- en: Easily build an Event Reminder with Cloud Workflows and Cloud Scheduler
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Cloud Workflows å’Œ Cloud Scheduler è½»æ¾æ„å»ºäº‹ä»¶æé†’
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/easily-build-an-event-reminder-with-cloud-workflows-and-cloud-scheduler-efba59b3df9a](https://towardsdatascience.com/easily-build-an-event-reminder-with-cloud-workflows-and-cloud-scheduler-efba59b3df9a)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/easily-build-an-event-reminder-with-cloud-workflows-and-cloud-scheduler-efba59b3df9a](https://towardsdatascience.com/easily-build-an-event-reminder-with-cloud-workflows-and-cloud-scheduler-efba59b3df9a)
- en: 'Use Case: Identify Birthdays and Send Notification Emails'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç”¨ä¾‹ï¼šè¯†åˆ«ç”Ÿæ—¥å¹¶å‘é€é€šçŸ¥ç”µå­é‚®ä»¶
- en: '[](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)[![Marc
    Djohossou](../Images/096f7877d14b7671e48500175931dbea.png)](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)[](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)
    [Marc Djohossou](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)[![Marc
    Djohossou](../Images/096f7877d14b7671e48500175931dbea.png)](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)[](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)
    [Marc Djohossou](https://marcgeremie.medium.com/?source=post_page-----efba59b3df9a--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)
    Â·7 min readÂ·Apr 26, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page-----efba59b3df9a--------------------------------)
    Â·7åˆ†é’Ÿé˜…è¯»Â·2023å¹´4æœˆ26æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/4defb51e3279ab731da36613dcca9606.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4defb51e3279ab731da36613dcca9606.png)'
- en: Photo by [Imants KaziÄ¼uns](https://unsplash.com/@imants72?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±[Imants KaziÄ¼uns](https://unsplash.com/@imants72?utm_source=medium&utm_medium=referral)æä¾›ï¼Œæ¥è‡ª[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: 'Building an event reminder, like Facebook anniversary reminder can seem more
    laborious than it really is. In this article, I elaborate on an easy, yet efficient
    way to build a birthday reminder application. Please, read through to unlock your
    access to the repository containing the full working code. Following are the main
    topics covered:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æ„å»ºäº‹ä»¶æé†’åŠŸèƒ½ï¼Œæ¯”å¦‚ Facebook å‘¨å¹´æé†’ï¼Œå¯èƒ½çœ‹èµ·æ¥æ¯”å®é™…æ›´è´¹åŠ›ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘è¯¦ç»†é˜è¿°äº†ä¸€ç§ç®€å•ä½†é«˜æ•ˆçš„æ–¹å¼æ¥æ„å»ºç”Ÿæ—¥æé†’åº”ç”¨ç¨‹åºã€‚è¯·é˜…è¯»ä»¥ä¸‹å†…å®¹ä»¥è§£é”è®¿é—®åŒ…å«å®Œæ•´å·¥ä½œä»£ç çš„ä»“åº“ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦æ¶‰åŠçš„ä¸»é¢˜ï¼š
- en: Introduction to Cloud Workflows and Cloud Run
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: äº‘å·¥ä½œæµä¸ Cloud Run ä»‹ç»
- en: ''
  id: totrans-10
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Build the Birthday Identification Service
  id: totrans-11
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å»ºç«‹ç”Ÿæ—¥è¯†åˆ«æœåŠ¡
- en: ''
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Build the Email Notification Service
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å»ºç«‹ç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡
- en: ''
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Build the Birthday Reminder Service
  id: totrans-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ„å»ºç”Ÿæ—¥æé†’æœåŠ¡
- en: ''
  id: totrans-16
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Summing Up
  id: totrans-17
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ€»ç»“
- en: Introduction to Cloud Workflows and Cloud Run
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: äº‘å·¥ä½œæµä¸ Cloud Run ä»‹ç»
- en: C[loud Workflows](https://cloud.google.com/workflows?hl=en) is a Google Cloud
    service that lets you orchestrate a series of HTTP-Based services. Those services
    can be internal (when they belong to a Google Cloud domain) or external. In additional
    to its attractive cost, Cloud Workflows has some unique and interesting features
    to offer like [Wait and Callback](https://cloud.google.com/workflows/docs/creating-callback-endpoints)
    that lets you wait for up to 1 year for an event to happen.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '[Cloud Workflows](https://cloud.google.com/workflows?hl=en) æ˜¯ Google Cloud
    æä¾›çš„ä¸€é¡¹æœåŠ¡ï¼Œå…è®¸ä½ ç¼–æ’ä¸€ç³»åˆ—åŸºäº HTTP çš„æœåŠ¡ã€‚è¿™äº›æœåŠ¡å¯ä»¥æ˜¯å†…éƒ¨çš„ï¼ˆå½“å®ƒä»¬å±äº Google Cloud åŸŸæ—¶ï¼‰æˆ–å¤–éƒ¨çš„ã€‚é™¤äº†å…·æœ‰å¸å¼•äººçš„æˆæœ¬ï¼ŒCloud
    Workflows è¿˜æä¾›äº†ä¸€äº›ç‹¬ç‰¹ä¸”æœ‰è¶£çš„åŠŸèƒ½ï¼Œä¾‹å¦‚[ç­‰å¾…å’Œå›è°ƒ](https://cloud.google.com/workflows/docs/creating-callback-endpoints)ï¼Œå¯ä»¥è®©ä½ ç­‰å¾…é•¿è¾¾
    1 å¹´çš„æ—¶é—´ä»¥å‘ç”ŸæŸä¸ªäº‹ä»¶ã€‚'
- en: '[Cloud Run](https://cloud.google.com/run?hl=en) is used to run containerized
    applications at scale. As a serverless offer it does not require creating a cluster
    or a Virtual Machine, which accelerate building and deploying applications. Although
    Cloud Run tends to be used often for websites and Rest APIs, it can be used for
    a broad range of tasks including lightweight data processing or task automation.
    On that note, this article uses a data processing Cloud Run service to identify
    people that will be soon celebrating their birthday and a task automation Cloud
    Run service that sends reminder emails.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[Cloud Run](https://cloud.google.com/run?hl=en) ç”¨äºå¤§è§„æ¨¡è¿è¡Œå®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚ä½œä¸ºæ— æœåŠ¡å™¨çš„æœåŠ¡ï¼Œå®ƒä¸éœ€è¦åˆ›å»ºé›†ç¾¤æˆ–è™šæ‹Ÿæœºï¼Œä»è€ŒåŠ é€Ÿäº†åº”ç”¨ç¨‹åºçš„æ„å»ºå’Œéƒ¨ç½²ã€‚è™½ç„¶
    Cloud Run é€šå¸¸ç”¨äºç½‘ç«™å’Œ Rest APIï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨äºå¹¿æ³›çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬è½»é‡çº§çš„æ•°æ®å¤„ç†æˆ–ä»»åŠ¡è‡ªåŠ¨åŒ–ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæœ¬æ–‡ä½¿ç”¨äº†ä¸€ä¸ªæ•°æ®å¤„ç†çš„ Cloud
    Run æœåŠ¡æ¥è¯†åˆ«å³å°†åº†ç¥ç”Ÿæ—¥çš„äººï¼Œä»¥åŠä¸€ä¸ªä»»åŠ¡è‡ªåŠ¨åŒ–çš„ Cloud Run æœåŠ¡æ¥å‘é€æé†’ç”µå­é‚®ä»¶ã€‚'
- en: Build the Birthday Identification Service
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ„å»ºç”Ÿæ—¥è¯†åˆ«æœåŠ¡
- en: Letâ€™s imagine that we have been given the details of a group of people whose
    anniversary should be reminded in advance to a few people, maybe their closest
    friends.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬å·²è·å¾—ä¸€ç»„äººå‘˜çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¿™äº›äººå‘˜çš„å‘¨å¹´çºªå¿µåº”è¯¥æå‰æé†’å‡ ä¸ªäººï¼Œä¹Ÿè®¸æ˜¯ä»–ä»¬æœ€äº²è¿‘çš„æœ‹å‹ã€‚
- en: '![](../Images/4ad3d40953b65ce73139287baa4abaec.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4ad3d40953b65ce73139287baa4abaec.png)'
- en: Image By Author, birthdays table â€” List of people whom birthday to identify
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾åƒï¼Œç”Ÿæ—¥è¡¨ â€” éœ€è¦è¯†åˆ«çš„äººå‘˜ç”Ÿæ—¥åˆ—è¡¨
- en: Looking at the first line of the table above, we see that Mr Smith was born
    a 25th of December. Then, the goal might be to automatically notify Mr Smithâ€™s
    friends via email one week ahead (so that they have enough time to arrange the
    surprise party ğŸ˜€).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: æŸ¥çœ‹ä¸Šè¡¨çš„ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬çœ‹åˆ°å²å¯†æ–¯å…ˆç”Ÿå‡ºç”Ÿäº12æœˆ25æ—¥ã€‚å› æ­¤ï¼Œç›®æ ‡å¯èƒ½æ˜¯è‡ªåŠ¨é€šè¿‡ç”µå­é‚®ä»¶æå‰ä¸€å‘¨é€šçŸ¥å²å¯†æ–¯å…ˆç”Ÿçš„æœ‹å‹ä»¬ï¼ˆä»¥ä¾¿ä»–ä»¬æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥å®‰æ’æƒŠå–œæ´¾å¯¹
    ğŸ˜€ï¼‰ã€‚
- en: Now there are many places where the birthdays table might be stored. As a Google
    Cloud user, it makes sense to store the birthdays details in a [BigQuery](https://cloud.google.com/bigquery?hl=en)
    table. Another really good candidate is [Google Sheets](https://www.google.fr/intl/en/sheets/about/),
    especially if the number of people in the birthdays table is not too high.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œç”Ÿæ—¥è¡¨å¯èƒ½å­˜å‚¨åœ¨è®¸å¤šåœ°æ–¹ã€‚ä½œä¸º Google Cloud ç”¨æˆ·ï¼Œå°†ç”Ÿæ—¥è¯¦æƒ…å­˜å‚¨åœ¨ [BigQuery](https://cloud.google.com/bigquery?hl=en)
    è¡¨ä¸­æ˜¯æœ‰æ„ä¹‰çš„ã€‚å¦ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©æ˜¯ [Google Sheets](https://www.google.fr/intl/en/sheets/about/)ï¼Œå°¤å…¶æ˜¯å½“ç”Ÿæ—¥è¡¨ä¸­çš„äººæ•°ä¸å¤šæ—¶ã€‚
- en: 'With Google Sheets as the storage solution, the birthday identification service
    will then look like this:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Google Sheets ä½œä¸ºå­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œç”Ÿæ—¥è¯†åˆ«æœåŠ¡å°†å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '![](../Images/15b3c5d662a598e1c0b12ab81f39a1d9.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/15b3c5d662a598e1c0b12ab81f39a1d9.png)'
- en: Image By Author, Birthday Identification Service Architecture â€” Sheets Logo
    from flaticonÂ¹
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾åƒï¼Œç”Ÿæ—¥è¯†åˆ«æœåŠ¡æ¶æ„ â€” Sheets å›¾æ ‡æ¥è‡ª flaticonÂ¹
- en: This can then be easily translated in Python Code
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¯ä»¥å¾ˆå®¹æ˜“åœ°è½¬æ¢æˆ Python ä»£ç ã€‚
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Note how the birthday identification service takes 2 input parameters:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ç”Ÿæ—¥è¯†åˆ«æœåŠ¡æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼š
- en: The Google Sheet containing the birthdays table ID
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŒ…å«ç”Ÿæ—¥è¡¨ ID çš„ Google Sheet
- en: The list of emails to notify about the upcoming birthdays (for instance notify_1@gmail.com
    and notify_2@gmail.com)
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¦é€šçŸ¥å³å°†åˆ°æ¥çš„ç”Ÿæ—¥çš„ç”µå­é‚®ä»¶åˆ—è¡¨ï¼ˆä¾‹å¦‚ notify_1@gmail.com å’Œ notify_2@gmail.comï¼‰
- en: It reads the birthdays table, filters the table to keep only the next week lucky-ones
    and returns a python dictionary containing the details of the detected birthdays
    and the list of people to notify.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒè¯»å–ç”Ÿæ—¥è¡¨ï¼Œè¿‡æ»¤è¡¨æ ¼ä»¥ä¿ç•™ä¸‹å‘¨çš„å¹¸è¿å„¿ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ£€æµ‹åˆ°çš„ç”Ÿæ—¥è¯¦æƒ…å’Œéœ€è¦é€šçŸ¥çš„äººå‘˜åˆ—è¡¨çš„ Python å­—å…¸ã€‚
- en: '[PRE1]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now we can give the service a name and deploy it to have a Cloud Run service
    ready to identify next birthdays from the birthdays table:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»™æœåŠ¡èµ·ä¸ªåå­—å¹¶å°†å…¶éƒ¨ç½²ï¼Œä»¥ä¾¿å‡†å¤‡ä¸€ä¸ª Cloud Run æœåŠ¡æ¥è¯†åˆ«ç”Ÿæ—¥è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªç”Ÿæ—¥ï¼š
- en: '![](../Images/30d552cf31ead13b32380dd64486ad48.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/30d552cf31ead13b32380dd64486ad48.png)'
- en: Image By Author, Birthday Identification Service Deployed to Cloud Run
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾åƒï¼Œç”Ÿæ—¥è¯†åˆ«æœåŠ¡å·²éƒ¨ç½²åˆ° Cloud Run
- en: '**Note**: This article does not go into the specifics of how to identify the
    upcoming birthdays or how to deploy the birthday identification service.'
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**æ³¨æ„**ï¼šæœ¬æ–‡ä¸ä¼šè¯¦ç»†ä»‹ç»å¦‚ä½•è¯†åˆ«å³å°†åˆ°æ¥çš„ç”Ÿæ—¥æˆ–å¦‚ä½•éƒ¨ç½²ç”Ÿæ—¥è¯†åˆ«æœåŠ¡ã€‚'
- en: Build the Email Notification Service
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ„å»ºç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡
- en: Once the nearing birthdays are identified, itâ€™s time to communicate the good
    news. In a social network context for example, only the direct connections of
    the â€œbirthday boy / girlâ€ will get to be notified.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦è¯†åˆ«å‡ºå³å°†åˆ°æ¥çš„ç”Ÿæ—¥ï¼Œå°±è¯¥ä¼ è¾¾å¥½æ¶ˆæ¯äº†ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¤¾äº¤ç½‘ç»œä¸Šä¸‹æ–‡ä¸­ï¼Œåªæœ‰â€œç”Ÿæ—¥ç”·å­©/å¥³å­©â€çš„ç›´æ¥è”ç³»æ‰èƒ½å¾—åˆ°é€šçŸ¥ã€‚
- en: 'The email notification Cloud Run service takes as input a json payload containing:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ç”µå­é‚®ä»¶é€šçŸ¥ Cloud Run æœåŠ¡çš„è¾“å…¥æ˜¯ä¸€ä¸ªåŒ…å« json æœ‰æ•ˆè´Ÿè½½çš„å†…å®¹ï¼š
- en: The list of birthday boy / girl and their details (identified previously)
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”Ÿæ—¥ç”·å­©/å¥³å­©åŠå…¶è¯¦ç»†ä¿¡æ¯çš„åˆ—è¡¨ï¼ˆä¹‹å‰å·²è¯†åˆ«ï¼‰
- en: The list of the people to notify
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éœ€è¦é€šçŸ¥çš„äººå‘˜åˆ—è¡¨
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The actual email sending can be achieved in multiple ways. Personally, Iâ€™ve
    had success using [Sendgrid](https://sendgrid.com/) or Gmail SMPT server via the
    Python Package *smtplib*.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: å®é™…çš„ç”µå­é‚®ä»¶å‘é€å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ã€‚ä¸ªäººæ¥è¯´ï¼Œæˆ‘æˆåŠŸä½¿ç”¨äº† [Sendgrid](https://sendgrid.com/) æˆ–é€šè¿‡ Python
    åŒ… *smtplib* ä½¿ç”¨ Gmail SMPT æœåŠ¡å™¨ã€‚
- en: '![](../Images/7d22d8bdc8444c90769444cdacbdbe7f.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7d22d8bdc8444c90769444cdacbdbe7f.png)'
- en: Image By Author, Email Notification Service Deployed to Cloud Run
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ï¼Œç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡éƒ¨ç½²åˆ° Cloud Run
- en: 'At this point, we have built a service that is able to identify birthdays and
    another service which is able to send email notifications. Yet, there are 2 missing
    ingredients for a working birthday reminder application:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ„å»ºäº†ä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ«ç”Ÿæ—¥çš„æœåŠ¡å’Œä¸€ä¸ªèƒ½å¤Ÿå‘é€ç”µå­é‚®ä»¶é€šçŸ¥çš„æœåŠ¡ã€‚ç„¶è€Œï¼Œè¿˜ç¼ºå°‘ä¸¤ä¸ªè¦ç´ æ¥å®Œæˆä¸€ä¸ªå·¥ä½œæ­£å¸¸çš„ç”Ÿæ—¥æé†’åº”ç”¨ç¨‹åºï¼š
- en: A solution that is able to run the two services sequentially on a schedule
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªèƒ½å¤ŸæŒ‰è®¡åˆ’é¡ºåºè¿è¡Œè¿™ä¸¤ä¸ªæœåŠ¡çš„è§£å†³æ–¹æ¡ˆ
- en: A solution that is able to skip running the email notification service if no
    birthday has been identified.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªèƒ½å¤Ÿè·³è¿‡è¿è¡Œç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡çš„è§£å†³æ–¹æ¡ˆï¼ˆå¦‚æœæ²¡æœ‰è¯†åˆ«åˆ°ç”Ÿæ—¥çš„è¯ï¼‰ã€‚
- en: And this is where Cloud Workflows comes into play
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ—¶ï¼ŒCloud Workflows å°±æ´¾ä¸Šç”¨åœºäº†
- en: '**Note**: This article does not dive into the details of how to send the emails
    or how to deploy the email notification service.'
  id: totrans-54
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**æ³¨æ„**ï¼šæœ¬æ–‡ä¸ä¼šæ·±å…¥è®²è§£å¦‚ä½•å‘é€ç”µå­é‚®ä»¶æˆ–å¦‚ä½•éƒ¨ç½²ç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡ã€‚'
- en: Build the Birthday Reminder Service
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ„å»ºç”Ÿæ—¥æé†’æœåŠ¡
- en: As the birthday identification service and the email notification service are
    up and running, all that is left is how to connect them and recurrently start
    the birthday reminder application on a schedule.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºç”Ÿæ—¥è¯†åˆ«æœåŠ¡å’Œç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡å·²ç»å¯åŠ¨ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¦‚ä½•å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œå¹¶å®šæœŸå¯åŠ¨ç”Ÿæ—¥æé†’åº”ç”¨ç¨‹åºã€‚
- en: 'Letâ€™s say we want the birthday reminder application to execute every Saturday.
    Then we need to do the following:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬å¸Œæœ›ç”Ÿæ—¥æé†’åº”ç”¨ç¨‹åºæ¯å‘¨å…­æ‰§è¡Œä¸€æ¬¡ã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åšä»¥ä¸‹äº‹æƒ…ï¼š
- en: '**Activate the Cloud Workflows API**'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ¿€æ´» Cloud Workflows API**'
- en: In Cloud Console search bar, type *Workflows* and click on the *Worflows* API
    link. Then click on the *ENABLE* button to activate the API and wait for a few
    seconds.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Cloud Console æœç´¢æ¡†ä¸­ï¼Œè¾“å…¥ *Workflows* å¹¶ç‚¹å‡» *Workflows* API é“¾æ¥ã€‚ç„¶åç‚¹å‡» *ENABLE* æŒ‰é’®æ¥æ¿€æ´»
    APIï¼Œå¹¶ç­‰å¾…å‡ ç§’é’Ÿã€‚
- en: '![](../Images/afba4e996cb5c7f26cce0e347536928c.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/afba4e996cb5c7f26cce0e347536928c.png)'
- en: Image By Author, Looking for Cloud Workflows API
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ï¼Œå¯»æ‰¾ Cloud Workflows API
- en: '![](../Images/f7f85cca99eceb6a39e051f4c9f62393.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f7f85cca99eceb6a39e051f4c9f62393.png)'
- en: Image By Author, Activate the Cloud Workflows API
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ï¼Œæ¿€æ´» Cloud Workflows API
- en: '**Create the Birthday Reminder Workflow**'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åˆ›å»ºç”Ÿæ—¥æé†’å·¥ä½œæµ**'
- en: Once the Workflows API is enabled, click on the *CREATE* button and start filling
    the details for the birthday workflow creation. Please, note that the workflow
    service account should have the *Cloud Run Invoker IAM Role* (or a broader role)
    to be able to trigger the birthday identification and the email notification services
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: å¯ç”¨ Workflows API åï¼Œç‚¹å‡» *CREATE* æŒ‰é’®å¹¶å¼€å§‹å¡«å†™ç”Ÿæ—¥å·¥ä½œæµåˆ›å»ºçš„è¯¦ç»†ä¿¡æ¯ã€‚è¯·æ³¨æ„ï¼Œå·¥ä½œæµæœåŠ¡è´¦æˆ·åº”å…·æœ‰ *Cloud Run
    Invoker IAM Role*ï¼ˆæˆ–æ›´å¹¿æ³›è§’è‰²ï¼‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿè§¦å‘ç”Ÿæ—¥è¯†åˆ«å’Œç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡ã€‚
- en: '![](../Images/7204fe6a46c617530a8318dfa1d8c236.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7204fe6a46c617530a8318dfa1d8c236.png)'
- en: Image By Author, Birthday Reminder Workflow Creation, Part 1
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ï¼Œç”Ÿæ—¥æé†’å·¥ä½œæµåˆ›å»ºï¼Œç¬¬ 1 éƒ¨åˆ†
- en: Click on the *ADD NEW TRIGGER* button and configure a Cloud Scheduler. Please,
    make sure to define a json document in the *Workflowâ€™s argument* containing the
    birthdays table Google Sheets ID and the emails to notify. In addition, youâ€™ll
    want to pick a service account with the *Workflows Invoker IAM Role* (or broader)
    to run the scheduler job.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ç‚¹å‡» *ADD NEW TRIGGER* æŒ‰é’®å¹¶é…ç½®ä¸€ä¸ª Cloud Schedulerã€‚è¯·ç¡®ä¿åœ¨ *Workflowâ€™s argument* ä¸­å®šä¹‰ä¸€ä¸ªåŒ…å«ç”Ÿæ—¥è¡¨
    Google Sheets ID å’Œè¦é€šçŸ¥çš„ç”µå­é‚®ä»¶çš„ json æ–‡æ¡£ã€‚æ­¤å¤–ï¼Œä½ è¿˜éœ€è¦é€‰æ‹©ä¸€ä¸ªå…·æœ‰ *Workflows Invoker IAM Role*ï¼ˆæˆ–æ›´å¹¿æ³›è§’è‰²ï¼‰çš„æœåŠ¡è´¦æˆ·æ¥è¿è¡Œè°ƒåº¦ç¨‹åºä½œä¸šã€‚
- en: '![](../Images/54b5e5570f705e759870bff73480aa21.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/54b5e5570f705e759870bff73480aa21.png)'
- en: Image By Author, Birthday Reminder Workflow Creation, Part 2
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ï¼Œç”Ÿæ—¥æé†’å·¥ä½œæµåˆ›å»ºï¼Œç¬¬ 2 éƒ¨åˆ†
- en: Click the *CONTINUE* button and add the workflow definition yaml file. Then
    click on *DEPLOY* and wait a few seconds for the workflow to be created
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ç‚¹å‡» *CONTINUE* æŒ‰é’®å¹¶æ·»åŠ å·¥ä½œæµå®šä¹‰ yaml æ–‡ä»¶ã€‚ç„¶åç‚¹å‡» *DEPLOY* å¹¶ç­‰å¾…å‡ ç§’é’Ÿä»¥åˆ›å»ºå·¥ä½œæµ
- en: '![](../Images/cd752b2ceda1fcceeda0cdfa86fca570.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/cd752b2ceda1fcceeda0cdfa86fca570.png)'
- en: Image By Author, Birthday Reminder Workflow Creation, Part 3
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºäºä½œè€…ï¼Œç”Ÿæ—¥æé†’å·¥ä½œæµåˆ›å»ºï¼Œç¬¬ 3 éƒ¨åˆ†
- en: 'Do you remember the 2 reasons why Cloud Workflows is actually needed for putting
    together the birthday reminder application ? It provides:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ è¿˜è®°å¾—ä¸ºä»€ä¹ˆ Cloud Workflows å¯¹äºæ„å»ºç”Ÿæ—¥æé†’åº”ç”¨ç¨‹åºå®é™…ä¸Šæ˜¯å¿…è¦çš„ 2 ä¸ªåŸå› å—ï¼Ÿå®ƒæä¾›äº†ï¼š
- en: A way to recurrently run the birthday identification and the email notification
    services, one after the other
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ç§é‡å¤è¿è¡Œç”Ÿæ—¥è¯†åˆ«å’Œç”µå­é‚®ä»¶é€šçŸ¥æœåŠ¡çš„æ–¹æ³•ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ
- en: The capacity to skip the execution of the notification if there were no birthdays
    to celebrate.
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœæ²¡æœ‰ç”Ÿæ—¥éœ€è¦åº†ç¥ï¼Œåˆ™å¯ä»¥è·³è¿‡é€šçŸ¥çš„æ‰§è¡Œã€‚
- en: This skipping capacity is implemented by using a **switch step** in which the
    number of upcoming birthdays is checked. If there is no birthdays, the notification
    email service is not executed.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§è·³è¿‡åŠŸèƒ½æ˜¯é€šè¿‡ä½¿ç”¨**åˆ‡æ¢æ­¥éª¤**æ¥å®ç°çš„ï¼Œå…¶ä¸­æ£€æŸ¥äº†å³å°†åˆ°æ¥çš„ç”Ÿæ—¥æ•°é‡ã€‚å¦‚æœæ²¡æœ‰ç”Ÿæ—¥ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œé€šçŸ¥ç”µå­é‚®ä»¶æœåŠ¡ã€‚
- en: '[PRE3]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '**Summing Up**'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ€»ç»“**'
- en: This writing describes a simple way of building any event reminder application
    using Cloud Scheduler and Cloud Workflows. The former is responsible of triggering
    the reminding while the latter orchestrates HTTP services that hold the logic
    of what needs to be reminded. Typically, we created a workflow that orchestrates
    2 Cloud Run services and used a Cloud Workflows switch step to early stop the
    workflow when needed.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ–‡æè¿°äº†ä½¿ç”¨ Cloud Scheduler å’Œ Cloud Workflows æ„å»ºä»»ä½•äº‹ä»¶æé†’åº”ç”¨ç¨‹åºçš„ç®€å•æ–¹æ³•ã€‚å‰è€…è´Ÿè´£è§¦å‘æé†’ï¼Œè€Œåè€…åˆ™åè°ƒåŒ…å«éœ€è¦æé†’çš„é€»è¾‘çš„
    HTTP æœåŠ¡ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåè°ƒ 2 ä¸ª Cloud Run æœåŠ¡çš„å·¥ä½œæµï¼Œå¹¶ä½¿ç”¨äº† Cloud Workflows çš„åˆ‡æ¢æ­¥éª¤ï¼Œåœ¨éœ€è¦æ—¶æå‰åœæ­¢å·¥ä½œæµã€‚
- en: If this sparked your interest, youâ€™ll find the full working code in this [gitlab
    repository](https://gitlab.com/marcdjoh/event-reminder-with-cloud-workflows).
    Please, request an access by sending an email at marcgeremie@gmail.com and Iâ€™ll
    be happy to add you to the repository.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœè¿™å¼•èµ·äº†ä½ çš„å…´è¶£ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ª [gitlab ä»“åº“](https://gitlab.com/marcdjoh/event-reminder-with-cloud-workflows)
    ä¸­æ‰¾åˆ°å®Œæ•´çš„å·¥ä½œä»£ç ã€‚å¦‚æœéœ€è¦è®¿é—®ï¼Œè¯·å‘é€ç”µå­é‚®ä»¶è‡³ marcgeremie@gmail.comï¼Œæˆ‘ä¼šå¾ˆä¹æ„å°†ä½ æ·»åŠ åˆ°ä»“åº“ä¸­ã€‚
- en: Thank you for your time and see you soon with another interesting article.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢ä½ çš„æ—¶é—´ï¼ŒæœŸå¾…ä¸ä¹…åä¸å¦ä¸€ç¯‡æœ‰è¶£çš„æ–‡ç« å†è§ã€‚
- en: '[1] [https://www.flaticon.com/free-icon/sheets_281761?term=google+sheets&page=1&position=1&origin=tag&related_id=281761](https://www.flaticon.com/free-icon/sheets_281761?term=google+sheets&page=1&position=1&origin=tag&related_id=281761)'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '[1] [https://www.flaticon.com/free-icon/sheets_281761?term=google+sheets&page=1&position=1&origin=tag&related_id=281761](https://www.flaticon.com/free-icon/sheets_281761?term=google+sheets&page=1&position=1&origin=tag&related_id=281761)'

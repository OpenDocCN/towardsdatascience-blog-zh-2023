- en: 'Double Machine Learning, Simplified: Part 2 â€” Targeting & the CATE'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åŒé‡æœºå™¨å­¦ä¹ ï¼Œç®€åŒ–ç‰ˆï¼šç¬¬ 2 éƒ¨åˆ† â€” ç›®æ ‡è®¾å®šä¸ CATE
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/double-machine-learning-simplified-part-2-extensions-the-cate-99926151cac?source=collection_archive---------2-----------------------#2023-07-31](https://towardsdatascience.com/double-machine-learning-simplified-part-2-extensions-the-cate-99926151cac?source=collection_archive---------2-----------------------#2023-07-31)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/double-machine-learning-simplified-part-2-extensions-the-cate-99926151cac?source=collection_archive---------2-----------------------#2023-07-31](https://towardsdatascience.com/double-machine-learning-simplified-part-2-extensions-the-cate-99926151cac?source=collection_archive---------2-----------------------#2023-07-31)
- en: '![](../Images/6eb4d0930e2bb0f3820e0379c8f07e34.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6eb4d0930e2bb0f3820e0379c8f07e34.png)'
- en: Learn how to utilize DML for estimating idiosyncratic treatment effects to enable
    data-driven targeting
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å­¦ä¹ å¦‚ä½•åˆ©ç”¨ DML ä¼°è®¡ç‰¹å®šçš„æ²»ç–—æ•ˆæœï¼Œä»¥å®ç°æ•°æ®é©±åŠ¨çš„ç›®æ ‡è®¾å®š
- en: '[](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)[![Jacob
    Pieniazek](../Images/2d9c6295d39fcaaec4e62f11c359cb29.png)](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)[](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)
    [Jacob Pieniazek](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)[![Jacob
    Pieniazek](../Images/2d9c6295d39fcaaec4e62f11c359cb29.png)](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)[](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)
    [Jacob Pieniazek](https://medium.com/@jakepenzak?source=post_page-----99926151cac--------------------------------)'
- en: Â·
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0948d99b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&user=Jacob+Pieniazek&userId=6f0948d99b1c&source=post_page-6f0948d99b1c----99926151cac---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)
    Â·10 min readÂ·Jul 31, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99926151cac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&user=Jacob+Pieniazek&userId=6f0948d99b1c&source=-----99926151cac---------------------clap_footer-----------)'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0948d99b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&user=Jacob+Pieniazek&userId=6f0948d99b1c&source=post_page-6f0948d99b1c----99926151cac---------------------post_header-----------)
    å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----99926151cac--------------------------------)
    Â· 10 åˆ†é’Ÿé˜…è¯» Â· 2023 å¹´ 7 æœˆ 31 æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99926151cac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&user=Jacob+Pieniazek&userId=6f0948d99b1c&source=-----99926151cac---------------------clap_footer-----------)'
- en: --
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99926151cac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&source=-----99926151cac---------------------bookmark_footer-----------)'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99926151cac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdouble-machine-learning-simplified-part-2-extensions-the-cate-99926151cac&source=-----99926151cac---------------------bookmark_footer-----------)'
- en: This article is the **2nd** in a 2 part series on simplifying and democratizing
    Double Machine Learning. In the [1st part](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee),
    we covered the fundamentals of Double Machine Learning, along with two basic causal
    inference applications. Now, in pt. 2, we will extend this knowledge to turn our
    causal inference problem into a prediction task, wherein we predict individual
    level treatment effects to aid in decision making and data-driven targeting.
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æœ¬æ–‡æ˜¯å…³äºç®€åŒ–å’Œæ°‘ä¸»åŒ–åŒé‡æœºå™¨å­¦ä¹ çš„**ç¬¬äºŒç¯‡**æ–‡ç« ã€‚åœ¨[ç¬¬ä¸€éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)ï¼Œæˆ‘ä»¬ä»‹ç»äº†åŒé‡æœºå™¨å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠä¸¤ä¸ªåŸºæœ¬çš„å› æœæ¨æ–­åº”ç”¨ã€‚ç°åœ¨ï¼Œåœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•è¿™äº›çŸ¥è¯†ï¼Œå°†æˆ‘ä»¬çš„å› æœæ¨æ–­é—®é¢˜è½¬å˜ä¸ºé¢„æµ‹ä»»åŠ¡ï¼Œå…¶ä¸­æˆ‘ä»¬é¢„æµ‹ä¸ªä½“çº§åˆ«çš„æ²»ç–—æ•ˆåº”ï¼Œä»¥å¸®åŠ©å†³ç­–å’Œæ•°æ®é©±åŠ¨çš„ç›®æ ‡è®¾å®šã€‚
- en: Double Machine Learning, as we learned in [part 1 of this series](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee),
    is a highly flexible partially-linear causal inference method for estimating the
    average treatment effect (ATE) of a treatment. Specifically, it can be utilized
    to model highly non-linear confounding relationships in observational data (especially
    when our set of controls/confounders is of extremely high dimensionality) and/or
    to reduce the variation in our key outcome in experimental settings. Estimating
    the ATE is particularly useful in understanding the average impact of a specific
    treatment, which can be extremely useful for future decision making. However,
    extrapolating this treatment effect assumes a degree homogeneity in the effect;
    that is, regardless of the population we roll treatment out to, we anticipate
    the effect to be similar to the ATE. What if we are limited in the number of individuals
    who we can target for future rollout and thus want to understand among which subpopulations
    the treatment was most effective to drive highly effective rollout?
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æˆ‘ä»¬åœ¨[æœ¬ç³»åˆ—ç¬¬ä¸€éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)ä¸­æ‰€å­¦ï¼ŒåŒé‡æœºå™¨å­¦ä¹ æ˜¯ä¸€ç§é«˜åº¦çµæ´»çš„éƒ¨åˆ†çº¿æ€§å› æœæ¨æ–­æ–¹æ³•ï¼Œç”¨äºä¼°è®¡æ²»ç–—çš„å¹³å‡æ²»ç–—æ•ˆåº”ï¼ˆATEï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¯ä»¥ç”¨äºå»ºæ¨¡è§‚å¯Ÿæ•°æ®ä¸­é«˜åº¦éçº¿æ€§çš„æ··æ‚å…³ç³»ï¼ˆå°¤å…¶æ˜¯å½“æˆ‘ä»¬çš„æ§åˆ¶/æ··æ‚å˜é‡é›†åˆå…·æœ‰æé«˜çš„ç»´åº¦æ—¶ï¼‰å’Œ/æˆ–åœ¨å®éªŒè®¾ç½®ä¸­å‡å°‘å…³é”®ç»“æœçš„å˜å¼‚æ€§ã€‚ä¼°è®¡
    ATE å¯¹äºç†è§£ç‰¹å®šæ²»ç–—çš„å¹³å‡å½±å“å°¤ä¸ºæœ‰ç”¨ï¼Œè¿™å¯¹æœªæ¥çš„å†³ç­–éå¸¸é‡è¦ã€‚ç„¶è€Œï¼Œå¤–æ¨è¿™ä¸€æ²»ç–—æ•ˆåº”å‡è®¾æ•ˆåº”çš„åŒè´¨æ€§ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºæˆ‘ä»¬å°†æ²»ç–—æ¨å¹¿åˆ°å“ªä¸ªäººç¾¤ï¼Œæˆ‘ä»¬é¢„æœŸæ•ˆåº”å°†ä¸
    ATE ç›¸ä¼¼ã€‚å¦‚æœæˆ‘ä»¬åœ¨æœªæ¥æ¨å¹¿ä¸­èƒ½å¤Ÿé’ˆå¯¹çš„ä¸ªä½“æ•°é‡æœ‰é™ï¼Œå› æ­¤å¸Œæœ›äº†è§£å“ªäº›å­ç¾¤ä½“çš„æ²»ç–—æ•ˆæœæœ€ä¸ºæ˜¾è‘—ï¼Œä»è€Œé©±åŠ¨é«˜æ•ˆçš„æ¨å¹¿ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ
- en: 'This issue described above concerns estimating treatment effect heterogeneity.
    That is, how does our treatment effect impact different subsets of the population?
    Luckily for us, DML provides a powerful framework to do exactly this. Specifically,
    we can make use of DML to estimate the Conditional Average Treatment Effect (CATE).
    First, letâ€™s revisit our definition of the ATE:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šè¿°é—®é¢˜æ¶‰åŠä¼°è®¡æ²»ç–—æ•ˆåº”çš„å¼‚è´¨æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„æ²»ç–—æ•ˆåº”å¦‚ä½•å½±å“ä¸åŒçš„ç¾¤ä½“ï¼Ÿå¹¸è¿çš„æ˜¯ï¼ŒDML æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ¡†æ¶æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨
    DML æ¥ä¼°è®¡æ¡ä»¶å¹³å‡æ²»ç–—æ•ˆåº”ï¼ˆCATEï¼‰ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬é‡æ–°å®¡è§†ä¸€ä¸‹ ATE çš„å®šä¹‰ï¼š
- en: '![](../Images/595346cd86ae3d2dccd2d8172696ce3f.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/595346cd86ae3d2dccd2d8172696ce3f.png)'
- en: (1) Average Treatment Effect
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: (1) å¹³å‡æ²»ç–—æ•ˆåº”
- en: 'Now with the CATE, we estimate the ATE conditional on a set of values for our
    covariates, **X**:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æœ‰äº† CATEï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ç»„åå˜é‡**X**çš„æ¡ä»¶ä¸‹ä¼°è®¡ ATEï¼š
- en: '![](../Images/3b305cea9d99b947be51a804dd21028b.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3b305cea9d99b947be51a804dd21028b.png)'
- en: (2) Conditional Average Treatment Effect
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: (2) æ¡ä»¶å¹³å‡æ²»ç–—æ•ˆåº”
- en: 'For example, if we wanted to know the treatment effect for males versus females,
    we can estimate the CATE conditional on the covariate being equal to each subgroup
    of interest. Note that we can estimate highly aggregated CATEs (i.e., at a male
    vs. female level) or we can allow **X** to take on an extremely high dimensionality
    and thus closely estimate each individuals treatment effect. You may immediately
    notice the benefits in being able to do this: we can utilize this information
    to make highly informed decisions in future targeting of the treatment! *Even
    more notable, we can create a CATE function to make predictions on what we predict
    the treatment effect to be on previously* ***unexposed*** *individuals!*'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“ç”·æ€§ä¸å¥³æ€§çš„æ²»ç–—æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¡ä»¶å˜é‡ç­‰äºæ¯ä¸ªæ„Ÿå…´è¶£çš„å­ç¾¤ä½“æ—¶ä¼°è®¡ CATEã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä¼°è®¡é«˜åº¦èšåˆçš„ CATEï¼ˆå³ç”·æ€§ä¸å¥³æ€§å±‚é¢ï¼‰ï¼Œä¹Ÿå¯ä»¥å…è®¸
    **X** å…·æœ‰æé«˜çš„ç»´åº¦ï¼Œä»è€Œç²¾ç¡®ä¼°è®¡æ¯ä¸ªäººçš„æ²»ç–—æ•ˆæœã€‚ä½ å¯èƒ½ä¼šç«‹å³æ³¨æ„åˆ°è¿™æ ·åšçš„å¥½å¤„ï¼šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯åœ¨æœªæ¥çš„æ²»ç–—ç›®æ ‡ä¸Šåšå‡ºé«˜åº¦æ˜æ™ºçš„å†³ç­–ï¼ *æ›´å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª
    CATE å‡½æ•°ï¼Œé¢„æµ‹æˆ‘ä»¬å¯¹ä»¥å‰* ***æœªæ¥è§¦è¿‡çš„*** *ä¸ªä½“çš„æ²»ç–—æ•ˆæœçš„é¢„æµ‹ï¼*
- en: DML provides two primary methodologies for estimating this CATE function; namely,
    Linear DML and Non-Parametric DML. We will show how to estimate the CATE mathematically
    and then provide examples for each case.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: DML æä¾›äº†ä¸¤ç§ä¸»è¦çš„æ–¹æ³•æ¥ä¼°è®¡ CATE å‡½æ•°ï¼Œå³çº¿æ€§ DML å’Œéå‚æ•° DMLã€‚æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•ä»æ•°å­¦ä¸Šä¼°è®¡ CATEï¼Œç„¶åä¸ºæ¯ç§æƒ…å†µæä¾›ç¤ºä¾‹ã€‚
- en: '**Note:** Unbiased estimation of the CATE still requires the exogeneity/CIA/Ignorability
    assumption to hold as covered in [part 1](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee).'
  id: totrans-19
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**æ³¨æ„ï¼š** CATE çš„æ— åä¼°è®¡ä»ç„¶éœ€è¦ exogeneity/CIA/Ignorability å‡è®¾æˆç«‹ï¼Œå¦‚åœ¨ [ç¬¬ 1 éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)ä¸­æ‰€è¿°ã€‚'
- en: Everything demonstrated below can and should be extended to the experimental
    setting (RCT or A/B Testing), where exogeneity is satisfied by construction, as
    covered in application 2 of [part 1](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee).
  id: totrans-20
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ¼”ç¤ºçš„æ‰€æœ‰å†…å®¹éƒ½å¯ä»¥å¹¶ä¸”åº”è¯¥æ‰©å±•åˆ°å®éªŒè®¾ç½®ï¼ˆRCT æˆ– A/B æµ‹è¯•ï¼‰ï¼Œå…¶ä¸­é€šè¿‡æ„é€ æ»¡è¶³ exogeneityï¼Œå¦‚åœ¨ [ç¬¬ 1 éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)
    çš„åº”ç”¨ 2 ä¸­æ‰€è¿°ã€‚
- en: Linear DML for Estimating the CATE
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: çº¿æ€§ DML ä¼°è®¡ CATE
- en: 'Estimating the CATE in the linear DML framework is a simple extension of DML
    for estimating the ATE, as done in [part 1](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee):'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨çº¿æ€§ DML æ¡†æ¶ä¸‹ä¼°è®¡ CATE æ˜¯å¯¹ DML çš„ä¸€ç§ç®€å•æ‰©å±•ï¼Œç±»ä¼¼äºåœ¨ [ç¬¬ 1 éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)ä¸­å¯¹
    ATE çš„ä¼°è®¡ï¼š
- en: '![](../Images/ff40e6bdeac9222544390e90e9b8ed1a.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ff40e6bdeac9222544390e90e9b8ed1a.png)'
- en: (3) DML for Estimating the ATE
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: (3) DML ä¼°è®¡ ATE
- en: 'where ***y*** is our outcome, ***T*** is our treatment, & ğ‘€ğ‘¦ and ***MT*** are
    both flexible ML models (our nuisance functions) to predict ***y*** and ***T***
    given confounders and/or controls, ***X***, respectively. To estimate the CATE
    function using Linear DML, we can simply include interaction terms of the treatment
    residuals with our covariates. Observe:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ ***y*** æ˜¯æˆ‘ä»¬çš„ç»“æœï¼Œ***T*** æ˜¯æˆ‘ä»¬çš„æ²»ç–—ï¼Œ& ğ‘€ğ‘¦ å’Œ ***MT*** æ˜¯ä¸¤ä¸ªçµæ´»çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆæˆ‘ä»¬çš„å¹²æ‰°å‡½æ•°ï¼‰ï¼Œç”¨äºåœ¨ç»™å®šæ··æ‚å› ç´ å’Œ/æˆ–æ§åˆ¶å˜é‡
    ***X*** çš„æƒ…å†µä¸‹é¢„æµ‹ ***y*** å’Œ ***T***ã€‚è¦ä½¿ç”¨çº¿æ€§ DML ä¼°è®¡ CATE å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°åŒ…æ‹¬æ²»ç–—æ®‹å·®ä¸åå˜é‡çš„äº¤äº’é¡¹ã€‚è§‚å¯Ÿï¼š
- en: '![](../Images/174272210fa7fd5219b00dee168f1c53.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/174272210fa7fd5219b00dee168f1c53.png)'
- en: (4) Linear DML for Estimating the CATE
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: (4) çº¿æ€§ DML ä¼°è®¡ CATE
- en: where **Î©** is the vector of coefficients for the interaction terms. Now our
    CATE function, call it *Ï„,* takes the form *Ï„*(**X**) = Î²â‚ + **XÎ©**, where we
    can predicteach individuals CATE given **X**. If T is continuous, this CATE function
    is for a 1 unit increase in T. Note that *Ï„(****X****) =* Î²â‚ in eq. (3) where
    *Ï„(****X****)* is assumed a constant. Letâ€™s take a look at this in action!
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ **Î©** æ˜¯äº¤äº’é¡¹ç³»æ•°çš„å‘é‡ã€‚ç°åœ¨æˆ‘ä»¬çš„ CATE å‡½æ•°ï¼Œç§°ä¹‹ä¸º *Ï„*ï¼Œå…·æœ‰å½¢å¼ *Ï„*(**X**) = Î²â‚ + **XÎ©**ï¼Œåœ¨ç»™å®š **X**
    çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹æ¯ä¸ªä¸ªä½“çš„ CATEã€‚å¦‚æœ T æ˜¯è¿ç»­çš„ï¼Œåˆ™æ­¤ CATE å‡½æ•°ç”¨äº T çš„ 1 å•ä½å¢åŠ ã€‚è¯·æ³¨æ„ï¼Œ*Ï„(****X****) =* Î²â‚
    åœ¨å…¬å¼ (3) ä¸­ï¼Œå…¶ä¸­ *Ï„(****X****)* è¢«å‡å®šä¸ºå¸¸æ•°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®é™…åº”ç”¨ï¼
- en: 'First, letâ€™s use the same casual DAG from [part 1](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee),
    where we will be looking at the effect of an individuals time spent on the website
    on their purchase amount, or sales, in the past month (*assuming we observe all
    confounders*).:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ¥è‡ª[ç¬¬ä¸€éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)çš„ç›¸åŒå› æœ
    DAGï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸ªäººåœ¨ç½‘ç«™ä¸ŠèŠ±è´¹çš„æ—¶é—´å¯¹å…¶è¿‡å»ä¸€ä¸ªæœˆè´­ä¹°é‡‘é¢æˆ–é”€å”®é¢çš„å½±å“ï¼ˆ*å‡è®¾æˆ‘ä»¬è§‚å¯Ÿåˆ°æ‰€æœ‰æ··æ‚å› ç´ *ï¼‰ï¼š
- en: '![](../Images/53ff709528289a0762c49af8579e9f7a.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/53ff709528289a0762c49af8579e9f7a.png)'
- en: 'Letâ€™s then simulate this DFP using a similar process as utilized in [part 1](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)
    (*note that all values & data are chosen and generated arbitrarily for demonstrative
    purposes, and thus should not necessarily represent a large degree real world
    intuition per se outside of our estimates of the CATE*). Observe that we now include
    interaction terms in the sales DGP to model the CATE, or treatment effect heterogeneity
    (*note that the DGP in part 1 had no treatment effect heterogeneity by construction*):'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°†ä½¿ç”¨ä¸[ç¬¬ä¸€éƒ¨åˆ†](https://medium.com/towards-data-science/double-machine-learning-simplified-part-1-basic-causal-inference-applications-3f7afc9852ee)ä¸­ç±»ä¼¼çš„è¿‡ç¨‹æ¥æ¨¡æ‹Ÿè¿™ä¸ª
    DFPï¼ˆ*è¯·æ³¨æ„ï¼Œæ‰€æœ‰å€¼å’Œæ•°æ®éƒ½æ˜¯ä¸ºæ¼”ç¤ºç›®çš„è€Œä»»æ„é€‰æ‹©å’Œç”Ÿæˆçš„ï¼Œå› æ­¤å¯èƒ½å¹¶ä¸ä»£è¡¨æˆ‘ä»¬çš„ CATE ä¼°è®¡ä¹‹å¤–çš„å¤§éƒ¨åˆ†å®é™…ä¸–ç•Œç›´è§‰*ï¼‰ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ç°åœ¨åœ¨é”€å”®
    DGP ä¸­åŒ…å«äº†äº¤äº’é¡¹æ¥å»ºæ¨¡ CATE æˆ–å¤„ç†æ•ˆæœçš„å¼‚è´¨æ€§ï¼ˆ*è¯·æ³¨æ„ï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸­çš„ DGP åœ¨æ„å»ºæ—¶æ²¡æœ‰å¤„ç†æ•ˆæœå¼‚è´¨æ€§*ï¼‰ï¼š
- en: '[PRE0]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now, to estimate our CATE function, as outlined in eq. (4), we can run:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œä¸ºäº†ä¼°è®¡æˆ‘ä»¬çš„ CATE å‡½æ•°ï¼Œå¦‚ç­‰å¼ (4) ä¸­æ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œï¼š
- en: '[PRE1]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'With the following results:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š
- en: '![](../Images/c8ea093a7a3cbe932d91e2a3e9cd9b8d.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c8ea093a7a3cbe932d91e2a3e9cd9b8d.png)'
- en: 'Here we can see that the linear DML closely modeled the true DGP for the CATE
    (see coefficients on interaction terms in sales DGP). Letâ€™s evaluate the performance
    of our CATE function by comparing the linear DML predictions to the true CATE
    for a 1 hour increase in time on the spent on the website:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çº¿æ€§ DML é€¼è¿‘äº† CATE çš„çœŸå® DGPï¼ˆå‚è§é”€å”® DGP ä¸­çš„äº¤äº’é¡¹ç³»æ•°ï¼‰ã€‚è®©æˆ‘ä»¬é€šè¿‡å°†çº¿æ€§ DML é¢„æµ‹å€¼ä¸å¢åŠ  1 å°æ—¶ç½‘ç«™åœç•™æ—¶é—´çš„çœŸå®
    CATE è¿›è¡Œæ¯”è¾ƒï¼Œæ¥è¯„ä¼°æˆ‘ä»¬ CATE å‡½æ•°çš„è¡¨ç°ï¼š
- en: '[PRE2]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Here we obtain a MSE of ~0.45, MAE of ~0.55, & R2 of ~0.99\. Plotting the distributions
    of the predicted CATE and true CATE, we obtain:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¾—åˆ°äº†çº¦ 0.45 çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ï¼Œçº¦ 0.55 çš„å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰ï¼Œä»¥åŠçº¦ 0.99 çš„å†³å®šç³»æ•°ï¼ˆR2ï¼‰ã€‚é€šè¿‡ç»˜åˆ¶é¢„æµ‹ CATE
    å’ŒçœŸå® CATE çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/31f0438f39ed311f178f70a63dbf3c3c.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/31f0438f39ed311f178f70a63dbf3c3c.png)'
- en: 'Additionally, plotting the predicted values versus the true values we obtain:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œé€šè¿‡ç»˜åˆ¶é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å…³ç³»ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/1bad1bdb88ac3d54becf71b7e122b1ea.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1bad1bdb88ac3d54becf71b7e122b1ea.png)'
- en: 'Overall, we have pretty impressive performance! However, the primary limitation
    in this approach is that we must manually specify the functional form of the CATE
    function, thus if we are only including linear interaction terms we may not capture
    the true CATE function. In our example, we simulated the DGP to only have these
    linear interaction terms and thus the performance is strong **by construction**,
    but letâ€™s see what happens when we tweak the DGP for the CATE to be arbitrarily
    non-linear:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ä½“æ¥è¯´ï¼Œæˆ‘ä»¬çš„è¡¨ç°éå¸¸ä»¤äººå°è±¡æ·±åˆ»ï¼ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çš„ä¸»è¦å±€é™æ€§åœ¨äºæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨æŒ‡å®š CATE å‡½æ•°çš„åŠŸèƒ½å½¢å¼ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ä»…åŒ…å«çº¿æ€§äº¤äº’é¡¹ï¼Œå¯èƒ½æ— æ³•æ•æ‰åˆ°çœŸå®çš„
    CATE å‡½æ•°ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº† DGP ä»¥ä»…åŒ…å«è¿™äº›çº¿æ€§äº¤äº’é¡¹ï¼Œå› æ­¤æ€§èƒ½å¼ºåŠ² **æŒ‰æ„å»º**ï¼Œä½†è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬å°† CATE çš„ DGP éšæ„è°ƒæ•´ä¸ºéçº¿æ€§æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Here we see a stark decrease in performance, where we obtain a MSE of ~55.92,
    MAE of ~4.50, & R2 of ~0.65\. Plotting the distributions of the predicted CATE
    and true CATE, we obtain:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œæˆ‘ä»¬å¾—åˆ°äº†çº¦ 55.92 çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ï¼Œçº¦ 4.50 çš„å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰ï¼Œä»¥åŠçº¦ 0.65 çš„å†³å®šç³»æ•°ï¼ˆR2ï¼‰ã€‚é€šè¿‡ç»˜åˆ¶é¢„æµ‹
    CATE å’ŒçœŸå® CATE çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/e6532b1335fc2b355fd4f617cb061781.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e6532b1335fc2b355fd4f617cb061781.png)'
- en: 'Additionally, plotting the predicted values versus the true values we obtain:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œé€šè¿‡ç»˜åˆ¶é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å…³ç³»ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/94b329b73623ab360460d9d7078317c9.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/94b329b73623ab360460d9d7078317c9.png)'
- en: This non-linearity in the CATE function is precisely where Non-Parametric DML
    can shine!
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: CATE å‡½æ•°ä¸­çš„è¿™ç§éçº¿æ€§æ­£æ˜¯éå‚æ•° DML å¯ä»¥å‘å…‰çš„åœ°æ–¹ï¼
- en: Non-Parametric DML for Estimating the CATE
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç”¨äºä¼°è®¡ CATE çš„éå‚æ•° DML
- en: 'Non-Parametric DML goes one step further and allows for another flexible non-parametric
    ML model to be utilized for learning the CATE function! Letâ€™s take a look at how
    we can, mathematically, do exactly this. Let *Ï„(****X****)* continue to denote
    our CATE function. Letâ€™s start with defining our error term relative to eq. 3
    (*note we drop the intercept Î²â‚€ as we are not interested in this parameter for
    the CATE; we could similarly drop this in the linear DML formulation, but for
    the sake of simplicity and consistency with part 1, we do not do this*):'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: éå‚æ•°DMLæ›´è¿›ä¸€æ­¥ï¼Œå…è®¸å¦ä¸€ä¸ªçµæ´»çš„éå‚æ•°MLæ¨¡å‹ç”¨äºå­¦ä¹ CATEå‡½æ•°ï¼è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨æ•°å­¦ä¸Šå‡†ç¡®æ‰§è¡Œæ­¤æ“ä½œã€‚è®© *Ï„(****X****)* ç»§ç»­è¡¨ç¤ºæˆ‘ä»¬çš„CATEå‡½æ•°ã€‚è®©æˆ‘ä»¬ä»ç›¸å¯¹äºeq.
    3å®šä¹‰æˆ‘ä»¬çš„è¯¯å·®é¡¹å¼€å§‹ï¼ˆè¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ”¾å¼ƒäº†æˆªè· Î²â‚€ï¼Œå› ä¸ºæˆ‘ä»¬å¯¹äºCATEçš„æ­¤å‚æ•°ä¸æ„Ÿå…´è¶£ï¼›åœ¨çº¿æ€§DMLå…¬å¼ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥ç±»ä¼¼åœ°æ”¾å¼ƒæ­¤å‚æ•°ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œå¹¶ä¸ç¬¬1éƒ¨åˆ†ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿™æ ·åšï¼‰ï¼š
- en: '![](../Images/ff0e274d37e759410518f750c82bbd0e.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ff0e274d37e759410518f750c82bbd0e.png)'
- en: (5) Error in DML Framework
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: (5) DMLæ¡†æ¶ä¸­çš„è¯¯å·®
- en: 'Then define the causal loss function as such (note this is just the MSE!):'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åå®šä¹‰å› æœæŸå¤±å‡½æ•°å¦‚ä¸‹ï¼ˆè¯·æ³¨æ„è¿™åªæ˜¯å‡æ–¹è¯¯å·®ï¼ï¼‰ï¼š
- en: '![](../Images/23b208d7d4401f64ac7676339b586054.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/23b208d7d4401f64ac7676339b586054.png)'
- en: (6) Causal Loss Function
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: (6) å› æœæŸå¤±å‡½æ•°
- en: 'What does this mean? We can directly learn *Ï„(****X****)* with any flexible
    ML model via minimizing our causal loss function! This amounts to a weighted regression
    problem with our target and weights, respectively, as:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡æœ€å°åŒ–æˆ‘ä»¬çš„å› æœæŸå¤±å‡½æ•°ï¼Œç›´æ¥ç”¨ä»»ä½•çµæ´»çš„MLæ¨¡å‹å­¦ä¹  *Ï„(****X****)* ï¼è¿™ç›¸å½“äºä¸€ä¸ªå¸¦æœ‰æˆ‘ä»¬çš„ç›®æ ‡å’Œæƒé‡çš„åŠ æƒå›å½’é—®é¢˜ï¼Œåˆ†åˆ«ä¸ºï¼š
- en: '![](../Images/60c2a9a2f33933b97d33381032c6861b.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/60c2a9a2f33933b97d33381032c6861b.png)'
- en: (7) Target & Weights in Non-Parametric DML
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: (7) éå‚æ•°DMLä¸­çš„ç›®æ ‡ä¸æƒé‡
- en: '*Take a moment and soak in the elegance of this resultâ€¦ We can directly learn
    the CATE function & predict an individuals CATE given our residualized outcome,*
    ***y****, and treatment,* ***T****!*'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '*ç¨ä½œåœé¡¿ï¼Œæ²‰æµ¸åœ¨è¿™ä¸€ç»“æœçš„ä¼˜é›…ä¹‹ä¸­â€¦â€¦ æˆ‘ä»¬å¯ä»¥ç›´æ¥å­¦ä¹ CATEå‡½æ•°ï¼Œå¹¶é¢„æµ‹ä¸ªä½“çš„CATEï¼Œç»™å®šæˆ‘ä»¬çš„æ®‹å·®åŒ–ç»“æœï¼Œ* ***y****ï¼Œå’Œå¤„ç†ï¼Œ*
    ***T****ï¼*'
- en: 'Letâ€™s take a look at this in action now. We will reuse the DGP for the non-linear
    CATE function that was utilized in the example where linear DML performs poorly
    above. To construct of Non-Parametric DML model, we can run:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹è¿™åœ¨å®é™…ä¸­æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚æˆ‘ä»¬å°†é‡ç”¨åœ¨ä¸Šè¿°çº¿æ€§DMLè¡¨ç°ä¸ä½³ç¤ºä¾‹ä¸­ä½¿ç”¨çš„éçº¿æ€§CATEå‡½æ•°çš„DGPã€‚ä¸ºäº†æ„å»ºéå‚æ•°DMLæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œï¼š
- en: '[PRE4]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'And to make predictions + evaluate performance:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä¸”ç”¨æ¥é¢„æµ‹å’Œè¯„ä¼°æ€§èƒ½ï¼š
- en: '[PRE5]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Here we obtain a much superior performance over linear DML, with a MSE of 4.61,
    MAE of 1.37, & R2 of 0.97\. Plotting the distributions of the predicted CATE and
    true CATE, we obtain:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è·å¾—äº†æ¯”çº¿æ€§DMLæ›´ä¼˜è¶Šçš„æ€§èƒ½ï¼ŒMSEä¸º4.61ï¼ŒMAEä¸º1.37ï¼ŒR2ä¸º0.97ã€‚ç»˜åˆ¶é¢„æµ‹CATEå’ŒçœŸå®CATEçš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/eb3e196328ea71e98e753f625a653215.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/eb3e196328ea71e98e753f625a653215.png)'
- en: 'Additionally, plotting the predicted values versus the true values we obtain:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: å¦å¤–ï¼Œç»˜åˆ¶é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å›¾å½¢ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
- en: '![](../Images/970f099ec85fa61b7e45fbbaa25f1e02.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/970f099ec85fa61b7e45fbbaa25f1e02.png)'
- en: Here we can see that, although not perfect, the non-parametric DML approach
    was able to model the non-linearities in the CATE function much better than the
    linear DML approach. We can of course further improve the performance via tuning
    our model. Note that we can use explainable AI tools, such as [SHAP values](https://shap.readthedocs.io/en/latest/index.html),
    to understand the nature of our treatment effect heterogeneity!
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ä¸å®Œç¾ï¼Œä½†éå‚æ•°DMLæ–¹æ³•èƒ½å¤Ÿæ¯”çº¿æ€§DMLæ–¹æ³•æ›´å¥½åœ°å»ºæ¨¡CATEå‡½æ•°ä¸­çš„éçº¿æ€§ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´æˆ‘ä»¬çš„æ¨¡å‹è¿›ä¸€æ­¥æé«˜æ€§èƒ½ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯è§£é‡Šçš„AIå·¥å…·ï¼Œå¦‚[SHAPå€¼](https://shap.readthedocs.io/en/latest/index.html)ï¼Œæ¥ç†è§£æˆ‘ä»¬å¤„ç†æ•ˆåº”å¼‚è´¨æ€§çš„æ€§è´¨ï¼
- en: Conclusion
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: And there you have it! Thank you for taking the time to read through my article.
    I hope this article has taught you how to go beyond estimating only the ATE &
    utilize DML to estimate the CATE to further understanding heterogeneity in the
    treatment effects and drive more causal inference- & data- driven targeting schemes.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: è‡³æ­¤ï¼æ„Ÿè°¢æ‚¨æŠ½å‡ºæ—¶é—´é˜…è¯»æˆ‘çš„æ–‡ç« ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« æ•™ä¼šäº†æ‚¨å¦‚ä½•è¶…è¶Šä»…ä¼°è®¡ATEå¹¶åˆ©ç”¨DMLä¼°è®¡CATEï¼Œä»¥è¿›ä¸€æ­¥ç†è§£å¤„ç†æ•ˆåº”çš„å¼‚è´¨æ€§ï¼Œå¹¶æ¨åŠ¨æ›´å¤šå› æœæ¨æ–­å’Œæ•°æ®é©±åŠ¨çš„å®šä½æ–¹æ¡ˆã€‚
- en: As always, I hope you have enjoyed reading this as much as I enjoyed writing
    it!
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€å¦‚æ—¢å¾€ï¼Œå¸Œæœ›æ‚¨é˜…è¯»æœ¬æ–‡èƒ½ä¸æˆ‘å†™ä½œæ—¶ä¸€æ ·æ„‰å¿«ï¼
- en: Resources
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: èµ„æº
- en: '[1] V. Chernozhukov, D. Chetverikov, M. Demirer, E. Duflo, C. Hansen, and a.
    W. Newey. Double Machine Learning for Treatment and Causal Parameters. *ArXiv
    e-prints*, July 2016.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '[1] V. Chernozhukov, D. Chetverikov, M. Demirer, E. Duflo, C. Hansen, and a.
    W. Newey. åŒæœºå™¨å­¦ä¹ ç”¨äºå¤„ç†å’Œå› æœå‚æ•°ã€‚*ArXivç”µå­æ‰“å°*ï¼Œ2016å¹´7æœˆã€‚'
- en: '*Access all the code via this GitHub Repo:* [https://github.com/jakepenzak/Blog-Posts](https://github.com/jakepenzak/Blog-Posts)'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '*é€šè¿‡è¿™ä¸ª GitHub ä»“åº“è®¿é—®æ‰€æœ‰ä»£ç :* [https://github.com/jakepenzak/Blog-Posts](https://github.com/jakepenzak/Blog-Posts)'
- en: '*I appreciate you reading my post! My posts on Medium seek to explore real-world
    and theoretical applications utilizing* ***econometric*** *and* ***statistical/machine
    learning*** *techniques. Additionally, I seek to provide posts on the theoretical
    underpinnings of various methodologies via theory and simulations. Most importantly,
    I write to learn and help others learn! I hope to make complex topics slightly
    more accessible to all. If you enjoyed this post, please consider* [***following
    me on Medium***](https://medium.com/@jakepenzak)*!*'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ä½ é˜…è¯»æˆ‘çš„æ–‡ç« ï¼æˆ‘åœ¨ Medium ä¸Šçš„æ–‡ç« æ—¨åœ¨æ¢ç´¢åˆ©ç”¨* ***è®¡é‡ç»æµå­¦*** *å’Œ* ***ç»Ÿè®¡/æœºå™¨å­¦ä¹ *** *æŠ€æœ¯çš„ç°å®ä¸–ç•Œå’Œç†è®ºåº”ç”¨ã€‚æ­¤å¤–ï¼Œæˆ‘è¿˜å¸Œæœ›é€šè¿‡ç†è®ºå’Œæ¨¡æ‹Ÿæä¾›å…³äºå„ç§æ–¹æ³•è®ºçš„ç†è®ºåŸºç¡€çš„æ–‡ç« ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘å†™ä½œæ˜¯ä¸ºäº†å­¦ä¹ å’Œå¸®åŠ©ä»–äººå­¦ä¹ ï¼æˆ‘å¸Œæœ›ä½¿å¤æ‚çš„è¯é¢˜å¯¹æ‰€æœ‰äººç¨å¾®æ›´æ˜“äºç†è§£ã€‚å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·è€ƒè™‘*
    [***å…³æ³¨æˆ‘åœ¨ Medium ä¸Šçš„è´¦å·***](https://medium.com/@jakepenzak)*ï¼*'

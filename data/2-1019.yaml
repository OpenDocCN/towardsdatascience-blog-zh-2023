- en: A guide to handling categorical variables in Python
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¤„ç† Python ä¸­åˆ†ç±»å˜é‡çš„æŒ‡å—
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/guide-to-handling-categorical-variables-in-python-854d0b65a6ae](https://towardsdatascience.com/guide-to-handling-categorical-variables-in-python-854d0b65a6ae)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/guide-to-handling-categorical-variables-in-python-854d0b65a6ae](https://towardsdatascience.com/guide-to-handling-categorical-variables-in-python-854d0b65a6ae)
- en: '*A guide on how to approach categorical variables for machine learning and
    data science purposes*'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '*å¦‚ä½•å¤„ç†åˆ†ç±»å˜é‡ä»¥ç”¨äºæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦çš„æŒ‡å—*'
- en: '[](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)[![Andrea
    D''Agostino](../Images/58c7c218815f25278aae59cea44d8771.png)](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)[](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)
    [Andrea D''Agostino](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)[![Andrea
    D''Agostino](../Images/58c7c218815f25278aae59cea44d8771.png)](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)[](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)
    [Andrea D''Agostino](https://medium.com/@theDrewDag?source=post_page-----854d0b65a6ae--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)
    Â·13 min readÂ·Jun 16, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----854d0b65a6ae--------------------------------)
    Â·13åˆ†é’Ÿé˜…è¯»Â·2023å¹´6æœˆ16æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/e99d8b89a83f713a851916579c9a484c.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e99d8b89a83f713a851916579c9a484c.png)'
- en: Photo by [Thomas Haas](https://unsplash.com/@thomashaas?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit)
    / [Unsplash](https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”± [Thomas Haas](https://unsplash.com/@thomashaas?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit)
    / [Unsplash](https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit)
    æä¾›
- en: Handling categorical variables in a data science or machine learning project
    is no easy task. This type of work requires deep knowledge of the field of application
    and a broad understanding of the multiple methodologies available.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ•°æ®ç§‘å­¦æˆ–æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­å¤„ç†åˆ†ç±»å˜é‡å¹¶éæ˜“äº‹ã€‚è¿™ç§å·¥ä½œéœ€è¦å¯¹åº”ç”¨é¢†åŸŸæœ‰æ·±å…¥çš„äº†è§£ï¼Œå¹¶ä¸”éœ€è¦å¯¹å¤šç§å¯ç”¨æ–¹æ³•æœ‰å¹¿æ³›çš„ç†è§£ã€‚
- en: For this reason, the present article will focus on explaining the following
    concepts
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: å‡ºäºè¿™ä¸ªåŸå› ï¼Œæœ¬æ–‡å°†é‡ç‚¹è§£é‡Šä»¥ä¸‹æ¦‚å¿µ
- en: '**what are categorical variables** and how to divide them into the different
    types'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ä»€ä¹ˆæ˜¯åˆ†ç±»å˜é‡**åŠå¦‚ä½•å°†å®ƒä»¬åˆ’åˆ†ä¸ºä¸åŒç±»å‹'
- en: how to convert them to **numeric value** based on their type
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚ä½•æ ¹æ®å®ƒä»¬çš„ç±»å‹å°†å®ƒä»¬è½¬æ¢ä¸º**æ•°å€¼**
- en: tools and technologies for their management mainly using **Sklearn**
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¤„ç†è¿™äº›å˜é‡çš„å·¥å…·å’ŒæŠ€æœ¯ä¸»è¦ä½¿ç”¨**Sklearn**
- en: Proper handling of categorical variables can greatly improve the result of our
    predictive model or analysis. In fact, most of the information relevant to learning
    and understanding data could be contained in the available categorical variables.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: é€‚å½“å¤„ç†åˆ†ç±»å˜é‡å¯ä»¥å¤§å¤§æ”¹å–„æˆ‘ä»¬é¢„æµ‹æ¨¡å‹æˆ–åˆ†æçš„ç»“æœã€‚äº‹å®ä¸Šï¼Œå­¦ä¹ å’Œç†è§£æ•°æ®çš„å¤§éƒ¨åˆ†ç›¸å…³ä¿¡æ¯å¯èƒ½éƒ½åŒ…å«åœ¨å¯ç”¨çš„åˆ†ç±»å˜é‡ä¸­ã€‚
- en: Just think of tabular data, split by the variable `gender` or by a certain `color`.
    These spits, based on the number of categories, can bring out significant differences
    between groups and which can inform the analyst or the learning algorithm.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³æƒ³è¡¨æ ¼æ•°æ®ï¼ŒæŒ‰å˜é‡`gender`æˆ–æŸç§`color`è¿›è¡Œåˆ’åˆ†ã€‚è¿™äº›åˆ’åˆ†åŸºäºç±»åˆ«æ•°é‡ï¼Œå¯ä»¥æ­ç¤ºç»„ä¹‹é—´çš„æ˜¾è‘—å·®å¼‚ï¼Œä»è€Œä¸ºåˆ†æå¸ˆæˆ–å­¦ä¹ ç®—æ³•æä¾›ä¿¡æ¯ã€‚
- en: Letâ€™s start by defining what they are and how they can present themselves.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»å®šä¹‰åˆ†ç±»å˜é‡æ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬å¦‚ä½•è¡¨ç°è‡ªå·±å¼€å§‹ã€‚
- en: Definition of categorical variable
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆ†ç±»å˜é‡çš„å®šä¹‰
- en: Categorical variables are a type of variable used in statistics and data science
    to represent qualitative or nominal data. These variables can be defined as a
    class or category of data that cannot be quantified continuously, but only discretely.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†ç±»å˜é‡æ˜¯ç”¨äºç»Ÿè®¡å­¦å’Œæ•°æ®ç§‘å­¦ä¸­çš„ä¸€ç§å˜é‡ï¼Œç”¨äºè¡¨ç¤ºå®šæ€§æˆ–åä¹‰æ•°æ®ã€‚è¿™äº›å˜é‡å¯ä»¥å®šä¹‰ä¸ºä¸€ç§ç±»åˆ«æˆ–æ•°æ®ç±»åˆ«ï¼Œè¿™äº›æ•°æ®æ— æ³•è¿ç»­é‡åŒ–ï¼Œè€Œåªèƒ½ç¦»æ•£è¡¨ç¤ºã€‚
- en: For example, an example of a categorical variable might be a **personâ€™s eye
    color,** which can be blue, green, or brown.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆ†ç±»å˜é‡çš„ä¾‹å­å¯èƒ½æ˜¯**ä¸€ä¸ªäººçš„çœ¼ç›é¢œè‰²ï¼Œ** å¯èƒ½æ˜¯è“è‰²ã€ç»¿è‰²æˆ–æ£•è‰²ã€‚
- en: Most learning models donâ€™t work with data in a categorical format. We must first
    convert them into numeric format so that the information is preserved.
  id: totrans-19
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¤§å¤šæ•°å­¦ä¹ æ¨¡å‹æ— æ³•å¤„ç†åˆ†ç±»æ ¼å¼çš„æ•°æ®ã€‚æˆ‘ä»¬å¿…é¡»å…ˆå°†å®ƒä»¬è½¬æ¢ä¸ºæ•°å­—æ ¼å¼ï¼Œä»¥ä¾¿ä¿¡æ¯å¾—ä»¥ä¿ç•™ã€‚
- en: 'Categorical variables can be classified into two types:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†ç±»å˜é‡å¯ä»¥åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š
- en: Nominal
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åä¹‰å‹
- en: Ordinal
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ‰åº
- en: '**Nominal variables** are variables that are not constrained by a precise order.
    Gender, color, or brands are examples of nominal variables since they are not
    sortable.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**åä¹‰å˜é‡**æ˜¯æ²¡æœ‰ä¸¥æ ¼é¡ºåºé™åˆ¶çš„å˜é‡ã€‚æ€§åˆ«ã€é¢œè‰²æˆ–å“ç‰Œå°±æ˜¯åä¹‰å˜é‡çš„ä¾‹å­ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½æ’åºã€‚'
- en: '**Ordinal variables** are instead categorical variables divided into logically
    orderable levels. A column in a dataset that consists of levels such as *First,
    Second, and Third* can be considered an ordinal categorical variable.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '**æœ‰åºå˜é‡**æ˜¯å°†åˆ†ç±»å˜é‡åˆ’åˆ†ä¸ºé€»è¾‘ä¸Šå¯æ’åºçš„çº§åˆ«çš„å˜é‡ã€‚æ•°æ®é›†ä¸­åŒ…å«*ç¬¬ä¸€ã€ç¬¬äºŒå’Œç¬¬ä¸‰*ç­‰çº§åˆ«çš„åˆ—å¯ä»¥è¢«è®¤ä¸ºæ˜¯æœ‰åºçš„åˆ†ç±»å˜é‡ã€‚'
- en: You can go deeper into the breakdown of categorical variables by considering
    **binary and cyclic variables.**
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥é€šè¿‡è€ƒè™‘**äºŒå…ƒå˜é‡å’Œå¾ªç¯å˜é‡**æ¥æ·±å…¥äº†è§£åˆ†ç±»å˜é‡çš„åˆ†è§£ã€‚
- en: 'A **binary variable** is simple to understand: it is a categorical variable
    that can only take on two values.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**äºŒå…ƒå˜é‡**å¾ˆç®€å•ç†è§£ï¼šå®ƒæ˜¯ä¸€ä¸ªåªèƒ½å–ä¸¤ä¸ªå€¼çš„åˆ†ç±»å˜é‡ã€‚'
- en: A **cyclic variable**, on the other hand, is characterized by a repetition of
    its values. For example, the days of the week are cyclical, and so are the seasons.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**å¾ªç¯å˜é‡**åˆ™å…·æœ‰å€¼çš„é‡å¤ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œæ˜ŸæœŸå‡ æ˜¯å¾ªç¯çš„ï¼Œå­£èŠ‚ä¹Ÿæ˜¯å¦‚æ­¤ã€‚'
- en: How to transform categorical variables
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¦‚ä½•è½¬æ¢åˆ†ç±»å˜é‡
- en: Now that weâ€™ve defined what categorical variables are and what they look like,
    letâ€™s tackle the question of transforming them using a practical example â€” a Kaggle
    dataset called *cat-in-the-dat*.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å®šä¹‰äº†åˆ†ç±»å˜é‡æ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬çš„æ ·å­ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è§£å†³è½¬åŒ–å®ƒä»¬çš„é—®é¢˜â€”â€”ä¸€ä¸ªåä¸º*cat-in-the-dat*çš„Kaggleæ•°æ®é›†ã€‚
- en: The dataset
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ•°æ®é›†
- en: This is an open source dataset at the basis of an introductory competition to
    the management and modeling of categorical variables, called the Categorical Feature
    Encoding Challenge II. You can download the data directly from the link below.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªå¼€æºæ•°æ®é›†ï¼Œä½œä¸ºå¯¹åˆ†ç±»å˜é‡ç®¡ç†å’Œå»ºæ¨¡çš„å…¥é—¨ç«èµ›åŸºç¡€ï¼Œç§°ä¸ºåˆ†ç±»ç‰¹å¾ç¼–ç æŒ‘æˆ˜ IIã€‚ä½ å¯ä»¥ä»ä¸‹é¢çš„é“¾æ¥ç›´æ¥ä¸‹è½½æ•°æ®ã€‚
- en: '[](https://www.kaggle.com/c/cat-in-the-dat-ii?source=post_page-----854d0b65a6ae--------------------------------)
    [## Categorical Feature Encoding Challenge II'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://www.kaggle.com/c/cat-in-the-dat-ii?source=post_page-----854d0b65a6ae--------------------------------)
    [## åˆ†ç±»ç‰¹å¾ç¼–ç æŒ‘æˆ˜ II'
- en: Binary classification, with every feature a categorical (and interactions!)
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: äºŒå…ƒåˆ†ç±»ï¼Œæ¯ä¸ªç‰¹å¾éƒ½æ˜¯åˆ†ç±»çš„ï¼ˆä»¥åŠäº¤äº’ï¼ï¼‰
- en: www.kaggle.com](https://www.kaggle.com/c/cat-in-the-dat-ii?source=post_page-----854d0b65a6ae--------------------------------)
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: www.kaggle.com](https://www.kaggle.com/c/cat-in-the-dat-ii?source=post_page-----854d0b65a6ae--------------------------------)
- en: The peculiarity of this dataset is that it contains exclusively categorical
    data. So it becomes the perfect use case for this guide. It includes nominal,
    ordinal, cyclic, and binary variables.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ•°æ®é›†çš„ç‰¹æ®Šæ€§åœ¨äºå®ƒä»…åŒ…å«åˆ†ç±»æ•°æ®ã€‚å› æ­¤ï¼Œå®ƒæˆä¸ºæœ¬æŒ‡å—çš„å®Œç¾ä½¿ç”¨æ¡ˆä¾‹ã€‚å®ƒåŒ…æ‹¬åä¹‰å‹ã€åºæ•°å‹ã€å¾ªç¯å‹å’ŒäºŒå…ƒå˜é‡ã€‚
- en: We will see techniques for transforming each variable into a format usable by
    a learning model.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†çœ‹åˆ°å°†æ¯ä¸ªå˜é‡è½¬æ¢ä¸ºå­¦ä¹ æ¨¡å‹å¯ç”¨æ ¼å¼çš„æŠ€æœ¯ã€‚
- en: The dataset looks like this
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®é›†å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '![](../Images/7dfe5816387a98c71f30b084a1b0cf26.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7dfe5816387a98c71f30b084a1b0cf26.png)'
- en: Image by author.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚
- en: Since the target variable can only take on two values, this is a binary classification
    task. We will use the AUC metric to evaluate our model.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºç›®æ ‡å˜é‡åªèƒ½å–ä¸¤ä¸ªå€¼ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªäºŒå…ƒåˆ†ç±»ä»»åŠ¡ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ AUC æŒ‡æ ‡æ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚
- en: Now we are going to apply techniques for managing categorical variables using
    the mentioned dataset.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å°†åº”ç”¨å¤„ç†åˆ†ç±»å˜é‡çš„æŠ€æœ¯ï¼Œä½¿ç”¨ä¸Šè¿°æåˆ°çš„æ•°æ®é›†ã€‚
- en: 1\. Label Encoding (mapping to an arbitrary number)
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1\. æ ‡ç­¾ç¼–ç ï¼ˆæ˜ å°„åˆ°ä»»æ„æ•°å­—ï¼‰
- en: The simplest technique there is for converting a category into a usable format
    is to assign each category to an arbitrary number.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: å°†åˆ†ç±»è½¬æ¢ä¸ºå¯ç”¨æ ¼å¼çš„æœ€ç®€å•æ–¹æ³•æ˜¯å°†æ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªä»»æ„æ•°å­—ã€‚
- en: Take for example the `ord_2` column which contains the categories
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œ`ord_2`åˆ—åŒ…å«çš„ç±»åˆ«
- en: '[PRE0]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The mapping could be done like this using Python and Pandas:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: å¯ä»¥ä½¿ç”¨ Python å’Œ Pandas è¿›è¡Œè¿™æ ·çš„æ˜ å°„ï¼š
- en: '[PRE1]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'However, this method has a problem: you have to manually declare the mapping.
    For a small number of categories this is not a problem, but for a large number
    it could be.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼šä½ å¿…é¡»æ‰‹åŠ¨å£°æ˜æ˜ å°„ã€‚å¯¹äºå°‘é‡ç±»åˆ«è¿™ä¸æ˜¯é—®é¢˜ï¼Œä½†å¯¹äºå¤§é‡ç±»åˆ«å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚
- en: For this we will use Scikit-Learn and the `LabelEncoder` object to achieve the
    same result in a more flexible way.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Scikit-Learn å’Œ `LabelEncoder` å¯¹è±¡ä»¥æ›´çµæ´»çš„æ–¹å¼å®ç°ç›¸åŒçš„ç»“æœã€‚
- en: '[PRE2]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Mapping is controlled by Sklearn. We can visualize it like this:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜ å°„ç”± Sklearn æ§åˆ¶ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å¯è§†åŒ–å®ƒï¼š
- en: '[PRE3]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note the `.fillna(â€œNONE")` in the code snippet above. In fact, Sklearnâ€™s label
    encoder does not handle empty values and will give an error when applying it if
    any are found.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­çš„ `.fillna(â€œNONE")`ã€‚å®é™…ä¸Šï¼ŒSklearn çš„æ ‡ç­¾ç¼–ç å™¨ä¸å¤„ç†ç©ºå€¼ï¼Œå¦‚æœå‘ç°ä»»ä½•ç©ºå€¼ï¼Œåº”ç”¨æ—¶ä¼šäº§ç”Ÿé”™è¯¯ã€‚
- en: One of the most important things to keep in mind for the correct handling of
    categorical variables is to always handle the empty values. In fact, most of the
    relevant techniques donâ€™t work if these arenâ€™t taken care of.
  id: totrans-54
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ­£ç¡®å¤„ç†åˆ†ç±»å˜é‡æ—¶æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯å§‹ç»ˆå¤„ç†ç©ºå€¼ã€‚å®é™…ä¸Šï¼Œå¤§å¤šæ•°ç›¸å…³æŠ€æœ¯åœ¨æœªå¤„ç†è¿™äº›å€¼æ—¶æ— æ³•æ­£å¸¸å·¥ä½œã€‚
- en: 'The label encoder maps arbitrary numbers to each category in the column, without
    an explicit declaration of the mapping. This is convenient, but introduces a problem
    for some predictive models: *it introduces the need to scale the data if the column
    is not the target one*.'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: æ ‡ç­¾ç¼–ç å™¨å°†ä»»æ„æ•°å­—æ˜ å°„åˆ°åˆ—ä¸­çš„æ¯ä¸ªç±»åˆ«ï¼Œè€Œæ— éœ€æ˜¾å¼å£°æ˜æ˜ å°„ã€‚è¿™å¾ˆæ–¹ä¾¿ï¼Œä½†å¯¹æŸäº›é¢„æµ‹æ¨¡å‹å¼•å…¥äº†ä¸€ä¸ªé—®é¢˜ï¼š*å¦‚æœåˆ—ä¸æ˜¯ç›®æ ‡åˆ—ï¼Œå®ƒå¼•å…¥äº†éœ€è¦å¯¹æ•°æ®è¿›è¡Œç¼©æ”¾çš„éœ€æ±‚*ã€‚
- en: In fact, machine learning beginners often ask what the difference is between
    label encoder and one hot encoder, which we will see shortly. **The label encoder,
    by design, should be applied to the labels, ie the target variable we want to
    predict and not to the other columns.**
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å®é™…ä¸Šï¼Œæœºå™¨å­¦ä¹ åˆå­¦è€…ç»å¸¸é—®æ ‡ç­¾ç¼–ç å™¨å’Œ one hot ç¼–ç å™¨ä¹‹é—´çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å¾ˆå¿«ä¼šçœ‹åˆ°ã€‚**æ ‡ç­¾ç¼–ç å™¨ä»è®¾è®¡ä¸Šåº”åº”ç”¨äºæ ‡ç­¾ï¼Œå³æˆ‘ä»¬æƒ³è¦é¢„æµ‹çš„ç›®æ ‡å˜é‡ï¼Œè€Œä¸æ˜¯å…¶ä»–åˆ—ã€‚**
- en: Having said that, some models also very relevant in the field work well even
    with an encoding of this type. Iâ€™m talking about tree models, among which XGBoost
    and LightGBM stand out.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: è¯´åˆ°è¿™ä¸€ç‚¹ï¼Œä¸€äº›åœ¨é¢†åŸŸå†…éå¸¸ç›¸å…³çš„æ¨¡å‹å³ä½¿ä½¿ç”¨è¿™ç§ç±»å‹çš„ç¼–ç ä¹Ÿèƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚æˆ‘æŒ‡çš„æ˜¯æ ‘æ¨¡å‹ï¼Œå…¶ä¸­ XGBoost å’Œ LightGBM è„±é¢–è€Œå‡ºã€‚
- en: So feel free to use label encoders if you decide to use tree models, but otherwise,
    we have to use one hot encoding.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œå¦‚æœä½ å†³å®šä½¿ç”¨æ ‘æ¨¡å‹ï¼Œå¯ä»¥è‡ªç”±ä½¿ç”¨æ ‡ç­¾ç¼–ç å™¨ï¼Œä½†å¦åˆ™ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ one hot ç¼–ç ã€‚
- en: 2\. One Hot Encoding
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2\. One Hot ç¼–ç 
- en: As I already mentioned in my article about [vector representations in machine
    learning](https://medium.com/towards-data-science/vector-representations-for-machine-learning-5047c50aaeff),
    one hot encoding is a very common and famous vectorization technique (i.e. converting
    a text into a number).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘åœ¨æˆ‘çš„æ–‡ç« ä¸­æåˆ°çš„[æœºå™¨å­¦ä¹ ä¸­çš„å‘é‡è¡¨ç¤º](https://medium.com/towards-data-science/vector-representations-for-machine-learning-5047c50aaeff)ï¼Œone
    hot ç¼–ç æ˜¯ä¸€ç§éå¸¸å¸¸è§ä¸”è‘—åçš„å‘é‡åŒ–æŠ€æœ¯ï¼ˆå³å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—ï¼‰ã€‚
- en: 'It works like this: for each category present, a square matrix is created whose
    only possible values are 0 and 1\. This matrix informs the model that among all
    possible categories, this observed row has the value denoted by 1.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šå¯¹äºæ¯ä¸ªå­˜åœ¨çš„ç±»åˆ«ï¼Œåˆ›å»ºä¸€ä¸ªä»…å¯èƒ½åŒ…å« 0 å’Œ 1 çš„æ–¹é˜µã€‚è¿™ä¸ªçŸ©é˜µé€šçŸ¥æ¨¡å‹ï¼Œåœ¨æ‰€æœ‰å¯èƒ½çš„ç±»åˆ«ä¸­ï¼Œè¿™ä¸€è§‚å¯Ÿåˆ°çš„è¡Œå…·æœ‰ç”± 1 è¡¨ç¤ºçš„å€¼ã€‚
- en: 'An example:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªä¾‹å­ï¼š
- en: '[PRE4]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The array is of size *n_categories*. This is very useful information, because
    one hot encoding typically requires **a sparse representation** of the converted
    data.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°ç»„çš„å¤§å°ä¸º *n_categories*ã€‚è¿™æ˜¯éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå› ä¸º one hot ç¼–ç é€šå¸¸éœ€è¦**ç¨€ç–è¡¨ç¤º**è½¬æ¢åçš„æ•°æ®ã€‚
- en: What does it mean? It means that for large numbers of categories, the matrix
    could become equally large. Being populated only by values of 0 and 1 and since
    only one of the positions can be populated by a 1, this makes the one hot representation
    very redundant and cumbersome.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿè¿™æ„å‘³ç€å¯¹äºå¤§é‡ç±»åˆ«ï¼ŒçŸ©é˜µä¹Ÿå¯èƒ½å˜å¾—éå¸¸å¤§ã€‚ç”±äºçŸ©é˜µä»…ç”± 0 å’Œ 1 ç»„æˆï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªä½ç½®å¯ä»¥è¢« 1 å¡«å……ï¼Œè¿™ä½¿å¾— one hot è¡¨ç¤ºéå¸¸å†—ä½™å’Œç¹çã€‚
- en: A sparse matrix solves this problem â€” only the positions of the 1â€™s are saved,
    while values equal to 0 are not saved. This simplifies the mentioned problem and
    allows us to save a huge array of information in exchange for very little memory
    usage.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç¨€ç–çŸ©é˜µè§£å†³äº†è¿™ä¸ªé—®é¢˜â€”â€”åªä¿å­˜ 1 çš„ä½ç½®ï¼Œè€Œä¸ä¿å­˜å€¼ä¸º 0 çš„ä½ç½®ã€‚è¿™ç®€åŒ–äº†ä¸Šè¿°é—®é¢˜ï¼Œå¹¶ä½¿æˆ‘ä»¬èƒ½å¤Ÿä»¥æå°‘çš„å†…å­˜ä½¿ç”¨é‡ä¿å­˜å¤§é‡çš„ä¿¡æ¯ã€‚
- en: Letâ€™s see what such an array looks like in Python, applying the code from before
    again
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹åœ¨ Python ä¸­è¿™æ ·ä¸€ä¸ªæ•°ç»„çš„æ ·å­ï¼Œå†æ¬¡åº”ç”¨ä¹‹å‰çš„ä»£ç ã€‚
- en: '[PRE5]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Python returns an object by default, not a list of values. To get such a list,
    you need to use `.toarray()`
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Python é»˜è®¤è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯å€¼åˆ—è¡¨ã€‚è¦è·å¾—è¿™æ ·çš„åˆ—è¡¨ï¼Œä½ éœ€è¦ä½¿ç”¨ `.toarray()`
- en: '[PRE6]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Donâ€™t worry if you donâ€™t fully understand the concept: we will soon see how
    to apply the label and one hot encoder to the dataset to train a predictive model.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä¸å®Œå…¨ç†è§£è¿™ä¸ªæ¦‚å¿µä¹Ÿä¸ç”¨æ‹…å¿ƒï¼šæˆ‘ä»¬å¾ˆå¿«ä¼šçœ‹åˆ°å¦‚ä½•å°†æ ‡ç­¾ç¼–ç å’Œç‹¬çƒ­ç¼–ç åº”ç”¨äºæ•°æ®é›†ï¼Œä»¥è®­ç»ƒé¢„æµ‹æ¨¡å‹ã€‚
- en: Label encoding and one hot encoding are the most important techniques for handling
    categorical variables. Knowing these two techniques will allow you to handle most
    cases that involve categorical variables.
  id: totrans-72
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ ‡ç­¾ç¼–ç å’Œç‹¬çƒ­ç¼–ç æ˜¯å¤„ç†åˆ†ç±»å˜é‡çš„æœ€é‡è¦æŠ€æœ¯ã€‚æŒæ¡è¿™ä¸¤ç§æŠ€æœ¯å°†ä½¿ä½ èƒ½å¤Ÿå¤„ç†å¤§å¤šæ•°æ¶‰åŠåˆ†ç±»å˜é‡çš„æƒ…å†µã€‚
- en: 3\. Transformations and aggregations
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3\. è½¬æ¢å’Œèšåˆã€‚
- en: Another method of converting from categorical to numeric format is to perform
    a transformation or aggregation on the variable.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: å°†åˆ†ç±»æ•°æ®è½¬æ¢ä¸ºæ•°å€¼æ ¼å¼çš„å¦ä¸€ç§æ–¹æ³•æ˜¯å¯¹å˜é‡è¿›è¡Œè½¬æ¢æˆ–èšåˆã€‚
- en: By grouping with `.groupby()` it is possible to use the count of the values
    present in the column as the output of the transformation.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡`.groupby()`åˆ†ç»„ï¼Œå¯ä»¥å°†åˆ—ä¸­å­˜åœ¨å€¼çš„è®¡æ•°ç”¨ä½œè½¬æ¢çš„è¾“å‡ºã€‚
- en: '[PRE7]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: using `.transform()` we can replace these numbers to the corresponding cell
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`.transform()`æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ•°å­—æ›¿æ¢åˆ°ç›¸åº”çš„å•å…ƒæ ¼ä¸­ã€‚
- en: '[PRE8]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: It is possible to apply this logic also with other mathematical operations â€”
    the method that most improves the performance of our model should be tested.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ•°å­¦æ“ä½œåº”ç”¨è¿™ç§é€»è¾‘â€”â€”åº”æµ‹è¯•æœ€èƒ½æé«˜æ¨¡å‹æ€§èƒ½çš„æ–¹æ³•ã€‚
- en: 4\. Create new categorical features from categorical variables
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4\. ä»åˆ†ç±»å˜é‡åˆ›å»ºæ–°çš„åˆ†ç±»ç‰¹å¾ã€‚
- en: We look at the ord_1 column together with ord_2
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°† ord_1 åˆ—ä¸ ord_2 ä¸€èµ·æŸ¥çœ‹ã€‚
- en: '![](../Images/b9ed1890cb1951a94860379758143a9f.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b9ed1890cb1951a94860379758143a9f.png)'
- en: image by author.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºäºä½œè€…ã€‚
- en: We can create new categorical variables by merging existing variables. For example,
    we can merge ord_1 with ord_2 to create a new feature
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆå¹¶ç°æœ‰å˜é‡æ¥åˆ›å»ºæ–°çš„åˆ†ç±»å˜é‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°† ord_1 ä¸ ord_2 åˆå¹¶ï¼Œä»¥åˆ›å»ºä¸€ä¸ªæ–°ç‰¹å¾ã€‚
- en: '[PRE9]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This technique can be applied in practically any case. The idea that must guide
    the analyst is to improve the performance of the model by adding information that
    was originally difficult to understand to the learning model.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æŠ€æœ¯å‡ ä¹å¯ä»¥åº”ç”¨äºä»»ä½•æƒ…å†µã€‚æŒ‡å¯¼åˆ†æå¸ˆçš„æ€æƒ³æ˜¯é€šè¿‡å‘å­¦ä¹ æ¨¡å‹ä¸­æ·»åŠ åŸæœ¬éš¾ä»¥ç†è§£çš„ä¿¡æ¯æ¥æé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚
- en: 5\. Use NaN as a categorical variable
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5\. å°† NaN ä½œä¸ºåˆ†ç±»å˜é‡ä½¿ç”¨ã€‚
- en: Very often null values are removed. This is typically not a move I recommend,
    **as the NaNs contain potentially useful information to our model.**
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: å¾ˆå¤šæ—¶å€™ï¼Œç©ºå€¼ä¼šè¢«åˆ é™¤ã€‚æˆ‘é€šå¸¸ä¸æ¨èè¿™æ ·åšï¼Œ**å› ä¸º NaNs å¯èƒ½åŒ…å«å¯¹æˆ‘ä»¬çš„æ¨¡å‹æœ‰ç”¨çš„ä¿¡æ¯**ã€‚
- en: One solution is to treat NaNs as a category in their own right.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°† NaNs è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç±»åˆ«ã€‚
- en: Letâ€™s look at the ord_2 column again
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: å†æ¬¡æŸ¥çœ‹ ord_2 åˆ—ã€‚
- en: '[PRE10]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Now letâ€™s try applying the `.fillna(â€œNONE")` to see how many empty cells exist
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å°è¯•åº”ç”¨`.fillna(â€œNONE")`ï¼Œä»¥æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªç©ºå•å…ƒæ ¼å­˜åœ¨ã€‚
- en: '[PRE11]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: As a percentage, NONE represents about 3% of the entire column. Itâ€™s a pretty
    noticeable amount. Exploiting the NaN makes even more sense and can be done with
    the One Hot Encoder mentioned earlier.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºç™¾åˆ†æ¯”ï¼ŒNONE çº¦å æ•´åˆ—çš„ 3%ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å½“æ˜¾è‘—çš„é‡ã€‚åˆ©ç”¨ NaN æ›´æœ‰æ„ä¹‰ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¹‹å‰æåˆ°çš„ç‹¬çƒ­ç¼–ç æ¥å®Œæˆã€‚
- en: Tracking rare categories
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è·Ÿè¸ªç¨€æœ‰ç±»åˆ«ã€‚
- en: 'Letâ€™s remember what the OneHotEncoder does: it creates a sparse matrix whose
    number of columns and rows is equal to the number of unique categories in the
    referenced column. *This means that we must also take into account the categories
    that could be present in the test set and that could be absent in the train set.*'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è®°ä½ OneHotEncoder çš„ä½œç”¨ï¼šå®ƒåˆ›å»ºä¸€ä¸ªç¨€ç–çŸ©é˜µï¼Œå…¶åˆ—æ•°å’Œè¡Œæ•°ç­‰äºå¼•ç”¨åˆ—ä¸­å”¯ä¸€ç±»åˆ«çš„æ•°é‡ã€‚*è¿™æ„å‘³ç€æˆ‘ä»¬è¿˜å¿…é¡»è€ƒè™‘å¯èƒ½å­˜åœ¨äºæµ‹è¯•é›†ä¸­ä½†å¯èƒ½åœ¨è®­ç»ƒé›†ä¸­ç¼ºå¤±çš„ç±»åˆ«*ã€‚
- en: The situation is similar for the LabelEncoder â€” there may be categories in the
    test set but which are not present in the training set and this could create problems
    during the transformation.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº LabelEncoder æƒ…å†µç±»ä¼¼â€”â€”æµ‹è¯•é›†ä¸­å¯èƒ½å­˜åœ¨ä½†è®­ç»ƒé›†ä¸­æ²¡æœ‰çš„ç±»åˆ«ï¼Œè¿™å¯èƒ½åœ¨è½¬æ¢è¿‡ç¨‹ä¸­é€ æˆé—®é¢˜ã€‚
- en: We solve this problem by concatenating the datasets. This will allow us to apply
    the encoders to all data and not just the training data.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é€šè¿‡è¿æ¥æ•°æ®é›†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™å°†å…è®¸æˆ‘ä»¬å°†ç¼–ç å™¨åº”ç”¨äºæ‰€æœ‰æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯è®­ç»ƒæ•°æ®ã€‚
- en: '[PRE12]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![](../Images/e8556ff3c302b82438c4094d26f5789f.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e8556ff3c302b82438c4094d26f5789f.png)'
- en: Image by author.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºäºä½œè€…ã€‚
- en: This methodology helps us if we have the test set. If we donâ€™t have the test
    set, we will take into account a value like NONE when a new category becomes part
    of our training set.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æœ‰æµ‹è¯•é›†ï¼Œè¿™ç§æ–¹æ³•å¯¹æˆ‘ä»¬å¾ˆæœ‰å¸®åŠ©ã€‚å¦‚æœæ²¡æœ‰æµ‹è¯•é›†ï¼Œå½“æ–°ç±»åˆ«æˆä¸ºè®­ç»ƒé›†çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œæˆ‘ä»¬å°†è€ƒè™‘ä½¿ç”¨ç±»ä¼¼ NONE çš„å€¼ã€‚
- en: Model categorical data
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¨¡å‹åˆ†ç±»æ•°æ®ã€‚
- en: Now letâ€™s move on to the training of a simple model. We will follow the steps
    from the article on how to design and implement a cross-validation at the following
    link ğŸ‘‡
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹è®­ç»ƒä¸€ä¸ªç®€å•çš„æ¨¡å‹ã€‚æˆ‘ä»¬å°†æŒ‰ç…§ä»¥ä¸‹é“¾æ¥ä¸­å…³äºå¦‚ä½•è®¾è®¡å’Œå®ç°äº¤å‰éªŒè¯çš„æ­¥éª¤è¿›è¡Œ ğŸ‘‡
- en: '[](/what-is-cross-validation-in-machine-learning-14d2a509d6a5?source=post_page-----854d0b65a6ae--------------------------------)
    [## What is cross-validation in machine learning'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/what-is-cross-validation-in-machine-learning-14d2a509d6a5?source=post_page-----854d0b65a6ae--------------------------------)
    [## ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ä¸­çš„äº¤å‰éªŒè¯'
- en: Learn what cross-validation is â€” a fundamental technique for building generalizable
    models
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: äº†è§£ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯â€”â€”æ„å»ºé€šç”¨æ¨¡å‹çš„åŸºæœ¬æŠ€æœ¯
- en: towardsdatascience.com](/what-is-cross-validation-in-machine-learning-14d2a509d6a5?source=post_page-----854d0b65a6ae--------------------------------)
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/what-is-cross-validation-in-machine-learning-14d2a509d6a5?source=post_page-----854d0b65a6ae--------------------------------)
- en: We start from scratch, importing our data and creating our folds with Sklearnâ€™s
    `StratifiedKFold`.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»å¤´å¼€å§‹ï¼Œå¯¼å…¥æ•°æ®å¹¶ä½¿ç”¨Sklearnçš„`StratifiedKFold`åˆ›å»ºæŠ˜å ã€‚
- en: '[PRE13]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This little snippet of code will create a Pandas dataframe with 5 groups to
    test our model against.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ®µå°ä»£ç å°†åˆ›å»ºä¸€ä¸ªåŒ…å«5ä¸ªç»„çš„Pandasæ•°æ®æ¡†ï¼Œä»¥æµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹ã€‚
- en: '![](../Images/bb127860185f608bac6b4229aa4ab9cf.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bb127860185f608bac6b4229aa4ab9cf.png)'
- en: Image by author.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾åƒã€‚
- en: Now letâ€™s define a function that will test a logistic regression model on each
    group.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæµ‹è¯•æ¯ä¸ªç»„ä¸Šçš„é€»è¾‘å›å½’æ¨¡å‹ã€‚
- en: '[PRE14]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: I invite the interested reader to read the article on cross-validation to understand
    in more detail the functioning of the code shown.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘é‚€è¯·æ„Ÿå…´è¶£çš„è¯»è€…é˜…è¯»æœ‰å…³äº¤å‰éªŒè¯çš„æ–‡ç« ï¼Œä»¥æ›´è¯¦ç»†åœ°ç†è§£æ‰€å±•ç¤ºä»£ç çš„å·¥ä½œåŸç†ã€‚
- en: Now letâ€™s see how instead to apply a tree model like XGBoost, which also works
    well with a LabelEncoder.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åº”ç”¨åƒXGBoostè¿™æ ·çš„æ ‘æ¨¡å‹ï¼Œå®ƒä¹Ÿä¸LabelEncoderé…åˆå¾—å¾ˆå¥½ã€‚
- en: '[PRE15]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Conclusions
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: 'In conclusion, there are also other techniques worth mentioning for handling
    categorical variables:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ä¹‹ï¼Œè¿˜æœ‰å…¶ä»–å€¼å¾—ä¸€æçš„æŠ€æœ¯æ¥å¤„ç†åˆ†ç±»å˜é‡ï¼š
- en: '**Target-based encoding**, where the category is converted into the average
    value assumed by the target variable in correspondence with it'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åŸºäºç›®æ ‡çš„ç¼–ç **ï¼Œå³å°†ç±»åˆ«è½¬æ¢ä¸ºç›®æ ‡å˜é‡åœ¨å¯¹åº”ç±»åˆ«ä¸‹çš„å¹³å‡å€¼'
- en: '[**The embeddings of a neural network**](https://medium.com/towards-data-science/vector-representations-for-machine-learning-5047c50aaeff),
    which can be used to represent the textual entity'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[**ç¥ç»ç½‘ç»œçš„åµŒå…¥**](https://medium.com/towards-data-science/vector-representations-for-machine-learning-5047c50aaeff)ï¼Œå¯ç”¨äºè¡¨ç¤ºæ–‡æœ¬å®ä½“'
- en: In summary, here are the essential steps for a correct management of categorical
    variables
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ç»“ä¸€ä¸‹ï¼Œæ­£ç¡®ç®¡ç†åˆ†ç±»å˜é‡çš„å…³é”®æ­¥éª¤å¦‚ä¸‹
- en: always treat null values
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»æ˜¯å¤„ç†ç©ºå€¼
- en: apply LabelEncoder or OneHotEncoder based on the type of variable and template
    we want to use
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ ¹æ®å˜é‡çš„ç±»å‹å’Œæˆ‘ä»¬æƒ³ä½¿ç”¨çš„æ¨¡æ¿åº”ç”¨LabelEncoderæˆ–OneHotEncoder
- en: reason in terms of variable enrichment, considering NaN or NONE as categorical
    variables that can inform the model
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»å˜é‡ä¸°å¯Œçš„è§’åº¦è€ƒè™‘ï¼Œå°†NaNæˆ–NONEè§†ä¸ºå¯ä»¥å‘ŠçŸ¥æ¨¡å‹çš„åˆ†ç±»å˜é‡
- en: Model the data!
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å»ºæ¨¡æ•°æ®ï¼
- en: Thank you for your time,
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢ä½ çš„æ—¶é—´ï¼Œ
- en: Andrea
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: å®‰å¾·çƒˆäºš
- en: Recommended Reads
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¨èé˜…è¯»
- en: For the interested, here are a list of books that I recommended for each ML-related
    topic. There are ESSENTIAL books in my opinion and have greatly impacted my professional
    career.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºæ„Ÿå…´è¶£çš„è¯»è€…ï¼Œä»¥ä¸‹æ˜¯æˆ‘æ¨èçš„æ¯ä¸ªæœºå™¨å­¦ä¹ ç›¸å…³ä¸»é¢˜çš„ä¹¦å•ã€‚è¿™äº›ä¹¦åœ¨æˆ‘çœ‹æ¥æ˜¯**å¿…ä¸å¯å°‘**çš„ï¼Œå¹¶ä¸”å¯¹æˆ‘çš„èŒä¸šç”Ÿæ¶¯äº§ç”Ÿäº†é‡å¤§å½±å“ã€‚
- en: '*Disclaimer: these are Amazon affiliate links. I will receive a small commission
    from Amazon for referring you these items. Your experience wonâ€™t change and you
    wonâ€™t be charged more, but it will help me scale my business and produce even
    more content around AI.*'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '*å…è´£å£°æ˜ï¼šè¿™äº›æ˜¯äºšé©¬é€Šçš„é™„å±é“¾æ¥ã€‚æˆ‘å°†ä»äºšé©¬é€Šè·å¾—å°‘é‡ä½£é‡‘ï¼Œä»¥æ¨èè¿™äº›å•†å“ç»™ä½ ã€‚ä½ çš„ä½“éªŒä¸ä¼šæ”¹å˜ï¼Œä½ ä¹Ÿä¸ä¼šè¢«å¤šæ”¶è´¹ï¼Œä½†è¿™å°†å¸®åŠ©æˆ‘æ‰©å¤§ä¸šåŠ¡ï¼Œå¹¶åˆ¶ä½œæ›´å¤šå…³äºAIçš„å†…å®¹ã€‚*'
- en: '**Intro to ML:** [*Confident Data Skills: Master the Fundamentals of Working
    with Data and Supercharge Your Career*](https://amzn.to/3ZzKTz6)by Kirill Eremenko'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœºå™¨å­¦ä¹ ç®€ä»‹ï¼š** [*è‡ªä¿¡çš„æ•°æ®æŠ€èƒ½ï¼šæŒæ¡æ•°æ®å·¥ä½œçš„åŸºç¡€ï¼Œæå‡ä½ çš„èŒä¸šç”Ÿæ¶¯*](https://amzn.to/3ZzKTz6)ä½œè€…Kirill
    Eremenko'
- en: '**Sklearn / TensorFlow:** [*Hands-On Machine Learning with Scikit-Learn, Keras,
    and TensorFlow*](https://amzn.to/433F4Nm) by Aurelien GÃ©ron'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Sklearn / TensorFlowï¼š** [*ç”¨Scikit-Learnã€Keraså’ŒTensorFlowè¿›è¡Œå®è·µæœºå™¨å­¦ä¹ *](https://amzn.to/433F4Nm)ä½œè€…Aurelien
    GÃ©ron'
- en: '**NLP:** [*Text as Data: A New Framework for Machine Learning and the Social
    Sciences*](https://amzn.to/3zvH43j)by Justin Grimmer'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**NLPï¼š** [*æ–‡æœ¬ä½œä¸ºæ•°æ®ï¼šæœºå™¨å­¦ä¹ å’Œç¤¾ä¼šç§‘å­¦çš„æ–°æ¡†æ¶*](https://amzn.to/3zvH43j)ä½œè€…Justin Grimmer'
- en: '**Sklearn / PyTorch:** [*Machine Learning with PyTorch and Scikit-Learn: Develop
    machine learning and deep learning models with Python*](https://amzn.to/3Gcavve)
    by Sebastian Raschka'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Sklearn / PyTorchï¼š** [*ç”¨ PyTorch å’Œ Scikit-Learn è¿›è¡Œæœºå™¨å­¦ä¹ ï¼šç”¨ Python å¼€å‘æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹*](https://amzn.to/3Gcavve)
    ä½œè€…ï¼šSebastian Raschka'
- en: '**Data Viz:** [*Storytelling with Data: A Data Visualization Guide for Business
    Professionals*](https://amzn.to/3HUtGtB) by Cole Knaflic'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ•°æ®å¯è§†åŒ–ï¼š** [*ç”¨æ•°æ®è®²æ•…äº‹ï¼šå•†åŠ¡ä¸“ä¸šäººå£«çš„æ•°æ®å¯è§†åŒ–æŒ‡å—*](https://amzn.to/3HUtGtB) ä½œè€…ï¼šCole Knaflic'
- en: Useful Links (written by me)
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æœ‰ç”¨çš„é“¾æ¥ï¼ˆç”±æˆ‘ç¼–å†™ï¼‰
- en: '**Learn how to perform a top-tier Exploratory Data Analysis in Python**: [*Exploratory
    Data Analysis in Python â€” A Step-by-Step Process*](/exploratory-data-analysis-in-python-a-step-by-step-process-d0dfa6bf94ee)'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å­¦ä¹ å¦‚ä½•åœ¨ Python ä¸­è¿›è¡Œé¡¶çº§çš„æ¢ç´¢æ€§æ•°æ®åˆ†æ**ï¼š[*Python ä¸­çš„æ¢ç´¢æ€§æ•°æ®åˆ†æâ€”â€”é€æ­¥è¿‡ç¨‹*](/exploratory-data-analysis-in-python-a-step-by-step-process-d0dfa6bf94ee)'
- en: '**Learn the basics of PyTorch:** [*Introduction to PyTorch: from training loop
    to prediction*](https://medium.com/towards-data-science/introduction-to-pytorch-from-training-loop-to-prediction-a70372764432)'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å­¦ä¹  PyTorch çš„åŸºç¡€çŸ¥è¯†ï¼š** [*PyTorch å…¥é—¨ï¼šä»è®­ç»ƒå¾ªç¯åˆ°é¢„æµ‹*](https://medium.com/towards-data-science/introduction-to-pytorch-from-training-loop-to-prediction-a70372764432)'
- en: '**Learn the basics of TensorFlow**: [*Get started with TensorFlow 2.0 â€” Introduction
    to deep learning*](https://medium.com/towards-data-science/a-comprehensive-introduction-to-tensorflows-sequential-api-and-model-for-deep-learning-c5e31aee49fa)'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å­¦ä¹  TensorFlow çš„åŸºç¡€çŸ¥è¯†**ï¼š[*ä» TensorFlow 2.0 å¼€å§‹â€”â€”æ·±åº¦å­¦ä¹ å…¥é—¨*](https://medium.com/towards-data-science/a-comprehensive-introduction-to-tensorflows-sequential-api-and-model-for-deep-learning-c5e31aee49fa)'
- en: '**Perform text clustering with TF-IDF in Python**: [*Text Clustering with TF-IDF
    in Python*](https://medium.com/mlearning-ai/text-clustering-with-tf-idf-in-python-c94cd26a31e7)'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç”¨ TF-IDF åœ¨ Python ä¸­è¿›è¡Œæ–‡æœ¬èšç±»**ï¼š[*Python ä¸­çš„ TF-IDF æ–‡æœ¬èšç±»*](https://medium.com/mlearning-ai/text-clustering-with-tf-idf-in-python-c94cd26a31e7)'
- en: '**If you want to support my content creation activity, feel free to follow
    my referral link below and join Mediumâ€™s membership program**. I will receive
    a portion of your investment and youâ€™ll be able to access Mediumâ€™s plethora of
    articles on data science and more in a seamless way.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '**å¦‚æœä½ æƒ³æ”¯æŒæˆ‘çš„å†…å®¹åˆ›ä½œæ´»åŠ¨ï¼Œè¯·éšæ„é€šè¿‡ä¸‹é¢çš„æ¨èé“¾æ¥åŠ å…¥ Medium çš„ä¼šå‘˜è®¡åˆ’**ã€‚æˆ‘å°†ä»ä½ çš„æŠ•èµ„ä¸­è·å¾—ä¸€éƒ¨åˆ†ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥æ— ç¼è®¿é—® Medium
    ä¸Šå…³äºæ•°æ®ç§‘å­¦ç­‰é¢†åŸŸçš„å¤§é‡æ–‡ç« ã€‚'
- en: '[](https://medium.com/@theDrewDag/membership?source=post_page-----854d0b65a6ae--------------------------------)
    [## Join Medium with my referral link - Andrea D''Agostino'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '[## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium - Andrea D''Agostino](https://medium.com/@theDrewDag/membership?source=post_page-----854d0b65a6ae--------------------------------)'
- en: As a Medium member, a portion of your membership fee goes to writers you read,
    and you get full access to every storyâ€¦
  id: totrans-144
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½œä¸º Medium ä¼šå‘˜ï¼Œä½ çš„éƒ¨åˆ†ä¼šå‘˜è´¹ç”¨å°†åˆ†é…ç»™ä½ é˜…è¯»çš„ä½œè€…ï¼Œå¹¶ä¸”ä½ å¯ä»¥å…¨é¢è®¿é—®æ¯ä¸€ä¸ªæ•…äº‹â€¦â€¦
- en: medium.com](https://medium.com/@theDrewDag/membership?source=post_page-----854d0b65a6ae--------------------------------)
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '[medium.com](https://medium.com/@theDrewDag/membership?source=post_page-----854d0b65a6ae--------------------------------)'

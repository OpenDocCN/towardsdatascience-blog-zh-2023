- en: SQL Riddles to Test Your Wits
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: SQLè°œé¢˜æµ‹è¯•ä½ çš„æ™ºæ…§
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22](https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22](https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22)
- en: Timestamps, dependent filters, and misbehaving left joins
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ—¶é—´æˆ³ã€ä¾èµ–è¿‡æ»¤å™¨å’Œè¡¨ç°ä¸ä½³çš„å·¦è¿æ¥
- en: '[](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Matt
    Sosna](../Images/c3175c0dc62b795a8d0fa57532fb669b.png)](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    [Matt Sosna](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Matt
    Sosna](../Images/c3175c0dc62b795a8d0fa57532fb669b.png)](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    [Matt Sosna](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)'
- en: Â·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff17fb22b897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=post_page-f17fb22b897----8ce31202ae7f---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    Â·8 min readÂ·Feb 22, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=-----8ce31202ae7f---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff17fb22b897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=post_page-f17fb22b897----8ce31202ae7f---------------------post_header-----------)
    å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    Â· 8åˆ†é’Ÿé˜…è¯» Â· 2023å¹´2æœˆ22æ—¥ [](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=-----8ce31202ae7f---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&source=-----8ce31202ae7f---------------------bookmark_footer-----------)![](../Images/e1fc7bf3a6b50e65020f31e0892a018c.png)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&source=-----8ce31202ae7f---------------------bookmark_footer-----------)![](../Images/e1fc7bf3a6b50e65020f31e0892a018c.png)'
- en: Photo by [Saffu](https://unsplash.com/@saffu?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”± [Saffu](https://unsplash.com/@saffu?utm_source=medium&utm_medium=referral)
    æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: SQL is a deceptively simple language. Across its many dialects, users can query
    databases in a syntax similar to English. **What you see is what you getâ€¦ until
    you donâ€™t.**
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: SQL æ˜¯ä¸€ç§çœ‹ä¼¼ç®€å•çš„è¯­è¨€ã€‚åœ¨å…¶ä¼—å¤šæ–¹è¨€ä¸­ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ç±»ä¼¼è‹±è¯­çš„è¯­æ³•æŸ¥è¯¢æ•°æ®åº“ã€‚**ä½ æ‰€è§å³æ‰€å¾—â€¦â€¦ç›´åˆ°ä½ å‘ç°ä¸æ˜¯ã€‚**
- en: Every now and then I come across a query that produces a result completely different
    from what I expected, teaching me little nuances about the language. Iâ€™ve compiled
    three recent head-scratchers in this post, and Iâ€™ve arranged them as riddles to
    make them more interesting. Try to figure out the answer before reading the end
    of each section!
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ—¶ä¸æ—¶ä¼šé‡åˆ°ä¸€äº›æŸ¥è¯¢ï¼Œè¿”å›çš„ç»“æœä¸æˆ‘é¢„æœŸçš„å®Œå…¨ä¸åŒï¼Œè¿™è®©æˆ‘å­¦åˆ°äº†è¯­è¨€ä¸­çš„ä¸€äº›å°ç»†èŠ‚ã€‚æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ±‡ç¼–äº†ä¸‰ä¸ªæœ€è¿‘è®©æˆ‘å›°æƒ‘çš„é—®é¢˜ï¼Œå¹¶å°†å®ƒä»¬å®‰æ’æˆè°œé¢˜ä»¥å¢åŠ è¶£å‘³ã€‚å°è¯•åœ¨é˜…è¯»æ¯èŠ‚çš„ç»“å°¾å‰æ‰¾å‡ºç­”æ¡ˆï¼
- en: Iâ€™ve also included quick [**common table expressions (CTEs)**](https://learnsql.com/blog/what-is-common-table-expression/)
    to generate the tables in each example, so you donâ€™t need to try querying your
    companyâ€™s production tables! But to get really comfortable with SQL, I actually
    recommend creating your own database and tables to play with. Check out [this
    post](https://medium.com/towards-data-science/intermediate-sql-for-everyone-fe35c541147a)
    to learn how.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘è¿˜åŒ…æ‹¬äº†å¿«é€Ÿçš„[**å…¬å…±è¡¨è¡¨è¾¾å¼ (CTEs)**](https://learnsql.com/blog/what-is-common-table-expression/)ä»¥ç”Ÿæˆæ¯ä¸ªç¤ºä¾‹ä¸­çš„è¡¨æ ¼ï¼Œå› æ­¤ä½ æ— éœ€å°è¯•æŸ¥è¯¢å…¬å¸ç”Ÿäº§è¡¨ï¼ä½†ä¸ºäº†çœŸæ­£ç†Ÿæ‚‰
    SQLï¼Œæˆ‘å®é™…ä¸Šå»ºè®®ä½ åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“å’Œè¡¨æ¥ç»ƒä¹ ã€‚æŸ¥çœ‹[è¿™ç¯‡æ–‡ç« ](https://medium.com/towards-data-science/intermediate-sql-for-everyone-fe35c541147a)äº†è§£æ–¹æ³•ã€‚
- en: Note that all queries are in Postgres â€” you may get different results in a different
    dialect. Finally, an obligatory note that the actual data and topics in each query
    are just illustrative examples. ğŸ™‚
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„æ‰€æœ‰æŸ¥è¯¢éƒ½æ˜¯åœ¨ Postgres ä¸­è¿›è¡Œçš„â€”â€”ä½ åœ¨ä¸åŒæ–¹è¨€ä¸­å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚æœ€åï¼Œå¿…é¡»æåŠçš„æ˜¯ï¼Œæ¯ä¸ªæŸ¥è¯¢ä¸­çš„å®é™…æ•°æ®å’Œä¸»é¢˜ä»…ä»…æ˜¯ç¤ºä¾‹ã€‚ğŸ™‚

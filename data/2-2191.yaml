- en: Understanding Multinomial Distribution using Python
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Python理解多项分布
- en: 原文：[https://towardsdatascience.com/understanding-multinomial-distribution-using-python-f48c89e1e29f](https://towardsdatascience.com/understanding-multinomial-distribution-using-python-f48c89e1e29f)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/understanding-multinomial-distribution-using-python-f48c89e1e29f](https://towardsdatascience.com/understanding-multinomial-distribution-using-python-f48c89e1e29f)
- en: The math and intuition behind the multinomial distribution
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 多项分布背后的数学和直觉
- en: '[](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)[![Reza
    Bagheri](../Images/7c5a7dc9e6e31048ce31c8d49055987c.png)](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)
    [Reza Bagheri](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)[![Reza
    Bagheri](../Images/7c5a7dc9e6e31048ce31c8d49055987c.png)](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)
    [Reza Bagheri](https://reza-bagheri79.medium.com/?source=post_page-----f48c89e1e29f--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)
    ·20 min read·Jan 6, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发布于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----f48c89e1e29f--------------------------------)
    ·20分钟阅读·2023年1月6日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/be421088ce08f6be5825b9f3e0a934fa.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/be421088ce08f6be5825b9f3e0a934fa.png)'
- en: 'Source: [https://pixabay.com/vectors/dice-game-die-luck-random-numbers-151867/](https://pixabay.com/vectors/dice-game-die-luck-random-numbers-151867/)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 来源：[https://pixabay.com/vectors/dice-game-die-luck-random-numbers-151867/](https://pixabay.com/vectors/dice-game-die-luck-random-numbers-151867/)
- en: The multinomial distribution is a generalization of the binomial distribution
    and is used to find the probabilities in experiments with more than two outcomes.
    This article gives an intuitive introduction to multinomial distribution and discusses
    its mathematical properties. In addition, it will teach you how to use the SciPy
    library in Python to model and visualize a multinomial distribution.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 多项分布是二项分布的推广，用于在具有多个结果的实验中计算概率。本文对多项分布进行了直观的介绍，并讨论了其数学性质。此外，还将教你如何使用Python中的SciPy库来建模和可视化多项分布。
- en: '**Binomial disitrbution**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**二项分布**'
- en: Since the multinomial distribution is a generalization of the binomial distribution,
    we will briefly review it here. In [another article](https://medium.com/towards-data-science/understanding-probability-distributions-using-python-9eca9c1d9d38),
    I discussed the univariate probability distributions in more detail, so if you
    are not familiar with binomial distribution or concepts like random variables
    and probability mass function (PMF), I suggest you read [that article](https://medium.com/towards-data-science/understanding-probability-distributions-using-python-9eca9c1d9d38)
    first.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 由于多项分布是二项分布的推广，我们将在此简要回顾一下。有关单变量概率分布的详细讨论，请参阅[另一篇文章](https://medium.com/towards-data-science/understanding-probability-distributions-using-python-9eca9c1d9d38)，如果你对二项分布或随机变量和概率质量函数（PMF）等概念不熟悉，建议你先阅读[那篇文章](https://medium.com/towards-data-science/understanding-probability-distributions-using-python-9eca9c1d9d38)。
- en: A *random variable* is a variable whose value is determined by the outcome of
    a random experiment. A Random variable is usually denoted by uppercase letters
    however, we use lowercase letters to denote the particular values that it can
    take. For example, we can define a random variable *X* to represent the outcomes
    of a coin toss. To do that we need to assign a numerical value to each outcome.
    We can denote obtaining a head by 1 and obtaining a tail by 0\. Now, *X*=1 means
    that the outcome of a coin toss is a head, and *X*=0 means that it is a tail.
    Such a random variable that can only take certain values is called a *discrete
    random variable*.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '*随机变量* 是一个其值由随机实验的结果决定的变量。随机变量通常用大写字母表示，但我们使用小写字母表示它可以取的特定值。例如，我们可以定义一个随机变量
    *X* 来表示掷硬币的结果。为此，我们需要给每个结果分配一个数值。我们可以用1表示得到正面，用0表示得到反面。现在，*X*=1表示掷硬币的结果是正面，*X*=0表示是反面。这样只能取特定值的随机变量称为*离散随机变量*。'
- en: We define the probability mass function (PMF) of a discrete random variable
    *X* as a function that gives the probability that *X* is equal to a certain value.
    Mathematically, the PMF of *X* is defined as the function *p*ₓ such that
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将离散随机变量*X*的概率质量函数（PMF）定义为一个给出*X*等于某个特定值的概率的函数。从数学上讲，*X*的PMF定义为函数*p*ₓ，使得
- en: '![](../Images/7b9dc00158375170d3900f00361c9b57.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7b9dc00158375170d3900f00361c9b57.png)'
- en: 'A particular value that *X* can take on is denoted by *x, s*o *P*(*X*=*x*)
    gives the probability of *X*=*x*. We know that the sum of the probabilities for
    all the possible values of *X* should be equal to 1, so it follows that:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 特定值*X*可以取的值用*x*表示，因此*P*(*X*=*x*)表示*X*=*x*的概率。我们知道，*X*所有可能值的概率之和应该等于1，因此：
- en: '![](../Images/5ee8dc17ba517bf0a650ca5e085fd7f7.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5ee8dc17ba517bf0a650ca5e085fd7f7.png)'
- en: A discrete random variable *X* with a Bernoulli distribution with parameter
    *p* represents a random experiment that only has two outcomes denoted by 0 and
    1 (we denote it by *X*~Bern(*p*)). Here *X*=1 (also called ‘success’) occurs with
    the probability *p* and *X*=0 (also called ‘failure’) occurs with the probability
    1-*p*. As an example, we can represent the outcome of a coin toss with a random
    variable *X* with a Bernoulli distribution. Now we can assume that *X*=1 and *X*=0
    represent getting a head and a tail respectively, and *p* is the probability of
    obtaining a head.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 具有伯努利分布的离散随机变量*X*，其参数为*p*，表示一个只有两个结果的随机实验，分别用0和1表示（我们用*X*~Bern(*p*)表示）。这里*X*=1（也称为‘成功’）发生的概率是*p*，而*X*=0（也称为‘失败’）发生的概率是1-*p*。例如，我们可以用伯努利分布的随机变量*X*表示掷硬币的结果。现在我们可以假设*X*=1和*X*=0分别表示得到正面和反面，*p*是得到正面的概率。
- en: Suppose that we have a sequence of *n* independent random experiments and each
    of them can be represented by a random variable that has a Bernoulli distribution
    with the parameter *p*. So each experiment has only two outcomes denoted by 1
    (success) and 0 (failure) and *X*=1 occurs with the probability *p* (such an experiment
    is called a Bernoulli trial). A discrete random variable *X* with a binomial distribution
    with parameters *n* and *p* represents the total number of successes in this sequence,
    and we can write this as *X ~* Bin(*n, p*).Suppose that we have a coin that lands
    on heads with the probability *p*. We can represent the total number of heads
    in *n* tosses of this coin with a random variable *X* that has a binomial distribution
    with parameters *n* and *p* (Figure 1).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一个*n*次独立随机实验的序列，每次实验可以用一个伯努利分布参数*p*的随机变量表示。因此，每次实验只有两个结果，分别为1（成功）和0（失败），且*X*=1发生的概率为*p*（这样的实验称为伯努利试验）。具有参数*n*和*p*的二项分布的离散随机变量*X*表示这一序列中的成功总数，我们可以写作*X
    ~* Bin(*n, p*)。假设我们有一枚硬币，正面朝上的概率为*p*。我们可以用具有参数*n*和*p*的二项分布的随机变量*X*表示这一硬币在*n*次投掷中的正面总数（图1）。
- en: '![](../Images/9d6a3bae878b0d97a80ad5be3cee561a.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9d6a3bae878b0d97a80ad5be3cee561a.png)'
- en: Figure 1 (Image by Author)
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 图1（作者提供的图片）
- en: '**Random vectors**'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**随机向量**'
- en: 'Multinomial disitrbution is a *multivariate disitrbution*. In statistics, a
    *univariate distribution* is a probability distribution of only one random variable.
    The multivariate distributions are a generalization of the univariate distributions
    to two or more random variables. To understand these distributions, we should
    first discuss the random vectors. A random vector is a vector of random variables.
    If we have *n* random variables *X*₁, *X*₂ …, *Xₙ*, we can place them in the random
    vector ***X***:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 多项分布是一种*多变量分布*。在统计学中，*单变量分布*是仅一个随机变量的概率分布。多变量分布是单变量分布的推广，适用于两个或更多随机变量。要理解这些分布，我们首先应讨论随机向量。随机向量是一个随机变量的向量。如果我们有*n*个随机变量*X*₁、*X*₂
    …、*X*ₙ，我们可以将它们放在随机向量***X***中：
- en: '![](../Images/3e683e03b1fed10b01e8e451f6df7576.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3e683e03b1fed10b01e8e451f6df7576.png)'
- en: 'We use bold uppercase letters to denote a random vector. To show a possible
    value of a random vector (which is also a vector) we use bold lowercase letters
    such as ***x***. For example:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们用粗体大写字母表示随机向量。要表示随机向量的一个可能值（这也是一个向量），我们使用粗体小写字母，如***x***。例如：
- en: '![](../Images/c97e8a856c14fb5f780279c1e054b847.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c97e8a856c14fb5f780279c1e054b847.png)'
- en: Is a random vector with two elements and
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 是一个包含两个元素的随机向量，且
- en: '![](../Images/54751b6e5765c1a43a5b245df95baabe.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/54751b6e5765c1a43a5b245df95baabe.png)'
- en: is a possible value of it.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 是它的一个可能值。
- en: '**Joint PMF**'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**联合PMF**'
- en: Suppose that we have a random vector
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一个随机向量
- en: '![](../Images/3e683e03b1fed10b01e8e451f6df7576.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3e683e03b1fed10b01e8e451f6df7576.png)'
- en: 'where *X*₁, *X*₂ …, *Xₙ* are discrete random variables. The *joint probability
    mass function* (joint PMF) of ***X*** is defined as:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *X*₁，*X*₂，…，*Xₙ* 是离散随机变量。***X***的*联合概率质量函数*（联合PMF）定义为：
- en: '![](../Images/a13b6cfad30af8a257a724d7fe444391.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a13b6cfad30af8a257a724d7fe444391.png)'
- en: where *P*(*X*₁=*x*₁, *X*₂=*x*₂, …, *Xₙ*=*xₙ*) is that probability that *X*₁=*x*₁,
    *X*₂=*x*₂, …, and *Xₙ*=*xₙ* at the same time. If we have the joint PMF of the
    random vector ***X***, we can derive the distribution of one of its components
    *Xᵢ* using *marginalization*. The *marginal* *probability mass function* of *Xᵢ*
    can be derived from the joint PMF of ***X*** as follows
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *P*(*X*₁=*x*₁，*X*₂=*x*₂，…，*Xₙ*=*xₙ*) 是 *X*₁=*x*₁，*X*₂=*x*₂，…，和 *Xₙ*=*xₙ*
    同时发生的概率。如果我们知道随机向量 ***X*** 的联合PMF，我们可以通过*边缘化*来推导其一个分量 *Xᵢ* 的分布。*边缘* *概率质量函数* 可以从
    ***X*** 的联合PMF 导出，如下所示
- en: '![](../Images/d97d95a6e6f48d8b00ed6c4b00a3678b.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d97d95a6e6f48d8b00ed6c4b00a3678b.png)'
- en: Here *R***ₓ** is the support of ***X*** which means that it is the set of all
    values the random vector ***X*** can take. So, to derive the marginal probability
    PMF of *Xᵢ* at point *x*, we need to sum the probabilities of all the vectors
    of *R***ₓ** in which *Xᵢ* is equal to *x*.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 *R***ₓ** 是 ***X*** 的支持集，表示随机向量 ***X*** 可以取的所有值的集合。因此，为了推导 *Xᵢ* 在点 *x* 的边缘概率PMF，我们需要对
    *R***ₓ** 中 *Xᵢ* 等于 *x* 的所有向量的概率进行求和。
- en: '**Multinomial distribution**'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '**多项分布**'
- en: The multinomial distribution is a generalization of the binomial distribution.
    Suppose that we have *n* independent trials. Each trial has *k* different outcomes
    (*k* ≥ 2), and the probability of the *i*th outcome is *pᵢ* and
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 多项分布是二项分布的一种推广。假设我们有 *n* 次独立试验。每次试验有 *k* 种不同的结果（*k* ≥ 2），第 *i* 种结果的概率是 *pᵢ*
    和
- en: '![](../Images/2deb3097908cb7aa9a21931d4f8052c4.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2deb3097908cb7aa9a21931d4f8052c4.png)'
- en: 'The vector ***p*** denotes these probabilities:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 向量 ***p*** 表示这些概率：
- en: '![](../Images/a176a3594ae25731750094f0da0cdd9b.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a176a3594ae25731750094f0da0cdd9b.png)'
- en: Let the discrete random variable *Xᵢ* represent the number of times the outcome
    number *i* is observed over *n* trials. The random vector ***X*** is defined as
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 设离散随机变量 *Xᵢ* 表示在*n*次试验中结果编号*i*出现的次数。随机向量 ***X*** 定义为
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: 'and we have *x*₁+*x*₂ +…+*xₖ*=*n*. Then ***X*** is said to have the multinomial
    distribution with parameters *n* and ***p****.* The joint PMF of ***X*** is defined
    as follows:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 并且我们有 *x*₁+*x*₂ +…+*xₖ*=*n*。那么 ***X*** 就称为具有参数 *n* 和 ***p*** 的多项分布。***X*** 的联合PMF定义如下：
- en: '![](../Images/84911c9d7a590ad9b7f5f67978185a6e.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/84911c9d7a590ad9b7f5f67978185a6e.png)'
- en: Let’s see if we can prove it. First, we should note that if *x*₁+*x*₂ +…+*xₖ*≠*n*
    then the event *X*₁=*x*₁, *X*₂=*x*₂, …, and *Xₖ*=*xₖ* is impossible, so its probability
    should be equal to zero. If *x*₁+*x*₂ +…+*xₖ*=*n*, the probability of the event
    *X*₁=*x*₁, *X*₂=*x*₂, …, and *Xₖ*=*xₖ* is
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看是否可以证明这一点。首先，我们应该注意到如果 *x*₁+*x*₂ +…+*xₖ*≠*n*，那么事件 *X*₁=*x*₁，*X*₂=*x*₂，…，和
    *Xₖ*=*xₖ* 是不可能的，因此其概率应为零。如果 *x*₁+*x*₂ +…+*xₖ*=*n*，事件 *X*₁=*x*₁，*X*₂=*x*₂，…，和 *Xₖ*=*xₖ*
    的概率是
- en: '![](../Images/989b65ec4e8fd60dad535f38c3a1a0c0.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/989b65ec4e8fd60dad535f38c3a1a0c0.png)'
- en: In addition, the total number of different ways in which we can have *n* trials
    with *X*₁=*x*₁, *X*₂=*x*₂, …, and *Xₖ*=*xₖ* is
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，获得 *X*₁=*x*₁，*X*₂=*x*₂，…，和 *Xₖ*=*xₖ* 的 *n* 次试验的不同方式的总数是
- en: '![](../Images/4dadc5ded2a235c87074699e1b7ba28b.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4dadc5ded2a235c87074699e1b7ba28b.png)'
- en: So the total probability of having *X*₁=*x*₁, *X*₂=*x*₂, …, and *Xₖ*=*xₖ* in
    *n* trialsis
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 所以在*n*次试验中，*X*₁=*x*₁，*X*₂=*x*₂，…，和*Xₖ*=*xₖ*的总概率是
- en: '![](../Images/1a421a215bb8bb3921fd7e258aeb24db.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1a421a215bb8bb3921fd7e258aeb24db.png)'
- en: Based on this story, the multinomial distribution can be used to describe a
    *k*-sided die. Suppose that we have a *k*-sided die and the probability of getting
    side *i* is *pᵢ*. In addition, let *Xᵢ* represent the total number of times that
    side *i* is observed. Now, if we roll it *n* times, the random vector ***X***
    has a multinomial distribution with parameters *n* and ***p*** (Figure 2).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这个故事，多项分布可以用来描述一个 *k* 面的骰子。假设我们有一个 *k* 面的骰子，且获得面 *i* 的概率是 *pᵢ*。此外，设 *Xᵢ* 表示观察到面
    *i* 的总次数。现在，如果我们掷骰子 *n* 次，随机向量 ***X*** 就具有参数 *n* 和 ***p*** 的多项分布（见图 2）。
- en: '![](../Images/1f308405453930cb5be7b120f2a8633a.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1f308405453930cb5be7b120f2a8633a.png)'
- en: Figure 2 (Image by Author)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2（作者提供的图片）
- en: We can also express the multinomial distribution in a different way. Suppose
    that we have a population of items of *k* different categories (*k* ≥ 2). The
    proportion of the items in the population that are in category *i* is *pᵢ*, and
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以用另一种方式来表达多项式分布。假设我们有一个由 *k* 种不同类别的物品组成的总体（*k* ≥ 2）。总体中属于类别 *i* 的物品比例为 *pᵢ*，并且
- en: '![](../Images/2deb3097908cb7aa9a21931d4f8052c4.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2deb3097908cb7aa9a21931d4f8052c4.png)'
- en: Now we randomly select *n* items from the population with replacement, and we
    assume that the random variable *Xᵢ* represents the number of selected items that
    are in category *i* (Figure 3). Since these items are selected at random with
    replacement, the selections will be independent of each other, and the probability
    that an item will be in category *i* is *pᵢ*. So, we can think of each selection
    as an independent trial with *k* different outcomes, and the corresponding probability
    of each outcome *i* is *pᵢ*. Now, if we define the vector ***p*** as
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们从总体中随机选择 *n* 个物品（允许重复），我们假设随机变量 *Xᵢ* 代表选择的物品中属于类别 *i* 的数量（图 3）。由于这些物品是随机选择的且允许重复，因此选择是相互独立的，每个物品属于类别
    *i* 的概率是 *pᵢ*。因此，我们可以将每次选择视为一个具有 *k* 种不同结果的独立试验，每个结果 *i* 的相应概率是 *pᵢ*。现在，如果我们定义向量
    ***p*** 为
- en: '![](../Images/a176a3594ae25731750094f0da0cdd9b.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a176a3594ae25731750094f0da0cdd9b.png)'
- en: then the random vector
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 那么随机向量
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: has the multinomial distribution with parameters *n* and ***p***.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数 *n* 和 ***p*** 的多项式分布。
- en: '![](../Images/ea7ca89aad730a7dfbc8ec377f4a75e2.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ea7ca89aad730a7dfbc8ec377f4a75e2.png)'
- en: Figure 3 (Image by Author)
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3（图像来源：作者）
- en: 'A random vector ***X*** that has a multinomial distribution with parameters
    *n* and ***p*** can be written as the sum of *n* random vectors that have a multinomial
    distribution with parameters 1 and ***p***:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数 *n* 和 ***p*** 的多项式分布的随机向量 ***X*** 可以表示为 *n* 个具有参数 1 和 ***p*** 的多项式分布的随机向量之和：
- en: '![](../Images/0d5e45128ca1841f3fba42b78165734e.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0d5e45128ca1841f3fba42b78165734e.png)'
- en: '**Proof** (*optional*): The vectors ***Y****ᵢ* can be written as follows:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明**（*可选*）：向量 ***Y****ᵢ* 可以写成如下形式：'
- en: '![](../Images/e0c6e2dd5845276a3974b1c4fab0bdad.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e0c6e2dd5845276a3974b1c4fab0bdad.png)'
- en: Since *X*₁+*X*₂ +…+*Xₖ*=*n,* we conclude that we have *n* vectors on the right-hand
    side*.* In each ***Y****ᵢ* one element is 1 and the others are 0\. So, each ***Y****ᵢ*
    can represent one trial that has *k* different outcomes, and the element which
    is equal to 1 represents the observed outcome. Therefore, each ***Y****ᵢ* has
    a multinomial distribution with parameters 1 and ***p***.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 *X*₁+*X*₂ +…+*X*ₖ*=*n*，我们可以得出在右侧有 *n* 个向量。每个 ***Y****ᵢ* 中有一个元素为 1，其余为 0。因此，每个
    ***Y****ᵢ* 可以表示一个具有 *k* 种不同结果的试验，其中等于 1 的元素表示观察到的结果。因此，每个 ***Y****ᵢ* 具有参数为 1 和
    ***p*** 的多项式分布。
- en: We can merge multiple elements in a multinomial random vector ***X*** to get
    a new multinomial random vector. For example, let
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以合并多项式随机向量 ***X*** 中的多个元素来获得新的多项式随机向量。例如，设
- en: '![](../Images/c58acc6b94027153a2bedcb84e364443.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c58acc6b94027153a2bedcb84e364443.png)'
- en: Now we can merge the first three elements to get the new random vector
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以合并前三个元素得到新的随机向量
- en: '![](../Images/60262144e97738e0fff1cd4dd5450d11.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/60262144e97738e0fff1cd4dd5450d11.png)'
- en: And this random vector has multinomial distribution with parameters *n* and
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 而这个随机向量具有参数为 *n* 和 的多项式分布
- en: '![](../Images/7b5c973d40d92b24e92a10b13ac488ea.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7b5c973d40d92b24e92a10b13ac488ea.png)'
- en: In fact, by merging *X*₁, *X*₂, and *X*₅, we create a new category, and the
    proportion of this category is simply *p*₁+*p*₂+*p*₅. So, it can create a multinomial
    distribution along the remaining categories 3 and 4 while the proportion of those
    categories remains the same.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，通过合并 *X*₁、*X*₂ 和 *X*₅，我们创建了一个新类别，该类别的比例是 *p*₁+*p*₂+*p*₅。因此，它可以在剩余类别 3 和
    4 上创建一个多项式分布，同时这些类别的比例保持不变。
- en: The multinomial distribution is a generalization of the binomial distribution.
    If *k*=2, the multinomial distribution reduces to a binomial distribution. Hence,
    if we have
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 多项式分布是二项式分布的推广。如果 *k*=2，多项式分布简化为二项式分布。因此，如果我们有
- en: '![](../Images/57b7ea2a92767e4ff4414adcf88d3920.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/57b7ea2a92767e4ff4414adcf88d3920.png)'
- en: then *X*₁ ~ Bin(*n*, *p*₁) and *X*₂ ~ Bin(*n*, *p*₂).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 那么 *X*₁ ~ Bin(*n*, *p*₁) 和 *X*₂ ~ Bin(*n*, *p*₂)。
- en: '**Proof** (*optional*): We should note that *X*₂= *n*-*X*₁ and *p*₂=1-*p*₁.
    So, if we call the outcome 1 a success and the outcome 2 a failure, then each
    trial has only two outcomes (success and failure), and success occurs with probability
    *p*₁. Hence, each trial can be represented with a Bernoulli distribution with
    parameter *p*₁ and *X*₁ represents the number of successes in *n* Bernoulli trials
    with the parameter *p*₁. So, we conclude that *X*₁ has a binomial distribution
    with parameters *n* and *p*₁. Similarly, if we call the outcome 2 a success, and
    the outcome 1 a failure, *X*₂ represents the number of successes in *n* Bernoulli
    trials with the parameter *p*₂, so has a binomial distribution with parameters
    *n* and *p*₂.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明**（*可选*）：我们应该注意到 *X*₂= *n*-*X*₁ 和 *p*₂=1-*p*₁。因此，如果我们将结果 1 视为成功，将结果 2 视为失败，则每次试验只有两种结果（成功和失败），成功的概率是
    *p*₁。因此，每次试验可以用具有参数 *p*₁ 的伯努利分布表示，*X*₁ 代表了 *n* 次伯努利试验中成功的次数，参数为 *p*₁。因此，我们得出 *X*₁
    具有参数 *n* 和 *p*₁ 的二项分布。类似地，如果我们将结果 2 视为成功，将结果 1 视为失败，则 *X*₂ 代表了 *n* 次伯努利试验中成功的次数，参数为
    *p*₂，因此具有参数 *n* 和 *p*₂ 的二项分布。'
- en: We can extend the previous result to a multinomial distribution with *k*>2\.
    If
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将之前的结果扩展到 *k*>2 的多项分布。如果
- en: '![](../Images/25723813b57188dcbe469671c35beb31.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/25723813b57188dcbe469671c35beb31.png)'
- en: 'then the marginal distribution of each *Xᵢ* is a binomial distribution with
    parameters *n* and *pᵢ*:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 那么每个 *Xᵢ* 的边际分布是具有参数 *n* 和 *pᵢ* 的二项分布：
- en: '![](../Images/2ecfea65828c7ad683f07e1f204135a8.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2ecfea65828c7ad683f07e1f204135a8.png)'
- en: '**Proof** (*optional*): We assume that the outcome *i* is a success with the
    probability *pᵢ*, and all the remaining outcomes are a failure with the probability
    1-*pᵢ*. So, *Xᵢ* represents the number of successes in *n* Bernoulli trials with
    the parameter *pᵢ*, and it has a binomial distribution with parameters *n* and
    *pᵢ*.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明**（*可选*）：我们假设结果 *i* 的成功概率为 *pᵢ*，所有其他结果的失败概率为 1-*pᵢ*。因此，*Xᵢ* 代表了 *n* 次伯努利试验中成功的次数，参数为
    *pᵢ*，并且它具有参数 *n* 和 *pᵢ* 的二项分布。'
- en: In addition, the sum of some of the elements of ***X*** has a binomial distribution.
    Mathematically, if *Xᵢ,*1, *Xᵢ,*₂, …, *Xᵢ,ₘ* are *m* elements of the random vector
    ***X*** (*m*<*k*) and their corresponding probabilities in vector ***p*** are
    *pᵢ,*₁, *pᵢ*,₂, …, *pᵢ,ₘ*, then the sum *Xᵢ,*₁ + *Xᵢ,*₂ + …+ *Xᵢ,ₘ* has a binomial
    distribution with parameters *n* and *pᵢ,*₁ + *pᵢ,*₂ + …+ *pᵢ,ₘ.* For example,
    for *n*=8 and *k*=5, *X*₁+*X*₃+*X*₅ has a binomial distribution with parameters
    8 and *p*₁ + *p*₃ + *p*₅*.*
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，***X*** 的某些元素的总和服从二项分布。从数学上讲，如果 *Xᵢ,*₁, *Xᵢ,*₂, …, *Xᵢ,ₘ* 是随机向量 ***X*** 的
    *m* 个元素（*m*<*k*），它们在向量 ***p*** 中的对应概率是 *pᵢ,*₁, *pᵢ*,₂, …, *pᵢ,ₘ*，那么总和 *Xᵢ,*₁ +
    *Xᵢ,*₂ + …+ *Xᵢ,ₘ* 服从具有参数 *n* 和 *pᵢ,*₁ + *pᵢ,*₂ + …+ *pᵢ,ₘ* 的二项分布。例如，对于 *n*=8
    和 *k*=5，*X*₁+*X*₃+*X*₅ 具有参数 8 和 *p*₁ + *p*₃ + *p*₅* 的二项分布。
- en: '**Proof** (*optional*): As mentioned before, we can merge multiple elements
    in a multinomial random vector ***X*** to get a new multinomial random vector.
    So, by merging *Xᵢ,*₁ + *Xᵢ,*₂ + …+ *Xᵢ,ₘ* we get a new random vector ***Y***
    which has a multinomial distribution:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明**（*可选*）：如前所述，我们可以将多项式随机向量 ***X*** 中的多个元素合并，以获得一个新的多项式随机向量。因此，通过合并 *Xᵢ,*₁
    + *Xᵢ,*₂ + …+ *Xᵢ,ₘ*，我们得到一个新的随机向量 ***Y***，它具有多项分布：'
- en: '![](../Images/29c7c4a168fde811c124e5a3207519fd.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/29c7c4a168fde811c124e5a3207519fd.png)'
- en: We also now showed that the marginal distribution of each element of a multinomial
    random vector has a binomial distribution with parameters *n* and its corresponding
    probability, so we conclude that *Xᵢ,*₁ + *Xᵢ,*₂ + …+ *Xᵢ,ₘ* has a binomial distribution
    with parameters *n* and *pᵢ,*₁ + *pᵢ,*₂ + …+ *pᵢ,ₘ.*
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在还展示了多项式随机向量每个元素的边际分布具有参数 *n* 和其对应概率的二项分布，因此我们得出结论 *Xᵢ,*₁ + *Xᵢ,*₂ + …+ *Xᵢ,ₘ*
    具有参数 *n* 和 *pᵢ,*₁ + *pᵢ,*₂ + …+ *pᵢ,ₘ* 的二项分布。
- en: We can use the `scipy` library in Python to generate the multinomial distribution.
    We can create a multinomial distribution using the `multinomial` object in `scipy.stat`,
    and calculate its joint PMF using the `pmf()` method of this object. The object
    takes the parameters `n` and `p` which correspond to *n* and ***p***. `p` is an
    array-like object. Each element of `p` should be in the interval [0, 1] and the
    elements should sum to 1\. If they do not sum to 1, the last element of `p` is
    not used and is replaced with one minus the sum of the earlier elements (so that
    the elements sum to 1).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 Python 中的 `scipy` 库生成多项分布。我们可以使用 `scipy.stat` 中的 `multinomial` 对象创建多项分布，并使用该对象的
    `pmf()` 方法计算其联合 PMF。该对象接受 `n` 和 ***p*** 参数，其中 `n` 和 ***p*** 对应于 *n* 和 ***p***。`p`
    是一个类似数组的对象。`p` 的每个元素应在 [0, 1] 区间内，并且这些元素的和应为 1。如果它们的和不为 1，则 `p` 的最后一个元素不会被使用，而是用之前元素和的
    1 减去替代（以使元素和为 1）。
- en: 'First, we need to import all the required libraries:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要导入所有必需的库：
- en: '[PRE0]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Listing 1 creates the following multinomial distribution
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 1 创建了以下多项分布
- en: '![](../Images/6f20c8a28ddfd2d8676de07da59f0f6c.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6f20c8a28ddfd2d8676de07da59f0f6c.png)'
- en: And calculates its joint PMF at
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 并计算其联合 PMF 在
- en: '![](../Images/98935491670adb821e70e83d624c491c.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/98935491670adb821e70e83d624c491c.png)'
- en: '[PRE1]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We could also pass the distribution parameters to the `pmf()` function directly:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以直接将分布参数传递给 `pmf()` 函数：
- en: '[PRE2]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The method `rvs()` can be used to generate random variates. A random variate
    or simply variate is a particular outcome of a random variable or a random vector.
    Using this method, we can draw a random sample of size *m* from a multinomial
    distribution which means that we generate *m* random variates from a random vector
    with a multinomial distribution. For example, to draw a random sample of size
    4 from a multinomial distribution in Equation 1, we can use the following code
    snippet:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 方法 `rvs()` 可以用于生成随机变异。随机变异或简称变异是随机变量或随机向量的特定结果。使用此方法，我们可以从多项分布中抽取大小为 *m* 的随机样本，这意味着我们从具有多项分布的随机向量中生成
    *m* 个随机变异。例如，要从方程 1 中的多项分布中抽取大小为 4 的随机样本，我们可以使用以下代码片段：
- en: '[PRE3]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: It returns a 2d array with 4 elements. Each element is an array and is a possible
    value that the random vector can ***X*** in equation 1 can take.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 它返回一个包含 4 个元素的 2d 数组。每个元素是一个数组，表示方程 1 中的随机向量可以取的可能值 ***X***。
- en: Let’s see how we can visualize a multinomial distribution defined in Equation
    1\. Here we want to gather all the possible values that ***X*** can take. To do
    that, we only need to calculate all the possible values that the tuple (*X*₁,
    *X*₂) can take. Once we know the value of *X*₁ and *X*₂, the value of *X*₃ can
    be calculated using the fact that *X*₃=*n*-*X*₁-*X*₂. Since *n*=5, *Xᵢ* can take
    an integer valuebetween 0 and 5*.* Listing 2 uses the method `meshgrid()` in `numpy`
    to get all the possible values of (*X*₁, *X*₂) and their corresponding value of
    *X*₃. Finally, the different values of (*X*₁, *X*₂, *X*₃) are stored in the array
    `X_mat`. We end up with some negative values for *X*₃. These negative values are
    impossible to take, but we don’t need to drop them since the joint PMF of a multinomial
    distribution with a negative value for any *Xᵢ* is simply zero.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何可视化方程 1 定义的多项分布。在这里，我们希望收集***X***可能取的所有值。为此，我们只需计算元组 (*X*₁, *X*₂) 所有可能的值。一旦我们知道了
    *X*₁ 和 *X*₂ 的值，就可以利用 *X*₃=*n*-*X*₁-*X*₂ 计算 *X*₃ 的值。由于 *n*=5，*Xᵢ* 可以取 0 到 5 之间的整数值。列表
    2 使用 `numpy` 中的 `meshgrid()` 方法获取 (*X*₁, *X*₂) 的所有可能值及其对应的 *X*₃ 值。最后，(*X*₁, *X*₂,
    *X*₃) 的不同值被存储在数组 `X_mat` 中。我们得到了一些负值的 *X*₃。虽然这些负值是不可能取的，但我们无需丢弃它们，因为多项分布中任何 *Xᵢ*
    为负值的联合 PMF 仅为零。
- en: '[PRE4]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Now we can use `X_mat` to calculate the marginal PMF of *X*₁ at *X*₁=3\. To
    do that, we need to sum the joint PMF of all values of ***X*** in which *X*₁ is
    equal to 3.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用 `X_mat` 计算 *X*₁ 在 *X*₁=3 时的边际 PMF。为此，我们需要对所有值为 3 的 ***X*** 的联合 PMF
    进行求和。
- en: '[PRE5]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We also know that the marginal distribution of *X*₁ is a binomial distribution
    with parameters *n* and *p*₁*.* So, we can use the PMF of a binomial distribution
    with parameters *n*=5 and *p*₁=0.5\. To calculate the PMF of the binomial distribution,
    we can use the object `binom` in `scipy.stat`. We calculate the value of this
    PMF at *X*₁=3, and it should give us the same result as the previous code snippet.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还知道*X*₁的边际分布是参数*n*和*p*₁*的二项分布。因此，我们可以使用参数*n*=5和*p*₁=0.5的二项分布的PMF。为了计算二项分布的PMF，我们可以使用`scipy.stat`中的`binom`对象。我们计算*X*₁=3处的PMF值，结果应该与之前的代码片段相同。
- en: '[PRE6]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The result is almost the same but with a small difference due to the numerical
    errors. We can also approximate the marginal PMF of *X*₁ by sampling from the
    multinomial distribution. Listing 3 draws a sample of size 100,000 from the multinomial
    distribution in Equation 1 and plots the bar chart of the values of *X*₁ in that
    sample. The result is shown in Figure 4\. As this figure shows the bar chart of
    the sample matches the PDF of the binomial distribution with parameters *n*=5
    and *p*₁=0.5.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 结果几乎相同，但由于数值误差存在小的差异。我们还可以通过从多项分布中抽样来近似*X*₁的边际PMF。列表3从方程1中的多项分布中抽取了大小为100,000的样本，并绘制了该样本中*X*₁值的条形图。结果如图4所示。正如图中所示，样本的条形图与参数*n*=5和*p*₁=0.5的二项分布的PDF匹配。
- en: '[PRE7]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/5b24b278425d0bddbadbebc7ec2abb4e.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5b24b278425d0bddbadbebc7ec2abb4e.png)'
- en: Figure 4
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图4
- en: If a random variable with a multinomial distribution has only 3 elements (*k*=3),
    then we can easily plot its joint PMF in a 2d or 3d space. Listing 4 plots the
    joint PMF of the previous multinomial distribution in Figure 5 (top). The plot
    is a heatmap of *X*₁ versus *X*₂. We don’t need to include *X*₃ in this plot since
    its value depends on *X*₁ versus *X*₂ (*X*₃=*n*-*X*₁-*X*). The PMF of the binomial
    distribution of *X*₁ is also plotted in Figure 5 (bottom).
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一个具有多项分布的随机变量只有3个元素（*k*=3），我们可以轻松地在2d或3d空间中绘制其联合PMF。列表4绘制了图5（顶部）中先前多项分布的联合PMF。图是*X*₁与*X*₂的热图。我们不需要在此图中包含*X*₃，因为其值依赖于*X*₁与*X*₂（*X*₃=*n*-*X*₁-*X*）。*X*₁的二项分布PMF也绘制在图5（底部）中。
- en: '[PRE8]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/0315911b53f77b10d2bf1db799476456.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0315911b53f77b10d2bf1db799476456.png)'
- en: Figure 5 (Image by Author)
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图5（作者提供的图片）
- en: Each column of the heatmap at *X*₁=*x* contains the joint PMF of all values
    of ***X*** in which *X*₁ is equal to *x*. So, the marginal PMF of *X*₁ at *x*
    is equal to the sum of the column at *X*₁=*x* (Figure 5). Similarly, the marginal
    PMF of *X*₂ at *x* is equal to the sum of the row at *X*₂=*x.*
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 热图中每列在*X*₁=*x*处包含所有值的联合PMF，其中*X*₁等于*x*。因此，*X*₁在*x*处的边际PMF等于*X*₁=*x*列的总和（图5）。类似地，*X*₂在*x*处的边际PMF等于*X*₂=*x*行的总和。
- en: We can also use a 3d bar plot to visualize the joint PMF of the multinomial
    distribution in Equation 1\. As mentioned before we only need to include *X*₁
    and *X*₂ in the plot since the value of *X*₃ depends on them. Listing 5 uses the
    `pmf()` method to calculate the joint PMF of the arrays in `X_mat` and creates
    a 3d bar plot of these joint PMF values in Figure 6\. The marginal distributions
    of *X*₁ and *X*₂ are also shown in this figure.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用3d条形图来可视化方程1中多项分布的联合PMF。如前所述，我们只需要在图中包含*X*₁和*X*₂，因为*X*₃的值依赖于它们。列表5使用`pmf()`方法计算`X_mat`中数组的联合PMF，并在图6中创建这些联合PMF值的3d条形图。此图中还显示了*X*₁和*X*₂的边际分布。
- en: '[PRE9]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/d33b8a6a054f9b32e433b817c81db30a.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d33b8a6a054f9b32e433b817c81db30a.png)'
- en: Figure 6
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图6
- en: We can merge the first two elements of the multinomial distribution in Equation
    1 to get the new random vector
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将方程1中的多项分布的前两个元素合并，得到新的随机向量。
- en: '![](../Images/1ccdb1f8a57dafbe62876c6ca8e1a94f.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1ccdb1f8a57dafbe62876c6ca8e1a94f.png)'
- en: And we know that this random vector has a multinomial distribution with parameters
    *n* and
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还知道这个随机向量具有参数*n*的多项分布。
- en: '![](../Images/2b50384006f499b737cf4d547e8ca268.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2b50384006f499b737cf4d547e8ca268.png)'
- en: Listing 6 approximates the marginal PMF of *X*₁+*X*₂ by sampling from the multinomial
    distribution. It draws a sample of size 100,000 from the multinomial distribution
    in Equation 86 and plots the bar chart of the values of *X*₁+*X*₂ in that sample.
    The result is shown in Figure 7, and you can see that the bar chart matches the
    PDF of a binomial distribution with parameters *n*=5 and *p*₁+*p*₂.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 6 通过从多项分布中采样来近似 *X*₁+*X*₂ 的边际 PMF。它从方程 86 中的多项分布中抽取一个100,000大小的样本，并绘制该样本中
    *X*₁+*X*₂ 值的条形图。结果如图 7 所示，你可以看到条形图与参数 *n*=5 和 *p*₁+*p*₂ 的二项分布的 PDF 相匹配。
- en: '[PRE10]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/e9525bb33f72eca8ce42a7067aaf5c6f.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e9525bb33f72eca8ce42a7067aaf5c6f.png)'
- en: Figure 7
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7
- en: 'Listing 7 shows how sampling with replacement from a population of items with
    *k* different categories can result in a multinomial distribution (Figure 3).
    Here the population is represented by a list that has 3 unique elements: 1, 2,
    and 3\. The proportion of these elements is 0.5, 0.3, and 0.2\. We can randomly
    select 5 elements from this list and calculate the number of occurrences of 1,
    2, and 3 in that (we denote them by *x*₁, *x*₂, and *x*₃). Now the vector'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 7 展示了如何从具有 *k* 个不同类别的项的总体中进行有放回采样可以产生多项分布（图 3）。这里总体由一个具有 3 个独特元素的列表表示：1、2
    和 3。它们的比例分别是 0.5、0.3 和 0.2。我们可以从这个列表中随机选择 5 个元素，并计算 1、2 和 3 的出现次数（我们用 *x*₁、*x*₂
    和 *x*₃ 来表示）。现在这个向量
- en: '![](../Images/38549a3de678717d453ec1ebd4f12bbb.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/38549a3de678717d453ec1ebd4f12bbb.png)'
- en: is a random variate of the multinomial distribution in Equation 1\. We can also
    call it a random sample of size 1 from that distribution. Please note that we
    could also use the `rvs()` method to generate this random variate. We can now
    repeat the same procedure *n* times to draw a random sample of size *n* from the
    multinomial distribution. Listing 7 plots the bar chart of two random samples
    in Figure 8 (blue bars). The size of these samples is 30 and 50000 respectively.
    The bar chart of the joint PMF of the multinomial distribution defined in Equation
    1 is also plotted in this figure (red bars). As the sample size increases, the
    shape of the sample bar chart gets closer to the shape of the bar chart of the
    joint PMF of the multinomial distribution.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 是方程 1 中多项分布的随机变量。我们也可以将其称为从该分布中抽取的大小为 1 的随机样本。请注意，我们也可以使用 `rvs()` 方法生成这个随机变量。现在我们可以重复相同的过程
    *n* 次，从多项分布中抽取一个大小为 *n* 的随机样本。列表 7 在图 8（蓝色条形）中绘制了两个随机样本的条形图。这些样本的大小分别为 30 和 50000。图中还绘制了方程
    1 中定义的多项分布的联合 PMF 的条形图（红色条形）。随着样本大小的增加，样本条形图的形状越来越接近多项分布联合 PMF 的条形图的形状。
- en: '[PRE11]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](../Images/72f1a508acbc4cf272cfadbe573c3a0e.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/72f1a508acbc4cf272cfadbe573c3a0e.png)'
- en: Figure 8
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8
- en: 'In Listing 8, we compare the joint PMF of a random variable that has the multinomial
    distribution defined in Equation 1 with the joint PMF of the sum of *n* random
    vectors that have a multinomial distribution with parameters *n*=1 and ***p***.
    We first draw a sample of size 5000000 (`sample1`) from the multinomial distribution
    defined in Equation 1 which had these parameters:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在列表 8 中，我们比较了在方程 1 中定义的多项分布的随机变量的联合 PMF 与具有 *n* 个随机向量的和的联合 PMF，这些随机向量具有参数 *n*=1
    和 ***p***。我们首先从方程 1 中定义的多项分布中抽取一个5000000大小的样本（`sample1`），该多项分布具有以下参数：
- en: '![](../Images/fe9bc3af3e981e14ab2caef9f78eb551.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fe9bc3af3e981e14ab2caef9f78eb551.png)'
- en: Then we draw a sample of size 5000000 from 5 multinomial distributions with
    the same ***p*** and *n*=1\. We add these 5 samples together to have one sample
    of size 5000000 and store in `sample2`. In fact, this sample contains the values
    that the random vector
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们从5个具有相同***p***和*n*=1的多项分布中抽取一个5000000大小的样本。我们将这5个样本相加，得到一个5000000大小的样本并存储在`sample2`中。实际上，这个样本包含了随机向量
- en: '![](../Images/14c16ab241a7664c3d8d21d263270755.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/14c16ab241a7664c3d8d21d263270755.png)'
- en: can take.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 可以取。
- en: '[PRE12]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: We can now compare the probability of getting a specific value in `sample1`
    and `sample2`.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以比较在`sample1`和`sample2`中获得特定值的概率。
- en: '[PRE13]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: As you see the probabilities are very close, and the minor difference is due
    to the sample size. As the sample size goes to infinity, these probabilities tend
    to be the same.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所见，概率非常接近，微小的差异是由于样本大小的不同。随着样本大小趋于无穷大，这些概率趋于相同。
- en: 'As mentioned before, if we have:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，如果我们有：
- en: '![](../Images/25723813b57188dcbe469671c35beb31.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/25723813b57188dcbe469671c35beb31.png)'
- en: 'Then each *Xᵢ* has a binomial distribution with parameters *n* and *p*. So,
    using the properties of the binomial distribution we conclude that:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 然后每个*Xᵢ*具有参数*n*和*p*的二项分布。因此，利用二项分布的性质我们得出：
- en: '![](../Images/c92c6d3bbdd0acd217cc270d544d75bb.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c92c6d3bbdd0acd217cc270d544d75bb.png)'
- en: We define the mean of the random vector ***X*** as
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义随机向量***X***的均值为
- en: '![](../Images/3243c2cfebba7f3ff54062e9231f825e.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3243c2cfebba7f3ff54062e9231f825e.png)'
- en: 'We also showed that the sum of some of the elements of ***X*** has a binomial
    distribution. So, for each pair of *i*, *j* (*i*, *j*=1…*k*, *i*≠*j*) *Xᵢ* + *Xⱼ*
    has a binomial distribution with parameters *n* and *pᵢ* + *pⱼ*. Hence, we have:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还展示了***X***的一些元素的和具有二项分布。因此，对于每对*i*、*j* (*i*、*j*=1…*k*，*i*≠*j*)，*Xᵢ* + *Xⱼ*具有参数*n*和*pᵢ*
    + *pⱼ*的二项分布。因此，我们有：
- en: '![](../Images/5640dc1bdbd29453063d2d1a1e7835d7.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5640dc1bdbd29453063d2d1a1e7835d7.png)'
- en: 'It can be shown that:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 可以证明：
- en: '![](../Images/ba2228d70ce94cf5cfc8627ddddb04fd.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ba2228d70ce94cf5cfc8627ddddb04fd.png)'
- en: 'And it follows that:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 由此可以得出：
- en: '![](../Images/0d428986f45302172444bbba5baa326d.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0d428986f45302172444bbba5baa326d.png)'
- en: Since *n*, *pᵢ,* and *pⱼ* are positive numbers, we conclude that the covariance
    of *Xᵢ* and *Xⱼ* is always a negative number. Let’s see why the correlation is
    negative. A negative correlation between two random variables means that when
    one of them is high, the other one tends to be low and when one of them increases,
    the other one tends to decrease. We know that *X*₁+*X*₂+ …+ *Xₖ*=*n*, so assuming
    that all other components of ***X*** (all *Xm* where *m* ≠ *i*, *j*) are constant,
    any increase in *Xᵢ* should result in a decrease in *Xⱼ* and vice versa.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 由于*n*、*pᵢ*和*pⱼ*是正数，我们得出*Xᵢ*和*Xⱼ*的协方差总是负数。让我们看看为什么相关性是负的。两个随机变量之间的负相关意味着当其中一个变量较高时，另一个变量倾向于较低，并且当一个变量增加时，另一个变量倾向于减少。我们知道*X*₁+*X*₂+
    …+ *Xₖ*=*n*，所以假设***X***的所有其他分量（所有*m* ≠ *i*、*j*的*Xm*）都是常数，那么任何*Xᵢ*的增加都应该导致*Xⱼ*的减少，反之亦然。
- en: 'We define the covariance matrix of ***X*** as:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义***X***的协方差矩阵为：
- en: '![](../Images/6df9a1be2226f182707e589af3b8862f.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6df9a1be2226f182707e589af3b8862f.png)'
- en: So, the (*i, j*) element of the covariance matrix is the covariance of variables
    *Xᵢ* and *Xⱼ,* and the *i*th diagonal element gives the variance of *Xᵢ*. Based
    on the definition of covariance, we know that *Cov*(*Xᵢ*, *Xⱼ*)=*Cov*(*Xⱼ*, *Xᵢ*).
    So, the covariance matrix is a symmetric matrix in which the (*i*, *j*) element
    is equal to the (*j*, *i*) element.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，协方差矩阵中的(*i, j*)元素是变量*Xᵢ*和*Xⱼ*的协方差，而第*i*个对角元素给出了*Xᵢ*的方差。根据协方差的定义，我们知道*Cov*(*Xᵢ*,
    *Xⱼ*)=*Cov*(*Xⱼ*, *Xᵢ*)。因此，协方差矩阵是对称矩阵，其中的(*i*, *j*)元素等于(*j*, *i*)元素。
- en: 'We can easily calculate the mean and covariance matrix for the multinomial
    distribution defined in Equation 1 using Python. The method `mean()` returns the
    mean vector defined in Equation 2:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用Python轻松计算在方程1中定义的多项分布的均值和协方差矩阵。方法`mean()`返回方程2中定义的均值向量：
- en: '[PRE15]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The method `cov()` returns the covariance matrix (Equation 3):'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 方法`cov()`返回协方差矩阵（方程3）：
- en: '[PRE16]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: In this article, we discussed the math behind the multinomial distribution and
    showed you how to implement it in Python. The multinomial distribution is widely
    used in science, engineering, and finance. It can be used in applications where
    there are more than two possible outcomes and the system cannot be modeled by
    a success-failure description.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们讨论了多项分布背后的数学原理，并展示了如何在Python中实现它。多项分布在科学、工程和金融领域被广泛使用。它可以用于那些有超过两个可能结果的应用场景，并且系统不能通过成功-失败的描述进行建模。
- en: 'I hope that you enjoyed reading this article. Please let me know if you have
    any questions or suggestions. All the Code Listings in this article are available
    for download as a Jupyter notebook from GitHub at: [https://github.com/reza-bagheri/probability_distributions/blob/main/multinomial_distribution.ipynb](https://github.com/reza-bagheri/probability_distributions/blob/main/multinomial_distribution.ipynb)'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 希望你喜欢阅读这篇文章。如果你有任何问题或建议，请告诉我。本文中的所有代码列表可以从GitHub上作为Jupyter笔记本下载，链接为：[https://github.com/reza-bagheri/probability_distributions/blob/main/multinomial_distribution.ipynb](https://github.com/reza-bagheri/probability_distributions/blob/main/multinomial_distribution.ipynb)

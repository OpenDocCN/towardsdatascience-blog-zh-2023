- en: 'Probing into Minimum Sample Size Formula: Derivation and Usage'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探讨最小样本量公式：推导与应用
- en: 原文：[https://towardsdatascience.com/probing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b?source=collection_archive---------0-----------------------#2023-02-01](https://towardsdatascience.com/probing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b?source=collection_archive---------0-----------------------#2023-02-01)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/probing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b?source=collection_archive---------0-----------------------#2023-02-01](https://towardsdatascience.com/probing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b?source=collection_archive---------0-----------------------#2023-02-01)
- en: A gentle walkthrough of the sample size formula in A/B tests
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: A/B 测试中的样本量公式简明指南
- en: '[](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)[![Mintao
    Wei](../Images/eec1a909df8e780ac6a2c1f9d754ba75.png)](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)
    [Mintao Wei](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)[![Mintao
    Wei](../Images/eec1a909df8e780ac6a2c1f9d754ba75.png)](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)
    [Mintao Wei](https://medium.com/@weimintaottt?source=post_page-----8db9a556280b--------------------------------)'
- en: ·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6959c4b812af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&user=Mintao+Wei&userId=6959c4b812af&source=post_page-6959c4b812af----8db9a556280b---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)
    ·18 min read·Feb 1, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8db9a556280b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&user=Mintao+Wei&userId=6959c4b812af&source=-----8db9a556280b---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[关注](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6959c4b812af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&user=Mintao+Wei&userId=6959c4b812af&source=post_page-6959c4b812af----8db9a556280b---------------------post_header-----------)
    发表在 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8db9a556280b--------------------------------)
    · 18 分钟阅读 · 2023年2月1日 [](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8db9a556280b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&user=Mintao+Wei&userId=6959c4b812af&source=-----8db9a556280b---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8db9a556280b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&source=-----8db9a556280b---------------------bookmark_footer-----------)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8db9a556280b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobing-into-minimum-sample-size-formula-derivation-and-usage-8db9a556280b&source=-----8db9a556280b---------------------bookmark_footer-----------)'
- en: Too Long; Don’t Read
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 太长；不读
- en: 'This article answers two important “how-to” questions centering on the minimum
    sample size calculation in A/B tests:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本文回答了两个围绕A/B测试中最小样本量计算的重要“如何做”问题：
- en: '**1) How to derive the formula for the minimum sample size** 𝜨**?**'
  id: totrans-10
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**1) 如何推导最小样本量公式** 𝜨**?**'
- en: The essential idea behind the formula is to **reverse the p-value calculation
    in hypothesis testing**, with a particular focus on **statistical power**, which
    is the probability of rejecting the null hypothesis when the null hypothesis is
    indeed false.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 公式背后的核心思想是**反转假设检验中的p值计算**，特别关注于**统计功效**，即在原假设确实为假的情况下拒绝原假设的概率。
- en: '![](../Images/bf2c8037500f91060ac87fa8aee12159.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bf2c8037500f91060ac87fa8aee12159.png)'
- en: 'Figure 1: Intuition Behind Minimum Sample Size Calculation Formula'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图1：最小样本量计算公式的直观解释
- en: '**2) How to use the formula to calculate the minimum sample size in real-world
    scenarios?**'
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**2) 如何在现实场景中使用公式计算最小样本量？**'
- en: We use **historical data**, aggregated to the correct experiment unit, to calculate
    the **standard deviation** for our metric of interest as well as the historical
    average as the baseline level. Then, we **manually** determine the desired significance
    level **𝛼**, the statistical power **1-𝛽**, and most importantly, the minimum
    detectable effect we expect between the treatment group and the control group
    **𝑑𝑚𝑖𝑛**.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用**历史数据**，将其汇总到正确的实验单位，来计算我们感兴趣指标的**标准差**以及历史平均值作为基线水平。然后，我们**手动**确定所需的显著性水平**𝛼**、统计功效**1-𝛽**，以及最重要的，期望在处理组和对照组之间的最小可检测效果**𝑑𝑚𝑖𝑛**。
- en: These are the **four inputs** required for the sample size calculation. It is
    worthwhile to note that there are **trade-offs** between a *stronger statistical
    power* and a *longer experiment period* if we want to detect more subtle incremental
    lifts (small **𝑑𝑚𝑖𝑛).** Therefore, when designing A/B experiments, we often compute
    multiple versions of sample sizes under different levels of **𝑑𝑚𝑖𝑛** to quantify
    the trade-offs.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是样本量计算所需的**四个输入**。值得注意的是，如果我们想检测到更微妙的增量提升（小**𝑑𝑚𝑖𝑛**），则在*更强的统计能力*和*更长的实验周期*之间存在**权衡**。因此，在设计
    A/B 实验时，我们通常会计算在不同**𝑑𝑚𝑖𝑛**水平下的多个样本量版本，以量化这些权衡。
- en: Table of Contents
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 目录
- en: '[Why Should We Care](#d90b)'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[我们为什么要关心](#d90b)'
- en: '[Set-up](#6649)'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[设置](#6649)'
- en: '[I. Deriving Minimum Sample Size (The Naive Formulation/Without](#aa46) [𝛽](#529a)[)](#aa46)'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[I. 推导最小样本量（简单公式/无𝛽](#aa46) [𝛽](#529a)[)](#aa46)'
- en: • [Key Idea](#43b8)
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [关键思想](#43b8)
- en: • [Formula Derivation](#c172)
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [公式推导](#c172)
- en: '• [Example: Analyzing Download Speed Difference between Two Communities In
    Chicago](#516e)'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [示例：分析芝加哥两个社区之间的下载速度差异](#516e)
- en: '[II. Deriving Minimum Sample Size (The Standard Formulation/With 𝛽)](#529a)
    • [Key Idea](#6ea9) • [Formula Derivation](#2c44)'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[II. 推导最小样本量（标准公式/带𝛽）](#529a) • [关键思想](#6ea9) • [公式推导](#2c44)'
- en: '• [Example: “Demystifying” Evan’s Awesome A/B Sample Size Calculator](#b1ce)'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [示例：“揭开”Evan 的 A/B 样本量计算器的神秘面纱](#b1ce)
- en: '[Practical Issues](#76fa)'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[实际问题](#76fa)'
- en: • [How to derive the rule-of-thumb sample size from our general formula?](#efa2)
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [如何从我们的通用公式推导经验法则样本量？](#efa2)
- en: • [How to determine 𝑑𝑚𝑖𝑛?](#6675)
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [如何确定𝑑𝑚𝑖𝑛？](#6675)
- en: • [What if the variances and the sizes of the two groups are unequal?](#cdbd)
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [如果两个组的方差和样本量不相等怎么办？](#cdbd)
- en: • [How to estimate the standard deviation 𝜎 using historical data?](#44bd)
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [如何使用历史数据估算标准差𝜎？](#44bd)
- en: • [How much historical data do we need?](#9947)
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [我们需要多少历史数据？](#9947)
- en: • [How shall we prepare those data?](#a0a5)
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: • [我们应该如何准备这些数据？](#a0a5)
- en: '[Summary](#fc4f)'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[总结](#fc4f)'
- en: Why Shall We Care?
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么我们需要关心？
- en: 'In 2022/2023, it seems unnecessary to delve into the principles behind the
    formula when there are numerous built-up sample size calculators on the web (e.g.
    [Evan Miller’s Calculator](https://www.evanmiller.org/ab-testing/sample-size.html),
    [Optimizely](https://www.optimizely.com/sample-size-calculator/#/?conversion=3&effect=20&significance=95)),
    and when most tech firms have their own established experiment platforms and tools
    ready to use. Nevertheless, it is still important for us to know what is behind
    the scene because:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在 2022/2023 年，当网上有大量现成的样本量计算器（例如，[Evan Miller’s Calculator](https://www.evanmiller.org/ab-testing/sample-size.html)、[Optimizely](https://www.optimizely.com/sample-size-calculator/#/?conversion=3&effect=20&significance=95)）可用，以及大多数科技公司都有自己建立的实验平台和工具时，深入探讨公式背后的原理似乎没有必要。然而，了解这些原理仍然很重要，因为：
- en: A/B test sample size calculation is one of the most frequently asked questions
    in **product data scientist** **interviews**, and we are expected to give the
    rationale in addition to reciting the formula.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: A/B 测试样本量计算是**产品数据科学家****面试**中最常见的问题之一，我们需要不仅能够背诵公式，还要能解释其原理。
- en: In both the online randomized A/B testing and the offline controlled trials,
    the real-world business context can be complex, so we need to know the ins and
    outs of the formula to **select or adapt these tools** correctly and avoid fallacies.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在在线随机 A/B 测试和离线对照试验中，现实世界的业务背景可能很复杂，因此我们需要了解公式的来龙去脉，以**正确选择或调整这些工具**并避免谬误。
- en: Furthermore, it is critically important for us to build up the “**statistics
    acumen**” in hypothesis testing and power analysis because it is very common to
    encounter insignificant testing results due to insufficient sample size. We certainly
    want to sharpen our instinct for a possible type II error (neglecting a truly
    effective treatment strategy), and be prepared to estimate the required sample
    size for the next step. This goes beyond the typical data science work at tech
    companies to academia and research questions in our day-to-day life — “*Are female
    employees given less compensation than males?*”, “*Do wealthier communities have
    a better internet connection and download speed than underserved communities?*”,
    etc. We not only want to ask ourselves “is what we see from the data statistically
    significant?”, but also “**Do we have enough samples? If not, how much more data
    do we need or how many more surveys do we need to send out in the future?**”
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，我们在假设检验和功效分析中建立“**统计直觉**”至关重要，因为由于样本量不足，常常会遇到无显著性检验结果。我们当然希望提高对可能的第二类错误（忽视真正有效的处理策略）的敏感度，并准备估算下一步所需的样本量。这不仅仅涉及技术公司中的典型数据科学工作，还涉及学术界和日常生活中的研究问题——“*女性员工的薪酬是否低于男性？*”、“*财富更高的社区是否比欠发达社区有更好的互联网连接和下载速度？*”等。我们不仅要问自己“我们从数据中看到的是否具有统计学意义？”，还要问“**我们是否有足够的样本？如果没有，我们还需要多少数据或未来需要发送多少份调查问卷？**”
- en: There are many great introductory articles and resources on this topic, but
    most of them **simply “present” the formula**. Standing on their shoulders, I
    hope to go one step further here to delve into the intuitions and derivations
    and answer the question **“why are the formulas defined in this way”**. In addition,
    I will address some practical issues in using this formula.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 关于这个主题，有许多优秀的入门文章和资源，但大多数**仅仅“呈现”公式**。站在这些前人的肩膀上，我希望在这里进一步*深入探讨*直觉和推导，回答**“这些公式为何如此定义”**的问题。此外，我还将讨论使用这些公式的一些实际问题。
- en: Setup
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置
- en: Tests
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 测试
- en: The discussion of sample size calculation in this article will be mostly based
    on **two sample one-sided z-tests**.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 本文中样本量计算的讨论将主要基于**两个样本单侧z检验**。
- en: The reasons are that, in A/B testing scenarios, the testing statistics are usually
    sample mean (*e.g. average XXX per user between the experiment period, where all
    the behaviors for a specific user in this period are regarded as a sample, and
    this metric is just the sample mean statistic across all users*) and they are
    usually normally distributed according to the central limited theorem. The one-sided
    tests are preferred here as we usually have a clear **directional** belief on
    the treatment effect (i.e. the treatment group should perform better or worse
    than the controlled group.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 原因在于，在A/B测试场景中，测试统计量通常是样本均值（*例如实验期间每用户的平均XXX，其中该期间特定用户的所有行为被视为一个样本，而该指标只是所有用户的样本均值统计量*），并且通常根据中心极限定理呈正态分布。这里倾向于使用单侧检验，因为我们通常对处理效果有明确的**方向性**信念（即处理组应表现得比对照组更好或更差）。
- en: Notations and Concepts
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 符号和概念
- en: '𝜨: the minimum required sample size.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '𝜨: 最小所需样本量。'
- en: '**𝑝:** the p-value.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**𝑝:** p值。'
- en: '**𝛼:** the significance level, or the type I error.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**𝛼:** 显著性水平，或称为第一类错误。'
- en: '**𝛽:** the type II error. And 1-𝛽 denotes the statistical power.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**𝛽:** 第二类错误。1-𝛽表示统计功效。'
- en: '***X̄1/X̄2/X̄d*:** the random variables of the metrics mean statistics for
    observations in group 1 (control), group 2 (treatment), and the difference between
    the two random mean variables.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***X̄1/X̄2/X̄d*:** 第1组（对照组）、第2组（处理组）和两个随机均值变量之间差异的样本均值。'
- en: '***x̄1/x̄2/x̄d***: the sample means of the observations in group 1 (control),
    group 2 (treatment), and the difference between the two mean statistics.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***x̄1/x̄2/x̄d***: 第1组（对照组）、第2组（处理组）和两个均值统计量之间差异的样本均值。'
- en: '***z_(1-*𝛼*)***: the z-score that cuts off the top **𝛼(%)**, or the critical
    value of a standard normal distribution. For example, in the one-side test, ***z_(1–5%)=z_(95%)≈1.65;
    z_(1–2.5%)=z_(97.5%)≈1.96; z_(2.5%)≈-1.96.***'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***z_(1-*𝛼*)***: 切割顶部**𝛼(%)**的z分数，或标准正态分布的临界值。例如，在单侧检验中，***z_(1–5%)=z_(95%)≈1.65;
    z_(1–2.5%)=z_(97.5%)≈1.96; z_(2.5%)≈-1.96。***'
- en: '**𝜎:** the standard deviation of the observations in each group. We assume
    the standard deviations to be the same in the two groups (*we will also discuss
    how to adjust the formula when the variances are unequal*).'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**𝜎：**每组观察值的标准差。我们假设两个组的标准差相同（*我们还将讨论当方差不相等时如何调整公式*）。'
- en: '**𝑑𝑚𝑖𝑛:** the minimum detectable effect, that is the level of statistically
    significant difference that can be detected given the sample size 𝜨. For instance,
    if the conversion rate of the control group is 10% and **we expect** the treatment
    can actually increase the conversion from 10% to 15%(note that this is our expectation),
    then (the absolute) **𝑑𝑚𝑖𝑛** is 15%-10%=5%. Intuitively, if our **expected treatment
    effect is very small** (i.e. we are not confident of the treatment strategy),
    we will need many **more samples** to distinguish it from the natural variance
    because the true effect could be very subtle. If the minimum detectable effect
    is **large**, it should be fairly noticeable and thus **a small sample** will
    suffice to tell us whether the difference between the two groups is actually statistically
    significant or not.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**𝑑𝑚𝑖𝑛：**最小可检测效应，即在给定样本量 𝜨 的情况下，可以检测到的统计显著差异水平。例如，如果对照组的转换率为 10%，且**我们预期**处理能够将转换率从
    10% 实际提高到 15%（请注意这是我们的预期），则（绝对）**𝑑𝑚𝑖𝑛** 为 15%-10%=5%。直观地说，如果我们**预期的处理效应非常小**（即我们对处理策略没有信心），我们将需要更多的**样本**来将其与自然变异区分开，因为真实效应可能非常微弱。如果最小可检测效应**较大**，它应该相当显著，因此**少量样本**就足以告诉我们两组之间的差异是否实际具有统计学意义。'
- en: Goal
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 目标
- en: Given type I error **𝛼**, type II error **𝛽**, the standard deviation **𝜎**,
    and the minimum detectable effect **𝑑𝑚𝑖𝑛**, we want to estimate the minimum required
    sample size 𝜨 such that we have sufficient statistical power to detect a difference
    at least as large as **𝑑𝑚𝑖𝑛.**
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 给定 I 型错误**𝛼**、II 型错误**𝛽**、标准差**𝜎**和最小可检测效应**𝑑𝑚𝑖𝑛**，我们希望估计最小所需样本量 𝜨，以便我们有足够的统计功效来检测到至少与**𝑑𝑚𝑖𝑛**一样大的差异。
- en: In other words, the number of samples 𝜨 (only) guarantees us to detect the treatment
    effect or inter-group difference at least **𝑑𝑚𝑖𝑛**. If the real treatment effect
    is actually smaller than **𝑑𝑚𝑖𝑛**, we might not be able to distinguish such minor
    improvement from the natural variation.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，样本量 𝜨（仅）保证我们能检测到至少**𝑑𝑚𝑖𝑛**的处理效应或组间差异。如果实际的处理效应实际上小于**𝑑𝑚𝑖𝑛**，我们可能无法将这种微小的改进与自然变异区分开。
- en: I. Deriving Minimum Sample Size ( The Naive Formulation/Without **𝛽** )
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: I. 推导最小样本量（天真的公式/不考虑**𝛽**）
- en: While the statistical power **1-𝛽,** or the probability of detecting a difference
    when there is actually such one,is a crucial component in estimating meaning sample
    size, I found it hard to wrap my head around when I started to learn A/B tests.
    For this reason, in this article, we start off first with this *“naive”* version
    of the minimum sample size estimation, where only the significance level **𝛼**
    is considered, and then progress into the “formal” derivation in the next section,
    where the concept of statistical power steps in.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然统计功效**1-𝛽**，或者当实际上存在差异时检测差异的概率，是估计样本量的关键因素，但当我开始学习 A/B 测试时，我发现很难理解。因此，在本文中，我们首先从这种*“天真的”*最小样本量估计版本开始，仅考虑显著性水平**𝛼**，然后在下一节中逐步进入“正式”的推导，其中引入统计功效的概念。
- en: Key Idea
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关键思想
- en: The key idea to calculating the minimum required sample size is just the **reverse
    of hypothesis testing**, or put it differently, **asking the sample size *“as
    if the p-value is known to be the significance level* 𝛼*”***.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 计算最小所需样本量的关键思想就是**假设检验的逆过程**，或者换句话说，**询问样本量 *“就像 p 值已知为显著性水平* 𝛼*”***。
- en: Given two samples, we could compute the p-value based on the **sample mean,
    standard deviation**, and ***N***. In the words of *Figure 2*, we want the sample
    mean difference statistic***X̄d*** to **fall within the red area**, as that is
    the rejection region for the null hypothesis H0.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 给定两个样本，我们可以基于**样本均值、标准差**和***N***计算 p 值。用*图2*的话来说，我们希望样本均值差异统计量***X̄d*** **落在红色区域内**，因为这是原假设
    H0 的拒绝区域。
- en: '![](../Images/db7431cf1fd16c1599ac373fb5b0c925.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/db7431cf1fd16c1599ac373fb5b0c925.png)'
- en: 'Figure 2: Rejection Area and Critical Value in Hypothesis Testing (by Author)'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图2：假设检验中的拒绝区域和临界值（作者提供）
- en: Now, since the significance level 𝛼 is essentially the **threshold** of p-values,
    we could compute ***N*** if we know the **standard deviation 𝜎** from historical
    data and specify the level of **𝛼** as well as the expected difference between
    the two groups **𝑑𝑚𝑖𝑛** we want to detect. The minimum required sample size ***N***
    with this formulation guarantees us enough “significance” to detect the **𝑑𝑚𝑖𝑛**
    amount ofdifference between the two groups.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，由于显著性水平 𝛼 本质上是 p 值的 **阈值**，如果我们知道历史数据中的 **标准差 𝜎** 并指定 **𝛼** 的水平以及我们希望检测的两组之间的预期差异
    **𝑑𝑚𝑖𝑛**，我们可以计算 ***N***。这种公式下所需的最小样本量 ***N*** 确保我们有足够的“显著性”来检测两组之间的 **𝑑𝑚𝑖𝑛** 量的差异。
- en: Formula Derivation
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 公式推导
- en: 'Based on the above-mentioned idea, we could outline the high-level formula
    below, and I will discuss the derivation of ***N*** step-by-step centering this
    logic:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 基于上述思想，我们可以概述以下高级公式，我将围绕这个逻辑逐步讨论 ***N*** 的推导：
- en: '![](../Images/3c0da9ee95bef36782e0ff7b17649699.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3c0da9ee95bef36782e0ff7b17649699.png)'
- en: 'Formula 1: High-level Idea behind the Naive Minimum Sample Size Formulation
    (by Author)'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 1: 朴素最小样本量公式的高级概念（作者提供）'
- en: To start off, I would like to explicitly define our hypotheses and the testing
    statistic. The null hypothesis is that there is no statistical difference between
    the mean statistics of group 1 (control group) and group 2 (treatment group).
    The alternative hypothesis asserts that our treatment group is ‘better’ than the
    control group, indicating a one-sided test.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我想明确我们的假设和测试统计量。零假设是组 1（对照组）和组 2（处理组）的均值统计量之间没有统计学差异。备择假设则表明我们的处理组‘优于’对照组，表明这是一个单侧检验。
- en: '![](../Images/a6c705b17e02b1bf34086f1a7a3912f1.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a6c705b17e02b1bf34086f1a7a3912f1.png)'
- en: 'Formula 2: H0 and H1 in Two-sample One-sided T-test/Z-test (by Author)'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 2: 两样本单侧 T 检验/Z 检验中的 H0 和 H1（作者提供）'
- en: 'We focus on the difference in mean statistics of group 1 and group 2:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们关注的是组 1 和组 2 的均值统计量的差异：
- en: '![](../Images/4554e1e17b2cf83aa7a26f01c1723e1e.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4554e1e17b2cf83aa7a26f01c1723e1e.png)'
- en: 'Formula 3: Test Statistic for the Two-sample T-test/Z-test (by Author)'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 3: 双样本 T 检验/Z 检验的测试统计量（作者提供）'
- en: Let’s explore the distribution properties before delving any further. We don’t
    require any distribution assumptions for the two groups 𝛸1, 𝛸2, because their
    **sample mean statistics** as well as the derived **sample mean difference statistic**
    follow normal distributions according to the Central Limit Theorem.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在进一步探讨之前，让我们先探讨分布性质。我们不需要对两组 𝛸1、𝛸2 做任何分布假设，因为根据中心极限定理，它们的 **样本均值统计量** 以及推导出的
    **样本均值差异统计量** 遵循正态分布。
- en: '![](../Images/e3055ca906961dab057fdb26469f05eb.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e3055ca906961dab057fdb26469f05eb.png)'
- en: 'Formula 4: Distributional Properties of Key Random Variables and Test Statistics
    (by Author)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 4: 关键随机变量和测试统计量的分布性质（作者提供）'
- en: 'Recall p-value represents the probability for the random variable to obtain
    a value as or more extreme than the current sample statistic, assuming the null
    hypothesis is true. Therefore, the p-value and the z-statistic can be calculated
    by:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，p 值表示在零假设为真的情况下，随机变量获得一个值与当前样本统计量一样极端或更极端的概率。因此，p 值和 z 统计量可以通过以下公式计算：
- en: '![](../Images/10f93d853d31e7be3aa7b8a9b91edcce.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10f93d853d31e7be3aa7b8a9b91edcce.png)'
- en: 'Formula 5: P-value Formulation for the Two-Sample One-sided Z-test (by Author)'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 5: 两样本单侧 Z 检验的 p 值公式（作者提供）'
- en: 'Hence, if we were performing hypothesis testing, then we would reject the null
    hypothesis at **𝛼** significance level if our p-value is smaller than **𝛼**, or
    the sample z-statistic is greater than the critical z-value:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果我们进行假设检验，当我们的 p 值小于 **𝛼** 时，我们将以 **𝛼** 显著性水平拒绝零假设，或者样本 z 统计量大于临界 z 值：
- en: '![](../Images/6eb31af9bc882af659a92a3a077a6525.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6eb31af9bc882af659a92a3a077a6525.png)'
- en: 'Formula 6: Hypothesis Testing Criteria when H0 is rejected for Two-Sample One-sided
    T-test/Z-test (by Author)'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 6: 当 H0 被拒绝时的两样本单侧 T 检验/Z 检验的假设检验标准（作者提供）'
- en: Great! Now we derived the end formula for hypothesis testing given two sample
    groups. You may already notice 𝜨 in the denominator. Straightforward as it is,
    the minimum required sample size is computed by (1) treating ***x̄d*** as a pre-determined
    Minimum Detectable Effect (MDE or **𝑑𝑚𝑖𝑛**); (2) assuming the null hypothesis
    is true (μ2-μ1=0), and (3) asking for 𝜨 by reversing the inequation.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 太棒了！现在我们已经得出了给定两个样本组的假设检验最终公式。你可能已经注意到分母中有𝜨。尽管很简单，计算所需的最小样本量的方法是（1）将***x̄d***视为预定的最小可检测效应（MDE
    或 **𝑑𝑚𝑖𝑛**）；（2）假设原假设成立（μ2-μ1=0），以及（3）通过反转不等式来求𝜨。
- en: To conduct *hypothesis testing*, we compute ***x̄d*** by taking the difference
    between sample means from group 1 and group 2.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要进行*假设检验*，我们通过计算组1和组2之间的样本均值差异来计算***x̄d***。
- en: To calculate the *minimum sample size*, we replace the sample-based ***x̄d***
    with the expected Minimum Detectable Effect **𝑑𝑚𝑖𝑛**, which is the expected difference
    from group 1 (the control group) and group 2 (the treatment group), or in product
    analytics language, the potential incremental effect we anticipate our treatment
    strategy to obtain.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要计算*最小样本量*，我们用预期的最小可检测效应**𝑑𝑚𝑖𝑛**替换基于样本的***x̄d***，这代表了来自组1（对照组）和组2（处理组）的预期差异，或者在产品分析语言中，就是我们期望治疗策略带来的潜在增量效果。
- en: 'Accordingly, the derivation of 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**,and **𝜎** is illustrated
    below:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，给定**𝑑𝑚𝑖𝑛**、**𝛼**和**𝜎**的𝜨的推导如下：
- en: '![](../Images/efd580935995a198445f65466a799075.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/efd580935995a198445f65466a799075.png)'
- en: 'Formula 7: Derivation of 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**,and **𝜎** (by Author)'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 7：给定**𝑑𝑚𝑖𝑛**、**𝛼**和**𝜎**的𝜨的推导（作者）
- en: 'Example: Analyzing Download Speed Difference between Two Communities In Chicago'
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 示例：分析芝加哥两个社区之间的下载速度差异
- en: Let’s say you are a research assistant working with your professor. The team’s
    current research is about investigating internet inequity, which is measured by
    the **download speed, between underserved and wealthy communities,** and your
    professor has a very firm belief/hypothesis that there exists such inequity because
    of the differences in the infrastructure, service providers, and so forth.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你是一个研究助理，与你的教授一起工作。团队当前的研究是调查互联网不平等，这通过**下载速度，在服务不足和富裕社区之间**来衡量，你的教授坚信/假设存在这种不平等，因为基础设施、服务提供商等方面存在差异。
- en: The two geographic communities of focus are *Lincoln Park (Northside Chicago,
    one of the most affluent neighborhoods)* and *South Shore (Southside Chicago,
    usually considered an underserved community)*. The team has already surveyed **10
    randomly-selected households in each community**, and the professor asked you
    to conduct the data analysis to validate his hypothesis.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 两个关注的地理社区是*林肯公园（芝加哥北区，最富裕的社区之一）*和*南岸（芝加哥南区，通常被认为是服务不足的社区）*。团队已经对**每个社区的10个随机选择的家庭**进行了调查，教授让你进行数据分析以验证他的假设。
- en: 'Table 1: The Initial Small Sample (N=10) (Synthetic Data, Made-up by Author)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 表 1：初步小样本（N=10）（合成数据，作者编造）
- en: You realized **t-tests** could be a good candidate to check **if there is a
    statistically significant difference in average download speed per household between
    Lincoln Park and South Shore.** However, after putting together the number, you
    found the result is **not statistically significant**, and you believe it is because
    the **sample size is too small** that the actual difference is covered by the
    natural variation.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 你意识到**t检验**可能是检查**林肯公园和南岸之间每个家庭平均下载速度是否存在统计显著差异**的一个好方法。然而，在整理数据后，你发现结果是**不具有统计显著性**，你认为这是因为**样本量太小**，实际差异被自然变异所掩盖。
- en: 'The next question arises: **How many more samples should you suggest the team
    collect?** We need to know **three numbers:** **𝛼**, **𝜎, and 𝑑𝑚𝑖𝑛** to calculate
    the minimum required sample size, according to the formula in *Formula 7*.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来出现的问题是：**你建议团队收集多少更多的样本？** 我们需要知道**三个数字：** **𝛼**、**𝜎** 和 **𝑑𝑚𝑖𝑛**来根据*公式 7*
    计算所需的最小样本量。
- en: 'We usually specify a 5% significance level and the standard deviation can be
    approximated using the sample standard deviation of group 1, assuming homogenous
    variance. For **𝑑𝑚𝑖𝑛**, we need to talk with the Professor to borrow the domain
    knowledge and determine the expected difference between *group 1 (South Shore)*
    and *group 2 (Lincoln Park)*. For now, let’s assume Professor suggests that the
    expected difference, or the minimum detectable lift (%), in household download
    speed between these two communities should be 1%. Therefore, we have:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通常指定 5% 的显著性水平，并且在假设方差齐性的情况下，标准差可以用组 1 的样本标准差进行近似。对于**𝑑𝑚𝑖𝑛**，我们需要与教授沟通，借用领域知识并确定*组
    1（南岸）*和*组 2（林肯公园）*之间的预期差异。目前，假设教授建议这两个社区之间家庭下载速度的预期差异或最小可检测提升（%）应为 1%。因此，我们得到：
- en: '![](../Images/b43bb9acf26fd5d5403a19f35e2a7138.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b43bb9acf26fd5d5403a19f35e2a7138.png)'
- en: 'Formula 8: Specifications of **𝛼**, **𝜎**, and **𝑑𝑚𝑖𝑛** in the Download Speed
    Example(by Author)'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 8: **𝛼**、**𝜎** 和 **𝑑𝑚𝑖𝑛** 在下载速度示例中的规格（作者提供）'
- en: Plugging in these numbers, we are able to calculate the minimum required sample
    size, which is **77**. This number implies that we should survey **67** more households
    (we already have 10) and this larger sample (***N*=77**) would enable us to detect
    the **1%** or larger difference in download internet speed if there does exist
    such difference between the two communities in Chicago.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 插入这些数字后，我们能够计算出所需的最低样本量，为 **77**。这个数字意味着我们应该调查 **67** 户家庭（我们已经有 10 户），而这个更大的样本（***N*=77**）将使我们能够检测到
    **1%** 或更大的下载互联网速度差异，前提是这两个社区之间确实存在这样的差异。
- en: '![](../Images/4f20229e226cc2828d693c8c74fedaa2.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4f20229e226cc2828d693c8c74fedaa2.png)'
- en: 'Formula 9: Illustration of Calculating 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**,and **𝜎** in
    the Download Speed Example (by Author)'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '公式 9: 计算给定 **𝑑𝑚𝑖𝑛**、**𝛼** 和 **𝜎** 的 𝜨 的示例（作者提供）'
- en: 'The full Python implementation can be found on my [GitHub Gist](https://gist.github.com/mintaow/30506b7c2ae54da5d13623a3e4595beb)
    or the embedded notebook as follow:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的 Python 实现可以在我的 [GitHub Gist](https://gist.github.com/mintaow/30506b7c2ae54da5d13623a3e4595beb)
    上找到，或嵌入的笔记本如下：
- en: II. Deriving Minimum Sample Size ( The Standard Formulation/With **𝛽 )**
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: II. 推导最低样本量（标准公式/与 **𝛽**）
- en: Key Idea
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关键思想
- en: 'When designing and launching A/B tests at tech firms, in most cases, we not
    only care about obtaining significant p-values to reject the null hypothesis,
    but more importantly, to **reject the null hypothesis when it is actually wrong**,
    which indicates that our treatment is indeed effective rather than a Type I error.
    Therefore, the sample size we require needs to have sufficient **statistical power
    (1-𝛽)** to detect such treatment effects**.** Graphically, as illustrated in *Figure
    3*, what we most ‘desire’ are two things:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在科技公司设计和启动 A/B 测试时，我们通常不仅关心获得显著的 p 值以拒绝原假设，更重要的是在原假设确实错误时**拒绝原假设**，这表明我们的处理确实有效，而不是第一类错误。因此，我们所需的样本量需要有足够的**统计功效
    (1-𝛽)** 来检测这种处理效应。**图形上，如*图 3*所示，我们最‘渴望’的是两件事：
- en: The sample statistic (***X̄d***) **falls beyond the critical value**, as that
    is the rejection region for H0.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 样本统计量（***X̄d***）**超出了临界值**，因为这是 H0 的拒绝区域。
- en: The sample statistic (***X̄d***) **falls within the** **blue-shaded regions
    in the distribution Ha** because the blue area represents the alternative distribution,
    indicating the population difference between the treatment group and the control
    group is not zero.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 样本统计量（***X̄d***）**落在** **分布 Ha 中的蓝色阴影区域**，因为蓝色区域代表了替代分布，表示处理组和对照组之间的总体差异不为零。
- en: That is the key idea to calculating the minimum required sample size.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这是计算所需最低样本量的关键思想。
- en: '![](../Images/a852c0f5f3fa4d0d514829dce67dc71a.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a852c0f5f3fa4d0d514829dce67dc71a.png)'
- en: 'Figure 3: Rejection Area, Critical Value, Statistical Power in Hypothesis Testing
    (by Author)'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '图 3: 假设检验中的拒绝区域、临界值、统计功效（作者提供）'
- en: The transition in the formula from the above-mentioned **naive version** to
    the **formal representation**, reflecting the consideration of the statistical
    power **1-𝛽**, is demonstrated below. The required sample size **increases** as
    the critical value specified by **1-𝛽** is added to the numerator, which makes
    sense because we are “buying in” more efficiency in our inference.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 从上述提到的**朴素版本**到**正式表示**的公式转换，反映了统计功效 **1-𝛽** 的考虑，如下所示。随着由 **1-𝛽** 指定的临界值添加到分子中，所需的样本量
    **增加**，这很有意义，因为我们在推断中“购买”了更多的效率。
- en: '![](../Images/a39c7a36a33cf0b5983da1d333b70bf3.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a39c7a36a33cf0b5983da1d333b70bf3.png)'
- en: 'Formula 10: From Naive Formulation to Standard Formulation in Sample Size Estimation
    (by Author)'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 10：样本大小估计中的从简单公式到标准公式（作者）
- en: Another perspective is that the minimum required sample size for A/B tests is
    an extension of that of the naive version discussed above because the Type II
    Error **𝛽** is now included/controlled. The logic of calculating the minimum sample
    size is still the **reverse of hypothesis testing** except that we need to consider
    two distributions, H0 and H1, and to incorporate both the type-I error/significance
    level **𝛼** and type-II error **𝛽**.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种看法是，A/B测试所需的最小样本大小是上述简单版本的扩展，因为现在包含/控制了第二类错误**𝛽**。计算最小样本大小的逻辑仍然是**假设检验的反向**，只是我们需要考虑两种分布H0和H1，并纳入第一类错误/显著性水平**𝛼**和第二类错误**𝛽**。
- en: Formula Derivation
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 公式推导
- en: Accordingly, we set up our high-level formula by asserting the probability of
    rejecting false H0 to be smaller than the pre-specified **statistical power (1-𝛽)**
    as below.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们通过设定拒绝错误H0的概率小于预设的**统计功效 (1-𝛽)** 来建立我们的高阶公式，如下所示。
- en: Notice that we are now conditioning on H1 being the actual distribution where
    the statistic originates, rather than H0, which assumes no difference between
    the population in the treatment group and the control group.
  id: totrans-117
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 请注意，我们现在是在以H1作为统计量来源的实际分布进行条件化，而不是H0，后者假设处理组和对照组之间没有差异。
- en: '![](../Images/2be251a26867188d4cc0fb7627f3deca.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2be251a26867188d4cc0fb7627f3deca.png)'
- en: 'Formula 11: High-level Idea behind the Formal Minimum Sample Size Derivation
    (by Author)'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 11：正式最小样本大小推导背后的高阶思路（作者）
- en: 'There are **4 inputs** to calculate the minimum required sample size:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 计算最小所需样本大小需要**4个输入**：
- en: The significance level **𝛼** we need to specify
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要指定显著性水平**𝛼**
- en: The statistical power **1-𝛽** we need to specify
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要指定的统计功效**1-𝛽**
- en: The standard deviation **𝜎**, which we can calculate from historical data
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 标准差**𝜎**，我们可以从历史数据中计算得出
- en: The magnitude of the expected treatment effect, or the difference between the
    two groups **𝑑𝑚𝑖𝑛 (**μ2-μ1**)** we want to detect.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 期望的处理效应大小，即我们想要检测的两个组之间的差异**𝑑𝑚𝑖𝑛 (**μ2-μ1**)**。
- en: Recall that the sample means difference statistic follows a normal distribution
    with the mean of **μ2-μ1** and the standard deviation of the squared root of **2*𝜎/N*.***
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾一下，样本均值差异统计量遵循正态分布，其均值为**μ2-μ1**，标准差为**2*𝜎/N*的平方根**。
- en: '![](../Images/b6d981dd4a80bdacdbfcb3d609531f03.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b6d981dd4a80bdacdbfcb3d609531f03.png)'
- en: 'Formula 12: Distributional Properties of Key Random Variables and Test Statistics
    (by Author)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 12：关键随机变量和检验统计量的分布特性（作者）
- en: The derivations of the high-level formula above comprise two steps. First, we
    represent ***x_crit***, or the critical value to reject the null hypothesis when
    H0 is assumed to be true, using **𝛼**.Second, we solve for the minimum sample
    size 𝜨 using **𝑑𝑚𝑖𝑛**, **𝛼**, **𝛽**.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 上述高阶公式的推导包括两个步骤。首先，我们使用**𝛼**表示***x_crit***，即当假设H0为真时拒绝原假设的临界值。其次，我们使用**𝑑𝑚𝑖𝑛**、**𝛼**和**𝛽**求解最小样本大小𝜨。
- en: '![](../Images/964eae2f8a0398eb08e6f897fbbb4d30.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/964eae2f8a0398eb08e6f897fbbb4d30.png)'
- en: 'Formula 13: Derivation of 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**, **𝛽,** and **𝜎** (by Author)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 13：给定**𝑑𝑚𝑖𝑛**、**𝛼**、**𝛽**和**𝜎**的𝜨推导（作者）
- en: 'Example: “Demystifying” Evan’s Awesome A/B Sample Size Calculator'
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 示例：“揭示”埃文的神奇A/B样本大小计算器
- en: This “simple” but elegant [A/B sample size calculator tool](https://www.evanmiller.org/ab-testing/sample-size.html),
    shown in *Figure 4*, was created and published by [Evan Miller](https://www.evanmiller.org/).
    It is referred to in the great introductory A/B test course series by Udacity
    and Google, and thus has become the first A/B test tool for many data science
    students, including me. While these sample-size calculator tools can be very convenient
    to use, people may have concerns and would not fully trust them because there
    are usually no concrete explanations about the logic behind the output. Therefore,
    I hope to provide a short briefing to help lift the curtain and demonstrate how
    these calculators work.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 这个“简单”但优雅的 [A/B样本量计算工具](https://www.evanmiller.org/ab-testing/sample-size.html)，如*图4*所示，是由
    [Evan Miller](https://www.evanmiller.org/) 创建并发布的。它在Udacity和Google的优秀A/B测试入门课程系列中被提及，因此成为了许多数据科学学生，包括我在内的首选A/B测试工具。虽然这些样本量计算工具非常方便使用，但人们可能会担心，并不会完全信任它们，因为通常没有具体解释输出背后的逻辑。因此，我希望提供一个简要说明，以帮助揭开帷幕，展示这些计算器是如何工作的。
- en: '![](../Images/5963a4a04cb070ebc59fdb7b5b6e6396.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5963a4a04cb070ebc59fdb7b5b6e6396.png)'
- en: 'Figure 4: Evan Miller’s Sample Size Calculator'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图4：Evan Miller的样本量计算器
- en: First and foremost, Evan’s A/B test sample size calculator is curated specifically
    for the **z-proportional test** where the key metric of interest is a proportion
    (I believe the other article I wrote, [*How to Select the Right Statistical Tests
    for Different A/B Metrics*](https://medium.com/towards-data-science/how-to-select-the-right-statistical-tests-for-different-a-b-metrics-c8a1865851e),
    would be helpful if you are interested in different types of statistical testing).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，Evan的A/B测试样本量计算器专门针对**z-比例检验**，其中关键指标是比例（如果你对不同类型的统计测试感兴趣，我认为我写的另一篇文章 [*如何选择适合不同A/B指标的统计测试*](https://medium.com/towards-data-science/how-to-select-the-right-statistical-tests-for-different-a-b-metrics-c8a1865851e)
    会对你有帮助）。
- en: It is worthwhile to note that **when estimating the sample size for proportional
    metrics, we don’t need to input the standard deviation.** This is because the
    proportional metric such as conversion rate can be viewed as an aggregation of
    the conversion statuses for all the users. And since a **user is either converted
    or not converted**, which in statistical language, is a **random Bernoulli event**
    denoted as *Bernoulli(p)*. Therefore, the analytical variance estimate for the
    conversion rate is **𝑝∗(1-𝑝)**. What this nice property implies is that we don’t
    “need” to input the standard deviation to calculate the minimum sample size because
    we could always estimate the true analytical standard deviation using the sample
    average conversion rate **𝑝**, which is the **baseline conversion rate**, as phrased
    in the input box of Evan’s calculator.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，**在估计比例指标的样本量时，我们不需要输入标准差。** 这是因为像转化率这样的比例指标可以被视为所有用户转化状态的聚合。而且因为**用户要么转化，要么未转化**，用统计学语言来说，这是一个**随机伯努利事件**，记作*Bernoulli(p)*。因此，转化率的分析方差估计为**𝑝∗(1-𝑝)**。这一良好性质意味着我们“不需要”输入标准差来计算最小样本量，因为我们总是可以使用样本平均转化率**𝑝**来估计真实的分析标准差，而**𝑝**就是**基线转化率**，如Evan的计算器输入框中所述。
- en: 'With this important idea in mind, let’s delve into the tool (*Figure 4*). The
    tool asks for four inputs:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 牢记这一重要概念，让我们深入了解这个工具（*图4*）。该工具需要四个输入：
- en: 'Baseline conversion rate **𝑝**: let’s assume the current conversion level is
    20%.'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基线转化率 **𝑝**：假设当前转化水平为20%。
- en: 'Minimum detectable effect (MDE): The definition here can be tricky, but the
    idea is simple. There are “**absolute**” MDE and “**relative**” MDE. An absolute
    MDE of 5% states the sample size we calculated can only detect the range between
    15% and 25%, while the relative MDE defines the detectable range to be 20%*(1–5%)
    and 20%*(1+5%). For instance, if our product manager believes launching this new
    product feature will increase the conversion rate from 20% to 25%, then it means
    we should set **𝑑𝑚𝑖𝑛** as 5%, or the absolute MDE to be 5%, or the relative MDE
    to be 25% because 20%*1/4=5%.'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最小可检测效应（MDE）：这里的定义可能有些棘手，但概念很简单。有“**绝对**”MDE和“**相对**”MDE。5%的绝对MDE表示我们计算的样本量只能检测15%到25%之间的范围，而相对MDE定义了可检测的范围为20%*(1–5%)和20%*(1+5%)。例如，如果我们的产品经理认为推出这个新产品功能会将转化率从20%提高到25%，那么这意味着我们应该将**𝑑𝑚𝑖𝑛**设置为5%，或者将绝对MDE设置为5%，或者将相对MDE设置为25%，因为20%*1/4=5%。
- en: Statistical power **1-𝛽**
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 统计功效 **1-𝛽**
- en: Significance level **𝛼**
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显著性水平 **𝛼**
- en: 'Arranging them into the formula we have established so far:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 将其整理成我们目前建立的公式：
- en: '![](../Images/89d3a43a4d6283f7fb34b31e733895a1.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/89d3a43a4d6283f7fb34b31e733895a1.png)'
- en: 'Formula 14: Illustration of Calculating 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**, **𝛽,** and
    **𝜎** (two-sided)in the A/B Tool Example (by Author). The difference between the
    hand-calculated sample size (1003) is slightly different from the result produced
    by the A/B test tool (1030), which is likely to be the rounding differences in
    precision.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 公式14：给定**𝑑𝑚𝑖𝑛**、**𝛼**、**𝛽**和**𝜎**（双侧）在A/B工具示例中的计算𝜨的说明（作者提供）。手动计算的样本量（1003）与A/B测试工具生成的结果（1030）略有不同，这可能是精度舍入差异造成的。
- en: '![](../Images/e9258cc1c903df2fac9dce58147a61af.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e9258cc1c903df2fac9dce58147a61af.png)'
- en: 'Formula 14: Illustration of Calculating 𝜨 given **𝑑𝑚𝑖𝑛**, **𝛼**, **𝛽,** and
    **𝜎** (two-sided)in the A/B Tool Example (by Author)'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 公式14：给定**𝑑𝑚𝑖𝑛**、**𝛼**、**𝛽**和**𝜎**（双侧）在A/B工具示例中的计算𝜨的说明（作者提供）
- en: 'Talk is cheap:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 说话便宜：
- en: by Author
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 作者
- en: Practical Issues
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实际问题
- en: I consider *Formula 13* as the general form of the minimum required sample size.
    The **Practical Issues** section below discusses several important extensions
    to more specific cases. For instance, when variances are not equal when the metrics
    are proportional ratios, and the relationship to a rule-of-thumb formula when
    the two-sided test is used.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 我认为*公式13*是最小所需样本量的一般形式。以下**实际问题**部分讨论了对更具体情况的几个重要扩展。例如，当方差不等时，当指标是比例时，双侧测试使用时与经验法则公式的关系。
- en: '**How to derive the rule-of-thumb sample size from our general formula?**'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '**如何从我们的通用公式推导出经验法则样本量？**'
- en: Many resources mentioned a handy formula that ***N*** is equal to **16*𝜎2/𝑑𝑚𝑖𝑛**.
    This can be easily transformed if we are doing **two-sided tests** and we specify
    **𝛼 = 0.05**, **𝛽 = 0.2** and we can round the squared sum of the two z-scores
    times 2 up to 16\. See *Equation 17.6 in <Trustworthy Online Controlled Experiment>*
    or *Belle (2008)* for more details.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 许多资源提到一个方便的公式，***N***等于**16*𝜎2/𝑑𝑚𝑖𝑛**。如果我们进行**双侧测试**并指定**𝛼 = 0.05**、**𝛽 = 0.2**，我们可以将两个z分数平方和乘以2的结果四舍五入到16。有关更多详细信息，请参见*《可信的在线对照实验》第17.6方程*或*Belle（2008）*。
- en: '![](../Images/1d69a05d4d667f33248db958a9b9724c.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1d69a05d4d667f33248db958a9b9724c.png)'
- en: 'Formula 15: From the General Form to the Rule-of-Thumb Form (by Author)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 公式15：从一般形式到经验法则形式（作者提供）
- en: '**How to determine 𝑑𝑚𝑖𝑛?**'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**如何确定𝑑𝑚𝑖𝑛？**'
- en: 'I personally think that **𝑑𝑚𝑖𝑛** orthe Minimum Detectable Effect (MDE) should
    be determined through **close discussions between PM and DS**. It is a hard decision
    that requires careful communication and business intuition:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 我个人认为，**𝑑𝑚𝑖𝑛**或最小可检测效应（MDE）应通过**PM和DS之间的密切讨论**来确定。这是一个需要仔细沟通和商业直觉的艰难决定：
- en: DS can contribute insights relevant to (1) MDEs of similar historical experiments;
    (2) the magnitude of the volatility of key metrics; (3) the amount of available
    traffic/samples for the A/B test.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DS可以提供与以下内容相关的见解：（1）类似历史实验的MDE；（2）关键指标的波动幅度；（3）A/B测试的可用流量/样本量。
- en: PM can contribute insights relevant to (1) the expected magnitude of potential
    treatment effect; (2) the amount of confidence we have; (3) the importance/scope
    of this testing treatment; (4) the urgency/timeline of this testing treatment.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PM可以提供与以下内容相关的见解：（1）潜在处理效应的预期大小；（2）我们所拥有的信心量；（3）此测试处理的重要性/范围；（4）此测试处理的紧迫性/时间表。
- en: Back-and-forth communications might be needed, as a **trade-off** between **higher
    statistical power** and a **longer experiment period** emerges. Suppose the treatment
    effect is subtle (i.e. 𝑑𝑚𝑖𝑛 shall be set to be small) and requires higher statistical
    power to detect. In that case, we must accumulate more samples and thus expect
    a longer timeframe given the daily traffic is usually unchanged.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 可能需要反复沟通，因为**更高统计功效**与**更长实验周期**之间存在**权衡**。假设处理效应很微弱（即𝑑𝑚𝑖𝑛应设定为较小），且需要更高的统计功效来检测。在这种情况下，我们必须积累更多样本，因此在日常流量通常不变的情况下，预计需要更长时间。
- en: 'Tricky as it is to settle on **𝑑𝑚𝑖𝑛**, I would recommend a way of organizing
    scenarios under different **𝑑𝑚𝑖𝑛** and corresponding required sample sizes into
    a table as *Table 2 (The original Google Sheet table can be accessed through*
    [*here*](https://docs.google.com/spreadsheets/d/1I8dhHtYu42AoD-BCbM1I2PaGfH2zAbvgQcwd6RDLnuE/edit?usp=sharing)*)*.
    We data scientists first **pick a few possible MDEs** and **calculate the corresponding
    sample sizes** as well as **the number of days required**. The MDEs can be easily
    manipulated at any time and the table provides us with a straightforward comparative
    illustration so that it is easy to communicate with product managers regarding
    the above-mentioned trade-off:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管确定**𝑑𝑚𝑖𝑛**是棘手的，我建议将不同**𝑑𝑚𝑖𝑛**及其对应的样本量组织成表格，如*表2（原始Google表格可以通过* [*这里*](https://docs.google.com/spreadsheets/d/1I8dhHtYu42AoD-BCbM1I2PaGfH2zAbvgQcwd6RDLnuE/edit?usp=sharing)
    *)*。我们数据科学家首先**选择几个可能的MDEs**并**计算相应的样本量**以及**所需天数**。MDEs可以随时轻松调整，表格为我们提供了一个直接的对比示例，使我们能够与产品经理就上述权衡进行沟通：
- en: '![](../Images/33a5ef4f4cbbc5000d636ecb8392a549.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/33a5ef4f4cbbc5000d636ecb8392a549.png)'
- en: 'Table 2: A Sample Table to Calculate Minimum Required Sample Sizes under Different
    MDEs (**𝑑𝑚𝑖𝑛**) (by Author)'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 表2：计算不同MDEs（**𝑑𝑚𝑖𝑛**）下所需最小样本量的示例表（作者提供）
- en: '**What if the variances and the sizes of the two groups are unequal?**'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果两组的方差和样本量不相等呢？**'
- en: It is very common that the two groups have different variances, especially in
    observational studies. While the homogenous-variance assumption fails, only trivial
    efforts are needed, that is to **replace 2*𝜎2 with the sum of treatment group
    variance and control group variance** when adapting the formula.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在观察性研究中，两组之间有不同方差是非常常见的。当同质方差假设不成立时，只需做一些微不足道的调整，即在调整公式时**用处理组方差和对照组方差的总和替代2*𝜎2**。
- en: '![](../Images/638710eee635e80bca1211eaa93599b2.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/638710eee635e80bca1211eaa93599b2.png)'
- en: 'Formula 16: Adapting Sample Size Formula (12) under Unequal Variances (by Author)'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 公式16：在方差不等情况下调整样本量公式（作者提供）
- en: What’s more, we could further release the implicit assumption that we have an
    **equal portion** of the traffic between the treatment group and the control group.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 更重要的是，我们可以进一步释放隐含的假设，即处理组和对照组之间的流量是**相等的**。
- en: 'As you may have already noticed, the scale of the normally distributed sample
    means difference statistic demonstrated above is the population version of the
    so-called **pooled standard deviation** that we often see in online posts:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你可能已经注意到的，以上展示的正态分布样本均值差异统计量的尺度是我们在网上帖子中经常看到的所谓**汇总标准差**的人口版本：
- en: '![](../Images/3844fdd89e6e1bc8152da950971f75cb.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3844fdd89e6e1bc8152da950971f75cb.png)'
- en: 'Formula 17: Pooled Standard Deviation Formulation (by Author)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 公式17：汇总标准差公式（作者提供）
- en: '**How to estimate the standard deviation 𝜎 using historical data?**'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '**如何使用历史数据估计标准差𝜎？**'
- en: In A/B test scenarios, in order to gauge the potential traffic as well as the
    time length needed, sample size calculations are usually performed before the
    launch of the experiments. The (only) resource for the computation is historical
    data. The questions are thus, how much historical data do we need, and how shall
    we prepare those data?
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在A/B测试场景中，为了评估潜在的流量及所需时间，样本量计算通常在实验开始前进行。计算的（唯一）资源是历史数据。因此，问题是我们需要多少历史数据，如何准备这些数据？
- en: '**How much historical data do we need?**'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '**我们需要多少历史数据？**'
- en: It is advised that we use approximately the **same time length** of the past
    data as the expected A/B test period. In addition, the caveats are that we need
    to make sure the **scope of the historical data** is consistent with the treatment
    strategies. Otherwise, external validity is not guaranteed. For instance, if the
    product managers want to test the effectiveness of enlarging the size of the “Next”
    button and they hope to gather the experiment results about whether the conversion
    rate increases in two weeks, then we want to collect the conversion rate data
    for those eligible users who were (supposed to be) exposed to this button in the
    past two weeks.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 建议使用过去数据的大致**相同时间长度**作为预期的A/B测试周期。此外，需要注意的是，我们必须确保**历史数据的范围**与处理策略一致。否则，外部有效性无法保证。例如，如果产品经理想测试扩大“下一步”按钮的效果，并希望在两周内收集有关转化率是否增加的实验结果，那么我们需要收集过去两周内曾（应当）接触过该按钮的合格用户的转化率数据。
- en: '**How shall we prepare those data?**'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '**我们应如何准备这些数据？**'
- en: Aside from **selecting the right time frame** and **applying appropriate filters**
    to the historical data, we want to make sure the data are aggregated in a correct
    way such that the unit of analysis matches the unit of randomization. In other
    words, if the traffic is randomly diverted at the user level, considering the
    source data for the metrics are usually user-behavior level, we need to group
    by each user and aggregate their actions to calculate the metrics, before computing
    the historical sample mean and the standard deviations, which will be used to
    compute the required sample size.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 除了**选择正确的时间范围**和**应用适当的过滤器**到历史数据中，我们还要确保数据以正确的方式进行聚合，以便分析单元与随机化单元相匹配。换句话说，如果流量是在用户层面随机分配的，而用于度量的源数据通常是用户行为层面的，我们需要按每个用户进行分组，并聚合他们的行为以计算度量，然后计算历史样本均值和标准差，这将用于计算所需的样本大小。
- en: Summary
  id: totrans-177
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'In this article, we probed into the derivation of the minimal sample size formula
    and discuss the practical issues extensively in using the formula. You’ve learned:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们探讨了最小样本大小公式的推导，并广泛讨论了使用该公式的实际问题。你已学到：
- en: How to **derive the minimum sample size formula** in A/B tests
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何**推导A/B测试中的最小样本大小公式**
- en: How to **understand the many online sample size calculators** as well as **other
    versions** of the minimum sample size formulas.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何**理解许多在线样本大小计算器**以及**其他版本**的最小样本大小公式。
- en: How to **use this formula** to calculate the sample size by preparing the historical
    data into the right format, discussing with product managers3 to determine **𝑑𝑚𝑖𝑛**
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何**使用这个公式**来计算样本大小，通过将历史数据准备成正确的格式，与产品经理讨论以确定**𝑑𝑚𝑖𝑛**
- en: This article is particularly inspired and grounded upon *<Trustworthy Online
    Controlled Experiments>* by Diane Tang, Ron Kohavi, and Ya Xu, Emma Ding’s Youtube
    video “*How to Estimate Sample Size in A/B Tests*”, and my in-take from my work
    at TikTok.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 这篇文章特别受到*<可信的在线受控实验>*（作者：Diane Tang, Ron Kohavi, 和 Ya Xu）、Emma Ding 的 YouTube
    视频“*如何估算A/B测试中的样本大小*”以及我在 TikTok 工作中的经验的启发和基础。
- en: References
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: '[Ding, E. (2021). How to Estimate Sample Size in A/B Tests. *Youtube*.](https://www.youtube.com/watch?v=JEAsoUrX6KQ)'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Ding, E. (2021). 如何估算A/B测试中的样本大小。*YouTube*.](https://www.youtube.com/watch?v=JEAsoUrX6KQ)'
- en: '[Miller, E. (2013). Sample Size Calculator.](https://www.evanmiller.org/ab-testing/sample-size.html)'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Miller, E. (2013). 样本大小计算器。](https://www.evanmiller.org/ab-testing/sample-size.html)'
- en: '[Glen, S. Sample Size in Statistics (How to Find it): Excel, Cochran’s Formula,
    General Tips. *StatisticsHowTo.com*](https://www.statisticshowto.com/probability-and-statistics/find-sample-size/)*.*'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Glen, S. 统计中的样本大小（如何找到）：Excel，Cochran公式，常见技巧。*StatisticsHowTo.com*](https://www.statisticshowto.com/probability-and-statistics/find-sample-size/)*.*'
- en: '[Israel, G. D. (1992). Determining sample size.](https://web.tarleton.edu/academicassessment/wp-content/uploads/sites/119/2022/05/Samplesize.pdf)'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Israel, G. D. (1992). 确定样本大小。](https://web.tarleton.edu/academicassessment/wp-content/uploads/sites/119/2022/05/Samplesize.pdf)'
- en: 'Kohavi, R., Tang, D., & Xu, Y. (2020). Trustworthy Online Controlled Experiments:
    A Practical Guide to A/B Testing. In *Trustworthy Online Controlled Experiments:
    A Practical Guide to A/B Testing* (p. I). Cambridge: Cambridge University Press.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kohavi, R., Tang, D., & Xu, Y. (2020). 可信的在线受控实验：A/B测试的实用指南。在*可信的在线受控实验：A/B测试的实用指南*（第I页）。剑桥：剑桥大学出版社。
- en: 'Singh, A. S., & Masuku, M. B. (2014). Sampling techniques & determination of
    sample size in applied statistics research: An overview. *International Journal
    of economics, commerce and management*, *2*(11), 1–22.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Singh, A. S., & Masuku, M. B. (2014). 采样技术与应用统计研究中的样本量确定：概述。*国际经济、商业与管理期刊*,
    *2*(11), 1–22.
- en: Van Belle, G. (2008). Sample size. *Statistical rules of thumb*, 27–51.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Van Belle, G. (2008). 样本量。*统计学经验法则*, 27–51.
- en: '[Yadav, M. (2012). Sample size determination|Cochran formula|Yamane formula|
    Sample size calculation| — DU Professor. *Youtube.*](https://www.youtube.com/watch?v=-pwQJYjWWMc)'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Yadav, M. (2012). 样本量确定|科赫伦公式|山根公式|样本量计算| — 杜教授。*Youtube.*](https://www.youtube.com/watch?v=-pwQJYjWWMc)'
- en: 'Yamane, T. (1973). Statistics: an introductory analysis-3.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Yamane, T. (1973). 统计学：入门分析-3.

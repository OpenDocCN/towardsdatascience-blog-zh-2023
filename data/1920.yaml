- en: 'Supercharged pandas: Encrypting Excel Files Written from DataFrames'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è¶…å¼º pandasï¼šåŠ å¯†ä» DataFrames å†™å…¥çš„ Excel æ–‡ä»¶
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/supercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b?source=collection_archive---------7-----------------------#2023-06-12](https://towardsdatascience.com/supercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b?source=collection_archive---------7-----------------------#2023-06-12)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/supercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b?source=collection_archive---------7-----------------------#2023-06-12](https://towardsdatascience.com/supercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b?source=collection_archive---------7-----------------------#2023-06-12)
- en: Introducing an ExcelHelper class which allows you to encrypt Excel files with
    a strong password or a password of your choice
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä»‹ç»ä¸€ä¸ª ExcelHelper ç±»ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨å¼ºå¯†ç æˆ–è‡ªå®šä¹‰å¯†ç åŠ å¯† Excel æ–‡ä»¶
- en: '[](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)[![Ji
    Wei Liew](../Images/f1b7267530b9a97106e6464b7b45ed85.png)](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)
    [Ji Wei Liew](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)[![Ji
    Wei Liew](../Images/f1b7267530b9a97106e6464b7b45ed85.png)](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)
    [Ji Wei Liew](https://jiweiliew.medium.com/?source=post_page-----1251b585145b--------------------------------)'
- en: Â·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8----1251b585145b---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)
    Â·6 min readÂ·Jun 12, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1251b585145b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----1251b585145b---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8----1251b585145b---------------------post_header-----------)
    å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1251b585145b--------------------------------)
    Â·6 min readÂ·2023å¹´6æœˆ12æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1251b585145b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----1251b585145b---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1251b585145b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&source=-----1251b585145b---------------------bookmark_footer-----------)![](../Images/48f2ccc861b8edbdc2f949971790e150.png)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1251b585145b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharged-pandas-encrypting-excel-files-written-from-dataframes-1251b585145b&source=-----1251b585145b---------------------bookmark_footer-----------)![](../Images/48f2ccc861b8edbdc2f949971790e150.png)'
- en: Writing to Excel and Encrypting it (Image by the author)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ•°æ®å†™å…¥ Excel å¹¶åŠ å¯†ï¼ˆå›¾ç‰‡ç”±ä½œè€…æä¾›ï¼‰
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»‹ç»
- en: In this article, I will be sharing how to incorporate an `ExcelHelper` class
    to open and encrypt the Excel file after writing dataframes to Excel. Iâ€™ve included
    this encryption capability in the `to_excelp` function in my previous [article](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ†äº«å¦‚ä½•ç»“åˆä½¿ç”¨ `ExcelHelper` ç±»æ¥åœ¨å°†æ•°æ®æ¡†å†™å…¥ Excel åæ‰“å¼€å¹¶åŠ å¯† Excel æ–‡ä»¶ã€‚æˆ‘åœ¨ä¹‹å‰çš„ [æ–‡ç« ](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3)
    ä¸­å·²å°†è¿™ä¸€åŠ å¯†åŠŸèƒ½åŒ…å«åœ¨ `to_excelp` å‡½æ•°ä¸­ã€‚
- en: '[](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3?source=post_page-----1251b585145b--------------------------------)
    [## Supercharged pandas: Reading from and Writing to Excel'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3?source=post_page-----1251b585145b--------------------------------)
    [## è¶…å¼ºå¤§çš„pandasï¼šä»Excelä¸­è¯»å–å’Œå†™å…¥'
- en: Enhancing .read_excel & .to_excel methods to allow you to focus on data exploration
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¢å¼º.read_excelå’Œ.to_excelæ–¹æ³•ï¼Œä»¥ä¾¿ä½ å¯ä»¥ä¸“æ³¨äºæ•°æ®æ¢ç´¢
- en: towardsdatascience.com](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3?source=post_page-----1251b585145b--------------------------------)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3?source=post_page-----1251b585145b--------------------------------)
- en: For data scientists and machine learning enthusiasts who are reading this, you
    are likely to find it helpful as it will speed up your work when exporting dataframes
    to Excel.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºæ•°æ®ç§‘å­¦å®¶å’Œæœºå™¨å­¦ä¹ çˆ±å¥½è€…æ¥è¯´ï¼Œä½ ä¼šå‘ç°è¿™éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥åŠ å¿«å°†æ•°æ®æ¡†å¯¼å‡ºåˆ°Excelæ—¶çš„å·¥ä½œé€Ÿåº¦ã€‚
- en: Motivation
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åŠ¨æœº
- en: In a recent project, I had to analyze data and prepare statistics for a few
    people. As the data contained sensitive information, there was a need to password-protect
    the files. This is very much aligned with my skill set and if you have read my
    previous article, within `pypo.py`, I already have a `to_excelp` function which
    opens the Excel file after it has been created by the `df.to_excel()` method.
    While this is worked well for me, it seems like a good time to relook at how it
    was implemented and also add the capability to password-protect the Excel file.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘éœ€è¦åˆ†ææ•°æ®å¹¶ä¸ºå‡ ä¸ªäººå‡†å¤‡ç»Ÿè®¡æ•°æ®ã€‚ç”±äºæ•°æ®åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œå¯†ç ä¿æŠ¤ã€‚è¿™ä¸æˆ‘çš„æŠ€èƒ½éå¸¸åŒ¹é…ï¼Œå¦‚æœä½ è¯»è¿‡æˆ‘ä¹‹å‰çš„æ–‡ç« ï¼Œä½ ä¼šå‘ç°ï¼Œåœ¨`pypo.py`ä¸­ï¼Œæˆ‘å·²ç»æœ‰ä¸€ä¸ª`to_excelp`å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨Excelæ–‡ä»¶é€šè¿‡`df.to_excel()`æ–¹æ³•åˆ›å»ºåæ‰“å¼€å®ƒã€‚è™½ç„¶è¿™å¯¹æˆ‘æœ‰æ•ˆï¼Œä½†ç°åœ¨ä¼¼ä¹æ˜¯é‡æ–°å®¡è§†å®ç°æ–¹å¼å¹¶å¢åŠ å¯†ç ä¿æŠ¤åŠŸèƒ½çš„å¥½æ—¶æœºã€‚
- en: Content
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å†…å®¹
- en: Opening and Encrypting the Excel file
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ‰“å¼€å’ŒåŠ å¯†Excelæ–‡ä»¶
- en: Generating a strong password
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç”Ÿæˆå¼ºå¯†ç 
- en: Putting it all together
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ•´åˆæ‰€æœ‰å†…å®¹
- en: Full code [here](https://gist.github.com/jiweiliew/f07e24861ea42fd17caebf8566d8c2ac).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæ•´ä»£ç  [åœ¨è¿™é‡Œ](https://gist.github.com/jiweiliew/f07e24861ea42fd17caebf8566d8c2ac)ã€‚
- en: Part 1 â€” Opening and Encrypting the Excel File
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¬¬1éƒ¨åˆ† â€” æ‰“å¼€å’ŒåŠ å¯†Excelæ–‡ä»¶
- en: 'When working with python and pandas, there are good reasons to open the Excel
    file, for example, visually inspecting it during testing, or formatting it before
    sending to stakeholders. If there is an additional need to encrypt the Excel file,
    then there would be 3 scenarios to handle: *open-only*, *encrypt-only*, *open
    & encrypt*. If we are neither opening nor encrypting the Excel file, then nothing
    needs to be done since `df.to_excel()` would suffice.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä½¿ç”¨pythonå’Œpandasæ—¶ï¼Œæ‰“å¼€Excelæ–‡ä»¶æœ‰å¾ˆå¤šç†ç”±ï¼Œä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•æœŸé—´è¿›è¡Œè§†è§‰æ£€æŸ¥ï¼Œæˆ–è€…åœ¨å‘é€ç»™åˆ©ç›Šç›¸å…³è€…ä¹‹å‰è¿›è¡Œæ ¼å¼åŒ–ã€‚å¦‚æœæœ‰é¢å¤–çš„éœ€æ±‚æ¥åŠ å¯†Excelæ–‡ä»¶ï¼Œåˆ™éœ€è¦å¤„ç†3ç§æƒ…å†µï¼š*ä»…æ‰“å¼€*ï¼Œ*ä»…åŠ å¯†*ï¼Œ*æ‰“å¼€å¹¶åŠ å¯†*ã€‚å¦‚æœæˆ‘ä»¬æ—¢ä¸æ‰“å¼€ä¹Ÿä¸åŠ å¯†Excelæ–‡ä»¶ï¼Œé‚£ä¹ˆä¸éœ€è¦åšä»»ä½•æ“ä½œï¼Œå› ä¸º`df.to_excel()`å°±è¶³å¤Ÿäº†ã€‚
- en: '`ExcelHelper` is a class written to launch Excel (the application) and then
    open the workbook based on the `path` provided. Programmatically, this is a 2-step
    process. Most people never realize it because the Excel application and workbook
    launches together when you double-click an Excel file.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '`ExcelHelper`æ˜¯ä¸€ä¸ªç”¨äºå¯åŠ¨Excelï¼ˆåº”ç”¨ç¨‹åºï¼‰å¹¶æ ¹æ®æä¾›çš„`path`æ‰“å¼€å·¥ä½œç°¿çš„ç±»ã€‚ä»ç¨‹åºè§’åº¦çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¤æ­¥è¿‡ç¨‹ã€‚å¤§å¤šæ•°äººä»æœªæ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå½“ä½ åŒå‡»ä¸€ä¸ªExcelæ–‡ä»¶æ—¶ï¼ŒExcelåº”ç”¨ç¨‹åºå’Œå·¥ä½œç°¿ä¼šä¸€èµ·å¯åŠ¨ã€‚'
- en: '**Initialize the ExcelHelper class**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**åˆå§‹åŒ–ExcelHelperç±»**'
- en: '`__init__(self, launch=True, encrypt=False, password=None, length=20, quit_=True)`
    This is the initialization call for the `ExcelHelper`.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`__init__(self, launch=True, encrypt=False, password=None, length=20, quit_=True)`
    è¿™æ˜¯`ExcelHelper`çš„åˆå§‹åŒ–è°ƒç”¨ã€‚'
- en: If `launch` equals to `True`, the workbook is displayed after encryption is
    done.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœ`launch`ç­‰äº`True`ï¼Œåœ¨åŠ å¯†å®Œæˆåå·¥ä½œç°¿ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚
- en: If `encrypt` equals to `True`, the `self._encrypt()` method, which will be explained
    later, is called.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœ`encrypt`ç­‰äº`True`ï¼Œå°†è°ƒç”¨`self._encrypt()`æ–¹æ³•ï¼Œç¨åä¼šè¿›è¡Œè§£é‡Šã€‚
- en: '`password` allows the user to input a preferred password, otherwise it will
    automatically suggest a strong password with `length` number of characters, where
    the maximum length is 255.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`password`å…è®¸ç”¨æˆ·è¾“å…¥é¦–é€‰å¯†ç ï¼Œå¦åˆ™å°†è‡ªåŠ¨å»ºè®®ä¸€ä¸ªé•¿åº¦ä¸º`length`çš„å¼ºå¯†ç ï¼Œæœ€å¤§é•¿åº¦ä¸º255ã€‚'
- en: '**Open workbook**'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ‰“å¼€å·¥ä½œç°¿**'
- en: '`_open_wb(self, path, visible=False)` converts the given path to an absolute
    path and then opens it. Converting a path to an absolute path is necessary otherwise
    applications dispatched by `win32com.client` cannot find the file. (Previously,
    I used a `try-except` block to prepend the path with the current working directory
    but that is unnecessarily verbose and takes a bit of time to really understand
    what one is trying to do.)'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`_open_wb(self, path, visible=False)` å°†ç»™å®šè·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ï¼Œç„¶åæ‰“å¼€å®ƒã€‚å°†è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„æ˜¯å¿…è¦çš„ï¼Œå¦åˆ™ç”±`win32com.client`è°ƒåº¦çš„åº”ç”¨ç¨‹åºæ— æ³•æ‰¾åˆ°æ–‡ä»¶ã€‚ï¼ˆä¹‹å‰ï¼Œæˆ‘ä½¿ç”¨äº†`try-except`å—æ¥åœ¨è·¯å¾„å‰æ·»åŠ å½“å‰å·¥ä½œç›®å½•ï¼Œä½†è¿™æ˜¾å¾—è¿‡äºå†—é•¿ï¼Œå¹¶ä¸”éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´æ‰èƒ½çœŸæ­£ç†è§£æˆ‘ä»¬è¦åšçš„äº‹æƒ…ã€‚ï¼‰'
- en: '`visible` controls whether the application is visible to the user. Generally,
    it makes sense to show the application only after the encryption is completed.
    So if we are launching and encrypting, we should set `visible=True` only after
    `self._encrypt()` is done.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`visible` æ§åˆ¶åº”ç”¨ç¨‹åºæ˜¯å¦å¯¹ç”¨æˆ·å¯è§ã€‚é€šå¸¸ï¼Œåªæœ‰åœ¨åŠ å¯†å®Œæˆåæ‰æ˜¾ç¤ºåº”ç”¨ç¨‹åºæ‰æœ‰æ„ä¹‰ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨å¯åŠ¨å¹¶åŠ å¯†ï¼Œåº”è¯¥åœ¨`self._encrypt()`å®Œæˆåæ‰å°†`visible=True`è®¾ç½®ä¸ºçœŸã€‚'
- en: '**Encrypt Excel**'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '**åŠ å¯†Excel**'
- en: '`_encrypt(self, visible=False)` encrypts the Excel workbook and then displays
    the application by setting the `self.xl.Visible` attribute after the encryption
    is completed.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`_encrypt(self, visible=False)` åŠ å¯†Excelå·¥ä½œç°¿ï¼Œç„¶ååœ¨åŠ å¯†å®Œæˆåé€šè¿‡è®¾ç½®`self.xl.Visible`å±æ€§æ¥æ˜¾ç¤ºåº”ç”¨ç¨‹åºã€‚'
- en: Setting `self.xl.DisplayAlerts` to `True` is important otherwise the launched
    Excel file will not give any alerts (case in point, if you press Ctrl+F and try
    to find some gibberish and there would be no prompt ğŸ˜±; it happened for me and
    I was really confused!).
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†`self.xl.DisplayAlerts`è®¾ç½®ä¸º`True`æ˜¯å¾ˆé‡è¦çš„ï¼Œå¦åˆ™å¯åŠ¨çš„Excelæ–‡ä»¶ä¸ä¼šå‘å‡ºä»»ä½•è­¦æŠ¥ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä½ æŒ‰Ctrl+Få°è¯•æŸ¥æ‰¾ä¸€äº›æ— æ„ä¹‰çš„å­—ç¬¦è€Œæ²¡æœ‰ä»»ä½•æç¤º
    ğŸ˜±ï¼›è¿™æ›¾ç»å‘ç”Ÿåœ¨æˆ‘èº«ä¸Šï¼Œæˆ‘çœŸçš„å¾ˆå›°æƒ‘ï¼ï¼‰ã€‚
- en: '**Execute method**'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ‰§è¡Œæ–¹æ³•**'
- en: '`execute(self, path, launch, encrypt, quit_)` handles the 3 scenarios described
    above.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`execute(self, path, launch, encrypt, quit_)` å¤„ç†ä¸Šè¿°3ç§æƒ…å†µã€‚'
- en: '`quit_` argument closes the Excel application (trailing underscore is a convention
    to denote that `quit` is a reserved keyword in python). When `ExcelHelper` is
    initiated, if `launch=False`, the Excel application runs in the background and
    the Excel file is `opened`. If the user now double-clicks on the Excel file, he
    will be prompted that it can only be open in read-only mode. It is quite difficult
    for non-technical user to close the file; the workaround would be to open Task
    manager, select the Excel program and then End Task. Therefore, there is a need
    to call `.Quit()` to terminate the Excel application. We could have just closed
    the workbook, but perhaps there is no need to handle this so finely for now.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`quit_` å‚æ•°å…³é—­Excelåº”ç”¨ç¨‹åºï¼ˆå°¾éƒ¨ä¸‹åˆ’çº¿æ˜¯ä¸€ç§çº¦å®šï¼Œè¡¨ç¤º`quit`åœ¨Pythonä¸­æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼‰ã€‚å½“`ExcelHelper`è¢«åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœ`launch=False`ï¼ŒExcelåº”ç”¨ç¨‹åºå°†åœ¨åå°è¿è¡Œï¼ŒExcelæ–‡ä»¶ä¼šè¢«`æ‰“å¼€`ã€‚å¦‚æœç”¨æˆ·ç°åœ¨åŒå‡»Excelæ–‡ä»¶ï¼Œä»–ä¼šè¢«æç¤ºåªèƒ½ä»¥åªè¯»æ¨¡å¼æ‰“å¼€ã€‚å¯¹äºéæŠ€æœ¯ç”¨æˆ·æ¥è¯´ï¼Œå…³é—­æ–‡ä»¶ç›¸å½“å›°éš¾ï¼›è§£å†³æ–¹æ³•æ˜¯æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œé€‰æ‹©Excelç¨‹åºï¼Œç„¶åç»“æŸä»»åŠ¡ã€‚å› æ­¤ï¼Œéœ€è¦è°ƒç”¨`.Quit()`æ¥ç»ˆæ­¢Excelåº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬æœ¬å¯ä»¥ç›´æ¥å…³é—­å·¥ä½œç°¿ï¼Œä½†ä¹Ÿè®¸ç°åœ¨ä¸éœ€è¦å¤„ç†å¾—å¦‚æ­¤ç»†è‡´ã€‚'
- en: Part 2 â€” Generating a strong password
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¬¬2éƒ¨åˆ† â€” ç”Ÿæˆå¼ºå¯†ç 
- en: Initially, I was using `from cryptography.fernet import Fernet; Fernet.generate_key()`
    to generate random passwords. While several users were pleasantly surprised by
    the length and randomness of the password, I did not like it very much because
    it is a bit too long and does not contain a variety of punctuation. I googled
    and found a better [approach](https://stackoverflow.com/a/39596292/8350440) on
    StackOverflow. (I am always very impressed by how easily one can get very high
    quality answers on StackOverflow. All the tough work has already been done by
    all the giants, all we need to do is to search for it, copy, paste, and make small
    tweaks (e.g. change variable names).) The function is quite straightforward and
    rather self-explanatory.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: èµ·åˆï¼Œæˆ‘ä½¿ç”¨`from cryptography.fernet import Fernet; Fernet.generate_key()`æ¥ç”Ÿæˆéšæœºå¯†ç ã€‚è™½ç„¶å‡ ä¸ªç”¨æˆ·å¯¹å¯†ç çš„é•¿åº¦å’Œéšæœºæ€§æ„Ÿåˆ°æƒŠè®¶ï¼Œä½†æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢ï¼Œå› ä¸ºå®ƒæœ‰ç‚¹é•¿ï¼Œå¹¶ä¸”ä¸åŒ…å«å¤šæ ·çš„æ ‡ç‚¹ç¬¦å·ã€‚æˆ‘åœ¨Googleä¸ŠæŸ¥æ‰¾äº†ä¸€ä¸ªæ›´å¥½çš„[æ–¹æ³•](https://stackoverflow.com/a/39596292/8350440)åœ¨StackOverflowä¸Šã€‚ï¼ˆæˆ‘æ€»æ˜¯å¯¹StackOverflowä¸Šå¦‚ä½•è½»æ¾è·å¾—é«˜è´¨é‡ç­”æ¡ˆæ„Ÿåˆ°éå¸¸æƒŠè®¶ã€‚æ‰€æœ‰å›°éš¾çš„å·¥ä½œå·²ç»ç”±æ‰€æœ‰å‰è¾ˆå®Œæˆï¼Œæˆ‘ä»¬åªéœ€æœç´¢ã€å¤åˆ¶ã€ç²˜è´´å¹¶åšäº›å°è°ƒæ•´ï¼ˆä¾‹å¦‚æ›´æ”¹å˜é‡åï¼‰ã€‚ï¼‰è¿™ä¸ªå‡½æ•°ç›¸å½“ç®€å•ç›´æ¥ï¼Œè‡ªè§£é‡Šæ€§ä¹Ÿå¾ˆå¼ºã€‚
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Just as everything was going a bit too smoothly, while testing my code, I noticed
    that occasionally the passwords cannot be used to open the file! I was really
    puzzled. It took a bit of trial-and-error and I began to suspect that there could
    be some characters which are not *suitable* as passwords because this phenomenon
    only occurred when passwords contain 2 backslashes `\\`.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å½“ä¸€åˆ‡è¿›å±•å¾—è¿‡äºé¡ºåˆ©æ—¶ï¼Œåœ¨æµ‹è¯•æˆ‘çš„ä»£ç æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°æœ‰æ—¶å¯†ç æ— æ³•ç”¨æ¥æ‰“å¼€æ–‡ä»¶ï¼æˆ‘çœŸçš„å¾ˆå›°æƒ‘ã€‚ç»è¿‡ä¸€ç•ªè¯•é”™åï¼Œæˆ‘å¼€å§‹æ€€ç–‘å¯èƒ½æœ‰äº›å­—ç¬¦æ˜¯ä¸*é€‚åˆ*ç”¨ä½œå¯†ç çš„ï¼Œå› ä¸ºè¿™ç§ç°è±¡åªåœ¨å¯†ç åŒ…å«ä¸¤ä¸ªåæ–œæ 
    `\\` æ—¶å‘ç”Ÿã€‚
- en: 'Hereâ€™s a bit of background to allow you to appreciate the situation: I use
    Powershell and Notepad++, and my code prints the passwords to `stdout`. Next,
    I highlight the password printed on Powershell and then paste it when Excel prompts
    me to enter the password. So the issue is that `\` is an escape character, hence
    the first `\` should be ignored when I enter this as the password. It is troublesome
    to handle and for the purpose of passwords, I can do with one less character.
    Hence, all I did was slice out backslash in `string.punctuation`.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæœ‰ä¸€äº›èƒŒæ™¯ä¿¡æ¯å¯ä»¥è®©ä½ æ›´å¥½åœ°ç†è§£æƒ…å†µï¼šæˆ‘ä½¿ç”¨Powershellå’ŒNotepad++ï¼Œæˆ‘çš„ä»£ç å°†å¯†ç æ‰“å°åˆ° `stdout`ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘åœ¨Powershellä¸Šçªå‡ºæ˜¾ç¤ºæ‰“å°å‡ºçš„å¯†ç ï¼Œç„¶ååœ¨Excelæç¤ºæˆ‘è¾“å…¥å¯†ç æ—¶ç²˜è´´å®ƒã€‚æ‰€ä»¥é—®é¢˜æ˜¯
    `\` æ˜¯ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œå› æ­¤åœ¨æˆ‘è¾“å…¥å¯†ç æ—¶ï¼Œç¬¬ä¸€ä¸ª `\` åº”è¯¥è¢«å¿½ç•¥ã€‚å¤„ç†èµ·æ¥å¾ˆéº»çƒ¦ï¼Œå¯¹äºå¯†ç çš„ç›®çš„ï¼Œæˆ‘å¯ä»¥å°‘ç”¨ä¸€ä¸ªå­—ç¬¦ã€‚å› æ­¤ï¼Œæˆ‘æ‰€åšçš„å°±æ˜¯åœ¨ `string.punctuation`
    ä¸­åˆ‡é™¤åæ–œæ ã€‚
- en: '[PRE1]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Part 3 â€” Putting it all together
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¬¬ä¸‰éƒ¨åˆ† â€” å°†ä¸€åˆ‡æ•´åˆèµ·æ¥
- en: Since there is almost no value-add to instantiate an `ExcelHelper` object if
    you are not launching or encrypting the Excel file, one should start with `if
    launch or encrypt:`. Next, is merely passing the keyword arguments from `to_excelp`
    to `ExcelHelper` and returning the object and `password`.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºå¦‚æœä½ ä¸å¯åŠ¨æˆ–åŠ å¯†Excelæ–‡ä»¶ï¼Œå®ä¾‹åŒ– `ExcelHelper` å¯¹è±¡å‡ ä¹æ²¡æœ‰é™„åŠ å€¼ï¼Œå› æ­¤åº”è¯¥ä»¥ `if launch or encrypt:`
    å¼€å§‹ã€‚æ¥ä¸‹æ¥ï¼Œä»…éœ€å°†å…³é”®å­—å‚æ•°ä» `to_excelp` ä¼ é€’åˆ° `ExcelHelper` å¹¶è¿”å›å¯¹è±¡å’Œ `password`ã€‚
- en: '[PRE2]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: If you are writing dataframes to several different Excel files by calling this
    function, I would recommend to store the results in a list of tuples. You can
    subsequently iterate over this list of tuples to get the path to the Excel files
    and their passwords. Storing the object might be useful in future, especially
    if you intend to add more functionalities to `ExcelHelper`.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ é€šè¿‡è°ƒç”¨è¿™ä¸ªå‡½æ•°å°†æ•°æ®æ¡†å†™å…¥å¤šä¸ªä¸åŒçš„Excelæ–‡ä»¶ï¼Œæˆ‘å»ºè®®å°†ç»“æœå­˜å‚¨åœ¨ä¸€ä¸ªå…ƒç»„åˆ—è¡¨ä¸­ã€‚ä½ å¯ä»¥éšåéå†è¿™ä¸ªå…ƒç»„åˆ—è¡¨ä»¥è·å–Excelæ–‡ä»¶çš„è·¯å¾„åŠå…¶å¯†ç ã€‚å­˜å‚¨å¯¹è±¡å¯èƒ½åœ¨æœªæ¥å¾ˆæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ æ‰“ç®—ä¸º
    `ExcelHelper` æ·»åŠ æ›´å¤šåŠŸèƒ½çš„è¯ã€‚
- en: '[PRE3]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '`ExcelHelper` can also be added to other your existing scripts too.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '`ExcelHelper` ä¹Ÿå¯ä»¥æ·»åŠ åˆ°ä½ ç°æœ‰çš„å…¶ä»–è„šæœ¬ä¸­ã€‚'
- en: '[PRE4]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Conclusion
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: Revisiting old code written by myself is like a walk down memory lane which
    reveals how little I knew back then. Although I am very much embarrassed by it,
    I am glad to know that I have progressed since then.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: é‡æ–°å®¡è§†è‡ªå·±å†™çš„æ—§ä»£ç å°±åƒæ˜¯èµ°åœ¨è®°å¿†çš„é•¿å»Šä¸Šï¼Œæ­ç¤ºäº†å½“æ—¶æˆ‘çŸ¥é“çš„å°‘ã€‚è™½ç„¶å¯¹æ­¤æ„Ÿåˆ°éå¸¸å°´å°¬ï¼Œä½†æˆ‘å¾ˆé«˜å…´çŸ¥é“è‡ªå·±å·²ç»æœ‰æ‰€è¿›æ­¥ã€‚
- en: â€œIf youâ€™re not embarrassed by your old code then you arenâ€™t progressing as a
    programmer.â€ [Anonymous]
  id: totrans-54
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: â€œå¦‚æœä½ å¯¹è‡ªå·±æ—§çš„ä»£ç ä¸æ„Ÿåˆ°å°´å°¬ï¼Œé‚£ä¹ˆä½ ä½œä¸ºç¨‹åºå‘˜å°±æ²¡æœ‰è¿›æ­¥ã€‚â€ [åŒ¿å]
- en: Writing these little classes, functions takes time but there are immense benefits
    for having them as it automates the mechanical and not-so-fun parts of work and
    allows one to focus on the important tasks. (Imagine having to think about passwords
    with uppercase, lowercase, numbers and punctuation and storing them in a file
    all the time.)
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–å†™è¿™äº›å°ç±»å’Œå‡½æ•°éœ€è¦æ—¶é—´ï¼Œä½†å®ƒä»¬çš„å¥½å¤„å·¨å¤§ï¼Œå› ä¸ºå®ƒä»¬è‡ªåŠ¨åŒ–äº†æœºæ¢°åŒ–ä¸”ä¸å¤ªæœ‰è¶£çš„å·¥ä½œéƒ¨åˆ†ï¼Œå¹¶ä½¿äººèƒ½å¤Ÿä¸“æ³¨äºé‡è¦ä»»åŠ¡ã€‚ï¼ˆæƒ³è±¡ä¸€ä¸‹ï¼Œæ€»æ˜¯è¦è€ƒè™‘åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—å’Œæ ‡ç‚¹ç¬¦å·çš„å¯†ç ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ã€‚ï¼‰

- en: Automatically Detecting Label Errors in Datasets with CleanLab
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ CleanLab è‡ªåŠ¨æ£€æµ‹æ•°æ®é›†ä¸­çš„æ ‡ç­¾é”™è¯¯
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/automatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345?source=collection_archive---------3-----------------------#2023-07-22](https://towardsdatascience.com/automatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345?source=collection_archive---------3-----------------------#2023-07-22)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/automatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345?source=collection_archive---------3-----------------------#2023-07-22](https://towardsdatascience.com/automatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345?source=collection_archive---------3-----------------------#2023-07-22)
- en: A Tale of AI and wrongly-classified Brazilian Federal Laws
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸€åˆ™å…³äºäººå·¥æ™ºèƒ½å’Œé”™è¯¯åˆ†ç±»çš„å·´è¥¿è”é‚¦æ³•å¾‹çš„æ•…äº‹
- en: '[](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)[![JoÃ£o
    Pedro](../Images/64a0e14527be213e5fde0a02439fbfa7.png)](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)
    [JoÃ£o Pedro](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)[![JoÃ£o
    Pedro](../Images/64a0e14527be213e5fde0a02439fbfa7.png)](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)
    [JoÃ£o Pedro](https://joaopedro214.medium.com/?source=post_page-----e0a3ea5fb345--------------------------------)'
- en: Â·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb111eee95c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&user=Jo%C3%A3o+Pedro&userId=b111eee95c&source=post_page-b111eee95c----e0a3ea5fb345---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)
    Â·10 min readÂ·Jul 22, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe0a3ea5fb345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&user=Jo%C3%A3o+Pedro&userId=b111eee95c&source=-----e0a3ea5fb345---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb111eee95c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&user=Jo%C3%A3o+Pedro&userId=b111eee95c&source=post_page-b111eee95c----e0a3ea5fb345---------------------post_header-----------)
    å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e0a3ea5fb345--------------------------------)
    Â·10 åˆ†é’Ÿé˜…è¯»Â·2023å¹´7æœˆ22æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe0a3ea5fb345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&user=Jo%C3%A3o+Pedro&userId=b111eee95c&source=-----e0a3ea5fb345---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a3ea5fb345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&source=-----e0a3ea5fb345---------------------bookmark_footer-----------)![](../Images/36477c5670bfa2ec58e04ee972390139.png)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a3ea5fb345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatically-detecting-label-errors-in-datasets-with-cleanlab-e0a3ea5fb345&source=-----e0a3ea5fb345---------------------bookmark_footer-----------)![](../Images/36477c5670bfa2ec58e04ee972390139.png)'
- en: Photo by [Gustavo Leighton](https://unsplash.com/@g_leighton?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ç…§ç‰‡ç”± [Gustavo Leighton](https://unsplash.com/@g_leighton?utm_source=medium&utm_medium=referral)
    æä¾›ï¼Œæ¥è‡ª [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¼•è¨€
- en: A few weeks ago, while doing my usual search for datasets to develop my personal
    projects, I came across the Brazilian Chamber of Deputies Open Data Portal, which
    contains a lot of data â€” including the deputies' costs, parties metadata, etc
    â€” everything available trough a nice [API](https://dadosabertos.camara.leg.br/swagger/api.html#staticfile).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: å‡ å‘¨å‰ï¼Œå½“æˆ‘åœ¨è¿›è¡Œä¸ªäººé¡¹ç›®çš„æ•°æ®é›†æœç´¢æ—¶ï¼Œæˆ‘å¶ç„¶å‘ç°äº†å·´è¥¿ä¼—è®®é™¢å¼€æ”¾æ•°æ®é—¨æˆ·ç½‘ç«™ï¼Œè¿™é‡ŒåŒ…å«äº†å¤§é‡çš„æ•°æ®â€”â€”åŒ…æ‹¬è®®å‘˜çš„è´¹ç”¨ã€æ”¿å…šå…ƒæ•°æ®ç­‰â€”â€”æ‰€æœ‰è¿™äº›æ•°æ®éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸é”™çš„
    [API](https://dadosabertos.camara.leg.br/swagger/api.html#staticfile) è·å–ã€‚
- en: 'After a few hours of searching and inspecting, something very interesting caught
    my attention: The compilation of all the laws proposed by the parliamentarians
    with their â€˜*ementasâ€™* (concise summary), author, year, and, more importantly,
    their **themes** (health, security, finance, etcâ€¦) â€” categorized by the Chamberâ€™s
    Documentation and Information Center (Centro de DocumentaÃ§Ã£o e InformaÃ§Ã£o da CÃ¢mara,
    on literal translation).'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: å‡ å°æ—¶çš„æœç´¢å’Œæ£€æŸ¥åï¼Œæœ‰ä¸€äº›éå¸¸æœ‰è¶£çš„äº‹æƒ…å¼•èµ·äº†æˆ‘çš„æ³¨æ„ï¼šæ‰€æœ‰ç”±è®®å‘˜æå‡ºçš„æ³•å¾‹çš„æ±‡ç¼–ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„â€˜*ementas*â€™ï¼ˆç®€è¦æ‘˜è¦ï¼‰ã€ä½œè€…ã€å¹´ä»½ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒä»¬çš„**ä¸»é¢˜**ï¼ˆå¥åº·ã€å®‰å…¨ã€é‡‘èç­‰ï¼‰â€”â€”ç”±è®®ä¼šæ–‡çŒ®å’Œä¿¡æ¯ä¸­å¿ƒï¼ˆCentro
    de DocumentaÃ§Ã£o e InformaÃ§Ã£o da CÃ¢maraï¼‰åˆ†ç±»ã€‚
- en: A spark shined in my brain â€” â€œ*Iâ€™ll make a supervised classification pipeline
    to* ***predict the theme of a law******using its summary****, exploring some infrastructure
    aspect of Machine learning, like data versioning with DVC or something like that.*â€
    I quickly wrote a script and gathered an extensive dataset comprising over 60,000
    laws, spanning the period from 1990 to 2022.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘çš„è„‘æµ·ä¸­é—ªç°å‡ºä¸€ä¸ªçµå…‰â€”â€”â€œ*æˆ‘å°†åˆ›å»ºä¸€ä¸ªç›‘ç£åˆ†ç±»ç®¡é“æ¥* ***é¢„æµ‹æ³•å¾‹çš„ä¸»é¢˜******ä½¿ç”¨å…¶æ‘˜è¦****ï¼Œæ¢ç´¢æœºå™¨å­¦ä¹ çš„ä¸€äº›åŸºç¡€è®¾æ–½æ–¹é¢ï¼Œå¦‚ä½¿ç”¨DVCçš„æ•°æ®ç‰ˆæœ¬æ§åˆ¶æˆ–ç±»ä¼¼çš„ä¸œè¥¿*ã€‚â€æˆ‘è¿…é€Ÿç¼–å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œæ”¶é›†äº†ä¸€ä¸ªåŒ…å«è¶…è¿‡60,000æ¡æ³•å¾‹çš„å¤§å‹æ•°æ®é›†ï¼Œæ—¶é—´è·¨åº¦ä»1990å¹´åˆ°2022å¹´ã€‚
- en: 'Iâ€™ve already worked a little with Judiciary and Legislative data,Â soÂ IÂ hadÂ aÂ feelingÂ thatÂ thisÂ taskÂ wouldÂ notÂ beÂ hard.
    But, to make things even easier, I choose to classify only whether a law proposal
    (LP) is about â€œ*Tributes and commemorative dates*â€ or not (binary classification).
    In theory, it should be easy, as the texts are very simple:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å·²ç»ç¨å¾®æ¶‰çŒè¿‡å¸æ³•å’Œç«‹æ³•æ•°æ®ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ç§æ„Ÿè§‰è¿™ä¸ªä»»åŠ¡ä¸ä¼šå¾ˆéš¾ã€‚ä½†æ˜¯ï¼Œä¸ºäº†æ›´è½»æ¾äº›ï¼Œæˆ‘é€‰æ‹©ä»…åˆ†ç±»æ³•å¾‹ææ¡ˆï¼ˆLPï¼‰æ˜¯å¦æ¶‰åŠâ€œ*çºªå¿µå’Œçºªå¿µæ—¥æœŸ*â€ï¼ˆäºŒåˆ†ç±»ï¼‰ã€‚ç†è®ºä¸Šï¼Œè¿™åº”è¯¥å¾ˆç®€å•ï¼Œå› ä¸ºæ–‡æœ¬éå¸¸ç®€å•ï¼š
- en: '![](../Images/a26315bf71eaec67b082f036007bfbbb.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a26315bf71eaec67b082f036007bfbbb.png)'
- en: Original summaries and a literal translation by ChatGPT - I. Image by Author.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: åŸå§‹æ‘˜è¦å’ŒChatGPTçš„å­—é¢ç¿»è¯‘ - Iã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: But, no matter what I tried to do, my performance did not rise above the ~0.80
    mark on the f1 score, with a relatively low recall (for the positive class) of
    0.5â€“0.7.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯ï¼Œæ— è®ºæˆ‘å°è¯•äº†ä»€ä¹ˆï¼Œæˆ‘çš„æ€§èƒ½åœ¨f1åˆ†æ•°ä¸Šå§‹ç»ˆæœªèƒ½è¶…è¿‡~0.80ï¼Œä¸”ï¼ˆæ­£ç±»çš„ï¼‰å¬å›ç‡ç›¸å¯¹è¾ƒä½ï¼Œä¸º0.5â€“0.7ã€‚
- en: Of course, my dataset is highly unbalanced, with this class representing less
    than 5% of the dataset size, but there is something more.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œæˆ‘çš„æ•°æ®é›†é«˜åº¦ä¸å¹³è¡¡ï¼Œè¿™ä¸€ç±»åˆ«å æ•°æ®é›†æ€»é‡çš„ä¸åˆ°5%ï¼Œä½†è¿˜æœ‰æ›´å¤šå› ç´ ã€‚
- en: 'After some investigation, inspecting the data with regex-based queries, and
    looking into the wrong-classified records, I found several examples incorrectly
    labeled. With my crude approach, Iâ€™ve found ~200 false negatives, which represent
    ~7.5% of the â€œtrueâ€ positives and 0.33% of all my dataset, without mentioning
    the false positives. See a few below:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ç»è¿‡ä¸€äº›è°ƒæŸ¥ï¼Œä½¿ç”¨åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„æŸ¥è¯¢æ£€æŸ¥æ•°æ®ï¼ŒæŸ¥çœ‹é”™è¯¯åˆ†ç±»è®°å½•åï¼Œæˆ‘å‘ç°äº†å‡ ä¸ªé”™è¯¯æ ‡è®°çš„ä¾‹å­ã€‚é€šè¿‡æˆ‘ç²—ç•¥çš„æ–¹æ³•ï¼Œæˆ‘å‘ç°äº†~200ä¸ªå‡é˜´æ€§ï¼Œå â€œçœŸå®â€æ­£ä¾‹çš„~7.5%å’Œæˆ‘æ•°æ®é›†çš„0.33%ï¼Œè¿˜æ²¡æœ‰æåˆ°å‡é˜³æ€§ã€‚è§ä¸‹å›¾ï¼š
- en: '![](../Images/86340626c166a22cac095a5946da6dbd.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/86340626c166a22cac095a5946da6dbd.png)'
- en: Wrongly classified examples. Image by Author.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: é”™è¯¯åˆ†ç±»çš„ä¾‹å­ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: These examples were rotting my validation metrics â€” â€œ*How many of them could
    exist? Will I have to search the errors manually?*â€
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›ä¾‹å­å½±å“äº†æˆ‘çš„éªŒè¯æŒ‡æ ‡â€”â€”â€œ*å®ƒä»¬å¯èƒ½æœ‰å¤šå°‘ä¸ªï¼Ÿæˆ‘éœ€è¦æ‰‹åŠ¨æœç´¢é”™è¯¯å—ï¼Ÿ*â€
- en: But then **Confident Learning** materialized as the **Clean Lab** python package,
    came to save me.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œ**Confident Learning** ä½œä¸º**Clean Lab** PythonåŒ…çš„å½¢å¼å‡ºç°ï¼Œæ¥æ‹¯æ•‘æˆ‘äº†ã€‚
- en: '![](../Images/1e88f7af7141237d5d19f6b5f3c4f018.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1e88f7af7141237d5d19f6b5f3c4f018.png)'
- en: Clean Lab Logo. Image from [GitHub](https://github.com/cleanlab/cleanlab).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Clean Labæ ‡å¿—ã€‚å›¾ç‰‡æ¥è‡ª[GitHub](https://github.com/cleanlab/cleanlab)ã€‚
- en: What is Confident Learning?
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯Confident Learningï¼Ÿ
- en: Correctly labeling data is one of the most time-consuming and costly steps in
    any supervised machine-learning project. Techniques like crowdsourcing, semi-supervised
    learning, fine-tuning, and many others try to reduce the cost of collecting labels
    or the need for such labels in model training.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£ç¡®æ ‡è®°æ•°æ®æ˜¯ä»»ä½•ç›‘ç£æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­æœ€è€—æ—¶ä¸”æœ€æ˜‚è´µçš„æ­¥éª¤ä¹‹ä¸€ã€‚åƒä¼—åŒ…ã€åŠç›‘ç£å­¦ä¹ ã€å¾®è°ƒç­‰æŠ€æœ¯å°è¯•å‡å°‘æ”¶é›†æ ‡ç­¾çš„æˆæœ¬æˆ–å‡å°‘æ¨¡å‹è®­ç»ƒä¸­å¯¹è¿™äº›æ ‡ç­¾çš„éœ€æ±‚ã€‚
- en: Fortunately, we are already a step ahead of this problem. We have labels given
    by professionals, probably government workers with adequate *know-how*. But my
    non-professional eyes with my crude regex approach could spot mistakes as soon
    as they broke my performance expectations.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»åœ¨è¿™ä¸ªé—®é¢˜ä¸Šé¢†å…ˆä¸€æ­¥ã€‚æˆ‘ä»¬æœ‰ä¸“ä¸šäººå£«æä¾›çš„æ ‡ç­¾ï¼Œå¯èƒ½æ˜¯å…·å¤‡è¶³å¤Ÿ*ä¸“ä¸šçŸ¥è¯†*çš„æ”¿åºœå·¥ä½œäººå‘˜ã€‚ä½†æˆ‘ä»¥ç²—ç•¥æ­£åˆ™è¡¨è¾¾å¼å¤„ç†çš„éä¸“ä¸šè§†è§’ä¸€æ—¦è¶…å‡ºæˆ‘çš„æ€§èƒ½é¢„æœŸï¼Œå°±èƒ½å‘ç°é”™è¯¯ã€‚
- en: 'The point is: How many errors are still in the data?'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: å…³é”®ç‚¹æ˜¯ï¼šæ•°æ®ä¸­è¿˜æœ‰å¤šå°‘é”™è¯¯ï¼Ÿ
- en: Itâ€™s not reasonable to inspect every single law â€” An **automatic** way of detecting
    **incorrect labels** is necessary, and thatâ€™s what Confident Learning is.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥æ¯ä¸€æ¡æ³•å¾‹æ˜¯ä¸ç°å®çš„â€”â€”éœ€è¦ä¸€ç§ **è‡ªåŠ¨** æ£€æµ‹ **é”™è¯¯æ ‡ç­¾** çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ Confident Learning çš„ä½œç”¨ã€‚
- en: In summary, it uses statistics gathered from model probability predictions to
    estimate errors in the dataset. It can detect noise, outliers, and â€” the main
    subject of this post â€” **label errors**.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ç»“ä¸€ä¸‹ï¼Œå®ƒä½¿ç”¨ä»æ¨¡å‹æ¦‚ç‡é¢„æµ‹ä¸­æ”¶é›†çš„ç»Ÿè®¡æ•°æ®æ¥ä¼°è®¡æ•°æ®é›†ä¸­çš„é”™è¯¯ã€‚å®ƒå¯ä»¥æ£€æµ‹å™ªå£°ã€ç¦»ç¾¤å€¼ï¼Œä»¥åŠâ€”â€”æœ¬ç¯‡æ–‡ç« çš„ä¸»è¦å†…å®¹â€”â€”**æ ‡ç­¾é”™è¯¯**ã€‚
- en: Iâ€™ll not go into the details of CL, but there is a [very nice article](/confident-learning-err-did-you-say-your-data-is-clean-ef2597903328)
    covering its main points and a [YT video](https://youtu.be/BnOTv0f9Msk) from the
    creator of **CleanLab** talking about its research on the field.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç» CLï¼Œä½†æœ‰ä¸€ç¯‡[å¾ˆå¥½çš„æ–‡ç« ](/confident-learning-err-did-you-say-your-data-is-clean-ef2597903328)æ¶µç›–äº†å®ƒçš„ä¸»è¦è¦ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¥è‡ª
    **CleanLab** åˆ›å§‹äººçš„[YT è§†é¢‘](https://youtu.be/BnOTv0f9Msk)è°ˆè®ºå®ƒåœ¨è¯¥é¢†åŸŸçš„ç ”ç©¶ã€‚
- en: Letâ€™s see how it works in practice.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹å®ƒåœ¨å®è·µä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
- en: The data
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ•°æ®
- en: The data was gathered from the Brazilian Chamber of Deputies Open Data Portal,
    containing law proposals (LP) from 1990 to 2022\. The final dataset contains ~60K
    LPs.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®æ¥è‡ªå·´è¥¿ä¼—è®®é™¢å¼€æ”¾æ•°æ®é—¨æˆ·ï¼ŒåŒ…å« 1990 å¹´è‡³ 2022 å¹´çš„æ³•å¾‹ææ¡ˆï¼ˆLPï¼‰ã€‚æœ€ç»ˆçš„æ•°æ®é›†åŒ…å«çº¦ 60K LPsã€‚
- en: A single LP can have multiple themes associated with it, like Health and Finance,
    and this information is also available in the Open Data Portal. To make it easier
    to handle, Iâ€™ve encoded the theme information by binarizing each individual theme
    in a separate column.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å•ä¸ª LP å¯èƒ½ä¸å¤šä¸ªä¸»é¢˜ç›¸å…³ï¼Œä¾‹å¦‚å¥åº·å’Œé‡‘èï¼Œè¿™äº›ä¿¡æ¯ä¹Ÿå¯ä»¥åœ¨å¼€æ”¾æ•°æ®é—¨æˆ·ä¸­æ‰¾åˆ°ã€‚ä¸ºäº†æ›´æ–¹ä¾¿å¤„ç†ï¼Œæˆ‘é€šè¿‡å°†æ¯ä¸ªå•ç‹¬çš„ä¸»é¢˜äºŒå€¼åŒ–åˆ°å•ç‹¬çš„åˆ—ä¸­æ¥ç¼–ç ä¸»é¢˜ä¿¡æ¯ã€‚
- en: As previously mentioned, the theme used in this post is â€œ*Tributes and commemorative
    dates*â€. I choose it because its *ementas* are very short and simple, so the labels
    errors are easy to identify.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚å‰æ‰€è¿°ï¼Œæœ¬ç¯‡æ–‡ç« ä½¿ç”¨çš„ä¸»é¢˜æ˜¯â€œ*è‡´æ•¬å’Œçºªå¿µæ—¥æœŸ*â€ã€‚æˆ‘é€‰æ‹©å®ƒæ˜¯å› ä¸ºå®ƒçš„ *ementas* éå¸¸ç®€çŸ­ä¸”ç®€å•ï¼Œå› æ­¤æ ‡ç­¾é”™è¯¯å¾ˆå®¹æ˜“è¯†åˆ«ã€‚
- en: The data and the code are available in the [projectâ€™s GitHub repository](https://github.com/jaumpedro214/data-analysis-camara-federal-pls).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®å’Œä»£ç å¯ä»¥åœ¨[é¡¹ç›®çš„ GitHub ä»“åº“](https://github.com/jaumpedro214/data-analysis-camara-federal-pls)ä¸­æ‰¾åˆ°ã€‚
- en: The Implementation
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å®ç°
- en: Our goal is to fix every single label error in the â€œ*Tributes and commemorative
    dates*â€ automatically and finish this post with a nice and clean Dataset ready
    to be used in a Machine Learning problem.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è‡ªåŠ¨ä¿®å¤â€œ*è‡´æ•¬å’Œçºªå¿µæ—¥æœŸ*â€ä¸­çš„æ¯ä¸€ä¸ªæ ‡ç­¾é”™è¯¯ï¼Œå¹¶ä½¿è¿™ä¸ªå¸–å­ä»¥ä¸€ä¸ªå¹²å‡€ã€æ•´æ´çš„æ•°æ®é›†ä½œä¸ºç»“æŸï¼Œå‡†å¤‡å¥½ç”¨äºæœºå™¨å­¦ä¹ é—®é¢˜ã€‚
- en: Setup the environment
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½®ç¯å¢ƒ
- en: All needed to run this project are the classical ML/Data Science Python packages
    (Pandas, Numpy & Scikit-Learn) + the CleanLab package.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: è¿è¡Œè¿™ä¸ªé¡¹ç›®æ‰€éœ€çš„æ˜¯ç»å…¸çš„ ML/Data Science Python åŒ…ï¼ˆPandas, Numpy å’Œ Scikit-Learnï¼‰+ CleanLab
    åŒ…ã€‚
- en: '[PRE0]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Just install these requirements and weâ€™re ready to go.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: åªéœ€å®‰è£…è¿™äº›è¦æ±‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹äº†ã€‚
- en: Detecting Label Errors with CL
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ CL æ£€æµ‹æ ‡ç­¾é”™è¯¯
- en: The CleanLab package comes natively with the ability to identify many types
    of dataset problems, like outliers and duplicate/near-duplicate entries, but weâ€™ll
    be only interested in the **label errors**.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: CleanLab åŒ…è‡ªå¸¦è¯†åˆ«è®¸å¤šæ•°æ®é›†é—®é¢˜çš„èƒ½åŠ›ï¼Œå¦‚ç¦»ç¾¤å€¼å’Œé‡å¤/æ¥è¿‘é‡å¤çš„æ¡ç›®ï¼Œä½†æˆ‘ä»¬åªå¯¹ **æ ‡ç­¾é”™è¯¯** æ„Ÿå…´è¶£ã€‚
- en: '**CleanLab** uses probabilities generated by a Machine Learning model representing
    its confidence of an entry being a certain label. If the dataset has *n* entries
    and *m* classes, then this will be represented by an *n* by *m* matrix P, where
    P[i, j] represents the probability of row *i* being of class *j*.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**CleanLab** ä½¿ç”¨ç”±æœºå™¨å­¦ä¹ æ¨¡å‹ç”Ÿæˆçš„æ¦‚ç‡ï¼Œè¿™äº›æ¦‚ç‡ä»£è¡¨äº†æ¡ç›®è¢«æ ‡è®°ä¸ºæŸä¸ªæ ‡ç­¾çš„ä¿¡å¿ƒã€‚å¦‚æœæ•°æ®é›†æœ‰ *n* ä¸ªæ¡ç›®å’Œ *m* ä¸ªç±»åˆ«ï¼Œé‚£ä¹ˆè¿™å°†ç”±ä¸€ä¸ª
    *n* x *m* çš„çŸ©é˜µ P è¡¨ç¤ºï¼Œå…¶ä¸­ P[i, j] ä»£è¡¨ç¬¬ *i* è¡Œå±äºç±»åˆ« *j* çš„æ¦‚ç‡ã€‚'
- en: These probabilities and the â€œtrueâ€ labels are used in the CleanLab internals
    to estimate the errors.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æ¦‚ç‡å’Œâ€œçœŸå®â€æ ‡ç­¾è¢«ç”¨åœ¨ CleanLab çš„å†…éƒ¨ä»¥ä¼°è®¡é”™è¯¯ã€‚
- en: 'Letâ€™s practice:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç»ƒä¹ ä¸€ä¸‹ï¼š
- en: '*Importing packages*'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '*å¯¼å…¥åŒ…*'
- en: '[PRE1]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '*loading dataâ€¦*'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '*åŠ è½½æ•°æ®ä¸­â€¦*'
- en: '[PRE2]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: First of all, letâ€™s generate the probabilities.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”Ÿæˆæ¦‚ç‡ã€‚
- en: 'As mentioned in the CleanLab documentation, to achieve better performance is
    crucial that the probabilities are generated [on out-of-sample records](https://docs.cleanlab.ai/stable/tutorials/pred_probs_cross_val.html#pred-probs-cross-val)
    (â€™non-trainingâ€™ data). This is important as the models naturally tend to be over-confident
    when predicting probabilities on training data. The most usual way to generate
    out-of-sample probabilities in a dataset is to use a K-Fold strategy, as shown
    below:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ CleanLab æ–‡æ¡£ä¸­æåˆ°çš„ï¼Œä¸ºäº†å®ç°æ›´å¥½çš„æ€§èƒ½ï¼Œç”Ÿæˆçš„æ¦‚ç‡å¿…é¡» [åŸºäºæ ·æœ¬å¤–è®°å½•](https://docs.cleanlab.ai/stable/tutorials/pred_probs_cross_val.html#pred-probs-cross-val)ï¼ˆâ€˜éè®­ç»ƒâ€™æ•°æ®ï¼‰ã€‚è¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºæ¨¡å‹åœ¨é¢„æµ‹è®­ç»ƒæ•°æ®ä¸Šçš„æ¦‚ç‡æ—¶ï¼Œé€šå¸¸ä¼šè¿‡äºè‡ªä¿¡ã€‚ç”Ÿæˆæ ·æœ¬å¤–æ¦‚ç‡çš„æœ€å¸¸ç”¨æ–¹æ³•æ˜¯ä½¿ç”¨
    K-Fold ç­–ç•¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE3]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'NOTE: Itâ€™s important to be aware of the class distribution â€” Hence the StratifiedKFold
    object. The chosen class represents less than 5% of the dataset, a naive sampling
    approach could easily lead to poor-quality probabilities generated by models trained
    on wrongly balanced datasets.'
  id: totrans-56
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼šé‡è¦çš„æ˜¯è¦äº†è§£ç±»åˆ«åˆ†å¸ƒ â€”â€” å› æ­¤ä½¿ç”¨äº† StratifiedKFold å¯¹è±¡ã€‚æ‰€é€‰ç±»åˆ«åœ¨æ•°æ®é›†ä¸­æ‰€å æ¯”ä¾‹ä¸è¶³ 5%ï¼Œä¸€ç§å¤©çœŸçš„é‡‡æ ·æ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹åœ¨ä¸æ­£ç¡®å¹³è¡¡çš„æ•°æ®é›†ä¸Šç”Ÿæˆä½è´¨é‡çš„æ¦‚ç‡ã€‚
- en: CleanLab uses a class called Datalab to handle its error-detection jobs. It
    receives the DataFrame containing our data and the label columnâ€™s name.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: CleanLab ä½¿ç”¨ä¸€ä¸ªåä¸º Datalab çš„ç±»æ¥å¤„ç†å…¶é”™è¯¯æ£€æµ‹ä»»åŠ¡ã€‚å®ƒæ¥æ”¶åŒ…å«æˆ‘ä»¬æ•°æ®çš„ DataFrame å’Œæ ‡ç­¾åˆ—çš„åç§°ã€‚
- en: '[PRE4]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Now, we just need to pass the previously calculated probabilities to it â€¦
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€å°†å…ˆå‰è®¡ç®—çš„æ¦‚ç‡ä¼ é€’ç»™å®ƒâ€¦â€¦
- en: '[PRE5]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: â€¦ to start finding issues
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦â€¦å¼€å§‹æŸ¥æ‰¾é—®é¢˜
- en: '[PRE6]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/18b86c0c2d30b30543c431a2c24802a7.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/18b86c0c2d30b30543c431a2c24802a7.png)'
- en: And is simple as that.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™ä¹ˆç®€å•ã€‚
- en: The *get_issues*(â€labelâ€) function returns a DataFrame with the metrics and
    indicators calculated by CleanLab for each record. The most important columns
    are â€˜*is_label_issue*â€™ and â€˜*predicted_label*â€™, representing respectively if a
    record has a label issue and the possible correct label for it.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '*get_issues*(â€labelâ€) å‡½æ•°è¿”å›ä¸€ä¸ª DataFrameï¼ŒåŒ…å« CleanLab ä¸ºæ¯æ¡è®°å½•è®¡ç®—çš„æŒ‡æ ‡å’ŒæŒ‡æ ‡ã€‚æœ€é‡è¦çš„åˆ—æ˜¯ â€˜*is_label_issue*â€™
    å’Œ â€˜*predicted_label*â€™ï¼Œåˆ†åˆ«è¡¨ç¤ºè®°å½•æ˜¯å¦å­˜åœ¨æ ‡ç­¾é—®é¢˜ä»¥åŠå¯èƒ½çš„æ­£ç¡®æ ‡ç­¾ã€‚'
- en: '[PRE7]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We can merge this information in the original DataFrame to inspect which examples
    are problematic.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä¿¡æ¯åˆå¹¶åˆ°åŸå§‹ DataFrame ä¸­ï¼Œä»¥æ£€æŸ¥å“ªäº›ç¤ºä¾‹æ˜¯æœ‰é—®é¢˜çš„ã€‚
- en: '[PRE8]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Letâ€™s check a few examples:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ï¼š
- en: '![](../Images/3860e3258b8a00fd1fdbe455d23c18ab.png)![](../Images/78d445cc8ecdad5f1e1925259f2b4547.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3860e3258b8a00fd1fdbe455d23c18ab.png)![](../Images/78d445cc8ecdad5f1e1925259f2b4547.png)'
- en: To me, these laws are clearly associated with *Tributes and Commemorative Dates*;
    however, they are not appropriately categorized as such.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹æˆ‘æ¥è¯´ï¼Œè¿™äº›æ³•å¾‹æ˜¾ç„¶ä¸*è‡´æ•¬å’Œçºªå¿µæ—¥æœŸ*ç›¸å…³ï¼›ç„¶è€Œï¼Œå®ƒä»¬å¹¶æ²¡æœ‰è¢«é€‚å½“åœ°åˆ†ç±»ä¸ºè¿™äº›ã€‚
- en: Nice ! â€” CleanLab was able to find 312 label errors in our dataset, but what
    to do now?
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: å¾ˆå¥½ï¼â€”â€” CleanLab èƒ½å¤Ÿåœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æ‰¾åˆ° 312 ä¸ªæ ‡ç­¾é”™è¯¯ï¼Œä½†ç°åœ¨è¯¥æ€ä¹ˆåŠï¼Ÿ
- en: These errors could be either objects of a manual inspection for correction (in
    an active-learning manner) or instantly corrected (supposing that CleanLab did
    its job right). The former is more time-consuming but could lead to better results,
    while the latter is faster, but could lead to more errors.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›é”™è¯¯å¯ä»¥æ˜¯æ‰‹åŠ¨æ£€æŸ¥ä»¥è¿›è¡Œä¿®æ­£çš„å¯¹è±¡ï¼ˆä»¥ä¸»åŠ¨å­¦ä¹ çš„æ–¹å¼ï¼‰æˆ–ç«‹å³ä¿®æ­£ï¼ˆå‡è®¾ CleanLab åšå¾—å¯¹ï¼‰ã€‚å‰è€…æ›´è€—æ—¶ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ›´å¥½çš„ç»“æœï¼Œè€Œåè€…æ›´å¿«ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ›´å¤šé”™è¯¯ã€‚
- en: Regardless of the chosen path, CleanLab reduced the labor from 60K records to
    a few hundred â€” in the worst case.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºé€‰æ‹©å“ªæ¡è·¯å¾„ï¼ŒCleanLab éƒ½å°†è®°å½•çš„åŠ³åŠ¨é‡ä» 60K å‡å°‘åˆ°å‡ ç™¾æ¡ â€”â€” åœ¨æœ€åçš„æƒ…å†µä¸‹ã€‚
- en: '*But there is a catch.*'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '*ä½†æœ‰ä¸€ä¸ªé™·é˜±ã€‚*'
- en: How can we be sure that CleanLab found **all** the errors in the dataset?
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ€ä¹ˆèƒ½ç¡®ä¿ CleanLab æ‰¾åˆ°äº†æ•°æ®é›†ä¸­çš„**æ‰€æœ‰**é”™è¯¯ï¼Ÿ
- en: In fact, if we run the above pipeline but with the errors fixed as ground truth,
    CleanLab will find more errorsâ€¦
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: å®é™…ä¸Šï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œä¸Šè¿°ç®¡é“ï¼Œä½†å°†é”™è¯¯ä¿®æ­£ä¸ºçœŸå®æ ‡ç­¾ï¼ŒCleanLab å°†ä¼šå‘ç°æ›´å¤šé”™è¯¯â€¦â€¦
- en: More errors, but *hopefully* fewer errors than the first run.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: é”™è¯¯æ›´å¤šï¼Œä½†*å¸Œæœ›*æ¯”ç¬¬ä¸€æ¬¡è¿è¡Œçš„é”™è¯¯å°‘ã€‚
- en: 'And we can repeat this logic as many times as we want: Find errors, fix errors,
    retrain the model with the new presumed better-quality labels, find errors again
    â€¦'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é‡å¤è¿™ä¸ªé€»è¾‘ä»»æ„æ¬¡æ•°ï¼šæ‰¾å‡ºé”™è¯¯ï¼Œä¿®æ­£é”™è¯¯ï¼Œç”¨æ–°å‡å®šçš„æ›´é«˜è´¨é‡æ ‡ç­¾é‡æ–°è®­ç»ƒæ¨¡å‹ï¼Œå†æ¬¡æ‰¾å‡ºé”™è¯¯â€¦â€¦
- en: '![](../Images/10bf4f2f521ce9afa9cba9dd8aabecb2.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10bf4f2f521ce9afa9cba9dd8aabecb2.png)'
- en: Fixing errors iteratively. Image by Author.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: è¿­ä»£ä¿®æ­£é”™è¯¯ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: With the hope that after some interactions the number of errors will be zero.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: å¸Œæœ›åœ¨ä¸€äº›äº¤äº’ä¹‹åï¼Œé”™è¯¯çš„æ•°é‡å°†ä¼šæ˜¯é›¶ã€‚
- en: Iteratively fixing errors with CleanLab
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ CleanLab è¿­ä»£ä¿®æ­£é”™è¯¯
- en: 'To implement this idea all that we need to do is to repeat the process above
    in a loop, the code below does just that:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: è¦å®ç°è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬åªéœ€åœ¨å¾ªç¯ä¸­é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œä¸‹é¢çš„ä»£ç æ­£æ˜¯è¿™æ ·åšçš„ï¼š
- en: Letâ€™s review it.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ã€‚
- en: 'In each iteration, the OOS probabilities are generated just as shown previously:
    using the *cross_val_predict* method with StratifiedKFold. The current set of
    probabilities (in each iteration) is used to build a new Datalab object and find
    the new label issues.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼ŒOOS æ¦‚ç‡æ˜¯æŒ‰ç…§ä¹‹å‰å±•ç¤ºçš„æ–¹å¼ç”Ÿæˆçš„ï¼šä½¿ç”¨*cross_val_predict*æ–¹æ³•å’ŒStratifiedKFoldã€‚å½“å‰çš„æ¦‚ç‡é›†ï¼ˆæ¯æ¬¡è¿­ä»£ä¸­ï¼‰ç”¨äºæ„å»ºä¸€ä¸ªæ–°çš„Datalabå¯¹è±¡å¹¶å‘ç°æ–°çš„æ ‡ç­¾é—®é¢˜ã€‚
- en: The found issues are merged with the current dataset and fixed.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: å‘ç°çš„é—®é¢˜ä¸å½“å‰æ•°æ®é›†åˆå¹¶å¹¶ä¿®å¤ã€‚
- en: I choose the strategy of appending the fixed labels as a new column instead
    of replacing the original one.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘é€‰æ‹©äº†å°†ä¿®å¤åçš„æ ‡ç­¾ä½œä¸ºæ–°åˆ—é™„åŠ çš„ç­–ç•¥ï¼Œè€Œä¸æ˜¯æ›¿æ¢åŸå§‹åˆ—ã€‚
- en: '![](../Images/8de06e839952d37d0a01ab1a3d2f79db.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8de06e839952d37d0a01ab1a3d2f79db.png)'
- en: Appending the fixed labels. Image by Author.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: é™„åŠ ä¿®å¤åçš„æ ‡ç­¾ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: LABEL_COLUMN_0 is the original label, LABEL_COLUMN_1 is the label column fixed
    1 time, LABEL_COLUMN_2 is the label column fixed 2 times, and so onâ€¦
  id: totrans-91
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: LABEL_COLUMN_0 æ˜¯åŸå§‹æ ‡ç­¾ï¼ŒLABEL_COLUMN_1 æ˜¯ä¿®å¤1æ¬¡çš„æ ‡ç­¾åˆ—ï¼ŒLABEL_COLUMN_2 æ˜¯ä¿®å¤2æ¬¡çš„æ ‡ç­¾åˆ—ï¼Œä»¥æ­¤ç±»æ¨â€¦â€¦
- en: In addition to this process, the usual classification metrics are also computed
    and stored for later inspection.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†è¿™ä¸ªè¿‡ç¨‹ä¹‹å¤–ï¼Œè¿˜è®¡ç®—å¹¶å­˜å‚¨äº†å¸¸è§„åˆ†ç±»æŒ‡æ ‡ï¼Œä»¥å¤‡åç»­æ£€æŸ¥ã€‚
- en: After 8 interactions (~16min) the process is finished.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ç»è¿‡8æ¬¡äº’åŠ¨ï¼ˆçº¦16åˆ†é’Ÿï¼‰ï¼Œè¿‡ç¨‹å®Œæˆäº†ã€‚
- en: The Results
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“æœ
- en: The table below shows the performance metrics computed during the process.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹è¡¨æ˜¾ç¤ºäº†åœ¨è¿‡ç¨‹ä¸­çš„æ€§èƒ½æŒ‡æ ‡ã€‚
- en: '![](../Images/4703adfb83c3b6e815df7719203e2aef.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4703adfb83c3b6e815df7719203e2aef.png)'
- en: A total of **393 label errors** were found in the dataset in the 8 iterations.
    As expected, the number of errors found decreased with each iteration.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨8æ¬¡è¿­ä»£ä¸­ï¼Œæ•°æ®é›†ä¸­å‘ç°äº†æ€»è®¡**393ä¸ªæ ‡ç­¾é”™è¯¯**ã€‚æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå‘ç°çš„é”™è¯¯æ•°é‡éšç€æ¯æ¬¡è¿­ä»£çš„å¢åŠ è€Œå‡å°‘ã€‚
- en: Itâ€™s interesting to note that this process was able to â€œconvergeâ€ to a â€œsolutionâ€
    with only 6 iterations â€” staying at 0 errors in the last 2\. This is a good indication
    that, in this case, the CleanLab implementation is robust and did not find any
    more errors by â€˜accidentâ€™ that could lead to oscillations.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ä»…ä»…6æ¬¡è¿­ä»£ä¸­å°±èƒ½å¤Ÿâ€œæ”¶æ•›â€åˆ°ä¸€ä¸ªâ€œè§£å†³æ–¹æ¡ˆâ€â€”â€”åœ¨æœ€å2æ¬¡è¿­ä»£ä¸­é”™è¯¯æ•°ä¿æŒä¸º0ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿¹è±¡ï¼Œè¯´æ˜åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCleanLabçš„å®ç°æ˜¯ç¨³å¥çš„ï¼Œå¹¶ä¸”æ²¡æœ‰å‘ç°ä»»ä½•å¯èƒ½å¯¼è‡´æŒ¯è¡çš„â€˜å¶ç„¶â€™é”™è¯¯ã€‚
- en: Even though the number of errors represents only 0.6% of the dataset, the f1
    score increased from 0.81 to 0.90, ~11%. This is probably due to the classes being
    highly unbalanced, as the new 322 positive labels represent a total of ~12% in
    the number of original positive examples.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: å°½ç®¡é”™è¯¯çš„æ•°é‡ä»…å æ•°æ®é›†çš„0.6%ï¼Œf1åˆ†æ•°ä»0.81æé«˜åˆ°äº†0.90ï¼Œçº¦11%ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç±»åˆ«é«˜åº¦ä¸å¹³è¡¡ï¼Œå› ä¸ºæ–°çš„322ä¸ªæ­£æ ‡ç­¾æ€»å…±å åŸå§‹æ­£æ ·æœ¬çš„çº¦12%ã€‚
- en: But was CleanLab really able to find meaningful errors? Letâ€™s check a few examples
    to see if they make sense.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†CleanLabçœŸçš„èƒ½å¤Ÿå‘ç°æœ‰æ„ä¹‰çš„é”™è¯¯å—ï¼Ÿè®©æˆ‘ä»¬æ£€æŸ¥å‡ ä¸ªä¾‹å­çœ‹çœ‹å®ƒä»¬æ˜¯å¦æœ‰æ„ä¹‰ã€‚
- en: '**False negatives fixed**'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**å‡é˜´æ€§å·²ä¿®å¤**'
- en: '![](../Images/3cd56b85d5a050f44f03bbfaa5af56e4.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3cd56b85d5a050f44f03bbfaa5af56e4.png)'
- en: Original summaries and a literal translation by ChatGPT â€” II. Image by Author.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: åŸå§‹æ€»ç»“å’ŒChatGPTçš„é€å­—ç¿»è¯‘ â€” II. å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: The above texts indeed resemble â€œtributes and commemorative datesâ€, suggesting
    that they should be appropriately categorized as such â€” Point to CleanLab
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šè¿°æ–‡æœ¬ç¡®å®ç±»ä¼¼äºâ€œè‡´æ•¬å’Œçºªå¿µæ—¥æœŸâ€ï¼Œè¿™è¡¨æ˜å®ƒä»¬åº”è¯¥è¢«é€‚å½“åœ°åˆ†ç±»ä¸ºæ­¤ç±» â€” æŒ‡å‘CleanLab
- en: '**False positives fixed**'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**å‡é˜³æ€§å·²ä¿®å¤**'
- en: '![](../Images/b6e491d0925dc75bee1219f14afc62bb.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b6e491d0925dc75bee1219f14afc62bb.png)'
- en: Original summaries and a literal translation by ChatGPT â€” III. Image by Author.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: åŸå§‹æ€»ç»“å’ŒChatGPTçš„é€å­—ç¿»è¯‘ â€” III. å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: We have a few errors in this case, the 2nd and 4th laws arenâ€™t false positives.
    Not so good, but stillÂ ok.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æœ‰ä¸€äº›é”™è¯¯ï¼Œç¬¬2å’Œç¬¬4æ¡è§„åˆ™ä¸æ˜¯å‡é˜³æ€§ã€‚è™½ç„¶ä¸æ˜¯å¾ˆå¥½ï¼Œä½†è¿˜ç®—å¯ä»¥ã€‚
- en: Iâ€™ve repeated this inspection sampling new â€˜fixedâ€™ laws several times and, in
    general, CleanLab has a nearly perfect performance in detecting false negatives
    but gets a little confused with the false positives.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘é‡å¤è¿›è¡Œäº†è¿™ä¸ªæ£€æŸ¥é‡‡æ ·æ–°â€˜å›ºå®šâ€™è§„åˆ™çš„æ“ä½œå‡ æ¬¡ï¼Œæ€»çš„æ¥è¯´ï¼ŒCleanLabåœ¨æ£€æµ‹å‡é˜´æ€§æ–¹é¢è¡¨ç°å‡ ä¹å®Œç¾ï¼Œä½†å¯¹å‡é˜³æ€§æœ‰ç‚¹å›°æƒ‘ã€‚
- en: Now, even though we probably donâ€™t have a *perfectly* labeled dataset, I feel
    way more **confident** in training a machine **learning** model in it now.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œå³ä½¿æˆ‘ä»¬å¯èƒ½æ²¡æœ‰ä¸€ä¸ª*å®Œç¾*æ ‡è®°çš„æ•°æ®é›†ï¼Œæˆ‘ä¹Ÿæ›´**è‡ªä¿¡**ç°åœ¨ç”¨å®ƒæ¥è®­ç»ƒæœºå™¨**å­¦ä¹ **æ¨¡å‹äº†ã€‚
- en: Conclusion
  id: totrans-111
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: For long the machine learning area suffered from poor quality models and lack
    of computer power, but this time is gone. Now, the real bottleneck for most ML
    applications is data. But not raw data, refined data â€” with good labels, well-formatted,
    without too much noise or outliers.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: æœºå™¨å­¦ä¹ é¢†åŸŸé•¿æœŸä»¥æ¥å—å›°äºæ¨¡å‹è´¨é‡å·®å’Œè®¡ç®—èƒ½åŠ›ä¸è¶³ï¼Œä½†è¿™ç§æƒ…å†µå·²ç»è¿‡å»ã€‚ç°åœ¨ï¼Œå¤§å¤šæ•°æœºå™¨å­¦ä¹ åº”ç”¨çš„çœŸæ­£ç“¶é¢ˆæ˜¯æ•°æ®ã€‚ä¸æ˜¯åŸå§‹æ•°æ®ï¼Œè€Œæ˜¯ç»è¿‡ç²¾ç‚¼çš„æ•°æ®â€”â€”å…·æœ‰è‰¯å¥½æ ‡ç­¾ã€æ ¼å¼è§„èŒƒã€å™ªéŸ³æˆ–å¼‚å¸¸å€¼è¾ƒå°‘çš„æ•°æ®ã€‚
- en: 'Because no matter how big and powerful a model is, how much statistics and
    maths you mix into your pipeline, any of this will save you from the most basic
    law of computer science: garbage in, garbage out.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºæ— è®ºæ¨¡å‹å¤šä¹ˆåºå¤§å’Œå¼ºå¤§ï¼Œæ— è®ºä½ åœ¨ç®¡é“ä¸­æ··å…¥å¤šå°‘ç»Ÿè®¡å’Œæ•°å­¦ï¼Œè¿™äº›éƒ½æ— æ³•æ‹¯æ•‘ä½ å…äºè®¡ç®—æœºç§‘å­¦çš„æœ€åŸºæœ¬æ³•åˆ™ï¼šåƒåœ¾è¿›ï¼Œåƒåœ¾å‡ºã€‚
- en: 'And this project was a witness to this principle â€” Iâ€™ve tested several models,
    Deep Learning architectures, sampling techniques, and vectorization methods to,
    in the end, discover that the problem was on the basics: my data was wrong.'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªé¡¹ç›®è§è¯äº†è¿™ä¸€åŸåˆ™â€”â€”æˆ‘æµ‹è¯•äº†å‡ ä¸ªæ¨¡å‹ã€æ·±åº¦å­¦ä¹ æ¶æ„ã€é‡‡æ ·æŠ€æœ¯å’Œå‘é‡åŒ–æ–¹æ³•ï¼Œæœ€ç»ˆå‘ç°é—®é¢˜å‡ºåœ¨åŸºç¡€ä¸Šï¼šæˆ‘çš„æ•°æ®æ˜¯é”™è¯¯çš„ã€‚
- en: In such a scenario, investing in data quality techniques became a critical aspect
    to create successful ML projects.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŠ•èµ„äºæ•°æ®è´¨é‡æŠ€æœ¯æˆä¸ºåˆ›å»ºæˆåŠŸæœºå™¨å­¦ä¹ é¡¹ç›®çš„å…³é”®æ–¹é¢ã€‚
- en: In this post, we explored CleanLab, a package that helped us to detect and fix
    wrong labels in the dataset. It not only enabled us to significantly improve the
    quality of our dataset but it also did this in an automatic, reproducible, and
    cheap way â€” with no human intervention.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº† CleanLabï¼Œè¿™ä¸ªåŒ…å¸®åŠ©æˆ‘ä»¬æ£€æµ‹å’Œä¿®å¤æ•°æ®é›†ä¸­çš„é”™è¯¯æ ‡ç­¾ã€‚å®ƒä¸ä»…æ˜¾è‘—æé«˜äº†æ•°æ®é›†çš„è´¨é‡ï¼Œè€Œä¸”ä»¥è‡ªåŠ¨ã€å¯é‡å¤ä¸”å»‰ä»·çš„æ–¹å¼å®Œæˆâ€”â€”æ— éœ€äººå·¥å¹²é¢„ã€‚
- en: I hope this project helped you in understanding a little more about Confident
    Learning and the CleanLab package. As always, Iâ€™m not an expert in any of the
    subjects addressed in this post, and I strongly recommend further reading, see
    some references below.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¸Œæœ›è¿™ä¸ªé¡¹ç›®èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è‡ªä¿¡å­¦ä¹ å’Œ CleanLab åŒ…ã€‚æ­£å¦‚å¾€å¸¸ä¸€æ ·ï¼Œæˆ‘å¹¶ä¸æ˜¯è¿™äº›ä¸»é¢˜çš„ä¸“å®¶ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ è¿›ä¸€æ­¥é˜…è¯»ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å‚è€ƒæ–‡çŒ®ã€‚
- en: Thank you for reading! ;)
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼ğŸ˜‰
- en: References
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å‚è€ƒæ–‡çŒ®
- en: All the code is available in [this GitHub repository](https://github.com/jaumpedro214/data-analysis-camara-federal-pls).
  id: totrans-120
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨[è¿™ä¸ª GitHub ä»“åº“](https://github.com/jaumpedro214/data-analysis-camara-federal-pls)ä¸­æ‰¾åˆ°ã€‚
- en: Data used â€” [Open Data Portal Federal Chamber](https://dadosabertos.camara.leg.br/faq/faq-home.html#r14).
    [Open-Data â€” Law nÂº 12.527]
  id: totrans-121
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½¿ç”¨çš„æ•°æ® â€” [å¼€æ”¾æ•°æ®é—¨æˆ·è”é‚¦è®®ä¼š](https://dadosabertos.camara.leg.br/faq/faq-home.html#r14).
    [å¼€æ”¾æ•°æ® â€” æ³•å¾‹ nÂº 12.527]
- en: All the images are created by the Author, unless otherwise specified.
  id: totrans-122
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å›¾åƒå‡ç”±ä½œè€…åˆ›å»ºã€‚
- en: '[1] Cleanlab. (n.d.). *GitHub â€” cleanlab/cleanlab: The standard data-centric
    AI package for data quality and machine learning with messy, real-world data and
    labels.* [GitHub](https://github.com/cleanlab/cleanlab).'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '[1] Cleanlab. (æ— æ—¥æœŸ). *GitHub â€” cleanlab/cleanlab: æ ‡å‡†çš„æ•°æ®ä¸­å¿ƒ AI åŒ…ï¼Œç”¨äºå¤„ç†æ··ä¹±çš„çœŸå®ä¸–ç•Œæ•°æ®å’Œæ ‡ç­¾çš„æ•°æ®è´¨é‡å’Œæœºå™¨å­¦ä¹ ã€‚*
    [GitHub](https://github.com/cleanlab/cleanlab).'
- en: '[2][*Computing Out-of-Sample Predicted Probabilities with Cross-Validation*](https://docs.cleanlab.ai/stable/tutorials/pred_probs_cross_val.html#pred-probs-cross-val)
    *â€” cleanlab*. (n.d.).'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '[2][*è®¡ç®—æ ·æœ¬å¤–é¢„æµ‹æ¦‚ç‡çš„äº¤å‰éªŒè¯*](https://docs.cleanlab.ai/stable/tutorials/pred_probs_cross_val.html#pred-probs-cross-val)
    *â€” cleanlab*. (æ— æ—¥æœŸ).'
- en: '[3] Databricks. (2022, July 19). *CleanLab: AI to find and fix errors in ML
    datasets* [Video]. [YouTube](https://www.youtube.com/watch?v=BnOTv0f9Msk).'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '[3] Databricks. (2022å¹´7æœˆ19æ—¥). *CleanLab: ç”¨äºå‘ç°å’Œä¿®å¤ ML æ•°æ®é›†ä¸­çš„é”™è¯¯çš„ AI* [è§†é¢‘]. [YouTube](https://www.youtube.com/watch?v=BnOTv0f9Msk).'
- en: '[4][*FAQ*](https://docs.cleanlab.ai/stable/tutorials/faq.html) *â€” cleanlab*.
    (n.d.).'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '[4][*å¸¸è§é—®é¢˜*](https://docs.cleanlab.ai/stable/tutorials/faq.html) *â€” cleanlab*.
    (æ— æ—¥æœŸ).'
- en: '[5] Mall, S. (2023, May 25). Are label errors imperative? Is confident learning
    useful? [*Medium*](/confident-learning-err-did-you-say-your-data-is-clean-ef2597903328).'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '[5] Mall, S. (2023å¹´5æœˆ25æ—¥). æ ‡ç­¾é”™è¯¯æ˜¯å¦ä¸å¯é¿å…ï¼Ÿè‡ªä¿¡å­¦ä¹ æ˜¯å¦æœ‰ç”¨ï¼Ÿ[*Medium*](/confident-learning-err-did-you-say-your-data-is-clean-ef2597903328).'
- en: '[6] Northcutt, C. G. (2021). *Confident Learning: Estimating uncertainty in
    Dataset labels*. [arXiv.org](https://arxiv.org/abs/1911.00068).'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '[6] Northcutt, C. G. (2021). *è‡ªä¿¡å­¦ä¹ ï¼šä¼°è®¡æ•°æ®é›†æ ‡ç­¾çš„ä¸ç¡®å®šæ€§*. [arXiv.org](https://arxiv.org/abs/1911.00068).'

- en: 'Streamlit Tutorial: Creating Word Reports for Data Science Projects'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Streamlit教程：为数据科学项目创建Word报告
- en: 原文：[https://towardsdatascience.com/streamlit-tutorial-creating-word-reports-for-data-science-projects-96a749483cb3](https://towardsdatascience.com/streamlit-tutorial-creating-word-reports-for-data-science-projects-96a749483cb3)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/streamlit-tutorial-creating-word-reports-for-data-science-projects-96a749483cb3](https://towardsdatascience.com/streamlit-tutorial-creating-word-reports-for-data-science-projects-96a749483cb3)
- en: Combining python-docx and Streamlit for Data Science Report Automation
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将python-docx和Streamlit结合用于数据科学报告自动化
- en: '[](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)[![Andy
    McDonald](../Images/df11d647be032aeb3d31852affb33a64.png)](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)
    [Andy McDonald](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)[![Andy
    McDonald](../Images/df11d647be032aeb3d31852affb33a64.png)](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)
    [Andy McDonald](https://andymcdonaldgeo.medium.com/?source=post_page-----96a749483cb3--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)
    ·12 min read·Apr 17, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----96a749483cb3--------------------------------)
    ·12分钟阅读·2023年4月17日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/9e062c1dc458443a4896d81ae2166dcf.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9e062c1dc458443a4896d81ae2166dcf.png)'
- en: Report image generated by the author using Midjourney Basic Plan.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 报告图像由作者使用Midjourney基础计划生成。
- en: At the end of data-related projects, whether for petrophysics or data science,
    creating a report is a very common occurrence. The generated reports provide clients
    and end users with information on the key results and conclusions obtained during
    the study, as well as detailing the methodologies used.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据相关项目的结束阶段，无论是石油物理学还是数据科学，创建报告是非常常见的。生成的报告为客户和最终用户提供了在研究过程中获得的关键结果和结论的信息，并详细说明了使用的方法。
- en: However, creating structured reports can be a tedious and time-consuming process,
    especially when it comes to ensuring they are formatted correctly and the data
    is presented in the best way possible.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，创建结构化报告可能是一个繁琐且耗时的过程，特别是在确保报告格式正确和数据以最佳方式呈现时。
- en: This article will show how we can use the popular [Streamlit](https://streamlit.io/)
    library, combined with [python-docx](https://python-docx.readthedocs.io/en/latest/),
    to create the first step in automating part of the reporting process.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本文将展示我们如何使用流行的[Streamlit](https://streamlit.io/)库，结合[python-docx](https://python-docx.readthedocs.io/en/latest/)，来创建自动化报告过程的第一步。
- en: The [python-docx](https://python-docx.readthedocs.io/en/latest/) library will
    allow us to create a Microsoft Word report. Having the report in the format will
    allow us to make edits and apply finishing touches before making it into a PDF.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[python-docx](https://python-docx.readthedocs.io/en/latest/)库将允许我们创建一个Microsoft
    Word报告。将报告以这种格式呈现将使我们能够进行编辑，并在转换为PDF之前完成最后的润色。'
- en: Even though the worked example in this article requires mostly manual input,
    it could be adapted to include the power of large language models to summarise
    the data and create the required text.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本文中的示例需要主要的手动输入，但它可以适应大语言模型的强大功能，以总结数据并创建所需的文本。
- en: Let’s get started building a Streamlit Word document report generator.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始构建一个Streamlit Word文档报告生成器吧。
- en: Importing Libraries & Data
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 导入库和数据
- en: First, we will import the main libraries we are going to work with. These are
    [Streamlit](https://streamlit.io/), [pandas](https://pandas.pydata.org/), [matplotlib](https://matplotlib.org/)
    and [python-docx](https://python-docx.readthedocs.io/en/latest/).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将导入我们要使用的主要库。这些库包括[Streamlit](https://streamlit.io/)、[pandas](https://pandas.pydata.org/)、[matplotlib](https://matplotlib.org/)和[python-docx](https://python-docx.readthedocs.io/en/latest/)。
- en: '[PRE0]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Next, we will set the Streamlit page layout to wide. This allows the app to
    take up the full width of the browser window rather than being a narrow column
    in the middle.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将设置 Streamlit 页面布局为宽幅。这使得应用程序能够占据浏览器窗口的整个宽度，而不是位于中间的窄列中。
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Setting Up the Streamlit UI
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置 Streamlit 用户界面（UI）
- en: Now we can start building out the User Interface (UI).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以开始构建用户界面（UI）。
- en: We will start by giving our app a title.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从为我们的应用程序添加标题开始。
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/addc7550adbb4d4ca3cfd0ea300520c0.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/addc7550adbb4d4ca3cfd0ea300520c0.png)'
- en: The starting point for the Report Generator. Image by the author.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 报告生成器的起始点。图片来源：作者。
- en: To keep things simple, we will pre-load our data using `pd.read_csv()` and pass
    in a file name.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化操作，我们将使用 `pd.read_csv()` 预加载我们的数据并传入一个文件名。
- en: '[PRE3]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The dataset used for this tutorial is a subset of a training dataset used as
    part of a [**Machine Learning competition run by Xeek and FORCE 2020**](https://doi.org/10.5281/zenodo.4351156)(Bormann
    et al., 2020). This dataset is licensed under a a Creative Commons Attribution
    4.0 International license.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程使用的数据集是 [**Xeek 和 FORCE 2020 举办的机器学习竞赛**](https://doi.org/10.5281/zenodo.4351156)（Bormann
    等，2020）中的一个子集。该数据集在 Creative Commons Attribution 4.0 International 许可证下授权。
- en: To make this app more flexible, we could add a file uploader allowing users
    to load their own data.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使应用程序更具灵活性，我们可以添加一个文件上传器，允许用户加载他们自己的数据。
- en: You can find out more on how to do this in my article [**Uploading and Reading
    Files with Streamlit**](https://medium.com/@andymcdonaldgeo/uploading-and-reading-files-with-streamlit-92885ac3a1b6)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在我的文章 [**上传和读取 Streamlit 文件**](https://medium.com/@andymcdonaldgeo/uploading-and-reading-files-with-streamlit-92885ac3a1b6)
    中了解更多关于如何做到这一点的信息。
- en: Creating the Report Form with st.form
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 st.form 创建报告表单
- en: When widgets are included within a Streamlit app, any time they are edited or
    selected, the Streamlit app will re-run. To prevent this, we can create a form.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 当小部件包含在 Streamlit 应用程序中时，每次编辑或选择它们时，Streamlit 应用程序都会重新运行。为了防止这种情况，我们可以创建一个表单。
- en: This will allow us to enter values, and the app will only run when the button
    is pressed.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这将允许我们输入值，应用程序只会在按下按钮时运行。
- en: We can create a form using `with st.form('report')` followed by the inputs we
    want.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 `with st.form('report')` 创建一个表单，然后添加我们想要的输入。
- en: '![](../Images/4da04c2269429258d20fedf73bf76278.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4da04c2269429258d20fedf73bf76278.png)'
- en: Streamlit report generator with report details section. Image by the author.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 带有报告详细部分的 Streamlit 报告生成器。图片来源：作者。
- en: We will use the upper section of our app to create the report metadata. This
    includes the title of the report, who the author is, who the client is and the
    date for the report.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用应用程序的上部来创建报告元数据。这包括报告的标题、作者、客户以及报告的日期。
- en: Each of these elements is tied to a user input widget from Streamlit.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这些元素中的每一个都与来自 Streamlit 的用户输入小部件相关联。
- en: '[PRE4]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: For the form to display, we need to add a submit button. This is done using
    `st.form_submit_button()` . Here, we can pass a label that will appear on the
    button.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 为了显示表单，我们需要添加一个提交按钮。使用 `st.form_submit_button()` 可以完成这一点。在这里，我们可以传递一个将出现在按钮上的标签。
- en: '[PRE5]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Underneath this, I have placed a call to a `generate_report` function, which
    we will create shortly. For the moment, this will act as a placeholder.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在此之下，我放置了一个 `generate_report` 函数调用，我们将很快创建这个函数。目前，这将作为一个占位符。
- en: Here is the code for the form so far.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这是目前表单的代码。
- en: '[PRE6]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Creating a Report Section in the Streamlit Form
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Streamlit 表单中创建报告部分
- en: Reports are generally comprised of multiple sections or chapters.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 报告通常由多个部分或章节组成。
- en: To illustrate creating a very simple section within our app, we will add some
    inputs for the user to enter the section title and summary.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明如何在我们的应用程序中创建一个非常简单的部分，我们将添加一些输入，让用户输入部分标题和摘要。
- en: '![](../Images/1f35ef8a87fecbfaa810251d9f29a3ca.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1f35ef8a87fecbfaa810251d9f29a3ca.png)'
- en: Streamlit report generator with the section input boxes. Image by the author.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 带有部分输入框的 Streamlit 报告生成器。图片来源：作者。
- en: In the above image, I have added two new input widgets.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在上图中，我添加了两个新的输入小部件。
- en: A section title, which is a simple text input (`st.text_input`), and a summary
    of the section, which is a text area (`st.text_area`).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 一个部分标题，这是一个简单的文本输入（`st.text_input`），和该部分的摘要，这是一个文本区域（`st.text_area`）。
- en: Additionally, I have created two new columns to separate them from the columns
    above. This is important if we want to add any full-width text/info between these
    parts of the form.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我创建了两个新的列，以将它们与上面的列分开。如果我们想在这些表单部分之间添加任何全宽的文本/信息，这一点非常重要。
- en: 'Here is our form code so far:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们目前的表单代码：
- en: '[PRE7]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We could expand this capability so that the user can add multiple sections.
    Each could then be coded to start on a new page using a page break.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以扩展此功能，以便用户可以添加多个部分。每个部分都可以被编码为在新页面上开始，使用分页符。
- en: Additionally, to make it more comprehensive, we could generate a preview of
    the report as it is being built within the app.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，为了使其更全面，我们可以在应用程序中生成报告的预览。
- en: Lots of possibilities!
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 可能性非常多！
- en: Including a Dataframe in a Word Document Using docx
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Word 文档中包含数据框使用 docx
- en: Tables are essential in reports as they help present information in a clear,
    simple and organised way. This allows the readers to quickly understand the data
    and also compare it against other data values/categories in the same or different
    table.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 表格在报告中至关重要，因为它们有助于以清晰、简单和有组织的方式展示信息。这使读者能够快速理解数据，并将其与同一或不同表中的其他数据值/类别进行比较。
- en: To illustrate including a table in our report, we can use the statistical summary
    generated by the pandas `describe()` function as an example.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明在报告中包含一个表格，我们可以使用 pandas `describe()` 函数生成的统计摘要作为示例。
- en: Within the UI, we can add a multi-select option that will allow the user to
    select columns from the dataframe. This is especially handy if we have many columns
    and are only interested in a select few.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在 UI 中，我们可以添加一个多选选项，允许用户从数据框中选择列。如果我们有许多列且只对其中一些感兴趣，这将特别方便。
- en: '![](../Images/d81e1188300b3d34589da7da49e21e67.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d81e1188300b3d34589da7da49e21e67.png)'
- en: Streamlit report generator with the option for users to select columns from
    a dataframe. Image by the author.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: Streamlit 报告生成器允许用户从数据框中选择列。图片由作者提供。
- en: Before creating the multi-select entry box, we first need to grab the column
    names from the dataframe, which is done by creating a new variable and assigning
    it to `df.columns`
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建多选条目框之前，我们首先需要从数据框中获取列名，这可以通过创建一个新变量并将其分配给 `df.columns` 来完成。
- en: We then create the multi-select box using `st.multiselect()` . As we are working
    within columns, we need to call upon the required column. Which, in this case,
    is `sect_col2`.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们使用 `st.multiselect()` 创建多选框。由于我们在处理列，因此需要调用所需的列。在这种情况下，是 `sect_col2`。
- en: '[PRE8]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Next, we need to create two functions.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要创建两个函数。
- en: The first will take the features we are interested in along with the dataframe,
    and generate the statistical summary of the data.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个函数将获取我们感兴趣的特征和数据框，并生成数据的统计摘要。
- en: '[PRE9]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The second function is a little bit more complex.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个函数要复杂一些。
- en: 'As python-docx doesn’t natively support dataframes, we need to create a table
    using docx like so:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 python-docx 不原生支持数据框，我们需要使用 docx 创建一个表格，如下所示：
- en: '[PRE10]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: We will call these functions when the button is pressed.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 当按钮被按下时，我们将调用这些函数。
- en: Adding a Chart to the Word Document
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将图表添加到 Word 文档
- en: Charts form another essential part of a report. They allow us to convey large
    amounts of data concisely.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图表是报告的另一个重要部分。它们使我们能够简明扼要地传达大量数据。
- en: To illustrate the creation and inclusion of a chart within the final Word document,
    we will allow the user to select three columns from the dataset. These will then
    be used to create a scatterplot to be added to the report.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明在最终 Word 文档中创建和包含图表，我们将允许用户从数据集中选择三列。然后，这些将用于创建一个散点图，并添加到报告中。
- en: '![](../Images/1ddf7ae8713ff711c4813e6c68114914.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1ddf7ae8713ff711c4813e6c68114914.png)'
- en: Streamlit report generator after including options for the Scatterplot. Image
    by the author.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在包括散点图选项后，Streamlit 报告生成器。图片由作者提供。
- en: As seen in the image above, we will add the three selection boxes below the
    previous two sections. These will be added to three new columns and are created
    using Streamlit’s `selectbox()`.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，我们将在前面两个部分下方添加三个选择框。这些将添加到三个新列中，并使用 Streamlit 的 `selectbox()` 创建。
- en: '[PRE11]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: We will then create a new function called `create_scatterplot`that will be used
    to create our figure.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将创建一个新的函数，称为 `create_scatterplot`，用于生成我们的图形。
- en: 'We will set our function up to take several arguments:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将设置我们的函数以接受多个参数：
- en: '`dataframe` : the dataframe object containing the data'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dataframe`：包含数据的数据框对象'
- en: '`xaxis`: feature to be plotted on the x-axis'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`xaxis`：要在 x 轴上绘制的特征'
- en: '`yaxis`: feature to be plotted on the y-axis'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`yaxis`：要在 y 轴上绘制的特征'
- en: '`colour`: feature to be used to colour the data points'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`colour`：用于为数据点上色的特征'
- en: '`plot_name`: the name of our plot. This will be used as the file name'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`plot_name`：我们图表的名称。这将用作文件名'
- en: '`xaxis_scale`: a list which contains two elements and will be used to define
    the min and max range for the x-axis'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`xaxis_scale`：一个包含两个元素的列表，用于定义 x 轴的最小值和最大值范围'
- en: '`yaxis_scale`: a list which contains two elements and will be used to define
    the min and max range for the y-axis'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`yaxis_scale`：一个包含两个元素的列表，用于定义 y 轴的最小值和最大值范围'
- en: By default, the `xaxis_scale`, and `yaxis_scale` will both be set to `None`.
    If the user does not pass these in, then matplotlib will use the min and max range
    of the data plotted as the axes limits.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`xaxis_scale` 和 `yaxis_scale` 都会设置为 `None`。如果用户没有提供这些，matplotlib 将使用数据绘制的最小值和最大值作为轴的范围。
- en: Python-docx does not natively support matplotlib figures. As a workaround, we
    need to save our plot as a file, which can be picked up when we start writing
    to the Word document.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Python-docx 本身不支持 matplotlib 图形。作为一种解决方法，我们需要将我们的图保存为文件，然后在开始写入 Word 文档时使用。
- en: '[PRE12]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Adding Separating Horizontal Lines to the Streamlit UI
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 向 Streamlit UI 添加分隔水平线
- en: To help break up the UI and make each section stand out, we can add a horizontal
    line using `st.write('---')`.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助分隔 UI 并使每个部分突出显示，我们可以使用 `st.write('---')` 添加水平线。
- en: This will be converted from markdown language to an actual line.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 这将从 Markdown 语言转换为实际的行。
- en: 'If you want to find out more about the `st.write` function, then check out:
    [**How to Use Streamlit’s st.write Function to Improve Your Streamlit Dashboard.**](https://medium.com/p/1586333eb24d)'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解更多关于 `st.write` 函数的信息，可以查看：[**如何使用 Streamlit 的 st.write 函数来改善你的 Streamlit
    仪表板。**](https://medium.com/p/1586333eb24d)
- en: 'Our final code for the Streamlit form is as follows:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的最终代码如下：
- en: '[PRE13]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Creating the Word Report Generating Function
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建 Word 报告生成函数
- en: Our final part is to create the `generate_report` function.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的最后一步是创建 `generate_report` 函数。
- en: This function will take in all the previous pieces we gathered from the user
    and then write them into our Word document.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这个函数将接收我们从用户那里收集的所有内容，然后将其写入我们的 Word 文档中。
- en: As seen in the code below, we first need to create our docx object, which is
    done by calling `docx.Document()`.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如下代码所示，我们首先需要创建我们的 docx 对象，通过调用 `docx.Document()` 来完成。
- en: We then start creating each section of the report using a combination of headings
    and paragraphs. Some of these utilise f-strings so that we can combine text with
    the input variables.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们开始使用标题和段落的组合来创建报告的每个部分。其中一些利用 f-strings，以便我们可以将文本与输入变量结合起来。
- en: Then we move on to adding in the scatterplot we created earlier, which is done
    using `doc.add_picture()`.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 接着，我们将添加之前创建的散点图，这可以通过 `doc.add_picture()` 完成。
- en: The final section contains our dataframe statistical summary, which calls upon
    the `add_df_to_docx` function.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一部分包含我们的 dataframe 统计摘要，它调用 `add_df_to_docx` 函数。
- en: Finally, we save the report to the `docx` file.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将报告保存到 `docx` 文件中。
- en: '[PRE14]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Once the writing function has been created, we can then fill out what happens
    when the user clicks on the Generate button.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦写入函数创建完毕，我们就可以填充用户点击生成按钮时的操作。
- en: First, we have to call upon the `summary_stats` and `scatter_plot_file` functions.
    The results of these will then be passed into the `generate_report` function.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要调用 `summary_stats` 和 `scatter_plot_file` 函数。这些函数的结果将被传递到 `generate_report`
    函数中。
- en: '[PRE15]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: When we view our app, we can fill the input boxes with the required information
    and hit Generate.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看我们的应用时，可以填写输入框中的所需信息并点击生成。
- en: '![](../Images/332befafe5fad8f0c915153a822a3038.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/332befafe5fad8f0c915153a822a3038.png)'
- en: Final view of the Streamlit Word report generator. Image by the author.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: Streamlit Word 报告生成器的最终视图。图像由作者提供。
- en: This will then create our Word document that we see below.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这将创建我们下面看到的 Word 文档。
- en: '![](../Images/d0d836752859af9b9aa7b9fc0cf7cce2.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d0d836752859af9b9aa7b9fc0cf7cce2.png)'
- en: Page one of the report generated from the Streamlit app. Image by the author.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Streamlit 应用生成的报告的第一页。图像由作者提供。
- en: '![](../Images/405094e2dd05b3b50b1c63c86aa62dd1.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/405094e2dd05b3b50b1c63c86aa62dd1.png)'
- en: Page two of the report generated from the Streamlit app. Image by the author.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Streamlit 应用生成的报告的第二页。图像由作者提供。
- en: Summary
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Creating reports is an essential part of any data science or petrophysics workflow.
    However, creating these reports can often be time-consuming and tedious.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 创建报告是任何数据科学或岩石物理工作流程中的关键部分。然而，创建这些报告往往是耗时且繁琐的。
- en: Using a combination of Streamlit for the UI, and docx for creating the Word
    document, we can help reduce some of the burdens of report creation and begin
    automating the process.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 结合使用 Streamlit 创建用户界面和 docx 创建 Word 文档，我们可以帮助减少报告生成的负担，并开始自动化这一过程。
- en: With the arrival of Large Language Models (LLMs), we could potentially integrate
    these with this app to further enhance its capabilities and take automation to
    the next level.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 随着大型语言模型（LLMs）的到来，我们可能将这些模型集成到此应用中，以进一步提升其功能，并将自动化提升到一个新的水平。
- en: References
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: Bormann, Peter, Aursand, Peder, Dilib, Fahad, Manral, Surrender, & Dischington,
    Peter. (2020). FORCE 2020 Well well log and lithofacies dataset for machine learning
    competition [Data set]. Zenodo. [https://doi.org/10.5281/zenodo.4351156](https://doi.org/10.5281/zenodo.4351156)
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: Bormann, Peter, Aursand, Peder, Dilib, Fahad, Manral, Surrender, & Dischington,
    Peter. (2020). FORCE 2020 Well well log and lithofacies dataset for machine learning
    competition [数据集]. Zenodo. [https://doi.org/10.5281/zenodo.4351156](https://doi.org/10.5281/zenodo.4351156)
- en: Full Code for the Streamlit Word Document Report Creator
  id: totrans-124
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Streamlit Word 文档报告生成器的完整代码
- en: 'Below is the full code to generate the Word Report Streamlit app:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是生成 Word 报告的 Streamlit 应用的完整代码：
- en: '[PRE16]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '*Thanks for reading. Before you go, you should definitely subscribe to my content
    and get my articles in your inbox.* [***You can do that here!***](https://andymcdonaldgeo.medium.com/subscribe)*Alternatively,
    you can* [***sign up for my newsletter***](https://fabulous-founder-2965.ck.page/2ca286e572)
    *to get additional content straight into your inbox for free.*'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '*感谢阅读。在你离开之前，你应该订阅我的内容，将我的文章直接送到你的邮箱。* [***你可以在这里操作！***](https://andymcdonaldgeo.medium.com/subscribe)*或者，你也可以*
    [***注册我的通讯***](https://fabulous-founder-2965.ck.page/2ca286e572) *以获取额外内容，直接免费送到你的邮箱。*'
- en: '*Secondly, you can get the full Medium experience and support thousands of
    other writers and me by signing up for a membership. It only costs you $5 a month,
    and you have full access to all of the fantastic Medium articles, as well as the
    chance to make money with your writing.*'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '*其次，通过注册会员，你可以获得完整的 Medium 体验，并支持我和其他成千上万的作家。每月仅需 $5，你可以完全访问所有精彩的 Medium 文章，还可以通过写作赚钱。*'
- en: '*If you sign up using* [***my link***](https://andymcdonaldgeo.medium.com/membership)***,***
    *you will support me directly with a portion of your fee, and it won’t cost you
    more. If you do so, thank you so much for your support.*'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果你通过* [***我的链接***](https://andymcdonaldgeo.medium.com/membership)***注册，***
    *你将直接用你的一部分费用支持我，并且不会额外增加你的费用。如果你这么做了，非常感谢你的支持。*'

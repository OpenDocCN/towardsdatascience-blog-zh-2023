- en: Two-way ANOVA in R
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: R中的双因素ANOVA
- en: 原文：[https://towardsdatascience.com/two-way-anova-in-r-c53d7353efe5](https://towardsdatascience.com/two-way-anova-in-r-c53d7353efe5)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/two-way-anova-in-r-c53d7353efe5](https://towardsdatascience.com/two-way-anova-in-r-c53d7353efe5)
- en: Learn how to do a two-way ANOVA in R. You will also learn its aim, hypotheses,
    assumptions, and how to interpret the results.
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 了解如何在R中进行双因素ANOVA。你还将学习其目的、假设、假设条件以及如何解释结果。
- en: '[](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)[![Antoine
    Soetewey](../Images/51d7837d18ff15a62cac2343a485e35d.png)](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)
    [Antoine Soetewey](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)[![安托万·苏特维](../Images/51d7837d18ff15a62cac2343a485e35d.png)](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)[![数据科学前沿](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)
    [安托万·苏特维](https://antoinesoetewey.medium.com/?source=post_page-----c53d7353efe5--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)
    ·23 min read·Jun 19, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发布于[数据科学前沿](https://towardsdatascience.com/?source=post_page-----c53d7353efe5--------------------------------)
    ·23分钟阅读·2023年6月19日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/5186e1c2999fc5da63a55327a6f00454.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5186e1c2999fc5da63a55327a6f00454.png)'
- en: Photo by [Nathan Dumlao](https://unsplash.com/@nate_dumlao?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来源：[内森·杜姆劳](https://unsplash.com/@nate_dumlao?utm_source=medium&utm_medium=referral)
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: The two-way ANOVA (analysis of variance) is a statistical method that allows
    to **evaluate the simultaneous effect of two** [**categorical**](https://statsandr.com/blog/variable-types-and-examples/#qualitative)
    **variables on a** [**quantitative continuous**](https://statsandr.com/blog/variable-types-and-examples/#continuous)
    **variable**.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 双因素ANOVA（方差分析）是一种统计方法，**允许评估两个** [**分类**](https://statsandr.com/blog/variable-types-and-examples/#qualitative)
    **变量对** [**定量连续**](https://statsandr.com/blog/variable-types-and-examples/#continuous)
    **变量的同时影响**。
- en: The two-way ANOVA is an extension of the one-way ANOVA since it allows to evaluate
    the effects on a numerical response of **two** categorical variables instead of
    one. The advantage of a two-way ANOVA over a one-way ANOVA is that we test the
    relationship between two variables, while taking into account the effect of a
    third variable. Moreover, it also allows to include the possible *interaction*
    of the two categorical variables on the response.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 双因素ANOVA是单因素ANOVA的扩展，因为它允许评估**两个**分类变量对数值响应的影响。双因素ANOVA相对于单因素ANOVA的优势在于我们可以测试两个变量之间的关系，同时考虑第三个变量的影响。此外，它还允许包括两个分类变量对响应的可能*交互作用*。
- en: 'The advantage of a two-way over a one-way ANOVA is quite similar to the advantage
    of a [multiple linear regression](https://statsandr.com/blog/multiple-linear-regression-made-simple/)
    over a [correlation](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/):'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 双因素ANOVA相对于单因素ANOVA的优势与[多元线性回归](https://statsandr.com/blog/multiple-linear-regression-made-simple/)相对于[相关性](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/)的优势类似：
- en: The correlation measures the relationship between two quantitative variables.
    The multiple linear regression also measures the relationship between two variables,
    but this time taking into account the potential effect of other covariates.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关性测量两个定量变量之间的关系。多元线性回归也测量两个变量之间的关系，但这次考虑了其他协变量的潜在影响。
- en: The one-way ANOVA tests whether a quantitative variable is different between
    groups. The two-way ANOVA also tests whether a quantitative variable is different
    between groups, but this time taking into account the effect of another qualitative
    variable.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单因素ANOVA测试定量变量在各组之间是否存在差异。双因素ANOVA也测试定量变量在各组之间是否存在差异，但这次考虑了另一个定性变量的影响。
- en: Previously, we have discussed about [one-way ANOVA in R](https://statsandr.com/blog/anova-in-r/).
    Now, we show when, why, and how to perform a **two-way** ANOVA in R.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 之前，我们讨论了 [单因素方差分析在 R 中的应用](https://statsandr.com/blog/anova-in-r/)。现在，我们展示了在
    R 中执行**两因素**方差分析的时机、原因和方法。
- en: 'Before going further, I would like to mention and briefly describe some related
    statistical methods and tests in order to avoid any confusion:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，我想提及并简要描述一些相关的统计方法和测试，以避免任何混淆：
- en: 'A [Student’s t-test](https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/)
    is used to evaluate the effect of one categorical variable on a quantitative continuous
    variable, **when the categorical variable has exactly 2 levels**:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[学生 t 检验](https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/)用于评估一个分类变量对定量连续变量的影响，**当分类变量恰好有
    2 个水平**时：'
- en: 'Student’s t-test *for independent samples* if the observations are **independent**
    (for example: if we compare the age between women and men)'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果观察值是**独立**的（例如：比较女性和男性的年龄），则使用学生 t 检验 *针对独立样本*。
- en: Student’s t-test *for paired samples* if the observations are **dependent**,
    that is, when they come in pairs (it is the case when the same subjects are measured
    twice, at two different points in time, before and after a treatment for example)
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果观察值是**依赖**的，即成对出现（例如，当相同的受试者在两个不同时间点进行两次测量时，前后测量），则使用学生 t 检验 *针对配对样本*。
- en: To evaluate the effect of one categorical variable on a quantitative variable,
    **when the categorical variable has 3 or more levels**:[1](https://statsandr.com/blog/two-way-anova-in-r/#fn1)
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估一个分类变量对定量变量的影响，**当分类变量有 3 个或更多水平**时：[1](https://statsandr.com/blog/two-way-anova-in-r/#fn1)
- en: '[*one-way ANOVA*](https://statsandr.com/blog/anova-in-r/) (often simply referred
    as ANOVA) if the groups are **independent** (for example a group of patients who
    received treatment A, another group of patients who received treatment B, and
    the last group of patients who received no treatment or a placebo)'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*单因素方差分析*](https://statsandr.com/blog/anova-in-r/)（通常简称为 ANOVA）如果组是**独立**的（例如，一个接受治疗
    A 的患者组，一个接受治疗 B 的患者组，以及一个没有接受治疗或接受安慰剂的患者组）。'
- en: '*repeated measures ANOVA* if the groups are **dependent** (when the same subjects
    are measured three times, at three different points in time, before, during and
    after a treatment for example)'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*重复测量方差分析* 如果组是**依赖**的（例如，当相同的受试者在三个不同时间点进行三次测量时，治疗前、治疗中和治疗后）。'
- en: A two-way ANOVA is used to evaluate the effects of 2 categorical variables (and
    their potential interaction) on a quantitative continuous variable. This is the
    topic of the post.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 两因素方差分析用于评估 2 个分类变量（及其潜在交互作用）对定量连续变量的影响。这是本文的主题。
- en: '[Linear regression](https://statsandr.com/blog/multiple-linear-regression-made-simple/)
    is used to evaluate the relationship between a quantitative continuous dependent
    variable and one or several independent variables:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '[线性回归](https://statsandr.com/blog/multiple-linear-regression-made-simple/)用于评估定量连续因变量与一个或多个自变量之间的关系：'
- en: simple linear regression if there is only one independent variable (which can
    be quantitative or qualitative)
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果只有一个自变量（可以是定量或定性），则为简单线性回归。
- en: multiple linear regression if there is at least two independent variables (which
    can be quantitative, qualitative, or a mix of both)
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果至少有两个自变量（可以是定量、定性或两者的混合），则为多元线性回归。
- en: An ANCOVA (analysis of covariance) is used to evaluate the effect of a categorical
    variable on a quantitative variable, while controlling for the effect of another
    quantitative variable (known as covariate). ANCOVA is actually a special case
    of multiple linear regression with a mix of one qualitative and one quantitative
    independent variable.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ANCOVA（协方差分析）用于评估分类变量对定量变量的影响，同时控制另一个定量变量（称为协变量）的影响。ANCOVA 实际上是多元线性回归的一种特殊情况，其中包含一个定性和一个定量自变量。
- en: In this post, we start by explaining when and why a two-way ANOVA is useful,
    we then do some preliminary descriptive analyses and present how to conduct a
    two-way ANOVA in R. Finally, we show how to interpret and visualize the results.
    We also briefly mention and illustrate how to verify the underlying assumptions.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们首先解释了何时以及为何两因素方差分析是有用的，然后进行一些初步的描述性分析，并展示如何在 R 中进行两因素方差分析。最后，我们展示了如何解释和可视化结果。我们还简要提及并说明如何验证基本假设。
- en: Data
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据
- en: To illustrate how to perform a two-way ANOVA in R, we use the `penguins` dataset,
    available from the `{palmerpenguins}` package.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明如何在 R 中进行双因素 ANOVA，我们使用 `{palmerpenguins}` 包提供的 `penguins` 数据集。
- en: 'We do not need to [import the dataset](https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/),
    but we need to [load the package](https://statsandr.com/blog/an-efficient-way-to-install-and-load-r-packages/)
    first and then call the dataset:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不需要 [导入数据集](https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/)，但我们需要先
    [加载包](https://statsandr.com/blog/an-efficient-way-to-install-and-load-r-packages/)，然后调用数据集：
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The dataset contains 8 variables for 344 penguins, summarized below:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集包含 344 只企鹅的 8 个变量，汇总如下：
- en: '[PRE3]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In this post, we will focus on the following three variables:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们将重点关注以下三个变量：
- en: '`species`: the species of the penguin (Adelie, Chinstrap or Gentoo)'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`species`: 企鹅的物种（Adelie，Chinstrap 或 Gentoo）'
- en: '`sex`: sex of the penguin (female and male)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sex`: 企鹅的性别（雌性和雄性）'
- en: '`body_mass_g`: body mass of the penguin (in grams)'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`body_mass_g`: 企鹅的体重（以克为单位）'
- en: If needed, more information about this dataset can be found by running `?penguins`
    in R.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，可以通过在 R 中运行 `?penguins` 来获取关于此数据集的更多信息。
- en: '`body_mass_g` is the quantitative continuous variable and will be the dependent
    variable, whereas `species` and `sex` are both qualitative variables.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '`body_mass_g` 是定量连续变量，将作为因变量，而 `species` 和 `sex` 都是定性变量。'
- en: Those two last variables will be our independent variables, also referred as
    factors. Make sure that they are read as [factors](https://statsandr.com/blog/data-types-in-r/#factor)
    by R. If it is not the case, they will need to be [transformed to factors](https://statsandr.com/blog/data-manipulation-in-r/#factors).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个最后的变量将是我们的独立变量，也称为因素。确保它们被 R 读作 [factors](https://statsandr.com/blog/data-types-in-r/#factor)。如果不是这种情况，它们需要被
    [转换为因素](https://statsandr.com/blog/data-manipulation-in-r/#factors)。
- en: Aim and hypotheses of a two-way ANOVA
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双因素 ANOVA 的目标和假设
- en: As mentioned above, a two-way ANOVA is used to **evaluate simultaneously the
    effect of two categorical variables on one quantitative continuous variable**.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述，双因素 ANOVA 用于**同时评估两个分类变量对一个定量连续变量的影响**。
- en: It is referred as **two**-way ANOVA because we are comparing groups which are
    formed by **two** independent categorical variables.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 它被称为**双**因素 ANOVA，因为我们比较的组是由**两个**独立的分类变量形成的。
- en: 'Here, we would like to know if body mass depends on species and/or sex. In
    particular, we are interested in:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们想知道体重是否依赖于物种和/或性别。特别是，我们感兴趣的是：
- en: measuring and testing the relationship between species and body mass,
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 测量和测试物种与体重之间的关系，
- en: measuring and testing the relationship between sex and body mass, and
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 测量和测试性别与体重之间的关系，并且
- en: potentially check whether the relationship between species and body mass is
    different for females and males (which is equivalent than checking whether the
    relationship between sex and body mass depends on the species)
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 潜在地检查物种与体重之间的关系是否对雌性和雄性不同（这等同于检查性别与体重之间的关系是否依赖于物种）
- en: The first two relationships are referred as **main effects**, while the third
    point is known as the **interaction effect**.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 前两个关系被称为**主要效果**，而第三点被称为**交互效应**。
- en: The main effects test whether at least one group is different from another one
    (while controlling for the other independent variable). On the other hand, the
    interaction effect aims at testing whether the relationship between two variables
    differs *depending on the level of a third variable*.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 主要效果测试是否至少有一个组与另一个组不同（同时控制其他独立变量）。另一方面，交互效应旨在测试两个变量之间的关系是否*依赖于第三个变量的水平*。
- en: When performing a two-way ANOVA, testing the interaction effect is not mandatory.
    However, omitting an interaction effect may lead to erroneous conclusions if the
    interaction effect is present.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行双因素 ANOVA 时，测试交互效应不是强制性的。然而，忽略交互效应可能会导致错误的结论，如果交互效应存在的话。
- en: 'If we go back to our example, we have the following [hypothesis tests](https://statsandr.com/blog/hypothesis-test-by-hand/):'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们回到我们的例子，我们有以下 [假设检验](https://statsandr.com/blog/hypothesis-test-by-hand/)：
- en: 'Main effect of sex on body mass:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 性别对体重的主要影响：
- en: 'H0: mean body mass is equal between females and males'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'H0: 女性和男性的平均体重相等'
- en: 'H1: mean body mass is different between females and males'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'H1: 女性和男性的平均体重不同'
- en: 'Main effect of species on body mass:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 物种对体重的主要影响：
- en: 'H0: mean body mass is equal between all 3 species'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'H0: 所有 3 个物种的平均体重相等'
- en: 'H1: mean body mass is different for at least one species'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: H1：至少有一个物种的体重平均值不同。
- en: 'Interaction between sex and species:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 性别和物种之间的交互作用：
- en: 'H0: there is no interaction between sex and species, meaning that the relationship
    between species and body mass is the same for females and males (similarly, the
    relationship between sex and body mass is the same for all 3 species)'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: H0：性别和物种之间没有交互作用，意味着物种和体重之间的关系对雌性和雄性相同（同样，性别和体重之间的关系对所有3种物种相同）。
- en: 'H1: there is an interaction between sex and species, meaning that the relationship
    between species and body mass is different for females than for males (similarly,
    the relationship between sex and body mass depends on the species)'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: H1：性别和物种之间存在交互作用，意味着物种和体重之间的关系对雌性和雄性不同（同样，性别和体重之间的关系依赖于物种）。
- en: Assumptions of a two-way ANOVA
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 两因素方差分析的假设
- en: Most statistical tests require some assumptions for the results to be valid,
    and a two-way ANOVA is not an exception.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数统计检验需要一些假设以确保结果有效，而两因素方差分析也不例外。
- en: 'Assumptions of a two-way ANOVA are similar than for a one-way ANOVA. To summarize:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 两因素方差分析的假设与单因素方差分析类似。总结如下：
- en: '**Variable type**: the dependent variable must be quantitative continuous,
    while the two independent variables must be categorical (with at least two levels).'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**变量类型**：依赖变量必须是定量连续的，而两个自变量必须是分类的（至少有两个水平）。'
- en: '**Independence**: the observations should be independent between groups and
    within each group.'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**独立性**：观察值在组间和组内应相互独立。'
- en: '**Normality**:'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**正态性**：'
- en: For small samples, data should follow approximately a [normal distribution](https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/)
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于小样本，数据应大致遵循[正态分布](https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/)
- en: For large samples (usually n ≥ 30 in each group/sample), normality is not required
    (thanks to the central limit theorem)
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于大样本（通常每组/样本n ≥ 30），不要求正态性（感谢中心极限定理）。
- en: '**Equality of variances**: variances should be equal across groups.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**方差齐性**：各组之间的方差应相等。'
- en: '**Outliers**: There should be no significant [outliers](https://statsandr.com/blog/outliers-detection-in-r/)
    in any group.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**异常值**：任何组中都不应有显著的[异常值](https://statsandr.com/blog/outliers-detection-in-r/)。'
- en: More details about these assumptions can be found in the [assumptions of a one-way
    ANOVA](https://statsandr.com/blog/anova-in-r/#underlying-assumptions-of-anova).
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 关于这些假设的更多细节可以在[单因素方差分析的假设](https://statsandr.com/blog/anova-in-r/#underlying-assumptions-of-anova)中找到。
- en: Now that we have seen the underlying assumptions of the two-way ANOVA, we review
    them specifically for our dataset before applying the test and interpreting the
    results.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看到了两因素方差分析的基本假设，在应用测试和解释结果之前，我们会专门审查这些假设在我们的数据集中的适用性。
- en: Variable type
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 变量类型
- en: The dependent variable body mass is [quantitative continuous](https://statsandr.com/blog/variable-types-and-examples/#continuous),
    while both independent variables sex and species are [qualitative variables](https://statsandr.com/blog/variable-types-and-examples/#qualitative)
    (with at least 2 levels).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 依赖变量体重是[定量连续的](https://statsandr.com/blog/variable-types-and-examples/#continuous)，而两个自变量性别和物种是[定性变量](https://statsandr.com/blog/variable-types-and-examples/#qualitative)（至少有2个水平）。
- en: Therefore, this assumption is met.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这个假设得到满足。
- en: Independence
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 独立性
- en: Independence is usually checked based on the design of the experiment and how
    data have been collected.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 独立性通常根据实验设计和数据收集方式来检查。
- en: 'To keep it simple, observations are usually:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简单起见，观察通常是：
- en: '**independent** if each experimental unit (here a penguin) has been measured
    only once and the observations are collected from a representative and randomly
    selected portion of the population, or'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**独立的**，如果每个实验单元（此处为企鹅）仅测量一次，且观察值来自于一个具有代表性和随机选择的样本部分，或者'
- en: '**dependent** if each experimental unit has been measured at least twice (as
    it is often the case in the medical field for example, with two measurements on
    the same subjects; one before and one after the treatment).'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**依赖的**，如果每个实验单元至少被测量两次（例如，在医学领域，通常在同一受试者上进行两次测量；一次是在治疗前，一次是在治疗后）。'
- en: In our case, body mass has been measured only once on each penguin, and on a
    representative and random sample of the population, so the independence assumption
    is met.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的案例中，体重只在每只企鹅上测量一次，并且在一个具有代表性和随机的样本中测量，因此独立性假设得到满足。
- en: Normality
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正态性
- en: 'We have a large sample in all subgroups (each combination of the levels of
    the two factors, called cell):'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在所有子组中都有一个大样本（两个因素水平的每种组合，称为单元）：
- en: '[PRE5]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: so normality does not need to be checked.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 所以正态性无需检查。
- en: For completeness, we still show how to verify normality, as if we had a small
    samples.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完整起见，我们仍然展示如何验证正态性，假如我们有一个小样本。
- en: 'There are several methods to test the normality assumption. The most common
    methods being:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种方法可以测试正态性假设。最常见的方法包括：
- en: a [QQ-plot](https://statsandr.com/blog/descriptive-statistics-in-r/#qq-plot)
    by group or on the residuals, and/or
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个[QQ图](https://statsandr.com/blog/descriptive-statistics-in-r/#qq-plot)按组或对残差进行，以及/或
- en: a [histogram](https://statsandr.com/blog/descriptive-statistics-in-r/#histogram)
    by group or on the residuals, and/or
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个[直方图](https://statsandr.com/blog/descriptive-statistics-in-r/#histogram)按组或对残差进行，以及/或
- en: a [normality test](https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#normality-test)
    (Shapiro-Wilk test for instance) by group or on the residuals.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个[正态性检验](https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#normality-test)（例如Shapiro-Wilk检验）按组或对残差进行。
- en: 'The easiest/shortest way is to verify the normality with a QQ-plot on the residuals.
    To draw this plot, we first need to save the model:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单/最短的方式是通过残差的QQ图来验证正态性。要绘制此图，我们首先需要保存模型：
- en: '[PRE7]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This piece of code will be explained further.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码会进一步解释。
- en: 'Now we can draw the QQ-plot on the residuals. We show two ways to do so, first
    with the `plot()` function and second with the `qqPlot()` function from the `{car}`
    package:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以绘制残差的QQ图。我们展示两种方法，首先是使用`plot()`函数，其次是使用来自`{car}`包的`qqPlot()`函数：
- en: '[PRE8]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/b4b619c159fecb34124a97fc3a67bc63.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b4b619c159fecb34124a97fc3a67bc63.png)'
- en: Plot by author
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 按作者绘图
- en: '[PRE9]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/712c0808ee4a81a830869e4dc744d616.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/712c0808ee4a81a830869e4dc744d616.png)'
- en: Plot by author
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 按作者绘图
- en: Code for method 1 is slightly shorter, but it misses the confidence interval
    around the reference line.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 方法1的代码稍短，但缺少参考线周围的置信区间。
- en: If points follow the straight line (called Henry’s line) and fall within the
    confidence band, we can assume normality. This is the case here.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 如果点沿直线（称为亨利线）分布并且落在置信带内，我们可以假设正态性。在这里是这种情况。
- en: 'If you prefer to verify the normality based on a histogram of the residuals,
    here is the code:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你更倾向于通过残差的直方图来验证正态性，这里是代码：
- en: '[PRE11]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](../Images/864cf95ccceef226c5b3f57912831254.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/864cf95ccceef226c5b3f57912831254.png)'
- en: Plot by author
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 按作者绘图
- en: The histogram of the residuals show a gaussian distribution, which is in line
    with the conclusion from the QQ-plot.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 残差的直方图显示了高斯分布，这与QQ图的结论一致。
- en: 'Although the QQ-plot and histogram is largely enough to verify the normality,
    if you want to test it more formally with a statistical test, the Shapiro-Wilk
    test can be applied on the residuals as well:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然QQ图和直方图在验证正态性方面已基本足够，但如果你希望通过统计检验更正式地测试正态性，可以对残差应用Shapiro-Wilk检验：
- en: '[PRE12]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: ⇒ We do not reject the null hypothesis that the residuals follow a normal distribution
    (p-value = 0.937).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: ⇒ 我们不拒绝残差服从正态分布的原假设（p值 = 0.937）。
- en: From the QQ-plot, histogram and Shapiro-Wilk test, we conclude that we do not
    reject the null hypothesis of normality of the residuals.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 从QQ图、直方图和Shapiro-Wilk检验中，我们得出结论，不拒绝残差正态性的原假设。
- en: The normality assumption is thus verified, we can now check the equality of
    the variances.[2](https://statsandr.com/blog/two-way-anova-in-r/#fn2)
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 正态性假设因此得到验证，我们现在可以检查方差的相等性。[2](https://statsandr.com/blog/two-way-anova-in-r/#fn2)
- en: Homogeneity of variances
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方差的同质性
- en: 'Equality of variances, also referred as homogeneity of variances or homoscedasticity,
    can be verified visually with the `plot()` function:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 方差的同质性，也称为方差的均匀性或齐性，可以通过`plot()`函数直观地验证：
- en: '[PRE14]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![](../Images/507ae2c823fcdc60986559c5a115501a.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/507ae2c823fcdc60986559c5a115501a.png)'
- en: Plot by author
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 按作者绘图
- en: Since the spread of the residuals is constant, the red smooth line is horizontal
    and flat, so it looks like the constant variance assumption is satisfied here.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 由于残差的分布是恒定的，红色平滑线是水平和扁平的，因此看起来这里的恒定方差假设得到满足。
- en: The diagnostic plot above is sufficient, but if you prefer it can also be tested
    more formally with the Levene’s test (also from the `{car}` package):[3](https://statsandr.com/blog/two-way-anova-in-r/#fn3)
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 上述诊断图足够，但如果你愿意，也可以使用Levene检验（也来自`{car}`包）进行更正式的测试：[3](https://statsandr.com/blog/two-way-anova-in-r/#fn3)
- en: '[PRE15]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: ⇒ We do not reject the null hypothesis that the variances are equal (p-value
    = 0.227).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: ⇒ 我们未拒绝方差相等的原假设（p值 = 0.227）。
- en: Both the visual and formal approaches give the same conclusion; we do not reject
    the hypothesis of homogeneity of the variances.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 视觉和正式方法得出了相同的结论；我们未拒绝方差齐性的假设。
- en: Outliers
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常值
- en: The easiest and most common way to [detect outliers](https://statsandr.com/blog/descriptive-statistics-in-r/)
    is visually thanks to boxplots by groups.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 检测异常值最简单和最常见的方法是通过组的箱线图进行视觉检查。
- en: 'For females and males:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 对于雌性和雄性：
- en: '[PRE17]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![](../Images/c50041e09cc44b1d4b3e5bc9a4b9a339.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c50041e09cc44b1d4b3e5bc9a4b9a339.png)'
- en: Plot by author
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'For the three species:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 对于三种物种：
- en: '[PRE19]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![](../Images/2f8c7ecce381ed282db2032833f1d9ea.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2f8c7ecce381ed282db2032833f1d9ea.png)'
- en: Plot by author
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: There are, as defined by the [interquartile range criterion](https://statsandr.com/blog/descriptive-statistics-in-r/#interquartile-range),
    two outliers for the species Chinstrap. These points are, nonetheless, not extreme
    enough to bias results.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 根据[四分位距标准](https://statsandr.com/blog/descriptive-statistics-in-r/#interquartile-range)，物种
    Chinstrap 有两个异常值。这些点的极端程度不足以偏倚结果。
- en: Therefore, we consider that the assumption of no significant outliers is met.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们认为满足无显著异常值的假设。
- en: Two-way ANOVA
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双因素ANOVA
- en: We have shown that all assumptions are met, so we can now proceed to the implementation
    of the two-way ANOVA in R.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经展示了所有假设都得到满足，所以现在可以继续在R中实施双因素ANOVA。
- en: 'This will allow us to answer the following research questions:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 这将帮助我们回答以下研究问题：
- en: Controlling for the species, is body mass significantly different between the
    two sexes?
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制物种后，两个性别之间的体重是否存在显著差异？
- en: Controlling for the sex, is body mass significantly different for at least one
    species?
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制性别后，体重在至少一种物种中是否存在显著差异？
- en: Is the relationship between species and body mass different between female and
    male penguins?
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 物种与体重之间的关系在雌性和雄性企鹅中是否不同？
- en: Preliminary analyses
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 初步分析
- en: Before performing any statistical test, it is a good practice to make some [descriptive
    statistics](https://statsandr.com/blog/descriptive-statistics-in-r/) in order
    to have a first overview of the data, and perhaps, have a glimpse of the results
    to be expected.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行任何统计测试之前，进行一些[描述性统计](https://statsandr.com/blog/descriptive-statistics-in-r/)是一个好的做法，以便对数据有一个初步的了解，并且可能对预期结果有所了解。
- en: This can be done via descriptive statistics or plots.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过描述性统计或图形完成。
- en: Descriptive statistics
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 描述性统计
- en: 'If we want to keep it simple, we can compute only the mean for each subgroup:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想保持简单，我们可以只计算每个子组的均值：
- en: '[PRE20]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Or eventually, the mean and [standard deviation](https://statsandr.com/blog/descriptive-statistics-by-hand/#standard-deviation)
    for each subgroup using the `{dplyr}` package:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 或者最终，使用`{dplyr}`包计算每个子组的均值和[标准差](https://statsandr.com/blog/descriptive-statistics-by-hand/#standard-deviation)：
- en: '[PRE22]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Plots
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 图形
- en: If you are a frequent reader of the blog, you know that I like to draw plots
    to visualize the data at hand before interpreting results of a test.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是博客的常读者，你知道我喜欢绘制图形来可视化数据，然后再解释测试结果。
- en: 'The most appropriate plot when we have one quantitative and two qualitative
    variables is a [boxplot](https://statsandr.com/blog/descriptive-statistics-in-r/#boxplot)
    by group. This can easily be made with the `[{ggplot2}](https://statsandr.com/blog/graphics-in-r-with-ggplot2/)`
    [package](https://statsandr.com/blog/graphics-in-r-with-ggplot2/):'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们有一个定量变量和两个定性变量时，最合适的图形是按组绘制的[箱线图](https://statsandr.com/blog/descriptive-statistics-in-r/#boxplot)。这可以很容易地使用`[{ggplot2}](https://statsandr.com/blog/graphics-in-r-with-ggplot2/)`
    [包](https://statsandr.com/blog/graphics-in-r-with-ggplot2/)制作：
- en: '[PRE25]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![](../Images/9f1d0107fe31a38ded9639af9e8d31c4.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9f1d0107fe31a38ded9639af9e8d31c4.png)'
- en: Plot by author
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Some observations are missing for the sex, we can remove them to have a more
    concise plot:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 性别的一些观察值缺失，我们可以将它们删除以获得更简洁的图形：
- en: '[PRE27]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![](../Images/b0817a0baf070892d0d1203012d168fe.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b0817a0baf070892d0d1203012d168fe.png)'
- en: Plot by author
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Note that we could also have made the following plot:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们也可以绘制以下图形：
- en: '[PRE28]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![](../Images/c52590eb50a39ffde9eab4bd2c6d85ee.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c52590eb50a39ffde9eab4bd2c6d85ee.png)'
- en: Plot by author
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘图
- en: But for a more readable plot, I tend to prefer putting the variable with the
    smallest number of levels as color (which is in fact the argument `fill` in the
    `aes()` layer) and the variable with the largest number of categories on the x-axis
    (i.e., the argument `x` in the `aes()` layer).
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 但为了获得更易读的图形，我倾向于将变量中层级最少的设置为颜色（实际上是`aes()`层中的`fill`参数），将类别最多的变量设置在x轴上（即`aes()`层中的`x`参数）。
- en: 'From the means and the boxplots by subgroup, we can already see that, *in our
    sample*:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 从均值和子组的箱线图中，我们已经可以看到，*在我们的样本中*：
- en: female penguins tend to have a lower body mass than males, and that is the case
    for all the considered species, and
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 雌性企鹅的体重往往低于雄性，并且所有考虑的物种中都是如此，并且
- en: body mass is higher for Gentoo penguins than for the other two species.
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相比其他两种物种，振翅企鹅的体重更高。
- en: Bear in mind that these conclusions are only valid within our [sample](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)!
    To generalize these conclusions to the [population](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/),
    we need to perform the two-way ANOVA and check the significance of the explanatory
    variables. This is the aim of the next section.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，这些结论仅在我们的[样本](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)内有效！要将这些结论推广到[总体](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)，我们需要进行双因素方差分析并检查解释变量的显著性。这是下一节的目标。
- en: Two-way ANOVA in R
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: R中的双因素方差分析
- en: As mentioned earlier, including an interaction effect in a two-way ANOVA is
    not compulsory. However, in order to avoid flawed conclusions, it is recommended
    to first check whether the interaction is significant or not, and depending on
    the results, include it or not.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，在双因素方差分析中包含交互作用效应并非强制性的。然而，为了避免错误结论，建议首先检查交互作用是否显著，并根据结果决定是否包括它。
- en: If the interaction is not significant, it is safe to remove it from the final
    model. On the contrary, if the interaction is significant, it should be included
    in the final model which will be used to interpret results.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如果交互作用不显著，可以安全地将其从最终模型中移除。相反，如果交互作用显著，应将其包含在最终模型中以解释结果。
- en: 'We thus start with a model which includes the two main effects (i.e., sex and
    species) and the interaction:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们首先建立一个包括两个主要效应（即性别和物种）及交互作用的模型：
- en: '[PRE29]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '[PRE30]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[PRE31]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The sum of squares (column `Sum Sq`) shows that the species explain a large
    part of the variability of body mass. It is the most important factor in explaining
    this variability.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 平方和（`Sum Sq`列）显示物种解释了体重变化的大部分。这是解释这种变化的最重要因素。
- en: 'The p-values are displayed in the last column of the output above (`Pr(>F)`).
    From these p-values, we conclude that, at the 5% significance level:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: p值显示在上述输出的最后一列（`Pr(>F)`）。从这些p值中，我们得出结论，在5%的显著性水平下：
- en: controlling for the species, body mass is significantly different between the
    two sexes,
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在控制了物种的情况下，两个性别之间的体重显著不同，
- en: controlling for the sex, body mass is significantly different for at least one
    species, and
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制性别的情况下，至少有一种物种的体重显著不同，并且
- en: the interaction between sex and species (displayed at the line `sex:species`
    in the output above) is significant.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 性别和物种之间的交互作用（在上述输出中的`sex:species`行显示）是显著的。
- en: So from the significant interaction effect, we have just seen that the relationship
    between body mass and species is different between males and females. Since it
    is significant, we have to keep it in the model and we should interpret results
    from that model.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，从显著的交互作用效应中，我们刚刚看到体重与物种之间的关系在雄性和雌性之间是不同的。由于它是显著的，我们必须将其保留在模型中，并应解释该模型的结果。
- en: 'If, on the contrary, the interaction was not significant (that is, if the p-value
    ≥ 0.05) we would have removed this interaction effect from the model. For illustrative
    purposes, below the code for a two-way ANOVA without interaction, referred as
    an additive model:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 如果相反，交互作用不显著（即p值≥0.05），我们将从模型中移除这个交互作用效应。为了说明，下面是一个没有交互作用的双因素方差分析代码，称为加性模型：
- en: '[PRE32]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'For the readers who are used to perform [linear regressions in R](https://statsandr.com/blog/multiple-linear-regression-made-simple/),
    you will notice that the structure of the code for a two-way ANOVA is in fact
    similar:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 对于习惯于在[R中进行线性回归](https://statsandr.com/blog/multiple-linear-regression-made-simple/)的读者，你会注意到双因素方差分析的代码结构实际上是相似的：
- en: the formula is `dependent variable ~ independent variables`
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公式是 `dependent variable ~ independent variables`
- en: the `+` sign is used to include independent variables *without* an interaction[4](https://statsandr.com/blog/two-way-anova-in-r/#fn4)
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`+` 符号用于包含没有交互作用的独立变量[4](https://statsandr.com/blog/two-way-anova-in-r/#fn4)'
- en: the `*` sign is used to include independent variables *with* an interaction
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*` 符号用于包含具有交互作用的独立变量*与*。'
- en: The resemblance with a linear regression is not a surprise because a two-way
    ANOVA, like all ANOVA, is actually a linear model.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 与线性回归的相似性并不令人惊讶，因为双因素方差分析，就像所有方差分析一样，实际上是一个线性模型。
- en: 'Note that the following code works as well, and give the same results:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 注意以下代码也有效，并且给出相同的结果：
- en: '[PRE33]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '[PRE34]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '[PRE35]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Note that the `aov()` function assumes a **balanced design**, meaning that we
    have equal sample sizes within levels of our independent grouping variables. Moreover,
    `aov()` uses the type I sums of squares, so we can obtain different p-values when
    we write `y ~ A * B` and `y ~ B * A`.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 注意 `aov()` 函数假设**平衡设计**，即在我们的独立分组变量的水平内样本大小相等。此外，`aov()` 使用类型 I 方差和平方和，因此当我们写
    `y ~ A * B` 和 `y ~ B * A` 时可能会得到不同的 p 值。
- en: 'For **unbalanced design**, that is, unequal numbers of subjects in each subgroup,
    the recommended methods are:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 对于**不平衡设计**，即每个子组中的受试者数量不相等，推荐的方法是：
- en: the type II ANOVA when there is **no** significant interaction, which can be
    done in R with `Anova(mod, type = "II")`,[5](https://statsandr.com/blog/two-way-anova-in-r/#fn5)
    and
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当**没有**显著交互作用时使用类型 II 方差分析，这可以在 R 中使用 `Anova(mod, type = "II")` 来完成，[5](https://statsandr.com/blog/two-way-anova-in-r/#fn5)，并且
- en: the type III ANOVA when there is a significant interaction, which can be done
    in R with `Anova(mod, type = "III")`.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当存在显著交互作用时使用类型 III 方差分析，这可以在 R 中使用 `Anova(mod, type = "III")` 来完成。
- en: This is beyond the scope of the post and we assume a balanced design here. For
    the interested reader, see this [detailed discussion](https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/)
    about type I, type II and type III ANOVA.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 这超出了帖子范围，我们假设这里是平衡设计。对感兴趣的读者，参见 [详细讨论](https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/)
    关于类型 I、类型 II 和类型 III 方差分析。
- en: Pairwise comparisons
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 两两比较
- en: 'Through the two main effects being significant, we concluded that:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 通过两个主要效应显著，我们得出结论：
- en: controlling for the species, body mass is different between females and males,
    and
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制物种时，体重在女性和男性之间有所不同，并且
- en: controlling for the sex, body mass is different for at least one species.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制性别时，体重在至少一个物种中有所不同。
- en: If body mass is different between the two sexes, given that there are exactly
    two sexes, it must be because body mass is significantly different between females
    and males.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 如果体重在两个性别之间不同，鉴于性别正好有两个，这必然是因为体重在女性和男性之间显著不同。
- en: If one wants to know which sex has the highest body mass, it can be deduced
    from the means and/or boxplots by subgroup. Here, it is clear that males have
    a significantly higher body mass than females.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 如果想知道哪个性别的体重最高，可以通过均值和/或子组箱线图来推测。这里，显然男性的体重显著高于女性。
- en: However, it is not so straightforward for the species. Let me explain why it
    is not as easy as for the sexes.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，对于物种来说，情况并非如此简单。让我解释为什么这不像性别那样容易。
- en: 'There are three species (Adelie, Chinstrap and Gentoo), so there are 3 pairs
    of species:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 有三种物种（阿德利企鹅、刺胸企鹅和绵毛企鹅），因此有 3 对物种：
- en: Adelie and Chinstrap
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 阿德利企鹅和刺胸企鹅
- en: Adelie and Gentoo
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 阿德利企鹅和绵毛企鹅
- en: Chinstrap and Gentoo
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 刺胸企鹅和绵毛企鹅
- en: 'If body mass is significantly different for at least one species, it could
    be that:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 如果体重在至少一个物种中显著不同，可能是因为：
- en: body mass is significantly different between Adelie and Chinstrap but not significantly
    different between Adelie and Gentoo, and not significantly different between Chinstrap
    and Gentoo, or
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在阿德利企鹅和刺胸企鹅之间显著不同，但在阿德利企鹅和绵毛企鹅之间没有显著不同，也在刺胸企鹅和绵毛企鹅之间没有显著不同，或者
- en: body mass is significantly different between Adelie and Gentoo but not significantly
    different between Adelie and Chinstrap, and not significantly different between
    Chinstrap and Gentoo, or
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在阿德利企鹅和绵毛企鹅之间显著不同，但在阿德利企鹅和刺胸企鹅之间没有显著不同，也在刺胸企鹅和绵毛企鹅之间没有显著不同，或者
- en: body mass is significantly different between Chinstrap and Gentoo but not significantly
    different between Adelie and Chinstrap, and not significantly different between
    Adelie and Gentoo.
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在刺胸企鹅和绵毛企鹅之间显著不同，但在阿德利企鹅和刺胸企鹅之间没有显著不同，也在阿德利企鹅和绵毛企鹅之间没有显著不同。
- en: 'Or, it could also be that:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，也可能是：
- en: body mass is significantly different between Adelie and Chinstrap, and between
    Adelie and Gentoo, but not significantly different between Chinstrap and Gentoo,
    or
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在Adelie和Chinstrap之间、Adelie和Gentoo之间显著不同，但在Chinstrap和Gentoo之间没有显著差异，或者
- en: body mass is significantly different between Adelie and Chinstrap, and between
    Chinstrap and Gentoo, but not significantly different between Adelie and Gentoo,
    or
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在Adelie和Chinstrap之间、Chinstrap和Gentoo之间显著不同，但在Adelie和Gentoo之间没有显著差异，或者
- en: body mass is significantly different between Chinstrap and Gentoo, and between
    Adelie and Gentoo, but not significantly different between Adelie and Chinstrap.
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在Chinstrap和Gentoo之间、Adelie和Gentoo之间显著不同，但在Adelie和Chinstrap之间没有显著差异。
- en: Last, it could also be that body mass is significantly different between **all**
    species.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，体重也可能在**所有**物种之间存在显著差异。
- en: As for a [one-way ANOVA](https://statsandr.com/blog/anova-in-r/), we cannot,
    at this stage, know precisely which species is different from which one in terms
    of body mass. To know this, we need to compare each species two by two thanks
    to post-hoc tests (also known as pairwise comparisons).
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 至于[单因素方差分析](https://statsandr.com/blog/anova-in-r/)，在这个阶段，我们无法确切知道哪种物种在体重方面与其他物种不同。要知道这一点，我们需要通过事后检验（也称为成对比较）来两两比较每个物种。
- en: There are several post-hoc tests, the most common one being the Tukey HSD, which
    tests all possible pairs of groups. As mentioned earlier, this test only needs
    to be done on the species variable because there are only two levels for the sex.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种事后检验，最常见的是Tukey HSD，它测试所有可能的组对。如前所述，这个检验只需要在物种变量上进行，因为性别只有两个水平。
- en: 'As for the one-way ANOVA, the Tukey HSD can be done in R as follows:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 至于单因素方差分析，Tukey HSD可以在R中按如下方式进行：
- en: '[PRE36]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'or using the `{multcomp}` package:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 或使用`{multcomp}`包：
- en: '[PRE38]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '[PRE40]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: or using the `pairwise.t.test()` function using the p-value adjustment method
    of your choice:[6](https://statsandr.com/blog/two-way-anova-in-r/#fn6)
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 或使用`pairwise.t.test()`函数，使用你选择的p值调整方法：[6](https://statsandr.com/blog/two-way-anova-in-r/#fn6)
- en: '[PRE41]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '[PRE42]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Note that when using the second method, it is the model without the interaction
    that needs to be specified into the `glht()` function, even if the interaction
    is significant. Moreover, do not forget to replace `mod` and `species` in my code
    with the name of your model and the name of your independent variable.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，使用第二种方法时，需要在`glht()`函数中指定没有交互作用的模型，即使交互作用显著。此外，不要忘记在我的代码中将`mod`和`species`替换为你的模型名称和独立变量名称。
- en: 'Both methods give the same results, that is:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 两种方法得到的结果相同，即：
- en: body mass is *not* significantly different between Chinstrap and Adelie (adjusted
    p-value = 0.83),
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Chinstrap和Adelie之间的体重*没有*显著差异（调整后的p值 = 0.83），
- en: body mass is significantly different between Gentoo and Adelie (adjusted p-value
    < 0.001), and
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在Gentoo和Adelie之间（调整后的p值 < 0.001）显著不同，并且
- en: body mass is significantly different between Gentoo and Chinstrap (adjusted
    p-value < 0.001).
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 体重在Gentoo和Chinstrap之间（调整后的p值 < 0.001）显著不同。
- en: Remember that it is the **adjusted** p-values that are reported, to prevent
    the [issue of multiple testing](https://statsandr.com/blog/anova-in-r/#issue-of-multiple-testing)
    which occurs when comparing several pairs of groups.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 记住报告的是**调整后的**p值，以防止比较多个组对时出现的[多重检验问题](https://statsandr.com/blog/anova-in-r/#issue-of-multiple-testing)。
- en: 'If you would like to compare all combinations of groups, it can be done with
    the `TukeyHSD()` function and specifying the interaction in the `which` argument:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想比较所有组的组合，可以使用`TukeyHSD()`函数，并在`which`参数中指定交互作用：
- en: '[PRE43]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '[PRE44]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Or with the `HSD.test()` function from the `{agricolae}` package, which denotes
    subgroups that are not significantly different from each other with the same letter:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 或者使用来自`{agricolae}`包的`HSD.test()`函数，该函数用相同的字母标记那些在统计上没有显著差异的子组：
- en: '[PRE45]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '[PRE46]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '[PRE47]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'If you have many groups to compare, plotting them might be easier to interpret:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有多个组需要比较，绘图可能更容易解释：
- en: '[PRE48]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '[PRE49]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '![](../Images/00df3d37a8dd5b5fa56a247b1a376dd7.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/00df3d37a8dd5b5fa56a247b1a376dd7.png)'
- en: Plot by author
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 按作者绘图
- en: From the outputs and plot above, we conclude that all combinations of sex and
    species are significantly different, except between female Chinstrap and female
    Adelie (p-value = 0.138) and male Chinstrap and male Adelie (p-value = 0.581).
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 从上述输出和图中，我们得出结论，所有性别和物种的组合之间都有显著差异，除了雌性Chinstrap和雌性Adelie（p值 = 0.138）以及雄性Chinstrap和雄性Adelie（p值
    = 0.581）。
- en: These results, which are by the way in line with the boxplots shown above and
    which will be confirmed with the visualizations below, concludes the two-way ANOVA
    in R.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果与上面展示的箱型图一致，并将通过下面的可视化得到确认，这些结果总结了 R 中的二元方差分析。
- en: Visualizations
  id: totrans-261
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可视化
- en: If you would like to visualize results in a different way to what has already
    been presented in the preliminary analyses, below are some ideas of useful plots.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想以不同于初步分析中已经呈现的方式可视化结果，以下是一些有用的绘图思路。
- en: 'First, with the mean and standard error of the mean by subgroup using the `allEffects()`
    function from the `{effects}` package:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，使用 `{effects}` 包中的 `allEffects()` 函数绘制每个子组的均值和标准误：
- en: '[PRE50]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '[PRE51]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '![](../Images/7cc474320810b00de7c76f86d8e3505b.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7cc474320810b00de7c76f86d8e3505b.png)'
- en: Plot by author
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Or using the `{ggpubr}` package:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 或使用 `{ggpubr}` 包：
- en: '[PRE52]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '![](../Images/7ce0d965287b2ff3e9045b1747a0565d.png)'
  id: totrans-271
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7ce0d965287b2ff3e9045b1747a0565d.png)'
- en: Plot by author
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Alternatively, using `{Rmisc}` and `{ggplot2}`:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，使用 `{Rmisc}` 和 `{ggplot2}`：
- en: '[PRE54]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '[PRE55]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '![](../Images/2b9715a46ac806fc7b4d2524d86c55d4.png)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2b9715a46ac806fc7b4d2524d86c55d4.png)'
- en: Plot by author
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Second, if you prefer to draw only the mean by subgroup:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，如果您更喜欢仅绘制每个子组的均值：
- en: '[PRE56]'
  id: totrans-279
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: '![](../Images/52e323eee886597e786bee242152bc3d.png)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/52e323eee886597e786bee242152bc3d.png)'
- en: Plot by author
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 作者绘制
- en: 'Last but not least, for those of you who are familiar with GraphPad, you are
    most likely familiar with plotting means and error bars as follows:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 最后但同样重要的是，对于那些熟悉 GraphPad 的人，您可能已经熟悉如下方式绘制均值和误差条：
- en: '[PRE57]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '![](../Images/a4c790aca40f652162e60b1f69636409.png)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a4c790aca40f652162e60b1f69636409.png)'
- en: Conclusion
  id: totrans-285
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: In this post, we started with a few reminders of the different tests that exist
    to compare a quantitative variable across groups. We then focused on the two-way
    ANOVA, starting from its goal and hypotheses to its implementation in R, together
    with the interpretations and some visualizations. We also briefly mentioned its
    underlying assumptions and one post-hoc test to compare all subgroups.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们首先回顾了用于比较组间定量变量的不同检验方法。然后我们集中讨论了二元方差分析，从其目标和假设到在 R 中的实现，以及解释和一些可视化。我们还简要提到了其基本假设和一种事后检验，用于比较所有子组。
- en: All this was illustrated with the `penguins` dataset available from the `{palmerpenguins}`
    package.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些都使用 `{palmerpenguins}` 包中提供的 `penguins` 数据集进行了说明。
- en: Thanks for reading.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 感谢阅读。
- en: I hope this article will help you in conducting a two-way ANOVA with your data.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望这篇文章能帮助您用您的数据进行二元方差分析。
- en: As always, if you have a question or a suggestion related to the topic covered
    in this article, please add it as a comment so other readers can benefit from
    the discussion.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 一如既往，如果您对本文讨论的主题有任何问题或建议，请在评论中添加，以便其他读者也能从讨论中受益。
- en: In theory, a one-way ANOVA can also be used to compare 2 groups, and not only
    3 or more. Nonetheless, in practice, it is often the case that a Student’s t-test
    is performed to compare 2 groups, and a one-way ANOVA to compare 3 or more groups.
    Conclusions obtained via a Student’s t-test for independent samples and a one-way
    ANOVA with 2 groups will be similar.[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref1)
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 理论上，一元方差分析也可以用于比较 2 个组，而不仅仅是 3 个或更多组。然而，在实际操作中，通常会使用学生 t 检验来比较 2 个组，而使用一元方差分析来比较
    3 个或更多组。使用独立样本的学生 t 检验和 2 个组的一元方差分析得出的结论会相似。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref1)
- en: Note that if the normality assumption is not met, many transformations can be
    applied to improve it, the most common one being the logarithmic transformation
    (`log()` function in R).[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref2)
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，如果正态性假设未满足，可以应用许多变换来改善这一点，其中最常见的是对数变换（`log()` 函数在 R 中）。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref2)
- en: Note that the Bartlett’s test is also appropriate to test the assumption of
    equal variances.[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref3)
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，Bartlett 检验也适用于检验方差齐性假设。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref3)
- en: An additive model makes the assumption that the 2 explanatory variables are
    independent; they do not interact with each other.[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref4)
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加性模型假设两个解释变量是独立的；它们之间没有相互作用。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref4)
- en: Where `mod` is the name of your saved model.[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref5)
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 其中 `mod` 是您保存的模型的名称。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref5)
- en: Here, we use the Benjamini & Hochberg (1995) correction, but you can choose
    between several methods. See `?p.adjust` for more details.[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref6)
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，我们使用Benjamini & Hochberg (1995)修正，但你可以选择多种方法。有关更多详情，请参见`?p.adjust`。[↩︎](https://statsandr.com/blog/two-way-anova-in-r/#fnref6)
- en: Related articles
  id: totrans-297
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 相关文章
- en: '[ANOVA in R](https://statsandr.com/blog/anova-in-r/)'
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[R中的ANOVA](https://statsandr.com/blog/anova-in-r/)'
- en: '[Student’s t-test in R and by hand: how to compare two groups under different
    scenarios?](https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/)'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[R中的学生t检验及手动检验：如何在不同场景下比较两个组？](https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/)'
- en: '[One-sample Wilcoxon test in R](https://statsandr.com/blog/one-sample-wilcoxon-test-in-r/)'
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[R中的单样本Wilcoxon检验](https://statsandr.com/blog/one-sample-wilcoxon-test-in-r/)'
- en: '[Kruskal-Wallis test, or the nonparametric version of the ANOVA](https://statsandr.com/blog/kruskal-wallis-test-nonparametric-version-anova/)'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Kruskal-Wallis检验，即ANOVA的非参数版本](https://statsandr.com/blog/kruskal-wallis-test-nonparametric-version-anova/)'
- en: '[Hypothesis test by hand](https://statsandr.com/blog/hypothesis-test-by-hand/)'
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[手动假设检验](https://statsandr.com/blog/hypothesis-test-by-hand/)'
- en: '*Originally published at* [*https://statsandr.com*](https://statsandr.com/blog/two-way-anova-in-r/)
    *on June 19, 2023.*'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: '*最初发表于* [*https://statsandr.com*](https://statsandr.com/blog/two-way-anova-in-r/)
    *于2023年6月19日。*'

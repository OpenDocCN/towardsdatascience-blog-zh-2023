- en: 'Dirichlet Distribution: The Underlying Intuition and Python Implementation'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Dirichlet 分布：基础直观理解及 Python 实现
- en: 原文：[https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2](https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2](https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2)
- en: Everything you need to know about the Dirichlet distribution
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于 Dirichlet 分布你需要知道的一切
- en: '[](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Reza
    Bagheri](../Images/7c5a7dc9e6e31048ce31c8d49055987c.png)](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)
    [Reza Bagheri](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Reza
    Bagheri](../Images/7c5a7dc9e6e31048ce31c8d49055987c.png)](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)
    [Reza Bagheri](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)
    ·27 min read·Aug 1, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)
    ·27分钟阅读·2023年8月1日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/d401dd1e32b5386d115f5f45826440fe.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d401dd1e32b5386d115f5f45826440fe.png)'
- en: 'Image source: [https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/](https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '图片来源: [https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/](https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/)'
- en: The Dirichlet distribution is a generalization of the beta distribution. In
    Bayesian statistics, it is commonly used as the conjugate prior to the multinomial
    distribution, hence it can be used to model the uncertainty of a random vector
    of probabilities. It has a wide range of applications including Bayesian analysis,
    text mining, statistical genetics, and nonparametric inference. This article gives
    an intuitive introduction to Dirichlet distribution and shows how it is connected
    to the multinomial distribution. In addition, it shows how it can be modeled and
    visualized in Python.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: Dirichlet 分布是贝塔分布的一种推广。在贝叶斯统计中，它通常用作多项式分布的共轭先验，因此可以用来建模概率随机向量的不确定性。它具有广泛的应用，包括贝叶斯分析、文本挖掘、统计遗传学和非参数推断。本文对
    Dirichlet 分布进行了直观介绍，并展示了它与多项式分布的联系。此外，还展示了如何在 Python 中建模和可视化 Dirichlet 分布。
- en: '**Definition**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义**'
- en: 'Suppose that the continuous random variables *X*₁, *X*₂, …*Xₖ* (*k*≥2) form
    the random vector ***X*** defined as:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 假设连续随机变量 *X*₁, *X*₂, …*Xₖ* (*k*≥2) 形成随机向量 ***X***，定义为：
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: 'We also define the vector ***α*** as:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还定义了向量 ***α*** 如下：
- en: '![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)'
- en: where
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/d80069db2690a24ca16772c9735581b4.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d80069db2690a24ca16772c9735581b4.png)'
- en: 'Now the random vector ***X*** is said to have *Dirichlet distribution* with
    parameter ***α*** if it has the following joint PDF:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果随机向量 ***X*** 具有参数 ***α*** 的 *Dirichlet 分布*，则它具有以下联合 PDF：
- en: '![](../Images/ebb95005954b232af99dee7d20387b43.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ebb95005954b232af99dee7d20387b43.png)'
- en: The function B(***α***) is called the *multivariate* *beta function* and is
    defined as
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 函数 B(***α***) 称为 *多变量* *贝塔函数*，其定义为
- en: '![](../Images/d8ddc644727cbf8a1dcefda6397b8fb3.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d8ddc644727cbf8a1dcefda6397b8fb3.png)'
- en: 'where Г(*x*) is the gamma function. If the random vector ***X*** has a Dirichlet
    distribution with parameter ***α***, it is denoted by ***X*** ~ Dir(***α***).
    The multivariate beta function is included in the joint PDF to normalize it. The
    joint PDF should integrate to 1 over its domain:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 Г(*x*) 是伽马函数。如果随机向量 ***X*** 具有参数 ***α*** 的 Dirichlet 分布，则记作 ***X*** ~ Dir(***α***)。多变量贝塔函数包含在联合概率密度函数（PDF）中用于归一化。联合
    PDF 应该在其定义域上积分为 1：
- en: '![](../Images/95afa4275082e9598e960cadf411433f.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/95afa4275082e9598e960cadf411433f.png)'
- en: 'Hence, we have:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们有：
- en: '![](../Images/ed6529ee755626f0afbf5b80046f1db6.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ed6529ee755626f0afbf5b80046f1db6.png)'
- en: 'Based on Equation 1, the values that the random variables *X*₁, *X*₂, …*Xₖ*
    take should meet the following conditions to have *f***ₓ**(***x***)>0:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 基于方程1，随机变量*X*₁、*X*₂、…*Xₖ*的取值应满足以下条件，以使*f***ₓ**(***x***)>0：
- en: '![](../Images/7e1ec62ff43e62b50ef856bf367dcafe.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7e1ec62ff43e62b50ef856bf367dcafe.png)'
- en: These conditions define the *support* of the Dirichlet distribution. The support
    of ***X***, and of its distribution, is the set of all ***x*** (the values that
    ***X*** can take) where *f***ₓ**(***x***)>0\. If ***X*** has *k* elements, the
    support of ***X*** with a Dirichlet distribution is a *k*-1 dimensional *simplex*.
    A simplex is a bounded linear manifold that is created because of the constraints
    of Equation 3\. A simplex is the generalization of the notion of a triangle to
    higher dimensions. Hence, a *k*-1 dimensional simplex can be thought of as a *k*-1
    dimensional triangle which lies in a *k*-dimensional space.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 这些条件定义了Dirichlet分布的*支持*。***X***的支持及其分布的支持是所有***x***的集合（***X***可以取的值），其中*f***ₓ**(***x***)>0。如果***X***有*k*个元素，具有Dirichlet分布的***X***的支持是一个*k*-1维的*单纯形*。单纯形是由于方程3的约束而形成的有界线性流形。单纯形是三角形概念的高维推广。因此，*k*-1维单纯形可以被视为一个位于*k*维空间中的*k*-1维三角形。
- en: 'For example, if *k*=2, then the support of ***X*** is the 1-d simplex shown
    in Figure 1 (left). It is a straight line that touches each axis at a point 1
    unit away from the origin. For each point on this line, we have:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果*k*=2，那么***X***的支持是图1（左）中显示的1维单纯形。它是一条直线，触及每个坐标轴，距离原点1个单位。对于这条线上的每一点，我们有：
- en: '![](../Images/1db12253f21dcde52287e2f96a49aa03.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1db12253f21dcde52287e2f96a49aa03.png)'
- en: For *k*=3, then the support of ***X*** is the 2-d simplex shown in Figure 1
    (right). Now it is a triangle that touches each axis at a point 1 unit away from
    the origin.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 对于*k*=3，那么***X***的支持是图1（右）中显示的2维单纯形。现在它是一个触及每个坐标轴的三角形，距离原点1个单位。
- en: '![](../Images/5ca6946080d9e82b734d028a02857ed4.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5ca6946080d9e82b734d028a02857ed4.png)'
- en: Figure 1 (Image by author)
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图1（作者提供）
- en: 'For each point on the surface of this triangle, we have:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个三角形表面上的每一个点，我们有：
- en: '![](../Images/e911b8e900aab37ca329b00d39191c5d.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e911b8e900aab37ca329b00d39191c5d.png)'
- en: Let the random vector
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 让随机向量
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: 'has a Dirichlet distribution with the parameter:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数的Dirichlet分布：
- en: '![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)'
- en: And let
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 让
- en: '![](../Images/e10286164e5d097a6083200b8eccf504.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e10286164e5d097a6083200b8eccf504.png)'
- en: 'Then, it can be shown that the mean of ***X*** is as follows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，可以证明***X***的均值如下：
- en: '![](../Images/01d94aca4c6ac3f42eb7f7e369185b7e.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/01d94aca4c6ac3f42eb7f7e369185b7e.png)'
- en: 'It can be also shown that:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 也可以证明：
- en: '![](../Images/b428305ac29ad9482aff1db4baede1c1.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b428305ac29ad9482aff1db4baede1c1.png)'
- en: '**Intuition**'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**直觉**'
- en: 'As mentioned before, the Dirichlet distribution is commonly used as the conjugate
    prior for the multinomial distribution. Hence, to understand the intuition behind
    it, first, we need to review the multinomial distribution. Suppose that the discrete
    random vector ***X*** is defined as:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，Dirichlet分布通常作为多项分布的共轭先验。因此，为了理解其背后的直觉，我们首先需要回顾多项分布。假设离散随机向量***X***定义为：
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: 'And let the vector ***p*** be:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 让向量***p***为：
- en: '![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)'
- en: 'Then ***X*** is said to have the multinomial distribution with parameters *n*
    and ***p*** if it has the following joint PMF:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 那么***X***被称为具有参数*n*和***p***的多项分布，如果它具有以下联合PMF：
- en: '![](../Images/78cb26b2cb78594406394c72e40b9991.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/78cb26b2cb78594406394c72e40b9991.png)'
- en: Multinomial distribution can be used to model a *k*-sided die. Suppose that
    we have a *k*-sided die and roll it *n* times. Let *pᵢ* denote the probability
    of getting side *i*, and let the random variable *Xᵢ* represent the total number
    of times that side *i* is observed (*i*=1…*k*). Then the random vector
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 多项分布可以用于建模一个*k*面骰子。假设我们有一个*k*面骰子，并将其掷*n*次。让*pᵢ*表示获得第*i*面的概率，并让随机变量*Xᵢ*表示第*i*面观察到的总次数（*i*=1…*k*）。那么随机向量
- en: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2badf37a90938009e80bdb08529e453a.png)'
- en: has a multinomial distribution with parameters *n* and
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数*n*的多项分布
- en: '![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)'
- en: This is demonstrated in Figure 2.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这一点在图 2 中展示。
- en: '![](../Images/1f308405453930cb5be7b120f2a8633a.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1f308405453930cb5be7b120f2a8633a.png)'
- en: Figure 2 (Image by author)
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2（作者提供的图片）
- en: 'Now suppose that we do not know the values of *pᵢ* in vector ***p***. Hence,
    we don’t know the probability of getting each side of the *k*-sided die, and we
    want to infer it by observing the outcomes of *n* rolls of this die. The elements
    of ***p*** represent the probability of some mutually exclusive events, so we
    should have:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 现在假设我们不知道向量 ***p*** 中的 *pᵢ* 值。因此，我们不知道每一面 *k*-面骰子的概率，我们想通过观察 *n* 次掷骰子的结果来推断它。***p***
    的元素表示一些互斥事件的概率，因此我们应该有：
- en: '![](../Images/f50f34ded99c35f004271471997ef16a.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f50f34ded99c35f004271471997ef16a.png)'
- en: The value of ***p*** can be inferred using the *Bayesian approach*. Here, we
    assume that the unknown probability vector ***p*** is represented by the continuous
    random vector ***P***. The probability distribution of ***P*** is called the *prior
    distribution*. The prior distribution represents the prior knowledge or assumptions
    about the parameter ***P*** being estimated. After rolling the die, we can analyze
    the observed data and use it to update our belief about ***P***. Hence, we end
    up with a new distribution for ***P*** which is called the *posterior distribution*.
    The posterior distribution results from updating the prior probability distribution
    with the observed data.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '***p*** 的值可以使用 *贝叶斯方法* 推断。在这里，我们假设未知的概率向量 ***p*** 由连续随机向量 ***P*** 表示。***P***
    的概率分布称为 *先验分布*。先验分布表示对估计参数 ***P*** 的先验知识或假设。在掷骰子之后，我们可以分析观察到的数据，并使用这些数据更新我们对 ***P***
    的信念。因此，我们得到一个新的 ***P*** 分布，这称为 *后验分布*。后验分布是通过用观察数据更新先验概率分布得到的。'
- en: 'Remember that random variable *Xᵢ* in the random vector ***X*** represents
    the total number of times that side *i* is observed. If we know the value of ***p***,
    we can calculate the probability of observing *X*₁=*m*₁, *X*₂=*m*₂, …*Xₖ*=*mₖ*
    after *n* rolls using the following conditional probability:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，随机向量***X***中的随机变量 *Xᵢ* 代表观察到的第 *i* 面的总次数。如果我们知道 ***p*** 的值，我们可以使用以下条件概率计算在
    *n* 次掷骰子后观察到 *X*₁=*m*₁, *X*₂=*m*₂, … *Xₖ*=*mₖ* 的概率：
- en: '![](../Images/1f9257fe46c6db19625cc7eaa7eeb1ba.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1f9257fe46c6db19625cc7eaa7eeb1ba.png)'
- en: 'where:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 其中：
- en: '![](../Images/d0b3d2dfc990e0ecb6df95d78a46640b.png)![](../Images/7286ebcb8f3c5fac15df0bc79272213d.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d0b3d2dfc990e0ecb6df95d78a46640b.png)![](../Images/7286ebcb8f3c5fac15df0bc79272213d.png)'
- en: 'This conditional gives the probability of observing each side of the die for
    a specific number of times after *n* rolls assuming that we know the true value
    of ***P***. As mentioned before, the probability distribution of ***P*** is our
    prior distribution. We denote the joint PDF of this distribution by *f_****P***(***p***).
    Now, we can use Bayes’ rule to connect the prior and posterior joint PDFs:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 这个条件概率给出了在 *n* 次掷骰子后观察到每一面骰子特定次数的概率，假设我们知道 ***P*** 的真实值。如前所述，***P*** 的概率分布是我们的先验分布。我们用
    *f_****P***(***p***) 来表示这个分布的联合概率密度函数。现在，我们可以使用贝叶斯定理将先验和后验联合概率密度函数连接起来：
- en: '![](../Images/f64975b1eaa9aa8d5d0cdf845944da3f.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f64975b1eaa9aa8d5d0cdf845944da3f.png)'
- en: 'Here *f_****P***|***X*** (***p***|***X***=***m***) is the joint PDF of the
    posterior distribution. This distribution updates our belief about ***P*** after
    observing ***X***. We also call *P*(***X***=***m***|***p***) the likelihood, and
    it can be written as the PMF of a multinomial distribution with a known value
    of ***p***(Equation 4):'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 *f_****P***|***X*** (***p***|***X***=***m***) 是后验分布的联合概率密度函数。这个分布在观察到 ***X***
    后更新我们对 ***P*** 的信念。我们也称 *P*(***X***=***m***|***p***) 为似然函数，它可以写成一个已知 ***p*** 值的多项式分布的概率质量函数（方程
    4）：
- en: '![](../Images/2f15581bd2006837ed36b459e5187544.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2f15581bd2006837ed36b459e5187544.png)'
- en: 'The denominator of Bayes’ rule is the probability of ***X***=***m***, and it
    is called the marginal PMF of ***X***:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯定理的分母是 ***X***=***m*** 的概率，称为 ***X*** 的边际概率质量函数：
- en: '![](../Images/cc6d0b47e85d4258a89ea0916d33bdea.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/cc6d0b47e85d4258a89ea0916d33bdea.png)'
- en: 'Please note it is independent of the true value of ***p***. Now we assume that
    the prior distribution is a Dirichlet distribution with the parameter ***α***₁:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这与 ***p*** 的真实值无关。现在我们假设先验分布是具有参数 ***α***₁ 的 Dirichlet 分布。
- en: '![](../Images/c4c37e90e1f775ee43e325f8f950c66e.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c4c37e90e1f775ee43e325f8f950c66e.png)'
- en: where
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/d6ce5f1d51afd5d8e3f5ffdb9a726d6d.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d6ce5f1d51afd5d8e3f5ffdb9a726d6d.png)'
- en: Remember that the random variables with a Dirichlet distribution should follow
    the conditions in Equation 3, and these conditions are exactly the same as the
    conditions of Equation 5\. In fact, the conditions in Equation 3 allow us to use
    the Dirichlet distribution for the random variables that represent the probability
    of mutually exclusive events.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，具有 Dirichlet 分布的随机变量应遵循方程 3 中的条件，这些条件与方程 5 的条件完全相同。实际上，方程 3 中的条件允许我们使用 Dirichlet
    分布来表示互斥事件的概率的随机变量。
- en: 'Now we can use the Bayes’ rule (Equation 6) to write:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用贝叶斯规则（方程 6）来写：
- en: '![](../Images/418e868227eb5a117564c6229c3581f3.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/418e868227eb5a117564c6229c3581f3.png)'
- en: 'Here *c* is a constant that does not depend on *pᵢ* values. The posterior joint
    PDF should be normalized; hence we have the following condition:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 *c* 是一个不依赖于 *pᵢ* 值的常数。后验联合 PDF 应该被归一化，因此我们有以下条件：
- en: '![](../Images/80b71fa8c3c66beb644eed7fade78eb8.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/80b71fa8c3c66beb644eed7fade78eb8.png)'
- en: By comparing Equations 7 and 8 with Equations 1 and 2, we conclude that the
    posterior distribution is a Dirichlet distribution with the parameter
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将方程 7 和 8 与方程 1 和 2 进行比较，我们得出结论，后验分布是一个参数为的 Dirichlet 分布
- en: '![](../Images/a341d75cb1d476ef88fc4b2540515956.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a341d75cb1d476ef88fc4b2540515956.png)'
- en: 'and *c* is simply its normalizing factor, and we get:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 和 *c* 仅仅是其归一化因子，我们得到：
- en: '![](../Images/88c4cde864ad1f7ecea1943c9cb9c257.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/88c4cde864ad1f7ecea1943c9cb9c257.png)'
- en: 'Finally, we can write:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以写：
- en: '![](../Images/edd226985bb40724fcc37018af64e701.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/edd226985bb40724fcc37018af64e701.png)'
- en: So, if we assume that the prior has a Dirichlet distribution, then the posterior
    distribution of ***P*** after observing ***X***=***m*** is also a Dirichlet distribution.
    We only need to add the observed number of each side (*mᵢ*) to its corresponding
    parameter in the prior distribution (*αᵢ*) to get the parameters of the posterior
    distribution.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，如果我们假设先验分布是 Dirichlet 分布，那么在观察到 ***X***=***m*** 之后的后验分布也是 Dirichlet 分布。我们只需将每个侧面观察到的数量
    (*mᵢ*) 添加到先验分布中的相应参数 (*αᵢ*) 中，就能得到后验分布的参数。
- en: In Bayesian probability theory, If the posterior distribution belongs to the
    same family as the prior distribution, then the prior and posterior are referred
    to as *conjugate distributions*. Therefore, we conclude that the Dirichlet distribution
    is the conjugate prior to the multinomial distribution (Figure 3).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在贝叶斯概率理论中，如果后验分布属于与先验分布相同的家族，那么先验和后验被称为 *共轭分布*。因此，我们得出结论，Dirichlet 分布是多项分布的共轭先验（图
    3）。
- en: '![](../Images/c96ca617fe8f7f1229cca6c2aec2ee71.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c96ca617fe8f7f1229cca6c2aec2ee71.png)'
- en: Figure 3 (Image by author)
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3（作者提供的图片）
- en: One special case of the Dirichlet distribution is when
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Dirichlet 分布的一个特殊情况是当
- en: '![](../Images/e74030855bcc495979276dd393694a24.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e74030855bcc495979276dd393694a24.png)'
- en: 'Then we have:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们得到：
- en: '![](../Images/2c37ba9b37c4f048d44401175d103689.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2c37ba9b37c4f048d44401175d103689.png)'
- en: which means that
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着
- en: '![](../Images/c9ccda7f5fde9ddc013fbf29f693515a.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c9ccda7f5fde9ddc013fbf29f693515a.png)'
- en: is the same as the uniform distribution over its *k*-1 dimensional simplex since
    the joint PDF has the same value over the simplex.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 与其 *k*-1 维单纯形上的均匀分布是一样的，因为联合 PDF 在单纯形上具有相同的值。
- en: '**Modeling and visualization in Python**'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '**在 Python 中建模和可视化**'
- en: 'We can use the `scipy` library to model Dirichlet distribution in Python. In
    `scipy`, Dirichlet distribution can be created using the object `dirichlet`. This
    object takes the parameter `alpha` which corresponds to ***α*** in Equation 1\.
    We can also pass `alpha` to the methods of this object instead. The method `pdf()`
    also takes the parameter `x` which corresponds to ***x*** in Equation 1 and returns
    the joint PDF of the distribution at `x`. We can also calculate the mean and variance
    of the distribution using the methods `mean()` and `var()`. For example, let:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 `scipy` 库在 Python 中对 Dirichlet 分布进行建模。在 `scipy` 中，Dirichlet 分布可以通过对象
    `dirichlet` 创建。该对象接受参数 `alpha`，该参数对应于方程 1 中的 ***α***。我们也可以将 `alpha` 传递给此对象的方法。方法
    `pdf()` 还接受参数 `x`，该参数对应于方程 1 中的 ***x***，并返回 `x` 处分布的联合 PDF。我们还可以使用方法 `mean()`
    和 `var()` 计算分布的均值和方差。例如，设：
- en: '![](../Images/5935c0207086f3bfabb27caa02a87885.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5935c0207086f3bfabb27caa02a87885.png)'
- en: 'Now we want to calculate the mean of ***X*** and its joint PDF at [0.5, 0.3,
    0.2]ᵀ using the following code snippet:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们想计算 ***X*** 的均值及其在 [0.5, 0.3, 0.2]ᵀ 的联合 PDF，使用以下代码片段：
- en: '[PRE0]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If the value of `x` is outside the simplex, `pdf()` throws an error:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 `x` 的值在单纯形之外，`pdf()` 会抛出错误：
- en: '[PRE2]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/b12a46c92bf7e82419db89db477a8ea4.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b12a46c92bf7e82419db89db477a8ea4.png)'
- en: We can visualize the joint PDF of the Dirichlet when *k*=2 and 3 (*k* is the
    number of the elements of ***X***). As mentioned before, when we have 3 random
    variables in ***X*** (with Dirichlet distribution), the simplex is a 2-d triangle
    (Figure 1). We can calculate the contours of the joint PDF on the surface of this
    simplex and plot it in a 2-d plot with *barycentric coordinates* (Figure 4).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以可视化 *k*=2 和 3 时的 Dirichlet 联合 PDF（*k* 是 ***X*** 的元素个数）。如前所述，当我们在 ***X***
    中有 3 个随机变量（具有 Dirichlet 分布）时，单纯形是一个二维三角形（图 1）。我们可以计算这个单纯形表面上联合 PDF 的轮廓，并用 *重心坐标*
    在二维图中绘制（图 4）。
- en: '![](../Images/d0b4cf6d74749675587b2f5be7538a7f.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d0b4cf6d74749675587b2f5be7538a7f.png)'
- en: Figure 4 (Image by author)
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4（作者提供的图像）
- en: The barycentric coordinates are the coordinates of a point with respect to a
    simplex in an affine space. They can give the location of a point with respect
    to a line, triangle, or tetrahedron instead of the global Cartesian coordinates.
    In a *k*-dimensional Cartesian coordinate system, the coordinates of a point can
    be expressed as the normalized weighted average of the edges of a *k*-1 dimensional
    simplex. Those weights then give the barycentric coordinates of the point relative
    to that simplex. Consider the 2-d space shown in Figure 5.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 重心坐标是一个点在仿射空间中相对于单纯形的坐标。它们可以提供一个点相对于直线、三角形或四面体的位置，而不是全局笛卡尔坐标。在 *k* 维笛卡尔坐标系中，一个点的坐标可以表示为
    *k*-1 维单纯形的边的归一化加权平均。这些权重给出了该点相对于单纯形的重心坐标。考虑图 5 中显示的二维空间。
- en: '![](../Images/9dc499125921610ff548db6fa55af521.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9dc499125921610ff548db6fa55af521.png)'
- en: Figure 5 (Image by author)
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5（作者提供的图像）
- en: 'The 1-d simplex is the line segment between the endpoints [0,1] and [0,1].
    The coordinates of an arbitrary point ***p*** on this simplex can be expressed
    as the normalized weighted average of coordinates of the endpoints:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 一维单纯形是端点 [0,1] 和 [0,1] 之间的线段。在这个单纯形上的任意点 ***p*** 的坐标可以表示为端点坐标的归一化加权平均：
- en: '![](../Images/47068359c366bcd7e40be16900502a6a.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/47068359c366bcd7e40be16900502a6a.png)'
- en: where
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/3d0f2050c861427acde6ab36db98211d.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3d0f2050c861427acde6ab36db98211d.png)'
- en: Here *λ*₁ is the distance of ***p*** from the endpoint [0,1] divided by the
    length of the simplex (*L*). Similarly, *λ*₂ is the distance of ***p*** from the
    endpoint [1,0] divided by *L*. The weights *λ*₁ and *λ*₂ are the barycentric coordinates
    of ***p*** relative to this simplex, and since the endpoints are just one unit
    away from the origin, they have the same values as the Cartesian coordinates.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 *λ*₁ 是 ***p*** 到端点 [0,1] 的距离除以单纯形的长度 (*L*)。类似地，*λ*₂ 是 ***p*** 到端点 [1,0] 的距离除以
    *L*。权重 *λ*₁ 和 *λ*₂ 是 ***p*** 相对于该单纯形的重心坐标，并且由于端点距离原点只有一个单位，它们与笛卡尔坐标具有相同的值。
- en: 'Next, consider the 2-d simplex shown in Figure 6\. This simplex is a triangle
    formed by the endpoints [1,0,0], [0,1,0] and [0,0,1]. The coordinates of a point
    ***p*** on this simplex are equal to the normalized weighted average of the coordinates
    of these endpoints:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，考虑图 6 中显示的二维单纯形。这个单纯形是由端点 [1,0,0]、[0,1,0] 和 [0,0,1] 组成的三角形。该单纯形上点 ***p***
    的坐标等于这些端点坐标的归一化加权平均：
- en: '![](../Images/8ea24fca5e787855c4e16019e59d8f6c.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8ea24fca5e787855c4e16019e59d8f6c.png)'
- en: where
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/82fbe85bf54cd613528c8f96e7eac3de.png)![](../Images/4253dba4fa736e1ac0ad54d325751433.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/82fbe85bf54cd613528c8f96e7eac3de.png)![](../Images/4253dba4fa736e1ac0ad54d325751433.png)'
- en: Figure 6 (Image by author)
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6（作者提供的图像）
- en: In this triangle, each node represents one of the coordinate axes *x*₁, *x*₂,
    or *x*₃. Suppose that we want to calculate the value of *x*₁. Let the length of
    each side be *L* (it is an equilateral triangle). To get the value of *x*₁, we
    draw a line that passes through ***p*** and is parallel to the side that doesn’t
    pass through the node represented by *x*₁ (here this side is *x*₂*x*₃). This line
    divides each of the remaining sides (*x*₁*x*₂ and *x*₁*x*₃) into two segments.
    On each of these sides, the length of the line segment which does not contain
    the node *x*₁ is *λ*₁*L* (Figure 6)*.* We can calculate the values of *λ*₂ and
    *λ*₃ similarly.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个三角形中，每个节点代表一个坐标轴 *x*₁、*x*₂ 或 *x*₃。假设我们要计算 *x*₁ 的值。设每条边的长度为 *L*（这是一个等边三角形）。为了得到
    *x*₁ 的值，我们绘制一条经过 ***p*** 并且与不经过 *x*₁ 所代表的节点的边（这里是 *x*₂*x*₃）平行的直线。这条直线将其余的每一边（*x*₁*x*₂
    和 *x*₁*x*₃）分成两个线段。在这些边上，不包含节点 *x*₁ 的线段长度是 *λ*₁*L*（见图 6）。我们可以类似地计算 *λ*₂ 和 *λ*₃
    的值。
- en: 'Now, we create a Python function that draws the contours of the joint PDF of
    the Dirichlet distribution on a 2-d simplex. Listing 1 imports all the libraries
    that we need later and defines the edges of this triangular simplex on a 2-d plot.
    These edges are stored in the list `edges`. Please note that this 2-d simplex
    is now plotted on a 2-d screen, hence all the edges are 2-dimensional. However,
    the barycentric coordinates of a point are still a weighted average of the Cartesian
    coordinates of these edges:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们创建一个 Python 函数来绘制二维单纯形上 Dirichlet 分布的联合 PDF 的等高线。清单 1 导入了我们后续需要的所有库，并在二维图上定义了这个三角形单纯形的边。这些边存储在列表`edges`中。请注意，这个二维单纯形现在绘制在二维屏幕上，因此所有的边都是二维的。然而，点的重心坐标仍然是这些边的笛卡尔坐标的加权平均值：
- en: '![](../Images/dab451bf7a5108843011a4b91e72b685.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/dab451bf7a5108843011a4b91e72b685.png)'
- en: Here *H* is the height of the triangle (Figure 7).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的*H*是三角形的高度（图 7）。
- en: We use the `matplotlib.tri` library to create a triangular mesh. The array `normal_vecs`
    keeps the normal vectors of each side of this triangle (the normal vector of each
    side is perpendicular to that side).
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用`matplotlib.tri`库来创建一个三角网格。数组`normal_vecs`保存了这个三角形每条边的法向量（每条边的法向量都垂直于该边）。
- en: '[PRE3]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In Listing 2, the function `cart_to_bc()` converts the 2-d Cartesian coordinates
    of a point into the barycentric coordinates relative to the 2-d triangle defined
    by the edges in `edges`.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在清单 2 中，函数`cart_to_bc()`将点的二维笛卡尔坐标转换为相对于`edges`中定义的二维三角形的重心坐标。
- en: '[PRE4]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Figure 7 shows how these calculations are done to calculate *λ*₃ (as an example).
    As this figure shows one edge of the triangle (***x***₁) is at the origin of the
    2-d Cartesian coordinate system. We can represent a point ***p*** on this triangle
    with vector ***x***₁***p***. From geometry, we know that
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7 展示了如何进行这些计算以计算*λ*₃（作为示例）。如图所示，三角形的一条边（***x***₁）位于二维笛卡尔坐标系统的原点。我们可以用向量***x***₁***p***来表示这个三角形上的点***p***。从几何学中，我们知道
- en: '![](../Images/354177cf624981cd8707f98879973b6a.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/354177cf624981cd8707f98879973b6a.png)'
- en: Where ***n*** is the normal vector of the side ***x***₁***x***₂. Hence, if we
    have the Cartesian coordinates of ***p***, the edges of the triangle, and the
    normal vector of each side, we can easily calculate the barycentric coordinates
    of ***p***.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 其中***n***是边***x***₁***x***₂的法向量。因此，如果我们知道点***p***的笛卡尔坐标、三角形的边以及每条边的法向量，我们就可以轻松计算出点***p***的重心坐标。
- en: '![](../Images/41fa71d84abcab86d00f6408b6ab99b8.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/41fa71d84abcab86d00f6408b6ab99b8.png)'
- en: Figure 7 (Image by author)
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7（作者提供的图片）
- en: It is important to note that this function doesn’t always return the exact barycentric
    coordinates. If a barycentric coordinate is outside the interval [1e-10 -10, 1–1e-10],
    then it is clipped to the interval edges using the `clip()` function in `numpy`.
    The reason for that will be explained later.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，这个函数并不总是返回准确的重心坐标。如果重心坐标超出了区间 [1e-10 -10, 1–1e-10]，则会使用`numpy`中的`clip()`函数将其裁剪到区间边界。原因将在后文中解释。
- en: 'We also have the function `bc_to_cart()` that converts the barycentric coordinates
    of this triangle to the Cartesian coordinates. The Cartesian coordinates of a
    point ***p*** are equal to the weighted average of the Cartesian coordinates of
    the edges of the triangle, and the barycentric coordinates are simply the weights:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有函数`bc_to_cart()`，它将这个三角形的重心坐标转换为笛卡尔坐标。点***p***的笛卡尔坐标等于三角形边的笛卡尔坐标的加权平均值，而重心坐标只是这些权重：
- en: '![](../Images/dab451bf7a5108843011a4b91e72b685.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/dab451bf7a5108843011a4b91e72b685.png)'
- en: Finally listing 3 defines the function `plot_contours()` that draws the contours
    of the joint PDF of a Dirichlet distribution on this triangle. This function creates
    a triangular mesh on the Cartesian 2d space. Next, the barycentric coordinates
    of each point on this mesh are calculated. Then it uses the barycentric coordinates
    to calculate the joint PDF of that point. After calculating the joint PDF of all
    the points on the triangle, the contours are plotted. Please note that some points
    on the triangular mesh can be slightly out of the simple boundary. This means
    that *x*₁+*x*₂+*x*₃ for that point can be slightly less than zero or greater than
    1\. Passing such a point to the `pdf()` method of the `dirichlet` object throws
    an error. Hence, we clip the barycentric coordinates in `cart_to_bc()` to avoid
    this error.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，列表 3 定义了函数`plot_contours()`，该函数绘制 Dirichlet 分布在这个三角形上的联合 PDF 等高线。此函数在笛卡尔
    2D 空间上创建一个三角网格。接下来，计算网格上每个点的重心坐标。然后，它使用重心坐标计算该点的联合 PDF。在计算完三角形上所有点的联合 PDF 后，绘制等高线。请注意，三角网格上的某些点可能稍微超出简单边界。这意味着该点的
    *x*₁+*x*₂+*x*₃ 可能稍微小于零或大于 1。将这样的点传递给 `dirichlet` 对象的 `pdf()` 方法会引发错误。因此，我们在 `cart_to_bc()`
    中裁剪重心坐标以避免此错误。
- en: '[PRE5]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Let's try `plot_contours()`. We first plot the contours of
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试 `plot_contours()`。我们首先绘制等高线
- en: '![](../Images/00f502b15f804340c982c11da81ccc1f.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/00f502b15f804340c982c11da81ccc1f.png)'
- en: As mentioned before, it is the same as the uniform distribution over its 2-d
    simplex since the joint PDF has the same value over the simplex. Listing 4 plots
    the contours of the joint PDF, and the resulting plot is shown in Figure 8.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，由于联合 PDF 在单纯形上具有相同的值，因此它与其 2D 单纯形上的均匀分布相同。列表 4 绘制了联合 PDF 的等高线，结果图如图 8 所示。
- en: '[PRE6]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/38963084896ec1105c15b27faccce308.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/38963084896ec1105c15b27faccce308.png)'
- en: Figure 8
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8
- en: As you see the joint PDF has the same value all over the simplex. Next, we plot
    the contours of
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，联合 PDF 在整个单纯形上具有相同的值。接下来，我们绘制等高线
- en: '![](../Images/35b339bbaa93837fff3e44c2effe8ae4.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/35b339bbaa93837fff3e44c2effe8ae4.png)'
- en: as our second example in Listing 5\. The result is shown in Figure 9.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 作为列表 5 中的第二个示例。结果如图 9 所示。
- en: '[PRE7]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/a7493ee0e421c84271d08d91d00124a8.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a7493ee0e421c84271d08d91d00124a8.png)'
- en: Figure 9
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9
- en: '**Effect of *α* on the joint PDF**'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '**影响 *α* 对联合 PDF 的影响**'
- en: We can also create a 3d plot of the surface of the joint PDF. Here we assume
    that the 2-d simplex is on the XY plane and the Z axis gives the value of the
    PDF. The function `plot_surface()` in Listing 6 generates such a plot.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以创建联合 PDF 表面的 3D 图。这里我们假设 2D 单纯形位于 XY 平面，Z 轴给出 PDF 的值。列表 6 中的函数`plot_surface()`生成这样的图。
- en: '[PRE8]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Listing 7 uses this function to plot the joint PDF of the Dirichlet distribution
    with some different parameters. The plots are shown in Figure 10.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 7 使用此函数绘制了具有不同参数的 Dirichlet 分布的联合 PDF。图形如图 10 所示。
- en: '[PRE9]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/618d3c48b4f154c6ea26dd59ecf4c888.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/618d3c48b4f154c6ea26dd59ecf4c888.png)'
- en: Figure 10
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10
- en: These plots can help you understand the effect of ***α*** on the shape of the
    joint PDF. The random variables *p*₁, *p*₂, and *p*₃ in ***P*** with a Dirichlet
    distribution can represent the probability of 3 mutually exclusive events. Hence,
    each edge of the simplex represents one of these events, and the corresponding
    *αᵢ* is like a weight for the likelihood of that event.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 这些图可以帮助您理解 ***α*** 对联合 PDF 形状的影响。具有 Dirichlet 分布的随机变量 *p*₁、*p*₂ 和 *p*₃ 可以表示
    3 个相互排斥事件的概率。因此，单纯形的每条边表示这些事件中的一个，相应的 *αᵢ* 就像是该事件发生概率的权重。
- en: As mentioned before ***α***=[1 1 1]ᵀ means that we have a uniform distribution
    over the simplex. Here, the value of PDF is 2 everywhere over the simplex, so
    the joint PDF has a flat surface. When *αᵢ* increases relative to other elements,
    it means that the *i*th event has a higher chance of occurrence since it has been
    observed more compared to other events (here we can assume that we start we Dir([1
    1 1]ᵀ) as the prior distribution). An example is the plot of Dir([1 7 1]ᵀ) in
    Figure 10\. Now the surface is raised near the edge of the simplex that represents
    that event.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，***α***=[1 1 1]ᵀ 意味着我们在单纯形上有均匀分布。这里，PDF 的值在单纯形上处处为 2，因此联合 PDF 具有平坦的表面。当
    *αᵢ* 相对于其他元素增加时，这意味着第 *i* 个事件发生的机会更高，因为与其他事件相比，它被观察得更多（这里我们可以假设我们从 Dir([1 1 1]ᵀ)
    作为先验分布开始）。一个例子是图 10 中 Dir([1 7 1]ᵀ) 的图形。现在，表面在单纯形的边缘附近升高，表示该事件。
- en: When the sum *α*₁+*α*₂+*α*₃ increases, it means that the total number of observations
    has increased. This will decrease our uncertainty about the distribution of ***P***
    and makes the joint PDF of the Dirichlet distribution look shaper. As you see
    in Figure 10, Dir([30 30 30]ᵀ) is much sharper compared to Dir([5 5 5]ᵀ). However,
    both look symmetric with respect to edges. Since all the events have been observed
    equally. When an *αᵢ* gets larger compared to others, the peak of the joint PDF
    moves towards the edge representing it. This is shown in Dir([5 5 30]ᵀ). Here
    the weight of the 3rd event (*α*₃) is greater which means that the 3rd event has
    been observed more, so it has a higher chance of occurrence.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 当总和*α*₁+*α*₂+*α*₃增加时，意味着观察的总数量增加了。这将减少我们对***P***的分布的不确定性，并使Dirichlet分布的联合PDF看起来更尖锐。正如你在图10中看到的，Dir([30
    30 30]ᵀ)相比Dir([5 5 5]ᵀ)要尖锐得多。然而，两者在边缘上看起来都是对称的。因为所有事件被观察的次数相同。当某个*αᵢ*相对于其他值变大时，联合PDF的峰值会向表示该事件的边缘移动。这在Dir([5
    5 30]ᵀ)中得到了体现。这里第三个事件的权重（*α*₃）较大，意味着第三个事件被观察得更多，因此发生的概率更高。
- en: Please note that all the elements of ***α*** should be greater than zero, so
    we can not assign a zero weight to an event. However, if we set *αᵢ*<1 then, the
    weight of the corresponding event significantly drops. This is shown in the plot
    of Dir([0.65 7 1]ᵀ) in Figure 10\. If you compare it with the plot of Dir([1 7
    1]ᵀ), you see that to have a nonzero PDF, the barycentric coordinate of *p*₁ should
    be very small. This is almost like having a 1-d simplex on *p*₂ and *p*₃.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，所有的***α***元素应大于零，因此我们不能给事件分配零权重。然而，如果我们设置*αᵢ*<1，则相应事件的权重会显著下降。这在图10中的Dir([0.65
    7 1]ᵀ)的图示中得到了体现。如果你将其与Dir([1 7 1]ᵀ)的图示进行比较，你会发现为了得到非零PDF，*p*₁的重心坐标应非常小。这几乎像在*p*₂和*p*₃上有一个1维的简单形体。
- en: Listing 8 plots the joint PDF of the Dirichlet distribution on a logarithmic
    scale (to better show the changes of the joint PDF surface). The result is shown
    in Figure 11.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8绘制了Dirichlet分布的联合PDF的对数尺度图（以更好地展示联合PDF表面的变化）。结果如图11所示。
- en: '[PRE10]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/27330f5767d38ee71d06e8a7b5cdf848.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/27330f5767d38ee71d06e8a7b5cdf848.png)'
- en: Figure 11
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 图11
- en: Note that when all *αᵢ* are less than 1, the joint PDF has a convex surface.
    The PDF is extremely small except at the edges and the sides of the triangular
    simplex. It is almost like having three 1-d simplexes at the sides of the triangle.
    Hence a prior with such a distribution represents a setup in which one or two
    *pᵢ* are extremely small, and their corresponding events have a small chance of
    occurrence.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，当所有*αᵢ*小于1时，联合PDF有一个凸面的表面。PDF在三角形简单形体的边缘和侧面几乎非常小。它几乎像在三角形的边上有三个1维的简单形体。因此，具有这种分布的先验表示一个设置，其中一个或两个*pᵢ*非常小，它们对应的事件发生的概率很小。
- en: By comparing Dir([0.2 0.2 0.2]ᵀ) with Dir([0.8 0.8 0.8]ᵀ), you notice that increasing
    the value of *αᵢ* tends to flatten the surface of the joint PDF. Hence, it decreases
    the value of the joint PDF on the edges and sides and increases its value in the
    regions closer to the middle of the simplex.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 通过比较Dir([0.2 0.2 0.2]ᵀ)和Dir([0.8 0.8 0.8]ᵀ)，你会发现增加*αᵢ*的值倾向于使联合PDF的表面变平。因此，它减少了边缘和侧面的联合PDF值，并增加了在简单形体中部区域的值。
- en: Finally, it is important to note that the parameters of the Dirichlet distribution
    can be also non-integers. But what is the meaning of say Dir([1.65 6 20]ᵀ)? Here,
    we can assign the fractional part of the parameters to the prior distribution.
    For example, we can write it as Dir([0.65+1 1+5 7+13]ᵀ). This means that we started
    with Dir([0.65 1 7]ᵀ) as the prior distribution (the joint PDF of Dir([0.65 1
    7]ᵀ) is shown in Figure 10). Choosing this prior distribution means that we initially
    believed that *p*₁ is almost zero, and its corresponding event is very unlikely
    to happen. Then we observed that the 1st event occurred only once, and the 2nd
    and 3rd events event occurred 5, and 13 times respectively. These numbers were
    added to the parameters of the prior distribution to form the posterior distribution.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，需要注意的是，Dirichlet分布的参数也可以是非整数的。但例如Dir([1.65 6 20]ᵀ)是什么意思呢？在这里，我们可以将参数的小数部分分配给先验分布。例如，我们可以将其写成Dir([0.65+1
    1+5 7+13]ᵀ)。这意味着我们从Dir([0.65 1 7]ᵀ)作为先验分布开始（Dir([0.65 1 7]ᵀ)的联合PDF如图10所示）。选择这个先验分布意味着我们最初认为*p*₁几乎为零，它对应的事件发生的可能性非常小。然后我们观察到第一个事件只发生了一次，而第二个和第三个事件分别发生了5次和13次。这些数字被加到先验分布的参数中，形成了后验分布。
- en: '**Bayesian inference in Python**'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python中的贝叶斯推断**'
- en: Now that we can plot the contours, we can use the Dirichlet distribution to
    infer the distribution of parameters of a multinomial distribution. Suppose that
    we have a 3-sided die (of course, it can be also a 6-sided die with only 3 labels
    (1, 2, and 3) where each label is placed on two faces). Let the probability of
    getting side *i* be *pᵢ*, and *Xᵢ* represents the total number of times that side
    *i* is observed (*i*=1..3). As mentioned before, the random vector
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以绘制轮廓图了，我们可以使用狄利克雷分布来推断多项式分布的参数分布。假设我们有一个3面的骰子（当然，它也可以是一个6面的骰子，只是上面有3个标签（1、2和3），每个标签出现在两个面上）。设获得面*i*的概率为*pᵢ*，*Xᵢ*表示观察到面*i*的总次数（*i*=1..3）。如前所述，随机向量
- en: '![](../Images/006a1af2819afa650680787c5c308e93.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/006a1af2819afa650680787c5c308e93.png)'
- en: has a multinomial distribution with parameters *n* and
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数*n*的多项式分布
- en: '![](../Images/d188b4d9b61ded8c5496e576d5c1a5c9.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d188b4d9b61ded8c5496e576d5c1a5c9.png)'
- en: 'Let the actual value of ***p*** be:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 设实际的***p***值为：
- en: '![](../Images/6453b087015e8994d484ff2684c9c0ae.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6453b087015e8994d484ff2684c9c0ae.png)'
- en: 'Hence, this is not a fair die! We can use the multinomial object in `scipy`
    to model this distribution. The following code snippet shows the result of rolling
    this die 10 times:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这不是一个公平的骰子！我们可以使用`scipy`中的多项式对象来建模这个分布。以下代码片段显示了掷这个骰子10次的结果：
- en: '[PRE11]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Hence if we roll it 10 times, we have the following observation:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果我们掷10次，我们会得到以下观察结果：
- en: 'Side 1: 6 times'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 面 1：6 次
- en: 'Side 2: 3 times'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 面 2：3 次
- en: 'Side 3: only 1 time'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 面 3：仅 1 次
- en: Of course, these are some random events, so if we change the `random_state`
    in `rvs()` , we can get a different observation (we fix the `random_state` to
    make this specific observation repeatable).
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，这些是一些随机事件，因此如果我们在`rvs()`中更改`random_state`，我们可以获得不同的观察结果（我们固定`random_state`以使这个特定的观察结果可重复）。
- en: Now suppose that we don’t have the probability of getting each side, so the
    actual value of the vector ***p*** (which was given in Equation 10) is unknown.
    However, we can still roll this die *n* times and observe the outcomes, therefore,
    we know the values of *Xᵢ*. If we assume that the unknown probability vector ***p***
    is represented by the random vector ***P***, we can use the Dirichlet distribution
    to infer the probability distribution of ***P*** after rolling the die.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 现在假设我们不知道每一面的概率，因此实际的向量***p***（如方程10所示）的值未知。然而，我们仍然可以掷这个骰子*n*次并观察结果，因此，我们知道*Xᵢ*的值。如果我们假设未知的概率向量***p***由随机向量***P***表示，我们可以使用狄利克雷分布来推断掷骰子后的***P***的概率分布。
- en: Listing 9 first generates the outcomes of rolling the die *n* times and stores
    it in *m*. Then it calculates *f_****P***|***X*** (***p***|***X***=***m***) which
    is the joint PDF of the posterior distribution and plots its contours on a 2-d
    simplex. We have tried 5 different values for *n* ranging from 3 to 10000, and
    the plots are shown in Figure 12\. We start with Dir([1 1 1]ᵀ) as the prior distribution
    for ***P***. So initially we have a uniform distribution for ***P*** in which
    different values of ***P*** are equally likely. Hence, we have the maximum uncertainty
    about ***P***.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9首先生成掷骰子*n*次的结果并存储在*m*中。然后计算*f_****P***|***X*** (***p***|***X***=***m***)，这是后验分布的联合PDF，并在二维简单形上绘制其轮廓。我们尝试了5个不同的*n*值，范围从3到10000，图12展示了这些图形。我们以Dir([1
    1 1]ᵀ)作为***P***的先验分布。因此，最初我们对***P***有均匀分布，其中不同的***P***值是同样可能的。因此，我们对***P***有最大的未知。
- en: The actual value of ***P*** (Equation 10) which was used to generate the observation
    data is shown with a white marker on these plots. As *n* increases, we get more
    observation data, and our uncertainty about ***P*** decreases. By increasing *n*,
    the Dirichlet distribution, which was initially uniform, gets sharper and closer
    to the white market that represents ***p_***act.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 用于生成观察数据的实际***P***值（方程10）在这些图中用白色标记显示。随着*n*的增加，我们获得了更多的观察数据，我们对***P***的未知性减少。通过增加*n*，狄利克雷分布从最初的均匀分布变得更加尖锐，并更接近表示***p_***act的白色标记。
- en: '[PRE13]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](../Images/e9b10068baa3d1ea19209ec0c842add6.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e9b10068baa3d1ea19209ec0c842add6.png)'
- en: Figure 12
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 图12
- en: '**Relation to beta distribution**'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '**与贝塔分布的关系**'
- en: Let the random vector
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 让随机向量
- en: '![](../Images/1d7b0906c55e7665b39555d37f684d66.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1d7b0906c55e7665b39555d37f684d66.png)'
- en: have a Dirichlet distribution with the parameter
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 具有参数的狄利克雷分布
- en: '![](../Images/1e404962725486e815990629ee7c36a0.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1e404962725486e815990629ee7c36a0.png)'
- en: 'Based on Equation 1, the joint PDF of ***X*** is:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 基于方程1，***X***的联合PDF是：
- en: '![](../Images/d3815b3d3ede2a05fbdc400a2841b1c2.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d3815b3d3ede2a05fbdc400a2841b1c2.png)'
- en: where
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/fef44e2b3afeba4ec60e4bcdd74cb58e.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fef44e2b3afeba4ec60e4bcdd74cb58e.png)'
- en: Since we have
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们有
- en: '![](../Images/1d44daabfec25c2808416b1e908b7a3c.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1d44daabfec25c2808416b1e908b7a3c.png)'
- en: 'We can remove *x*₂ from the PDF:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从 PDF 中去除 *x*₂：
- en: '![](../Images/3aabe4d4a829d12f9bf731017f1da34a.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3aabe4d4a829d12f9bf731017f1da34a.png)'
- en: 'As you see the joint PDF of *X*₁ and *X*₂ is only a function of *x*₁. Hence,
    the random vector ***X*** is determined by the single random variable *X*₁ which
    means that the right-hand side of the above equation is also the PDF of the random
    variable *X*₁. So, we can write:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，*X*₁ 和 *X*₂ 的联合 PDF 仅是 *x*₁ 的函数。因此，随机向量 ***X*** 由单一随机变量 *X*₁ 决定，这意味着上式右侧也是随机变量
    *X*₁ 的 PDF。所以，我们可以写成：
- en: '![](../Images/494efee0e0e6b51426f6f0f88ac722d0.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/494efee0e0e6b51426f6f0f88ac722d0.png)'
- en: 'A continuous random variable with such a PDF is said to have the *beta distribution*
    with parameters *α*₁ and *α*₂, and we denote it by *X*₁ ~ Beta(*α*₁, *α*₂). Similarly,
    we can write the PDF in terms of *x*₂:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 具有这种 PDF 的连续随机变量称为具有参数 *α*₁ 和 *α*₂ 的 *贝塔分布*，我们用 *X*₁ ~ Beta(*α*₁, *α*₂) 来表示。类似地，我们可以用
    *x*₂ 表达 PDF：
- en: '![](../Images/8ea15208fc8561125f3824fc5dd81bf7.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8ea15208fc8561125f3824fc5dd81bf7.png)'
- en: 'Hence, we conclude that *X*₂ ~ Beta(*α*₂, *α*₁), and we conclude that:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们得出结论 *X*₂ ~ Beta(*α*₂, *α*₁)，并得出：
- en: '![](../Images/01b7cb9281703d6911bf38e33978c074.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/01b7cb9281703d6911bf38e33978c074.png)'
- en: 'The distributions of *X*₁ and *X*₂ are called the *marginal distributions*
    of ***X***. The beta distribution is a special case of the Dirichlet distribution
    when ***α*** only has two elements and we only consider one of the random variables
    in ***X***. Hence it is a univariate distribution. Listing 10 plots the joint
    PDF of Dir([5 1]ᵀ) and the PDF of its marginal distributions: Beta(5,1) and Beta(1,5).
    The plots are shown in Figure 13.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '*X*₁ 和 *X*₂ 的分布被称为 ***X*** 的 *边际分布*。当 ***α*** 仅有两个元素，并且我们仅考虑 ***X*** 中的一个随机变量时，贝塔分布是狄利克雷分布的特例。因此，它是一个单变量分布。列表
    10 绘制了 Dir([5 1]ᵀ) 的联合 PDF 以及其边际分布的 PDF：Beta(5,1) 和 Beta(1,5)。这些图示见图 13。'
- en: '[PRE14]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![](../Images/a333cfe560f0d57eaa5d6912d0c7d235.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a333cfe560f0d57eaa5d6912d0c7d235.png)'
- en: Figure 13
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13
- en: Please note that the joint PDF of Dir([*α*₁ *α*₂]ᵀ) in Equation 11 is the same
    as the PDF of its marginal distribution (Beta(*α*₁, *α*₂)) in Equation 12\. However,
    they don’t represent the same distributions. The former is the joint PDF of the
    random vector ***X*** and the latter is the PDF of the random variable *X*₁. As
    Figure 13 shows the PDFs of the marginal distributions are the projection of the
    joint PDF on the planes formed by the axes (*x*₁, *f***ₓ**(***x***)), and (*x*₂,
    *f***ₓ**(***x***)).
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，方程 11 中 Dir([*α*₁ *α*₂]ᵀ) 的联合 PDF 与方程 12 中其边际分布 (Beta(*α*₁, *α*₂)) 的 PDF
    相同。然而，它们并不表示相同的分布。前者是随机向量 ***X*** 的联合 PDF，而后者是随机变量 *X*₁ 的 PDF。如图 13 所示，边际分布的 PDFs
    是联合 PDF 在由坐标轴 (*x*₁, *f***ₓ**(***x***)) 和 (*x*₂, *f***ₓ**(***x***)) 形成的平面上的投影。
- en: 'Remember that the multinomial distribution can be used to model a *k*-sided
    die. When *k*=2, the die turns into a coin. Now *X*₁ can represent the total number
    of heads in *n* tosses of this coin. Similarly, *X*₂ represents the total number
    of tails. From Equation 4, we have:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，多项分布可以用于建模一个 *k* 面的骰子。当 *k*=2 时，骰子变成了硬币。现在 *X*₁ 可以表示在 *n* 次掷硬币中的正面总数。类似地，*X*₂
    表示反面总数。从方程 4，我们得到：
- en: '![](../Images/b953fb14b1a9e4dcfd45f5f3d50698c7.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b953fb14b1a9e4dcfd45f5f3d50698c7.png)'
- en: 'Since *x*₁+*x*₂=*n*, *p*₁+*p*₂=1, we can eliminate *p*₂ and *x*₂ from the above
    equation:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 *x*₁+*x*₂=*n*，*p*₁+*p*₂=1，我们可以从上述方程中消去 *p*₂ 和 *x*₂：
- en: '![](../Images/5e5d0657e2e31d4029fb7e20a2c80681.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5e5d0657e2e31d4029fb7e20a2c80681.png)'
- en: 'Now the random vector ***X*** is determined by the single random variable *X*₁
    which means that the right-hand side of the above equation is also the PDF of
    the random variable *X*₁. Hence the PDF of *X*₁ can be written as:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 现在随机向量 ***X*** 由单一随机变量 *X*₁ 决定，这意味着上式右侧也是随机变量 *X*₁ 的 PDF。因此，*X*₁ 的 PDF 可以写成：
- en: '![](../Images/aa417c378753f5d0f2a9cfc60e55dbfa.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/aa417c378753f5d0f2a9cfc60e55dbfa.png)'
- en: This is the PDF of the binomial distribution. The binomial distribution is a
    special case of the multinomial distribution when the random vector ***X*** has
    only one element (it is the marginal distribution of the multinomial distribution).
    Hence *X*₁ has a binomial distribution with parameters *n* and *p*₁. Similarly,
    *X*₂ has a binomial distribution with parameters *n* and *p*₂.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 binomial 分布的 PDF。binomial 分布是 multinomial 分布的特例，当随机向量 ***X*** 只有一个元素时（即 multinomial
    分布的边际分布）。因此 *X*₁ 具有参数 *n* 和 *p*₁ 的 binomial 分布。类似地，*X*₂ 具有参数 *n* 和 *p*₂ 的 binomial
    分布。
- en: '![](../Images/b144aa46a282d81687a6c19d7e83b391.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b144aa46a282d81687a6c19d7e83b391.png)'
- en: Since the beta and binomial distributions are special cases of Dirichlet and
    multinomial distributions respectively, they are still conjugate distributions.
    In fact, the beta distribution is the conjugate prior to the binomial distribution
    as shown in Figure 14.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 beta 分布和 binomial 分布分别是 Dirichlet 和 multinomial 分布的特例，它们仍然是共轭分布。实际上，beta
    分布是 binomial 分布的共轭先验，如图 14 所示。
- en: '![](../Images/384afa084972c4929b7e63b3d2a52e46.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/384afa084972c4929b7e63b3d2a52e46.png)'
- en: Figure 14 (Image by author)
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14（作者提供的图片）
- en: Suppose that we have a coin that lands on heads with an unknown probability
    of *p*. Let the random variable *P* represents the unknown probability *p*, and
    the random variable *X* represents the total number of heads in *n* tosses. Let’s
    assume that the probability distribution of *P* is Beta(*a*, *b*) (this is our
    prior distribution). Now if we toss the coin *n* times and we observe that *X*=*k*,
    the posterior distribution of *P* is Beta(*a*+*k*, *b*+*n*-*k*).
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一枚硬币，其正面朝上的概率为未知的 *p*。令随机变量 *P* 表示未知的概率 *p*，随机变量 *X* 表示 *n* 次掷硬币中正面的总数。假设
    *P* 的概率分布是 Beta(*a*, *b*)（这是我们的先验分布）。现在如果我们掷硬币 *n* 次，观察到 *X*=*k*，则 *P* 的后验分布是
    Beta(*a*+*k*, *b*+*n*-*k*)。
- en: '**Aggregation property**'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**聚合性质**'
- en: 'Let the random vector ***X*** have the following Dirichlet distribution:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 令随机向量 ***X*** 具有以下 Dirichlet 分布：
- en: '![](../Images/c01df7da5e542888cdddacc80ba8bef7.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c01df7da5e542888cdddacc80ba8bef7.png)'
- en: 'We drop the random variables *Xᵢ* and *X_j* from ***X*** and add *Xᵢ*+*X_j*
    to it at an arbitrary place and call the resulting random vector ***X***’. It
    can be shown that ***X***’ has the following Dirichlet distribution:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从***X***中移除随机变量 *Xᵢ* 和 *X_j*，并将 *Xᵢ*+*X_j* 插入到任意位置，得到的结果随机向量称为 ***X***’。可以证明，***X***’
    具有以下 Dirichlet 分布：
- en: '![](../Images/0a3af6832911bcbe7cfdff6286447d5a.png)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0a3af6832911bcbe7cfdff6286447d5a.png)'
- en: So, to create the vector of parameters in the new Dirichlet distribution, first,
    we drop the corresponding parameters of *Xᵢ* and *X_j* (*αᵢ* and *α_j*), and then
    insert *αᵢ*+*α_j* at the same place that *Xᵢ* +*X_j* was inserted into ***X***
    (the index of *αᵢ*+*α_j* and *Xᵢ* +*X_j* are the same in their corresponding vectors).
    The proof of the aggregation property is given in the appendix.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了创建新 Dirichlet 分布中参数的向量，首先，我们移除 *Xᵢ* 和 *X_j* 对应的参数 (*αᵢ* 和 *α_j*)，然后在 *Xᵢ*
    +*X_j* 被插入到 ***X*** 的相同位置时，插入 *αᵢ*+*α_j*（*αᵢ*+*α_j* 和 *Xᵢ* +*X_j* 在它们对应的向量中的索引是相同的）。聚合性质的证明见附录。
- en: 'Let’s see an example. Let ***X*** ~ Dir([1 5 3]ᵀ). Using the aggregation property,
    we have:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 我们来看一个例子。设 ***X*** ~ Dir([1 5 3]ᵀ)。利用聚合性质，我们有：
- en: '![](../Images/a56d7908b6b8b0358b19e536a634fd13.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a56d7908b6b8b0358b19e536a634fd13.png)'
- en: Listing 11 plots the joint PDF of all these distributions together. The plot
    is in Figure 15\. In this plot, each aggregated random vector [*Xᵢ X_j*+*X_k*]ᵀ
    has 1-d simplex. Here, we assumed that this simplex is along the height of the
    triangle that passes through *Xᵢ.*
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 11 显示了所有这些分布的联合 PDF。该图如图 15 所示。在此图中，每个聚合随机向量 [*Xᵢ X_j*+*X_k*]ᵀ 具有 1 维单纯形。这里，我们假设该单纯形沿着经过
    *Xᵢ* 的三角形的高度。
- en: '[PRE15]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](../Images/adb1aa908a90f794e99ae6689e6859a4.png)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/adb1aa908a90f794e99ae6689e6859a4.png)'
- en: Figure 15
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15
- en: '**Marginal distributions**'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '**边际分布**'
- en: 'Now using the aggregation property, we can find the marginal distributions
    of Dirichlet distributions when ***X*** has more than 2 elements. Let ***X***
    have a Dirichlet distribution:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，利用聚合性质，当 ***X*** 具有超过 2 个元素时，我们可以找到 Dirichlet 分布的边际分布。令 ***X*** 具有 Dirichlet
    分布：
- en: '![](../Images/f69f4d5ce6c4530e1e7a31a50f93f631.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f69f4d5ce6c4530e1e7a31a50f93f631.png)'
- en: 'We can apply the aggregation property repeatedly on all the elements of ***X***
    except *X*₁, and we get:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以对除 *X*₁ 外的 ***X*** 中的所有元素重复应用聚合性质，得到：
- en: '![](../Images/2954ed5d02b7373ba26b1dc35541c2a1.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2954ed5d02b7373ba26b1dc35541c2a1.png)'
- en: We can write the previous equation as
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将前面的方程写成
- en: '![](../Images/a808ec15deceb36b937be9b498a6a63e.png)'
  id: totrans-245
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a808ec15deceb36b937be9b498a6a63e.png)'
- en: where
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/e10286164e5d097a6083200b8eccf504.png)'
  id: totrans-247
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e10286164e5d097a6083200b8eccf504.png)'
- en: 'More generally, we can write the same equation for each element of ***X***:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 更一般地，我们可以为每个元素***X***写出相同的方程：
- en: '![](../Images/4474d195428a34352a6319382657a0d0.png)'
  id: totrans-249
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4474d195428a34352a6319382657a0d0.png)'
- en: 'Hence, based on Equation 13, the marginal distribution of each *Xᵢ* is the
    following beta distribution:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，根据方程13，每个 *Xᵢ* 的边际分布是以下贝塔分布：
- en: '![](../Images/8cbd5254a569bfcbc4a32139b3ca89b1.png)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8cbd5254a569bfcbc4a32139b3ca89b1.png)'
- en: In this article, we reviewed the Dirichlet distribution. We showed that it is
    the conjugate prior to the multinomial distribution, and due to this important
    property, it can be used to infer the parameters of the multinomial distribution.
    We also showed how it can be modeled in Python and how we can visualize its joint
    PDF. Finally, we saw the connection between the beta and Dirichlet distributions
    and showed that the Dirichlet distribution is a generalization of the beta distribution
    to higher dimensions.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们回顾了狄利克雷分布。我们展示了它是多项分布的共轭先验，并且由于这一重要特性，它可以用来推断多项分布的参数。我们还展示了如何在 Python
    中对其进行建模以及如何可视化其联合 PDF。最后，我们看到贝塔分布和狄利克雷分布之间的联系，并展示了狄利克雷分布是贝塔分布在更高维度上的推广。
- en: 'I hope that you enjoyed reading this article. Please let me know if you have
    any questions or suggestions. All the Code Listings in this article are available
    for download as a Jupyter Notebook from GitHub at:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望你喜欢阅读这篇文章。如果你有任何问题或建议，请告诉我。本文中的所有代码清单可以从 GitHub 上以 Jupyter Notebook 形式下载，网址为：
- en: '[https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb](https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb)'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb](https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb)'

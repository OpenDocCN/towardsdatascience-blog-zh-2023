- en: Combine dbt Models Into a Single Target Table
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/combine-dbt-models-into-a-single-target-table-9873679ffd9b?source=collection_archive---------4-----------------------#2023-01-03](https://towardsdatascience.com/combine-dbt-models-into-a-single-target-table-9873679ffd9b?source=collection_archive---------4-----------------------#2023-01-03)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Tutorial covering 3 patterns and their trade-offs
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@jaypeterman?source=post_page-----9873679ffd9b--------------------------------)[![Jay
    Peterman](../Images/94587c88cb7981fa58fa8137d27b9588.png)](https://medium.com/@jaypeterman?source=post_page-----9873679ffd9b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----9873679ffd9b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----9873679ffd9b--------------------------------)
    [Jay Peterman](https://medium.com/@jaypeterman?source=post_page-----9873679ffd9b--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9731dc608e6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombine-dbt-models-into-a-single-target-table-9873679ffd9b&user=Jay+Peterman&userId=9731dc608e6c&source=post_page-9731dc608e6c----9873679ffd9b---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----9873679ffd9b--------------------------------)
    ·6 min read·Jan 3, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9873679ffd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombine-dbt-models-into-a-single-target-table-9873679ffd9b&user=Jay+Peterman&userId=9731dc608e6c&source=-----9873679ffd9b---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9873679ffd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombine-dbt-models-into-a-single-target-table-9873679ffd9b&source=-----9873679ffd9b---------------------bookmark_footer-----------)![](../Images/d7f8c181012add6ebd4d042b7666b54b.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: If you’re looking for a simple way to build analytics pipelines, dbt is likely
    on your radar. It’s tailored to empower data analyst/scientist to focus on their
    areas of expertise, and reduce their dependencies on data engineers.
  prefs: []
  type: TYPE_NORMAL
- en: 'I have noticed that newcomers to dbt often pose a common question: How do I
    load several dbt models with a common schema into a single target table? I will
    introduce a few patterns that can be adapted to different use cases, and discuss
    some of the trade-offs.'
  prefs: []
  type: TYPE_NORMAL
- en: The remainder of this tutorial assumes you already have dbt set up, and have
    some familiarity using the tool. Even if you don’t, I think you can extract some
    useful insights. This tutorial uses BigQuery.
  prefs: []
  type: TYPE_NORMAL
- en: Setting up the problem
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This will be a trivial example where we will combine 3 dbt models with a simple
    schema:'
  prefs: []
  type: TYPE_NORMAL
- en: 'To get started, we will created a new directory in `models` and name it `dbt-test`.
    Inside of `dbt-test` we will then create the following 4 files:'
  prefs: []
  type: TYPE_NORMAL
- en: '**table_1.sql**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE

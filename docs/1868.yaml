- en: 'Unbox the Cox: Intuitive Guide to Cox Regressions'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è§£é”Coxå›å½’ï¼šCoxå›å½’çš„ç›´è§‚æŒ‡å—
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/unbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d?source=collection_archive---------11-----------------------#2023-06-06](https://towardsdatascience.com/unbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d?source=collection_archive---------11-----------------------#2023-06-06)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/unbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d?source=collection_archive---------11-----------------------#2023-06-06](https://towardsdatascience.com/unbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d?source=collection_archive---------11-----------------------#2023-06-06)
- en: How do hazards and maximum likelihood estimates predict event rankings?
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é£é™©å’Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡å¦‚ä½•é¢„æµ‹äº‹ä»¶æ’åï¼Ÿ
- en: '[](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)[![Igor
    Å egota](../Images/17c592b71fef9526a0679d47937837f6.png)](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)
    [Igor Å egota](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)[![Igor
    Å egota](../Images/17c592b71fef9526a0679d47937837f6.png)](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)
    [Igor Å egota](https://medium.com/@igor-s?source=post_page-----c485408ae15d--------------------------------)'
- en: Â·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5f8ebca4ad8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&user=Igor+%C5%A0egota&userId=e5f8ebca4ad8&source=post_page-e5f8ebca4ad8----c485408ae15d---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)
    Â·10 min readÂ·Jun 6, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc485408ae15d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&user=Igor+%C5%A0egota&userId=e5f8ebca4ad8&source=-----c485408ae15d---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5f8ebca4ad8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&user=Igor+%C5%A0egota&userId=e5f8ebca4ad8&source=post_page-e5f8ebca4ad8----c485408ae15d---------------------post_header-----------)
    å‘è¡¨åœ¨[Towards Data Science](https://towardsdatascience.com/?source=post_page-----c485408ae15d--------------------------------)
    Â·10åˆ†é’Ÿé˜…è¯»Â·2023å¹´6æœˆ6æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc485408ae15d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&user=Igor+%C5%A0egota&userId=e5f8ebca4ad8&source=-----c485408ae15d---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc485408ae15d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&source=-----c485408ae15d---------------------bookmark_footer-----------)![](../Images/9eb4923328ea3ea068ceed2c39230ac5.png)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc485408ae15d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funbox-the-cox-intuitive-guide-to-cox-regressions-c485408ae15d&source=-----c485408ae15d---------------------bookmark_footer-----------)![](../Images/9eb4923328ea3ea068ceed2c39230ac5.png)'
- en: Photo by [Chris Boyer](https://unsplash.com/fr/@csgboyer?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±[Chris Boyer](https://unsplash.com/fr/@csgboyer?utm_source=medium&utm_medium=referral)æä¾›ï¼Œæ¥æºäº[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¼•è¨€
- en: The goal of Cox regression is to model the relationship between predictor variables
    and the time it takes for an event to happen â€” like events that only happen once.
    Letâ€™s dive into a made-up dataset with 5 subjects, labeled A to E. During the
    study, each subject either experienced an event (event = 1) or not (event = 0).
    On top of that, each subject got assigned a single predictor, letâ€™s call it *x*,
    before the study. As a practical example, if we are tracking the death events,
    then *x* could be the dosage of a drug we are testing to see if it helps people
    live longer, by affecting the time until death.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Cox å›å½’çš„ç›®æ ‡æ˜¯å»ºæ¨¡é¢„æµ‹å˜é‡ä¸äº‹ä»¶å‘ç”Ÿæ‰€éœ€æ—¶é—´ä¹‹é—´çš„å…³ç³»â€”â€”ä¾‹å¦‚åªå‘ç”Ÿä¸€æ¬¡çš„äº‹ä»¶ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè™šæ„çš„æ•°æ®é›†ï¼ŒåŒ…å«5ä¸ªå—è¯•è€…ï¼Œæ ‡è®°ä¸ºAåˆ°Eã€‚åœ¨ç ”ç©¶æœŸé—´ï¼Œæ¯ä¸ªå—è¯•è€…è¦ä¹ˆç»å†äº†äº‹ä»¶ï¼ˆäº‹ä»¶
    = 1ï¼‰ï¼Œè¦ä¹ˆæ²¡æœ‰ï¼ˆäº‹ä»¶ = 0ï¼‰ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªå—è¯•è€…åœ¨ç ”ç©¶å‰éƒ½è¢«åˆ†é…äº†ä¸€ä¸ªé¢„æµ‹å˜é‡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º *x*ã€‚ä½œä¸ºä¸€ä¸ªå®é™…ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è·Ÿè¸ªæ­»äº¡äº‹ä»¶ï¼Œé‚£ä¹ˆ *x*
    å¯èƒ½æ˜¯æˆ‘ä»¬æ­£åœ¨æµ‹è¯•çš„è¯ç‰©å‰‚é‡ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦é€šè¿‡å½±å“ç›´åˆ°æ­»äº¡çš„æ—¶é—´æ¥å¸®åŠ©äººä»¬æ´»å¾—æ›´ä¹…ã€‚
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/3fb26d1a5d08f6457756d77a06975e25.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3fb26d1a5d08f6457756d77a06975e25.png)'
- en: 'In this dataset, subject E did not experience anything during the study, so
    we set event = 0 and the time assigned is basically the last moment we knew about
    them. This kind of data is called â€œcensoredâ€ because we have no clue if the event
    happened after the study ended. To make it easier to understand, a cool â€œlollipopâ€
    ğŸ­ plot comes in handy for visualizing this type of data:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œå—è¯•è€…Eåœ¨ç ”ç©¶æœŸé—´æ²¡æœ‰ç»å†ä»»ä½•äº‹ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å°†äº‹ä»¶è®¾ç½®ä¸º0ï¼Œåˆ†é…çš„æ—¶é—´åŸºæœ¬ä¸Šæ˜¯æˆ‘ä»¬æœ€åä¸€æ¬¡çŸ¥é“ä»–ä»¬çš„æ—¶é—´ã€‚è¿™ç§æ•°æ®è¢«ç§°ä¸ºâ€œåˆ å¤±æ•°æ®â€ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“äº‹ä»¶æ˜¯å¦åœ¨ç ”ç©¶ç»“æŸåå‘ç”Ÿã€‚ä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œä½¿ç”¨ä¸€ä¸ªé…·ç‚«çš„â€œæ£’æ£’ç³–â€ğŸ­å›¾æ¥å¯è§†åŒ–è¿™ç§ç±»å‹çš„æ•°æ®éå¸¸æœ‰ç”¨ï¼š
- en: '[PRE1]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/96788e4368f5a669934f3b5990c8f847.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/96788e4368f5a669934f3b5990c8f847.png)'
- en: Lines indicate the duration of time each subject experienced before an event,
    which is represented by a filled circle. Subject E does not have a circle since
    it survived the entire study.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: çº¿æ¡è¡¨ç¤ºæ¯ä¸ªå—è¯•è€…åœ¨äº‹ä»¶å‘ç”Ÿä¹‹å‰ç»å†çš„æ—¶é—´ï¼Œäº‹ä»¶ç”±å¡«å……çš„åœ†åœˆè¡¨ç¤ºã€‚å—è¯•è€…Eæ²¡æœ‰åœ†åœˆï¼Œå› ä¸ºä»–åœ¨æ•´ä¸ªç ”ç©¶æœŸé—´éƒ½å­˜æ´»ã€‚
- en: (ï¸ï¸Plotting functions available on my [Github repo](https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py).)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: (ï¸ï¸ç»˜åˆ¶å‡½æ•°å¯ä»¥åœ¨æˆ‘çš„ [Github ä»“åº“](https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py)
    ä¸­æ‰¾åˆ°ã€‚)
- en: 'Just a heads up: I want to make the main ideas of Cox regression easier to
    grasp, so we will focus on data where only one event can happen at a given time
    (no ties).'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: æä¸ªé†’ï¼šæˆ‘å¸Œæœ›è®©Coxå›å½’çš„ä¸»è¦æ€æƒ³æ›´æ˜“äºç†è§£ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¸“æ³¨äºåœ¨ç»™å®šæ—¶é—´åªèƒ½å‘ç”Ÿä¸€ä¸ªäº‹ä»¶çš„æ•°æ®ï¼ˆæ²¡æœ‰å¹³å±€ï¼‰ã€‚
- en: Hazards
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å±é™©åº¦
- en: 'Hazard represents the instant rate (probability per unit time) at which an
    event can occur at a specific time â€” assuming the event has not occurred before
    that point. Since it is a rate at which events take place, it can have arbitrary
    units and unlike probability, hazard values can range between 0 and infinity:
    [0, âˆ).'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å±é™©åº¦è¡¨ç¤ºäº‹ä»¶åœ¨ç‰¹å®šæ—¶é—´ç‚¹å‘ç”Ÿçš„ç¬æ—¶ç‡ï¼ˆå•ä½æ—¶é—´å†…çš„æ¦‚ç‡ï¼‰â€”â€”å‡è®¾åœ¨æ­¤ä¹‹å‰äº‹ä»¶å°šæœªå‘ç”Ÿã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„é€Ÿç‡ï¼Œå®ƒå¯ä»¥å…·æœ‰ä»»æ„å•ä½ï¼Œä¸æ¦‚ç‡ä¸åŒï¼Œå±é™©åº¦å€¼å¯ä»¥åœ¨0åˆ°æ— ç©·å¤§ä¹‹é—´å˜åŒ–ï¼š[0,
    âˆ)ã€‚
- en: In Cox regression, hazard works similar to the odds in logistic regression.
    In logistic regression, odds = p/(1-p) takes probabilities from the range of [0,
    1] and transforms them to a range of [0, âˆ). Then, taking the logarithm converts
    the odds to log-odds, which can have values from negative infinity to positive
    infinity (-âˆ, âˆ). This log-odds transformation of probabilities is done to match
    the possible output values to the linear combination of predictors *Î²â‚xâ‚ + Î²â‚‚xâ‚‚
    + â€¦*, which also can range (-âˆ, âˆ).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨Coxå›å½’ä¸­ï¼Œå±é™©åº¦çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºé€»è¾‘å›å½’ä¸­çš„èµ”ç‡ã€‚åœ¨é€»è¾‘å›å½’ä¸­ï¼Œèµ”ç‡ = p/(1-p) å°†æ¦‚ç‡èŒƒå›´ [0, 1] è½¬æ¢ä¸º [0, âˆ) çš„èŒƒå›´ã€‚ç„¶åï¼Œå–å¯¹æ•°å°†èµ”ç‡è½¬æ¢ä¸ºå¯¹æ•°èµ”ç‡ï¼Œå…¶å€¼å¯ä»¥ä»è´Ÿæ— ç©·åˆ°æ­£æ— ç©·
    (-âˆ, âˆ)ã€‚è¿™ç§å¯¹æ•°èµ”ç‡çš„æ¦‚ç‡å˜æ¢æ˜¯ä¸ºäº†å°†å¯èƒ½çš„è¾“å‡ºå€¼ä¸é¢„æµ‹å˜é‡ *Î²â‚xâ‚ + Î²â‚‚xâ‚‚ + â€¦* çš„çº¿æ€§ç»„åˆåŒ¹é…ï¼Œåè€…çš„èŒƒå›´ä¹Ÿå¯ä»¥æ˜¯ (-âˆ, âˆ)ã€‚
- en: 'Here, we start with a hazard h(t, x) that already has values ranging from 0
    to infinity [0, âˆ). By applying a logarithm, we transform that range to (-âˆ, âˆ),
    allowing it to be fitted with a linear combination of predictors:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªå±é™©åº¦ h(t, x) å¼€å§‹ï¼Œå®ƒçš„å€¼èŒƒå›´å·²ç»æ˜¯ä»0åˆ°æ— ç©·å¤§ [0, âˆ)ã€‚é€šè¿‡åº”ç”¨å¯¹æ•°å˜æ¢ï¼Œæˆ‘ä»¬å°†è¯¥èŒƒå›´è½¬å˜ä¸º (-âˆ, âˆ)ï¼Œä»è€Œå…è®¸ç”¨é¢„æµ‹å˜é‡çš„çº¿æ€§ç»„åˆè¿›è¡Œæ‹Ÿåˆï¼š
- en: '![](../Images/fc0695bae7d071593adceb20df485e57.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fc0695bae7d071593adceb20df485e57.png)'
- en: 'In Cox regression, thereâ€™s another assumption that helps make things easier.
    It assumes that all the time dependence of the log-hazard is packed into the intercept
    term:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨Coxå›å½’ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªå‡è®¾æœ‰åŠ©äºç®€åŒ–é—®é¢˜ã€‚å®ƒå‡è®¾å¯¹æ•°å±é™©åº¦çš„æ‰€æœ‰æ—¶é—´ä¾èµ–æ€§éƒ½åŒ…å«åœ¨æˆªè·é¡¹ä¸­ï¼š
- en: '![](../Images/531233308f98f878371c83f7fcb1115d.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/531233308f98f878371c83f7fcb1115d.png)'
- en: 'The motivation behind this assumption is to simplify the fitting process significantly
    (we will show how in a moment). In the literature, the intercept term *Î²â‚€(t)*
    is usually moved to the left side of this equation and expressed as a *baseline
    hazard* *log[hâ‚€(t)]*:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸€å‡è®¾çš„åŠ¨æœºæ˜¯ä¸ºäº†æ˜¾è‘—ç®€åŒ–æ‹Ÿåˆè¿‡ç¨‹ï¼ˆæˆ‘ä»¬ç¨åå°†å±•ç¤ºå…·ä½“æ–¹æ³•ï¼‰ã€‚åœ¨æ–‡çŒ®ä¸­ï¼Œæˆªè·é¡¹ *Î²â‚€(t)* é€šå¸¸è¢«ç§»åˆ°æ–¹ç¨‹çš„å·¦ä¾§ï¼Œå¹¶è¡¨ç¤ºä¸º *åŸºçº¿é£é™©* *log[hâ‚€(t)]*ï¼š
- en: '![](../Images/4f5424d6048b6c1fed45d84545dadf02.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4f5424d6048b6c1fed45d84545dadf02.png)'
- en: 'From this equation, we can expressed the hazard *h(t, x)*:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¿™ä¸ªæ–¹ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºé£é™© *h(t, x)*ï¼š
- en: '![](../Images/f3954fe815dc8cd628e927d940715235.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f3954fe815dc8cd628e927d940715235.png)'
- en: 'Now, here is the cool part: since the data from each subject only comes to
    hazard through predictors *x*, every subjectâ€™s hazard has the same time dependence.
    The only difference lies in the *exp(Î²x)* part, which makes hazards from different
    subjects proportional to each other. Thatâ€™s why this model is also called a â€œproportional
    hazardâ€ model.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè¿™é‡Œæ˜¯æœ‰è¶£çš„éƒ¨åˆ†ï¼šç”±äºæ¯ä¸ªè¢«è¯•çš„æ•°æ®é€šè¿‡é¢„æµ‹å˜é‡ *x* ä»…å½±å“é£é™©ï¼Œå› æ­¤æ¯ä¸ªè¢«è¯•çš„é£é™©å…·æœ‰ç›¸åŒçš„æ—¶é—´ä¾èµ–æ€§ã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äº *exp(Î²x)*
    éƒ¨åˆ†ï¼Œè¿™ä½¿å¾—æ¥è‡ªä¸åŒè¢«è¯•çš„é£é™©ç›¸äº’æˆæ¯”ä¾‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªæ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºâ€œæ¯”ä¾‹é£é™©â€æ¨¡å‹ã€‚
- en: 'We have been drawing a lot of parallels to the logistic regression. If you
    read my previous post on logistic regression:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å·²ç»å°†å¾ˆå¤šé€»è¾‘å›å½’çš„ç±»æ¯”æåŠäº†ã€‚å¦‚æœä½ é˜…è¯»äº†æˆ‘ä¹‹å‰å…³äºé€»è¾‘å›å½’çš„å¸–å­ï¼š
- en: '[](/logistic-regression-faceoff-67560de4f492?source=post_page-----c485408ae15d--------------------------------)
    [## Logistic regression: Faceoff'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/logistic-regression-faceoff-67560de4f492?source=post_page-----c485408ae15d--------------------------------)
    [## é€»è¾‘å›å½’ï¼šå¯¹å†³'
- en: What do log-losses and perfectly separated data have to do with hockey sticks?
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¯¹æ•°æŸå¤±å’Œå®Œå…¨åˆ†ç¦»çš„æ•°æ®ä¸æ›²æ£çƒæ£’æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ
- en: towardsdatascience.com](/logistic-regression-faceoff-67560de4f492?source=post_page-----c485408ae15d--------------------------------)
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/logistic-regression-faceoff-67560de4f492?source=post_page-----c485408ae15d--------------------------------)
- en: you may be wondering if Cox regression also suffers from predictors being â€œtoo
    goodâ€. Stay tuned for the next post which will cover that!
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ Cox å›å½’æ˜¯å¦ä¹Ÿä¼šå—åˆ°é¢„æµ‹å˜é‡â€œè¿‡äºä¼˜ç§€â€çš„å½±å“ã€‚è¯·ç»§ç»­å…³æ³¨ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†è®¨è®ºè¿™ä¸€ç‚¹ï¼
- en: Likelihoods
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¯èƒ½æ€§
- en: 'Cox models are fit using a method called Maximum Likelihood Estimation (MLE).
    Likelihoods are quite similar to probabilities: they share the same equation â€”
    almost like two sides of the same coin. Probabilities are functions of data *x*,
    with fixed model parameters *Î²*s, while likelihoods are functions of *Î²*s, with
    fixed *x*. Itâ€˜s like looking at the probability density of a Normal distribution,
    but instead of focusing on *x*, we focus on *Î¼* and *Ïƒ*.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: Cox æ¨¡å‹ä½¿ç”¨ä¸€ç§ç§°ä¸ºæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMLEï¼‰çš„æ–¹æ³•è¿›è¡Œæ‹Ÿåˆã€‚å¯èƒ½æ€§ä¸æ¦‚ç‡éå¸¸ç›¸ä¼¼ï¼šå®ƒä»¬å…±äº«ç›¸åŒçš„æ–¹ç¨‹â€”â€”å‡ ä¹å°±åƒæ˜¯åŒä¸€æšç¡¬å¸çš„ä¸¤é¢ã€‚æ¦‚ç‡æ˜¯æ•°æ® *x*
    çš„å‡½æ•°ï¼Œæ¨¡å‹å‚æ•° *Î²* å›ºå®šï¼Œè€Œå¯èƒ½æ€§æ˜¯ *Î²* çš„å‡½æ•°ï¼Œ*x* å›ºå®šã€‚è¿™å°±åƒæ˜¯æŸ¥çœ‹æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ï¼Œä½†ä¸æ˜¯å…³æ³¨ *x*ï¼Œè€Œæ˜¯å…³æ³¨ *Î¼* å’Œ *Ïƒ*ã€‚
- en: 'The MLE fitting process begins with a rank-order of event occurrence. In our
    made-up data this order is: A, B, D, C, with E censored. This is the only instance
    where time comes into play in Cox regression. **The actual numeric values of event
    times do not matter at all, as long as the subjects experience the events in the
    same order.**'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: MLE æ‹Ÿåˆè¿‡ç¨‹å§‹äºäº‹ä»¶å‘ç”Ÿçš„æ’åºã€‚åœ¨æˆ‘ä»¬ç¼–é€ çš„æ•°æ®ä¸­ï¼Œè¿™ä¸ªé¡ºåºæ˜¯ï¼šAã€Bã€Dã€Cï¼ŒE ä¸ºåˆ å¤±ã€‚è¿™æ˜¯ Cox å›å½’ä¸­å”¯ä¸€æ¶‰åŠæ—¶é—´çš„æƒ…å†µã€‚**äº‹ä»¶æ—¶é—´çš„å®é™…æ•°å€¼å®Œå…¨ä¸é‡è¦ï¼Œåªè¦è¢«è¯•ç»å†äº‹ä»¶çš„é¡ºåºç›¸åŒã€‚**
- en: 'We then move on to each subject one by one and estimate the probability or
    likelihood of that subject experiencing an event compared to all the other subjects
    who are *still at risk* of having an event. For instance, take subject A who experienced
    an event at t = 1\. The likelihood of this happening is determined by the hazard
    rate at which subject A experiences the event, relative to the combined hazard
    rates of everyone else who is still at risk at t = 1 (which includes everyone):'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬é€ä¸ªå¤„ç†æ¯ä¸ªè¢«è¯•ï¼Œå¹¶ä¼°è®¡è¯¥è¢«è¯•ç»å†äº‹ä»¶çš„æ¦‚ç‡æˆ–å¯èƒ½æ€§ï¼Œç›¸å¯¹äºæ‰€æœ‰å…¶ä»–ä»å¤„äº *é£é™©ä¹‹ä¸­çš„* è¢«è¯•ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘è¢«è¯• Aï¼Œåœ¨ t = 1 æ—¶ç»å†äº†äº‹ä»¶ã€‚è¿™ä¸€äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ç”±è¢«è¯•
    A ç»å†äº‹ä»¶çš„é£é™©ç‡å†³å®šï¼Œç›¸å¯¹äº t = 1 æ—¶æ‰€æœ‰å…¶ä»–ä»å¤„äºé£é™©ä¸­çš„äººçš„ç»¼åˆé£é™©ç‡ï¼ˆåŒ…æ‹¬æ‰€æœ‰äººï¼‰ï¼š
- en: '![](../Images/22bde743e454b44530da2e6409211ca6.png)![](../Images/54b824e014a5d03c06363b78f76dccc3.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/22bde743e454b44530da2e6409211ca6.png)![](../Images/54b824e014a5d03c06363b78f76dccc3.png)'
- en: As you may have noticed, we did not bother defining the baseline hazard *hâ‚€(t)*
    because it actually cancels out completely from the likelihood calculation.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚ä½ æ‰€æ³¨æ„åˆ°çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰å®šä¹‰åŸºçº¿é£é™© *hâ‚€(t)*ï¼Œå› ä¸ºå®ƒå®é™…ä¸Šåœ¨å¯èƒ½æ€§è®¡ç®—ä¸­å®Œå…¨æŠµæ¶ˆäº†ã€‚
- en: 'Once we substitute the values for *x* (-1.7, -0.4, 0.0, 0.9, 1.2) for each
    subject, we end up with an equation that only has *Î²* left:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬ä¸ºæ¯ä¸ªä¸»é¢˜ä»£å…¥å€¼ *x*ï¼ˆ-1.7ã€-0.4ã€0.0ã€0.9ã€1.2ï¼‰ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªä»…å‰©ä¸‹ *Î²* çš„æ–¹ç¨‹ï¼š
- en: '![](../Images/879d7ce7c23fe47b1fa333f0162c8f52.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/879d7ce7c23fe47b1fa333f0162c8f52.png)'
- en: 'From this point on, for any time after t = 1, the hazard of subject A is considered
    zero and is not taken into account when calculating further likelihoods. For instance,
    at another time, t = 3, subject B experiences an event. So, the likelihood for
    subject B is determined relative to the hazards of subjects B through E only:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¿™ä¸€ç‚¹èµ·ï¼Œåœ¨ t = 1 ä¹‹åçš„ä»»ä½•æ—¶é—´ï¼Œä¸»é¢˜ A çš„é£é™©è¢«è®¤ä¸ºæ˜¯é›¶ï¼Œå¹¶ä¸”åœ¨è®¡ç®—è¿›ä¸€æ­¥çš„ä¼¼ç„¶å€¼æ—¶ä¸ä¼šè€ƒè™‘ã€‚ä¾‹å¦‚ï¼Œåœ¨å¦ä¸€ä¸ªæ—¶é—´ t = 3ï¼Œä¸»é¢˜ B å‘ç”Ÿäº†äº‹ä»¶ã€‚å› æ­¤ï¼Œä¸»é¢˜
    B çš„ä¼¼ç„¶å€¼æ˜¯ç›¸å¯¹äºä¸»é¢˜ B åˆ° E çš„é£é™©æ¥ç¡®å®šçš„ï¼š
- en: '![](../Images/3faac948b82115b83c1d3cc217e6d64c.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3faac948b82115b83c1d3cc217e6d64c.png)'
- en: We could keep going and calculate the likelihoods for all subjects A through
    D, but we will cover that in the coding part in the next section. Subject E, being
    censored and not experiencing an event does not have its own likelihood. Since
    the censored data is only used in the likelihoods of uncensored subjects, the
    resulting combined likelihood is often referred to as â€œpartial likelihoodâ€.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ç»§ç»­è®¡ç®—æ‰€æœ‰ä¸»é¢˜ A åˆ° D çš„ä¼¼ç„¶å€¼ï¼Œä½†è¿™å°†åœ¨ä¸‹ä¸€éƒ¨åˆ†çš„ç¼–ç ä¸­è¿›è¡Œã€‚ç”±äºä¸»é¢˜ E æ˜¯è¢«å®¡æŸ¥çš„ä¸”æœªå‘ç”Ÿäº‹ä»¶ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰è‡ªå·±çš„ä¼¼ç„¶å€¼ã€‚ç”±äºå®¡æŸ¥æ•°æ®ä»…ç”¨äºæœªå®¡æŸ¥ä¸»é¢˜çš„ä¼¼ç„¶å€¼ä¸­ï¼Œå› æ­¤ç»“æœç»„åˆçš„ä¼¼ç„¶å€¼é€šå¸¸è¢«ç§°ä¸ºâ€œéƒ¨åˆ†ä¼¼ç„¶â€ã€‚
- en: 'To summarize this process, we can create an animated lollipop plot:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ€»ç»“è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŠ¨ç”»æ£’æ£’ç³–å›¾ï¼š
- en: '[PRE2]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/5a032e3aeb7bd02f84175c9d0adcdff6.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5a032e3aeb7bd02f84175c9d0adcdff6.png)'
- en: Finding Î²
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æŸ¥æ‰¾ Î²
- en: 'When events occur independently of each other, the joint probability or likelihood
    of observing all events can be calculated by multiplying individual likelihoods,
    denoted as *L= L(A) L(B) L(C) L(D)*. However, multiplying exponential expressions
    can lead to numerical errors, so we often take the logarithm of this likelihood.
    By applying the logarithm, we transform the product of likelihoods into a sum
    of log-likelihoods:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: å½“äº‹ä»¶å½¼æ­¤ç‹¬ç«‹å‘ç”Ÿæ—¶ï¼Œè§‚å¯Ÿæ‰€æœ‰äº‹ä»¶çš„è”åˆæ¦‚ç‡æˆ–ä¼¼ç„¶å€¼å¯ä»¥é€šè¿‡ä¹˜ä»¥å„ä¸ªä¼¼ç„¶å€¼æ¥è®¡ç®—ï¼Œè¡¨ç¤ºä¸º *L= L(A) L(B) L(C) L(D)*ã€‚ç„¶è€Œï¼Œä¹˜æ³•çš„æŒ‡æ•°è¡¨è¾¾å¼å¯èƒ½å¯¼è‡´æ•°å€¼è¯¯å·®ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸å–è¯¥ä¼¼ç„¶å€¼çš„å¯¹æ•°ã€‚é€šè¿‡åº”ç”¨å¯¹æ•°ï¼Œæˆ‘ä»¬å°†ä¼¼ç„¶å€¼çš„ä¹˜ç§¯è½¬æ¢ä¸ºå¯¹æ•°ä¼¼ç„¶å€¼çš„æ€»å’Œï¼š
- en: '![](../Images/d69effc0790722ed973c9fbc57e3dbf8.png)![](../Images/b1eb9b567f2776034ddfcd328389df9f.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d69effc0790722ed973c9fbc57e3dbf8.png)![](../Images/b1eb9b567f2776034ddfcd328389df9f.png)'
- en: Since the logarithm is a monotonic function, both the likelihood and the log-likelihood
    reach their maximum point at the same value of *Î²*. To facilitate visualization
    and enable comparison with other cost functions, we can define a cost as the negative
    log-likelihood and aim to minimize it instead.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºå¯¹æ•°æ˜¯å•è°ƒå‡½æ•°ï¼Œä¼¼ç„¶å€¼å’Œå¯¹æ•°ä¼¼ç„¶å€¼åœ¨ç›¸åŒçš„ *Î²* å€¼ä¸‹è¾¾åˆ°æœ€å¤§å€¼ã€‚ä¸ºäº†ä¾¿äºå¯è§†åŒ–å’Œä¸å…¶ä»–æˆæœ¬å‡½æ•°è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆæœ¬å®šä¹‰ä¸ºè´Ÿå¯¹æ•°ä¼¼ç„¶å€¼ï¼Œå¹¶æ—¨åœ¨æœ€å°åŒ–å®ƒã€‚
- en: Ready, Set, Code!
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å‡†å¤‡å¥½ï¼Œå¼€å§‹ç¼–ç ï¼
- en: 'We can implement this algorithm in Python, step by step. First, we need to
    extract the event time and predictor *x* for each uncensored subject. This can
    be accomplished using the function `event_time_and_x_from_subject()`. Once we
    have the event time for a subject, we can subset our data frame to identify the
    rows corresponding to all subjects who are still at risk. This is achieved using
    the function `subjects_at_risk_data()`. Finally, we calculate the log-likelihood
    for each subject using the function `log_likelihood()`:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€æ­¥åœ¨ Python ä¸­å®ç°è¿™ä¸ªç®—æ³•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æå–æ¯ä¸ªæœªå®¡æŸ¥ä¸»é¢˜çš„äº‹ä»¶æ—¶é—´å’Œé¢„æµ‹å˜é‡ *x*ã€‚è¿™å¯ä»¥é€šè¿‡å‡½æ•° `event_time_and_x_from_subject()`
    å®Œæˆã€‚ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°ä¸»é¢˜çš„äº‹ä»¶æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®æ¡†è¿›è¡Œå­é›†å¤„ç†ï¼Œä»¥è¯†åˆ«æ‰€æœ‰ä»åœ¨é£é™©ä¸­çš„ä¸»é¢˜çš„è¡Œã€‚è¿™æ˜¯é€šè¿‡å‡½æ•° `subjects_at_risk_data()`
    å®ç°çš„ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•° `log_likelihood()` è®¡ç®—æ¯ä¸ªä¸»é¢˜çš„å¯¹æ•°ä¼¼ç„¶å€¼ï¼š
- en: '[PRE3]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'For visualization purposes, we plot the cost or negative log-likelihoods. Therefore,
    we need to compute these values for each subject at a specific *Î²* value:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¯è§†åŒ–ï¼Œæˆ‘ä»¬ç»˜åˆ¶æˆæœ¬æˆ–è´Ÿå¯¹æ•°ä¼¼ç„¶å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸ªä¸»é¢˜åœ¨ç‰¹å®š *Î²* å€¼ä¸‹çš„è¿™äº›å€¼ï¼š
- en: '[PRE4]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To find the minimum cost, we sweep through the range of *Î²* values:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ‰¾åˆ°æœ€å°æˆæœ¬ï¼Œæˆ‘ä»¬éå† *Î²* å€¼çš„èŒƒå›´ï¼š
- en: '[PRE5]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/c8e55f4725d681c1cc1c6e001ac32640.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c8e55f4725d681c1cc1c6e001ac32640.png)'
- en: Making sense of it all
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç†è§£è¿™ä¸€åˆ‡
- en: 'Rather than aggregating the data frame by summing the log-likelihoods grouped
    by subject, we can keep it in its current form and visualize it as stacked bar
    charts. In this visualization, the total height of each bar corresponds to the
    sum of negative log-likelihoods. Each subject is represented by a different color
    within the bar, indicating their individual likelihood and contribution to the
    overall likelihood:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸å…¶é€šè¿‡æŒ‰å—è¯•è€…åˆ†ç»„çš„å¯¹æ•°ä¼¼ç„¶åº¦æ±‚å’Œæ¥èšåˆæ•°æ®æ¡†ï¼Œä¸å¦‚ä¿æŒå…¶å½“å‰å½¢å¼å¹¶å°†å…¶å¯è§†åŒ–ä¸ºå †å æ¡å½¢å›¾ã€‚åœ¨è¿™ä¸ªå¯è§†åŒ–ä¸­ï¼Œæ¯ä¸ªæ¡å½¢å›¾çš„æ€»é«˜åº¦å¯¹åº”äºè´Ÿå¯¹æ•°ä¼¼ç„¶åº¦çš„æ€»å’Œã€‚æ¯ä¸ªå—è¯•è€…åœ¨æ¡å½¢å›¾ä¸­ç”¨ä¸åŒçš„é¢œè‰²è¡¨ç¤ºï¼ŒæŒ‡ç¤ºä»–ä»¬çš„ä¸ªä½“ä¼¼ç„¶åº¦åŠå…¶å¯¹æ•´ä½“ä¼¼ç„¶åº¦çš„è´¡çŒ®ï¼š
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/80e3ddfac00be7575824dad21f243b1d.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/80e3ddfac00be7575824dad21f243b1d.png)'
- en: Each narrow vertical colored bar represents the individual negative log-likelihood.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªç‹­çª„çš„å‚ç›´å½©è‰²æ¡è¡¨ç¤ºä¸ªä½“è´Ÿå¯¹æ•°ä¼¼ç„¶åº¦ã€‚
- en: Letâ€™s understand how to interpret this plot.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹å¦‚ä½•è§£è¯»è¿™ä¸ªå›¾ã€‚
- en: First, note that the negative log-likelihood (cost) is large when the likelihood
    and hazards are small. Think of the y-axis similar to -log(p-value); larger values
    indicate lower probability.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæ³¨æ„åˆ°å½“ä¼¼ç„¶åº¦å’Œå±é™©åº¦å¾ˆå°æ—¶ï¼Œè´Ÿå¯¹æ•°ä¼¼ç„¶åº¦ï¼ˆæˆæœ¬ï¼‰å¾ˆå¤§ã€‚å¯ä»¥å°† y è½´è§†ä¸º -log(p-value)ï¼›è¾ƒå¤§çš„å€¼è¡¨ç¤ºè¾ƒä½çš„æ¦‚ç‡ã€‚
- en: Second, censored subjects (like subject E) do not have their own individual
    likelihoods, so they donâ€™t appear on the plot. However, their contribution is
    incorporated into the likelihoods of subjects A to D.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶æ¬¡ï¼Œè¢«å®¡æŸ¥çš„å—è¯•è€…ï¼ˆå¦‚å—è¯•è€… Eï¼‰æ²¡æœ‰è‡ªå·±å•ç‹¬çš„ä¼¼ç„¶åº¦ï¼Œå› æ­¤å®ƒä»¬æ²¡æœ‰å‡ºç°åœ¨å›¾ä¸­ã€‚ç„¶è€Œï¼Œå®ƒä»¬çš„è´¡çŒ®è¢«çº³å…¥äº†å—è¯•è€… A åˆ° D çš„ä¼¼ç„¶åº¦ä¸­ã€‚
- en: 'Now, consider different scenarios based on the value of *Î²*:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè€ƒè™‘åŸºäº *Î²* å€¼çš„ä¸åŒåœºæ™¯ï¼š
- en: If *Î²* is large and negative, subjects A, B, and C (with *x â‰¤ 0*) and their
    events are fitted nearly perfectly. The likelihoods of these subjects are all
    close to one. However, fitting such large negative *Î²* values for A, B, and C
    comes at the cost of subject D. In this range of *Î²*, the probability of subject
    D (with *x > 0*) having an event is very low. As a result, the total cost is dominated
    by the small likelihood of subject D.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœ*Î²*å¾ˆå¤§ä¸”ä¸ºè´Ÿæ•°ï¼Œå—è¯•è€… Aã€B å’Œ Cï¼ˆ*x â‰¤ 0*ï¼‰åŠå…¶äº‹ä»¶å‡ ä¹å®Œç¾æ‹Ÿåˆã€‚è¿™äº›å—è¯•è€…çš„ä¼¼ç„¶åº¦éƒ½æ¥è¿‘äºä¸€ã€‚ç„¶è€Œï¼Œç»™ Aã€B å’Œ C æ‹Ÿåˆå¦‚æ­¤å¤§çš„è´Ÿ
    *Î²* å€¼çš„ä»£ä»·æ˜¯å—è¯•è€… Dã€‚åœ¨è¿™ä¸ª *Î²* èŒƒå›´å†…ï¼Œå—è¯•è€… Dï¼ˆ*x > 0*ï¼‰å‘ç”Ÿäº‹ä»¶çš„æ¦‚ç‡éå¸¸ä½ã€‚å› æ­¤ï¼Œæ€»æˆæœ¬ç”±å—è¯•è€… D çš„å°ä¼¼ç„¶åº¦ä¸»å¯¼ã€‚
- en: If *Î²* is large and positive, the hazard of subject D (with *x > 0*) becomes
    significant compared to the other hazards. The purple section (subject D) becomes
    a small part of the total cost. However, since subjects A, B, and C all have *x
    â‰¤ 0*, the cost of fitting a large *Î²* for them is high. Consequently, these subjects
    dominate the total cost.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœ *Î²* å¾ˆå¤§ä¸”ä¸ºæ­£ï¼Œå—è¯•è€… Dï¼ˆ*x > 0*ï¼‰çš„å±é™©åº¦ç›¸è¾ƒäºå…¶ä»–å±é™©åº¦å˜å¾—æ˜¾è‘—ã€‚ç´«è‰²éƒ¨åˆ†ï¼ˆå—è¯•è€… Dï¼‰æˆä¸ºæ€»æˆæœ¬çš„ä¸€å°éƒ¨åˆ†ã€‚ç„¶è€Œï¼Œç”±äºå—è¯•è€… Aã€B
    å’Œ C éƒ½æœ‰ *x â‰¤ 0*ï¼Œå› æ­¤ç»™ä»–ä»¬æ‹Ÿåˆä¸€ä¸ªå¤§ *Î²* çš„æˆæœ¬å¾ˆé«˜ã€‚å› æ­¤ï¼Œè¿™äº›å—è¯•è€…ä¸»å¯¼äº†æ€»æˆæœ¬ã€‚
- en: 'The optimal value of Î², located around 2 on the plot, strikes a balance between
    assigning high probabilities to events of subjects A, B, and C versus subject
    D. This optimal value can be verified numerically:'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½äºå›¾ä¸Šçº¦ 2 çš„ *Î²* çš„æœ€ä½³å€¼åœ¨ä¸ºå—è¯•è€… Aã€B å’Œ C äº‹ä»¶åˆ†é…é«˜æ¦‚ç‡ä¸å—è¯•è€… D ä¹‹é—´å–å¾—äº†å¹³è¡¡ã€‚è¿™ä¸ªæœ€ä½³å€¼å¯ä»¥é€šè¿‡æ•°å€¼æ–¹æ³•éªŒè¯ï¼š
- en: '[PRE7]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/5409dfe3fd3f2e8624ef9b997747366f.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5409dfe3fd3f2e8624ef9b997747366f.png)'
- en: Using lifelines library
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ lifelines åº“
- en: 'Now that we have a better understanding of how Cox regression works, we can
    apply it to sample data using Pythonâ€™s lifelines library to verify the results.
    Here is a code snippet for our made-up data:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯¹ Cox å›å½’æœ‰äº†æ›´å¥½çš„ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python çš„ lifelines åº“å°†å…¶åº”ç”¨äºæ ·æœ¬æ•°æ®ä»¥éªŒè¯ç»“æœã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬è™šæ„æ•°æ®çš„ä»£ç ç‰‡æ®µï¼š
- en: '[PRE8]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/80353e673eb6a541c755657f79ded4f9.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/80353e673eb6a541c755657f79ded4f9.png)'
- en: In the output, we can observe the coefficient (coef) value of -1.71, which corresponds
    to the Î² coefficient. Next to it, we have exp(coef), representing exp(Î²), as well
    as columns indicating standard errors and confidence intervals. The â€œpartial log-likelihoodâ€
    value is -2.64, which matches our manual result.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ° -1.71 çš„ç³»æ•°ï¼ˆcoefï¼‰å€¼ï¼Œå®ƒå¯¹åº”äº *Î²* ç³»æ•°ã€‚å®ƒæ—è¾¹çš„æ˜¯ exp(coef)ï¼Œè¡¨ç¤º exp(Î²)ï¼Œè¿˜æœ‰è¡¨ç¤ºæ ‡å‡†è¯¯å·®å’Œç½®ä¿¡åŒºé—´çš„åˆ—ã€‚â€œéƒ¨åˆ†å¯¹æ•°ä¼¼ç„¶åº¦â€å€¼ä¸º
    -2.64ï¼Œè¿™ä¸æˆ‘ä»¬çš„æ‰‹åŠ¨ç»“æœç›¸åŒ¹é…ã€‚
- en: Lastly, it is important to mention that Cox regression implementations also
    offer an extension that allows the model to handle multiple events tied at the
    same event time. However, this goes beyond the scope of this discussion.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œéœ€è¦æåˆ°çš„æ˜¯ï¼ŒCox å›å½’å®ç°è¿˜æä¾›äº†ä¸€ä¸ªæ‰©å±•ï¼Œå…è®¸æ¨¡å‹å¤„ç†åœ¨åŒä¸€äº‹ä»¶æ—¶é—´å‘ç”Ÿçš„å¤šä¸ªäº‹ä»¶ã€‚ç„¶è€Œï¼Œè¿™è¶…å‡ºäº†æœ¬è®¨è®ºçš„èŒƒå›´ã€‚
- en: Conclusion
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: 'There was a lot to â€œunboxâ€ here:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæœ‰å¾ˆå¤šéœ€è¦â€œæ‹†è§£â€çš„å†…å®¹ï¼š
- en: Cox regression models the association between predictor variables and the rank-order
    of times to an event occurrence.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Cox å›å½’æ¨¡å‹æè¿°äº†é¢„æµ‹å˜é‡ä¸äº‹ä»¶å‘ç”Ÿæ—¶é—´æ’åé¡ºåºä¹‹é—´çš„å…³è”ã€‚
- en: Actual numeric values of event times do not matter at all, as long as the subjects
    experience the events in the same order.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº‹ä»¶æ—¶é—´çš„å®é™…æ•°å€¼å®Œå…¨æ— å…³ç´§è¦ï¼Œåªè¦å—è¯•è€…ä»¥ç›¸åŒçš„é¡ºåºç»å†è¿™äº›äº‹ä»¶ã€‚
- en: Hazards are probabilities per unit time and can have arbitrary units, while
    likelihoods are related the probability of events occurring.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å±é™©åº¦æ˜¯å•ä½æ—¶é—´å†…çš„æ¦‚ç‡ï¼Œå¯ä»¥å…·æœ‰ä»»æ„å•ä½ï¼Œè€Œä¼¼ç„¶åº¦ä¸äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ç›¸å…³ã€‚
- en: Stacked bar charts can be used to provide insights into maximum likelihood estimation
    by stacking individual negative log-likelihoods and exploring how they change
    with predictors *x*.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å †å æ¡å½¢å›¾å¯ä»¥ç”¨æ¥é€šè¿‡å †å å•ä¸ªè´Ÿå¯¹æ•°ä¼¼ç„¶å€¼æä¾›å¯¹æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„æ´å¯Ÿï¼Œå¹¶æ¢ç´¢å®ƒä»¬å¦‚ä½•éšé¢„æµ‹å˜é‡*x*å˜åŒ–ã€‚
- en: By striking a balance between assigning probabilities to events for various
    subjects, MLE finds *Î²* for which the observed data is *most likely to happen*.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é€šè¿‡åœ¨ä¸ºå„ç§å—è¯•è€…åˆ†é…äº‹ä»¶æ¦‚ç‡ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ‰¾åˆ°ä½¿è§‚å¯Ÿæ•°æ®*æœ€æœ‰å¯èƒ½å‘ç”Ÿ*çš„*Î²*ã€‚
- en: To be continuedâ€¦ ğŸ‘€
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ•¬è¯·æœŸå¾…â€¦ ğŸ‘€
- en: References
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å‚è€ƒæ–‡çŒ®
- en: 'Code with plots: [https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py](https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py)'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'å¸¦å›¾è¡¨çš„ä»£ç : [https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py](https://github.com/igor-sb/blog/blob/main/posts/cox/plots.py)'
- en: 'Survival Data Analysis slides from Prof. Patrick Breheny: [https://myweb.uiowa.edu/pbreheny/7210/f19/index.html](https://myweb.uiowa.edu/pbreheny/7210/f19/index.html)'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'å¸•ç‰¹é‡Œå…‹Â·å¸ƒé›·èµ«å°¼æ•™æˆçš„ç”Ÿå­˜æ•°æ®åˆ†æå¹»ç¯ç‰‡: [https://myweb.uiowa.edu/pbreheny/7210/f19/index.html](https://myweb.uiowa.edu/pbreheny/7210/f19/index.html)'
- en: ChatGPT for text cleanup and funny hallucinations
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”¨äºæ–‡æœ¬æ¸…ç†å’Œæœ‰è¶£çš„è™šæ„çš„ChatGPT

- en: Ensemble Averaging in Medical Signal Processing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/ensemble-averaging-in-medical-signal-processing-17116d0cf0d2?source=collection_archive---------14-----------------------#2023-05-02](https://towardsdatascience.com/ensemble-averaging-in-medical-signal-processing-17116d0cf0d2?source=collection_archive---------14-----------------------#2023-05-02)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Simple yet so powerful method
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@omar.ok1998?source=post_page-----17116d0cf0d2--------------------------------)[![Omar
    Alkousa](../Images/7598618abe8e8fa89f1d8a4bfc21f014.png)](https://medium.com/@omar.ok1998?source=post_page-----17116d0cf0d2--------------------------------)[](https://towardsdatascience.com/?source=post_page-----17116d0cf0d2--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----17116d0cf0d2--------------------------------)
    [Omar Alkousa](https://medium.com/@omar.ok1998?source=post_page-----17116d0cf0d2--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff8302b9534b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-averaging-in-medical-signal-processing-17116d0cf0d2&user=Omar+Alkousa&userId=f8302b9534b5&source=post_page-f8302b9534b5----17116d0cf0d2---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----17116d0cf0d2--------------------------------)
    ·6 min read·May 2, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17116d0cf0d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-averaging-in-medical-signal-processing-17116d0cf0d2&user=Omar+Alkousa&userId=f8302b9534b5&source=-----17116d0cf0d2---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17116d0cf0d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-averaging-in-medical-signal-processing-17116d0cf0d2&source=-----17116d0cf0d2---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: Dealing with data as a researcher, a data scientist/analyst, or even in any
    science field is inevitable. Thus, the reliability of the data you’re working
    with is crucial as it decides the reliability of your work.
  prefs: []
  type: TYPE_NORMAL
- en: In this post, we will introduce the ensemble averaging method, a simple but
    powerful method, and its applications on signal data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/48226e70172f46fd4a7b4dfb1e0acd79.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Eran Menashri](https://unsplash.com/@chesnutt?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The average is a single value that can describe a set of values. It can be
    defined as the sum of the variables divided by the number of variables. If we
    have a set of variables {x1, x2, …, xn}, the average can be calculated as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1a85d51eb64276c3f1ba00d74e8f36c6.png)'
  prefs: []
  type: TYPE_IMG
- en: A simple example you can think of to introduce the idea of ensemble averaging
    is measuring the temperature of a solution that has a stable temperature during
    the measurement. An electronic sensor can be used to measure the temperature three
    times for a time of ten seconds. the ensemble averaging can be done by taking
    the average of the three measurements.
  prefs: []
  type: TYPE_NORMAL
- en: From the example above, the ensemble averaging method requires the ability to
    repeat the experiment you are conducting with the same properties of the measurement
    system [[1](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)]. This is hard
    to be applied in many real-world cases. Therefore, a solution that might be considered
    in many cases is conducting the experiment one time but using multiple sensors
    [[1](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)] simultaneously to produce
    multiple observations of the corresponding experiment.
  prefs: []
  type: TYPE_NORMAL
- en: In the case of the signal type of data (time series), the ensemble averaging
    method is done by averaging the samples of the signals point-by-point [[2](https://www.ijarcce.com/upload/2016/august-16/IJARCCE%2052.pdf)].
    Therefore, a prerequisite before applying the method is that the signals generated
    are aligned in time [[1](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)].
    Below is an illustration of applying ensemble averaging on signal data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dcb3cc4f607fe1a064a6277f15de228c.png)'
  prefs: []
  type: TYPE_IMG
- en: Applying the ensemble averaging method using two experiments. Notice the samples
    of the signal are aligned in time. [Image by the Author]
  prefs: []
  type: TYPE_NORMAL
- en: Why use the ensemble averaging method? Why do we repeat experiments?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The first time I got into ensemble averaging was at the biomechanics lab, which
    is specialized in studying gait patterns and analyzing human locomotion. When
    my professor instructed to conduct the experiment on the same patient to get at
    least three successful experiments, **I asked why three times and not just one
    successful experiment?!**
  prefs: []
  type: TYPE_NORMAL
- en: The answer was to calculate the ensemble average of these three experiments
    to get the final signal with higher reliability and less prone to random noise.
  prefs: []
  type: TYPE_NORMAL
- en: In common sense, repeating the experiments ensure that the data you obtain is
    the data of interest. But of course, the cost and the time of experiment repetitions
    have to be considered.
  prefs: []
  type: TYPE_NORMAL
- en: 'From a signal-processing perspective, ensemble averaging has many advantages
    in enhancing the signal data. These advantages can be concluded as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Ensemble averaging is useful for filtering random noise in the signals [[2](https://www.ijarcce.com/upload/2016/august-16/IJARCCE%2052.pdf)].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Applying the ensemble averaging method improves the Signal to Noise Ratio (SNR).
    If we have N number of repetitions, the improvement is proportional to the square
    root of N [[2](https://www.ijarcce.com/upload/2016/august-16/IJARCCE%2052.pdf)].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Real-world Medical Example
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The applications of the ensemble averaging method are limitless. A great example
    in the medical field is the idea behind Visual Evoked Response/Potential test
    (VER or VEP test). The aim of this test is to measure the response to visual stimulation
    which is produced as electrical signals in the visual cortex of the brain. The
    test depends on the repetitive stimulation with specified timing [[3](https://eyewiki.aao.org/Visual_Evoked_Potential/_Response_(VEP/VER))].
    The visual stimulation is done using a screen black-white checkerboard [[3](https://eyewiki.aao.org/Visual_Evoked_Potential/_Response_(VEP/VER))].
    The repetitive stimuli’s signals are averaged point-by-point (ensemble average)
    to determine the VER signal [[1](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)],
    remember that the signals are aligned in time of the stimulation process. The
    following is an example of how to extract VER signals using the ensemble averaging
    method.
  prefs: []
  type: TYPE_NORMAL
- en: The signal data we will use are available following this [**link**](https://github.com/Roshni1999/John-Semmlow-Signals-and-Systems-for-Bioengineers-2ed/blob/9c6efc1c68e042212cff45a5fb41902d6699a09e/Chapter1/ver.mat)
    (MIT Licensed). The data consists of 100 electrical signals recorded at 200 Hz
    of sampling rate.
  prefs: []
  type: TYPE_NORMAL
- en: Ensemble Averaging using Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'First, we will import the required Python packages:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Numpy**: for array manipulation and arithmetic calculation.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Matplotlib**: to visualize the signal data of the VER response.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scipy**: we will use the module scipy.io to read the data file (.MAT file
    type).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Now, we read the data file that contains the electrical signals using the *scipy.io.loadmat*
    method. The output is a dictionary of the file content. The electrical signals
    can be found in the item “ver”.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Let’s explore the size of the data we are working with.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This means that we have 100 signals and each one has 500 samples. Applying the
    ensemble averaging method to this data will average 100 signals and produce one
    signal with 500 samples.
  prefs: []
  type: TYPE_NORMAL
- en: After extracting the signal data, we will define the sampling rate the generate
    the time axis of the signals.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Now that we have the time axis and the signals we are studying, we can visualize
    some of the signals along the same time axis to see what the single visual response
    looks like. We will visualize only the first 10 signals.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/3ccc10bb8adeb0f57e40cff62c49fd95.png)'
  prefs: []
  type: TYPE_IMG
- en: The first 10 signals of the data. [Image by the Author]
  prefs: []
  type: TYPE_NORMAL
- en: Notice that we cannot recognize the visual response from only one signal. Therefore,
    we’re going to use ensemble averaging to determine the VER.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/1408db1ce22d6739a4a0480b7b593465.png)'
  prefs: []
  type: TYPE_IMG
- en: VER using ensemble averaging on 100 signals. [Image by the Author]
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We’ve introduced Ensemble Averaging, a simple yet very helpful method that you
    can use to extract reliable data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We’ve pointed out the reason behind repeating experiments and how it enhances
    the reliability of the data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Applying ensemble averaging improves the SNR of the signal by the square root
    of the N (the number of repetitions). Also, the final signal data are less prone
    to random noise.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We’ve introduced an example using the ensemble averaging method to determine
    the Visual Evoked Response (VER) based on repetitive stimulation with specified
    timing.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**[**[**1**](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)**]** Semmlow,
    J. (2018). Signal Analysis in the Time Domain. In *Circuits, Signals and Systems
    for Bioengineers* (pp. 51–110). Elsevier. [https://doi.org/10.1016/B978-0-12-809395-5.00002-3](https://doi.org/10.1016/B978-0-12-809395-5.00002-3)'
  prefs: []
  type: TYPE_NORMAL
- en: '**[**[**2**](https://www.ijarcce.com/upload/2016/august-16/IJARCCE%2052.pdf)**]**
    Thomas, T. (2005). Ensemble Averaging Filter for Noise Reduction. *International
    Journal of Advanced Research in Computer and Communication Engineering*, *5*(8).'
  prefs: []
  type: TYPE_NORMAL
- en: '**[**[**3**](https://eyewiki.aao.org/Visual_Evoked_Potential/_Response_(VEP/VER))**]**
    Tripathy, K., Hsu, J., & Lim, J. (2022, November 10). *Visual Evoked Potential/
    Response (VEP/VER).* American Academy of Ophthalmology. [https://eyewiki.aao.org/Visual_Evoked_Potential/_Response_(VEP/VER)](https://eyewiki.aao.org/Visual_Evoked_Potential/_Response_(VEP/VER))'
  prefs: []
  type: TYPE_NORMAL

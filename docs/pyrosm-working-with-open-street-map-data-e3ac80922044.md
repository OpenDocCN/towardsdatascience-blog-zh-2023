# PyrOSMï¼šå¤„ç†å¼€æ”¾è¡—å›¾æ•°æ®

> åŸæ–‡ï¼š[https://towardsdatascience.com/pyrosm-working-with-open-street-map-data-e3ac80922044?source=collection_archive---------4-----------------------#2023-10-21](https://towardsdatascience.com/pyrosm-working-with-open-street-map-data-e3ac80922044?source=collection_archive---------4-----------------------#2023-10-21)

## é«˜æ•ˆçš„åœ°ç†ç©ºé—´æ“ä½œç”¨äº OSM åœ°å›¾æ•°æ®

[](https://deabardhoshi.medium.com/?source=post_page-----e3ac80922044--------------------------------)[![Dea Bardhoshi](../Images/14ce0986fc2a4a192797a52ed9908d1e.png)](https://deabardhoshi.medium.com/?source=post_page-----e3ac80922044--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e3ac80922044--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e3ac80922044--------------------------------) [Dea Bardhoshi](https://deabardhoshi.medium.com/?source=post_page-----e3ac80922044--------------------------------)

Â·

[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd61c58ba988e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyrosm-working-with-open-street-map-data-e3ac80922044&user=Dea+Bardhoshi&userId=d61c58ba988e&source=post_page-d61c58ba988e----e3ac80922044---------------------post_header-----------) å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e3ac80922044--------------------------------) Â· 4åˆ†é’Ÿé˜…è¯» Â· 2023å¹´10æœˆ21æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3ac80922044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyrosm-working-with-open-street-map-data-e3ac80922044&user=Dea+Bardhoshi&userId=d61c58ba988e&source=-----e3ac80922044---------------------clap_footer-----------)

--

[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3ac80922044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyrosm-working-with-open-street-map-data-e3ac80922044&source=-----e3ac80922044---------------------bookmark_footer-----------)![](../Images/8a3a66110df17612b904c2434650013f.png)

å›¾ç‰‡ç”± [Tabea Schimpf](https://unsplash.com/@tabeaschimpf?utm_source=medium&utm_medium=referral) æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

å¦‚æœä½ ä»¥å‰å¤„ç†è¿‡ OSM æ•°æ®ï¼Œä½ çŸ¥é“æå–èµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚OSM æ•°æ®å¯èƒ½éå¸¸åºå¤§ï¼Œæ‰¾åˆ°æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆæ¥åˆ†æä½ æƒ³è¦çš„å†…å®¹å¾€å¾€æ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚PyrOSM æ˜¯ä¸€ä¸ªä½¿è¯»å–å’Œå¤„ç† OSM æ•°æ®çš„è¿‡ç¨‹æ›´åŠ é«˜æ•ˆçš„åŒ…ã€‚æ€ä¹ˆåšåˆ°çš„ï¼ŸPyrOSM åŸºäº Cythonï¼ˆC Pythonï¼‰æ„å»ºï¼Œå¹¶ä½¿ç”¨æ›´å¿«çš„åº“æ¥ååºåˆ—åŒ– OSM æ•°æ®ï¼ŒåŒæ—¶è¿˜æœ‰åƒ numpy æ•°ç»„è¿™æ ·çš„è¾ƒå°ä¼˜åŒ–ï¼Œä½¿å…¶èƒ½å¤Ÿå¿«é€Ÿå¤„ç†æ•°æ®ã€‚ç‰¹åˆ«æ˜¯å¦‚æœä½ ä¹‹å‰ä½¿ç”¨è¿‡ OSMnxï¼ˆç”¨äºéå¸¸ç±»ä¼¼çš„ç”¨ä¾‹ï¼‰ï¼Œä½ ä¼šçŸ¥é“å¤§å‹æ•°æ®é›†åŠ è½½åˆ°å†…å­˜ä¸­éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œè¿™å°±æ˜¯ PyrOSM å¯ä»¥å¸®åŠ©ä½ å¤„ç†å®ƒä»¬çš„åœ°æ–¹ã€‚è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹è¿™ä¸ªåº“èƒ½åšä»€ä¹ˆå§ï¼

## ğŸŒ PBF æ•°æ®

è®©æˆ‘ä»¬è°ˆè°ˆ OSM æ•°æ®çš„å…·ä½“æ–‡ä»¶æ ¼å¼ã€‚PBF ä»£è¡¨â€œProtocolbuffer Binary Formatâ€ï¼Œå®ƒåœ¨å¤„ç†å­˜å‚¨ OSM æ•°æ®æ—¶éå¸¸é«˜æ•ˆã€‚OSM æ•°æ®ç»„ç»‡æˆ**fileblocks**ï¼Œè¿™äº›æ˜¯å¯ä»¥ç‹¬ç«‹ç¼–ç æˆ–è§£ç çš„æ•°æ®ç»„ã€‚Fileblocks åŒ…å«**PrimitiveGroups**ï¼Œå®ƒä»¬åˆåŒ…å«æˆåƒä¸Šä¸‡çš„ OSM å®ä½“ï¼Œå¦‚èŠ‚ç‚¹ã€é“è·¯å’Œå…³ç³»ã€‚

æ•°æ®å¯ä»¥æ ¹æ®ç”¨æˆ·æœŸæœ›çš„ç²’åº¦çº§åˆ«è¿›è¡Œç¼©æ”¾ã€‚ä¾‹å¦‚ï¼Œå½“å‰ OSM æ•°æ®åº“çš„åˆ†è¾¨ç‡çº¦ä¸º ~1 cmã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥å°†æ•´ä¸ª Open Street Maps æ•°æ®ä¸‹è½½åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶è¢«ç§°ä¸º Planetï¼ˆçº¦ 1000 Gb çš„æ•°æ®ï¼‰ï¼

## ğŸ‘©â€ğŸ’» PyrOSM åŸºç¡€ï¼šè¯»å–æ•°æ®é›†

PyrOSM æ˜¯ä¸€ä¸ªè¯»å– Open Street Map çš„ PBF æ•°æ®çš„åŒ…ï¼ŒåŸºäºä¸¤ä¸ªä¸»è¦çš„æ•°æ®åˆ†å‘å•†ï¼šGeofabrikï¼ˆå…¨çƒå’Œå›½å®¶çº§æ•°æ®ï¼‰å’Œ BBBikeï¼ˆåŸå¸‚çº§æ•°æ®ï¼‰ã€‚è¯¥åŒ…å…è®¸ç”¨æˆ·è®¿é—®è®¸å¤šç±»å‹çš„åŠŸèƒ½ï¼š

+   å»ºç­‘ç‰©ã€å…´è¶£ç‚¹ï¼ˆPOIsï¼‰ã€åœŸåœ°ä½¿ç”¨

+   è¡—é“ç½‘ç»œ

+   è‡ªå®šä¹‰è¿‡æ»¤å™¨

+   ä½œä¸ºç½‘ç»œå¯¼å‡º

+   è¿˜æœ‰æ›´å¤šï¼

ç›®å‰ BBBike æ”¯æŒå…¨çƒ 235 ä¸ªåŸå¸‚ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨**â€œsources.cities.availableâ€**æ–¹æ³•è½»æ¾è·å–å®Œæ•´åˆ—è¡¨ã€‚å…¥é—¨éå¸¸ç®€å•ï¼Œä½ åªéœ€åˆå§‹åŒ–ä¸€ä¸ª OSM è¯»å–å™¨å¯¹è±¡å¹¶åŠ è½½æ‰€éœ€çš„æ•°æ®ï¼š

ä»è¿™ä¸€ç‚¹å¼€å§‹ï¼Œä½ éœ€è¦ä½¿ç”¨ OSM å¯¹è±¡æ¥ä¸ Berkeley æ•°æ®äº¤äº’ã€‚ç°åœ¨è®©æˆ‘ä»¬è·å– Berkeley çš„é©¾é©¶è¡—é“ç½‘ç»œï¼š

![](../Images/080e775dbd2e52d1353ef015180ad933.png)

Berkeley çš„ OSM è¡—é“ç½‘ç»œæ•°æ®æ¡†

æ‰“å°å‡ºå®é™…çš„ street_network å¯¹è±¡æ˜¾ç¤ºå®ƒå­˜å‚¨åœ¨ä¸€ä¸ª GeoPandas GeoDataFrame ä¸­ï¼ŒåŒ…å«æ‰€æœ‰ OSM å±æ€§ï¼Œå¦‚é•¿åº¦ã€é«˜é€Ÿå…¬è·¯ã€æœ€é«˜é€Ÿåº¦ç­‰ï¼Œè¿™å¯¹äºè¿›ä¸€æ­¥åˆ†æéå¸¸æœ‰ç”¨ã€‚

**é™„æ³¨ï¼š** BBBikeï¼ˆæ•°æ®æ¥æºæä¾›å•†ï¼‰æœ‰è®¸å¤šå…¶ä»–å¤§å°çš„æ•°æ®æ ¼å¼ï¼ŒåŒ…æ‹¬ Organic Maps OSMã€Garmin OSM æˆ– SVG Mapnikï¼Œè¿™å–å†³äºä½ çš„ä½¿ç”¨æ¡ˆä¾‹ã€‚

## ğŸ” æ›´å¥½çš„è¿‡æ»¤

ä¸Šè¿°æ•°æ®åŠ è½½çš„ç»“æœåŒ…æ‹¬äº†æ•´ä¸ª Berkeley çš„æ•°æ®ï¼Œå®é™…ä¸Šç”šè‡³åŒ…æ‹¬äº†é‚»è¿‘åŸå¸‚çš„æ•°æ®ï¼Œè¿™å¹¶ä¸æ˜¯ç†æƒ³çš„ã€‚é‚£å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ›´å°æˆ–æ›´å…·ä½“çš„åŒºåŸŸå‘¢ï¼Ÿè¿™å°±æ˜¯ä½¿ç”¨è¾¹ç•Œæ¡†çš„ç”¨æ­¦ä¹‹åœ°ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºè¾¹ç•Œæ¡†ï¼š

+   æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªæ ¼å¼ä¸º **[minx, miny, maxx, maxy]** çš„ 4 ä¸ªåæ ‡åˆ—è¡¨

+   ä¼ å…¥ Shapely å‡ ä½•å¯¹è±¡ï¼ˆä¾‹å¦‚ LineString æˆ– Multipolygonï¼‰

è¦æŸ¥æ‰¾è¾¹ç•Œæ¡†åæ ‡ï¼Œæˆ‘é€šå¸¸ä½¿ç”¨è¿™ä¸ª [bbox finder](http://bboxfinder.com/#0.000000,0.000000,0.000000,0.000000) ç½‘ç«™ï¼Œå®ƒå…è®¸ä½ ç»˜åˆ¶çŸ©å½¢ç„¶åå¤åˆ¶åæ ‡ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ç•Œå®š UC Berkeley æ ¡å›­å‘¨å›´çš„åŒºåŸŸå¹¶è·å–å…¶æ­¥è¡Œç½‘ç»œï¼š

![](../Images/94c7482901919addf2468d153ea4af40.png)

ä½¿ç”¨è¾¹ç•Œæ¡†çš„è¡—é“ç½‘ç»œ

## ğŸ¯ å¯¼å‡ºå’Œå¤„ç†å›¾å½¢

PyrOSM çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒå…è®¸ç½‘ç»œå¤„ç†å¹¶ä¸å…¶ä»–ç½‘ç»œåˆ†æåº“è¿æ¥ã€‚é™¤äº†å°†è¡—é“ç½‘ç»œä¿å­˜ä¸ºåœ°ç†æ•°æ®æ¡†å¤–ï¼ŒPyrOSM è¿˜å…è®¸ä½ é€šè¿‡å°†èŠ‚ç‚¹å’Œè¾¹å­˜å‚¨åœ¨ä¸¤ä¸ªå•ç‹¬çš„æ•°æ®æ¡†ä¸­æ¥æå–å®ƒä»¬ã€‚è¿™é‡Œæ˜¯èŠ‚ç‚¹æ•°æ®æ¡†ï¼š

![](../Images/818743f62ad37e355a502bc406ae2009.png)

ä»è¡—é“ç½‘ç»œä¸­æå–çš„èŠ‚ç‚¹æ•°æ®æ¡†

å¦‚æœä½ æœ‰è¿™äº›å›¾å½¢è¡¨ç¤ºï¼Œä¿å­˜ä¸ºå„ç§æ ¼å¼æ˜¯éå¸¸ç®€å•çš„ï¼šOSMnxã€igraph å’Œ Pandana å¹¶åœ¨è¿™äº›å·¥å…·ä¸­ä½¿ç”¨å®ƒä»¬ã€‚

## ğŸ’­ ç»“æŸæ€è€ƒ

è¿™æ˜¯ pyrosm åœ¨ä½ çš„åœ°ç†ç©ºé—´å·¥ä½œä¸­èƒ½ä¸ºä½ æä¾›çš„ç®€çŸ­æ€»ç»“ï¼æˆ‘æåˆ°äº†å‡ ç§éå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚ä»æŸä¸ªåŒºåŸŸä¸‹è½½ç‰¹å®šçš„æ•°æ®é›†ï¼Œæˆ–é€šè¿‡ç•Œå®šæ„Ÿå…´è¶£åŒºåŸŸä»¥åŠå®ƒä¸å…¶ä»–åº“çš„å…³ç³»ã€‚æˆ‘è®¤ä¸º pyrosm æœ€æ£’çš„åœ°æ–¹å°±æ˜¯å®ƒèƒ½å¤Ÿå¼¥åˆåºå¤§çš„ OSM æ•°æ®é›†ä¸å·¥ç¨‹æˆ–åˆ†æé—®é¢˜ä¹‹é—´çš„å·®è·ã€‚

æ„Ÿè°¢é˜…è¯»ï¼

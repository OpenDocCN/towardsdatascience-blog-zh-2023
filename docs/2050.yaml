- en: 'Understanding Bayesian Marketing Mix Modeling: A Deep Dive into Prior Specifications'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/understanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e?source=collection_archive---------2-----------------------#2023-06-24](https://towardsdatascience.com/understanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e?source=collection_archive---------2-----------------------#2023-06-24)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Exploring model specification with Google’s LightweightMMM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@slavax?source=post_page-----af400adb836e--------------------------------)[![Slava
    Kisilevich](../Images/5a2a00fb7a9d4c33868d071b6cc1a009.png)](https://medium.com/@slavax?source=post_page-----af400adb836e--------------------------------)[](https://towardsdatascience.com/?source=post_page-----af400adb836e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----af400adb836e--------------------------------)
    [Slava Kisilevich](https://medium.com/@slavax?source=post_page-----af400adb836e--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba0d56f8b910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e&user=Slava+Kisilevich&userId=ba0d56f8b910&source=post_page-ba0d56f8b910----af400adb836e---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----af400adb836e--------------------------------)
    ·8 min read·Jun 24, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf400adb836e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e&user=Slava+Kisilevich&userId=ba0d56f8b910&source=-----af400adb836e---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf400adb836e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e&source=-----af400adb836e---------------------bookmark_footer-----------)![](../Images/4a03e63743ae2b133d6689409a2acd9f.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Pawel Czerwinski](https://unsplash.com/@pawel_czerwinski?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Bayesian marketing mix modeling has been receiving more and more attention,
    especially with the recent releases of open source tools like [LightweightMMM](https://lightweight-mmm.readthedocs.io/en/latest/index.html)
    (Google) or [PyMC Marketing](https://www.pymc-marketing.io) (PyMC Labs). Although
    these frameworks simplify the complexities of Bayesian modeling, it is still crucial
    for the user to have an understanding of fundamental Bayesian concepts and be
    able to understand the model specification.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, I take Google’s LightweightMMM as a practical example and show
    the intuition and meaning of the prior specifications of this framework. I demonstrate
    the simulation of prior samples using Python and the scipy library.
  prefs: []
  type: TYPE_NORMAL
- en: Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I use the data made available by [Robyn](https://github.com/facebookexperimental/Robyn)
    under MIT Licence.
  prefs: []
  type: TYPE_NORMAL
- en: 'The dataset consists of 208 weeks of revenue (from 2015–11–23 to 2019–11–11)
    having:'
  prefs: []
  type: TYPE_NORMAL
- en: '5 media spend channels: **tv_S, ooh_S, print_S, facebook_S, search_S**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '2 media channels that have also the exposure information (Impression, Clicks):
    facebook_I, search_clicks_P'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Organic media without spend: **newsletter**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Control variables: **events, holidays**, competitor sales (**competitor_sales_B)**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: LightweightMMM Model Specification
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The specification of the [LightweightMMM model](https://lightweight-mmm.readthedocs.io/en/latest/models.html#)
    is defined as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/68a5b02a5020d63d65589026dda1b600.png)'
  prefs: []
  type: TYPE_IMG
- en: LMMM Model Specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: This specification represents an additive linear regression model that explains
    the value of a response (target variable) at a specific time point *t.*
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s break down each component in the equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '**α**: This component represents the intercept or the baseline value of the
    response. It is the expected value of the response when all other factors are
    zero.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***trend***: This component captures the increasing or decreasing trend of
    the response over time.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***seasonality***: This component represents periodic fluctuations in the response.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***media_channels***: This component accounts for the influence of media channels
    (tv, radio, online ads) on the response.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***other_factors***: This component encompasses any other variables that have
    influence on the response such as weather, economic indicators or competitor activities.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Below, I go through each of the components in detail and explain how to interpret
    the prior specifications. As a reminder, a prior distribution is an assumed distribution
    of some parameter without any knowledge of the underlying data.
  prefs: []
  type: TYPE_NORMAL
- en: Intercept
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/a91554c7d9d3ffa17bd455faca15ed46.png)'
  prefs: []
  type: TYPE_IMG
- en: Intercept prior specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: The intercept is defined to follow a half-normal distribution with a standard
    deviation of 2\. A half-normal distribution is a continuous probability distribution
    that resembles a normal distribution but is restricted to positive values only.
    The distribution is characterized by a single parameter, the standard deviation
    (scale). Half-normal distribution implies that the intercept can get only positive
    values.
  prefs: []
  type: TYPE_NORMAL
- en: The following code generates samples from the prior distribution of the intercept
    and visualizes the probability density function (PDF) for a half-normal distribution
    with a scale of 2\. For visualizations of other components, please refer to the
    accompanying source code in the [Github repo](https://github.com/slavakx/medium_posts).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/42a658fe5c463f91f41bc8bc9af6750a.png)'
  prefs: []
  type: TYPE_IMG
- en: Half Normal Distribution (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Trend
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/7abcf759c734f74b0a2d29d58a1174ba.png)'
  prefs: []
  type: TYPE_IMG
- en: Trend specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: The trend is defined as a power-law relationship between time *t* and the trend
    value. The parameter *μ* represents the amplitude or magnitude of the trend, while
    *k* controls the steepness or curvature of the trend.
  prefs: []
  type: TYPE_NORMAL
- en: The parameter *μ* is drawn from a normal distribution with a mean of 0 and a
    standard deviation of 1\. This implies that *μ* follows a standard normal distribution,
    centered around 0, with standard deviation of 1\. The normal distribution allows
    for positive and negative values of *μ*, representing upward or downward trends,
    respectively.
  prefs: []
  type: TYPE_NORMAL
- en: The parameter *k* is drawn from a uniform distribution between 0.5 and 1.5\.
    The uniform distribution ensures that *k* takes values that result in a reasonable
    and meaningful curvature for the trend.
  prefs: []
  type: TYPE_NORMAL
- en: 'The plot below depicts separate components obtained from the prior distributions:
    a sample of the intercept and trend, each represented individually.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/45e852b1202ae917e1f5fa37343b7d4c.png)'
  prefs: []
  type: TYPE_IMG
- en: Trend and Intercept (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Seasonality
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/bc168c635788c6ec766641cfb6d2571a.png)'
  prefs: []
  type: TYPE_IMG
- en: Seasonality specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Each component γ is drawn from a normal distribution with a mean of 0 and a
    standard deviation of 1.
  prefs: []
  type: TYPE_NORMAL
- en: By combining the cosine and sine functions with different γ, cyclic patterns
    can modeled to capture the [seasonality](https://en.wikipedia.org/wiki/Seasonality)
    present in the data. The cosine and sine functions represent the oscillating behavior
    observed over the period of 52 units (weeks).
  prefs: []
  type: TYPE_NORMAL
- en: The plot below illustrates a sample of the seasonality, intercept and trend
    obtained from the prior distributions.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/964b36d329febe38575c58465fd8ce6f.png)'
  prefs: []
  type: TYPE_IMG
- en: Seasonality, Trend and Intercept (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Other factors (control variables)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/1787d9a33bdf30f8cd0c4354294faf7d.png)'
  prefs: []
  type: TYPE_IMG
- en: Other Factors specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Each factor coefficient *λ*​ is drawn from a normal distribution with a mean
    of 0 and a standard deviation of 1, which means that *λ* can take positive or
    negative values​, representing the direction and magnitude of the influence each
    factor has on the outcome.
  prefs: []
  type: TYPE_NORMAL
- en: 'The plot below depicts separate components obtained from the prior distributions:
    a sample of the intercept, trend, seasonality and control variables (*competitor_sales_B,
    newsletter, holidays and events*) each represented individually.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d0551801a9f51391b3a5664c189380f1.png)'
  prefs: []
  type: TYPE_IMG
- en: Other factors (combined) (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Media Channels
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/278af8fb42495d6db9199aef17c1c644.png)'
  prefs: []
  type: TYPE_IMG
- en: Media Channels prior specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: The distribution for *β*​ coefficient of a media channel *m* is specified as
    a half-normal distribution, where the standard deviation parameter *v*​ is determined
    by the sum of the total cost associated with media channel *m*. The total cost
    reflects the investment or resources allocated to that particular media channel.
  prefs: []
  type: TYPE_NORMAL
- en: Media Transformations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/fb02d036a7b12a61a851b8ca5ab312d0.png)'
  prefs: []
  type: TYPE_IMG
- en: Adstock and Hill Saturation Specification (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: In these equations, we are modeling the media channels’ behavior using a series
    of transformations, such as adstock and Hill saturation.
  prefs: []
  type: TYPE_NORMAL
- en: '[](/modeling-marketing-mix-using-pymc3-ba18dd9e6e68?source=post_page-----af400adb836e--------------------------------)
    [## Modeling Marketing Mix using PyMC3'
  prefs: []
  type: TYPE_NORMAL
- en: Experimenting with priors, data normalization, and comparing Bayesian modeling
    with Robyn, Facebook’s open-source MMM…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/modeling-marketing-mix-using-pymc3-ba18dd9e6e68?source=post_page-----af400adb836e--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: The variable *media channels* represents the transformed media channels at time
    point *t*. It is obtained by applying a transformation to the raw media channel
    value *x*​. The Hill transformation is controlled by the parameters *K*​ a half
    saturation point (0 < k ≤ 1), and shape *S*​ controlling the steepness of the
    curve (s > 0).
  prefs: []
  type: TYPE_NORMAL
- en: The variable *x*∗​ represents the transformed media channels value at time *t*
    after undergoing the adstock transformation. It is calculated by adding the current
    raw media channel value to the product of the previous transformed value and the
    adstock decay parameter *λ*​.
  prefs: []
  type: TYPE_NORMAL
- en: Parameters *K*​ and *S*​ follow gamma distributions with shape and scale parameters
    both set to 1, while *λ*​ follows a beta distribution with shape parameters 2
    and 1.
  prefs: []
  type: TYPE_NORMAL
- en: 'The probability density function of the Hill Saturation parameters *K*​ and
    *S* are illustrated in the plot below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e4fe6de1bc6a9a8822bd0d6f079df3e3.png)'
  prefs: []
  type: TYPE_IMG
- en: Gamma distribution (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'The probability density function of the adstock parameter λ is shown in the
    plot below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a135ee52e7e20f76a3e0cddb1b09bca8.png)'
  prefs: []
  type: TYPE_IMG
- en: Beta distribution (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: '**A Note on the specification of the adstock parameter *λ*:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'The probability density function of the Beta(α = 2, β = 1) distribution exhibits
    a positive trend, indicating that higher values have a higher probability density.
    In media analysis, different industries and media activities may demonstrate varying
    decay rates, with most media channels typically exhibiting small decay rates.
    For instance, Robyn suggests the following ranges of λ decay for common media
    channels: TV (0.3–0.8), OOH/Print/Radio (0.1–0.4), and digital (0–0.3).'
  prefs: []
  type: TYPE_NORMAL
- en: In the context of the Beta(α = 2, β = 1) distribution, higher probabilities
    are assigned to λ values closer to 1, while lower probabilities are assigned to
    values closer to 0\. Consequently, outcomes or observations near the upper end
    of the interval [0, 1] are more likely to occur compared to outcomes near the
    lower end.
  prefs: []
  type: TYPE_NORMAL
- en: Alternatively, in the [Bayesian Methods for Media Mix Modeling with Carryover
    and Shape Effects](https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/46001.pdf),
    the decay parameter is defined as Beta(α = 3, β = 3), whose probability density
    function is illustrated below. This distribution is symmetric around 0.5, indicating
    an equal likelihood of observing outcomes at both extremes and near the center
    of the interval [0, 1].
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ef4a5b2752e6e732cf710180beffc221.png)'
  prefs: []
  type: TYPE_IMG
- en: Beta(3,3) (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'The plot below depicts separate components obtained from the prior distributions:
    a sample of the intercept, trend, seasonality, control variables and media channels,
    each represented individually.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/60ee0427f39d60149b2d85af37873c7b.png)'
  prefs: []
  type: TYPE_IMG
- en: All model components (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Combining all components
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As mentioned earlier, LightweightMMM models an additive linear regression by
    combining various components such as intercept, trend, seasonality, media channels,
    and other factors sampled from their prior distributions to obtain the predictive
    response. The plot below visualizes the true response and the expected response
    sampled from the prior predictive distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Visualizing a single sample against the true response value allows us to observe
    how the model’s prediction compares to the actual outcome for a specific set of
    parameter values. It can provide an intuitive understanding of how the model performs
    in that particular instance.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0036621466f5c4583488191a01603221.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Revenue: True vs. Prior (image by the author)'
  prefs: []
  type: TYPE_NORMAL
- en: Prior predictive check
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In order get more robust insights, it is generally recommended to sample multiple
    times from the prior predictive distribution and measure the uncertainty. The
    prior predictive check helps assess the adequacy of the chosen model and evaluate
    whether the model’s predictions align with our expectations, before observing
    any actual data.
  prefs: []
  type: TYPE_NORMAL
- en: The plot depicted below visualizes the prior predictive distribution by showing
    the expected revenue (mean) at each point, along with measures of uncertainty.
    We can see that the true revenue falls within the range of the standard deviation,
    indicating that the model specification is suitable for the observed data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/42f15e6bd17dd5b0e837f66a4983426c.png)'
  prefs: []
  type: TYPE_IMG
- en: Prior predictive check (image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Bayesian marketing mix modeling may take considerable time to master. I hope
    that this article helped you to enhance your understanding of prior distributions
    and Bayesian marketing model specifications.
  prefs: []
  type: TYPE_NORMAL
- en: The complete code can be downloaded from my [Github repo](https://github.com/slavakx/medium_posts)
  prefs: []
  type: TYPE_NORMAL
- en: Thanks for reading!
  prefs: []
  type: TYPE_NORMAL

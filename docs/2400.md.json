["```py\nWITH\n  subscriptions_grouped AS (\n  SELECT\n    customer_id,\n    GROUP_CONCAT(subscription) AS subscriptions\n  FROM \n    subscriptions\n  GROUP BY customer_id\n  )\nSELECT\n  subscriptions,\n  COUNT(*) AS num_accounts\nFROM subscriptions_grouped\nGROUP BY subscriptions\n;\n```", "```py\nWITH\n  subscriptions_grouped AS (\n  SELECT\n    customer_id,\n    GROUP_CONCAT(subscription ORDER BY subscription) AS subscriptions\n  FROM \n    subscriptions\n  GROUP BY 1\n  )\nSELECT\n  subscriptions,\n  COUNT(*) AS num_accounts\nFROM subscriptions_grouped\nGROUP BY subscriptions\n;\n```", "```py\nSELECT\n  subscriptions,\n  LENGTH(subscriptions) - LENGTH(REPLACE(subscriptions, ',', '')) + 1 AS num_subscriptions,\n  COUNT(*) AS num_accounts\nFROM subscriptions_grouped\nGROUP BY subscriptions\n;\n```", "```py\nSELECT JSON_LENGTH(JSON_ARRAY(\"foo\", \"bar\", \"hello\", \"world\"));\n-- JSON_ARRAY function used here just to quickly create an example array\n```", "```py\nWITH\n  subscriptions_ordered AS (\n  SELECT\n    customer_id,\n    subscription\n  FROM subscriptions\n  ORDER BY subscription \n  )\n  , subscriptions_grouped AS (\n  SELECT\n    customer_id,\n    JSON_ARRAYAGG(subscription) AS subscriptions,\n    JSON_LENGTH(JSON_ARRAYAGG(subscription)) AS num_subscriptions\n  FROM \n    subscriptions_ordered\n  GROUP BY customer_id\n  )\nSELECT\n  subscriptions,\n  COUNT(*) AS num_accounts\n  num_subscriptions\nFROM subscriptions_grouped\nGROUP BY subscriptions\n;\n```", "```py\nSELECT \n  customer_id, \n  subscription, \n  ROW_NUMBER() OVER(ORDER BY subscription) AS alphabetical_row_num\nFROM subscriptions\n;\n```", "```py\nSELECT \n  customer_id, \n  subscription, \n  ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY subscription) AS alphabetical_order\nFROM subscriptions\n;\n```", "```py\nWITH \n  subscriptions_ordered AS (\n  SELECT \n    customer_id, \n    subscription, \n    ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY subscription) AS alphabetical_order\n  FROM subscriptions\n  )\nSELECT\n  customer_id,\n  JSON_ARRAYAGG(subscription) AS subscriptions\nFROM subscriptions_ordered\nGROUP BY 1\nORDER BY 2\n;\n```", "```py\nWITH \n  subscriptions_ordered AS (\n  SELECT \n    customer_id, \n    subscription, \n    ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY subscription) AS alphabetical_order\n  FROM subscriptions\n  )\n  , subscriptions_grouped AS (\n  SELECT\n    customer_id,\n    JSON_ARRAYAGG(subscription) AS subscriptions,\n    JSON_LENGTH(JSON_ARRAYAGG(subscription)) AS num_subscriptions\n  FROM subscriptions_ordered\n  GROUP BY customer_id \n  )\nSELECT\n  subscriptions,\n  COUNT(*) AS num_customers,\n  num_subscriptions\nFROM subscriptions_grouped\nGROUP BY subscriptions\nORDER BY num_customers DESC\n;\n```"]
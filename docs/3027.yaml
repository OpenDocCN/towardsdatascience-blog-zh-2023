- en: Clinical Trial Outcome Prediction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/clinical-trial-outcome-prediction-a4c6d279fd42?source=collection_archive---------6-----------------------#2023-10-04](https://towardsdatascience.com/clinical-trial-outcome-prediction-a4c6d279fd42?source=collection_archive---------6-----------------------#2023-10-04)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*Part 1: Multi-modal health data embedding*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@lenlan?source=post_page-----a4c6d279fd42--------------------------------)[![Lennart
    Langouche](../Images/ca35c7112cb845d17e1148b4f282600e.png)](https://medium.com/@lenlan?source=post_page-----a4c6d279fd42--------------------------------)[](https://towardsdatascience.com/?source=post_page-----a4c6d279fd42--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----a4c6d279fd42--------------------------------)
    [Lennart Langouche](https://medium.com/@lenlan?source=post_page-----a4c6d279fd42--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4bee88ffae4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclinical-trial-outcome-prediction-a4c6d279fd42&user=Lennart+Langouche&userId=4bee88ffae4&source=post_page-4bee88ffae4----a4c6d279fd42---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----a4c6d279fd42--------------------------------)
    ·8 min read·Oct 4, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa4c6d279fd42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclinical-trial-outcome-prediction-a4c6d279fd42&user=Lennart+Langouche&userId=4bee88ffae4&source=-----a4c6d279fd42---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa4c6d279fd42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclinical-trial-outcome-prediction-a4c6d279fd42&source=-----a4c6d279fd42---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: 'I recently came across this article: [HINT: Hierarchical interaction network
    for clinical-trial-outcome predictions](https://www.cell.com/patterns/pdf/S2666-3899(22)00018-6.pdf)
    from Fu et al. It’s an interesting application of real-world data science, and
    it inspired me to create my own project in which I attempt to predict clinical
    trial outcomes based on publicly available information from [ClinicalTrials.gov](http://clinicaltrials.gov).'
  prefs: []
  type: TYPE_NORMAL
- en: 'The aim of the project is to predict the outcome of clinical trials (a binary
    outcome: fail vs. success), without actually having to run them. We will use publicly
    available clinical trial information from [ClinicalTrials.gov](http://clinicaltrials.gov)
    such as *Drug Molecule, Disease Indication, Trial Protocol, Sponsor,* and *Number
    of Participants* and embed it (transform it into vector representations) using
    different tools such as BioBERT, SBERT, and DeepPurpose.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3562ccfd368279055d7b53f61345d436.png)'
  prefs: []
  type: TYPE_IMG
- en: Workflow schematic (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: 'In the first part of this series I focus on embedding the multi-modal clinical
    trial data. In [the second part](https://medium.com/@lennart.langouche/clinical-trial-outcome-prediction-7ce6c27831f9)
    I use an XGBoost model to predict trial outcomes (a binary prediction: fail vs.
    success) and briefly compare my simple XGBoost model’s performance to the HINT
    model’s performance from the [article](https://doi.org/10.1016/j.patter.2022.100445)
    that inspired this project.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/598fd825153e7854fa7a1e821e1cbb35.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Focus for Part 1 of this series: Embedding multi-modal clinical trial data
    into vectors (image by author)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are the steps I will follow in this article:'
  prefs: []
  type: TYPE_NORMAL
- en: Collect all clinical trial records from [ClinicalTrials.gov](http://ClinicalTrials.gov)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Read and parse the obtained XML files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Embed **disease indications** using [tiny-biobert](https://huggingface.co/nlpie/tiny-biobert)
    by [Rohanian et al](https://doi.org/10.1093/bioinformatics/btad103)., a compact
    version of [BioBERT](https://doi.org/10.1093/bioinformatics/btz682)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Embed clinical trial **inclusion-/exclusion criteria** using [tiny-biobert](https://huggingface.co/nlpie/tiny-biobert)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Embed **sponsor information** using [all-MiniLM-L6-v2](https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2),
    a powerful pre-trained sentence encoder from [SentenceBERT](https://doi.org/10.48550/arXiv.1908.10084)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Convert **drug names** to their SMILES representation and then to their Morgan
    fingerprint using [DeepPurpose](https://github.com/kexinhuang12345/DeepPurpose)
    by [Huang et al.](https://doi.org/10.1093/bioinformatics/btaa1005)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can follow all the steps in this Jupyter notebook: [clinical trial embedding
    tutorial](https://github.com/lenlan/clinical-trial-prediction/blob/main/clinical_trial_embedding_tutorial.ipynb).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Collect clinical trial records from** ClinicalTrials.gov'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'I suggest running the whole process in the command line since it is time- and
    space-consuming. In case you don’t have wget installed on your system, have a
    look here for [how to install wget](https://www.jcchouinard.com/wget/#How_to_Install_Wget).
    Open up a command line/terminal and type in the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Read and parse the obtained XML files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that you have the clinical trials as individual files on your hard drive,
    we’re going to extract the information we need from them by parsing the XML files.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Using sentence-transformers to embed information — Example
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First we need to install the sentence-transformers library.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: We have successfully transformed two sentences into a 312-dimensional vector
    representation.
  prefs: []
  type: TYPE_NORMAL
- en: Embed **disease indications** using tiny-biobert
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We first create a dictionary, where we map each indication to its 312- dimensional
    embedding using [tiny-biobert](https://huggingface.co/nlpie/tiny-biobert). Then,
    we create a dictionary that directly maps each trial identifier to its disease
    embedding. When trials include multiple indications, we take their mean as vector
    representation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Embed clinical trial inclusion/exclusion criteria using tiny-biobert
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In a very similar way, we encode clinical trial inclusion/exclusion criteria.
    There is some additional data cleaning involved to get the text into the right
    format. We encode inclusion and exclusion criteria separately, and each criteria
    embedding is the mean vector representation of the sentences it consists of.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Embed **sponsor information** using all-MiniLM-L6-v2, a powerful pre-trained
    sentence encoder from SentenceBERT
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I chose to encode trial sponsors using sentence embedding ([SBERT](https://www.sbert.net/index.html))
    as well. Using simpler methods such as Label or One-Hot Encoding could work too,
    but I wanted to be able to catch similarities between sponsor names, in case there
    were typos or multiple different spellings for one sponsor. I use the pre-trained
    [all-MiniLM-L6-v2](https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2)
    model which achieves high speed and performance on benchmark datasets. It converts
    each sponsor institution into a 384-dimensional vector.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Convert **drug names** to their SMILES representation and then to their Morgan
    fingerprint using DeepPurpose
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Molecules can be represented in SMILES strings. SMILES is a line notation for
    encoding molecular structure. Drug molecule data is extracted from [ClinicalTrials.gov](http://ClinicalTrials.gov)
    and linked to its molecule structure (SMILES strings) using [CACTUS](https://cactus.nci.nih.gov/).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[DeepPurpose](https://github.com/kexinhuang12345/DeepPurpose) can be used to
    encode molecular compounds. It currently supports 15 different encodings. We will
    use Morgan encoding, which encodes the atom groups of a chemical into a binary
    vector with length and radius as its two parameters. First we need to install
    the DeepPurpose library.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/7dcdecb43803584e8c4498f653137c4d.png)'
  prefs: []
  type: TYPE_IMG
- en: Overview of DeepPurpose Encoders (Image by [Huang et al.](https://doi.org/10.1093/bioinformatics/btaa1005),
    CC license)
  prefs: []
  type: TYPE_NORMAL
- en: We create a dictionary that maps SMILES to Morgan representation and a dictionary
    that maps clinical trial identifiers (NCTIDs) directly to their Morgan representation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Using publicly available clinical trial information we can create useful inputs
    for machine learning models by using feature embedding. To summarize, we:'
  prefs: []
  type: TYPE_NORMAL
- en: Embedded **disease indications** using [tiny-biobert](https://huggingface.co/nlpie/tiny-biobert)
    by [Rohanian et al](https://doi.org/10.1093/bioinformatics/btad103)., a compact
    version of [BioBERT](https://doi.org/10.1093/bioinformatics/btz682)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Embedded clinical trial **inclusion-/exclusion criteria** using [tiny-biobert](https://huggingface.co/nlpie/tiny-biobert)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Embedded **sponsor information** using [all-MiniLM-L6-v2](https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2),
    a powerful pre-trained sentence encoder from [SentenceBERT](https://doi.org/10.48550/arXiv.1908.10084)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Converted **drug names** to their SMILES representation and then to their Morgan
    fingerprint using [DeepPurpose](https://github.com/kexinhuang12345/DeepPurpose)
    by [Huang et al.](https://doi.org/10.1093/bioinformatics/btaa1005)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the [second part](https://medium.com/@lennart.langouche/clinical-trial-outcome-prediction-7ce6c27831f9)
    of this series I will run a simple XGBoost model to predict the clinical trial
    outcome based on the embedded vector representations we created here. I will compare
    its performance to that of the HINT model.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Fu, Tianfan, et al. “Hint: Hierarchical interaction network for clinical-trial-outcome
    predictions.” *Patterns* 3.4 (2022).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Huang, Kexin, et al. “DeepPurpose: a deep learning library for drug–target
    interaction prediction.” *Bioinformatics* 36.22–23 (2020): 5545–5547.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

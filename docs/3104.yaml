- en: A Bayesian Way of Choosing a Restaurant
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/a-bayesian-way-of-choosing-a-restaurant-87905a745854?source=collection_archive---------5-----------------------#2023-10-12](https://towardsdatascience.com/a-bayesian-way-of-choosing-a-restaurant-87905a745854?source=collection_archive---------5-----------------------#2023-10-12)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[](https://5why.medium.com/?source=post_page-----87905a745854--------------------------------)[![Kirill
    Tsyganov](../Images/376bcac6eae9741114ff6cc385883d62.png)](https://5why.medium.com/?source=post_page-----87905a745854--------------------------------)[](https://towardsdatascience.com/?source=post_page-----87905a745854--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----87905a745854--------------------------------)
    [Kirill Tsyganov](https://5why.medium.com/?source=post_page-----87905a745854--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fad57bdbd9754&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-bayesian-way-of-choosing-a-restaurant-87905a745854&user=Kirill+Tsyganov&userId=ad57bdbd9754&source=post_page-ad57bdbd9754----87905a745854---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----87905a745854--------------------------------)
    ·3 min read·Oct 12, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87905a745854&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-bayesian-way-of-choosing-a-restaurant-87905a745854&user=Kirill+Tsyganov&userId=ad57bdbd9754&source=-----87905a745854---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87905a745854&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-bayesian-way-of-choosing-a-restaurant-87905a745854&source=-----87905a745854---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recently I was looking for a new good restaurant. Google Maps highlighted me
    2 options: restaurant A with 10 reviews all 5 stars and restaurant B with 200
    reviews and average rating 4\. I tempted to choose restaurant A but the low number
    of reviews concerned me. On the other hand, many reviews of restaurant B gave
    me confidence of its 4 star rating, but promised nothing excellent. So, I wanted
    to compare the restaurants and choose the best discounting on reviews or lack
    of reviews. Thanks to Bayes, there is a way.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e306eaf4ab6d73bf22c1c73a73023f0b.png)'
  prefs: []
  type: TYPE_IMG
- en: Image made by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Bayesian framework allows to assume something about the initial distribution
    of ratings and then update the inital belief based on observed data.
  prefs: []
  type: TYPE_NORMAL
- en: '**Set initial beliefs / prior**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Initially we know nothing about probabilities of each rating (from 1 to 5 —
    stars). So, before any reviews, all ratings are equally likely. It means we start
    from the Uniform distr. which can be expressed as a **Dirichlete** distribution
    (generalization of Beta).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Our average rating will be just (1+2+3+4+5)/5 = 3 which is where the most probability
    is concentrated.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/29d7c20cc46584189adb11920e1c115f.png)'
  prefs: []
  type: TYPE_IMG
- en: Image made by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Update beliefs
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To update the initial beliefs we need to multiply the **prior beliefs** to the
    **likelihood** of observing the data with the prior beliefs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The observed data is naturally described by **Multinomial** distribution (generalization
    of Binomial).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It turns out that Dirichlet is a **conjugate prior** to the Multinomial likelihood.
    In other words our **posterior distr. is also a Dirichlet** distributuion with
    parameters incorporating observed data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/3efe17e0895746f8924ac4546b80868f.png)'
  prefs: []
  type: TYPE_IMG
- en: Image made by the author.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The posterior avg. rating of A is now somewhere in the middle **between prior
    3 and observed 5**. But the avg. rating of B didn’t change much because the large
    number of reviews outweighted the initial beliefs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/54add7a0439835424879234e30891ed8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image made by the author.
  prefs: []
  type: TYPE_NORMAL
- en: So, which one is better?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Back to our original question, “better” means the probability that an **avg.
    rating of A is bigger than an avg. rating of B,** i.e., P(E(A|data)>E(B|data)).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In my case I obtain the probability of 85% that restaurant A is better than
    restaurant B.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/a1bb98cbb307aad650137ec4267dd2d1.png)'
  prefs: []
  type: TYPE_IMG
- en: Image made by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Bayesian update allows us to incorporate prior beliefs which are especially
    valuable in case of small number of reviews. However, when the number of reviews
    is big, the initial beliefs do not significantly impact the posterior beliefs.
  prefs: []
  type: TYPE_NORMAL
- en: Code is available in [my github](https://github.com/uselessskills/back-of-the-envelope/blob/eb487cfd1a577518e24af478081af68f95c6db30/rating_uncertainty.ipynb)
    and I am going to the restaurant A.
  prefs: []
  type: TYPE_NORMAL

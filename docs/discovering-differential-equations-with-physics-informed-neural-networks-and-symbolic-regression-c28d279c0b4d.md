# é€šè¿‡ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œå’Œç¬¦å·å›å½’å‘ç°å¾®åˆ†æ–¹ç¨‹

> åŸæ–‡ï¼š[`towardsdatascience.com/discovering-differential-equations-with-physics-informed-neural-networks-and-symbolic-regression-c28d279c0b4d`](https://towardsdatascience.com/discovering-differential-equations-with-physics-informed-neural-networks-and-symbolic-regression-c28d279c0b4d)

## ä¸€ä¸ªé€æ­¥ä»£ç å®ç°çš„æ¡ˆä¾‹ç ”ç©¶

[](https://shuaiguo.medium.com/?source=post_page-----c28d279c0b4d--------------------------------)![Shuai Guo](https://shuaiguo.medium.com/?source=post_page-----c28d279c0b4d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c28d279c0b4d--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----c28d279c0b4d--------------------------------) [Shuai Guo](https://shuaiguo.medium.com/?source=post_page-----c28d279c0b4d--------------------------------)

Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page-----c28d279c0b4d--------------------------------) Â·é˜…è¯»æ—¶é—´ 25 åˆ†é’ŸÂ·2023 å¹´ 7 æœˆ 28 æ—¥

--

![](img/feb76e9bafbe81909b3d783c4332a1eb.png)

ç…§ç‰‡ç”±[Steven Coffey](https://unsplash.com/@steeeve?utm_source=medium&utm_medium=referral)æ‹æ‘„ï¼Œæ¥æºäº[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

å¾®åˆ†æ–¹ç¨‹ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„æ¡†æ¶ï¼Œç”¨äºæ•æ‰å’Œç†è§£ç‰©ç†ç³»ç»Ÿçš„åŠ¨æ€è¡Œä¸ºã€‚é€šè¿‡æè¿°å˜é‡ä¹‹é—´å¦‚ä½•å˜åŒ–ï¼Œå®ƒä»¬æä¾›äº†å¯¹ç³»ç»ŸåŠ¨æ€çš„è§è§£ï¼Œå¹¶å…è®¸æˆ‘ä»¬å¯¹ç³»ç»Ÿæœªæ¥çš„è¡Œä¸ºè¿›è¡Œé¢„æµ‹ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬åœ¨è®¸å¤šå®é™…ç³»ç»Ÿä¸­é¢ä¸´çš„ä¸€ä¸ªå…±åŒæŒ‘æˆ˜æ˜¯ï¼Œå®ƒä»¬çš„æ§åˆ¶å¾®åˆ†æ–¹ç¨‹é€šå¸¸ä»…*éƒ¨åˆ†å·²çŸ¥*ï¼ŒæœªçŸ¥çš„æ–¹é¢ä»¥å‡ ç§æ–¹å¼è¡¨ç°å‡ºæ¥ï¼š

+   å¾®åˆ†æ–¹ç¨‹çš„**å‚æ•°**æ˜¯æœªçŸ¥çš„ã€‚ä¾‹å¦‚åœ¨é£å·¥ç¨‹ä¸­ï¼Œæµä½“åŠ¨åŠ›å­¦çš„æ§åˆ¶æ–¹ç¨‹å·²è¢«å¾ˆå¥½åœ°å»ºç«‹ï¼Œä½†ä¸æ¹æµæµåŠ¨ç›¸å…³çš„ç³»æ•°éå¸¸ä¸ç¡®å®šã€‚

+   å¾®åˆ†æ–¹ç¨‹çš„**å‡½æ•°å½¢å¼**æ˜¯æœªçŸ¥çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒ–å­¦å·¥ç¨‹ä¸­ï¼Œç”±äºé€Ÿç‡å†³å®šæ­¥éª¤å’Œååº”é€”å¾„çš„ä¸ç¡®å®šæ€§ï¼Œé€Ÿç‡æ–¹ç¨‹çš„ç¡®åˆ‡å‡½æ•°å½¢å¼å¯èƒ½æ²¡æœ‰å®Œå…¨ç†è§£ã€‚

+   **å‡½æ•°å½¢å¼**å’Œ**å‚æ•°**éƒ½æ˜¯æœªçŸ¥çš„ã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯ç”µæ± çŠ¶æ€å»ºæ¨¡ï¼Œå…¶ä¸­å¸¸ç”¨çš„ç­‰æ•ˆç”µè·¯æ¨¡å‹ä»…éƒ¨åˆ†æ•æ‰äº†ç”µæµ-ç”µå‹å…³ç³»ï¼ˆå› æ­¤ç¼ºå¤±ç‰©ç†çš„å‡½æ•°å½¢å¼æ˜¯æœªçŸ¥çš„ï¼‰ã€‚æ­¤å¤–ï¼Œæ¨¡å‹æœ¬èº«åŒ…å«æœªçŸ¥çš„å‚æ•°ï¼ˆå³ç”µé˜»å’Œç”µå®¹å€¼ï¼‰ã€‚

![](img/0dc9da76d5f88c55a5a1ea99dd496e18.png)

å›¾ 1\. è®¸å¤šå®é™…åŠ¨æ€ç³»ç»Ÿçš„æ§åˆ¶æ–¹ç¨‹ä»…éƒ¨åˆ†å·²çŸ¥ã€‚ï¼ˆå›¾ç‰‡ç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

å¯¹ä¸»æ–¹ç¨‹çš„è¿™ç§éƒ¨åˆ†äº†è§£é˜»ç¢äº†æˆ‘ä»¬å¯¹è¿™äº›åŠ¨åŠ›ç³»ç»Ÿçš„ç†è§£å’Œæ§åˆ¶ã€‚å› æ­¤ï¼Œæ ¹æ®è§‚å¯Ÿæ•°æ®æ¨æ–­è¿™äº›æœªçŸ¥ç»„ä»¶æˆä¸ºåŠ¨åŠ›ç³»ç»Ÿå»ºæ¨¡ä¸­çš„å…³é”®ä»»åŠ¡ã€‚

å¹¿ä¹‰è€Œè¨€ï¼Œä½¿ç”¨è§‚å¯Ÿæ•°æ®æ¢å¤åŠ¨åŠ›ç³»ç»Ÿçš„ä¸»æ–¹ç¨‹çš„è¿‡ç¨‹å±äº**ç³»ç»Ÿè¯†åˆ«**çš„èŒƒç•´ã€‚ä¸€æ—¦å‘ç°è¿™äº›æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åˆ©ç”¨è¿™äº›æ–¹ç¨‹é¢„æµ‹ç³»ç»Ÿçš„æœªæ¥çŠ¶æ€ï¼Œå‘ŠçŸ¥ç³»ç»Ÿçš„æ§åˆ¶ç­–ç•¥ï¼Œæˆ–é€šè¿‡åˆ†ææŠ€æœ¯è¿›è¡Œç†è®ºç ”ç©¶ã€‚

æœ€è¿‘ï¼Œ[Zhang et al.](https://arxiv.org/abs/2307.08107)(2023)æå‡ºäº†ä¸€ç§æœ‰å‰æ™¯çš„ç­–ç•¥ï¼Œè¯¥ç­–ç•¥åˆ©ç”¨**ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œ**ï¼ˆPINNï¼‰å’Œ**ç¬¦å·å›å½’**æ¥å‘ç°å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEsï¼‰ç³»ç»Ÿä¸­çš„æœªçŸ¥é‡ã€‚è™½ç„¶ä»–ä»¬çš„é‡ç‚¹æ˜¯å‘ç°ç”¨äºé˜¿å°”èŒ¨æµ·é»˜ç—…å»ºæ¨¡çš„å¾®åˆ†æ–¹ç¨‹ï¼Œä½†ä»–ä»¬æå‡ºçš„è§£å†³æ–¹æ¡ˆå¯¹ä¸€èˆ¬åŠ¨åŠ›ç³»ç»Ÿä¹Ÿå…·æœ‰æ½œåŠ›ã€‚

åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°äº†è§£ä½œè€…æå‡ºçš„æ¦‚å¿µï¼Œå¹¶åŠ¨æ‰‹é‡ç°è®ºæ–‡ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ª PINNï¼Œåˆ©ç”¨[PySR åº“](https://github.com/MilesCranmer/PySR)è¿›è¡Œç¬¦å·å›å½’ï¼Œå¹¶è®¨è®ºè·å¾—çš„ç»“æœã€‚

> å¦‚æœä½ å¯¹ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œçš„æœ€ä½³å®è·µæ„Ÿå…´è¶£ï¼Œæ¬¢è¿æŸ¥çœ‹æˆ‘çš„åšå®¢ç³»åˆ—ï¼š
> 
> ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œï¼šä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„æŒ‡å—
> 
> [æ­ç¤ºç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œçš„è®¾è®¡æ¨¡å¼](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)ã€‚

è®°ä½è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼

## **ç›®å½•**

**Â·** **1\. æ¡ˆä¾‹ç ”ç©¶** **Â·** **2\. ä¸ºä»€ä¹ˆä¼ ç»Ÿæ–¹æ³•ä¸å¤Ÿæœ‰æ•ˆï¼Ÿ** **Â·** **3\. PINN åœ¨ç³»ç»Ÿè¯†åˆ«ä¸­çš„åº”ç”¨ï¼ˆç†è®ºï¼‰** **Â·** **4\. PINN åœ¨ç³»ç»Ÿè¯†åˆ«ä¸­çš„åº”ç”¨ï¼ˆä»£ç ï¼‰**

âˆ˜ 4.1 å®šä¹‰æ¶æ„

âˆ˜ 4.2 å®šä¹‰ ODE æŸå¤±

âˆ˜ 4.3 å®šä¹‰æ¢¯åº¦ä¸‹é™æ­¥éª¤

âˆ˜ 4.4 æ•°æ®å‡†å¤‡

âˆ˜ 4.5 PINN è®­ç»ƒ

**Â·** **5\. ç¬¦å·å›å½’**

âˆ˜ 5.1 PySR åº“

âˆ˜ 5.2 å®æ–½

âˆ˜ 5.3 è¯†åˆ«ç»“æœ

Â·**6\. æ€»ç»“**

Â· å‚è€ƒæ–‡çŒ®

# 1\. æ¡ˆä¾‹ç ”ç©¶

è®©æˆ‘ä»¬å¼€å§‹ä»‹ç»æˆ‘ä»¬æ—¨åœ¨è§£å†³çš„é—®é¢˜ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç°[Zhang et al](https://arxiv.org/abs/2307.08107)åŸå§‹è®ºæ–‡ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶ï¼Œå³ä»æ•°æ®ä¸­å‘ç° Kraichnan-Orszag ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿç”±ä»¥ä¸‹ ODEs æè¿°ï¼š

![](img/4160891a7e1d7f249bdbcd7d9e79508f.png)

å…·æœ‰åˆå§‹æ¡ä»¶ *u*â‚(0)=1ï¼Œ*u*â‚‚(0)=0.8ï¼Œ*u*â‚ƒ(0)=0.5ã€‚Kraichnan-Orszag ç³»ç»Ÿé€šå¸¸ç”¨äºæ¹æµç ”ç©¶å’Œæµä½“åŠ¨åŠ›å­¦ç ”ç©¶ï¼Œå…¶ç›®æ ‡æ˜¯å¯¹æ¹æµåŠå…¶ç»“æ„å’ŒåŠ¨æ€å‘å±•ç†è®ºè§è§£ã€‚

ä¸ºäº†æ¨¡æ‹Ÿä¸€ä¸ªå…¸å‹çš„ç³»ç»Ÿè¯†åˆ«è®¾ç½®ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬å¯¹æ§åˆ¶å¸¸å¾®åˆ†æ–¹ç¨‹çš„äº†è§£ä»…é™äºéƒ¨åˆ†å·²çŸ¥ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬å¯¹ *u*â‚ å’Œ *u*â‚‚ çš„å¾®åˆ†æ–¹ç¨‹ä¸€æ— æ‰€çŸ¥ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬åªçŸ¥é“ *u*â‚ƒ çš„å¾®åˆ†æ–¹ç¨‹å³ä¾§æ˜¯ *u*â‚ å’Œ *u*â‚‚ çš„çº¿æ€§å˜æ¢ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å¸¸å¾®åˆ†æ–¹ç¨‹ç³»ç»Ÿé‡å†™å¦‚ä¸‹ï¼š

![](img/03c35582b0c5f142b22932c1dae697e0.png)

å…¶ä¸­ *f*â‚ å’Œ *f*â‚‚ ä»£è¡¨æœªçŸ¥å‡½æ•°ï¼Œ*a* å’Œ *b* æ˜¯æœªçŸ¥å‚æ•°ã€‚**æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ ¡å‡† *a* å’Œ *b* çš„å€¼ï¼Œå¹¶ä¼°è®¡ *f*â‚ å’Œ *f*â‚‚ çš„è§£æå‡½æ•°å½¢å¼**ã€‚ æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æ­£é¢ä¸´ä¸€ä¸ªå…·æœ‰æœªçŸ¥å‚æ•°å’Œå‡½æ•°å½¢å¼çš„å¤æ‚ç³»ç»Ÿè¯†åˆ«é—®é¢˜ã€‚

# 2\. ä¸ºä»€ä¹ˆä¼ ç»Ÿæ–¹æ³•ä¼šå¤±è´¥ï¼Ÿ

åœ¨ä¼ ç»Ÿçš„ç³»ç»Ÿè¯†åˆ«èŒƒå¼ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°å€¼æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œæ¬§æ‹‰æ³•ã€é¾™æ ¼-åº“å¡”æ³•ç­‰ï¼‰æ¥æ¨¡æ‹Ÿå’Œé¢„æµ‹ç³»ç»ŸçŠ¶æ€ *u*â‚ã€*u*â‚‚ å’Œ *u*â‚ƒã€‚ ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•ä»æ ¹æœ¬ä¸Šå—é™ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸éœ€è¦å®Œæ•´çš„æ§åˆ¶å¾®åˆ†æ–¹ç¨‹å½¢å¼ï¼Œå¹¶ä¸”æ— æ³•å¤„ç†å¾®åˆ†æ–¹ç¨‹ä»…éƒ¨åˆ†å·²çŸ¥çš„æƒ…å†µã€‚

åœ¨æ–¹ç¨‹å‚æ•°æœªçŸ¥çš„æƒ…å†µä¸‹ï¼Œä¼ ç»Ÿæ–¹æ³•é€šå¸¸è¯‰è¯¸äºä¼˜åŒ–æŠ€æœ¯ï¼Œå…¶ä¸­å¯¹å‚æ•°è¿›è¡Œåˆæ­¥çŒœæµ‹ï¼Œç„¶åé€šè¿‡è¿­ä»£è¿‡ç¨‹æ¥ä¼˜åŒ–ï¼Œä»¥æœ€å°åŒ–è§‚å¯Ÿæ•°æ®ä¸æ•°å€¼æ±‚è§£å™¨é¢„æµ‹æ•°æ®ä¹‹é—´çš„å·®å¼‚ã€‚ç”±äºæ¯æ¬¡ä¼˜åŒ–è¿­ä»£éƒ½éœ€è¦è¿è¡Œä¸€æ¬¡æ•°å€¼æ±‚è§£å™¨ï¼Œè¿™ç§æ–¹æ³•è™½ç„¶å¯è¡Œï¼Œä½†è®¡ç®—å¼€é”€å¯èƒ½éå¸¸å¤§ã€‚

è¯·æ³¨æ„ï¼Œä¸Šè¿°è®¨è®ºä»…æè¿°äº†æ ¡å‡†æœªçŸ¥å‚æ•°çš„æƒ…å†µã€‚å½“æˆ‘ä»¬éœ€è¦ä¼°è®¡å¾®åˆ†æ–¹ç¨‹ä¸­çš„æœªçŸ¥å‡½æ•°æ—¶ï¼Œé—®é¢˜å˜å¾—æ›´åŠ å¤æ‚ã€‚ä»ç†è®ºä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç±»ä¼¼çš„æ–¹æ³•ï¼Œå³åœ¨ä¼˜åŒ–ä¹‹å‰å¯¹æœªçŸ¥å‡½æ•°çš„å½¢å¼åšå‡ºå‡è®¾ã€‚ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬èµ°è¿™æ¡è·¯ï¼Œä¼šç«‹å³å‡ºç°é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬å‡è®¾ä¸€ä¸ªè¿‡äºç®€å•çš„å½¢å¼ï¼Œæˆ‘ä»¬é¢ä¸´**æ¬ æ‹Ÿåˆ**çš„é£é™©ï¼Œè¿™å¯èƒ½å¯¼è‡´è¾ƒå¤§çš„é¢„æµ‹è¯¯å·®ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬å‡è®¾ä¸€ä¸ªè¿‡äºå¤æ‚çš„å½¢å¼ï¼ˆä¾‹å¦‚ï¼Œå…·æœ‰è®¸å¤šå¯è°ƒå‚æ•°ï¼‰ï¼Œæˆ‘ä»¬é¢ä¸´**è¿‡æ‹Ÿåˆ**çš„é£é™©ï¼Œè¿™å¯èƒ½å¯¼è‡´è¾ƒå·®çš„æ³›åŒ–æ€§èƒ½ã€‚

æ€»ä¹‹ï¼Œä¼ ç»Ÿæ–¹æ³•åœ¨å¤„ç†éƒ¨åˆ†å·²çŸ¥å¾®åˆ†æ–¹ç¨‹æ—¶é¢ä¸´é‡å¤§æŒ‘æˆ˜ï¼š

1ï¸âƒ£ ä¼ ç»Ÿæ•°å€¼æ–¹æ³•ä¾èµ–äºå…·æœ‰å®Œæ•´æ§åˆ¶å¾®åˆ†æ–¹ç¨‹çš„å½¢å¼æ¥è¿›è¡Œæ¨¡æ‹Ÿã€‚

2ï¸âƒ£ å°†ä¼ ç»Ÿæ•°å€¼æ–¹æ³•ä¸ä¼˜åŒ–ç®—æ³•ç»“åˆå¯ä»¥è§£å†³å‚æ•°ä¼°è®¡é—®é¢˜ï¼Œä½†é€šå¸¸ä»£ä»·å¾ˆé«˜ã€‚

3ï¸âƒ£ å¯¹äºåµŒå…¥å¾®åˆ†æ–¹ç¨‹ä¸­çš„æœªçŸ¥å‡½æ•°è¿›è¡Œä¼°è®¡æ—¶ï¼Œä¼ ç»Ÿæ–¹æ³•å¯èƒ½ä¼šå¾—åˆ°å¯¹å‡è®¾å‡½æ•°å½¢å¼é«˜åº¦æ•æ„Ÿçš„ç»“æœï¼Œè¿™ä¼šå¯¼è‡´æ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆçš„é£é™©ã€‚

é‰´äºè¿™äº›æŒ‘æˆ˜ï¼Œä¼ ç»Ÿæ–¹æ³•åœ¨å¤„ç†æœªçŸ¥å‚æ•°å’Œå‡½æ•°å½¢å¼å…±å­˜çš„ç³»ç»Ÿè¯†åˆ«é—®é¢˜æ—¶å¾€å¾€æ•ˆæœä¸ä½³ã€‚è¿™è‡ªç„¶å¼•å‡ºäº†ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œï¼ˆPINNsï¼‰çš„è¯é¢˜ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° PINN å¦‚ä½•æœ‰æ•ˆåœ°è§£å†³ä¼ ç»Ÿæ–¹æ³•é¢ä¸´çš„æŒ‘æˆ˜ã€‚

# **3\. PINN åœ¨ç³»ç»Ÿè¯†åˆ«ä¸­çš„åº”ç”¨ï¼ˆç†è®ºï¼‰**

ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œï¼ˆç®€ç§° PINNï¼‰æ˜¯[Raissi ç­‰äºº](https://www.sciencedirect.com/science/article/abs/pii/S0021999118307125)åœ¨ 2019 å¹´æå‡ºçš„ä¸€ä¸ªå¼ºå¤§æ¦‚å¿µã€‚PINN çš„åŸºæœ¬æ€æƒ³ï¼Œåƒå…¶ä»–*ç‰©ç†ä¿¡æ¯æœºå™¨å­¦ä¹ *æŠ€æœ¯ä¸€æ ·ï¼Œæ˜¯åˆ›å»ºä¸€ä¸ªæ··åˆæ¨¡å‹ï¼Œå…¶ä¸­åœ¨æ¨¡å‹è®­ç»ƒä¸­åˆ©ç”¨äº†è§‚å¯Ÿæ•°æ®å’Œå·²çŸ¥çš„ç‰©ç†çŸ¥è¯†ï¼ˆä»¥å¾®åˆ†æ–¹ç¨‹å½¢å¼è¡¨ç¤ºï¼‰ã€‚PINN æœ€åˆè¢«è®¾è®¡ä¸ºä¸€ä¸ªé«˜æ•ˆçš„ ODE/PDE æ±‚è§£å™¨ã€‚ç„¶è€Œï¼Œç ”ç©¶äººå‘˜å¾ˆå¿«è®¤è¯†åˆ° PINN åœ¨è§£å†³é€†é—®é¢˜å’Œç³»ç»Ÿè¯†åˆ«é—®é¢˜ä¸Šï¼ˆå¯ä»¥è¯´ï¼‰å…·æœ‰æ›´å¤§çš„æ½œåŠ›ã€‚

åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å°†é€ä¸€è§£é‡Šå¦‚ä½•åˆ©ç”¨ PINN å…‹æœæˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚è®¨è®ºçš„æŒ‘æˆ˜ã€‚

1ï¸âƒ£ ä¼ ç»Ÿæ•°å€¼æ–¹æ³•ä¾èµ–äºæ‹¥æœ‰å®Œæ•´å½¢å¼çš„ä¸»æ§å¾®åˆ†æ–¹ç¨‹æ¥è¿›è¡Œæ¨¡æ‹Ÿã€‚

ğŸ“£**PINN çš„å“åº”**ï¼šä¸ä¼ ç»Ÿæ–¹æ³•ä¸åŒï¼Œæˆ‘èƒ½å¤Ÿå¤„ç†éƒ¨åˆ†å·²çŸ¥çš„å¾®åˆ†æ–¹ç¨‹ï¼Œå› æ­¤ä¸å—å®Œæ•´æ–¹ç¨‹çš„é™åˆ¶æ¥è¿›è¡Œæ¨¡æ‹Ÿã€‚

ä»å¤–éƒ¨è§’åº¦çœ‹ï¼ŒPINN ä»…ä»…ç±»ä¼¼äºä¸€ä¸ªä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å°†æ—¶é—´/ç©ºé—´åæ ‡ï¼ˆä¾‹å¦‚ï¼Œ*t*ï¼Œ*x*ï¼Œ*y*ï¼‰ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¾“å‡ºæˆ‘ä»¬è¯•å›¾æ¨¡æ‹Ÿçš„ç›®æ ‡é‡ï¼ˆä¾‹å¦‚ï¼Œé€Ÿåº¦*u*ï¼Œå‹åŠ›*p*ï¼Œæ¸©åº¦*T*ç­‰ï¼‰ã€‚ç„¶è€Œï¼Œä½¿ PINN ä¸ä¼ ç»Ÿ NN ä¸åŒçš„æ˜¯ï¼Œåœ¨ PINN ä¸­ï¼Œå¾®åˆ†æ–¹ç¨‹ä½œä¸ºè®­ç»ƒè¿‡ç¨‹ä¸­çš„çº¦æŸã€‚å…·ä½“æ¥è¯´ï¼ŒPINN å¼•å…¥äº†ä¸€ä¸ªé¢å¤–çš„æŸå¤±é¡¹ï¼Œç”¨äºè®¡ç®—ä¸»æ§å¾®åˆ†æ–¹ç¨‹çš„æ®‹å·®ï¼Œè¯¥æ®‹å·®é€šè¿‡å°†é¢„æµ‹é‡ä»£å…¥ä¸»æ§æ–¹ç¨‹è®¡ç®—å¾—åˆ°ã€‚é€šè¿‡ä¼˜åŒ–è¿™ä¸ªæŸå¤±é¡¹ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°ä½¿è®­ç»ƒåçš„ç½‘ç»œæ„è¯†åˆ°æ½œåœ¨çš„ç‰©ç†è§„å¾‹ã€‚

![](img/ea45326f2cd4ae4f4d2a7a2054350c86.png)

å›¾ 2. ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œå°†å¾®åˆ†æ–¹ç¨‹çº³å…¥æŸå¤±å‡½æ•°ä¸­ï¼Œå› æ­¤æœ‰æ•ˆåœ°ä½¿è®­ç»ƒåçš„ç½‘ç»œæ„è¯†åˆ°æ½œåœ¨çš„ç‰©ç†è§„å¾‹ã€‚ï¼ˆå›¾åƒç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

ç”±äºå¾®åˆ†æ–¹ç¨‹ä»…ç”¨äºæ„å»ºæŸå¤±å‡½æ•°ï¼Œå› æ­¤å®ƒä»¬å¯¹ PINN æ¨¡å‹ç»“æ„æ²¡æœ‰å½±å“ã€‚è¿™å®é™…ä¸Šæ„å‘³ç€æˆ‘ä»¬åœ¨è®­ç»ƒæ—¶ä¸éœ€è¦å¯¹å¾®åˆ†æ–¹ç¨‹æœ‰å®Œå…¨çš„äº†è§£ã€‚å³ä½¿æˆ‘ä»¬åªçŸ¥é“æ–¹ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè¿™äº›çŸ¥è¯†ä»ç„¶å¯ä»¥è¢«çº³å…¥ä»¥å¼ºåˆ¶è¾“å‡ºéµå¾ªå·²çŸ¥çš„ç‰©ç†è§„å¾‹ã€‚è¿™ç§é€‚åº”çŸ¥è¯†å®Œæ•´åº¦ä¸åŒçš„çµæ´»æ€§ç›¸æ¯”ä¼ ç»Ÿæ•°å€¼æ–¹æ³•å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚

2ï¸âƒ£ ç»“åˆä¼ ç»Ÿæ•°å€¼æ–¹æ³•ä¸ä¼˜åŒ–ç®—æ³•å¯ä»¥è§£å†³å‚æ•°ä¼°è®¡é—®é¢˜ï¼Œä½†é€šå¸¸ä»£ä»·è¾ƒé«˜ã€‚

ğŸ“£**PINN çš„å›åº”**ï¼šæˆ‘å¯ä»¥æä¾›ä¸€ç§è®¡ç®—ä¸Šé«˜æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆæ¥ä¼°è®¡æœªçŸ¥å‚æ•°ã€‚

ä¸å°†å‚æ•°ä¼°è®¡è§†ä¸ºå•ç‹¬ä¼˜åŒ–ä»»åŠ¡çš„ä¼ ç»Ÿæ–¹æ³•ä¸åŒï¼ŒPINNs å°†è¿™ä¸€è¿‡ç¨‹æ— ç¼åœ°é›†æˆåˆ°æ¨¡å‹è®­ç»ƒé˜¶æ®µã€‚åœ¨ PINNs ä¸­ï¼ŒæœªçŸ¥å‚æ•°è¢«ç®€å•åœ°è§†ä¸ºé¢å¤–çš„å¯è®­ç»ƒå‚æ•°ï¼Œè¿™äº›å‚æ•°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸å…¶ä»–ç¥ç»ç½‘ç»œçš„æƒé‡å’Œåå·®ä¸€èµ·ä¼˜åŒ–ã€‚

![](img/e87cddadb163478ef75654173c1e5060.png)

å›¾ 3\. æœªçŸ¥å‚æ•°ä¸ PINN çš„æƒé‡å’Œåå·®ä¸€èµ·ä¼˜åŒ–ã€‚åœ¨è®­ç»ƒç»“æŸæ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æœ€ç»ˆå€¼ *a* å’Œ *b* ä½œä¸ºæœªçŸ¥å‚æ•°çš„ä¼°è®¡å€¼ã€‚ï¼ˆå›¾ç‰‡ç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

æ­¤å¤–ï¼ŒPINNs å……åˆ†åˆ©ç”¨ç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶æ¥æ‰§è¡Œè®­ç»ƒã€‚è¿™å…è®¸å¿«é€Ÿè®¡ç®—æ‰€éœ€çš„æ¢¯åº¦ï¼ˆå³é€šè¿‡è‡ªåŠ¨å¾®åˆ†ï¼‰ï¼Œä»¥ç”¨äºé«˜çº§ä¼˜åŒ–ç®—æ³•ï¼ˆä¾‹å¦‚ Adamï¼‰ï¼Œä»è€Œå¤§å¤§åŠ é€Ÿäº†å‚æ•°ä¼°è®¡è¿‡ç¨‹ï¼Œå°¤å…¶æ˜¯å¯¹äºé«˜ç»´å‚æ•°ç©ºé—´çš„é—®é¢˜ã€‚è¿™äº›å› ç´ ä½¿å¾— PINNs æˆä¸ºå‚æ•°ä¼°è®¡é—®é¢˜çš„ä¸€ä¸ªæœ‰ç«äº‰åŠ›çš„æ›¿ä»£æ–¹æ¡ˆã€‚

3ï¸âƒ£ å¯¹äºåµŒå…¥å¾®åˆ†æ–¹ç¨‹ä¸­çš„æœªçŸ¥å‡½æ•°ï¼Œä¼ ç»Ÿæ–¹æ³•å¯èƒ½ä¼šå¾—åˆ°å¯¹å‡è®¾å‡½æ•°å½¢å¼é«˜åº¦æ•æ„Ÿçš„ç»“æœï¼Œè¿™ä¼šäº§ç”Ÿæ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆçš„é£é™©ã€‚

ğŸ“£**PINN çš„å›åº”**ï¼šæœªçŸ¥å‡½æ•°å¯ä»¥é€šè¿‡é¢å¤–çš„ç¥ç»ç½‘ç»œæœ‰æ•ˆåœ°å‚æ•°åŒ–ï¼Œè¿™äº›ç¥ç»ç½‘ç»œå¯ä»¥ä¸æˆ‘ä¸€èµ·è®­ç»ƒï¼Œå°±åƒä¹‹å‰çš„å‚æ•°ä¼°è®¡åœºæ™¯ä¸€æ ·ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ç‹¬ç«‹çš„ç¥ç»ç½‘ç»œæ¥é€¼è¿‘æœªçŸ¥å‡½æ•°ï¼Œç„¶åå°†å®ƒä»¬é›†æˆåˆ°ä¸» PINN æ¨¡å‹ä¸­ã€‚å°±åƒåœ¨ä¹‹å‰çš„å‚æ•°ä¼°è®¡åœºæ™¯ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›é¢å¤–çš„ç¥ç»ç½‘ç»œè§†ä¸ºéœ€è¦ä¼°è®¡çš„å¤§é‡æœªçŸ¥å‚æ•°ã€‚

![](img/44e745359b4f6cee0d0649b3b12bb55e.png)

å›¾ 4ã€‚æœªçŸ¥å‡½æ•°å¯ä»¥é€šè¿‡ä¸€ä¸ªç‹¬ç«‹çš„ç¥ç»ç½‘ç»œè¿›è¡Œå‚æ•°åŒ–ï¼Œå¹¶ä¸åŸå§‹ PINN ä¸€èµ·è®­ç»ƒã€‚ODE/PDE æ®‹å·®æŸå¤±é¡¹å¯¹è¾…åŠ©ç¥ç»ç½‘ç»œè¿›è¡Œæ­£åˆ™åŒ–ï¼Œä»¥æ»¡è¶³æ§åˆ¶æ–¹ç¨‹ã€‚è¿™æ ·ï¼Œè¾…åŠ©ç¥ç»ç½‘ç»œå¯ä»¥ç›´æ¥ä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ æœ€ä½³çš„å‡½æ•°å½¢å¼ã€‚ï¼ˆå›¾åƒæ¥æºäºæœ¬åšå®¢ä½œè€…ï¼‰

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè¿™äº›è¾…åŠ©ç¥ç»ç½‘ç»œçš„æƒé‡å’Œåå·®å°†ä¸åŸå§‹ PINN åŒæ—¶è®­ç»ƒï¼Œä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼ˆæ•°æ®æŸå¤± + ODE æ®‹å·®æŸå¤±ï¼‰ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè¿™äº›è¾…åŠ©ç¥ç»ç½‘ç»œå¯ä»¥ç›´æ¥ä»æ•°æ®ä¸­å­¦ä¹ æœ€ä½³çš„å‡½æ•°å½¢å¼ã€‚é€šè¿‡æ¶ˆé™¤å¯¹å‡½æ•°å½¢å¼è¿›è¡Œé£é™©å‡è®¾çš„éœ€è¦ï¼Œè¿™ç§ç­–ç•¥æœ‰åŠ©äºç¼“è§£æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆçš„é—®é¢˜ã€‚

æ€»ç»“æ¥è¯´ï¼ŒPINN çš„ä¼˜åŠ¿åœ¨äºå…¶èƒ½å¤Ÿå¤„ç†éƒ¨åˆ†å·²çŸ¥çš„å¾®åˆ†æ–¹ç¨‹ï¼Œå¹¶æœ‰æ•ˆåœ°ä»æ•°æ®ä¸­å­¦ä¹ æœªçŸ¥å‚æ•°å’Œå‡½æ•°å½¢å¼ã€‚è¿™ç§å¤šåŠŸèƒ½æ€§ä½¿å…¶ä¸ä¼ ç»Ÿæ–¹æ³•åŒºåˆ«å¼€æ¥ï¼Œå› æ­¤æˆä¸ºç³»ç»Ÿè¯†åˆ«ä»»åŠ¡çš„æœ‰æ•ˆå·¥å…·ã€‚

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å¼€å§‹å¤„ç†æˆ‘ä»¬çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå¹¶å°†ç†è®ºè½¬åŒ–ä¸ºå®é™…ä»£ç ã€‚

# 4. PINN ç”¨äºç³»ç»Ÿè¯†åˆ«ï¼ˆä»£ç ï¼‰

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ª PINNï¼ˆåœ¨ TensorFlow ä¸­ï¼‰æ¥è§£å†³æˆ‘ä»¬çš„ç›®æ ‡æ¡ˆä¾‹ç ”ç©¶ã€‚è®©æˆ‘ä»¬ä»å¯¼å…¥å¿…è¦çš„åº“å¼€å§‹ï¼š

```py
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

import tensorflow as tf
from tensorflow import keras
tf.random.set_seed(42)
```

## 4.1 å®šä¹‰æ¶æ„

å¯¹äºä¸»è¦çš„ PINNï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥é¢„æµ‹***u***ï¼Œå…¶å…·æœ‰ 1 ç»´è¾“å…¥ï¼ˆå³*t*ï¼‰å’Œ 3 ç»´è¾“å‡ºï¼ˆ*u*â‚ã€*u*â‚‚å’Œ*u*â‚ƒï¼‰ã€‚æ­¤å¤–ï¼Œå¦‚å‰ä¸€èŠ‚æ‰€è®¨è®ºçš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¾…åŠ©ç¥ç»ç½‘ç»œæ¥é€¼è¿‘æœªçŸ¥å‡½æ•°*f*â‚å’Œ*f*â‚‚ï¼Œè¯¥ç½‘ç»œå…·æœ‰ 4 ç»´è¾“å…¥ï¼ˆå³*t*ã€*u*â‚ã€*u*â‚‚å’Œ*u*â‚ƒï¼‰å’Œ 2 ç»´è¾“å‡ºï¼ˆ*f*â‚å’Œ*f*â‚‚ï¼‰ã€‚æ•´ä½“ PINN çš„æ¶æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

![](img/335fd393f34cf3ca8a2d48b78cd079de.png)

å›¾ 5ã€‚æ‰€ä½¿ç”¨çš„ PINN æ¨¡å‹çš„æ¶æ„ã€‚ï¼ˆå›¾åƒæ¥æºäºæœ¬åšå®¢ä½œè€…ï¼‰

å€¼å¾—å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œéœ€è¦å‘è¾…åŠ©ç¥ç»ç½‘ç»œæä¾›æ‰€æœ‰å¯ç”¨çš„ç‰¹å¾ï¼ˆåœ¨æˆ‘ä»¬å½“å‰çš„æƒ…å†µä¸‹ï¼Œ*t*ã€*u*â‚ã€*u*â‚‚å’Œ*u*â‚ƒï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“*f*â‚å’Œ*f*â‚‚çš„ç¡®åˆ‡å‡½æ•°å½¢å¼ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè¾…åŠ©ç¥ç»ç½‘ç»œå°†ä»¥æ•°æ®é©±åŠ¨çš„æ–¹å¼è‡ªåŠ¨ç¡®å®šå“ªäº›ç‰¹å¾æ˜¯å¿…è¦çš„/é‡è¦çš„ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé¢„æµ‹***u***çš„ç¥ç»ç½‘ç»œã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªéšè—å±‚ï¼Œæ¯ä¸ªå±‚é…å¤‡ 50 ä¸ªç¥ç»å…ƒå’ŒåŒæ›²æ­£åˆ‡æ¿€æ´»å‡½æ•°ï¼š

```py
def u_net(u_input):
    """Definition of the network for u prediction.

    Args:
    ----
    u_input: input for the u-net

    Outputs:
    --------
    output: the output of u-net
    """

    hidden = u_input
    for _ in range(2):
        hidden = tf.keras.layers.Dense(50, activation="tanh")(hidden)
    output = tf.keras.layers.Dense(3)(hidden)

    return output
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé¢„æµ‹***f***çš„è¾…åŠ©ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬é‡‡ç”¨ç›¸åŒçš„ç½‘ç»œæ¶æ„ï¼š

```py
def f_net(f_inputs, a_init=None, b_init=None):
    """Definition of the network for f prediction.

    Args:
    ----
    f_inputs: list of inputs for the f-net
    a_init: initial value for parameter a
    b_init: initial value for parameter b

    Outputs:
    --------
    output: the output of f-net
    """

    hidden = tf.keras.layers.Concatenate()(f_inputs)
    for _ in range(2):
        hidden = tf.keras.layers.Dense(50, activation="tanh")(hidden)
    output = tf.keras.layers.Dense(2)(hidden)
    output = ParameterLayer(a_init, b_init)(output)

    return output
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†*a*å’Œ*b*æ·»åŠ åˆ°ç¥ç»ç½‘ç»œæ¨¡å‹å‚æ•°çš„é›†åˆä¸­ã€‚è¿™æ ·ï¼Œ*a*å’Œ*b*å¯ä»¥ä¸ç¥ç»ç½‘ç»œçš„å…¶ä»–æƒé‡å’Œåå·®ä¸€èµ·ä¼˜åŒ–ã€‚æˆ‘ä»¬é€šè¿‡å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å±‚`ParameterLayer`å®ç°äº†è¿™ä¸€ç›®æ ‡ï¼š

```py
class ParameterLayer(tf.keras.layers.Layer):

    def __init__(self, a, b, trainable=True):
        super(ParameterLayer, self).__init__()
        self._a = tf.convert_to_tensor(a, dtype=tf.float32)
        self._b = tf.convert_to_tensor(b, dtype=tf.float32)
        self.trainable = trainable

    def build(self, input_shape):
        self.a = self.add_weight("a", shape=(1,), 
                                 initializer=tf.keras.initializers.Constant(value=self._a),
                                 trainable=self.trainable)
        self.b = self.add_weight("b", shape=(1,), 
                                 initializer=tf.keras.initializers.Constant(value=self._b),
                                 trainable=self.trainable)

    def get_config(self):
        return super().get_config()

    @classmethod
    def from_config(cls, config):
        return cls(**config)
```

æ³¨æ„ï¼Œè¿™ä¸€å±‚é™¤äº†å¼•å…¥è¿™ä¸¤ä¸ªå‚æ•°ä½œä¸ºæ¨¡å‹å±æ€§å¤–æ²¡æœ‰å…¶ä»–ä½œç”¨ã€‚

æœ€åï¼Œæˆ‘ä»¬å°† *u*-net å’Œ *f*-net ç»“åˆåœ¨ä¸€èµ·ï¼Œå®šä¹‰å®Œæ•´çš„ PINN æ¶æ„ï¼š

```py
def create_PINN(a_init=None, b_init=None, verbose=False):
    """Definition of a PINN.

    Args:
    ----
    a_init: initial value for parameter a
    b_init: initial value for parameter b
    verbose: boolean, indicate whether to show the model summary

    Outputs:
    --------
    model: the PINN model
    """

    # Input
    t_input = tf.keras.Input(shape=(1,), name="time")

    # u-NN
    u = u_net(t_input)

    # f-NN
    f = f_net([t_input, u], a_init, b_init)

    # PINN model
    model = tf.keras.models.Model(inputs=t_input, outputs=[u, f])

    if verbose:
        model.summary()

    return model
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†è¾“å…¥ *t* å’Œ *u*-net è¾“å‡º *u*â‚, *u*â‚‚, å’Œ *u*â‚ƒ è¿›è¡Œä¸²è”ï¼Œç„¶åè¾“å…¥åˆ° *f*-net ä¸­ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨æ•´ä½“ PINN æ¨¡å‹ä¸­è¾“å‡º ***u*** å’Œ ***f***ã€‚è™½ç„¶åœ¨å®é™…åº”ç”¨ä¸­åªéœ€è¦ ***u***ï¼ˆå› ä¸º ***u*** æ˜¯æˆ‘ä»¬çš„å»ºæ¨¡ç›®æ ‡ï¼‰ï¼Œä½†åç»­ ***f*** çš„é¢„æµ‹ä¼šå˜å¾—æœ‰ç”¨ï¼Œä»¥æå–å…¶åˆ†æå‡½æ•°å½¢å¼ï¼ˆè§ç¬¬äº”éƒ¨åˆ†ï¼‰ã€‚

## 4.2 å®šä¹‰ ODE æŸå¤±

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰è®¡ç®— ODE æ®‹å·®æŸå¤±çš„å‡½æ•°ã€‚å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ ODEs æ˜¯ï¼š

![](img/b38eab8013ffaefb44572f7be65d94c1.png)

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®šä¹‰å‡½æ•°ï¼š

```py
@tf.function
def ODE_residual_calculator(t, model):
    """ODE residual calculation.

    Args:
    ----
    t: temporal coordinate
    model: PINN model

    Outputs:
    --------
    ODE_residual: residual of the governing ODE
    """

    # Retrieve parameters
    a = model.layers[-1].a
    b = model.layers[-1].b

    with tf.GradientTape() as tape:
        tape.watch(t)
        u, f = model(t)

    # Calculate gradients
    dudt = tape.batch_jacobian(u, t)[:, :, 0]
    du1_dt, du2_dt, du3_dt = dudt[:, :1], dudt[:, 1:2], dudt[:, 2:]

    # Compute residuals
    res1 = du1_dt - f[:, :1]
    res2 = du2_dt - f[:, 1:]
    res3 = du3_dt - (a*u[:, :1]*u[:, 1:2] + b)
    ODE_residual = tf.concat([res1, res2, res3], axis=1)

    return ODE_residual
```

è™½ç„¶ä¸Šè¿°ä»£ç å¤§éƒ¨åˆ†æ˜¯è‡ªè§£é‡Šçš„ï¼Œä½†æœ‰å‡ ä¸ªé—®é¢˜å€¼å¾—æåŠï¼š

+   æˆ‘ä»¬ä½¿ç”¨äº† `tf.GradientTape.batch_jacobian()`ï¼ˆè€Œä¸æ˜¯é€šå¸¸çš„ `GradientTape.gradient()`ï¼‰æ¥è®¡ç®— *u*â‚, *u*â‚‚ å’Œ *u*â‚ƒ ç›¸å¯¹äº *t* çš„æ¢¯åº¦ã€‚`GradientTape.gradient()` åœ¨è¿™é‡Œä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå®ƒè®¡ç®—çš„æ˜¯ d*u*â‚/dt + d*u*â‚‚/dt + d*u*â‚ƒ/dtã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ `GradientTape.jacobian()` æ¥è®¡ç®—æ¯ä¸ªè¾“å‡ºå€¼ç›¸å¯¹äºæ¯ä¸ªè¾“å…¥å€¼çš„æ¢¯åº¦ã€‚æœ‰å…³æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§ [å®˜æ–¹é¡µé¢](https://www.tensorflow.org/api_docs/python/tf/GradientTape#methods)ã€‚

+   æˆ‘ä»¬ä½¿ç”¨äº† `@tf.function` è£…é¥°å™¨å°†ä¸Šè¿° Python å‡½æ•°è½¬æ¢ä¸º TensorFlow å›¾ã€‚è¿™æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºæ¢¯åº¦è®¡ç®—å¯èƒ½éå¸¸æ˜‚è´µï¼Œä½¿ç”¨å›¾æ¨¡å¼æ‰§è¡Œå¯ä»¥æ˜¾è‘—åŠ é€Ÿè®¡ç®—ã€‚

## 4.3 å®šä¹‰æ¢¯åº¦ä¸‹é™æ­¥éª¤

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é…ç½®äº†è®¡ç®—æ€»æŸå¤±ç›¸å¯¹äºå‚æ•°ï¼ˆç½‘ç»œæƒé‡å’Œåå·®ï¼Œä»¥åŠæœªçŸ¥å‚æ•° *a* å’Œ *b*ï¼‰çš„æ¢¯åº¦çš„é€»è¾‘ã€‚è¿™å¯¹äºæ‰§è¡Œæ¨¡å‹è®­ç»ƒçš„æ¢¯åº¦ä¸‹é™æ˜¯å¿…è¦çš„ï¼š

```py
@tf.function
def train_step(X_ODE, X, y, IC_weight, ODE_weight, data_weight, model):
    """Calculate gradients of the total loss with respect to network model parameters.

    Args:
    ----
    X_ODE: collocation points for evaluating ODE residuals
    X: observed samples
    y: target values of the observed samples
    IC_weight: weight for initial condition loss
    ODE_weight: weight for ODE loss
    data_weight: weight for data loss
    model: PINN model

    Outputs:
    --------
    ODE_loss: calculated ODE loss
    IC_loss: calculated initial condition loss
    data_loss: calculated data loss
    total_loss: weighted sum of ODE loss, initial condition loss, and data loss
    gradients: gradients of the total loss with respect to network model parameters.
    """

    with tf.GradientTape() as tape:
        tape.watch(model.trainable_weights)

        # Initial condition prediction
        y_pred_IC, _ = model(tf.zeros((1, 1)))

        # ODE residual
        ODE_residual = ODE_residual_calculator(t=X_ODE, model=model)

        # Data loss
        y_pred_data, _ = model(X)

        # Calculate loss
        IC_loss = tf.reduce_mean(keras.losses.mean_squared_error(tf.constant([[1.0, 0.8, 0.5]]), y_pred_IC))
        ODE_loss = tf.reduce_mean(tf.square(ODE_residual))
        data_loss = tf.reduce_mean(keras.losses.mean_squared_error(y, y_pred_data))

        # Weight loss
        total_loss = IC_loss*IC_weight + ODE_loss*ODE_weight + data_loss*data_weight

    gradients = tape.gradient(total_loss, model.trainable_variables)

    return ODE_loss, IC_loss, data_loss, total_loss, gradients
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š

1.  æˆ‘ä»¬è€ƒè™‘ä¸‰ä¸ªæŸå¤±é¡¹ï¼šåˆå§‹æ¡ä»¶æŸå¤± `IC_loss`ã€ODE æ®‹å·®æŸå¤± `ODE_loss` å’Œæ•°æ®æŸå¤± `data_loss`ã€‚`IC_loss` é€šè¿‡å°†æ¨¡å‹é¢„æµ‹çš„***u***(*t*=0)ä¸å·²çŸ¥çš„***u***åˆå§‹å€¼è¿›è¡Œæ¯”è¾ƒæ¥è®¡ç®—ï¼Œ`ODE_loss` é€šè¿‡è°ƒç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ `ODE_residual_calculator` å‡½æ•°æ¥è®¡ç®—ï¼Œè€Œæ•°æ®æŸå¤±åˆ™æ˜¯é€šè¿‡å°†æ¨¡å‹é¢„æµ‹å€¼ï¼ˆå³ *u*â‚, *u*â‚‚, *u*â‚ƒï¼‰ä¸å®ƒä»¬çš„è§‚æµ‹å€¼è¿›è¡Œç®€å•æ¯”è¾ƒæ¥è®¡ç®—çš„ã€‚

1.  æˆ‘ä»¬å°†æ€»æŸå¤±å®šä¹‰ä¸º `IC_loss`ã€`ODE_loss` å’Œ `data_loss` çš„åŠ æƒå’Œã€‚é€šå¸¸ï¼Œæƒé‡æ§åˆ¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹å„ä¸ªæŸå¤±é¡¹çš„é‡è§†ç¨‹åº¦ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ç ”ç©¶ä¸­ï¼Œå°†å®ƒä»¬å…¨éƒ¨è®¾ç½®ä¸º 1 å°±è¶³å¤Ÿäº†ã€‚

## 4.4 æ•°æ®å‡†å¤‡

åœ¨æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ç»„ç»‡æ•°æ®ä»¥è¿›è¡Œ PINN æ¨¡å‹è®­ç»ƒã€‚

å›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„æ€»æŸå¤±å‡½æ•°åŒ…å« ODE æ®‹å·®æŸå¤±å’Œæ•°æ®æŸå¤±ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆæ—¶é—´ç»´åº¦ä¸Šçš„é…ç‚¹ï¼ˆç”¨äºè¯„ä¼° ODE æŸå¤±ï¼‰å’Œé…å¯¹è¾“å…¥(*t*)-è¾“å‡º(***u***)çš„ç›‘ç£æ•°æ®ã€‚

```py
# Set batch size
data_batch_size = 100
ODE_batch_size = 1000

# Samples for enforcing ODE residual loss
N_collocation = 10000
X_train_ODE = tf.convert_to_tensor(np.linspace(0, 10, N_collocation).reshape(-1, 1), dtype=tf.float32)
train_ds_ODE = tf.data.Dataset.from_tensor_slices((X_train_ODE))
train_ds_ODE = train_ds_ODE.shuffle(10*N_collocation).batch(ODE_batch_size)

# Samples for enforcing data loss
X_train_data = tf.convert_to_tensor(u_obs[:, :1], dtype=tf.float32)
y_train_data = tf.convert_to_tensor(u_obs[:, 1:], dtype=tf.float32)
train_ds_data = tf.data.Dataset.from_tensor_slices((X_train_data, y_train_data))
train_ds_data = train_ds_data.shuffle(10000).batch(data_batch_size)
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨ç›®æ ‡æ—¶é—´åŸŸ[0, 10]å†…åˆ†é…äº† 10000 ä¸ªç­‰é—´è·çš„é…ç‚¹ã€‚ä¸ºäº†æ–¹ä¾¿æ•°æ®æŸå¤±è®¡ç®—ï¼Œæˆ‘ä»¬é¢„ç”Ÿæˆäº†é…å¯¹è¾“å…¥(*t*)-è¾“å‡º(***u***)æ•°æ®é›†`u_obs`ï¼Œå…¶ç¬¬ä¸€åˆ—ä¸ºæ—¶é—´åæ ‡ï¼Œå…¶ä½™ä¸‰åˆ—åˆ†åˆ«è¡¨ç¤º *u*â‚ã€*u*â‚‚ å’Œ *u*â‚ƒã€‚`u_obs`åŒ…å« 1000 ä¸ªæ•°æ®ç‚¹ï¼Œè®¡ç®—æ–¹å¼å¦‚ä¸‹ä»£ç ï¼š

```py
# Set up simulation
u_init = [1, 0.8, 0.5]
t_span = [0, 10]
obs_num = 1000

# Solve ODEs
u_obs = simulate_ODEs(u_init, t_span, obs_num)
```

å…¶ä¸­ `simulate_ODEs` æ˜¯ ODE æ±‚è§£å™¨ï¼Œå®ƒåœ¨ç»™å®šåˆå§‹æ¡ä»¶å’Œæ¨¡æ‹ŸåŸŸçš„æƒ…å†µä¸‹æ¨¡æ‹Ÿ***u***è½¨è¿¹ï¼š

```py
def simulate_ODEs(u_init, t_span, obs_num):
    """Simulate the ODE system and obtain observational data. 

    Args:
    ----
    u_init: list of initial condition for u1, u2, and u3
    t_span: lower and upper time limit for simulation
    obs_num: number of observational data points

    Outputs:
    --------
    u_obs: observed data for u's
    """

    # Target ODEs
    def odes(t, u):
        du1dt = np.exp(-t/10) * u[1] * u[2]
        du2dt = u[0] * u[2]
        du3dt = -2 * u[0] * u[1]
        return [du1dt, du2dt, du3dt]

    # Solve ODEs
    t_eval = np.linspace(t_span[0], t_span[1], obs_num)
    sol = solve_ivp(odes, t_span, u_init, method='RK45', t_eval=t_eval)

    # Restrcture solution
    u_obs = np.column_stack((sol.t, sol.y[0], sol.y[1], sol.y[2]))

    return u_obs
```

ä¸‹å›¾å±•ç¤ºäº†ç›®æ ‡***u***çš„è½®å»“ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»æŠ½å–äº† 1000 ä¸ªç­‰é—´è·çš„ (*t* â€” *u*â‚)ã€(*t* â€” *u*â‚‚) å’Œ (*t* â€” *u*â‚ƒ) æ•°æ®å¯¹ï¼ˆåŒ…å«åœ¨`u_obs`ä¸­ï¼‰ï¼Œä½œä¸ºæ•°æ®æŸå¤±è®¡ç®—çš„ç›‘ç£æ•°æ®ã€‚

![](img/41569446dc20349a0521acc759aafbfe.png)

å›¾ 6\. æˆ‘ä»¬å½“å‰ç ”ç©¶çš„ ODE çš„è¾“å‡ºè½®å»“ã€‚ï¼ˆå›¾åƒç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

## 4.5 PINN è®­ç»ƒ

ä»¥ä¸‹ä»£ç å®šä¹‰äº†ä¸»è¦çš„è®­ç»ƒå’ŒéªŒè¯é€»è¾‘ï¼š

```py
# Set up training configurations
n_epochs = 1000
IC_weight= tf.constant(1.0, dtype=tf.float32)   
ODE_weight= tf.constant(1.0, dtype=tf.float32)
data_weight= tf.constant(1.0, dtype=tf.float32)
a_list, b_list = [], []

# Initial value for unknown parameters
a_init, b_init = -1, 1

# Set up optimizer
optimizer = keras.optimizers.Adam(learning_rate=2e-2)

# Instantiate the PINN model
PINN = create_PINN(a_init=a_init, b_init=b_init)
PINN.compile(optimizer=optimizer)

# Configure callbacks
_callbacks = [keras.callbacks.ReduceLROnPlateau(factor=0.5, patience=100),
             tf.keras.callbacks.ModelCheckpoint('PINN_model.h5', monitor='val_loss', save_best_only=True)]
callbacks = tf.keras.callbacks.CallbackList(
                _callbacks, add_history=False, model=PINN)

# Start training process
for epoch in range(1, n_epochs + 1):  
    print(f"Epoch {epoch}:")

    for (X_ODE), (X, y) in zip(train_ds_ODE, train_ds_data):

        # Calculate gradients
        ODE_loss, IC_loss, data_loss, total_loss, gradients = train_step(X_ODE, X, y, IC_weight, 
                                                                         ODE_weight, data_weight, PINN)
        # Gradient descent
        PINN.optimizer.apply_gradients(zip(gradients, PINN.trainable_variables))

    # Parameter recording
    a_list.append(PINN.layers[-1].a.numpy())
    b_list.append(PINN.layers[-1].b.numpy())

    ####### Validation
    val_res = ODE_residual_calculator(tf.reshape(tf.linspace(0.0, 10.0, 1000), [-1, 1]), PINN)
    val_ODE = tf.cast(tf.reduce_mean(tf.square(val_res)), tf.float32)

    u_init=tf.constant([[1.0, 0.8, 0.5]])
    val_pred_init, _ = PINN.predict(tf.zeros((1, 1)))
    val_IC = tf.reduce_mean(tf.square(val_pred_init-u_init))

    # Callback at the end of epoch
    callbacks.on_epoch_end(epoch, logs={'val_loss': val_IC+val_ODE})

    # Re-shuffle dataset
    train_ds_data = tf.data.Dataset.from_tensor_slices((X_train_data, y_train_data))
    train_ds_data = train_ds_data.shuffle(10000).batch(data_batch_size) 

    train_ds_ODE = tf.data.Dataset.from_tensor_slices((X_train_ODE))
    train_ds_ODE = train_ds_ODE.shuffle(10*N_collocation).batch(ODE_batch_size) 
```

+   æ­£å¦‚ä¹‹å‰è®¨è®ºçš„ï¼Œæˆ‘ä»¬å°†ä¸åŒæŸå¤±ç»„ä»¶çš„æƒé‡è®¾ç½®ä¸º 1ã€‚

+   æˆ‘ä»¬å°† *a* å’Œ *b* çš„åˆå§‹çŒœæµ‹è®¾ç½®ä¸º-1 å’Œ 1ï¼Œåˆ†åˆ«ã€‚å›å¿†ä¸€ä¸‹ï¼Œè¿™äº›å€¼ä¸å®ƒä»¬çš„çœŸå®å€¼ä¸åŒï¼ŒçœŸå®å€¼åˆ†åˆ«ä¸º-2 å’Œ 0ã€‚

+   ä¸ºäº†éªŒè¯ï¼Œæˆ‘ä»¬å°† ODE æ®‹å·®æŸå¤±å’Œåˆå§‹æ¡ä»¶æŸå¤±ç›¸åŠ ï¼Œä½œä¸ºæœ€ç»ˆçš„éªŒè¯æŸå¤±ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸è€ƒè™‘æ•°æ®æŸå¤±ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾æ²¡æœ‰é¢å¤–çš„é…å¯¹ *t* â€” **u** æ•°æ®é›†ç”¨äºéªŒè¯ç›®çš„ã€‚è®¡ç®—å‡ºçš„éªŒè¯æŸå¤±ç”¨äºè°ƒæ•´å­¦ä¹ ç‡ã€‚

ä¸‹å›¾å±•ç¤ºäº†æŸå¤±æ”¶æ•›æ›²çº¿ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¸‰ä¸ªæŸå¤±ç»„ä»¶éƒ½æ­£ç¡®æ”¶æ•›ï¼Œè¿™è¡¨æ˜è®­ç»ƒå·²æ»¡æ„å®Œæˆã€‚

![](img/dd9788e21fc94bbf65450ede3abd0962.png)

å›¾ 7\. æŸå¤±æ”¶æ•›å›¾ã€‚ï¼ˆå›¾åƒç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

ä¸‹å›¾å±•ç¤ºäº†é¢„æµ‹çš„***u***ä¸é€šè¿‡ ODE æ±‚è§£å™¨è®¡ç®—çš„çœŸå®å€¼ä¹‹é—´çš„æ¯”è¾ƒã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ° PINN èƒ½å¤Ÿå‡†ç¡®åœ°è§£å†³æˆ‘ä»¬çš„ç›®æ ‡ ODEã€‚

![](img/4f0a4ec20674c126dda63aa99008a376.png)

å›¾ 8\. é¢„æµ‹çš„**u**ä¸ ODE æ±‚è§£å™¨è®¡ç®—çš„çœŸå®å€¼çš„æ¯”è¾ƒã€‚

ç„¶è€Œï¼Œè®­ç»ƒ PINN å¹¶ä¸æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡ã€‚ç›¸åï¼Œæˆ‘ä»¬æ›´æ„Ÿå…´è¶£çš„æ˜¯ä¼°è®¡æˆ‘ä»¬ç›®æ ‡ ODE ä¸­åµŒå…¥çš„æœªçŸ¥æ•°ã€‚è®©æˆ‘ä»¬ä»å‚æ•°ä¼°è®¡å¼€å§‹ã€‚ä¸‹å›¾æç»˜äº† *a* å’Œ *b* çš„æ¼”å˜ã€‚

![](img/3592d8cbb99c73826e321f9a816bc1c0.png)

å›¾ 9\. æœªçŸ¥å‚æ•° a å’Œ b è¿…é€Ÿè„±ç¦»äº†æŒ‡å®šçš„åˆå§‹å€¼ï¼Œå¹¶æ”¶æ•›åˆ°å®ƒä»¬çš„çœŸå®å€¼ã€‚è¿™è¡¨æ˜æ‰€é‡‡ç”¨çš„ PINN ç­–ç•¥èƒ½å¤Ÿå¯¹ ODE ç³»ç»Ÿè¿›è¡Œå‚æ•°ä¼°è®¡ã€‚ï¼ˆå›¾ç‰‡ç”±æœ¬åšå®¢ä½œè€…æä¾›ï¼‰

æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ*a*å’Œ*b*çš„å€¼è¿…é€Ÿæ”¶æ•›åˆ°å„è‡ªçš„çœŸå®å€¼ã€‚è¿™è¡¨æ˜æˆ‘ä»¬çš„ PINN ç­–ç•¥åœ¨å‚æ•°ä¼°è®¡æ–¹é¢æ˜¯æœ‰æ•ˆçš„ã€‚

é™¤äº†æœªçŸ¥å‚æ•°å¤–ï¼Œæˆ‘ä»¬è¿˜é€šè¿‡è®­ç»ƒå¥½çš„è¾…åŠ©*f*-ç½‘ç»œè·å¾—äº†æœªçŸ¥å‡½æ•°*f*â‚å’Œ*f*â‚‚çš„ä¼°è®¡å€¼ã€‚ä¸ºäº†æ£€æŸ¥*f*â‚å’Œ*f*â‚‚çš„è¿‘ä¼¼ç²¾åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä¸è®¡ç®—å¾—åˆ°çš„ d*u*â‚/dt å’Œ d*u*â‚‚/dt è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

```py
X_test = np.linspace(0, 10, 1000).reshape(-1, 1)
X_test = tf.convert_to_tensor(X_test, dtype=tf.float32)

with tf.GradientTape() as tape:
    tape.watch(X_test)
    u, f = PINN(X_test)

# Calculate gradients
dudt = tape.batch_jacobian(u, X_test)[:, :, 0]
du1_dt, du2_dt = dudt[:, :1], dudt[:, 1:2]

# Visualize comparison
fig, ax = plt.subplots(1, 2, figsize=(10, 4))

ax[0].scatter(du1_dt.numpy().flatten(), f[:, 0].numpy())
ax[0].set_xlabel('$du_1$/dt', fontsize=14)
ax[0].set_ylabel('$f_1$', fontsize=14)

ax[1].scatter(du2_dt.numpy().flatten(), f[:, 1].numpy())
ax[1].set_xlabel('$du_2$/dt', fontsize=14)
ax[1].set_ylabel('$f_2$', fontsize=14)

for axs in ax:
    axs.tick_params(axis='both', which='major', labelsize=12)
    axs.grid(True)

plt.tight_layout()
```

ä»ä¸‹å›¾ä¸­æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œ*f*-ç½‘ç»œçš„é¢„æµ‹å®Œå…¨ç¬¦åˆæ§åˆ¶ ODEï¼Œè¿™ä¸ä¹‹å‰è§‚å¯Ÿåˆ°çš„ ODE æ®‹å·®éå¸¸å°çš„æƒ…å†µä¸€è‡´ã€‚

![](img/9fc0758840eec2ad6f74ee4b6b634bfd.png)

å›¾ 10\. è®¡ç®—å‡ºçš„å¯¼æ•°ä¸é¢„æµ‹çš„**f**å‡½æ•°å€¼çš„æ¯”è¾ƒã€‚

å°½ç®¡æˆ‘ä»¬å¯ä»¥ç”¨*f*-ç½‘ç»œå‡†ç¡®åœ°é€¼è¿‘æœªçŸ¥å‡½æ•°*f*â‚å’Œ*f*â‚‚ï¼Œä½†å½’æ ¹ç»“åº•ï¼Œ*f*-ç½‘ç»œæ˜¯ä¸€ä¸ª**é»‘ç®±**ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚è‡ªç„¶åœ°ï¼Œæˆ‘ä»¬ä¼šæƒ³é—®ï¼šè¿™äº›ä¼°è®¡å‡½æ•°çš„ç¡®åˆ‡åŠŸèƒ½å½¢å¼æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸ªç­”æ¡ˆå¯ä»¥ä¸ºæˆ‘ä»¬æä¾›å¯¹æ½œåœ¨ç‰©ç†è¿‡ç¨‹çš„æ›´æ·±å…¥ç†è§£ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬å°†ç»“æœæ¨å¹¿åˆ°å…¶ä»–ç±»ä¼¼çš„é—®é¢˜ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•ä»è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­æå–è¿™äº›ç²¾ç¡®çš„åŠŸèƒ½å½¢å¼å‘¢ï¼Ÿæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­æ¢è®¨è¿™ä¸ªé—®é¢˜ã€‚

# 5\. ç¬¦å·å›å½’

ç¬¦å·å›å½’æ˜¯ä¸€ç§å¼ºå¤§çš„ç›‘ç£å­¦ä¹ æŠ€æœ¯ï¼Œå¯ä»¥ç”¨æ¥å‘ç°æœ€é€‚åˆç»™å®šæ•°æ®é›†çš„æ½œåœ¨æ•°å­¦å…¬å¼ã€‚æ­£å¦‚å…¶åç§°æ‰€ç¤ºï¼Œè¿™é¡¹æŠ€æœ¯åŒ…æ‹¬ä¸¤ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†ï¼š**ç¬¦å·**å’Œ**å›å½’**ï¼š

+   *ç¬¦å·*æŒ‡çš„æ˜¯ä½¿ç”¨ç¬¦å·è¡¨è¾¾å¼æ¥å»ºæ¨¡è¾“å…¥è¾“å‡ºå…³ç³»ï¼Œä¾‹å¦‚ï¼Œâ€œ+â€è¡¨ç¤ºåŠ æ³•ï¼Œâ€œ-â€è¡¨ç¤ºå‡æ³•ï¼Œâ€œcosâ€è¡¨ç¤ºä½™å¼¦å‡½æ•°ç­‰ã€‚ç¬¦å·å›å½’æ–¹æ³•ä¸æ˜¯æ‹Ÿåˆé¢„å®šä¹‰æ¨¡å‹ï¼ˆä¾‹å¦‚ï¼Œå¤šé¡¹å¼æ¨¡å‹ç­‰ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡æ•´ä¸ªæ½œåœ¨ç¬¦å·è¡¨è¾¾å¼çš„ç©ºé—´è¿›è¡Œæœç´¢ï¼Œä»¥æ‰¾åˆ°æœ€ä½³æ‹Ÿåˆã€‚

+   *å›å½’*æŒ‡çš„æ˜¯åˆ›å»ºä¸€ä¸ªæ¨¡å‹ä»¥é¢„æµ‹è¾“å‡ºå˜é‡çš„è¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹åŸºäºè¾“å…¥å˜é‡ï¼Œä»è€Œæ•æ‰å®ƒä»¬ä¹‹é—´çš„æ½œåœ¨å…³ç³»ã€‚å°½ç®¡â€œå›å½’â€ä¸€è¯å¯èƒ½ä¼šè®©äººè”æƒ³åˆ°çº¿æ€§å›å½’ï¼Œä½†åœ¨ç¬¦å·å›å½’çš„èƒŒæ™¯ä¸‹ï¼Œå®ƒå¹¶ä¸å±€é™äºä»»ä½•ç‰¹å®šçš„æ¨¡å‹å½¢å¼ï¼Œè€Œæ˜¯å¯ä»¥é‡‡ç”¨å„ç§æ•°å­¦è¿ç®—ç¬¦å’Œç»“æ„ã€‚

åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å®ç°ç¬¦å·å›å½’æŠ€æœ¯ï¼Œå°†å­¦ä¹ åˆ°çš„ *f*-ç½‘ç»œæç‚¼æˆå¯è§£é‡Šä¸”ç´§å‡‘çš„æ•°å­¦è¡¨è¾¾å¼ï¼Œè¿™ä¸å¼ ç­‰äººåœ¨ä»–ä»¬çš„åŸå§‹è®ºæ–‡ä¸­æå‡ºçš„ç­–ç•¥ä¸€è‡´ã€‚æˆ‘ä»¬å°†é¦–å…ˆä»‹ç»å°†ç”¨äºç¬¦å·å›å½’çš„åº“ PySRã€‚éšåï¼Œæˆ‘ä»¬å°†åº”ç”¨è¿™ä¸ªåº“è§£å†³æˆ‘ä»¬çš„è¯¾é¢˜ï¼Œå¹¶è®¨è®ºè¶…å‚æ•°çš„é€‰æ‹©ã€‚æœ€åï¼Œæˆ‘ä»¬å°†åˆ†æè·å¾—çš„ç»“æœã€‚

## 5.1 PySR åº“

[PySR](https://astroautomata.com/PySR/) æ˜¯ä¸€ä¸ªå¼€æº Python åº“ï¼Œæ—¨åœ¨æä¾›å®ç”¨çš„é«˜æ€§èƒ½ç§‘å­¦ç¬¦å·å›å½’ã€‚å®ƒä½¿ç”¨å…ˆè¿›çš„ *evolutionary* ä¼˜åŒ–ç®—æ³•åœ¨ç®€å•è§£æè¡¨è¾¾å¼çš„ç©ºé—´ä¸­æœç´¢ï¼Œä»¥è·å¾—å‡†ç¡®ä¸”å¯è§£é‡Šçš„æ¨¡å‹ï¼Œä»è€Œå°†é¢„æµ‹è¯¯å·®å’Œæ¨¡å‹å¤æ‚åº¦å…±åŒæœ€å°åŒ–ã€‚

å°½ç®¡ PySR æš´éœ²äº†ä¸€ä¸ªç±»ä¼¼äº `scikit-learn` é£æ ¼çš„ç®€å• Python å‰ç«¯ APIï¼Œä½†å…¶åå°æ˜¯ç”¨çº¯ Julia ç¼–å†™çš„ï¼Œåº“åä¸º *SymbolicRegression.jl*ã€‚è¿™ä¸ºç”¨æˆ·æä¾›äº†å®šåˆ¶æ“ä½œç¬¦å’Œä¼˜åŒ–æŸå¤±å‡½æ•°çš„çµæ´»æ€§ï¼ŒåŒæ—¶äº«æœ‰é«˜è®¡ç®—æ€§èƒ½ã€‚æœ‰å…³ PySR å·¥ä½œåŸç†çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§[è¿™ç¯‡è®ºæ–‡](https://arxiv.org/abs/2305.01582)ã€‚

è¦å¼€å§‹ä½¿ç”¨ PySRï¼Œä½ éœ€è¦é¦–å…ˆ[å®‰è£… Julia](https://julialang.org/downloads/)ã€‚ç„¶åè¿è¡Œ

```py
pip3 install -U pysr
```

ç„¶åé€šè¿‡

```py
python3 -m pysr install
```

æˆ–è€…åœ¨ IPython ä¸­è°ƒç”¨

```py
import pysr
pysr.install()
```

PySR ä¹Ÿå¯ä»¥é€šè¿‡ conda æˆ– docker å®‰è£…ã€‚è¯·æŸ¥çœ‹[å®‰è£…é¡µé¢](https://astroautomata.com/PySR/)ä»¥è·å–æ›´å¤šç»†èŠ‚ã€‚

## 5.2 å®æ–½

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åº”ç”¨ PySR åº“å°†å­¦ä¹ åˆ°çš„ *f*-ç½‘ç»œæç‚¼æˆå¯è§£é‡Šä¸”ç´§å‡‘çš„æ•°å­¦è¡¨è¾¾å¼ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆç¬¦å·å›å½’å­¦ä¹ çš„æ•°æ®é›†ï¼š

```py
t = np.linspace(0, 10, 10000).reshape(-1, 1)
u, f = PINN.predict(t, batch_size=12800)

# Configure dataframe
df = pd.DataFrame({
    't': t.flatten(),
    'u1': u[:, 0],
    'u2': u[:, 1],
    'u3': u[:, 2],
    'f1': f[:, 0],
    'f2': f[:, 1]
})
df.to_csv('f_NN_IO.csv', index=False)
```

è¯·æ³¨æ„ï¼Œå¯¹äºæˆ‘ä»¬å½“å‰çš„é—®é¢˜ï¼Œç¬¦å·å›å½’å­¦ä¹ çš„è¾“å…¥æ˜¯ *t*ã€*u*â‚ã€*u*â‚‚ å’Œ *u*â‚ƒï¼Œè¾“å‡ºæ˜¯ *f*â‚ å’Œ *f*â‚‚ã€‚è¿™æ˜¯å› ä¸ºåœ¨æˆ‘ä»¬çš„ç›®æ ‡ ODE ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ *f*â‚=*f*â‚(*t*ã€*u*â‚ã€*u*â‚‚ã€*u*â‚ƒ) å’Œ *f*â‚‚=*f*â‚‚(*t*ã€*u*â‚ã€*u*â‚‚ã€*u*â‚ƒ)ã€‚æˆ‘ä»¬ä¿å­˜äº†ç”Ÿæˆçš„æ•°æ®æ¡†ï¼ˆè§ä¸‹å›¾ï¼‰ä»¥å¤‡åç”¨ã€‚

![](img/1b0a3ff76c4ad0f3a7ddfc87cfd11ef4.png)

å›¾ 11\. ç”Ÿæˆçš„ç¬¦å·å›å½’å­¦ä¹ æ•°æ®æ¡†ã€‚ï¼ˆå›¾ç‰‡æ¥æºï¼šæœ¬åšå®¢ä½œè€…ï¼‰

ç”Ÿæˆæ•°æ®é›†åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ PySR è¿›è¡Œç¬¦å·å›å½’äº†ã€‚è¯·æ³¨æ„ï¼Œå»ºè®®åœ¨ç»ˆç«¯ä¸­è¿è¡Œ PySR ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨ Jupyter Notebook ä¸­ã€‚å°½ç®¡ PySR æ”¯æŒ Jupyter Notebookï¼Œä½†åœ¨ç»ˆç«¯ç¯å¢ƒä¸­çš„æ‰“å°ï¼ˆä¾‹å¦‚ï¼Œæœç´¢è¿›åº¦ã€å½“å‰æœ€ä½³ç»“æœç­‰ï¼‰æ•ˆæœè¦æ›´å¥½ã€‚

æŒ‰ç…§ `scikit-learn` é£æ ¼ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼š

```py
from pysr import PySRRegressor

model = PySRRegressor(
    niterations=20,  
    binary_operators=["+", "*"],
    unary_operators=[
        "cos",
        "exp",
        "sin",
        "inv(x) = 1/x",
    ],
    extra_sympy_mappings={"inv": lambda x: 1 / x},
    loss="L1DistLoss()",
    model_selection="score",
    complexity_of_operators={
        "sin": 3, "cos": 3, "exp": 3,
        "inv(x) = 1/x": 3
    }
)
```

ä»¥ä¸‹æ˜¯æŒ‡å®šè¶…å‚æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼š

+   `niterations`ï¼šç®—æ³•è¿è¡Œçš„è¿­ä»£æ¬¡æ•°ã€‚é€šå¸¸ï¼Œè¾ƒå¤§çš„è¿­ä»£æ¬¡æ•°ä¼šäº§ç”Ÿæ›´å¥½çš„ç»“æœï¼Œä½†ä»£ä»·æ˜¯æ›´é«˜çš„è®¡ç®—æˆæœ¬ã€‚ç„¶è€Œï¼Œç”±äº PySR å…è®¸æå‰ç»ˆæ­¢æœç´¢ä»»åŠ¡ï¼Œå¥½çš„åšæ³•æ˜¯å°† `niterations` è®¾ç½®ä¸ºä¸€ä¸ªéå¸¸å¤§çš„å€¼å¹¶ä¿æŒä¼˜åŒ–è¿›è¡Œã€‚ä¸€æ—¦è¯†åˆ«å‡ºçš„æ–¹ç¨‹çœ‹èµ·æ¥ä»¤äººæ»¡æ„ï¼Œå°±å¯ä»¥æå‰åœæ­¢ä»»åŠ¡ã€‚

+   `binary_operators`ï¼šç”¨äºæœç´¢çš„äºŒå…ƒè¿ç®—ç¬¦å­—ç¬¦ä¸²åˆ—è¡¨ã€‚PySR æ”¯æŒçš„å†…ç½®äºŒå…ƒè¿ç®—ç¬¦åŒ…æ‹¬ `+`ã€`-`ã€`*`ã€`/`ã€`^`ã€`greater`ã€`mod`ã€`logical_or`ã€`logical_and`ã€‚

+   `unary_operators`ï¼šç”¨äºæœç´¢çš„ä¸€å…ƒè¿ç®—ç¬¦åˆ—è¡¨ã€‚æ³¨æ„ï¼Œä¸€å…ƒè¿ç®—ç¬¦åªæ¥å—å•ä¸ªæ ‡é‡ä½œä¸ºè¾“å…¥ã€‚å†…ç½®çš„ä¸€å…ƒè¿ç®—ç¬¦åŒ…æ‹¬ `neg`ã€`square`ã€`cube`ã€`exp`ã€`abs`ã€`log`ã€`log10`ã€`log2`ã€`log1p`ã€`sqrt`ã€`sin`ã€`cos`ã€`tan`ã€`sinh`ã€`cosh`ã€`tanh`ã€`atan`ã€`asinh`ã€`acosh`ã€`atanh_clip`ï¼ˆ=atanh((x+1)%2 - 1)ï¼‰ã€`erf`ã€`erfc`ã€`gamma`ã€`relu`ã€`round`ã€`floor`ã€`ceil`ã€`round`ã€`sign`ã€‚æ³¨æ„ï¼Œè¦æä¾›è‡ªå®šä¹‰è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬éœ€è¦å°†â€œmyfunction(x) = â€¦â€ä¼ é€’ç»™è¿ç®—ç¬¦åˆ—è¡¨ï¼Œå°±åƒæˆ‘ä»¬ç”¨â€œinv(x) = 1/xâ€åšçš„é‚£æ ·ã€‚

+   `extra_sympy_mappings`ï¼šæä¾›è‡ªå®šä¹‰çš„ `binary_operators` æˆ– `unary_operators` åœ¨ julia å­—ç¬¦ä¸²ä¸­ä¸ [sympy](https://www.sympy.org/en/index.html) ä¸­ç›¸åŒè¿ç®—ç¬¦çš„æ˜ å°„ã€‚è¿™åœ¨å¯¼å‡ºç»“æœæ—¶éå¸¸æœ‰ç”¨ã€‚

+   `loss`ï¼šæŒ‡å®šå…ƒç´ çº§æŸå¤±å‡½æ•°çš„ Julia ä»£ç å­—ç¬¦ä¸²ï¼ˆå¦‚åœ¨ LossFunctions.jl ä¸­å®šä¹‰ï¼‰ã€‚å¸¸ç”¨çš„æŸå¤±åŒ…æ‹¬ `L1DistLoss()`ï¼ˆç»å¯¹è·ç¦»æŸå¤±ï¼‰ã€`L2DistLoss()`ï¼ˆæœ€å°äºŒä¹˜æŸå¤±ï¼‰ã€`HuberLoss()`ï¼ˆç”¨äºæŠ—ç¦»ç¾¤å€¼çš„ Huber æŸå¤±å‡½æ•°ï¼‰ã€‚æŸå¤±å‡½æ•°æŒ‡å®šäº†ç¬¦å·å›å½’æœç´¢çš„ä¼˜åŒ–ç›®æ ‡ã€‚

+   `model_selection`ï¼šä»æ¯ä¸ªå¤æ‚åº¦çš„æœ€ä½³è¡¨è¾¾å¼åˆ—è¡¨ä¸­é€‰æ‹©æœ€ç»ˆè¡¨è¾¾å¼çš„æ ‡å‡†ã€‚`score` æ„å‘³ç€å€™é€‰æ¨¡å‹å°†æ ¹æ®æœ€é«˜å¾—åˆ†è¿›è¡Œé€‰æ‹©ï¼Œå¾—åˆ†å®šä¹‰ä¸º -Î”log(loss)/Î”Cï¼Œå…¶ä¸­ C ä»£è¡¨è¡¨è¾¾å¼çš„å¤æ‚åº¦ï¼ŒÎ” è¡¨ç¤ºå±€éƒ¨å˜åŒ–ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼åœ¨ç¨é«˜çš„å¤æ‚åº¦ä¸‹å…·æœ‰æ›´å¥½çš„æŸå¤±ï¼Œåˆ™æ›´å—é’çã€‚

+   `complexity_of_operators`ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¿ç®—ç¬¦çš„å¤æ‚åº¦ä¸º 1ã€‚è¦æ›´æ”¹é»˜è®¤å¤æ‚åº¦è®¾ç½®å¹¶ä¼˜å…ˆè€ƒè™‘ä¸åŒçš„è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªå­—å…¸ï¼Œé”®ä¸ºè¿ç®—ç¬¦å­—ç¬¦ä¸²ï¼Œå€¼ä¸ºå…¶å¯¹åº”çš„å¤æ‚åº¦çº§åˆ«ã€‚åœ¨æˆ‘ä»¬å½“å‰çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ä¸€å…ƒè¿ç®—ç¬¦çš„å¤æ‚åº¦çº§åˆ«è®¾ç½®ä¸º 3ï¼Œè¿™ä¹Ÿåœ¨ Zhang ç­‰äººçš„åŸå§‹è®ºæ–‡ä¸­é‡‡ç”¨ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ`PySRRegressor` æä¾›äº†è®¸å¤šå…¶ä»–è¶…å‚æ•°ï¼Œç”¨äºè®¾ç½®ç®—æ³•ã€æ•°æ®é¢„å¤„ç†ã€åœæ­¢æ ‡å‡†ã€æ€§èƒ½å’Œå¹¶è¡ŒåŒ–ã€ç›‘æ§ã€ç¯å¢ƒå’Œç»“æœå¯¼å‡ºã€‚æœ‰å…³æ§åˆ¶ç¬¦å·å›å½’æœç´¢çš„æ‰€æœ‰é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·æŸ¥çœ‹ [PySRRegressor å‚è€ƒé¡µé¢](https://astroautomata.com/PySR/api/#pysrregressor-parameters)ã€‚

## 5.3 è¯†åˆ«ç»“æœ

åœ¨æŒ‡å®šæ¨¡å‹å¯¹è±¡åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‰è¡Œä»£ç å¯åŠ¨æ‹Ÿåˆè¿‡ç¨‹ï¼ˆç”¨äºæç‚¼ *f*â‚ çš„è§£æå½¢å¼ï¼‰ï¼š

```py
df = pd.read_csv('f_NN_IO.csv')
X = df.iloc[:, :4].to_numpy()
f1 = df.loc[:, 'f1'].to_numpy()

model.fit(X, f1)
```

åœ¨è„šæœ¬è¿è¡Œæ—¶ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°è¿›åº¦æ¡å’Œå½“å‰æœ€ä½³æ–¹ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ³¨æ„ x0ã€x1ã€x2 å’Œ x3 åˆ†åˆ«å¯¹åº” *t*ã€*u*â‚ã€*u*â‚‚ å’Œ *u*â‚ƒã€‚

![](img/3f2c28ee599036a30c260a4ebed307a3.png)

ä¸€æ—¦ä¼˜åŒ–ä»»åŠ¡å®Œæˆï¼Œç»ˆç«¯ä¸­å°†å‡ºç°å€™é€‰æ–¹ç¨‹åˆ—è¡¨ï¼š

![](img/1edf4cea529a1bb841e2301629d11c77.png)

å¦‚æœæˆ‘ä»¬æ ¹æ® **è¯„åˆ†å€¼** å¯¹æ–¹ç¨‹è¿›è¡Œæ’åï¼Œå¯ä»¥çœ‹åˆ°æ’åå‰ä¸‰çš„æ–¹ç¨‹æ˜¯ï¼š

+   *u*â‚‚ *u*â‚ƒ *exp*( -0.1053391 *t* )

+   0.60341805 *u*â‚‚ *u*â‚ƒ

+   *u*â‚‚ *u*â‚ƒ

å›å¿†ä¸€ä¸‹æˆ‘ä»¬çœŸå®çš„ ODE æ˜¯

![](img/7ee90229681ba8c80eac60db10d85852.png)

ä»¤äººå°è±¡æ·±åˆ»çš„æ˜¯ï¼ŒPySR å‡†ç¡®åœ°è¯†åˆ«å‡ºäº†åŸºæœ¬è¾“å…¥ï¼ˆå³ï¼Œå®ƒè¯†åˆ«å‡º *u*â‚ åœ¨ *f*â‚ ä¸­ä¸èµ·ä½œç”¨ï¼‰ï¼Œå¹¶å‘ç°äº†ä¸€ä¸ªæ¥è¿‘ *f*â‚ çœŸå®è¡¨è¾¾å¼çš„è§£æè¡¨è¾¾å¼ï¼ˆæ’åç¬¬ä¸€çš„ç»“æœï¼‰ã€‚

æˆ‘ä»¬å¯¹ *f*â‚‚ è¿›è¡Œäº†ç›¸åŒçš„åˆ†æã€‚ä¼˜åŒ–ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](img/7e935b2f1899d6929c72c6abaf0b6b43.png)

è¿™æ¬¡ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° *f*â‚‚ çš„çœŸå®è¡¨è¾¾å¼ï¼Œå³ *f*â‚‚=*u*â‚ *u*â‚ƒï¼Œä»…ä½œä¸ºç¬¬äºŒå¥½çš„ï¼ˆæŒ‰è¯„åˆ†è®¡ç®—ï¼‰æ–¹ç¨‹å‡ºç°ã€‚ç„¶è€Œï¼Œè¯·æ³¨æ„ï¼Œæœ€ä½³æ–¹ç¨‹ï¼Œå³ *u*â‚ƒï¼Œå…¶å¾—åˆ†ä»…æ¯”ç¬¬äºŒå¥½çš„é«˜ä¸€ç‚¹ã€‚å¦ä¸€æ–¹é¢ï¼Œ*u*â‚ *u*â‚ƒ çš„æŸå¤±å€¼æ¯”å•ç‹¬ä½¿ç”¨ *u*â‚ƒ ä½ä¸€ä¸ªæ•°é‡çº§ã€‚è¿™äº›è§‚å¯Ÿç»“æœè¡¨æ˜ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬éœ€è¦é¢†åŸŸçŸ¥è¯†/ç»éªŒæ¥åšå‡ºæ˜æ™ºçš„å†³å®šï¼Œä»¥åˆ¤æ–­è¿½æ±‚é«˜å‡†ç¡®åº¦æ‰€å¸¦æ¥çš„å¤æ‚æ€§æ˜¯å¦å€¼å¾—ã€‚

# 6. å…³é”®è¦ç‚¹

åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†ä»è§‚æµ‹æ•°æ®ä¸­å‘ç°å¾®åˆ†æ–¹ç¨‹çš„é—®é¢˜ã€‚æˆ‘ä»¬éµå¾ªäº† Zhang ç­‰äººæå‡ºçš„ç­–ç•¥ï¼Œå°†å…¶å®ç°ä¸ºä»£ç ï¼Œå¹¶åº”ç”¨äºä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶ã€‚ä»¥ä¸‹æ˜¯å…³é”®è¦ç‚¹ï¼š

1ï¸âƒ£ ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œ (PINN) æ˜¯ä¸€ä¸ªå¤šç”¨é€”çš„å·¥å…·ï¼Œç”¨äºè¿›è¡Œç³»ç»Ÿè¯†åˆ«ï¼Œç‰¹åˆ«æ˜¯åœ¨å¯¹æ§åˆ¶å¾®åˆ†æ–¹ç¨‹åªæœ‰éƒ¨åˆ†ä¿¡æ¯å·²çŸ¥çš„æƒ…å†µä¸‹ã€‚é€šè¿‡åŒåŒ–è§‚å¯Ÿæ•°æ®å’Œç°æœ‰çš„ç‰©ç†çŸ¥è¯†ï¼ŒPINN ä¸ä»…èƒ½æœ‰æ•ˆä¼°è®¡æœªçŸ¥å‚æ•°ï¼Œè¿˜èƒ½ä¼°è®¡æœªçŸ¥å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬é‡‡ç”¨ç”¨è¾…åŠ©ç¥ç»ç½‘ç»œå¯¹æœªçŸ¥å‡½æ•°è¿›è¡Œå‚æ•°åŒ–çš„æŠ€å·§ï¼Œå¹¶ä¸ä¸» PINN ä¸€èµ·è”åˆè®­ç»ƒã€‚è¿™äº›å› ç´ å…±åŒä½œç”¨ï¼Œç›¸æ¯”ä¼ ç»Ÿçš„ç³»ç»Ÿè¯†åˆ«æ–¹æ³•ï¼Œå…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ã€‚

2ï¸âƒ£ ç¬¦å·å›å½’æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºæ­å¼€å­¦ä¹ ç¥ç»ç½‘ç»œçš„é»‘ç®±ã€‚é€šè¿‡åˆ©ç”¨å…ˆè¿›çš„è¿›åŒ–ç®—æ³•åœ¨æ•´ä¸ªç¬¦å·è¡¨è¾¾å¼ç©ºé—´ä¸­è¿›è¡Œæœç´¢ï¼Œç¬¦å·å›å½’èƒ½å¤Ÿæå–å‡ºå¯è§£é‡Šä¸”ç´§å‡‘çš„è§£æè¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼å¯ä»¥å‡†ç¡®æè¿°éšè—çš„è¾“å…¥è¾“å‡ºå…³ç³»ã€‚è¿™ä¸ªçŸ¥è¯†è’¸é¦è¿‡ç¨‹åœ¨å®è·µä¸­å—åˆ°é«˜åº¦èµèµï¼Œå› ä¸ºå®ƒèƒ½æœ‰æ•ˆå¢å¼ºæˆ‘ä»¬å¯¹åŸºç¡€ç³»ç»ŸåŠ¨æ€çš„ç†è§£ã€‚

åœ¨æˆ‘ä»¬ç»“æŸè¿™ç¯‡åšå®¢ä¹‹å‰ï¼Œæœ‰å‡ ç‚¹åœ¨å°† PINN+ç¬¦å·å›å½’åº”ç”¨äºå®é™…é—®é¢˜æ—¶å€¼å¾—è€ƒè™‘ï¼š

## 1ï¸âƒ£ ä¸ç¡®å®šæ€§é‡åŒ– (UQ)

åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„ *u*â‚ã€*u*â‚‚ å’Œ *u*â‚ƒ æ•°æ®æ˜¯æ— å™ªå£°çš„ã€‚ç„¶è€Œï¼Œè¿™ç§å‡è®¾é€šå¸¸ä¸æˆç«‹ï¼Œå› ä¸ºå®é™…çš„åŠ¨æ€ç³»ç»Ÿä¸­çš„è§‚å¯Ÿæ•°æ®å¾ˆå®¹æ˜“è¢«å™ªå£°æ±¡æŸ“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç³»ç»Ÿè¯†åˆ«ç»“æœçš„ *å‡†ç¡®æ€§* å’Œ *å¯é æ€§* éƒ½ä¼šå—åˆ°å½±å“ã€‚å› æ­¤ï¼Œä¸€ä¸ªå…³é”®æ–¹é¢æ˜¯è€ƒè™‘åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿè¯†åˆ«å·¥ä½œæµä¸­è¿›è¡Œä¸ç¡®å®šæ€§é‡åŒ–ã€‚åƒè´å¶æ–¯ç¥ç»ç½‘ç»œå’Œ [è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ](https://medium.com/towards-data-science/how-to-quantify-the-prediction-error-made-by-my-model-db4705910173) è¿™æ ·çš„æŠ€æœ¯å¯ä»¥åˆç†åœ°è€ƒè™‘è§‚å¯Ÿæ•°æ®ä¸­çš„å™ªå£°ï¼Œå¹¶æä¾›å¯¹é¢„æµ‹çš„ç½®ä¿¡åŒºé—´çš„ä¼°è®¡ã€‚

## 2ï¸âƒ£ ç¬¦å·å›å½’çš„æ•æ„Ÿæ€§

ä¸€èˆ¬æ¥è¯´ï¼Œç¬¦å·å›å½’å¾—åˆ°çš„ç»“æœå¯èƒ½å¯¹æ‰€ä½¿ç”¨çš„æŸå¤±å‡½æ•°ã€æä¾›çš„å•ä¸€å’ŒäºŒå…ƒè¿ç®—ç¬¦å€™é€‰é¡¹ä»¥åŠå®šä¹‰çš„è¿ç®—ç¬¦å¤æ‚åº¦æ•æ„Ÿã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘å°è¯•é‡ç° Zhang ç­‰äººå‘å¸ƒçš„ç»“æœæ—¶ï¼Œå°½ç®¡æˆ‘é‡‡ç”¨äº†å®Œå…¨ç›¸åŒçš„è®¾ç½®ï¼ˆæ®æˆ‘æ‰€çŸ¥ï¼‰ï¼Œä½†æˆ‘æœªèƒ½è·å¾—ä¸åŸå§‹è®ºæ–‡ä¸­æ‰€ç¤ºçš„ *f*â‚‚ å®Œå…¨ä¸€è‡´çš„å‰ 3 ä¸ªæ–¹ç¨‹ã€‚è¿™ç§ä¸åŒ¹é…å¯èƒ½æœ‰å‡ ä¸ªå› ç´ ï¼šé¦–å…ˆï¼Œè¿›åŒ–ä¼˜åŒ–æŠ€æœ¯æœ¬è´¨ä¸Šæ˜¯éšæœºçš„ï¼Œå› æ­¤ç»“æœå¯èƒ½åœ¨ä¸åŒçš„è¿è¡Œä¸­æœ‰æ‰€ä¸åŒã€‚å…¶æ¬¡ï¼Œç¬¬ä¸€é˜¶æ®µè®­ç»ƒçš„ PINN å¯èƒ½ä¸åŒï¼Œå› æ­¤ç”Ÿæˆçš„æ•°æ®é›†ï¼ˆå³ *t*ï¼Œ*u*â‚ï¼Œ*u*â‚‚ï¼Œ*u*â‚ƒ â†’ *f*â‚ï¼Œ*f*â‚‚ï¼‰ä¹Ÿä¸åŒï¼Œä»è€Œå½±å“äº†ç¬¦å·å›å½’çš„ç»“æœã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™äº›è§‚å¯Ÿç»“æœè¡¨æ˜ï¼Œç¬¦å·å›å½’çš„ç»“æœä¸åº”ç›²ç›®æ¥å—ã€‚ç›¸åï¼Œä¾èµ–é¢†åŸŸçŸ¥è¯†/ç†è§£æ¥æ‰¹åˆ¤æ€§åœ°è¯„ä¼°è¯†åˆ«å‡ºçš„æ–¹ç¨‹çš„åˆç†æ€§è‡³å…³é‡è¦ã€‚

å¦‚æœä½ è§‰å¾—æˆ‘çš„å†…å®¹æœ‰ç”¨ï¼Œå¯ä»¥åœ¨[è¿™é‡Œ](https://www.buymeacoffee.com/Shuaiguo09f)è¯·æˆ‘å–å’–å•¡ğŸ¤— éå¸¸æ„Ÿè°¢ä½ çš„æ”¯æŒï¼

> ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/ShuaiGuo16/PINN_symbolic_regression)æ‰¾åˆ°å¸¦æœ‰å®Œæ•´ä»£ç çš„ä¼´éšç¬”è®°æœ¬å’Œè„šæœ¬*ğŸ’»*ã€‚
> 
> è¦å­¦ä¹ ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œçš„æœ€ä½³å®è·µï¼Œè¯·å‚é˜…ï¼š[è§£å¼€ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œè®¾è®¡æ¨¡å¼çš„å¥¥ç§˜](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)ã€‚
> 
> è¦äº†è§£æ›´å¤šå…³äºç‰©ç†ä¿¡æ¯è¿ç®—ç¬¦å­¦ä¹ çš„å†…å®¹ï¼Œè¯·å‚é˜…ï¼šé€šè¿‡ç‰©ç†ä¿¡æ¯æ·±åº¦è¿ç®—ç¬¦å­¦ä¹ ã€‚
> 
> éšæ—¶å¯ä»¥è®¢é˜…æˆ‘çš„[æ–°é—»é€šè®¯](https://shuaiguo.medium.com/subscribe)æˆ–åœ¨[Medium](https://shuaiguo.medium.com/)ä¸Šå…³æ³¨æˆ‘ã€‚

# å‚è€ƒèµ„æ–™

[1] Zhang ç­‰ï¼Œç»“åˆ PINN ä¸ç¬¦å·å›å½’å‘ç°é˜¿å°”èŒ¨æµ·é»˜ç—…çš„ååº”æ‰©æ•£æ¨¡å‹ã€‚arXivï¼Œ2023ã€‚

[2] Cranmer ç­‰ï¼Œä½¿ç”¨ PySR å’Œ SymbolicRegression.jl è¿›è¡Œå¯è§£é‡Šçš„æœºå™¨å­¦ä¹ ç§‘å­¦ç ”ç©¶ã€‚arXivï¼Œ2023ã€‚

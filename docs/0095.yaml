- en: Window Functions in PostgreSQL
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/window-functions-in-postgresql-788d2ad57c6b?source=collection_archive---------7-----------------------#2023-01-06](https://towardsdatascience.com/window-functions-in-postgresql-788d2ad57c6b?source=collection_archive---------7-----------------------#2023-01-06)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A must-know for any data practitioner
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://ms101196.medium.com/?source=post_page-----788d2ad57c6b--------------------------------)[![Merlin
    Schäfer](../Images/70108782dda329ca5bbc4cfb5d650e5e.png)](https://ms101196.medium.com/?source=post_page-----788d2ad57c6b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----788d2ad57c6b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----788d2ad57c6b--------------------------------)
    [Merlin Schäfer](https://ms101196.medium.com/?source=post_page-----788d2ad57c6b--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a2c8842187b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwindow-functions-in-postgresql-788d2ad57c6b&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=post_page-5a2c8842187b----788d2ad57c6b---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----788d2ad57c6b--------------------------------)
    ·8 min read·Jan 6, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F788d2ad57c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwindow-functions-in-postgresql-788d2ad57c6b&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=-----788d2ad57c6b---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F788d2ad57c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwindow-functions-in-postgresql-788d2ad57c6b&source=-----788d2ad57c6b---------------------bookmark_footer-----------)![](../Images/6fb505f5f62aafc51e7e278fa8654702.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Stephen Dawson](https://unsplash.com/@dawson2406?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Have you ever found yourself writing long SQL queries with many steps or subqueries
    containing aggregate functions to calculate seemingly simple metrics? Have you
    ever wondered if you “couldn’t just calculate along the table differently to make
    things easier”? Then it might be time to have a look at window functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Window functions are a handy and powerful feature in SQL that allows you to
    perform calculations across a number of rows similar to aggregate functions. But
    other than aggregate functions, which you might use with a GROUP BY, they don’t
    return a single value for a group of rows, but a value for each row in the set.
    Let’s look at an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/c630683f642ebee9e71a1a2d75085451.png)'
  prefs: []
  type: TYPE_IMG
- en: Why and when should you use window functions?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: One advantage of window functions is that they allow you to work with aggregate
    and non-aggregate values combined because the rows are not collapsed together.
    This…
  prefs: []
  type: TYPE_NORMAL

- en: SQL Riddles to Test Your Wits
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: åŽŸæ–‡ï¼š[https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22](https://towardsdatascience.com/sql-riddles-to-test-your-wits-8ce31202ae7f?source=collection_archive---------4-----------------------#2023-02-22)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Timestamps, dependent filters, and misbehaving left joins
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Matt
    Sosna](../Images/c3175c0dc62b795a8d0fa57532fb669b.png)](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    [Matt Sosna](https://mgsosna.medium.com/?source=post_page-----8ce31202ae7f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: Â·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff17fb22b897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=post_page-f17fb22b897----8ce31202ae7f---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8ce31202ae7f--------------------------------)
    Â·8 min readÂ·Feb 22, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&user=Matt+Sosna&userId=f17fb22b897&source=-----8ce31202ae7f---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ce31202ae7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-riddles-to-test-your-wits-8ce31202ae7f&source=-----8ce31202ae7f---------------------bookmark_footer-----------)![](../Images/e1fc7bf3a6b50e65020f31e0892a018c.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Saffu](https://unsplash.com/@saffu?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: SQL is a deceptively simple language. Across its many dialects, users can query
    databases in a syntax similar to English. **What you see is what you getâ€¦ until
    you donâ€™t.**
  prefs: []
  type: TYPE_NORMAL
- en: Every now and then I come across a query that produces a result completely different
    from what I expected, teaching me little nuances about the language. Iâ€™ve compiled
    three recent head-scratchers in this post, and Iâ€™ve arranged them as riddles to
    make them more interesting. Try to figure out the answer before reading the end
    of each section!
  prefs: []
  type: TYPE_NORMAL
- en: Iâ€™ve also included quick [**common table expressions (CTEs)**](https://learnsql.com/blog/what-is-common-table-expression/)
    to generate the tables in each example, so you donâ€™t need to try querying your
    companyâ€™s production tables! But to get really comfortable with SQL, I actually
    recommend creating your own database and tables to play with. Check out [this
    post](https://medium.com/towards-data-science/intermediate-sql-for-everyone-fe35c541147a)
    to learn how.
  prefs: []
  type: TYPE_NORMAL
- en: Note that all queries are in Postgres â€” you may get different results in a different
    dialect. Finally, an obligatory note that the actual data and topics in each query
    are just illustrative examples. ðŸ™‚
  prefs: []
  type: TYPE_NORMAL

- en: Assessing global temperature anomaly using NASA’s space studies - Part II
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/assessing-global-temperature-anomaly-using-nasas-space-studies-part-ii-29e5e313a7b3?source=collection_archive---------11-----------------------#2023-06-05](https://towardsdatascience.com/assessing-global-temperature-anomaly-using-nasas-space-studies-part-ii-29e5e313a7b3?source=collection_archive---------11-----------------------#2023-06-05)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Plotting global surface temperature anomaly data obtained from NASA’s GISSTEMP
    using cartopy, matplotlib and netCDF data in Python.
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@himalaya.birshrestha?source=post_page-----29e5e313a7b3--------------------------------)[![Himalaya
    Bir Shrestha](../Images/9766140c1c44381029d0a78154217775.png)](https://medium.com/@himalaya.birshrestha?source=post_page-----29e5e313a7b3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----29e5e313a7b3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----29e5e313a7b3--------------------------------)
    [Himalaya Bir Shrestha](https://medium.com/@himalaya.birshrestha?source=post_page-----29e5e313a7b3--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba33e6d0d27b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fassessing-global-temperature-anomaly-using-nasas-space-studies-part-ii-29e5e313a7b3&user=Himalaya+Bir+Shrestha&userId=ba33e6d0d27b&source=post_page-ba33e6d0d27b----29e5e313a7b3---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----29e5e313a7b3--------------------------------)
    ·10 min read·Jun 5, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29e5e313a7b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fassessing-global-temperature-anomaly-using-nasas-space-studies-part-ii-29e5e313a7b3&user=Himalaya+Bir+Shrestha&userId=ba33e6d0d27b&source=-----29e5e313a7b3---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29e5e313a7b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fassessing-global-temperature-anomaly-using-nasas-space-studies-part-ii-29e5e313a7b3&source=-----29e5e313a7b3---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: At the time of this writing (May 2023), global CO2 emissions [concentration](https://www.co2.earth/daily-co2#:~:text=421.74%20ppm&text=This%20table%20presents%20the%20most,atmospheric%20CO2%20on%20the%20planet.)
    in the atmosphere 425 ppm. This concentration level is the highest in 14 million
    years and is projected to rise in the coming years (The World Counts, 2023). It
    is no secret that anthropogenic greenhouse gas (GHG) emissions are the main drivers
    of global warming. In the first part of this series, I discussed the global surface
    temperature anomaly, the science, and the uncertainties associated with it based
    on the [data](https://data.giss.nasa.gov/gistemp/graphs_v4/) of the past 142 years
    (since 1880) provided by NASA’s Goddard Institute for Space Studies [(GISSTEMP](https://data.giss.nasa.gov/gistemp/)).
  prefs: []
  type: TYPE_NORMAL
- en: '[](/assessing-global-temperature-anomaly-using-nasas-space-studies-part-i-a4c0c4b825cb?source=post_page-----29e5e313a7b3--------------------------------)
    [## Assessing global temperature anomaly using NASA’s space studies — Part I'
  prefs: []
  type: TYPE_NORMAL
- en: Exploring the underlying data, uncertainties, and science behind the historical
    global temperature anomaly
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/assessing-global-temperature-anomaly-using-nasas-space-studies-part-i-a4c0c4b825cb?source=post_page-----29e5e313a7b3--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: A recent report published by World Meteorological Organization (WMO) stated
    that the global near-surface temperature is predicted to rise between 1.1 °C and
    1.8 °C in the next five years relative to 1850–1900 (WMO, 2023). The report further
    stated that there is a 98% chance of one of the coming five years being the hottest
    year on record, with a likely chance that one of the years would temporarily exceed
    the 1.5 °C threshold.
  prefs: []
  type: TYPE_NORMAL
- en: Globally, 2022 was the fifth warmest year on record (WMO, 2023). Climate-related
    disasters continued to be the news headlines in 2022, including catastrophic floods
    in Pakistan, hurricanes in Florida, heat waves in Europe, droughts and record-low
    water levels in rivers of China, Europe, and America, and record ice sheet melting
    in Greenland.
  prefs: []
  type: TYPE_NORMAL
- en: In this part of the series, I will focus on the global surface temperature anomaly
    for 2022, using the data from NASA’s [GISSTEMP](https://data.giss.nasa.gov/gistemp/).
    In the first section of this post, I will create maps depicting global surface
    temperature anomaly in April 2023 relative to the 1951–1980 mean in different
    projections. In the second section, I will plot the maps showing global surface
    temperature anomalies for different seasons in 2022\. I will be using the matplotlib,
    cartopy, and netcdf4 packages in Python for this purpose. Let’s get started.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/50b3729e86e35657f870721360c75965.png)'
  prefs: []
  type: TYPE_IMG
- en: Ocean clouds as seen from space. Photo by [NASA](https://unsplash.com/@nasa?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: '**A. Global surface temperature anomaly for April 2023 relative to 1951–1980
    mean**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Data**'
  prefs: []
  type: TYPE_NORMAL
- en: The data of global surface temperature anomaly for a historical timeframe relative
    to the base period is open-access and downloaded from NASA’s GISS Surface Temperature
    analysis [website](https://data.giss.nasa.gov//gistemp/maps/) (GISTEMP Team, 2023
    and Lenssen et al., 2019). I selected April as the **mean period**, the beginning
    to end of 2023 as the **time period**, and the beginning of 1951 to the end of
    1980 as the **base period**. The **smoothing radius** of 1200 km refers to the
    distance over which a station influences regional temperature.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9be0019d89c84393102ef98096b574b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Data portal in NASA’s GISSTEMP website. Data based on GISTEMP Team, 2023 and
    Lenssen et al., 2019\. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: 'I downloaded the grid data as a **netCDF** (*.nc) file. netCDF stands for Network
    Common Data Form, which is a file format containing a set of interfaces for the
    array-oriented machine-independent data access (National Snow and Ice Data Center,
    2023). The data in the netCDF file was read in Python using the Dataset module
    of the netCDF4 package, as shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8be9a84b58b4660d227bad5cf6ffd945.png)'
  prefs: []
  type: TYPE_IMG
- en: Reading netCDF file using Dataset module of netCDF4 package. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: The given data variables contain longitude (lon), latitude (lat), and temperature
    anomaly (TEMPANOMALY) data. These data are of numpy masked array types, which
    means, the data may contain some missing or invalid entries. Here, `temp_anomaly`
    data may not be available for each coordinate.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/76a9d1c8c54e478e319d6047059bcf9f.png)'
  prefs: []
  type: TYPE_IMG
- en: Accessing various data points for longitude, latitude, and temperature anomaly.
    Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**2\. Plotting using Cartopy**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Guidelines for installing Cartopy package**'
  prefs: []
  type: TYPE_NORMAL
- en: To install the cartopy package, first its dependencies **shapely** and **pyproj**
    need to be installed. The compatible wheel files for shapely and pyproj packages,
    which are based on the **Python version** and **Windows version,** can be accessed
    [here](https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyproj). After installing these
    packages, I succeeded in installing the cartopy package using `pip install cartopy`.
  prefs: []
  type: TYPE_NORMAL
- en: '**Function to plot data in different projections**'
  prefs: []
  type: TYPE_NORMAL
- en: The function below uses `projection` and `projection_name` as arguments, which
    determine the type of projection we want to display the resulting map plot and
    its title.
  prefs: []
  type: TYPE_NORMAL
- en: In the function `temp_anomaly_plot()` below, first, an axes is added to the
    figure with a specific projection. The map is set to cover the global extent.
    `clevs` define the range of data (temperature anomaly) that we want to project
    on the map. Here I defined this range as -5°C to 6°C. `cmap` refers to the color
    map. Here, I chose the coolwarm colormap, where the blue color reflects the cold
    end, and the red color reflects the warm end.
  prefs: []
  type: TYPE_NORMAL
- en: The function plots filled contour using `lons` and `lats` as coordinates, and
    `temp_anomaly` as data. By default, Cartopy assumes that the coordinates match
    the projection of the resulting plot. Therefore, the safe option is to supply
    the [transform](https://scitools.org.uk/cartopy/docs/latest/tutorials/understanding_transform.html)
    keyword so that Cartopy understands that the coordinates refer to the specific
    original projection (here ccrs.PlateCarree()) and needs to transform it into a
    new `projection` type. Finally, a horizontal color bar is added below the map.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**3\. Projections**'
  prefs: []
  type: TYPE_NORMAL
- en: Map projections are never absolutely accurate representations of the spherical
    earth. **Map projections** try to portray the surface of the earth, or a portion
    of the earth, from its spherical shape (3D) to a planar shape (2D). As a result
    of the map projection process, every map shows **distortions of angular conformity,
    distance, and area** (QGIS Documentation, 2023). In Python, geospatial data can
    be plotted in various [projections](https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html)
    using the Cartopy package.
  prefs: []
  type: TYPE_NORMAL
- en: 'Using the `temp_anomaly_plot` function defined in the section above, I plotted
    the global surface temperature anomaly on the global map in three different projections
    below:'
  prefs: []
  type: TYPE_NORMAL
- en: '**PlateCarree projection**'
  prefs: []
  type: TYPE_NORMAL
- en: PlateCarree projection is an equidistant cylindrical [projection](https://pro.arcgis.com/en/pro-app/latest/help/mapping/properties/plate-carree.htm)
    with the standard parallel located at the equator.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/17e2ca96076c95e4fa1348d0ec78ead3.png)'
  prefs: []
  type: TYPE_IMG
- en: Platecarree projection of Cartopy package (on top), and map of surface temperature
    anomaly in April 2023 relative to 1951 to 1980 average in Platecarree projection
    (on bottom). Illustration by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**Robinson Projection**'
  prefs: []
  type: TYPE_NORMAL
- en: Robinson projection is one of the most commonly used pseudocyclindrical map
    projections for world maps. It is a compromise where the distortions of area,
    angular conformity, and distance are acceptable on this map (QGIS Documentation,
    2023).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/25a7be7c09d2564c2e74aa7a17e685f8.png)'
  prefs: []
  type: TYPE_IMG
- en: Robinson projection of Cartopy package (on top), and map of surface temperature
    anomaly in April 2023 relative to 1951 to 1980 average in Robinson projection
    (on bottom). Illustration by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**Orthographic Projection**'
  prefs: []
  type: TYPE_NORMAL
- en: Orthographic projection is an azimuthal perspective [projection](https://pro.arcgis.com/en/pro-app/3.0/help/mapping/properties/orthographic.htm),
    projecting the Earth’s surface from an infinite distance to a plane. In this projection,
    one needs to state the `central_longitude` and `central_latitude` that one wants
    to view in the centre of the plane. Therefore, not all locations of the globe
    are visible at once in this projection.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4a51c77145ba86262c1f779e089760d0.png)'
  prefs: []
  type: TYPE_IMG
- en: Orthographic projection of Cartopy package (on top), and map of surface temperature
    anomaly in April 2023 relative to 1951 to 1980 average in Orthographic projection
    (on bottom). Illustration by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**B. Global surface temperature anomaly by seasons**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, I intended to plot the global surface temperature anomaly for
    different seasons of 2022\. The data is accessed from the same NASA GISSTEMP [website](https://data.giss.nasa.gov/gistemp/maps/).
    However, in this case, I selected data for four meteorological seasons (winter,
    spring, summer, and autumn) individually as **Mean Period**, and downloaded the
    corresponding grid data as a netCDF file. To get the data for the entire calendar
    year of 2022, I chose **Time Interval** between the beginning and the end of 2022.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, I created a `get_data` function to derive longitude, latitude, temperature
    anomaly, and average temperature anomaly data for four seasons from the corresponding
    netCDF file as shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5529a8be144c071b3f8d057e5f7acf47.png)'
  prefs: []
  type: TYPE_IMG
- en: Function to extract longitude, latitude, temperature anomaly, and average temperature
    anomaly data from netCDF files for four seasons. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: I intended to plot the temperature anomaly for four seasons as four subplots
    within a single figure. This has been coded accordingly in the code snippet below.
    I also added a common legend colorbar for the entire figure.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The resulting plot is as shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c96a4f34316dbf770809bf9668204349.png)'
  prefs: []
  type: TYPE_IMG
- en: Global surface temperature anomaly for four meteorological seasons of 2022 relative
    to 1951 to 1980 mean as the base period. Data based on GISTEMP Team, 2023 and
    Lenssen et al., 2019\. Illustration by Author.
  prefs: []
  type: TYPE_NORMAL
- en: Key Takeaways
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Some key takeaways from this analysis are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 2022 was a year of [*La Nina*](https://education.nationalgeographic.org/resource/la-nina/),
    which typically has a cooling effect on global temperature. Despite that, the
    global average surface temperature anomaly in 2022 was 1.2 °C relative to the
    1951–80 mean. 2022 was the warmest La Nina year on record, which highlights the
    extremeness of global warming (CNN, 2023).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The surface temperature anomaly is not uniform across different parts of the
    world. As discussed in the previous [post](/assessing-global-temperature-anomaly-using-nasas-space-studies-part-i-a4c0c4b825cb),
    global surface temperature anomaly is much higher in land as compared to oceans.
    A [study](https://www.ecmwf.int/en/about/media-centre/news/2023/european-climate-marked-heat-and-drought-2022-report)
    stated that temperature over land has risen around twice as those over oceans
    in recent decades.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There are some parts of the ocean, which are slightly cooler in different seasons
    of 2022 as compared to the historical 1951–80 base period. These are depicted
    by bluish color on the map. For example, parts of the Pacific Ocean to the left
    of South America, and some areas below Greenland. However, this doesn’t paint
    the complete picture as the majority of the places have warmed up as depicted
    by the reddish color.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Arctic region has warmed up much higher as compared to other parts of the
    world in recent years. This can broadly be attributed to the melting of sea ice
    and snow cover, causing the reducing in reflection and an increase in absorption
    of solar radiation (PBS News Hour, 2022). In 2022, the Arctic temperature anomaly
    was more prominent in winter as compared to other months.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Section B above showed that the global surface temperature anomaly in 2022 differed
    across seasons. The highest temperature anomaly was observed in summer (1.15 °C),
    followed by spring (1.14 °C), winter (1.08 °C), and autumn (1.02 °C). This can
    relate to the fact that summer has got much warmer and quite intolerable in recent
    years as compared to other seasons.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this post, first, I plotted the global surface temperature anomaly data for
    April 2023 relative to the 1951–80 mean using the data obtained from NASA’s [GISSTEMP](https://data.giss.nasa.gov/gistemp/maps/)
    as a netCDF file. I demonstrated ways to plot the map in different projections
    using the Cartopy package. Next, I plotted the surface temperature anomaly across
    four meteorological seasons of 2022 as four subplots within one figure. Using
    the map plots, I extracted the key takeaway messages around global surface temperature
    anomaly in recent years across different parts of the world and different seasons
    of the year.
  prefs: []
  type: TYPE_NORMAL
- en: Xarray is another useful package in Python, which can be used for working with
    geospatial data in netCDF or other file formats. For example, the posts by [Lubomir
    Franko](https://medium.com/@lubomirfranko/climate-data-visualisation-with-python-visualise-climate-data-using-cartopy-and-xarray-cf35a60ca8ee)
    and [Giannis Tolios](/visualizing-climate-change-data-with-python-74ea5bac8756)
    showcase plotting surface temperature anomaly data for Europe using xarray, cartopy,
    and matplotlib. The possibilities of working with spatial data with xarray can
    be a topic for a different post.
  prefs: []
  type: TYPE_NORMAL
- en: The notebooks and the data used in the analysis in this post and the previous
    post of this series are available in this GitHub [repository](https://github.com/hbshrestha/global_temperature_anomaly).
    Thank you for reading!
  prefs: []
  type: TYPE_NORMAL
- en: '**References**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: CNN, 2023\. [2022 was the warmest La Niña year on record. Scientists say this
    year will be warmer | CNN](https://edition.cnn.com/2023/01/12/us/2022-warmest-la-nina-year-climate/index.html#:~:text=Scientists%20say%20this%20year%20will%20be%20warmer,-By%20Rachel%20Ramirez&text=Low%20water%20levels%20on%20the,Mighty%20Mississippi%20to%20record%20lows.)
  prefs: []
  type: TYPE_NORMAL
- en: 'GISTEMP Team, 2023: GISS Surface Temperature Analysis (GISTEMP), version 4\.
    NASA Goddard Institute for Space Studies. Dataset accessed 2023–05–31 at [data.giss.nasa.gov/gistemp/](https://data.giss.nasa.gov/gistemp/).'
  prefs: []
  type: TYPE_NORMAL
- en: 'Lenssen, N., G. Schmidt, J. Hansen, M. Menne, A. Persin, R. Ruedy, and D. Zyss,
    2019: [Improvements in the GISTEMP uncertainty model](https://pubs.giss.nasa.gov/abs/le05800h.html).
    J. Geophys. Res. Atmos., **124**, no. 12, 6307–6326, doi:10.1029/2018JD029522.'
  prefs: []
  type: TYPE_NORMAL
- en: National Snow and Ice Data Center — Advancing knowledge of Earth’s frozen region,
    2023\. [What is netCDF? | National Snow and Ice Data Center (nsidc.org)](https://nsidc.org/data/user-resources/help-center/what-netcdf#:~:text=NetCDF%20(network%20Common%20Data%20Form,format%20for%20representing%20scientific%20data.)
  prefs: []
  type: TYPE_NORMAL
- en: PBS News Hour, 2022\. [The Arctic is warming nearly four times faster than the
    rest of the world | PBS NewsHour](https://www.pbs.org/newshour/politics/the-arctic-is-warming-nearly-four-times-faster-than-the-rest-of-the-world#:~:text=As%20the%20darkest%20natural%20surface,90%20percent%20of%20solar%20radiation.&text=When%20covered%20with%20sea%20ice,the%20absorption%20of%20solar%20radiation.)
  prefs: []
  type: TYPE_NORMAL
- en: QGIS Documentation, 2023\. [8\. Coordinate Reference Systems — QGIS Documentation
    documentation](https://docs.qgis.org/3.28/en/docs/gentle_gis_introduction/coordinate_reference_systems.html)
  prefs: []
  type: TYPE_NORMAL
- en: The World Counts, 2023\. [Global warming and CO2 Concentration (theworldcounts.com)](https://www.theworldcounts.com/challenges/global-warming/CO2-concentration)
  prefs: []
  type: TYPE_NORMAL
- en: World Meteorological Organization (WMO), 2023\. [Global Annual to Decadal Climate
    Update | World Meteorological Organization (wmo.int)](https://public.wmo.int/en/our-mandate/climate/global-annual-decadal-climate-update)
  prefs: []
  type: TYPE_NORMAL

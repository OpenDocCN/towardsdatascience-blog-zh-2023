- en: Identifying and Leveraging Leading Indicators for Time Series Forecasting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/identifying-and-leveraging-leading-indicators-for-time-series-forecasting-using-granger-causality-d0e6fd5e353f?source=collection_archive---------3-----------------------#2023-09-19](https://towardsdatascience.com/identifying-and-leveraging-leading-indicators-for-time-series-forecasting-using-granger-causality-d0e6fd5e353f?source=collection_archive---------3-----------------------#2023-09-19)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Using Granger Causality and SARIMAX Models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@afolabi-lagunju?source=post_page-----d0e6fd5e353f--------------------------------)[![Afolabi
    Lagunju](../Images/e966bf23d83227645cfba36950700201.png)](https://medium.com/@afolabi-lagunju?source=post_page-----d0e6fd5e353f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----d0e6fd5e353f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----d0e6fd5e353f--------------------------------)
    [Afolabi Lagunju](https://medium.com/@afolabi-lagunju?source=post_page-----d0e6fd5e353f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbe89de9b4ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-and-leveraging-leading-indicators-for-time-series-forecasting-using-granger-causality-d0e6fd5e353f&user=Afolabi+Lagunju&userId=bbe89de9b4ba&source=post_page-bbe89de9b4ba----d0e6fd5e353f---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----d0e6fd5e353f--------------------------------)
    ¬∑9 min read¬∑Sep 19, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0e6fd5e353f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-and-leveraging-leading-indicators-for-time-series-forecasting-using-granger-causality-d0e6fd5e353f&user=Afolabi+Lagunju&userId=bbe89de9b4ba&source=-----d0e6fd5e353f---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e6fd5e353f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-and-leveraging-leading-indicators-for-time-series-forecasting-using-granger-causality-d0e6fd5e353f&source=-----d0e6fd5e353f---------------------bookmark_footer-----------)![](../Images/7385d30bd58c597194ed51fc07366b84.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Aron Visuals](https://unsplash.com/@aronvisuals?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: On a daily basis, companies are faced with decisions relating to manoeuvring
    financial markets, optimising their supply chain operations, or formulating strategies
    to maintain a competitive edge amidst evolving trends. Nevertheless, achieving
    high accuracy results in forecasting can prove elusive when time series models
    fail to account for interconnected events or other time series that exert influence
    on the subject of prediction.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, we will explore the concept of leading indicators, how to identify
    them, and how to leverage them to improve time series forecasting. We will dive
    into the practical implementation using Python and real-world data sourced from
    the [Federal Reserve Economic Data](https://fred.stlouisfed.org).
  prefs: []
  type: TYPE_NORMAL
- en: What are Leading Indicators?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Leading indicators are datasets that help in forecasting future trends or activities.
    An everyday example of a leading indicator is the sudden appearance of cloud cover,
    which could signal the likelihood of a thunderstorm occurring within the next
    hour.
  prefs: []
  type: TYPE_NORMAL
- en: How to Identify & Leverage Leading Indicators
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Domain Knowledge**: Like all Data Science projects, we start by understanding
    the domain we will be operating within. A key aspect of this process is to identify
    variables or factors that are likely to influence the time series we want to forecast.
    In our practical implementation, we will be forecasting Beer, Wine, and Liquor
    sales·µà¬π so factors like Consumer Price Index‚ÅµùÑí·µà¬≤, Liquor Price¬πùÑí·µà¬≥, Real Personal
    Income‚ÅµùÑí·µà‚Å¥, Working Age Population‚ÅµùÑí·µà‚Åµ, Unemployment Rate‚Å¥ùÑí·µà‚Å∂, Labour Force Participation‚Å¥ùÑí·µà‚Å∑,
    Social Benefits‚Å¥ùÑí·µà‚Å∏, and Consumer Loans¬≤ùÑí·µà‚Åπwill be our potential leading indicators.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Data Exploration & Visualisation**: Next, we employ Time Series Decomposition
    to analyse the seasonal components of our dependent time series alongside its
    potential leading indicators. Our objective is to identify peaks or troughs in
    our leading indicators that precede similar/opposite changes in our dependent
    time series. It is crucial to note that the relationship between leading indicators
    and the dependent time series can be either positive or negative. Although we
    will not be going into this in our implementation, you can use [seasonal_decompose](https://www.statsmodels.org/stable/generated/statsmodels.tsa.seasonal.seasonal_decompose.html)
    function from [stats_model](https://www.statsmodels.org/stable/) to achieve this.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Statistical Tests**: In this step, we validate the influence of our hand-picked
    potential leading indicators on the dependent time series by employing the Granger
    Causality test.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Preprocessing**: Next, we scale our data to ensure that all features are
    within the same range, then we apply Principal Component Analysis (PCA) to eliminate
    multicollinearity between our leading indicators.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Model Building:** Finally, we build our SARIMAX model using the [auto_arima](http://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.auto_arima.html#pmdarima.arima.auto_arima)
    function from [pmdarima](https://pypi.org/project/pmdarima/) module, and setting
    the leading indicators as the exogenous values amongst other parameters.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What is Granger Causality?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Granger Causality, first introduced in 1969 by Clive Granger¬≥, is a statistical
    hypothesis test that helps determine whether changes in a time series can predict
    or ‚Äúcause‚Äù changes in another. It has been implemented as a function under [statsmodels](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.grangercausalitytests.html).
  prefs: []
  type: TYPE_NORMAL
- en: What is SARIMAX?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: SARIMAX stands for Seasonal AutoRegressive Integrated Moving Average with eXogenous
    variables. As the name suggests, the model combines several components like autoregression
    (AR), moving average (MA), differencing (I for integrated), and the inclusion
    of external factors (the ‚ÄúX‚Äù part) ‚Äî where we will plug our leading indicators.
  prefs: []
  type: TYPE_NORMAL
- en: Python Implementation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Before we start, create an account with [Federal Reserve Economic Data](https://fred.stlouisfed.org)
    (FRED), and get an API key using [this link](https://fredaccount.stlouisfed.org/apikeys).
    Please note that this product uses the FRED¬Æ API but is not endorsed or certified
    by the Federal Reserve Bank of St. Louis.
  prefs: []
  type: TYPE_NORMAL
- en: We start with installing and loading the needed modules.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9c6d13250b500842894bdb310f145fc1.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Next, we‚Äôll create a custom function to read the data using FRED API.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Now, let‚Äôs read our data and store it in a pandas dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e4996db702394f3242d3bf04a9ee2bd7.png)'
  prefs: []
  type: TYPE_IMG
- en: timeseries dataframe
  prefs: []
  type: TYPE_NORMAL
- en: Quick visual analysis of our data shows that our dependent time series (liquor
    sales) more or less follows the same cycle every 12 months. We will use this 12
    month cycle as a parameter later on in our time series forecasting.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/fcee635fdadeffdc2d26f8812baf4a97.png)'
  prefs: []
  type: TYPE_IMG
- en: Liquor sales trend
  prefs: []
  type: TYPE_NORMAL
- en: Before we test for causality, we need to confirm the stationarity of our time
    series data. To achieve this, we will use the Augmented Dickey‚ÄìFuller test. If
    our dataset fails this stationarity test, we must employ a recursive differencing
    approach until it satisfies the test criteria.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/2fe984d6e75c033d79e661d4290ba288.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that we have loaded our time series data into a pandas dataframe, and it
    passes the stationarity test, we test for causality using the granger causality
    test.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/9a1e7f4c16c8f80696831e171260414d.png)'
  prefs: []
  type: TYPE_IMG
- en: leading indicators of liquor sales
  prefs: []
  type: TYPE_NORMAL
- en: From our tests, we see can see that liquor sales of the current month is affected
    by Consumer Price Index·µà¬≤ and Consumer Loans·µà¬π‚Å∞ of 2 months ago; and Labour Force
    Participation·µà‚Å∑ of 6 months ago.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have established our leading indicators, we will shift their records
    so that their lagged figures are in the same row as the current data of liquor_sales
    which they ‚Äúcause‚Äù.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/1ea6fa32bc3b9a78f08f89267f5ef661.png)'
  prefs: []
  type: TYPE_IMG
- en: leading indicators presented as X variables of liquor_sales
  prefs: []
  type: TYPE_NORMAL
- en: Next, we scale our data so that all features are within the same range, then
    apply PCA to eliminate multicollinearity between our leading indicators.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/a9006cb51f55821d68b8cc06c85358ef.png)'
  prefs: []
  type: TYPE_IMG
- en: Finally, we can build our SARIMAX model with the help of auto_arima. For the
    purpose of this implementation, we will leave all parameters as their default,
    with the exception of seasonality flag and the number of periods in each cycle
    (m).
  prefs: []
  type: TYPE_NORMAL
- en: We will train our model using the timeseries data up until ‚Äò2024‚Äì05‚Äì31‚Äô, test
    with ‚Äò2024‚Äì06‚Äì30‚Äô data, then predict the ‚Äò2024‚Äì07‚Äì31‚Äô liquor sales.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/635edc890aa54fb7fadaf59ec02d27a5.png)'
  prefs: []
  type: TYPE_IMG
- en: SARIMAX model summary
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/f3fea5a710e895bcc8646919b3e89aaa.png)'
  prefs: []
  type: TYPE_IMG
- en: Test and Forecast result
  prefs: []
  type: TYPE_NORMAL
- en: By following the process step-by-step, we forecasted the liquor sales figure
    for July 2024 with an estimated MAPE of just 0.4%.
  prefs: []
  type: TYPE_NORMAL
- en: To further improve the accuracy of our prediction, we can explore adding more
    potential leading indicators and finetuning the models used.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Leading indicators, as we‚Äôve explored, serve as early signals of future trends,
    providing a crucial edge in anticipating changes before they fully materialise.
    By leveraging techniques such as Granger causality tests to identify leading indicator
    series and incorporating them into forecasting models, we can significantly enhance
    the precision and robustness of our predictions.
  prefs: []
  type: TYPE_NORMAL
- en: Thank you for Reading
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*I hope you enjoyed this article and are inspired to try this on your dataset.
    Follow me on* [*Medium*](https://medium.com/@afolabi-lagunju) *for more Data Science
    posts like this, and let‚Äôs connect on* [*LinkedIn*](https://www.linkedin.com/in/afolabi-lagunju/)*.*'
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] Chaloupka FJ, Grossman M, Saffer H. The effects of price on alcohol consumption
    and alcohol-related problems. Alcohol Res Health. 2002;26(1):22‚Äì34\. PMID: 12154648;
    PMCID: PMC6683806.'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Cuffe, Harold E. and Christopher G. Gibbs. ‚ÄúThe Effect of Payday Lending
    Restrictions on Liquor Sales.‚Äù Banking & Insurance eJournal (2015)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] Granger, C. W. J. ‚ÄúInvestigating Causal Relations by Econometric Models
    and Cross-Spectral Methods.‚Äù Econometrica 37, no. 3 (1969): 424‚Äì38\. [https://doi.org/10.2307/1912791](https://doi.org/10.2307/1912791).'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] J√∏rgensen MB, Pedersen J, Thygesen LC, Lau CJ, Christensen AI, Becker U,
    Tolstrup JS. Alcohol consumption and labour market participation: a prospective
    cohort study of transitions between work, unemployment, sickness absence, and
    social benefits. Eur J Epidemiol. 2019 Apr;34(4):397‚Äì407\. doi: 10.1007/s10654‚Äì018‚Äì0476‚Äì7\.
    Epub 2019 Jan 10\. PMID: 30627937; PMCID: PMC6451700.'
  prefs: []
  type: TYPE_NORMAL
- en: '[5] Nelson, Jon P., Economic and Demographic Factors in U.S. Alcohol Demand:
    A Growth-Accounting Analysis. EMPIRICAL ECONOMICS, Vol. 22, ‚Ññ1, March 7, 1997,
    Available at SSRN: [https://ssrn.com/abstract=4686](https://ssrn.com/abstract=4686)'
  prefs: []
  type: TYPE_NORMAL
- en: '[6] Prabal, K. De., Drinking during downturn: New evidence from the housing
    market fluctuations in the United States during the Great Recession. Economics
    & Human Biology, Vol. 43, December, 2021.'
  prefs: []
  type: TYPE_NORMAL
- en: Data Citations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[d1] U.S. Census Bureau, Retail Sales: Beer, Wine, and Liquor Stores [MRTSSM4453USN],
    retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/MRTSSM4453USN,](https://fred.stlouisfed.org/series/MRTSSM4453USN,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d2] Organization for Economic Co-operation and Development, Consumer Price
    Indices (CPIs, HICPs), COICOP 1999: Consumer Price Index: Total for United States
    [USACPIALLMINMEI], retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/USACPIALLMINMEI,](https://fred.stlouisfed.org/series/USACPIALLMINMEI,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d3] U.S. Bureau of Labor Statistics, Producer Price Index by Industry: Beer,
    Wine, and Liquor Retailers [PCU44534453], retrieved from FRED, Federal Reserve
    Bank of St. Louis; [https://fred.stlouisfed.org/series/PCU44534453,](https://fred.stlouisfed.org/series/PCU44534453,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d4] U.S. Bureau of Economic Analysis, Real Disposable Personal Income [DSPIC96],
    retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/DSPIC96,](https://fred.stlouisfed.org/series/DSPIC96,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d5] Organization for Economic Co-operation and Development, Infra-Annual Labor
    Statistics: Working-Age Population Total: From 25 to 54 Years for United States
    [LFWA25TTUSM647S], retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/LFWA25TTUSM647S,](https://fred.stlouisfed.org/series/LFWA25TTUSM647S,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d6] U.S. Bureau of Labor Statistics, Unemployment Rate [UNRATENSA], retrieved
    from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/UNRATENSA,](https://fred.stlouisfed.org/series/UNRATENSA,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d7] U.S. Bureau of Labor Statistics, Labor Force Participation Rate [LNU01300000],
    retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/LNU01300000,](https://fred.stlouisfed.org/series/LNU01300000,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d8] U.S. Bureau of Economic Analysis, Personal current transfer receipts:
    Government social benefits to persons [A063RC1], retrieved from FRED, Federal
    Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/A063RC1,](https://fred.stlouisfed.org/series/A063RC1,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: '[d9] Board of Governors of the Federal Reserve System (US), Consumer Loans:
    Credit Cards and Other Revolving Plans, All Commercial Banks [CCLACBM027NBOG],
    retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/CCLACBM027NBOG,](https://fred.stlouisfed.org/series/CCLACBM027NBOG,)
    August 28, 2024.'
  prefs: []
  type: TYPE_NORMAL

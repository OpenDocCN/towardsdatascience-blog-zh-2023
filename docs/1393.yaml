- en: Simplify Data Cleaning With BigQuery SQL User-Defined Functions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/simplify-data-cleaning-with-bigquery-sql-user-defined-functions-41c0560ea6?source=collection_archive---------8-----------------------#2023-04-20](https://towardsdatascience.com/simplify-data-cleaning-with-bigquery-sql-user-defined-functions-41c0560ea6?source=collection_archive---------8-----------------------#2023-04-20)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Introduction and use cases
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://madfordata.medium.com/?source=post_page-----41c0560ea6--------------------------------)[![Vicky
    Yu](../Images/54a32f45ebd13a18811912877f60f2f7.png)](https://madfordata.medium.com/?source=post_page-----41c0560ea6--------------------------------)[](https://towardsdatascience.com/?source=post_page-----41c0560ea6--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----41c0560ea6--------------------------------)
    [Vicky Yu](https://madfordata.medium.com/?source=post_page-----41c0560ea6--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd08464b29cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-data-cleaning-with-bigquery-sql-user-defined-functions-41c0560ea6&user=Vicky+Yu&userId=cd08464b29cc&source=post_page-cd08464b29cc----41c0560ea6---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----41c0560ea6--------------------------------)
    ·5 min read·Apr 20, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41c0560ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-data-cleaning-with-bigquery-sql-user-defined-functions-41c0560ea6&user=Vicky+Yu&userId=cd08464b29cc&source=-----41c0560ea6---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41c0560ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-data-cleaning-with-bigquery-sql-user-defined-functions-41c0560ea6&source=-----41c0560ea6---------------------bookmark_footer-----------)![](../Images/e4af66655e15b1d6abe99b4aae5a16c3.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Brooke Cagle](https://unsplash.com/@brookecagle?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: A large portion of any data-related job is data cleaning but often times writing
    SQL statements can be tedious, especially coding the same SQL logic over multiple
    columns in a table. This is until I discovered I could create [user-defined functions
    (UDFs) in BigQuery](https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions)
    to meet my specific data cleaning use case. Today I’d like to share a few data
    cleaning use cases where you can apply UDFs to simplify your SQL queries.
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Since database permissions differ across companies, I’ll be discussing data
    cleaning examples using temporary UDFs because permanent ones may require additional
    access not allowed by your database administrator. Temporary UDFs expire when
    the SQL query is completed while persistent UDFs are saved in the database and
    can be used across multiple SQL queries.
  prefs: []
  type: TYPE_NORMAL
- en: I’ll be using fake movie data I created and uploaded into [BigQuery sandbox](https://cloud.google.com/bigquery/docs/sandbox)that’s
    free to anyone with a Google account. I received similar data for a data analyst
    interview take-home assignment a few years ago and will use data cleaning examples
    I performed in the assignment but using UDFs.
  prefs: []
  type: TYPE_NORMAL
- en: 'Use Case 1: Grouping Values For Reporting'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL

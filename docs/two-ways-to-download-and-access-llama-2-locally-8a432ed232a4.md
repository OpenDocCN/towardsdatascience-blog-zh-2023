# ä¸¤ç§æœ¬åœ°ä¸‹è½½å’Œè®¿é—® Llama 2 çš„æ–¹æ³•

> åŸæ–‡ï¼š[`towardsdatascience.com/two-ways-to-download-and-access-llama-2-locally-8a432ed232a4`](https://towardsdatascience.com/two-ways-to-download-and-access-llama-2-locally-8a432ed232a4)

## åœ¨ä½ çš„ PC ä¸Šä½¿ç”¨ Llama 2 çš„é€æ­¥æŒ‡å—

[](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)![Ana Bildea, PhD](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8a432ed232a4--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----8a432ed232a4--------------------------------) [Ana Bildea, PhD](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)

Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8a432ed232a4--------------------------------) Â·10 åˆ†é’Ÿé˜…è¯»Â·2023 å¹´ 9 æœˆ 5 æ—¥

--

![](img/8096320260dd4a194856f7b6ae2ee973.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…ï¼ˆDreamstudioï¼‰

# åŠ¨æœº

Meta æœ€æ–°å‘å¸ƒçš„ Llama 2 æ­£åœ¨è·å¾—è¶Šæ¥è¶Šå¤šçš„å…³æ³¨ï¼Œå¹¶ä¸”å¯¹å„ç§ä½¿ç”¨åœºæ™¯éƒ½éå¸¸æœ‰è¶£ã€‚å®ƒæä¾›äº†ä¸åŒå¤§å°çš„é¢„è®­ç»ƒå’Œå¾®è°ƒçš„ Llama 2 è¯­è¨€æ¨¡å‹ï¼Œä» 7B åˆ° 70B å‚æ•°ã€‚Llama 2 åœ¨æ¨ç†ã€ç¼–ç ã€èƒ½åŠ›å’ŒçŸ¥è¯†åŸºå‡†ç­‰å„ç§æµ‹è¯•ä¸­è¡¨ç°è‰¯å¥½ï¼Œè¿™ä½¿å®ƒéå¸¸æœ‰å‰æ™¯ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é€æ­¥æŒ‡å¯¼ä½ åœ¨ PC ä¸Šä¸‹è½½ Llama 2 çš„è¿‡ç¨‹ã€‚ä½ æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šå®˜æ–¹çš„ Meta AI ç½‘ç«™æˆ– HuggingFaceã€‚æˆ‘ä»¬è¿˜ä¼šå±•ç¤ºå¦‚ä½•è®¿é—®å®ƒï¼Œä»¥ä¾¿ä½ å¯ä»¥åˆ©ç”¨å…¶å¼ºå¤§çš„åŠŸèƒ½æ¥æ”¯æŒä½ çš„é¡¹ç›®ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼

# å‰ææ¡ä»¶

+   [Jupyter Notebook](https://jupyter.org/)

+   Nvidia T4 å›¾å½¢å¤„ç†å•å…ƒ (GPU)

+   è™šæ‹Ÿç¯å¢ƒ (Virtualenv)

+   [HuggingFace](https://huggingface.co/) è´¦æˆ·ã€åº“ä»¥åŠ Llama æ¨¡å‹

+   Python 3.10

# æœ¬åœ°ä¸‹è½½å‰éœ€è¦è€ƒè™‘çš„äº‹é¡¹

åœ¨å°†æ¨¡å‹ä¸‹è½½åˆ°æœ¬åœ°æœºå™¨ä¹‹å‰ï¼Œè€ƒè™‘ä¸€äº›äº‹é¡¹ã€‚é¦–å…ˆï¼Œç¡®ä¿ä½ çš„è®¡ç®—æœºæœ‰è¶³å¤Ÿçš„å¤„ç†èƒ½åŠ›å’Œå­˜å‚¨ç©ºé—´ï¼ˆä» SSD ç£ç›˜åŠ è½½æ¨¡å‹è¦å¿«å¾—å¤šï¼‰ã€‚å…¶æ¬¡ï¼Œå‡†å¤‡è¿›è¡Œä¸€äº›åˆå§‹è®¾ç½®ä»¥ä½¿æ¨¡å‹è¿è¡Œã€‚æœ€åï¼Œå¦‚æœä½ æ˜¯å‡ºäºå·¥ä½œéœ€è¦ä½¿ç”¨æ­¤æ¨¡å‹ï¼Œè¯·æ£€æŸ¥å…¬å¸å…³äºä¸‹è½½å¤–éƒ¨è½¯ä»¶çš„æ”¿ç­–ã€‚

# ä¸ºä»€ä¹ˆè¦æœ¬åœ°ä¸‹è½½ Llama 2ï¼Ÿ

ä½ å¯èƒ½æœ‰å‡ ä¸ªå¾ˆå¥½çš„ç†ç”±å¸Œæœ›å°†æ¨¡å‹ä¸‹è½½åˆ°è‡ªå·±çš„è®¡ç®—æœºä¸Šï¼Œä¾‹å¦‚ï¼š

+   **å‡å°‘å»¶è¿Ÿ** é€šè¿‡åœ¨ä½ çš„ç¯å¢ƒä¸­æ‰˜ç®¡ Llama 2ï¼Œä½ å¯ä»¥å°†ä¸å¤–éƒ¨æœåŠ¡å™¨çš„ API è°ƒç”¨ç›¸å…³çš„å»¶è¿Ÿé™åˆ°æœ€ä½ã€‚

+   **æ•°æ®éšç§** ä½ å¯ä»¥å°†ç§äººå’Œæ•æ„Ÿä¿¡æ¯ä¿å­˜åœ¨è‡ªå·±çš„ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ˆæœ¬åœ°æˆ–å¤–éƒ¨äº‘æä¾›å•†ï¼‰ã€‚

+   **å®šåˆ¶å’Œæ§åˆ¶** æ‚¨å¯¹æ¨¡å‹æ‹¥æœ‰æ›´å¤šæ§åˆ¶æƒã€‚æ‚¨å¯ä»¥ä¼˜åŒ–æœºå™¨çš„é…ç½®ï¼Œè¿›è¡Œä¼˜åŒ–æŠ€æœ¯çš„å·¥ä½œï¼Œå¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œå¹¶è¿›ä¸€æ­¥å°†å…¶é›†æˆåˆ°æ‚¨çš„ç”Ÿæ€ç³»ç»Ÿä¸­ã€‚

+   **ç¦»çº¿è®¿é—®** æ ¹æ®ä½¿ç”¨æƒ…å†µï¼Œæ¨¡å‹å¯èƒ½æ‰˜ç®¡åœ¨æ²¡æœ‰äº’è”ç½‘è¿æ¥çš„å®‰å…¨ç¯å¢ƒä¸­ã€‚

# é€‰æ‹©è·å–â€œLlama 2â€çš„æ¥æº

å†³å®šä»å“ªé‡Œè·å–â€œLlama 2â€æ˜¯åŸºäºå¯¹æ‚¨æœ€åˆé€‚çš„é€‰æ‹©ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›è€ƒè™‘å› ç´ ï¼Œä»¥å¸®åŠ©æ‚¨åšå‡ºé€‰æ‹©ã€‚

## Meta çš„ GitHubï¼š

å½“æ‚¨ä» Meta çš„ GitHub è·å–â€œLlama 2â€æ—¶ï¼Œæ‚¨ç›´æ¥ä»æºå¤´è·å–ã€‚è¿™ä½¿æ‚¨å¯ä»¥è®¿é—®æœ€æ–°çš„æ›´æ–°ã€‚ç„¶è€Œï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼Œç¤¾åŒºå¯èƒ½ä¸ä¼šåƒ HuggingFace é‚£æ ·ååº”è¿…é€Ÿã€‚æ–‡æ¡£å¾ˆå¥½ï¼Œä½†å°è¯•ç¤ºä¾‹å¯èƒ½éœ€è¦æ›´å¤šç¼–ç ã€‚

## Hugging Faceï¼š

ä½¿ç”¨ Hugging Face éå¸¸ç®€å•ï¼Œå› ä¸ºå®ƒå…·æœ‰ç”¨æˆ·å‹å¥½çš„å¹³å°å’Œååº”è¿…é€Ÿä¸”å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒã€‚å®ƒå…¼å®¹å¤šä¸ªæ¡†æ¶ï¼Œä½¿å¾—å°†æ¨¡å‹é›†æˆåˆ°ç°æœ‰æŠ€æœ¯æ ˆä¸­å˜å¾—æ›´åŠ å®¹æ˜“ã€‚

å› æ­¤ï¼Œå¦‚æœæ‚¨éœ€è¦å®šåˆ¶å’Œè§è§£ï¼Œå»ºè®®ç›´æ¥ä» Meta çš„ GitHub è·å–æ¨¡å‹ï¼›å¦‚æœéœ€è¦æ˜“ç”¨æ€§ã€ç¤¾åŒºæ”¯æŒå’Œä¸å„ç§æ¡†æ¶çš„å…¼å®¹æ€§ï¼Œå¯ä»¥é€‰æ‹© Hugging Faceã€‚

# 1ï¸âƒ£ ä» Meta ç½‘ç«™ä¸‹è½½ Llama 2

## æ­¥éª¤ 1ï¼šè¯·æ±‚ä¸‹è½½

ä¸‹è½½ Llama 2 æ¨¡å‹æƒé‡å’Œåˆ†è¯å™¨çš„ä¸€ä¸ªé€‰é¡¹æ˜¯[Meta AI ç½‘ç«™](https://ai.meta.com/resources/models-and-libraries/llama-downloads/)ã€‚åœ¨ä¸‹è½½æ¨¡å‹æƒé‡å’Œåˆ†è¯å™¨ä¹‹å‰ï¼Œæ‚¨å¿…é¡»é˜…è¯»å¹¶åŒæ„è®¸å¯åè®®ï¼Œå¹¶é€šè¿‡æä¾›æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€æäº¤è¯·æ±‚ã€‚å¡«å†™ä»¥ä¸‹ä¿¡æ¯å¹¶æ¥å—æ¡æ¬¾ï¼š

![](img/f355ed05cf573afd2cd1008e4a0b33e4.png)

ä½œè€…æä¾›çš„å›¾ç‰‡

ä¸€æ—¦æ‚¨çš„è¯·æ±‚è¢«æ‰¹å‡†ï¼Œæ‚¨å°†é€šè¿‡ç”µå­é‚®ä»¶æ”¶åˆ°ä¸€ä¸ª`signed URL`ã€‚

æä¸ªå°æé†’ï¼æä¾›çš„ä¸‹è½½æ¨¡å‹æƒé‡å’Œåˆ†è¯å™¨çš„é“¾æ¥ä»…åœ¨ 24 å°æ—¶å†…æœ‰æ•ˆï¼Œå¹¶ä¸”ä¸‹è½½æ¬¡æ•°æœ‰é™ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨çœ‹åˆ°è¯¸å¦‚â€œ403: Forbiddenâ€çš„é”™è¯¯ï¼Œè¯·ä¸è¦æ‹…å¿ƒï¼æ‚¨å¯ä»¥é€šè¿‡è¿”å› Meta AI ç½‘ç«™è¯·æ±‚ä¸€ä¸ªæ–°é“¾æ¥ã€‚

## æ­¥éª¤ 2ï¼šè·å– download.sh è„šæœ¬

åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»å®‰è£…äº†`wget`å’Œ`md5sum`ã€‚æ‚¨å¯ä»¥åœ¨[Meta çš„ GitHub ä»“åº“](https://github.com/facebookresearch/llama.git)æ‰¾åˆ°æ‰€éœ€çš„ download.sh è„šæœ¬ã€‚å…‹éš†è¯¥ä»“åº“å¹¶æŒ‰å¦‚ä¸‹æ–¹å¼è¿›å…¥`llama`ç›®å½•ï¼š

```py
git clone https://github.com/facebookresearch/llama.git
cd llama 
```

é€šè¿‡è¾“å…¥ä»¥ä¸‹å‘½ä»¤ç¡®ä¿æ‚¨èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™ï¼š

```py
chmod +x download.sh
```

## æ­¥éª¤ 3ï¼šå¯åŠ¨ä¸‹è½½è¿‡ç¨‹

è¦å¯åŠ¨ä¸‹è½½è¿‡ç¨‹ï¼Œæ‚¨éœ€è¦è¿è¡Œ`download.sh`è„šæœ¬ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨æä¾›é€šè¿‡ç”µå­é‚®ä»¶å‘é€çš„ URL ä»¥åŠæ‚¨å¸Œæœ›ä¸‹è½½çš„æ¨¡å‹ã€‚

æ‚¨å¯ä»¥é€‰æ‹©ä¸‹è½½ä¸¤ç§ä¸åŒç±»å‹çš„æ¨¡å‹ï¼š

+   ***é¢„è®­ç»ƒ*** â€” Llama-2â€“7b, Llama-2â€“13b, Llama-2â€“70b

+   ***å¾®è°ƒçš„èŠå¤©*** â€” Llama-2â€“7b-chatï¼ŒLlama-2â€“13b-chatï¼ŒLlama-2â€“70b-chat

å°±æˆ‘è€Œè¨€ï¼Œæˆ‘ä¼šè·å¾— Llama-2â€“7b å’Œ Llama-2â€“7b-chatã€‚

```py
bash download.sh
```

![](img/5657df14b6be6c74df1d12f3360013a6.png)

å¦‚æœä¸‹è½½æˆåŠŸï¼Œä½ åº”è¯¥èƒ½æ‰¾åˆ°åˆ†è¯å™¨å’Œæ¨¡å‹ llama-2â€“7b åŠ llama-2â€“7b-chatã€‚

![](img/19983a212b2f144d840de1e53e655039.png)

ä½œè€…æä¾›çš„å›¾ç‰‡

## **æ­¥éª¤ 4ï¼šå‡†å¤‡æœ¬åœ°ç¯å¢ƒ**

ä¸ºäº†è·å¾—æœ€ä½³éš”ç¦»ï¼Œå»ºè®®å»ºç«‹ä¸€ä¸ªå…¨æ–°çš„æœ¬åœ°ç¯å¢ƒï¼›æˆ‘ä¸ªäººä½¿ç”¨ Conda ç¯å¢ƒç®¡ç†ç³»ç»Ÿã€‚è®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºæ–°çš„ Conda ç¯å¢ƒï¼š

```py
conda create --name yourenvname python=3.10
```

ç”¨ä½ æƒ³è¦ç»™ç¯å¢ƒçš„åç§°æ›¿æ¢ `yourenvname`ï¼Œç”¨é¦–é€‰çš„ Python ç‰ˆæœ¬æ›¿æ¢ `3.10`ã€‚åˆ›å»ºç¯å¢ƒåï¼Œä½ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æ¿€æ´»å®ƒï¼š

```py
conda activate yourenvname
```

ç„¶åï¼Œå¯¼èˆªåˆ°å…‹éš†çš„ä»“åº“å¹¶å®‰è£… `requirements.txt` ä¸­æåˆ°çš„æ‰€éœ€åº“ã€‚

```py
pip install -r requirements.txt 
```

è¿˜æœ‰ä¸€ä»¶äº‹ä½ éœ€è¦åšï¼šä»¥å…è®¸ä½ æ›´æ”¹ä»£ç å¹¶ç«‹å³æŸ¥çœ‹æ•ˆæœçš„æ–¹å¼å®‰è£…é¡¹ç›®åŒ…ï¼Œè€Œä¸å¿…é‡æ–°å®‰è£…ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```py
pip install -e .
```

æ—¢ç„¶æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ï¼Œè®©æˆ‘ä»¬è¿è¡Œæ¨¡å‹çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

# 4\. ä½¿ç”¨ `torchrun` è¿è¡Œæ¨ç†

Torchrun æ˜¯ PyTorch ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œé€šè¿‡è‡ªåŠ¨åˆ†é…å·¥ä½œè€…ã€å¤„ç†æ•…éšœã€æ”¯æŒå¼¹æ€§è®¾ç½®å’Œæä¾›è¶…è¶Š `torch.distributed.launch` çš„åŠŸèƒ½ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰å…¥å£ç‚¹ã€å‚æ•°ä¼ é€’å’Œæ—¥å¿—æ•è·ï¼‰æ¥ç®€åŒ–åˆ†å¸ƒå¼è®­ç»ƒã€‚

åœ¨å…‹éš†çš„ä»“åº“ä¸­ï¼Œä½ åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªç¤ºä¾‹ï¼š`example_chat_completion.py` å’Œ `example_text_completion.py`ã€‚

ç”±äºä¸¤ä¸ªè„šæœ¬éƒ½è®¾è®¡ç”¨äºåˆ†å¸ƒå¼è®­ç»ƒï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€äº›å˜é‡ã€‚ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ç®€å•åœ°å¯¼å‡ºå®ƒä»¬ï¼Œæˆ–å°†å®ƒä»¬æ·»åŠ åˆ° `.bashrc` ä¸­ã€‚

```py
export RANK=1
export WORLD_SIZE=0
export MASTER_ADDR=localhost
export MASTER_PORT=12355
```

+   `RANK`ï¼šåˆ†å¸ƒå¼è®­ç»ƒç»„ä¸­å½“å‰è¿›ç¨‹çš„ç­‰çº§ã€‚

+   `WORLD_SIZE`ï¼šåˆ†å¸ƒå¼ç»„ä¸­çš„æ€»è¿›ç¨‹æ•°ã€‚

+   `MASTER_ADDR`ï¼šåè°ƒè®­ç»ƒçš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚

+   `MASTER_PORT`ï¼šç”¨äºä¸ä¸»èŠ‚ç‚¹é€šä¿¡çš„ç«¯å£å·ã€‚

è¦æ‰§è¡Œ `torchrun`ï¼Œæˆ‘ä»¬éœ€è¦ï¼š

+   å°† `nproc-per-node` å®šä¹‰ä¸ºå¯ç”¨çš„ GPU æ•°é‡ï¼Œ

+   æä¾› `script.py`ï¼Œ

+   é€šè¿‡ `ckpt_dir` æŒ‡å®šæ¨¡å‹æ£€æŸ¥ç‚¹ç›®å½•ï¼Œ

+   ä½¿ç”¨ `tokenizer_path` æŒ‡å®šåˆ†è¯å™¨çš„è·¯å¾„ã€‚

```py
torchrun --nproc-per-node=NUM_GPUS_YOU_HAVE your_script.py \ 
         -- ckpt_dir /path/to/checkpoint \ 
         -- tokenizer_path /path/to/tokenizer
```

è®©æˆ‘ä»¬è¿è¡Œ `example_text_completion.py`ï¼Œå…¶ä¸­åˆå§‹æç¤ºä¸ºï¼š

![](img/f1122b768da07bf26d25a4ff783e2d6e.png)

ä½œè€…æä¾›çš„å›¾ç‰‡

```py
torchrun --nproc_per_node 1 example_text_completion.py \
    --ckpt_dir llama-2-7b/ \
    --tokenizer_path tokenizer.model \
    --max_seq_len 128 --max_batch_size 4
```

![](img/592106ab554f61bddbcd56e988247ae1.png)

ä½œè€…æä¾›çš„å›¾ç‰‡

å°±è¿™æ ·ã€‚ä½ æˆåŠŸäº†ï¼ç°åœ¨ä½ å¯ä»¥æ›´æ”¹æç¤ºå¹¶å°è¯•å…¶ä»–æ¨¡å‹ ğŸ˜ƒã€‚

**ç®€çŸ­å›é¡¾ï¼š**

> è®¿é—® **Meta å®˜æ–¹ç½‘ç«™** å¹¶ç”³è¯·ä¸‹è½½æƒé™ã€‚
> 
> è®¿é—® [**Llama 2 ä»“åº“**](https://github.com/facebookresearch/llama) åœ¨ GitHub ä¸Šå¹¶ä¸‹è½½ **download.sh** è„šæœ¬ã€‚
> 
> **æ‰§è¡Œ download.sh** å¹¶æä¾›é€šè¿‡ç”µå­é‚®ä»¶å‘é€çš„ç­¾å URLï¼š
> 
> https://download.llamameta.net/*?YOUR_SIGNED_URL å¹¶é€‰æ‹©è¦ä¸‹è½½çš„æ¨¡å‹æƒé‡
> 
> **å‡†å¤‡ç¯å¢ƒ**
> 
> **ä½¿ç”¨ torchrun è¿›è¡Œå¹²é¢„**

# 2ï¸âƒ£ ä» HuggingFace ä¸‹è½½ Llama 2

## æ­¥éª¤ 1ï¼šè¯·æ±‚ä¸‹è½½

é¦–å…ˆï¼Œç¡®ä¿ä½ åœ¨ [Meta AI ç½‘ç«™](https://ai.meta.com/resources/models-and-libraries/llama-downloads/) ä¸Šç”¨ä¸ä½ çš„ Hugging Face å¸æˆ·å…³è”çš„ç¡®åˆ‡ç”µå­é‚®ä»¶åœ°å€è¯·æ±‚ä¸‹è½½ã€‚æ¥å—[è®¸å¯æ¡æ¬¾](https://ai.meta.com/llama/license/)å’Œ[å¯æ¥å—ä½¿ç”¨æ”¿ç­–](https://ai.meta.com/llama/use-policy/)ã€‚å®Œæˆåï¼Œä½ å¯ä»¥ç”³è¯·è®¿é—® [Hugging Face](https://huggingface.co/meta-llama) ä¸Šçš„ä»»ä½•å¯ç”¨æ¨¡å‹ã€‚

ä¸‹é¢æ˜¯å½“å‰å¯ç”¨æ¨¡å‹çš„åˆ—è¡¨ã€‚

![](img/2bae9ef762dc58f83c6bf7d9a9140975.png)

cc. Hugging Face

ä½ å°†æ”¶åˆ°æ¥è‡ª HuggingFace çš„ç¡®è®¤è®¿é—®è®¸å¯çš„ç”µå­é‚®ä»¶ã€‚

## æ­¥éª¤ 2ï¼šä» HuggingFace è·å–ä»¤ç‰Œ

å¦‚æœä½ è¿˜æ²¡æœ‰ HuggingFace è´¦æˆ·ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªã€‚åˆ›å»ºè´¦æˆ·åï¼Œç™»å½• HuggingFaceã€‚ç™»å½•åï¼Œæ‰¾åˆ°å³ä¸Šè§’çš„`Profile`é€‰é¡¹å¹¶é€‰æ‹©`Settings`ã€‚

![](img/de689ce4ccfa73399e2774658b8f29cb.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›

é€‰æ‹©`Access Tokens`é€‰é¡¹å¹¶ç‚¹å‡»`New token`æŒ‰é’®ä»¥ç”Ÿæˆä»¤ç‰Œã€‚

![](img/64575ff4e6fb9986513ef26906dc9ace.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›

åªéœ€å¤åˆ¶ä»¤ç‰Œå¹¶è¿”å›åˆ°ä½ çš„ç¬”è®°æœ¬ä¸­ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•è®¿é—®å’Œä¸‹è½½æ¨¡å‹ã€‚

## æ­¥éª¤ 3ï¼šå¯¹ HuggingFace è¿›è¡Œèº«ä»½éªŒè¯

é¦–å…ˆï¼Œå®‰è£… Hugging Face å¼€å‘çš„ `huggingface_hub` æ¨¡å—ï¼Œå®ƒä½¿ä½ èƒ½å¤Ÿä¸ Hugging Face Model Hub è¿›è¡Œäº¤äº’ã€‚è¯¥ä¸­å¿ƒæ‰˜ç®¡å„ç§é¢„è®­ç»ƒæ¨¡å‹ã€‚è¯·æ³¨æ„ï¼Œ`huggingface_hub.login()` éœ€è¦ `ipywidgets` åŒ…ã€‚

```py
!pip install huggingface_hub ipywidgets
```

ç„¶åï¼Œå¯¼å…¥ `huggingface_hub` å¹¶æŒ‰å¦‚ä¸‹æ–¹å¼ç™»å½• Hugging Faceï¼š

```py
import huggingface_hub
huggingface_hub.login()
```

å½“ä½ è¿è¡Œ `huggingface_hub.login()` æ—¶ï¼Œä½ ä¼šè¢«è¦æ±‚æä¾›ä½ çš„ Hugging Face èº«ä»½éªŒè¯ä»¤ç‰Œã€‚æˆåŠŸè®¤è¯åï¼Œä½ å¯ä»¥ä¸‹è½½ llama æ¨¡å‹ã€‚ç²˜è´´ä½ çš„ä»¤ç‰Œå¹¶ç‚¹å‡»ç™»å½•ã€‚å¦‚æœè®¤è¯æˆåŠŸï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯ã€‚

åœ¨èº«ä»½éªŒè¯é€šè¿‡åï¼Œä½ å¯ä»¥ç»§ç»­ä¸‹è½½å…¶ä¸­ä¸€ä¸ª llama æ¨¡å‹ã€‚æˆ‘ä¼šé€‰æ‹©`meta-llama/Llama-2â€“7b-chat-hf`ã€‚

## æ­¥éª¤ 4ï¼šä¸‹è½½ Llama 2 æ¨¡å‹

é¦–å…ˆå®‰è£…æ‰€éœ€çš„åº“ã€‚

ä½ å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æ£€æŸ¥å¯ç”¨çš„ GPUï¼š

è¦æ£€æŸ¥ä½ çš„ GPU è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚é©±åŠ¨ç‰ˆæœ¬ã€CUDA ç‰ˆæœ¬ã€GPU åç§°æˆ–ä½¿ç”¨æŒ‡æ ‡ï¼Œè¯·åœ¨å•å…ƒæ ¼ä¸­è¿è¡Œå‘½ä»¤ `!nvidia-smi`ã€‚

ç„¶åï¼Œä¸ºäº†ä¸‹è½½æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä» PyTorch å’Œ Hugging Face çš„ Transformers å¯¼å…¥æ‰€æœ‰å¿…è¦çš„åº“ï¼Œåˆå§‹åŒ– Llama-2â€“7b èŠå¤©æ¨¡å‹åŠå…¶æ ‡è®°å™¨ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°ç£ç›˜ã€‚è¯·æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼š

æ‰§è¡Œå®Œå•å…ƒæ ¼åï¼Œä½ åº”è¯¥ä¼šåœ¨`huggingface`ç›®å½•ä¸‹çœ‹åˆ°æ¨¡å‹ã€‚

åœ¨è¿›ä¸€æ­¥æ“ä½œä¹‹å‰æ£€æŸ¥ç›®å½•ã€‚é‡Œé¢åº”è¯¥æœ‰ä»€ä¹ˆï¼Ÿ

+   `config.json`ï¼šå°†å…¶è§†ä¸ºæ¨¡å‹æ“ä½œçš„æ‰‹å†Œã€‚

+   `pytorch_model.bin`ï¼šè¿™æ˜¯ä½ çš„æ¨¡å‹åœ¨ PyTorch æ ¼å¼ä¸­çš„â€œå¤§è„‘â€ã€‚

+   å¿…éœ€çš„åˆ†è¯å™¨æ–‡ä»¶ï¼š`special_tokens_map.json` å’Œ `tokenizer_config.json` å°±åƒæ˜¯ä½ æ¨¡å‹è¯­è¨€çš„è¯å…¸ã€‚

+   `tokenizer.model` Llama 2 åˆ†è¯å™¨

## ç¬¬ 5 æ­¥ï¼šä»ç£ç›˜åŠ è½½ Llama 2 æ¨¡å‹

å¦‚æœä½ å·²ç»å°† Llama 2 æ¨¡å‹å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä½ åº”è¯¥å…ˆåŠ è½½å®ƒä»¬ã€‚

ä¸ºæ­¤ï¼Œä½ éœ€è¦ï¼š

+   `LlamaForCausalLM` å°±åƒæ˜¯ "Llama 2" çš„å¤§è„‘ï¼Œ

+   `LlamaTokenizer` æœ‰åŠ©äº "Llama 2" ç†è§£å’Œåˆ†è§£å•è¯ã€‚

+   æ¨¡å‹çš„è·¯å¾„

æˆ‘ä»¬å·²ç»åˆ°äº†æœ€åä¸€æ­¥â€”â€”æµ‹è¯•å¹²é¢„ã€‚

## ç¬¬ 6 æ­¥ï¼šä½¿ç”¨ HuggingFace ç®¡é“è¿›è¡Œå¹²é¢„

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ HuggingFace transformers çš„ç®¡é“æ¥è¯„ä¼°å¹²é¢„ã€‚åˆ©ç”¨ç®¡é“ï¼Œä½ å¯ä»¥å¿«é€Ÿå®Œæˆå¤æ‚ä»»åŠ¡ã€‚

+   `text-generation`ï¼šæŒ‡å®šç®¡é“ç”¨äºç”Ÿæˆæ–‡æœ¬ã€‚

+   `model`ï¼šä½ ç”¨äºæ–‡æœ¬ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹ã€‚

+   `tokenizer`ï¼šç”¨äºå¤„ç†è¾“å…¥æ–‡æœ¬å’Œè§£ç æ¨¡å‹è¾“å‡ºçš„åˆ†è¯å™¨ã€‚

+   `device_map=â€autoâ€`ï¼šè¿™å°è¯•åœ¨æœ€ä½³å¯ç”¨è®¾å¤‡ä¸Šè¿è¡Œæ¨¡å‹ï¼ˆä¾‹å¦‚ï¼Œè‹¥å¯ç”¨åˆ™ä¸º GPUï¼Œå¦åˆ™ä¸º CPUï¼‰ã€‚

+   `max_new_tokens=512`ï¼šé™åˆ¶ç”Ÿæˆçš„è¾“å‡ºä¸º 512 ä¸ªæ ‡è®°ã€‚

+   `num_return_sequences=1`ï¼šåªè¯·æ±‚ä¸€ä¸ªç”Ÿæˆçš„åºåˆ—ã€‚

+   `eos_token_id=tokenizer.eos_token_id`ï¼šåºåˆ—ç»“æŸæ ‡è®° IDã€‚

*ä»¥æˆ‘çš„æƒ…å†µä¸ºä¾‹ï¼Œæˆ‘æƒ³è¦ä¸€äº›æ‘‡æ»šä¹é˜Ÿçš„å»ºè®®ï¼Œç»“æœéå¸¸å¥½ã€‚*

![](img/1317429912fe58f6b9a5566cdf76a850.png)

**ä» HuggingFace ä¸‹è½½ Llama çš„ç®€çŸ­å›é¡¾ï¼š**

> è®¿é—®**Meta å®˜æ–¹ç½‘ç«™**å¹¶ç”³è¯·ä¸‹è½½æƒé™ã€‚
> 
> ä» HuggingFace è·å–ä»¤ç‰Œ
> 
> è®¤è¯ HuggingFace
> 
> ä¸‹è½½ Llama 2 æ¨¡å‹
> 
> ä»ç£ç›˜åŠ è½½ Llama 2 æ¨¡å‹
> 
> ä½¿ç”¨ HuggingFace ç®¡é“è¿›è¡Œå¹²é¢„

## æœ€åçš„æ€è€ƒï¼š

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°å¦‚ä½•å°† Llama 2 æ¨¡å‹ä¸‹è½½åˆ°æœ¬åœ° PCã€‚ä½ è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨é‡åŒ–ã€è’¸é¦ç­‰æ–¹æ³•è¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œæˆ‘å°†åœ¨åç»­æ–‡ç« ä¸­è®¨è®ºè¿™äº›æ–¹æ³•ã€‚åŠ¡å¿…åœ¨æ–°çš„è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œæ‰€æœ‰è¿™äº›æ­¥éª¤ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè¯·ç¡®ä¿ç›‘æ§è®¡ç®—æœºçš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚å¾ˆå¤šå¥‡æ€ªçš„é”™è¯¯å¯èƒ½éšè—åœ¨å†…å­˜é—®é¢˜åé¢ã€‚å¦‚æœä½ æƒ³ä¸‹è½½é‡åŒ–æ¨¡å‹ï¼Œè¯·æ³¨æ„ä½ å¯èƒ½éœ€è¦å°† `bitsandbytes` åº“é™çº§åˆ° 0.39.1

> æ›¾ç»å°è¯•åœ¨ Medium ä¸Šç‚¹å‡»â€œç‚¹èµâ€æŒ‰é’®å¤šæ¬¡å—ï¼Ÿâ¤ï¸
> 
> è®©æˆ‘ä»¬æˆä¸ºæœ‹å‹å§ï¼âœ‹ åˆ«å¿˜äº† [è®¢é˜…](https://medium.com/subscribe/@anna.bildea)!
> 
> *åœ¨* [*LinkedIn*](https://www.linkedin.com/in/ana-bildea-phd-2339b728/) *å’Œ* [*X*](https://twitter.com/AnaBildea) *æ‰¾åˆ°æˆ‘ï¼*

*å¦‚æœä½ è§‰å¾—æˆ‘çš„æ•…äº‹å¾ˆå¸å¼•äººï¼Œå¹¶å¸Œæœ›æ”¯æŒæˆ‘çš„å†™ä½œï¼Œæˆ‘é‚€è¯·ä½ è€ƒè™‘æˆä¸º Medium ä¼šå‘˜ï¼Œä½ å¯ä»¥è®¿é—®å¤§é‡çš„ç”Ÿæˆ AIã€æ•°æ®å·¥ç¨‹å’Œæ•°æ®ç§‘å­¦æ–‡ç« ã€‚*

[](https://medium.com/@anna.bildea/membership?source=post_page-----8a432ed232a4--------------------------------) [## ä½¿ç”¨æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium â€” Bildea Ana

### ä½œä¸º Medium çš„ä¼šå‘˜ï¼Œä½ çš„éƒ¨åˆ†ä¼šå‘˜è´¹å°†ç”¨äºæ”¯æŒä½ é˜…è¯»çš„ä½œè€…ï¼Œä½ ä¹Ÿå¯ä»¥å®Œå…¨è®¿é—®æ‰€æœ‰æ•…äº‹â€¦

[medium.com](https://medium.com/@anna.bildea/membership?source=post_page-----8a432ed232a4--------------------------------)

æŸ¥çœ‹æˆ‘å…³äºç”Ÿæˆå¼äººå·¥æ™ºèƒ½ã€MLOps å’Œè´Ÿè´£ä»»äººå·¥æ™ºèƒ½çš„æ–‡ç« åˆé›†ã€‚

![Ana Bildea, åšå£«](img/acaa243e5f1e9f9254c32b65042c822b.png)

[Ana Bildea, åšå£«](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)

## ç”Ÿæˆå¼äººå·¥æ™ºèƒ½

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@anna.bildea/list/generative-ai-30d313b29b80?source=post_page-----8a432ed232a4--------------------------------)11 ç¯‡æ•…äº‹![](img/df56a4e1a4785f73007a1ba8d1191b78.png)![](img/b6a7ab27a61a2cd49de8c07ee38f5999.png)![](img/8c3c51cf26b3db2c54205da85ad9fe2e.png)![Ana Bildea, åšå£«](img/acaa243e5f1e9f9254c32b65042c822b.png)

[Ana Bildea, åšå£«](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)

## MLOps - äººå·¥æ™ºèƒ½ç”Ÿäº§

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@anna.bildea/list/mlops-ai-in-production-04b6c81c50c8?source=post_page-----8a432ed232a4--------------------------------)4 ç¯‡æ•…äº‹![](img/8fbedcb9f3f75894caff649172adece1.png)![](img/d5014b3b3843fc4b2172bef517cccaa4.png)![](img/2dba051abf51711268415c3f1e055a60.png)![Ana Bildea, åšå£«](img/acaa243e5f1e9f9254c32b65042c822b.png)

[Ana Bildea, åšå£«](https://medium.com/@anna.bildea?source=post_page-----8a432ed232a4--------------------------------)

## è´Ÿè´£ä»»çš„äººå·¥æ™ºèƒ½

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@anna.bildea/list/responsible-ai-10009e82f412?source=post_page-----8a432ed232a4--------------------------------)1 ç¯‡æ•…äº‹![](img/46a362cef2c3ddcc9e9a1134400f8a6d.png)

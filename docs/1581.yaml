- en: 'Charting the Non-Parametric Odyssey: Statistical Frameworks for Distribution-Free
    Hypothesis Testing'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/charting-the-non-parametric-odyssey-statistical-frameworks-for-distribution-free-hypothesis-e13c10cb157a?source=collection_archive---------7-----------------------#2023-05-10](https://towardsdatascience.com/charting-the-non-parametric-odyssey-statistical-frameworks-for-distribution-free-hypothesis-e13c10cb157a?source=collection_archive---------7-----------------------#2023-05-10)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Gauging the Mechanics of the Sign and Wilcoxon Signed Rank Tests
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://namanagr03.medium.com/?source=post_page-----e13c10cb157a--------------------------------)[![Naman
    Agrawal](../Images/6bb885397aec17f5029cfac7f01edad9.png)](https://namanagr03.medium.com/?source=post_page-----e13c10cb157a--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e13c10cb157a--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e13c10cb157a--------------------------------)
    [Naman Agrawal](https://namanagr03.medium.com/?source=post_page-----e13c10cb157a--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bbb90aa727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcharting-the-non-parametric-odyssey-statistical-frameworks-for-distribution-free-hypothesis-e13c10cb157a&user=Naman+Agrawal&userId=5bbb90aa727&source=post_page-5bbb90aa727----e13c10cb157a---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e13c10cb157a--------------------------------)
    ·19 min read·May 10, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe13c10cb157a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcharting-the-non-parametric-odyssey-statistical-frameworks-for-distribution-free-hypothesis-e13c10cb157a&user=Naman+Agrawal&userId=5bbb90aa727&source=-----e13c10cb157a---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe13c10cb157a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcharting-the-non-parametric-odyssey-statistical-frameworks-for-distribution-free-hypothesis-e13c10cb157a&source=-----e13c10cb157a---------------------bookmark_footer-----------)![](../Images/a20ca4c61e3ea8da4ffa4dec3594bbf3.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Kiwihug](https://unsplash.com/@kiwihug?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/Hld-BtdRdPU?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Contents
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Tool 1: One-Sample Sign Test'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Tool 2: Two-Sample Sign Test'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Limitations of the Sign Test
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Tool 3: One-Sample Wilcoxon Signed Rank Test'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Wilcoxon Signed Rank Test: Possible Complications'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Tool 4: Two-Sample Wilcoxon Signed Rank Test'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Statistics is the corpus of instruments of knowledge that allow us to infer
    from data through tools including, but not limited to, estimation of parameters,
    construction of confidence intervals, and hypothesis testing to validate our assumptions.
    In this article, we will learn about frameworks that allow us to test our hypothesis
    about the values of different data quantiles, namely the Sign Test and the Wilcoxon
    Signed Rank Test. What’s unique about these frameworks is that, unlike popular
    hypothesis tests such as the z-test or the t-test, these tests don’t require any
    assumption made on the data, either through intuition or enforced via the Central
    Limit Theorem i.e., they are distribution-free or non-parametric. All that you
    need is data coming from a symmetric and continuous distribution, and you will
    be equipped with the tools to test claims such as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7149e1e2a3a1cab6e3a9dda81e9ac472.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Tool 1: One-Sample Sign Test'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let’s start with a straightforward test, which only involves counting the values
    lesser than or equal to the threshold for the hypothesis: The Sign Test (aka the
    Binomial Test). In particular, we consider a sample of size n X₁, …, Xₙ as well
    as the simple null hypothesis and the corresponding alternative hypothesis stated
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6d5f260a110c17c2da87371691a5f9d6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where m denotes the median of the given data. As a starting point, let’s think
    about how we’d approach the problem in a traditional t-test setting. In such a
    case, we would assume that n is large, allowing the Central Limit Theorem to kick
    in. Further, since the distribution is always assumed to be symmetric, testing
    for the median should be the same as testing for the mean. Thus, we can define
    the test statistic and the corresponding critical region as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/160f30a10e64f30d7379995d0f9e3b53.png)'
  prefs: []
  type: TYPE_IMG
- en: 'That’s simple enough and quite powerful (as we’ll later see), but it’s based
    on the assumption that the distribution converges to a t distribution of n — 1
    degrees of freedom. But this may not necessarily be true, especially if n isn’t
    large enough. This necessitates an alternative framework that lets us test this
    assumption without bringing in the distributional assumption of the data. This
    leads us to the Sign Test, which simply involves counting the total number of
    observations more than m⁰. For example, consider the following data of n samples:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ac112324978024a1015d6b8b3ecec54f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The hypotheses are given as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/53c8ef19a49b100c48b1f8a01b969911.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As discussed above, we first calculate the number of Xᵢ more than m⁰. Let N⁺
    denote the random variable for the number of Xᵢ more than m⁰ and let n⁺ be its
    realized value for the given sample:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a3de8510815e024d68553abeb14035ac.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, we determine the distribution of the above test statistic under the null.
    Since m = m⁰ under the null, the probability that a sample is more than m⁰ must
    be 0.5\. Thus, N⁺ measures the number of samples more than m⁰, where each sample
    has a probability of 0.5 to contribute to N⁺ under the null hypothesis. In other
    words, N⁺ counts the number of successes, where each success occurs with a probability
    of 0.5\. This defines a binomial random variable parametrized with the number
    of samples n = 10, and the probability of success p = 0.5\. Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cf2c52e71931808c4b07c8baec97d280.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that the distribution of the test statistic is known under the null, we
    can proceed to calculate the p-value for the given sample. Recall that the p-value
    denotes the probability of observing a more extreme value (relative to the sample
    observed value of the test statistic) under the assumption that the null hypothesis
    is true. Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/45dcadd08e7adba1f1997e2ec5197546.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Evidently, the p-value is quite large. So, even at a 10% significance level,
    since the p-value > 0.10, we fail to reject the null hypothesis! And that concludes
    the simple, yet useful application of the sign test. This also leads us to another
    important question: What if the alternative hypothesis was in the other direction,
    or what if it was two-sided? The process still remains the same, just that we
    count the number of observations that are lesser than m⁰ (N⁻). In particular,
    suppose we were interested in testing:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/965d2ea4b8cd84913e0386c5117223b0.png)'
  prefs: []
  type: TYPE_IMG
- en: Then,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b65704d808e73534bff8750b4764d96a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Note that the distribution still follows binomial with the same parameters
    as the reasoning remains the same as for the previous case. Finally, we discuss
    the two-sided hypothesis case:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5ed99ed2fdba0d80f8c7afeb20190ebd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'For this case, we compute both N⁺ and N⁻ for the sample:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3096e3bcc4adb035237f55b4760a9869.png)'
  prefs: []
  type: TYPE_IMG
- en: As before the p-value gives us the probability of an outcome as extreme as 6
    or more numbers more than 0.5\. Because this is a two-sided test, an extreme result
    can be either 6 or more numbers more than 0.5 or 4 or fewer numbers more than
    0.5.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/111ba9f360355fde73fbafca6939ccc1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Just as before, the p-value is quite large. So, even at a 10% significance
    level, since the p-value > 0.10, we fail to reject the null hypothesis! Isn’t
    this fascinating? Just simple counting and one of the most basic probability distributions
    can allow us to test such a hypothesis. But, can we generalize the results? In
    other words, can we use this test in general for any specific quantile, not just
    the median? Sure, the methodology remains exactly the same. For example, suppose
    for the same dataset as above, we are given the following hypotheses:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d4e2262542896795b3f25a1ae2ca7192.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Note that π₀.₂₅ denotes the 25th quantile or the 1st quartile of the data.
    Just as before, we count the number of Xᵢ less than 3:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f475e13496091f7c24ea9139bef648e0.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, we determine the distribution of the above test statistic under the null.
    Since π₀.₂₅ = 3 under the null, the probability that a sample is less than 3 must
    be 0.25\. Thus, N⁻ measures the number of samples less than 3, where each sample
    has a probability of 0.25 to contribute to N⁻ under the null hypothesis. In other
    words, N⁻ counts the number of successes, where each success occurs with a probability
    of 0.25\. This defines a binomial random variable parametrized with the number
    of samples n = 10, and the probability of success p = 0.25\. Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7dfe18fb1315742ddba34587bb884631.png)'
  prefs: []
  type: TYPE_IMG
- en: Consequently,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/17afc994e96435ab7aed6b4776631c88.png)'
  prefs: []
  type: TYPE_IMG
- en: That’s a lower p-value, but still not quite low enough to reject at a 5% or
    10% significance level. With this, we conclude our discussion on the One-Sample
    Sign Test.
  prefs: []
  type: TYPE_NORMAL
- en: 'Tool 2: Two-Sample Sign Test'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we will attempt to generalize the sign test presented earlier
    to the case of two samples. Previously, we were given data (consisting of observations
    from a single sample X), and we could test the hypothesis on whether the median
    (or any of the quantiles) was larger, smaller, or not equal to a given threshold.
    In this section, we will extend the above notion to that of two samples. In particular,
    suppose we are given independent pairs of sample data (x₁, y₁), · · ·, (xₙ, yₙ).
    The null hypothesis states that the two samples are equally likely to be larger
    than the other i.e., the difference in their medians is 0, whereas the alternative
    hypothesis suggests that there is a difference in the two samples i.e, the difference
    in the median is either positive, negative or non-zero. Mathematically, the null
    and alternative hypotheses are given as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/888d7fd887aba34d28e1fcd5ce6bae06.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Example: Suppose we are given the following paired data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3fff6daa8be6e28ab714982a7d8170e4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The hypotheses are given as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ac944abab676dad739e10e7a9fe7ebfc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The process of deriving the test statistic and finding its distribution remains
    similar. In the previous case, we simply checked for samples that were more than
    or less than the threshold (value under the null). In this case, we check for
    the sign by comparing each pair of observations. In other words, we check for
    the sign of Wᵢ = Xᵢ − Yᵢ for each observation from i = 1 to n:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/366f47d45d869d73401c9080f995cbfb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 1: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: 'The test statistic is given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e355fce9aaffb46fc05120fe5d9e8d3c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'By previous logic, the distribution of the test statistic is Bin(n, 0.5) under
    the null (Think of the value of the test statistic as the number of successes
    in n trials, where each success i.e., Xᵢ > Yᵢ has a probability of 0.5 as both
    samples are equally likely to be larger than the other). The p-value is therefore
    given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8a3eb7f9c7d1b9d9ca0bf9437bdba61b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Indeed, the p-value is much smaller, and we can reject the null hypothesis
    at a 10% significance level! Finally, let’s try to calculate the p-value for the
    same data if the alternative hypothesis was two-sided:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/479870ebc4b08fd9556963ccfcc87318.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Because this is a two-sided test, an extreme result can be either 8 or more
    positive signs or 2 or fewer positive signs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9239649e4e05566d23bd61de4208a0a1.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, we won’t be able to reject the null at a 10% significance for the two-sided
    case. This concludes our discussion on conducting the Sign Test for one and two
    sample cases.
  prefs: []
  type: TYPE_NORMAL
- en: Limitations of the Sign Test
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the previous two sections, we used the sign test to conduct different kinds
    of hypothesis testing. While the test was found to be quite useful due to its
    non-parametricity (aka distribution-free). However, in general, the sign test
    isn’t quite powerful (i.e., for the same significance level, the probability of
    type 2 error remains quite high). The main reason for this is that the sign test
    only considers the sign of the values i.e., whether they are lesser than the threshold
    value under the null (for one-sample) or lesser than their counterpart (for two-sample).
    It does not consider the magnitude of the difference i.e., how large or small
    the deviation from 0 is. In practice, the sign test is rarely used, but it still
    serves as a great tool for introducing discussions on non-parametric hypothesis
    testing due to its immense simplicity. This leads us to a new hypothesis-testing
    framework: The Wilcoxon Signed Rank test, an extension to the Sign test in a way,
    that considers the order of the magnitude of deviation from 0 and assigns ranks
    to each sample value. The test will be described in greater detail in the next
    section.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Tool 3: One-Sample Wilcoxon Signed Rank Test'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The theory behind the Wilcoxon Signed Rank Test is slightly convoluted. But,
    don’t worry. Let’s revisit the example from the previous section and apply the
    Wilcoxon test sequentially:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fc108f5bcb37fb2a7048f67047f719b8.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 1:** Find the absolute value of the difference between Xᵢ and m⁰ for
    each i:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d21708499c47097c1fb6a483ce7bc46d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 2: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2:** Rank each of the computed values in step 1 i.e., assign rank (Rᵢ)
    from 1 to n for every | Xᵢ − m⁰|:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2ce047c5f4f0c4d83b90ecc4956d36d8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 3: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 3:** Compute the Signed Rank (Rₛᵢ) for each sample, where the sign is
    given by the sign of Xᵢ − 4 (the same sign that was used in the Sign Test) i.e.,'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d8c1bfd3e5e51ac3824ebad1331e69e2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 4: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4:** Compute the Wilcoxon Signed Rank Test statistic, which is given
    by the sum of the signed ranks for all the data points:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fd65a5daa17b5c852e64fb85700f2a6b.png)'
  prefs: []
  type: TYPE_IMG
- en: Before, we proceed to discuss the distribution of W, let’s pause for a moment
    and think about the logic for these steps. In the sign test, we simply counted
    the number of samples more than or less than m⁰. Here, we are weighing the count
    by rank, which measures the relative absolute deviation from m⁰ for different
    samples. This allows us to give a higher weight to values that were much lesser
    or much larger than m⁰, helping us overcome the limitation of the Sign test.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s evaluate the distribution of W. It’s important to mention now that
    there is NO closed formula for the distribution of W (there are closed-form expressions
    for its moment-generating function, but no such expression exists for its mass
    function). One way to approach this problem is to use tables (Yes, there are specific
    tables designed for the critical values of W for different sample sizes) The other
    alternative is to approximate the distribution (CDF) of W using the Lyapunov CLT:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/52d6b3880e0e15f38fee20209b521b2e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where Φ is the cumulative density function of the standard normal distribution.
    The precise math is quite complex and beyond the scope of this article. But, we
    will still try to make sense of it. Let’s try to calculate the expectation and
    variance of W:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8a48db14ae72f5da24cfec3696d1678d.png)'
  prefs: []
  type: TYPE_IMG
- en: where Sᵣ denotes the sign of the rᵗʰ rank (all rank values will go from 1 to
    n). Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/501de44e03949ded7717efd6e8ea0650.png)'
  prefs: []
  type: TYPE_IMG
- en: 'If we standardize W, we contain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/998878c6f62e828369cf8ef4c545abcf.png)'
  prefs: []
  type: TYPE_IMG
- en: Indeed it’s quite similar to the expression inside Φ. In fact, by Lyapunov CLT
    (Not the traditional CLT, as even though the rSᵣ are independent, they are not
    necessarily identically distributed), we h
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c59742d3d0fcf9f0116742c20d496908.png)'
  prefs: []
  type: TYPE_IMG
- en: 'This leads to the Φ term in the distribution of W. You may also notice that
    the CDF of W contains an additional factor of 1\. This is simply a unit correction.
    Recall that W is a discrete random variable. Whenever a discrete random variable
    is approximated by a continuous one (e.g., the normal distribution), it’s always
    important to add a correction term, usually the half-unit correction. The half-unit
    correction helps to account for this discrepancy by adjusting the probabilities
    of the continuous distribution so that they more closely match the probabilities
    of the discrete distribution. Specifically, the correction involves shifting the
    midpoints of the intervals used to define the continuous distribution by 0.5 units
    in the direction opposite to the rounding convention. This ensures that the probabilities
    assigned to the intervals in the continuous distribution more closely match the
    probabilities of the discrete distribution, which improves the accuracy of the
    approximation. However, for approximating W, we tend to use a full-unit correction
    (instead of the traditional half-unit). This is because the values of W can differ
    from one another only in multiples of 2\. Think of it this way: If you have a
    value of W to be w, and you’re interested in decreasing the value of W by 1, you
    will have to flip the sign of a positive rank, which would add a minimal difference
    of 2\. For instance, in our example, W was calculated to be 3\. If we want to
    decrease W by 1, the best we can do is flip the +1 to -1, but this decreases the
    value of W by 2 (-1–1 = -2). Similar logic holds for increasing the value of W.
    Thus, in order to control for this range of values that W can take, a whole unit
    correction (0.5 × 2 = 1) is used instead of the traditional half unit correction
    (0.5 × 1 = 0.5). Thus, after applying the whole-unit correction and using Lyapunov
    CLT, we obtain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aecc4da2e81e30e1cba89df13c63137e.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that we have obtained an approximate expression for the distribution of
    W, we proceed to calculate the p-value for our example. Recall that the p-value
    denotes the probability of observing a more extreme value (relative to the sample
    observed value of the test statistic) under the assumption that the null hypothesis
    is true. Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b3cc00d2b559b6336f7e0984e9004090.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Evidently, the p-value is quite large. So, even at a 10% significance level,
    since the p-value > 0.10, we fail to reject the null hypothesis! And that concludes
    the simple, yet useful application of the Wilcoxon Signed Rank test. Now let’s
    consider the case when the alternative hypothesis was in the other direction.
    In particular, suppose we were interested in testing:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/30e90198eb4ebb7234a0561685b9746c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The test statistic still remains the same. However, since the direction in
    favor of the alternative hypothesis changes, the p-value calculation is adjusted
    accordingly (as per the definition of p-value):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/84457dbe74ae797fd38ca5b91604d086.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Again, the p-value is large and we fail to reject the null at a 10% significance
    level. Finally, let’s look at the two-sided case:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cb6c8cc38de0452c1843b843aa916512.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The test statistic still remains the same. However, just as before, since the
    direction in favor of the alternative hypothesis changes, the p-value calculation
    is adjusted accordingly (as per the definition of p-value):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/87573c3ac3c9c5e16c8bc6b9167e39f6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Again, the p-value is large and we fail to reject the null at a 10% significance
    level. Now, let’s generalize the test statistic for any specific quantile, not
    just the median. The methodology remains exactly the same. For example, suppose
    for the same dataset as above, we are given the following hypotheses:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1a3f055fa21768ef737cc7dea8083603.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Just as before, we construct the table and sum up the signed ranks to get the
    test statistic:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ffab3d6dab8aaf9cc6f2b86ee592345e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 5: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/700490045d868650679012a0fd7f5e29.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we determine the distribution of the above test statistic under the null:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1cdc7c457538a3dfe450ac5564c7bf4e.png)'
  prefs: []
  type: TYPE_IMG
- en: If we standardize W, we obtain
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c82f74a0f706c24491685058bc6a9f11.png)'
  prefs: []
  type: TYPE_IMG
- en: 'By Lyapunov CLT, we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4148114ea1018e89ae55aba5dcfd8fa6.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0e08e44242febcb158fc5e1b00f50f4f.png)'
  prefs: []
  type: TYPE_IMG
- en: That’s a lower p-value, but still not quite low enough to reject at a 5% or
    10% significance level. With this, we conclude our discussion on the One-Sample
    Wilcoxon Signed Rank Test.
  prefs: []
  type: TYPE_NORMAL
- en: 'Wilcoxon Signed Rank Test: Possible Complications'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are two possible complications that may arise while using the Wilcoxon
    Signed Rank test:'
  prefs: []
  type: TYPE_NORMAL
- en: 'For i ̸= j, |Xᵢ − m⁰| = |Xᵢⱼ − m⁰| i.e., the absolute deviations from m⁰ are
    the same. In this case, which of the observations would be assigned a higher rank?
    Firstly, under the assumption that the data follows a continuous distribution,
    the same data shouldn’t be occurring more than once theoretically. But, often
    in practice, this can happen. There are many ways to approach this problem, but
    the most common strategy is to assign each sample the average of the ranks. For
    instance, if there are 4 sample values such that they have the same absolute deviation
    from m⁰. If these observations take the ranks 7, 8, 9, and 10, for each sample
    we assign the average rank: (7 + 8 + 9 + 10)/4 = 8.5.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If |Xᵢ − m⁰| = 0 for some i, we exclude this sample from the analysis itself.
    We just used the reduced sample (and the corresponding reduced sample size) to
    compute the test statistic and its distribution.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'For example, if we are given the following data and hypothesis:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a015e993a056970dc9c291a2d699b2e0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We exclude the 5th sample (since |X₅ − 3| = 0) and use the remaining samples
    to calculate the average ranks:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0dab4e06fd86eec6e5f79244ee2386a1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 6: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/77f18ab626682d0c20958d49f5ae98cf.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Tool 4: Two-Sample Wilcoxon Signed Rank Test'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As our last non-parametric hypothesis testing toolkit, let’s look at the two-sample
    extension of the Wilcoxon Signed Rank Test. As before, the null hypothesis states
    that the difference in the medians is 0, whereas the alternative hypothesis suggests
    that there is a difference in the two samples i.e., the difference in the median
    is either positive, negative, or non-zero. Mathematically, the null and alternative
    hypotheses are given as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ef702dac012ea64f002954ac0f17a3dd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Let’s first look at the general framework and then consider an example. Suppose
    we are given data from two samples: X₁, X₂, · · ·, Xₙ₁ and Y₁, Y₂, · · ·, Yₙ₂.
    We combine the two samples in a single sample and arrange all observations in
    ascending order. For each observation, we assign the ranks (or average ranks in
    case of disputes) from 1, 2, · · ·, n1 + n2\. Finally, we calculate the sum of
    ranks for all observations from X, which we refer to as our test statistic W.
    For example, consider that we are given the following paired data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/369ba34c44549ad4c38c0da167c1e3fc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The hypotheses are given as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ff0e0773c4372fb79616f8acb9bc88ce.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 1:** Combine Xᵢ and Yᵢ :'
  prefs: []
  type: TYPE_NORMAL
- en: 24.27, 8.63, 16.76, 21.92, 29.59, 4.01, 7.28, −7.75, −6.61, 13.05, 13.47, 24.6,
    −4.97, 0.07, 6.96, −0.53, 7.26, −11.7, −5.01, −4.43
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2:** Arrange the combination in ascending order (remember to keep track
    of which observations, come from which sample:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/44f8ba660c689d962bd6620b9c2793f2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 7: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 3:** Assign The Ranks:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ec2489951f660a98fb1b02787730f5d8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Table 8: Image by Author'
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4:** Calculate the test statistic by summing up ranks from sample X:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0715f185b6814f23386d3c95f258556d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, we find the distribution of W under the null. As before, there is NO
    closed formula for the distribution of W, So we approximate the distribution (CDF)
    of W using the Lyapunov CLT:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ae0861a77c9553bb309ca28d49d15839.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where Φ is the cumulative density function of the standard normal distribution.
    We can check this by calculating the expectation and variance of W. Note, that
    this calculation is quite extensive, so you may skip over it and proceed to the
    p-value calculation directly. But, we still include it for completeness. Let Rˣᵢ
    denote the rank assigned to the iᵗʰ sample from X, and Rʸⱼ denote the rank assigned
    to the jᵗʰ sample from Y :'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dfabb1c2ac2f622639f73d96329b1095.png)'
  prefs: []
  type: TYPE_IMG
- en: Under the null, since the distributions are identical, Rˣᵢ and Rʸⱼ must be identically
    distributed for all 1 ≤ i ≤ n₁; 1 ≤ j ≤ n₂. Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7337e05c048d922e13f8e97ae05be341.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The calculation for the variance is slightly more complex. We make use of the
    following facts:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6239363e48f08be0411db609063975d1.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1d2ab73f023515aa323446553ac02f49.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Similarly, for i ̸= j:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5a1ac30dfd3e5cfcbada0a17abc6c043.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Therefore, by the definition of variance and covariance, we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3f67eecb40e3eddc06099957956e5cab.png)![](../Images/fe5d37ef1c600689926f6c20ceee52cf.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Therefore, by the extended sum of variances:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2b35a6826f737a5b486242ac2ecdd1e9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Thus, if we standardize W and apply CLT, we obtain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/130f11157c699f6171657e875d00d8d1.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0f00cecb1587c1b22ad732810e47ac1f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Thus, at a 10% significance level, since the p-value < 0.10 we can reject the
    null hypothesis! Finally, let’s try to calculate the p-value for the same data
    if the alternative hypothesis was two-sided:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0298ea43f2349b54fb58a1fe5c9b3d20.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The test statistic still remains the same. However, just as before, since the
    direction in favor of the alternative hypothesis changes, the p-value calculation
    is adjusted accordingly (as per the definition of p-value):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c6fe463fc4703b076fc0f2e9550e5693.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, we won’t be able to reject the null at 10% significance for the two-sided
    case. This concludes our discussion on conducting the Wilcoxon Signed Rank Test
    for one and two sample cases.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this article, we familiarised ourselves with some of the most well-known
    non-parametric or distribution-free hypothesis testing frameworks. We took a look
    at the Sign Test and the Wilcoxon Signed Rank Test for both the one-sample and
    the two-sample case and compared their performance on sample observations. We
    explored both the one-sided and the two-sided cases for each of the tests as well
    as how to generalize them for testing for any given quantile of the data. The
    Sign test, although less powerful in general is quite simple, relying only on
    the CDF of the binomial distribution to derive the associated p-values. The Wilcoxon
    Signed Rank Test, on the other hand, is far more complex in its theory but tends
    to give better results as it not only considers whether the values are smaller
    or bigger than the threshold but also considers the relative magnitude of their
    absolute deviations.
  prefs: []
  type: TYPE_NORMAL
- en: Hope you enjoyed reading this article! In case you have any doubts or suggestions,
    do reply in the comment box.
  prefs: []
  type: TYPE_NORMAL
- en: Please feel free to contact me via [mail](mailto:naman.agr03@gmail.com). If
    you liked my article and want to read more of them, visit this [link](https://medium.com/@namanagr03).
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: All images have been made by the author.'
  prefs: []
  type: TYPE_NORMAL

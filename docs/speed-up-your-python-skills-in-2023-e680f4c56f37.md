# åŠ é€Ÿä½ çš„ Python æŠ€èƒ½

> åŸæ–‡ï¼š[`towardsdatascience.com/speed-up-your-python-skills-in-2023-e680f4c56f37`](https://towardsdatascience.com/speed-up-your-python-skills-in-2023-e680f4c56f37)

## ä¸ƒä¸ªæŠ€å·§åŠ©ä½ æ›´ä¸Šä¸€å±‚æ¥¼

[](https://tinztwinspro.medium.com/?source=post_page-----e680f4c56f37--------------------------------)![Janik å’Œ Patrick Tinz](https://tinztwinspro.medium.com/?source=post_page-----e680f4c56f37--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e680f4c56f37--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----e680f4c56f37--------------------------------) [Janik å’Œ Patrick Tinz](https://tinztwinspro.medium.com/?source=post_page-----e680f4c56f37--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e680f4c56f37--------------------------------) Â·é˜…è¯»æ—¶é—´ 9 åˆ†é’ŸÂ·2023 å¹´ 1 æœˆ 16 æ—¥

--

![](img/509f2e1b0475dabe336a49f134d00b80.png)

å›¾ç‰‡æ¥æº [Emile Perron](https://unsplash.com/@emilep?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

**Python** æ˜¯æ•°æ®ç§‘å­¦é¢†åŸŸä½¿ç”¨æœ€å¹¿æ³›çš„ç¼–ç¨‹è¯­è¨€ï¼Œå…¶å—æ¬¢è¿ç¨‹åº¦ä¸æ–­å¢é•¿ã€‚è¿‘å¹´æ¥ï¼Œæ•´ä¸ªæ•°æ®ç§‘å­¦é¢†åŸŸä¹Ÿå¾—åˆ°äº†å·¨å¤§çš„å‘å±•ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å‘ä½ å±•ç¤ºä¸ƒä¸ªæé«˜ Python æŠ€èƒ½çš„æŠ€å·§ã€‚é€šå¸¸æ˜¯é‚£äº›å°ç»†èŠ‚èƒ½äº§ç”Ÿå¤§çš„å·®å¼‚ã€‚è¿™äº›æç¤ºå°†ä¸°å¯Œä½ ä½œä¸ºæ•°æ®ç§‘å­¦å®¶çš„ç”Ÿæ´»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æä¾›äº†ä¸ƒä¸ªå¯ä»¥ç«‹å³å®è·µçš„æŠ€å·§ã€‚**ä¿æŒå¥½å¥‡ï¼**

ä½œä¸ºæ•°æ®ç§‘å­¦å®¶ï¼Œä½ ç»å¸¸éœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®ã€‚å› æ­¤ï¼Œä½ å¿…é¡»åœ¨è¿è¡Œæ—¶é—´å’Œå†…å­˜æ–¹é¢é«˜æ•ˆç¼–ç ã€‚ä½ çš„ Python ä»£ç ä¹Ÿåº”è¯¥ç»“æ„è‰¯å¥½ä¸”æ˜“äºé˜…è¯»ã€‚è¿™äº›æç¤ºå°†å¸®åŠ©ä½ ç¼–å†™é«˜æ•ˆä¸”æ˜“è¯»çš„ Python ä»£ç ã€‚

# æç¤º 1: åŠ é€Ÿ NumPy

[NumPy](https://numpy.org) æ˜¯ä¸€ä¸ªç”¨äºé«˜æ•ˆå¤„ç†æ•°ç»„çš„ Python åº“ã€‚å®ƒè¿˜æä¾›äº†å¿«é€Ÿå’Œä¼˜åŒ–çš„çŸ¢é‡åŒ–æ“ä½œã€‚ä½†ï¼å®ƒä¸æ”¯æŒå¹¶è¡Œå¤„ç†ã€‚ä½œä¸º NumPy çš„æ›¿ä»£å“ï¼Œä½ å¯ä»¥ä½¿ç”¨ [NumExpr](https://numexpr.readthedocs.io/en/latest/index.html)ã€‚

NumExpr çš„æ€§èƒ½æ˜¾è‘—ä¼˜äº NumPyï¼Œå› ä¸ºå®ƒæ”¯æŒå¤šçº¿ç¨‹ã€‚æ­¤å¤–ï¼Œå®ƒé¿å…äº†ä¸ºä¸­é—´ç»“æœåˆ†é…å†…å­˜ã€‚

é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… NumPy å’Œ NumExpr åŒ…ã€‚ä¾‹å¦‚ï¼š

```py
$ pip install numpy numexpr
```

çœ‹çœ‹è¿™ä¸ªä¾‹å­å¹¶å°è¯•ä¸€ä¸‹ã€‚

```py
import numpy as np
import numexpr as ne
import timeit

var1 = np.random.random(2**27)
var2 = np.random.random(2**27)

%timeit np.sin(var1) / np.cos(var2)
# 2.73 s

%timeit ne.evaluate("sin(var1) / cos(var2)")
# 566 ms
```

å“‡ï¼è¯¥è¯­å¥åœ¨ NumExpr ä¸‹æ‰§è¡Œé€Ÿåº¦å¤§çº¦æé«˜äº† 5 å€ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³åŠ å¿« NumPy è¯­å¥çš„é€Ÿåº¦ï¼Œè¿™ä¸ºä½ æä¾›äº†ä¸€ç§å®ç°æ–¹æ³•ã€‚

NumExpr åœ¨å¤„ç†å¤§æ•°ç»„æ—¶æ•ˆæœæœ€ä½³ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¼ºå¤§çš„å¤šæ ¸è®¡ç®—æœºï¼Œå®ƒä¹Ÿèƒ½å‘æŒ¥å…¶æœ€å¤§æ€§èƒ½ã€‚å› æ­¤ï¼Œå½“è¿™ä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³æ—¶ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ NumExprã€‚å¯¹äºå°è§„æ¨¡æ•°ç»„æ“ä½œï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ NumPyï¼Œå› ä¸ºæ€§èƒ½å·®å¼‚éå¸¸å°ã€‚åŸå› æ˜¯ NumExpr å°†æ•°ç»„æ“ä½œæ•°æ‹†åˆ†æˆå°å—ï¼Œè¿™äº›å°å—å¾ˆå®¹æ˜“é€‚åº” CPU ç¼“å­˜ã€‚è¿™äº›å°å—åœ¨ CPU çš„å¯ç”¨æ ¸å¿ƒä¹‹é—´åˆ†é…ï¼Œä»è€Œå®ç°å¹¶è¡Œæ‰§è¡Œã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº NumExpr çš„å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹[NumExpr çš„ GitHub](https://github.com/pydata/numexpr)åº“ã€‚

# æç¤º 2ï¼špandas apply()çš„å¿«é€Ÿæ›¿ä»£æ–¹æ¡ˆ

pandas çš„ apply()å‡½æ•°å¯ä»¥åœ¨æ•°æ®æ¡†çš„ä¸€ä¸ªè½´ä¸Šæ‰§è¡Œå‡½æ•°ã€‚è®¸å¤šç¨‹åºå‘˜å°† apply()å‡½æ•°ä¸ lambda å‡½æ•°ç»“åˆä½¿ç”¨ã€‚ä½†ä½ å¦‚ä½•æé«˜ apply()å‡½æ•°çš„æ€§èƒ½å‘¢ï¼Ÿ

ä½ å¯ä»¥ä½¿ç”¨ swifter åŒ…ã€‚è¿™ä¸ªåŒ…å°†å‡½æ•°éå¸¸å¿«é€Ÿåœ°åº”ç”¨äºæ•°æ®æ¡†æˆ–åºåˆ—ã€‚pandas çš„ apply()å‡½æ•°åœ¨ä¸€ä¸ªæ ¸å¿ƒä¸Šè¿è¡Œï¼Œè€Œ swifter åˆ™æä¾›äº†å¤šä¸ªæ ¸å¿ƒæ”¯æŒã€‚

é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… swifter åŒ…ã€‚

```py
$ pip install swifter
```

å®‰è£…åï¼Œä½ å¯ä»¥ç›´æ¥å°è¯•å®ƒã€‚

```py
import pandas as pd
import numpy as np
import swifter
import timeit

df = pd.DataFrame({'a': np.random.randint(7, 10, 10**7)})

# pandas apply()
%timeit  df.apply(lambda x: x**7)
# 54 ms

# swifter.apply()
%timeit  df.swifter.apply(lambda x: x**7)
# 37.5 ms
```

è¿™ä¸ªç®€å•çš„ä¾‹å­æ˜¾ç¤ºäº† swifter.apply()å‡½æ•°çš„è¿è¡Œæ—¶é—´æ›´å¿«ã€‚å°¤å…¶æ˜¯åœ¨å¤šæ ¸çš„å¼ºå¤§è®¡ç®—æœºä¸Šï¼Œè¿™ä¸€å·®å¼‚å°¤å…¶æ˜æ˜¾ã€‚å¦‚æœä½ åœ¨ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸­éœ€è¦æ€§èƒ½æå‡ï¼Œè€ƒè™‘ä½¿ç”¨ swifter åŒ…ã€‚

# æç¤º 3ï¼šä½¿ç”¨å†…ç½®çš„ Python å‡½æ•°

ä½ ç»å¸¸å®ç°ä¸€ä¸ªå‡½æ•°å´ä¸çŸ¥é“å®ƒåœ¨ Python ä¸­å·²ç»å­˜åœ¨ã€‚å°¤å…¶æ˜¯å¦‚æœä½ æ¥è‡ªå…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ C æˆ– C++ã€‚é¦–å…ˆï¼Œä½ åº”è¯¥æ€»æ˜¯æ£€æŸ¥ Python å†…ç½®å‡½æ•°æ˜¯å¦å·²ç»å­˜åœ¨ã€‚Python å†…ç½®å‡½æ•°æ¯”è‡ªå®šä¹‰å®ç°è¦å¿«å¾—å¤šï¼Œå› æ­¤ä½ åº”è¯¥æ€»æ˜¯ä½¿ç”¨å®ƒä»¬ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ã€‚

```py
import numpy as np
from time import perf_counter

result_list = []
company_list = ["Tesla", "Block", "Palantir", "Apple"]
company_list_sample = np.repeat(company_list, 10**7)

start = perf_counter()
for company in company_list_sample:
  result_list.append(company.lower())
print(perf_counter()-start)
# 17.13 s

start = perf_counter()
result_list = map(str.lower, company_list_sample)
print(perf_counter()-start)
# 0.97 s
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªåŒ…å«å››ä¸ªæ¡ç›®çš„åˆ—è¡¨å¤åˆ¶äº† 1 åƒä¸‡æ¬¡ï¼Œå› æ­¤å¾—åˆ°ä¸€ä¸ªåŒ…å« 4 åƒä¸‡ä¸ªæ¡ç›®çš„åˆ—è¡¨ã€‚ç„¶åæˆ‘ä»¬å°†åˆ—è¡¨ä¸­çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå†…ç½®å‡½æ•°çš„é€Ÿåº¦çº¦å¿«äº† 17 å€ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤§é‡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæç¤ºå¸¦æ¥äº†å·¨å¤§çš„æ€§èƒ½æå‡ã€‚æ‰€ä»¥è¦ä½¿ç”¨å†…ç½®å‡½æ•°ï¼

è¿˜æœ‰è®¸å¤šå†…ç½®å‡½æ•°ï¼Œå¦‚ min()ã€max()ã€all()ç­‰ã€‚å¦‚æœä½ éœ€è¦ç‰¹å®šçš„ Python å‡½æ•°ï¼Œå¯ä»¥è‡ªå·±æŸ¥æ‰¾ã€‚**è¿™å¾ˆå€¼å¾—ï¼**

# æç¤º 4ï¼šä½¿ç”¨åˆ—è¡¨æ¨å¯¼ä»£æ›¿å¾ªç¯

ç¨‹åºå‘˜ç»å¸¸å°†åˆ—è¡¨ä¸å¾ªç¯ç»“åˆä½¿ç”¨æ¥å­˜å‚¨è®¡ç®—ç»“æœã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•åœ¨è¿è¡Œæ—¶é—´ä¸Šæ•ˆç‡ä¸é«˜ã€‚å› æ­¤ï¼Œæœ€å¥½ä½¿ç”¨åˆ—è¡¨æ¨å¯¼ï¼Œå®ƒå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†æ€§èƒ½çš„å·®å¼‚ã€‚

```py
import numpy as np
from time import perf_counter

result_list_loop = []
result_list_com = []

number_round = 10000000

start = perf_counter()
for i in range(number_round):
  result_list_loop.append(i*i)
print(perf_counter()-start)
# 1.47 s

start = perf_counter()
result_list_com = [i*i for i in range(number_round)]
print(perf_counter()-start)
# 0.69 s

print(result_list_com[10])
# 100
```

ä»è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿå°½å¯èƒ½ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ã€‚åˆ—è¡¨æ¨å¯¼å¼åœ¨ç¼–ç¨‹ä¸­æœ‰äº›äº‰è®®ã€‚ä¸€äº›ç¨‹åºå‘˜è§‰å¾—è¯­æ³•éš¾ä»¥é˜…è¯»ï¼Œå› ä¸ºä¸€è¡Œä»£ç è¡¨è¾¾äº†æ‰€æœ‰è¯­å¥ã€‚åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œè¯­æ³•æ¸…æ™°ç®€æ´ã€‚è¿™æ˜¯ä¸€ä¸ªå£å‘³é—®é¢˜ï¼Œä½†åˆ—è¡¨æ¨å¯¼å¼çš„æ€§èƒ½æ›´å¥½ã€‚

åˆ—è¡¨æ¨å¯¼å¼ä»¥å¼€æ‹¬å·[å¼€å§‹ã€‚ç„¶åæ˜¯ for å¾ªç¯ä¸­çš„è®¡ç®—ã€‚æ¥ç€æ˜¯å¾ªç¯å¤´ï¼ŒåŒ…å«ä¸‰ä¸ªå…ƒç´ ï¼ˆå…³é”®å­— forï¼Œè¿è¡Œå˜é‡ï¼Œå¾ªç¯é•¿åº¦ï¼‰ã€‚åˆ—è¡¨æ¨å¯¼å¼ä»¥é—­æ‹¬å·]ç»“æŸã€‚ä¸€æ—¦ä½ ç†è§£äº†è¯­æ³•ï¼Œä½ å¯ä»¥æ›´ç´§å‡‘åœ°ç¼–å†™ for å¾ªç¯ã€‚

é‚£ä¹ˆåœ¨å†…å­˜ä½¿ç”¨æ–¹é¢å‘¢ï¼Ÿæˆ‘ä»¬å¦‚ä½•å‡å°‘å†…å­˜ç©ºé—´ï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³å¯¹å¤§åˆ—è¡¨è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œï¼Œè¿™ä¸€ç‚¹å°¤å…¶å»ºè®®ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ—è¡¨ä¸­å­˜å‚¨äº† 10000000 ä¸ªå€¼ã€‚ä½†æˆ‘ä»¬æ˜¯å¦å¿…é¡»ç›´æ¥ä¿å­˜æ‰€æœ‰æ¡ç›®ï¼Œè¿˜æ˜¯ä»…åœ¨éœ€è¦æ—¶æ‰ä¿å­˜å®ƒä»¬ï¼Ÿ

åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨ã€‚ç”Ÿæˆå™¨åœ¨éœ€è¦æ—¶åˆ›å»ºä¸€ä¸ªåˆ—è¡¨é¡¹ã€‚å› æ­¤ï¼Œç”Ÿæˆå™¨éœ€è¦æ›´å°‘çš„å†…å­˜å¹¶ä¸”è¿è¡Œæ—¶é—´æ›´å¥½ã€‚çœ‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚

```py
import sys 
from time import perf_counter

print(sys.getsizeof(result_list_com), 'bytes')
# 89095160 bytes

start = perf_counter()
result_gen = (i*i for i in range(number_round))
print(perf_counter()-start)
# 0.22 ms

print(sys.getsizeof(result_gen), 'bytes')
# 112 bytes

print(list(result_gen)[10])
# 100
```

æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸ä¹‹å‰ç¤ºä¾‹ç›¸åŒçš„æ‰€æœ‰æ“ä½œã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯()è€Œä¸æ˜¯[]ã€‚æˆ‘ä»¬å­˜å‚¨çš„æ˜¯ç”Ÿæˆå™¨è€Œä¸æ˜¯åˆ—è¡¨ã€‚è¿™ç§æ–¹æ³•åœ¨å†…å­˜ä¸Šæ›´ä¸ºé«˜æ•ˆã€‚æ£€æŸ¥ä¸€ä¸‹ä½ æ˜¯å¦å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼æˆ–ç”Ÿæˆå™¨ã€‚å®ƒä»¬å¯ä»¥æé«˜æ€§èƒ½å¹¶å‡å°‘å†…å­˜ä½¿ç”¨ã€‚

# æç¤º 5ï¼šä½¿ç”¨åŒæ˜Ÿå·è¯­æ³•**åˆå¹¶å­—å…¸

å¦‚ä½•åˆå¹¶å­—å…¸ï¼Ÿä½ å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ¥å®ç°ã€‚æˆ‘ä»¬ä½¿ç”¨äº†æ˜Ÿå·è¯­æ³•**ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

```py
dict_1 = {'company': 'Tesla', 'founding': 2002}
dict_2 = {'company': 'Tesla', 'founding': 2003, 'CEO': 'Elon Musk'}

dict_merged = {**dict_1, **dict_2}
print(dict_merged)
# {'company': 'Tesla', 'Founding': 2003, 'CEO': 'Elon Musk'}
```

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªå­—å…¸ï¼Œå®ƒä»¬æœ‰ç›¸åŒå’Œä¸åŒçš„é”®å€¼å¯¹ã€‚ç‰¹æ–¯æ‹‰æˆç«‹äº 2003 å¹´ï¼Œæ‰€ä»¥ dict_2 æ›´åŠ æœ€æ–°ã€‚å¦‚æœä¸¤ä¸ªå­—å…¸åŒ…å«ç›¸åŒçš„é”®ä½†å€¼ä¸åŒï¼Œåˆ™ä½¿ç”¨æœ€åä¸€ä¸ªå­—å…¸çš„å€¼ã€‚åˆå¹¶åï¼Œæ–°å­—å…¸åŒ…å«æ‰€æœ‰ä¸‰ä¸ªé”®å€¼å¯¹ã€‚è¯­æ³•ç®€æ´ç´§å‡‘ï¼Œå› æ­¤åˆå¹¶éå¸¸ç®€å•ã€‚è€Œä¸”æœ€æ£’çš„æ˜¯ï¼Œä½ å¯ä»¥åˆå¹¶ä¸‰ä¸ªæˆ–æ›´å¤šå­—å…¸ã€‚è¿™ä¸ªæŠ€å·§å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚

å¦ä¸€ç§æ–¹æ³•æ˜¯ update æ–¹æ³•ã€‚æ­¤æ–¹æ³•æ›´æ–°ç¬¬ä¸€ä¸ªå­—å…¸ï¼Œå¹¶ä¸åˆ›å»ºå‰¯æœ¬ã€‚çœ‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚

```py
dict_1 = {'company': 'Tesla', 'founding': 2002}
dict_2 = {'company': 'Tesla', 'founding': 2003, 'CEO': 'Elon Musk'}

dict_1.update(dict_2)
print(dict_1)
# {'company': 'Tesla', 'Founding': 2003, 'CEO': 'Elon Musk'}
```

update æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ä½ åªèƒ½ä½¿ç”¨ä¸€ä¸ªå­—å…¸è¿›è¡Œæ›´æ–°ã€‚å¦‚æœä½ æœªæ¥æƒ³è¦åˆå¹¶å­—å…¸ï¼Œè¯·è®°ä½è¿™ä¸ªæç¤ºã€‚

# æç¤º 6ï¼šä¸è¦å¯¼å…¥ä¸å¿…è¦çš„æ¨¡å—

ä½ å¯èƒ½å¬åˆ°è¿‡è¿™ä¸ªæç¤ºå¾ˆå¤šæ¬¡ï¼Œä½†å®ƒå¯ä»¥æ˜¾è‘—æé«˜ä»£ç çš„æ€§èƒ½ã€‚æ²¡æœ‰å¿…è¦å¯¼å…¥æ•´ä¸ªåº“ã€‚ä½ é€šå¸¸åªéœ€è¦å…¶ä¸­çš„æŸäº›å‡½æ•°ã€‚æ­¤å¤–ï¼Œç”±äºå¿…é¡»å…ˆå¯¼å…¥æ•´ä¸ªåº“ï¼Œæ‰€ä»¥ä½ çš„ä»£ç å¯åŠ¨æ—¶é—´è¾ƒé•¿ã€‚è¿™ä¸åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¿…é¡»é€šè¿‡ç‚¹è¡¨ç¤ºæ³•è®¿é—®å•ç‹¬çš„å‡½æ•°ã€‚è¿™éå¸¸ä½æ•ˆï¼Œä½ åº”è¯¥é¿å…ä½¿ç”¨ç‚¹è¡¨ç¤ºæ³•ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ã€‚

```py
import math
from time import perf_counter

start = perf_counter()
variable = math.exp(7)
print(perf_counter()-start)
# 8.47-05 s
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `math.exp()` å‡½æ•°å’Œç‚¹è¡¨ç¤ºæ³•ã€‚è¿™å¯¼è‡´äº†ä»£ç æ€§èƒ½ä¸ä½³ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯¼å…¥äº†æ•´ä¸ª math åº“ï¼Œå°½ç®¡æˆ‘ä»¬åªéœ€è¦ `exp()` å‡½æ•°ã€‚

```py
from math import exp
from time import perf_counter

start = perf_counter()
variable = exp(7)
print(perf_counter()-start)
# 4.51-05 s
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨æ²¡æœ‰ç‚¹è¡¨ç¤ºæ³•çš„æƒ…å†µä¸‹å¯¼å…¥äº† `exp()` å‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªæŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç çš„è¿è¡Œæ—¶é—´å‡åŠã€‚å“‡ï¼Œå¤ªæ£’äº†ï¼

# æç¤º 7ï¼šä½¿ç”¨å³æ—¶ç¼–è¯‘å™¨

[Numba](https://numba.readthedocs.io/en/stable/index.html) æ˜¯ä¸€ä¸ªå³æ—¶ (jit) ç¼–è¯‘å™¨ï¼Œèƒ½å¤Ÿå¾ˆå¥½åœ°ä¸ NumPy å¾ªç¯ã€æ•°ç»„å’Œå‡½æ•°é…åˆä½¿ç”¨ã€‚è£…é¥°å™¨ç”¨äºæŒ‡ç¤º Numba ç”¨ Numba ç¼–è¯‘ç‰¹å®šå‡½æ•°ã€‚Numba å°†è£…é¥°è¿‡çš„å‡½æ•°å³æ—¶ç¼–è¯‘ä¸ºæœºå™¨ä»£ç ï¼Œä»¥ä¾¿æ‰€æœ‰æˆ–éƒ¨åˆ†ä»£ç ä»¥æœ¬åœ°æœºå™¨ä»£ç çš„é€Ÿåº¦è¿è¡Œã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ pip å®‰è£… Numbaã€‚

```py
pip install numba
```

å®‰è£…æˆåŠŸåï¼Œä½ å¯ä»¥ä½¿ç”¨ Numbaã€‚è¯·æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼š

```py
import numpy as np
from numba import jit
import timeit

var = np.random.random(10**7)
num_loop = 10000

def foo(var):
    result = 0
    for i in range(num_loop):
        result += 1
    result = np.sin(var) + np.cos(var)
    return result               
%timeit foo(var)
# 154 ms

@jit(nopython=True)
def foo_numba(var):
    result = 0
    for i in range(num_loop):
        result += 1
    result = np.sin(var) + np.cos(var)
    return result    

%timeit foo_numba(var)
# 76.3 ms
```

ä½ å¯ä»¥çœ‹åˆ°ï¼Œä¸Šè¿° foo å‡½æ•°çš„è£…é¥°å™¨åŠ å¿«äº†ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ã€‚è£…é¥°å™¨ *nopython=True* è¡¨æ˜ç¼–è¯‘å°†ä¸æ¶‰åŠ Python è§£é‡Šå™¨ã€‚Numba åŠ é€Ÿäº†å¾ªç¯å’Œ NumPy ä¸‰è§’å‡½æ•°çš„æ‰§è¡Œã€‚ç„¶è€Œï¼Œå®ƒä¸èƒ½ä¸æ‰€æœ‰ Python å‡½æ•°ä¸€èµ·ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯ [Numba](https://numba.readthedocs.io/en/stable/user/5minguide.html) çš„ä¼˜ç¼ºç‚¹ï¼š

***ç¼ºç‚¹ï¼š***

+   Numba ä¸æ”¯æŒ pandasã€‚

+   ä¸æ”¯æŒçš„ä»£ç é€šè¿‡è§£é‡Šå™¨æ‰§è¡Œï¼Œå¹¶ä¸”æœ‰é¢å¤–çš„ Numba å¼€é”€ã€‚

+   ä»…å¯¹ M1/Arm64 æä¾›éå®˜æ–¹æ”¯æŒã€‚

***ä¼˜ç‚¹ï¼š***

+   å¯¹ NumPy æ•°ç»„å’Œå‡½æ•°ä»¥åŠå¾ªç¯çš„æ”¯æŒéå¸¸å¥½ã€‚

+   æ”¯æŒ Nvidia CUDAã€‚å®ƒå¯ä»¥å¾ˆå¥½åœ°ç”¨äºåŸºäº NumPy çš„ç¥ç»ç½‘ç»œå¼€å‘ã€‚

ç¼ºç‚¹å’Œä¼˜ç‚¹è¡¨æ˜ Numba åº”ä¸»è¦ç”¨äº NumPy æ“ä½œã€‚æ­¤å¤–ï¼Œä½ åº”è¯¥æ€»æ˜¯åœ¨å¼€å§‹æ—¶æ£€æŸ¥ Numba æ˜¯å¦é€‚åˆç›¸åº”çš„å®ç°ã€‚

# ç»“è®º

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æé«˜ä»£ç çš„è¿è¡Œæ—¶é—´å’Œå†…å­˜æ•ˆç‡ã€‚å­¦åˆ°çš„æ•™è®­ï¼š

+   NumPy ä¸æ”¯æŒå¹¶è¡Œå¤„ç†ã€‚ä½ å¯ä»¥ä½¿ç”¨ NumExpr æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚

+   Pandas çš„ `apply()` å‡½æ•°å¯ä»¥é€šè¿‡ swifter åŠ é€Ÿã€‚

+   æ£€æŸ¥æ˜¯å¦æœ‰å†…ç½®å‡½æ•°ã€‚

+   ä½¿ç”¨åˆ—è¡¨æ¨å¯¼è€Œä¸æ˜¯å¾ªç¯ã€‚æ£€æŸ¥ç”Ÿæˆå™¨æ˜¯å¦é€‚åˆä½ çš„é¡¹ç›®ã€‚

+   ä½¿ç”¨åŒæ˜Ÿå·è¯­æ³•åˆå¹¶å­—å…¸**ã€‚

+   ä¸è¦å¯¼å…¥ä¸å¿…è¦çš„æ¨¡å—ã€‚

+   å¦‚æœä½ é‡åˆ°è¿è¡Œæ—¶é—´é—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨å³æ—¶ç¼–è¯‘å™¨ã€‚å³æ—¶ç¼–è¯‘å™¨å¯ä»¥åŠ é€Ÿä½ çš„ä»£ç ã€‚

ğŸ‘‰ğŸ½ [**æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„æ•°å­—äº§å“é¡µé¢ä¸Šæ‰¾åˆ°æ‰€æœ‰å…è´¹çš„èµ„æºï¼**](https://shop.tinztwins.de/)

ğŸ‘‰ğŸ½ [**åŠ å…¥æˆ‘ä»¬çš„æ¯å‘¨å…è´¹ Magic AI é€šè®¯ï¼Œè·å–æœ€æ–°çš„ AI æ›´æ–°ï¼**](https://magicai.tinztwins.de)

[**å…è´¹è®¢é˜…**](https://tinztwinspro.medium.com/subscribe) **ä»¥ä¾¿åœ¨æˆ‘ä»¬å‘å¸ƒæ–°æ•…äº‹æ—¶æ”¶åˆ°é€šçŸ¥ï¼š**

[](https://tinztwinspro.medium.com/subscribe?source=post_page-----e680f4c56f37--------------------------------) [## æ¯å½“ Janik å’Œ Patrick Tinz å‘å¸ƒæ–°å†…å®¹æ—¶ï¼Œæ‚¨å°†æ”¶åˆ°ç”µå­é‚®ä»¶ã€‚

### æ¯å½“ Janik å’Œ Patrick Tinz å‘å¸ƒæ–°å†…å®¹æ—¶ï¼Œæ‚¨å°†æ”¶åˆ°ç”µå­é‚®ä»¶ã€‚é€šè¿‡æ³¨å†Œï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ª Medium è´¦æˆ·ï¼Œå¦‚æœæ‚¨è¿˜æ²¡æœ‰çš„è¯â€¦

[tinztwinspro.medium.com](https://tinztwinspro.medium.com/subscribe?source=post_page-----e680f4c56f37--------------------------------)

åœ¨æˆ‘ä»¬çš„[å…³äºé¡µé¢](https://medium.com/@tinztwinspro/about)äº†è§£æ›´å¤šå…³äºæˆ‘ä»¬çš„ä¿¡æ¯ã€‚ä¸è¦å¿˜è®°åœ¨[X](https://twitter.com/tinztwins)ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚éå¸¸æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·éšæ„åˆ†äº«ã€‚**ç¥æ‚¨ä¸€å¤©æ„‰å¿«ï¼**

ä½¿ç”¨[æˆ‘ä»¬çš„é“¾æ¥](https://tinztwinspro.medium.com/membership)æ³¨å†Œ Medium ä¼šå‘˜ï¼Œé˜…è¯»æ— é™åˆ¶çš„ Medium æ•…äº‹ã€‚

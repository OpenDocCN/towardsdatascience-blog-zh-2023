# 如何理解因果关系的世界

> 原文：[https://towardsdatascience.com/how-to-understand-the-world-of-causality-c698cdc9f27c?source=collection_archive---------3-----------------------#2023-02-18](https://towardsdatascience.com/how-to-understand-the-world-of-causality-c698cdc9f27c?source=collection_archive---------3-----------------------#2023-02-18)

## 因果关系是一个广泛而复杂的领域。这里有一张地图帮助你理解它。

[](https://medium.com/@farrandtom?source=post_page-----c698cdc9f27c--------------------------------)[![Tom Farrand](../Images/008382bf673e96ea76d99c247ec6d46c.png)](https://medium.com/@farrandtom?source=post_page-----c698cdc9f27c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c698cdc9f27c--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c698cdc9f27c--------------------------------) [Tom Farrand](https://medium.com/@farrandtom?source=post_page-----c698cdc9f27c--------------------------------)

·

[关注](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe045add8ea1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-understand-the-world-of-causality-c698cdc9f27c&user=Tom+Farrand&userId=e045add8ea1a&source=post_page-e045add8ea1a----c698cdc9f27c---------------------post_header-----------) 发表在 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----c698cdc9f27c--------------------------------) · 11分钟阅读·2023年2月18日[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc698cdc9f27c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-understand-the-world-of-causality-c698cdc9f27c&user=Tom+Farrand&userId=e045add8ea1a&source=-----c698cdc9f27c---------------------clap_footer-----------)

--

[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc698cdc9f27c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-understand-the-world-of-causality-c698cdc9f27c&source=-----c698cdc9f27c---------------------bookmark_footer-----------)![](../Images/c22a3ad30bc352931d4148e4229fb479.png)

因果关系地图。图片由作者创作。

因果关系的世界大致分为两个主要领域：

+   **因果推断的主要领域：** 因果推断关注的是理解你所采取行动的效果。因果推断提供了工具，使你能够隔离并计算系统内变更的效果——即使该变更在实践中从未发生。因果推断可以用来回答以下问题：*我因为服用了某种药物而变得更好吗？我需要增加多少广告支出才能实现我的收入目标？课堂规模对教育成就的影响是什么？*

+   **因果发现岛**：因果发现方法利用数据确定其中的因果关系。关键是，因果发现揭示的关系不仅仅是统计相关性。因果关系对变化是不变的，代表了理解系统的更基本基础。

# 实验山脉 ⛰️

探索因果关系的最明显起点是实验山脉。这些山脉在景观中高耸入云，理由很充分。这些方法包括用于理解因果效应的金标准方法，具有最大的确定性。

理解这些方法有效性的关键在于掌握随机分配的意义。通过干预世界，实验随机分配那些接受某种处理和那些不接受处理的人——即对照组。处理可以是药物剂量、施加在作物上的肥料量、晨间例程等任何事物。

由于处理是随机化的，如果你从人群中选择一个足够大的样本，那么从统计学上讲，你的处理组和对照组之间唯一的差异就是处理本身。你已经成功排除了所有其他通常会偏倚结果的因素。这些对你的处理和结果有因果关系的外部因素被称为混杂因素。你在这篇文章中阅读的所有因果推断技术的目标都是消除混杂因素。因此，处理组和对照组之间的任何差异都必须是由于处理——从而使你能够计算处理效果。

以你是一个农民并希望了解使用一种新型肥料对作物的效果为例。与其盲目地将肥料施加到整个田地上，你可以将田地划分为若干个方块。对于每一个方块，你掷硬币，根据结果决定是否施加肥料。通过这样做，你已经随机化了是否施肥，从而排除了可能偏倚你选择的因素。此外，由于你在同一片田地内操作，天气等混杂因素也得到控制，不会影响结果。然后你可以简单地比较施肥方块和未施肥方块的作物产量，从而得到处理效果。

![](../Images/3a8f64335fef7ae0c90d295d4fed3d15.png)

随机化实验如何计算处理效果的示例。图片由作者创建。

# 自然实验之城 🌆

在许多情况下，进行现实世界的实验实际上是不可行的。实验可能是非伦理的、费用过高、在后勤上不可能，或是这些因素的组合。那么，如果你面临一个无法进行实验的情况，你该怎么办？

各领域的科学家们几代人都面临这些情况。经济学家无法将受控实验扩展到国家的规模。生物学家无法干预分配可能有害的治疗。因此，这些科学家们发展了一系列技术来识别自然随机化，使他们能够去除偏差并识别处理效果，而无需直接干预自己。这些技术填充了自然实验的城市。

城市中的所有技术行为类似，利用自然随机化来计算处理效果，但要更深入理解它，现在是时候专注于一种：工具变量。这些变量不会导致或与结果相关，也不会与其他混杂因素相关，但它们对处理有直接的因果影响。在图形形式中，工具变量看起来与前一部分农民掷硬币的情况相同。

**让我们回到农业例子。** 农民选择的作物是玉米，他们希望了解改变价格会对销售量产生多大影响。农民知道有多种因素影响玉米销售：运输成本、当年的总体产量、消费者趋势等。然而，我们的农民知道在降雨较少的年份，产量较低，而产量较低时，农民会提高价格。

现在为了使天气成为一个好的工具变量，我们的农民假设：

+   天气和玉米销售不会被另一个因素混杂；即导致它们两个的因素。

+   天气对玉米销售没有影响。

如果这些假设是正确的，并且农民对玉米市场的领域知识也认为天气引入的随机化以及足够大的数据集，会让农民计算价格对玉米销售的影响——所有这些都不需要进行真实世界的实验！

# 因果图桥梁 🌉

因果推断可以看作是一个两阶段过程：识别和估计。识别是确定你需要控制的变量集合，即保持不变，以隔离感兴趣的因果效应的过程。估计则是应用统计技术到你的数据中以计算效果。因果图是执行识别的事实工具。

因果图可视化你希望探究的数据中的因果关系。在前面的部分，你已经看到了一个因果图，考虑了肥料对农作物产量的影响。

因果图是有向无环图（DAGs），这意味着它们将变量表示为节点，节点之间的有向边显示了一个变量对另一个变量的因果影响。边还表示变量之间的双向相关性，而因果关系仅是单向的，相关性或统计关联是双向的。因此，相关性可以表明因果关系，但不能作为证据。

![](../Images/4c85515290ace03b6a062cf8651de8b9.png)

如何理解因果图。图像由作者创作。

理解因果图的一种方式是将其视为对数据生成方式的估计。因果关系描述了单独的一个特征或与其他特征组合，如何导致另一个特征——最终形成你希望研究的特征。

在之前的章节中，你学习了如何通过随机化来消除混杂变量的偏倚效应。因果图允许你在不进行随机化的情况下实现相同的目标。这意味着你不一定需要进行实验或识别自然的随机源来解开数据中的因果关系。

# 因果发现岛 🏝️

因果发现是将算法和领域知识相结合，以找到适当的因果图的过程。

然而，因果发现的岛屿是一个难以生存的地方。你正试图估计一个表示数据生成过程的因果图，而这个过程你在现实中永远无法完全观察到——没有绝对的真相。因此，对于大多数现实世界的数据，因果图是数据生成过程的最佳估计，不能被验证为对现象的真实表征。

这并不意味着从因果发现中恢复的因果图，以及支撑大多数因果推断的图，毫无用处。恰恰相反——这些图为纯统计方法的机器学习提供了强大的进展，使你更进一步地理解你感兴趣的系统的机制。

你可以应用许多不同的算法来分析收集的数据，以揭示因果关系。最常见的两种因果发现算法类别是：

+   **基于约束的：**通过执行条件独立性测试，在测试中控制数据集中的不同变量，并测量这样做对其他变量的影响，算法可以识别出某些因果模式。在整个数据集中迭代地应用条件独立性测试，然后可以建立出更完整的潜在因果图。

+   **基于评分：** 这类算法提出了一系列不同的因果结构，然后根据它们与基础数据的适配程度来分配一个评分。该算法从基本结构开始，然后通过重复评分的回合，建立最适合的结构，从而形成一个包含可用变量的因果结构。

应用算法到你的数据时的难点在于，它们永远无法获取一个完全解决的因果图。输出总会有一些没有明确因果方向的边，这时人类领域知识显得尤为重要。领域专业知识在创建可用的因果图中至关重要，因此对于获得准确的因果发现结果至关重要。

因果发现的最终难题是存在未观察到的混淆变量。这些变量混淆了你的兴趣变量，但在你的数据集中不存在。由于没有观察到这些混淆变量，许多因果推断方法无法有效工作。因果发现方法和人类领域专业知识在这里非常强大，因为它们可以帮助标记未观察到的混淆变量可能影响数据生成过程的地方。

# 匹配森林 🌲

匹配森林是因果图桥梁的落脚点。因果图使你能够轻松了解在尝试估计因果效应时需要控制哪些变量。匹配森林中的技术为你提供了从图形世界到数据应用的工具。匹配技术在文献中被广泛理解和使用——这就像一片茂密的绿色森林。

匹配是通过构建根据一组匹配变量相似的比较组，来去除处理与结果之间的混淆效应的过程。这些匹配变量通常通过你的因果图来确定。

这里的直觉是你正在构建一个具有与处理组相似属性的对照组。因此，两个组之间的任何结果变异都必须归因于处理，从而得到因果效应的估计。

最简单的匹配工具是子分类。

![](../Images/24d2a3f88bc2017a8a85f3d9c69323ba.png)

使用胆固醇与运动在年龄的混淆下的子分类示例。与Judea Pearl的《为何之书》中使用的示例相同。图像由作者创建。

当你将治疗（运动）与结果（胆固醇）数据进行绘图时，你会注意到一个下降的趋势，如上图的左侧。然而，通过按混杂变量（年龄）对数据进行分组，从而创建子类，你可以观察到治疗与结果之间的真实关系——见右侧。子分类直观易懂，但随着需要控制的变量数量增加，所需的数据量急剧增加。这限制了子分类的适用性，导致了其他方法的出现，这些方法充实了匹配森林。

# 建模沼泽 🍃

建模沼泽是事情开始变得有些模糊的地方。建模沼泽是一些最熟悉的因果推断工具的家园，相比之下，新兴工具则较少被建立。模型提供了强大的因果效应估计方法，虽然有些依赖于完全指定的因果图，但其他模型在没有该要求的情况下也能有效运行。

建模沼泽中最受欢迎的方法是普通回归。普通最小二乘（OLS）回归是一个极其灵活且有价值的因果效应估计工具。它之所以受欢迎也有充分的理由：

+   **理论上已被很好理解：** OLS 和其他类型的回归方法从统计学角度非常清楚。这意味着应用回归到你的挑战中的假设是明确的，允许你对结果做出明智的选择。

+   **可解释性强：** 回归模型易于解释，不像现代机器学习技术。这使得它们在高风险情况下，如涉及监管时，表现优异。

+   **因果推断很简单：** 控制混杂变量并使用回归估计因果效应是直接的。回归方程中的学习系数是给定变量的因果效应的估计，同时控制其他变量——请参见下面的图示。

![](../Images/fee25488eb0ed4d902dcc984119efa20.png)

普通最小二乘回归的参数描述了每个变量如何随结果的变化而变化，同时控制其他变量。图像由作者创建。

这里值得更详细了解的第二种方法是结构因果模型（SCM）。SCM 直接基于因果图的基础，并学习由领域专业知识或算法因果发现确定的因果关系的数学形式。

这意味着你因果图中的边缘和节点现在有了从数据中学到的数学关系。这是非常强大的，因为它使你能够通过干预模型来轻松创建“如果……会怎样”的情境。干预只是意味着改变图中一个节点的值。然后，SCM 描述了这种变化如何传递到其他变量，最终影响处理结果。结果是，通过一个具有代表性的 SCM，你可以开始探索各种不同的情境，并比较不同动作的影响。

![](../Images/735063ae2c3fd032bd0012a80473c63f.png)

结构性因果模型学习到的边函数的一个例子。图片由作者创建。

# 决策智能沙漠 🐪

决策智能沙漠是荒凉而偏远的，但也有绿洲。这一地图区域包含了超越处理效果估计的各种新兴技术。为了说明沙漠中包含的方法类型，我们来考虑一下[算法性救济](https://arxiv.org/abs/2002.06278)。

在机器学习中，一种常见的解释性技术是反事实解释。反事实解释提出了一个问题：为了让结果有所不同，需要改变什么？

例如，设想一个保留预测机器学习模型，它预测一个客户将会流失。一个反事实解释来帮助解释为什么这个人可能会流失可能是：如果他们是65岁或以上的高级客户，他们会续订。

算法性救济从反事实解释的概念出发，但重点在于提供你行动的能力，而不仅仅是理解。因此，算法性救济提供了推荐行动以改变不利结果的能力，使你能够干预系统以防止这些结果。

这最终将上述的流失示例从不可操作的解释，转变为可操作的建议。应用救济以防止此人流失：如果他们获得10%的折扣，他们会续订。由于折扣是可以采取行动的，这使你能够在现实世界中产生变化。

# 结论 🏁

你已经对一个深奥而迷人的主题进行了 whirlwind 之旅。我希望你喜欢对因果关系的探索，并感到有动力去学习更多。

如果你希望更深入地了解，我强烈推荐以下书籍和资源作为起点：

1.  [Brady Neal 的因果推断课程（Youtube）](https://www.youtube.com/@BradyNealCausalInference)：这是一个很好的入门视频系列，可以让你了解本文讨论的许多主题。

1.  [效果](https://www.theeffectbook.net/introduction.html)，或 [因果推断混音带](https://mixtape.scunning.com/)：这些书更侧重于因果推断的传统技术。这些书将为你提供一个强大的基础，帮助你继续前行。两本书的作者都很慷慨地免费提供，但如果你能负担得起，我总是建议你获取纸质版！

1.  [勇敢且真实的因果推断](https://matheusfacure.github.io/python-causality-handbook/landing-page.html)：这是一本非常有趣的书，探讨了因果推断和机器学习如何碰撞。书中包含了很好的实践代码示例，让你可以实际学习！

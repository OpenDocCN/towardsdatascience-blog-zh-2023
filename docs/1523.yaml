- en: How To Change Google Sheet Permissions with Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/google-sheet-permissions-python-fee1ff80363?source=collection_archive---------5-----------------------#2023-05-04](https://towardsdatascience.com/google-sheet-permissions-python-fee1ff80363?source=collection_archive---------5-----------------------#2023-05-04)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Programmatically sharing Google Sheets with specific users using the Python
    API
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://gmyrianthous.medium.com/?source=post_page-----fee1ff80363--------------------------------)[![Giorgos
    Myrianthous](../Images/ff4b116e4fb9a095ce45eb064fde5af3.png)](https://gmyrianthous.medium.com/?source=post_page-----fee1ff80363--------------------------------)[](https://towardsdatascience.com/?source=post_page-----fee1ff80363--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----fee1ff80363--------------------------------)
    [Giorgos Myrianthous](https://gmyrianthous.medium.com/?source=post_page-----fee1ff80363--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76c21e75463a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-permissions-python-fee1ff80363&user=Giorgos+Myrianthous&userId=76c21e75463a&source=post_page-76c21e75463a----fee1ff80363---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----fee1ff80363--------------------------------)
    ·5 min read·May 4, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffee1ff80363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-permissions-python-fee1ff80363&user=Giorgos+Myrianthous&userId=76c21e75463a&source=-----fee1ff80363---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffee1ff80363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-permissions-python-fee1ff80363&source=-----fee1ff80363---------------------bookmark_footer-----------)![](../Images/08ae206774c5ada897f91d3d70b78ba0.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Artur Tumasjan](https://unsplash.com/es/@arturtumasjan?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/zM8sSfYFDww?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Sharing a Google Sheet with others is an easy and straightforward task that
    can be done through the user interface. However, what if you need to share multiple
    Google Sheets with a specific user or service account?
  prefs: []
  type: TYPE_NORMAL
- en: Imagine you have created hundreds of external tables on BigQuery that consume
    data from various Google Sheets. If another service, like Apache Airflow, executes
    queries referencing those tables, you need to ensure that the Airflow’s service
    account has sufficient permissions on all those Sheets. But manually sharing (i.e.
    granting `Viewer` or `Editor` permissions) hundreds of Sheets with a specific
    principal is almost impossible, and would take several hours.
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, we will demonstrate how to use Python and the Google Drive
    API to change permissions for hundreds of Google Sheets at once
  prefs: []
  type: TYPE_NORMAL
- en: Prerequisites
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The first thing we need to do, is to make sure that we have successfully obtained
    user access credentials, with the required scopes. To do, simply run the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE

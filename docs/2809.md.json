["```py\nCREATE TABLE PlayerMatch (\nplayer_match_id serial PRIMARY KEY,\nplayer_id INT NOT NULL REFERENCES Player(player_id),\nmatch_id INT NOT NULL REFERENCES Match(match_id)\n);\n```", "```py\nCREATE SEQUENCE player_id_seq START 1;\nCREATE SEQUENCE team_id_seq START 1;\nCREATE SEQUENCE match_id_seq START 1;\nCREATE SEQUENCE player_match_id_seq START 1;\nCREATE SEQUENCE player_rating_id_seq START 1;\nCREATE SEQUENCE team_match_id_seq START 1;\nCREATE SEQUENCE team_rating_id_seq START 1;\n```", "```py\ndef get_latest_player_ratings(month=None, year=None):\n    now = datetime.now()\n    default_month = now.month\n    default_year = now.year\n    selected_year = int(year) if year else default_year\n    selected_month = int(month) if month else default_month\n    start_date = f'{selected_year}-{selected_month:02d}-01 00:00:00'\n    end_date = f'{selected_year}-{selected_month:02d}-{get_last_day_of_month(selected_month, selected_year):02d} 23:59:59'\n\n    query = '''\n        WITH max_player_rating_timestamp AS (\n            SELECT \n                pm.player_id,\n                MAX(pr.player_rating_timestamp) as max_timestamp\n            FROM PlayerMatch pm\n            JOIN PlayerRating pr ON pm.player_match_id = pr.player_match_id\n            WHERE pr.player_rating_timestamp BETWEEN %s AND %s\n            GROUP BY pm.player_id\n        ),\n        filtered_player_match AS (\n            SELECT \n                pm.player_id,\n                pm.match_id\n            FROM PlayerMatch pm\n            JOIN max_player_rating_timestamp mprt ON pm.player_id = mprt.player_id\n        ),\n        filtered_matches AS (\n            SELECT match_id\n            FROM Match\n            WHERE match_timestamp BETWEEN %s AND %s\n        )\n        SELECT \n            CONCAT(p.first_name, '.', SUBSTRING(p.last_name FROM 1 FOR 1)) as player_name, \n            pr.rating, \n            COUNT(DISTINCT fpm.match_id) as num_matches,\n            pr.player_rating_timestamp\n        FROM Player p\n        JOIN max_player_rating_timestamp mprt ON p.player_id = mprt.player_id\n        JOIN PlayerMatch pm ON p.player_id = pm.player_id\n        JOIN PlayerRating pr ON pm.player_match_id = pr.player_match_id\n            AND pr.player_rating_timestamp = mprt.max_timestamp\n        JOIN filtered_player_match fpm ON p.player_id = fpm.player_id\n        JOIN filtered_matches fm ON fpm.match_id = fm.match_id\n        GROUP BY p.player_id, pr.rating, pr.player_rating_timestamp\n        ORDER BY pr.rating DESC;\n    '''\n```", "```py\nSELECT DISTINCT ON (DATE_TRUNC('day', m.match_timestamp))\n    DATE_TRUNC('day', m.match_timestamp) AS day_start,\n    CASE WHEN p.first_name = '{player}' THEN pr.rating ELSE NULL END AS rating\nFROM PlayerMatch pm\nJOIN Player p ON pm.player_id = p.player_id\nJOIN PlayerRating pr ON pm.player_match_id = pr.player_match_id\nJOIN Match m ON pm.match_id = m.match_id\nWHERE p.first_name = '{player}'\nORDER BY DATE_TRUNC('day', m.match_timestamp) DESC, m.match_timestamp DESC\n```"]
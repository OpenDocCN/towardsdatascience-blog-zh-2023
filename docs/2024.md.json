["```py\ninsert into `recommendersystem.product_data` \n\n(\n  name,id,type,primaryProductId,collectionMemberIds,gtin,categories,title,brands,description,languageCode,attributes,  tags,    \n  priceInfo,rating,expireTime,ttl,availableTime,availability,availableQuantity,fulfillmentInfo, uri, images,audience,colorInfo,sizes,materials,patterns,conditions,retrievableFields,publishTime,promotions\n)\n\nSELECT \n   name,\n   cast(id as string) as id,\n   \"PRIMARY\" as type, \n   cast(id as string) as primaryProductId,\n    null as collectionMemberIds,\n    null as gtin,\n   array [categories] as categories,\n   name as title,\n   array[title] as brands,\n   ifnull(description,name) as description,\n    null as languageCode,\n   [\n      struct(\n      'product_location' as key,  STRUCT(array[ifnull(city,\"empty\")] as text,  cast(null as ARRAY<FLOAT64>) as numbers, true as searchable, true as indexable ) as value\n      )]\n   as attributes,\n   ARRAY_CONCAT(\n      [ifnull(location,\"empty\")],\n      [ifnull(categories,\"empty\")]      \n    ) as tags,\n    null as  priceInfo,\n    null as  rating,\n    null as  expireTime,\n    null as  ttl,\n    null as  availableTime,\n    null as  availability,\n    null as  availableQuantity,\n    null as  fulfillmentInfo,\n   url,\n   array[struct(image_url) as uri, null as height, null as width)] as images,\n   null as audience,\n   null as colorInfo,\n   null as sizes,\n   null as materials,\n   null as patterns,\n   null as conditions,\n   null as retrievableFields,\n   null as publishTime,\n   null as promotions\nFROM `product.product_details`\n```", "```py\n[\n    {\n        \"name\": \"eventType\",\n        \"type\": \"STRING\",\n        \"mode\": \"REQUIRED\"\n    },\n    {\n        \"name\": \"visitorId\",\n        \"type\": \"STRING\",\n        \"mode\": \"REQUIRED\"\n    },\n    {\n        \"name\": \"eventTime\",\n        \"type\": \"STRING\",\n        \"mode\": \"REQUIRED\"\n    },\n {\n   \"name\": \"productDetails\",\n   \"type\": \"RECORD\",\n   \"mode\": \"REPEATED\",\n   \"fields\": [\n     {\n       \"name\": \"product\",\n       \"type\": \"RECORD\",\n       \"mode\": \"REQUIRED\",\n       \"fields\": [\n         {\n           \"name\": \"id\",\n           \"type\": \"STRING\",\n           \"mode\": \"REQUIRED\"\n         }\n       ]\n     },\n     {\n       \"name\": \"quantity\",\n       \"type\": \"INTEGER\",\n       \"mode\": \"REQUIRED\"\n     }\n   ]\n },\n    {\n        \"name\": \"attributes\",\n        \"type\": \"RECORD\",\n        \"mode\": \"NULLABLE\",\n        \"fields\": [\n            {\n                \"name\": \"deviceType\",\n                \"type\": \"RECORD\",\n                \"mode\": \"NULLABLE\",\n                \"fields\": [\n                    {\n                        \"name\": \"text\",\n                        \"type\": \"STRING\",\n                        \"mode\": \"REPEATED\"\n                    }\n                ]\n            }\n        ]\n    }\n]\n```", "```py\n[\n {\n   \"name\": \"eventType\",\n   \"type\": \"STRING\",\n   \"mode\": \"REQUIRED\"\n },\n {\n   \"name\": \"visitorId\",\n   \"type\": \"STRING\",\n   \"mode\": \"REQUIRED\"\n },\n {\n   \"name\": \"eventTime\",\n   \"type\": \"STRING\",\n   \"mode\": \"REQUIRED\"\n },\n {\n   \"name\": \"productDetails\",\n   \"type\": \"RECORD\",\n   \"mode\": \"REPEATED\",\n   \"fields\": [\n     {\n       \"name\": \"product\",\n       \"type\": \"RECORD\",\n       \"mode\": \"REQUIRED\",\n       \"fields\": [\n         {\n           \"name\": \"id\",\n           \"type\": \"STRING\",\n           \"mode\": \"REQUIRED\"\n         }\n       ]\n     },\n     {\n       \"name\": \"quantity\",\n       \"type\": \"INTEGER\",\n       \"mode\": \"REQUIRED\"\n     }\n   ]\n },\n {\n   \"name\": \"purchaseTransaction\",\n   \"type\": \"RECORD\",\n   \"mode\": \"REQUIRED\",\n   \"fields\": [\n     {\n       \"name\": \"revenue\",\n       \"type\": \"FLOAT\",\n       \"mode\": \"REQUIRED\"\n     },\n     {\n       \"name\": \"currencyCode\",\n       \"type\": \"STRING\",\n       \"mode\": \"REQUIRED\"\n     }\n   ]\n },\n {\n    \"name\": \"attributes\",\n    \"type\": \"RECORD\",\n    \"mode\": \"NULLABLE\",\n    \"fields\": [\n        {\n            \"name\": \"deviceType\",\n            \"type\": \"RECORD\",\n            \"mode\": \"NULLABLE\",\n            \"fields\": [\n                {\n                    \"name\": \"text\",\n                    \"type\": \"STRING\",\n                    \"mode\": \"REPEATED\"\n                }\n            ]\n        },\n        {\n            \"name\": \"cityName\",\n            \"type\": \"RECORD\",\n            \"mode\": \"NULLABLE\",\n            \"fields\": [\n                {\n                    \"name\": \"text\",\n                    \"type\": \"STRING\",\n                    \"mode\": \"REPEATED\"\n                }\n            ]\n        }\n    ]\n}\n\n]\n```", "```py\ninsert into `recommendersystem.user_event_home_page_view` (eventType, visitorId,eventTime,attributes)\n  SELECT \n  'home-page-view' as eventType,\n  visitorId,\n  eventTime,\n  struct(\n      struct([deviceType] as text)as deviceType,\n      struct([city] as text)as cityName \n  )\n    as attributes,\n  from (\n    select *, \n deviceType from  `recommendersystem.user_event_history` \n```", "```py\ninsert into `recommendersystem.user_event_add_to_cart` (eventType, visitorId,eventTime,productDetails,attributes)\nSELECT \n'add-to-cart' as eventType,\nvisitorId,\neventTime,\n[\n    struct( struct(product_id  as id) as product , 1 as quantity) \n] as productDetails,\n struct(\n     struct([deviceType] as text)as deviceType,\n     struct([city] as text)as cityName \n\n )\n   as attributes,\nfrom (\n  select *, \n deviceType from  `recommendersystem.user_event_history` \n-- limit 100\n)\n```", "```py\ninsert into `recommendersystem.user_event_purchase_complete` (eventType, visitorId,eventTime,productDetails,purchaseTransaction,attributes)\nSELECT \n'purchase-complete' as eventType,\ncast( visitorId as string) as visitorId,\neventTime,\n[\n    struct( struct(product_id  as id) as product , 1 as quantity) \n] as productDetails,\nstruct(safe_cast(revenue as float64) as revenue, 'USD' as currencyCode) as purchaseTransaction,\n struct(\n     struct([deviceType] as text)as deviceType,\n     struct([city] as text)as cityName \n\n )\n   as attributes\nfrom (\n  select *, \ndeviceType from  `recommendersystem.user_purchase_event` \n)\n```", "```py\ncurl -X POST \\\n     -H \"Authorization: Bearer ya29.a0AasRrdaM8jq4J0FBtJpsdhu87ZJcPlr4-8NqkDdGmLYtQ7P-riTx5man4k2maqWGNIsL1007a4BClSsfVbgHyjycaKn_5bviofo5XCbvCeO5-kkepnb_RUgy6prxRX7X8pi2PFHxX-kbmSmQgeEoILQQnK_aYMtTagSFzkUXC12Q2A5VmlfXR5cvSW-a80XxGOikpEf1jHuwusQx2EftBITnhPaYvg6Xi08qzvAEnmKgYicqCqY5o9d9ixav1jm6bd0r7A\" \\\n     -H \"Content-Type: application/json; charset=utf-8\" \\\n     -H \"X-Goog-User-Project: test-prod \"\n     --data \"{\n         'eventType': 'home-page-view',\n         'visitorId': '12',\n         'eventTime': '2021-09-28T03:33:33.000001Z',\n         'attributionToken': 'ABC',\n         'attributes': {\n            'city_name': {\n              'text': ['karachi']\n            },\n            'device_type': {\n              'text': ['iOS']\n            },\n         },\n         'userInfo': {\n           'userId': '123',\n         }\n}\"\\\n\"https://retail.googleapis.com/v2/projects/test-prod/locations/global/catalogs/default_catalog/userEvents:write\"\n```", "```py\ncurl -X POST \\\n     -H \"Authorization: Bearer ya29.a0ARrdaMsd84J0FBtZdJp2jhu87ZJcPlr4-8NqkDdGmLYtQ7P-riTx5man4k2maqWGNIsL1007a4BClSsfVbgHyjycaKn_5bviofo5XCbvCeO5-kkepnb_RUgy6prxRX7X8pi2PFHxX-kbmSmQgeEoILQQnK_aYMtTagSFzkUXC12Q2A5VmlfXR5cvSW-a80XxGOikpEf1jHuwusQx2EftBITnhPaYvg6Xi08qzvAEnmKgYicqCqY5o9d9ixav1jm6bd0r7A\" \\\n     -H \"Content-Type: application/json; charset=utf-8\" \\\n     -H \"X-Goog-User-Project: test-prod \"\n     --data \"{\n         'eventType': 'detail-page-view',\n         'visitorId': '123',\n         'eventTime': '2021-09-28T03:33:33.000001Z',\n         'attributionToken': 'ABC',\n         'attributes': {\n            'city_name': {\n              'text': ['karachi']\n            },\n            'device_type': {\n              'text': ['iOS']\n            },\n         },\n         'productDetails': [{\n           'product': {\n             'id': '2806'\n           }\n          }],\n         'userInfo': {\n           'userId': '123',\n         }\n}\"\\\n\"https://retail.googleapis.com/v2/projects/test-prod/locations/global/catalogs/default_catalog/userEvents:write\"\n```", "```py\ncurl -X POST \\\n     -H \"Authorization: Bearer ya29.sdrdaM8jq4J0FBtZdJp2jsdshu87ZJcPlr4-8NqkDdGmLYtQ7P-riTx5man4k2maqWGNIsL1007a4BClSsfVbgHyjycaKn_5bviofo5XCbvCeO5-kkepnb_RUgy6prxRX7X8pi2PFHxX-kbmSmQgeEoILQQnK_aYMtTagSFzkUXC12Q2A5VmlfXR5cvSW-a80XxGOikpEf1jHuwusQx2EftBITnhPaYvg6Xi08qzvAEnmKgYicqCqY5o9d9ixav1jm6bd0r7A\" \\\n     -H \"Content-Type: application/json; charset=utf-8\" \\\n     -H \"X-Goog-User-Project: test-prod\"\n     --data \"{\n         'eventType': 'add-to-cart',\n         'visitorId': '123',\n         'eventTime': '2021-09-28T03:33:33.000001Z',\n         'attributionToken': 'ABC',\n         'attributes': {\n            'city_name': {\n              'text': ['karachi']\n            },\n            'device_type': {\n              'text': ['iOS']\n            },\n         },\n         'productDetails': [{\n           'product': {\n             'id': '2806'\n           },\n     'quantity':1\n          }],\n         'userInfo': {\n           'userId': '123',\n         }\n}\"\\\n\"https://retail.googleapis.com/v2/projects/test-prod/locations/global/catalogs/default_catalog/userEvents:write\"\n```", "```py\ncurl -X POST \\\n     -H \"Authorization: Bearer ya29.a0ARrsddaM8jJ0FBtZdJsdjhu87ZJcPlr4-8NqkDdGmLYtQ7P-riTx5man4k2maqWGNIsL1007a4BClSsfVbgHyjycaKn_5bviofo5XCbvCeO5-kkepnb_RUgy6prxRX7X8pi2PFHxX-kbmSmQgeEoILQQnK_aYMtTagSFzkUXC12Q2A5VmlfXR5cvSW-a80XxGOikpEf1jHuwusQx2EftBITnhPaYvg6Xi08qzvAEnmKgYicqCqY5o9d9ixav1jm6bd0r7A\" \\\n     -H \"Content-Type: application/json; charset=utf-8\" \\\n     -H \"X-Goog-User-Project: test-prod \"\n     --data \"{\n         'eventType': 'purchase-complete',\n         'visitorId': '123',\n         'eventTime': '2021-09-28T03:33:33.000001Z',\n         'attributionToken': 'ABC',\n         'attributes': {\n            'city_name': {\n              'text': ['karachi']\n            },\n            'device_type': {\n              'text': ['iOS']\n            },\n         },\n         'productDetails': [{\n           'product': {\n             'id': '2806'\n           },\n     'quantity':'1'\n          }],\n          'purchaseTransaction':{\n              \"id\": 'transacion-id-here',\n              \"revenue\": 'orderPrice-here',\n              \"currencyCode\": 'USD',\n               \"quantity\":'1'\n            }\n         'userInfo': {\n           'userId': '123',\n         }\n}\"\\\n\"https://retail.googleapis.com/v2/projects/test-prod/locations/global/catalogs/default_catalog/userEvents:write\"\n```", "```py\ncurl -X POST \\\n    -H \"Authorization: Bearer ya29.aARrdaM9Bm57OTsdsIQAzGT15GwYzZpVfssffknWPNJ8gpKRk6IHSFmGqs1nBpAlaRRg2fQvtJgtUDGsuIc-h-j0RMLkAPy7FjxQ4tQbYZl62ba-4q4oRx-oY2KwYDA-pEQW77SACo2a8hS1zEUZHyyHCO3V-PycSBetJeldjib5VYo969D1PFVF33WSSRLPIP9uBcTW9ABoYthSOioTePlaICbwV1p8dlXesnCH8PdPNuKPxJJI3rzrnIghKXUKSQb4E-mc\" \\\n    -H \"Content-Type: application/json; charset=utf-8\" \\\n    -H \"X-Goog-User-Project: test-prod\"\\\n\n    --data  '{\n\n     \"pageSize\":100,\n\n          \"userEvent\": {\n              \"eventType\": \"home-page-view\",\n              \"visitorId\": \"123\",\n              \"userInfo\": {\n                  \"userId\": \"123\"\n              },\n              \"experimentIds\": \"123\"\n            }\n          }' \\\nhttps://retail.googleapis.com/v2/projects/test-prod/locations/global/catalogs/default_catalog/placements/<your serving id here>:predict\n```"]
- en: Using SHAP to Debug a PyTorch Image Regression Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/using-shap-to-debug-a-pytorch-image-regression-model-4b562ddef30d?source=collection_archive---------14-----------------------#2023-01-10](https://towardsdatascience.com/using-shap-to-debug-a-pytorch-image-regression-model-4b562ddef30d?source=collection_archive---------14-----------------------#2023-01-10)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Using DeepShap to understand and improve the model powering an autonomous car
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://conorosullyds.medium.com/?source=post_page-----4b562ddef30d--------------------------------)[![Conor
    O''Sullivan](../Images/2dc50a24edb12e843651d01ed48a3c3f.png)](https://conorosullyds.medium.com/?source=post_page-----4b562ddef30d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4b562ddef30d--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4b562ddef30d--------------------------------)
    [Conor O''Sullivan](https://conorosullyds.medium.com/?source=post_page-----4b562ddef30d--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ae48256fb37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-shap-to-debug-a-pytorch-image-regression-model-4b562ddef30d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=post_page-4ae48256fb37----4b562ddef30d---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4b562ddef30d--------------------------------)
    ·11 min read·Jan 10, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b562ddef30d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-shap-to-debug-a-pytorch-image-regression-model-4b562ddef30d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=-----4b562ddef30d---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b562ddef30d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-shap-to-debug-a-pytorch-image-regression-model-4b562ddef30d&source=-----4b562ddef30d---------------------bookmark_footer-----------)![](../Images/965f5964b6c98ef14db3694ad7588c2f.png)'
  prefs: []
  type: TYPE_NORMAL
- en: '(source: author)'
  prefs: []
  type: TYPE_NORMAL
- en: Autonomous cars terrify me. Big hunks of metal flying around with no humans
    to stop them if something goes wrong. To reduce this risk it is not enough to
    evaluate the models powering these beasts. We also need to understand how they
    are making predictions. This is to avoid any edge cases that would cause unforeseen
    accidents.
  prefs: []
  type: TYPE_NORMAL
- en: Okay, so our application is not so consequential. We will be debugging the model
    used to power a mini-automated car (the worst you could expect is a bruised ankle).
    Still, IML methods can be useful. We will see how they can even improve the performance
    of the model.
  prefs: []
  type: TYPE_NORMAL
- en: 'Specifically, we will:'
  prefs: []
  type: TYPE_NORMAL
- en: Fine-tune ResNet-18 using PyTorch with image data and a continuous target variable
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Evaluate the model using MSE and scatter plots
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interpret the model using DeepSHAP
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Correct the model through better data collection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Discuss how image augmentation could further improve the model
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Along the way, we will discuss some key pieces of Python code. You can also
    find the full project on [GitHub](https://github.com/conorosully/SHAP-tutorial/blob/main/src/image_data.ipynb).
  prefs: []
  type: TYPE_NORMAL

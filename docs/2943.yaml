- en: 'From Hacks to Harmony: Structuring Product Rules in Recommendations'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»é»‘å®¢åˆ°å’Œè°ï¼šåœ¨æ¨èä¸­æ„å»ºäº§å“è§„åˆ™
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/from-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18?source=collection_archive---------7-----------------------#2023-09-23](https://towardsdatascience.com/from-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18?source=collection_archive---------7-----------------------#2023-09-23)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/from-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18?source=collection_archive---------7-----------------------#2023-09-23](https://towardsdatascience.com/from-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18?source=collection_archive---------7-----------------------#2023-09-23)
- en: Donâ€™t let heuristics undermine your ML, learn to combine them
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸è¦è®©å¯å‘å¼è§„åˆ™å‰Šå¼±ä½ çš„æœºå™¨å­¦ä¹ ï¼Œå­¦ä¼šå°†å®ƒä»¬ç»“åˆèµ·æ¥
- en: '[](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)[![Michael
    Roizner](../Images/bcb68ee626ea57234b62e512ed4b383b.png)](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)[](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)
    [Michael Roizner](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)[![Michael
    Roizner](../Images/bcb68ee626ea57234b62e512ed4b383b.png)](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)[](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)
    [Michael Roizner](https://roizner.medium.com/?source=post_page-----838af0873f18--------------------------------)'
- en: Â·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bee5af37d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&user=Michael+Roizner&userId=1bee5af37d8&source=post_page-1bee5af37d8----838af0873f18---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)
    Â·6 min readÂ·Sep 23, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F838af0873f18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&user=Michael+Roizner&userId=1bee5af37d8&source=-----838af0873f18---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[å…³æ³¨](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bee5af37d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&user=Michael+Roizner&userId=1bee5af37d8&source=post_page-1bee5af37d8----838af0873f18---------------------post_header-----------)
    å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----838af0873f18--------------------------------)
    Â·6 min readÂ·2023å¹´9æœˆ23æ—¥[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F838af0873f18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&user=Michael+Roizner&userId=1bee5af37d8&source=-----838af0873f18---------------------clap_footer-----------)'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F838af0873f18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&source=-----838af0873f18---------------------bookmark_footer-----------)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F838af0873f18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-hacks-to-harmony-structuring-product-rules-in-recommendations-838af0873f18&source=-----838af0873f18---------------------bookmark_footer-----------)'
- en: In todayâ€™s data-driven landscape, recommendation systems power everything from
    social media feeds to e-commerce. While itâ€™s tempting to think that machine learning
    algorithms do all the heavy lifting, thatâ€™s only half the story. Real-world systems
    often rely on a mix of machine learning and heuristic rules â€” commonly referred
    to as product rules, business rules, or simply hacks â€” to generate the most relevant
    recommendations.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å½“ä»Šçš„æ•°æ®é©±åŠ¨ç¯å¢ƒä¸­ï¼Œæ¨èç³»ç»Ÿé©±åŠ¨äº†ä»ç¤¾äº¤åª’ä½“ä¿¡æ¯æµåˆ°ç”µå­å•†åŠ¡çš„æ‰€æœ‰å†…å®¹ã€‚å°½ç®¡å¾ˆå®¹æ˜“è®¤ä¸ºæœºå™¨å­¦ä¹ ç®—æ³•æ‰¿æ‹…äº†æ‰€æœ‰çš„é‡ä»»ï¼Œä½†è¿™åªæ˜¯æ•…äº‹çš„ä¸€åŠã€‚ç°å®ä¸–ç•Œä¸­çš„ç³»ç»Ÿé€šå¸¸ä¾èµ–äºæœºå™¨å­¦ä¹ å’Œå¯å‘å¼è§„åˆ™çš„æ··åˆâ€”â€”é€šå¸¸è¢«ç§°ä¸ºäº§å“è§„åˆ™ã€ä¸šåŠ¡è§„åˆ™æˆ–ç®€å•çš„é»‘å®¢â€”â€”ä»¥ç”Ÿæˆæœ€ç›¸å…³çš„æ¨èã€‚
- en: 'For example:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼š
- en: You canâ€™t recommend tracks from the same artist too often;
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½ ä¸èƒ½è¿‡äºé¢‘ç¹åœ°æ¨èæ¥è‡ªåŒä¸€è‰ºæœ¯å®¶çš„æ›²ç›®ï¼›
- en: You should include content from subscriptions in the feed, but not overwhelm
    it;
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½ åº”è¯¥åœ¨ä¿¡æ¯æµä¸­åŒ…å«è®¢é˜…å†…å®¹ï¼Œä½†ä¸è¦ä½¿å…¶è¿‡äºç¹é‡ï¼›
- en: If a user has already disliked a certain category or author, the related content
    should be penalized or even filtered out;
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœç”¨æˆ·å·²ç»å¯¹æŸä¸€ç±»åˆ«æˆ–ä½œè€…è¡¨ç¤ºä¸å–œæ¬¢ï¼Œç›¸å…³å†…å®¹åº”å—åˆ°æƒ©ç½šæˆ–ç”šè‡³è¢«è¿‡æ»¤æ‰ï¼›
- en: Explicit content canâ€™t be recommended â€” except when appropriate.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ˜ç¡®çš„å†…å®¹ä¸èƒ½è¢«æ¨èâ€”â€”é™¤éæƒ…å†µé€‚å½“ã€‚
- en: '![](../Images/11efea3666e246f87dabb9ab4f9c293b.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/11efea3666e246f87dabb9ab4f9c293b.png)'
- en: Photo by [Cam Bradford](https://unsplash.com/@cambradford?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: ç…§ç‰‡ç”± [Cam Bradford](https://unsplash.com/@cambradford?utm_source=medium&utm_medium=referral)
    æä¾›ï¼Œå‘å¸ƒåœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: 'Rules come in two types: hard and soft. Hard rules act as filters, prohibiting
    certain documents from being recommended in specific contexts; failing to comply
    is considered a product bug. Thereâ€™s nothing inherently wrong with these rules,
    but their number should be limited. Moreover, they should be applied as early
    as possible in the ranking process, either at the candidate generation stage or
    even during index construction. Soft rules, on the other hand, are more like guidelines:
    you can recommend such items, but preferably not too much (or the opposite, more
    is better). Having too many of these soft rules can make system debugging and
    development highly challenging.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: è§„åˆ™æœ‰ä¸¤ç§ç±»å‹ï¼šç¡¬è§„åˆ™å’Œè½¯è§„åˆ™ã€‚ç¡¬è§„åˆ™ä½œä¸ºè¿‡æ»¤å™¨ï¼Œç¦æ­¢åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­æ¨èæŸäº›æ–‡æ¡£ï¼›ä¸ç¬¦åˆè§„å®šè¢«è§†ä¸ºäº§å“ç¼ºé™·ã€‚è¿™äº›è§„åˆ™æœ¬èº«æ²¡æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œä½†å®ƒä»¬çš„æ•°é‡åº”è¯¥å—åˆ°é™åˆ¶ã€‚æ­¤å¤–ï¼Œå®ƒä»¬åº”è¯¥å°½å¯èƒ½æ—©åœ°åº”ç”¨äºæ’åè¿‡ç¨‹ï¼Œæœ€å¥½æ˜¯åœ¨å€™é€‰ç”Ÿæˆé˜¶æ®µï¼Œç”šè‡³åœ¨ç´¢å¼•æ„å»ºè¿‡ç¨‹ä¸­ã€‚å¦ä¸€æ–¹é¢ï¼Œè½¯è§„åˆ™æ›´åƒæ˜¯æŒ‡å¯¼æ–¹é’ˆï¼šä½ å¯ä»¥æ¨èè¿™äº›é¡¹ç›®ï¼Œä½†æœ€å¥½ä¸è¦æ¨èè¿‡å¤šï¼ˆæˆ–è€…ç›¸åï¼Œå¤šæ¨èä¹Ÿå¯ä»¥ï¼‰ã€‚æ‹¥æœ‰è¿‡å¤šçš„è½¯è§„åˆ™å¯èƒ½ä¼šä½¿ç³»ç»Ÿè°ƒè¯•å’Œå¼€å‘å˜å¾—éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ã€‚
- en: '**Rules are technical debt.**'
  id: totrans-17
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**è§„åˆ™æ˜¯æŠ€æœ¯å€ºåŠ¡ã€‚**'
- en: I find that the quantity of such rules in a system often depends on the internal
    power dynamics within the team. Product managers usually find it convenient to
    express constraints through rules, while engineers typically dislike these hacks.
    In my previous team, I took pride in our ability to keep the number of such rules
    to a minimum.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å‘ç°ç³»ç»Ÿä¸­æ­¤ç±»è§„åˆ™çš„æ•°é‡é€šå¸¸ä¾èµ–äºå›¢é˜Ÿå†…éƒ¨çš„æƒåŠ›åŠ¨æ€ã€‚äº§å“ç»ç†é€šå¸¸å‘ç°é€šè¿‡è§„åˆ™è¡¨è¾¾çº¦æŸå¾ˆæ–¹ä¾¿ï¼Œè€Œå·¥ç¨‹å¸ˆé€šå¸¸ä¸å–œæ¬¢è¿™äº›æƒå®œä¹‹è®¡ã€‚åœ¨æˆ‘ä¹‹å‰çš„å›¢é˜Ÿä¸­ï¼Œæˆ‘ä¸ºæˆ‘ä»¬èƒ½å¤Ÿå°†è¿™äº›è§„åˆ™çš„æ•°é‡ä¿æŒåœ¨æœ€ä½é™åº¦è€Œæ„Ÿåˆ°è‡ªè±ªã€‚
- en: Throughout my career, Iâ€™ve frequently encountered a recurring pattern. The engineering
    team struggles to train the system in a way that produces good recommendations
    (either overall or in specific aspects). The product team then resorts to what
    they know best â€” adding new rules. Such patches are justified when quick fixes
    are needed, but theyâ€™re hard to remove later. The system often remains in this
    patched state until a major refactoring takes place, much like regular technical
    debt.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œæˆ‘ç»å¸¸é‡åˆ°ä¸€ä¸ªåå¤å‡ºç°çš„æ¨¡å¼ã€‚å·¥ç¨‹å›¢é˜Ÿéš¾ä»¥è®­ç»ƒç³»ç»Ÿï¼Œä»¥äº§ç”Ÿè‰¯å¥½çš„æ¨èï¼ˆæ— è®ºæ˜¯æ•´ä½“è¿˜æ˜¯åœ¨ç‰¹å®šæ–¹é¢ï¼‰ã€‚äº§å“å›¢é˜Ÿéšåè½¬è€Œä½¿ç”¨ä»–ä»¬æœ€ç†Ÿæ‚‰çš„æ–¹æ³•â€”â€”æ·»åŠ æ–°è§„åˆ™ã€‚è¿™äº›è¡¥ä¸åœ¨éœ€è¦å¿«é€Ÿä¿®å¤æ—¶æ˜¯åˆç†çš„ï¼Œä½†åæœŸå¾ˆéš¾å»é™¤ã€‚ç³»ç»Ÿé€šå¸¸ä¼šä¿æŒè¿™ç§è¡¥ä¸çŠ¶æ€ï¼Œç›´åˆ°è¿›è¡Œé‡å¤§é‡æ„ï¼Œå°±åƒå¸¸è§„çš„æŠ€æœ¯å€ºåŠ¡ä¸€æ ·ã€‚
- en: The moral of the story â€” donâ€™t skimp on hiring strong engineers ğŸ™‚
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: æ•…äº‹çš„å¯“æ„â€”â€”ä¸è¦åå•¬äºè˜è¯·å¼ºå¤§çš„å·¥ç¨‹å¸ˆğŸ™‚
- en: In an ideal system, there should be no such rules; all the fuzzy logic should
    be handled by an advanced enough model. I dream that someday weâ€™ll reach this
    technological state (and I have a hypothesis on how to achieve it). However, for
    the time being, itâ€™s not realistic. So, instead of completely forbidding these
    rules, Iâ€™ll talk about an approach that allows for some organization and limits
    the chaos.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸€ä¸ªç†æƒ³çš„ç³»ç»Ÿä¸­ï¼Œä¸åº”è¯¥æœ‰è¿™æ ·çš„è§„åˆ™ï¼›æ‰€æœ‰æ¨¡ç³Šçš„é€»è¾‘éƒ½åº”è¯¥ç”±è¶³å¤Ÿå…ˆè¿›çš„æ¨¡å‹å¤„ç†ã€‚æˆ‘æ¢¦æƒ³ç€æœ‰ä¸€å¤©æˆ‘ä»¬èƒ½è¾¾åˆ°è¿™ç§æŠ€æœ¯çŠ¶æ€ï¼ˆæˆ‘æœ‰ä¸€ä¸ªå…³äºå¦‚ä½•å®ç°å®ƒçš„å‡è®¾ï¼‰ã€‚ç„¶è€Œï¼Œå°±ç›®å‰è€Œè¨€ï¼Œè¿™å¹¶ä¸ç°å®ã€‚å› æ­¤ï¼Œä¸å…¶å®Œå…¨ç¦æ­¢è¿™äº›è§„åˆ™ï¼Œæˆ‘å°†è®¨è®ºä¸€ç§å…è®¸æŸç§ç»„ç»‡å¹¶é™åˆ¶æ··ä¹±çš„æ–¹æ³•ã€‚
- en: 'A Structured Approach: The Reranking Framework'
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä¸€ç§ç»“æ„åŒ–çš„æ–¹æ³•ï¼šé‡æ–°æ’åæ¡†æ¶
- en: This framework allows the integration of machine learning models with product
    rule enforcement, helping to structure these rules while avoiding complete chaos.
    However, itâ€™s flexible and not overly restrictive, so it canâ€™t guarantee total
    order. In a way, itâ€™s simply a language for describing rules. In my opinion, itâ€™s
    quite convenient.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ¡†æ¶å…è®¸å°†æœºå™¨å­¦ä¹ æ¨¡å‹ä¸äº§å“è§„åˆ™æ‰§è¡Œç»“åˆèµ·æ¥ï¼Œå¸®åŠ©æ„å»ºè¿™äº›è§„åˆ™ï¼ŒåŒæ—¶é¿å…å®Œå…¨æ··ä¹±ã€‚ç„¶è€Œï¼Œå®ƒæ˜¯çµæ´»çš„ï¼Œä¸ä¼šè¿‡äºé™åˆ¶ï¼Œå› æ­¤ä¸èƒ½ä¿è¯å®Œå…¨çš„ç§©åºã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œå®ƒåªæ˜¯æè¿°è§„åˆ™çš„ä¸€ç§è¯­è¨€ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒç›¸å½“æ–¹ä¾¿ã€‚
- en: In this discussion, weâ€™ll focus on the final stage of ranking, where there are
    not too many documents left â€” say, from a few dozen to a couple of hundred â€” and
    we want to compile the best list from them. Whatâ€™s interesting about this stage
    is that weâ€™re not just trying to assess each document in the current context as
    precisely as possible, but weâ€™re also considering how these documents combine
    with one another. This is when listwise ranking comes into play (not to be confused
    with listwise learning for learning-to-rank, where only the loss function depends
    on all the documents in a query, not the ranking function). A typical application
    of this listwise approach is to enhance result diversity.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨æ’åçš„æœ€ç»ˆé˜¶æ®µï¼Œæ­¤æ—¶å‰©ä½™æ–‡æ¡£ä¸å¤šâ€”â€”ä¾‹å¦‚ï¼Œä»å‡ åä¸ªåˆ°å‡ ç™¾ä¸ªâ€”â€”æˆ‘ä»¬å¸Œæœ›ä»ä¸­ç¼–åˆ¶å‡ºæœ€ä½³åˆ—è¡¨ã€‚è¿™ä¸ªé˜¶æ®µçš„æœ‰è¶£ä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬ä¸ä»…ä»…æ˜¯åœ¨å°½å¯èƒ½å‡†ç¡®åœ°è¯„ä¼°æ¯ä¸ªæ–‡æ¡£åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„è¡¨ç°ï¼Œè¿˜åœ¨è€ƒè™‘è¿™äº›æ–‡æ¡£ä¹‹é—´çš„ç›¸äº’ç»„åˆã€‚è¿™æ—¶ï¼Œlistwise
    æ’åæ–¹æ³•å°±å‘æŒ¥äº†ä½œç”¨ï¼ˆä¸ç”¨äºå­¦ä¹ æ’åçš„ listwise å­¦ä¹ ä¸åŒï¼Œåè€…ä»…ä»…æ˜¯æŸå¤±å‡½æ•°ä¾èµ–äºæŸ¥è¯¢ä¸­çš„æ‰€æœ‰æ–‡æ¡£ï¼Œè€Œæ’åå‡½æ•°å¹¶ä¸ä¾èµ–ï¼‰ã€‚è¿™ç§ listwise
    æ–¹æ³•çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯æå‡ç»“æœçš„å¤šæ ·æ€§ã€‚
- en: Here are the key principles of the approach.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ˜¯è¯¥æ–¹æ³•çš„å…³é”®åŸåˆ™ã€‚
- en: The results are generated iteratively, starting from the first position and
    ending at the last. On each iteration, we select the most fitting document for
    the upcoming position. This is how the majority of reranking strategies, like
    the well-known DPP for diversification, work. For non-linear outputs, positions
    can be ranked by importance.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»“æœæ˜¯é€šè¿‡è¿­ä»£ç”Ÿæˆçš„ï¼Œä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œç›´åˆ°æœ€åä¸€ä¸ªä½ç½®ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©æœ€åˆé€‚çš„æ–‡æ¡£æ”¾å…¥æ¥ä¸‹æ¥çš„ä½ç½®ã€‚è¿™æ˜¯å¤§å¤šæ•°é‡æ–°æ’åºç­–ç•¥çš„å·¥ä½œåŸç†ï¼Œå¦‚è‘—åçš„DPPç”¨äºå¤šæ ·åŒ–ã€‚å¯¹äºéçº¿æ€§è¾“å‡ºï¼Œå¯ä»¥æŒ‰é‡è¦æ€§å¯¹ä½ç½®è¿›è¡Œæ’åºã€‚
- en: 'On each iteration, we take all remaining documents and sort them by a value
    function. This could range from something simple like the output of a click probability
    model to something more complex: a combination of various model outputs (or multiple
    models) predicting different events, diversity components (such as similarity
    to previous documents), and manual boosts, etc. The value function can be recalculated
    on each iteration and can therefore depend on both the position and the documents
    already in the final output. It must be computationally efficient. Crafting the
    right value function is a rich topic in itself; the framework neither restricts
    nor simplifies this aspect.'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å‰©ä½™æ–‡æ¡£æŒ‰å€¼å‡½æ•°è¿›è¡Œæ’åºã€‚è¿™å¯ä»¥ä»ç®€å•çš„ç‚¹å‡»æ¦‚ç‡æ¨¡å‹è¾“å‡ºåˆ°æ›´å¤æ‚çš„æƒ…å†µï¼šå„ç§æ¨¡å‹è¾“å‡ºï¼ˆæˆ–å¤šä¸ªæ¨¡å‹ï¼‰é¢„æµ‹çš„ä¸åŒäº‹ä»¶ã€ç›¸ä¼¼æ€§ç»„ä»¶ï¼ˆå¦‚ä¸ä¹‹å‰æ–‡æ¡£çš„ç›¸ä¼¼æ€§ï¼‰ä»¥åŠæ‰‹åŠ¨åŠ æƒç­‰ã€‚å€¼å‡½æ•°å¯ä»¥åœ¨æ¯æ¬¡è¿­ä»£ä¸­é‡æ–°è®¡ç®—ï¼Œå› æ­¤å¯ä»¥ä¾èµ–äºä½ç½®å’Œæœ€ç»ˆè¾“å‡ºä¸­å·²æœ‰çš„æ–‡æ¡£ã€‚å®ƒå¿…é¡»å…·å¤‡è®¡ç®—æ•ˆç‡ã€‚è®¾è®¡æ­£ç¡®çš„å€¼å‡½æ•°æœ¬èº«æ˜¯ä¸€ä¸ªä¸°å¯Œçš„è¯é¢˜ï¼›è¯¥æ¡†æ¶æ—¢ä¸é™åˆ¶ä¹Ÿä¸ç®€åŒ–è¿™ä¸€æ–¹é¢ã€‚
- en: 'Product rules are expressed as follows: within a subset of positions ***X***,
    the number of documents with property ***f*** should be either above or below
    a certain threshold ***C***. Usually, ***X*** is a range of starting positions,
    such as 1 to 10 (the first page). Property ***f*** is best expressed as a threshold
    rule of some feature, i.e., **[feature(doc) > threshold]**. If needed, this format
    can be generalized to include non-binary properties.'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¹˜ç§¯è§„åˆ™è¡¨ç¤ºå¦‚ä¸‹ï¼šåœ¨ä¸€ä¸ªä½ç½®çš„å­é›†***X***ä¸­ï¼Œå…·æœ‰å±æ€§***f***çš„æ–‡æ¡£æ•°é‡åº”å½“é«˜äºæˆ–ä½äºæŸä¸ªé˜ˆå€¼***C***ã€‚é€šå¸¸ï¼Œ***X***æ˜¯ä¸€ä¸ªèµ·å§‹ä½ç½®çš„èŒƒå›´ï¼Œä¾‹å¦‚1åˆ°10ï¼ˆç¬¬ä¸€é¡µï¼‰ã€‚å±æ€§***f***æœ€å¥½è¡¨ç¤ºä¸ºæŸä¸ªç‰¹å¾çš„é˜ˆå€¼è§„åˆ™ï¼Œå³**[feature(doc)
    > threshold]**ã€‚å¦‚æœ‰å¿…è¦ï¼Œè¿™ç§æ ¼å¼å¯ä»¥æ¨å¹¿åˆ°åŒ…å«éäºŒå…ƒå±æ€§çš„æƒ…å†µã€‚
- en: 'Rules have priority. If we canâ€™t satisfy all rules, we discard the least important
    ones. To be more precise: if the highest-priority rule is achievable at a given
    position, it will definitely be enforced; otherwise, it wonâ€™t be. If the next-highest-priority
    rule is achievable under those conditions, it will be enforced; otherwise, we
    skip it. And so on. In other words, we select the lexicographically highest mask
    of fulfilled rules.'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è§„åˆ™å…·æœ‰ä¼˜å…ˆçº§ã€‚å¦‚æœæˆ‘ä»¬ä¸èƒ½æ»¡è¶³æ‰€æœ‰è§„åˆ™ï¼Œæˆ‘ä»¬å°†ä¸¢å¼ƒä¼˜å…ˆçº§æœ€ä½çš„è§„åˆ™ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼šå¦‚æœåœ¨ç»™å®šä½ç½®å¯ä»¥å®ç°æœ€é«˜ä¼˜å…ˆçº§çš„è§„åˆ™ï¼Œå®ƒå°†è¢«ä¸¥æ ¼æ‰§è¡Œï¼›å¦åˆ™ï¼Œå°†ä¸è¢«æ‰§è¡Œã€‚å¦‚æœåœ¨è¿™äº›æ¡ä»¶ä¸‹å¯ä»¥å®ç°ä¸‹ä¸€ä¸ªæœ€é«˜ä¼˜å…ˆçº§çš„è§„åˆ™ï¼Œå®ƒå°†è¢«æ‰§è¡Œï¼›å¦åˆ™ï¼Œæˆ‘ä»¬å°†è·³è¿‡å®ƒã€‚ä¾æ­¤ç±»æ¨ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬é€‰æ‹©å®ç°è§„åˆ™çš„å­—å…¸åºæœ€é«˜çš„æ©ç ã€‚
- en: 'Here are a few examples of rules in this format:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæœ‰ä¸€äº›æ ¼å¼è§„åˆ™çš„ç¤ºä¾‹ï¼š
- en: At least half of the documents in the entire output should be subscriptions.
    However, if all documents from subscriptions have already been read, this rule
    becomes infeasible and will be discarded.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ•´ä¸ªè¾“å‡ºä¸­è‡³å°‘ä¸€åŠçš„æ–‡æ¡£åº”ä¸ºè®¢é˜…å†…å®¹ã€‚ç„¶è€Œï¼Œå¦‚æœæ‰€æœ‰è®¢é˜…æ–‡æ¡£å·²ç»è¢«é˜…è¯»ï¼Œè¿™æ¡è§„åˆ™å°†å˜å¾—ä¸å¯è¡Œï¼Œå¹¶ä¼šè¢«ä¸¢å¼ƒã€‚
- en: The number of low-quality documents in the first 10 positions should not exceed
    2.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰10ä¸ªä½ç½®ä¸­çš„ä½è´¨é‡æ–‡æ¡£æ•°é‡ä¸åº”è¶…è¿‡2ä¸ªã€‚
- en: Between positions 10 and 20, there should be at least one document from a new
    category.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨ä½ç½® 10 å’Œ 20 ä¹‹é—´ï¼Œåº”è¯¥è‡³å°‘æœ‰ä¸€ä¸ªæ¥è‡ªæ–°ç±»åˆ«çš„æ–‡æ¡£ã€‚
- en: 'Itâ€™s worth noting that rules like â€œat least 5 documents with a certain property
    must be in the first 10 positionsâ€ can result in the first 5 positions being filled
    with documents lacking that property, followed by 5 with it. To make this more
    evenly distributed, you can add rules for intermediate ranges: at least 1 in the
    first 2 positions, at least 2 in the first 4, and so on.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåƒâ€œå‰ 10 ä¸ªä½ç½®ä¸­å¿…é¡»è‡³å°‘æœ‰ 5 ä¸ªæ–‡æ¡£å…·æœ‰æŸç§å±æ€§â€è¿™æ ·çš„è§„åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‰ 5 ä¸ªä½ç½®è¢«ç¼ºä¹è¯¥å±æ€§çš„æ–‡æ¡£å¡«å……ï¼Œç„¶åæ˜¯ 5 ä¸ªå…·æœ‰è¯¥å±æ€§çš„æ–‡æ¡£ã€‚ä¸ºäº†ä½¿åˆ†å¸ƒæ›´å‡åŒ€ï¼Œä½ å¯ä»¥ä¸ºä¸­é—´èŒƒå›´æ·»åŠ è§„åˆ™ï¼šå‰
    2 ä¸ªä½ç½®ä¸­è‡³å°‘æœ‰ 1 ä¸ªï¼Œå‰ 4 ä¸ªä½ç½®ä¸­è‡³å°‘æœ‰ 2 ä¸ªï¼Œä¾æ­¤ç±»æ¨ã€‚
- en: Implementing this framework efficiently is a good challenge but entirely doable.
    Hereâ€™s a Python code sketch to illustrate how one could implement the described
    reranking framework. Keep in mind, this is not optimized for efficiency but should
    give a good starting point.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: é«˜æ•ˆå®ç°è¿™ä¸ªæ¡†æ¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ‘æˆ˜ï¼Œä½†å®Œå…¨å¯ä»¥åšåˆ°ã€‚è¿™æ˜¯ä¸€ä¸ª Python ä»£ç è‰å›¾ï¼Œå±•ç¤ºäº†å¦‚ä½•å®ç°æè¿°çš„é‡æ–°æ’åºæ¡†æ¶ã€‚è¯·è®°ä½ï¼Œè¿™ä¸ªä»£ç å¹¶æ²¡æœ‰ä¼˜åŒ–æ•ˆç‡ï¼Œä½†åº”è¯¥èƒ½æä¾›ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚
- en: '[PRE0]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Lastly, enhancing the systemâ€™s debuggability and controllability is greatly
    facilitated by logging all executed and discarded rules.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œé€šè¿‡è®°å½•æ‰€æœ‰æ‰§è¡Œå’Œä¸¢å¼ƒçš„è§„åˆ™ï¼Œå¯ä»¥å¤§å¤§æå‡ç³»ç»Ÿçš„å¯è°ƒè¯•æ€§å’Œå¯æ§æ€§ã€‚
- en: As weâ€™ve seen, a â€˜rules-freeâ€™ recommendation system remains more of an ideal
    than a reality for now. But that doesnâ€™t mean weâ€™re stuck in chaos. A well-structured
    framework for managing rules can give you the organization you need without stifling
    the systemâ€™s potential.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œç›®å‰â€˜æ— è§„åˆ™â€™æ¨èç³»ç»Ÿä»ç„¶æ›´åƒæ˜¯ä¸€ä¸ªç†æƒ³è€Œéç°å®ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬é™·å…¥äº†æ··ä¹±ã€‚ä¸€ä¸ªç»“æ„è‰¯å¥½çš„è§„åˆ™ç®¡ç†æ¡†æ¶å¯ä»¥æä¾›æ‰€éœ€çš„ç»„ç»‡ï¼ŒåŒæ—¶ä¸ä¼šæŠ‘åˆ¶ç³»ç»Ÿçš„æ½œåŠ›ã€‚

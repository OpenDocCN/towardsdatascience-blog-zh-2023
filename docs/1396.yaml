- en: 'Boosting Spark Union Operator Performance: Optimization Tips for Improved Query
    Speed'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/boosting-spark-union-operator-performance-optimization-tips-for-improved-query-speed-9123ae6ada80?source=collection_archive---------11-----------------------#2023-04-20](https://towardsdatascience.com/boosting-spark-union-operator-performance-optimization-tips-for-improved-query-speed-9123ae6ada80?source=collection_archive---------11-----------------------#2023-04-20)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Demystify Spark Performance in Union Operator
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://chengzhizhao.medium.com/?source=post_page-----9123ae6ada80--------------------------------)[![Chengzhi
    Zhao](../Images/186bba91822dbcc0f926426e56faf543.png)](https://chengzhizhao.medium.com/?source=post_page-----9123ae6ada80--------------------------------)[](https://towardsdatascience.com/?source=post_page-----9123ae6ada80--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----9123ae6ada80--------------------------------)
    [Chengzhi Zhao](https://chengzhizhao.medium.com/?source=post_page-----9123ae6ada80--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff956c63a9571&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-spark-union-operator-performance-optimization-tips-for-improved-query-speed-9123ae6ada80&user=Chengzhi+Zhao&userId=f956c63a9571&source=post_page-f956c63a9571----9123ae6ada80---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----9123ae6ada80--------------------------------)
    ·6 min read·Apr 20, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9123ae6ada80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-spark-union-operator-performance-optimization-tips-for-improved-query-speed-9123ae6ada80&user=Chengzhi+Zhao&userId=f956c63a9571&source=-----9123ae6ada80---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9123ae6ada80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-spark-union-operator-performance-optimization-tips-for-improved-query-speed-9123ae6ada80&source=-----9123ae6ada80---------------------bookmark_footer-----------)![](../Images/bd00c06827eb22a6b64bcc2112e3d7d8.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Fahrul Azmi](https://unsplash.com/@fahrulazmi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/zN4mtLHkHn4?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: The union operator is one of the set operators to merge two input data frames
    into one. Union is a convenient operation in Apache Spark for combining rows with
    the same order of columns. One frequently used case is applying different transformations
    and then unioning them together.
  prefs: []
  type: TYPE_NORMAL
- en: The ways of using the union operation in Spark are often discussed widely. However,
    a hidden fact that has been less discussed is the performance caveat associated
    with the union operator. If we didn’t understand the caveat of the union operator
    in Spark, we might fall into the trap of doubling the execution time to get the
    result.
  prefs: []
  type: TYPE_NORMAL
- en: We will focus on the Apache Spark DataFrameunion operator in this story with
    examples, show you the physical query plan, and share techniques for optimization
    in this story.
  prefs: []
  type: TYPE_NORMAL
- en: Union Operator 101 in Spark
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Like Relational Database (RDBMS) SQL, the union is a direct way to combine
    rows. One important thing to note when dealing with a union operator is to ensure
    rows follow the same structure:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The number of columns should be identical**. The union operation won’t silently
    work or fill…'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

- en: Implement a Cache Decorator with Time to Live Feature in Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/implement-a-cache-decorator-with-ttl-feature-in-python-1d6969b7ca3f?source=collection_archive---------14-----------------------#2023-04-03](https://towardsdatascience.com/implement-a-cache-decorator-with-ttl-feature-in-python-1d6969b7ca3f?source=collection_archive---------14-----------------------#2023-04-03)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A decorator based on @functools.lru_cache supports cache expiration
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://qtalen.medium.com/?source=post_page-----1d6969b7ca3f--------------------------------)[![Peng
    Qian](../Images/9ce9aeb381ec6b017c1ee5d4714937e2.png)](https://qtalen.medium.com/?source=post_page-----1d6969b7ca3f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1d6969b7ca3f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1d6969b7ca3f--------------------------------)
    [Peng Qian](https://qtalen.medium.com/?source=post_page-----1d6969b7ca3f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8e2fe735546d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-a-cache-decorator-with-ttl-feature-in-python-1d6969b7ca3f&user=Peng+Qian&userId=8e2fe735546d&source=post_page-8e2fe735546d----1d6969b7ca3f---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1d6969b7ca3f--------------------------------)
    ·5 min read·Apr 3, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d6969b7ca3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-a-cache-decorator-with-ttl-feature-in-python-1d6969b7ca3f&user=Peng+Qian&userId=8e2fe735546d&source=-----1d6969b7ca3f---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d6969b7ca3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplement-a-cache-decorator-with-ttl-feature-in-python-1d6969b7ca3f&source=-----1d6969b7ca3f---------------------bookmark_footer-----------)![](../Images/1f1d5294aa688496b0d210d8cce05051.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Aron Visuals](https://unsplash.com/@aronvisuals?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: '**The problem：**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The [lru_cache](https://docs.python.org/3/library/functools.html#functools.lru_cache)
    decorator in Python’s functools package provides an implementation based on an
    LRU cache. Using this decorator functions with the same arguments will be significantly
    faster from the second time they are executed.
  prefs: []
  type: TYPE_NORMAL
- en: However, lru_cache cannot support cache expiration. If you want the cache to
    expire after a certain amount of time to update the cache when the function is
    called next time, lru_cache cannot achieve this.
  prefs: []
  type: TYPE_NORMAL
- en: '**How to solve:**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**1\. Implement a lru_cache with a TTL feature**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Therefore, I have implemented a new decorator based on lru_cache. This decorator
    can accept a ttl parameter. This parameter can accept a time in seconds, and when
    this time expires, the next function call will return a new value and refresh
    the cache.
  prefs: []
  type: TYPE_NORMAL
- en: 'For those who need to solve the problem urgently, here is the source code:'
  prefs: []
  type: TYPE_NORMAL

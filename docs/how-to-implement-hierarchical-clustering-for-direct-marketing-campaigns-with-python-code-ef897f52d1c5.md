# å¦‚ä½•ä½¿ç”¨ Python ä»£ç å®žçŽ°å±‚æ¬¡èšç±»

> åŽŸæ–‡ï¼š[`towardsdatascience.com/how-to-implement-hierarchical-clustering-for-direct-marketing-campaigns-with-python-code-ef897f52d1c5`](https://towardsdatascience.com/how-to-implement-hierarchical-clustering-for-direct-marketing-campaigns-with-python-code-ef897f52d1c5)

## äº†è§£å±‚æ¬¡èšç±»çš„æ–¹æ–¹é¢é¢ï¼Œä»¥åŠå®ƒå¦‚ä½•åº”ç”¨äºŽé“¶è¡Œä¸šçš„è¥é”€æ´»åŠ¨åˆ†æžã€‚

[](https://zoumanakeita.medium.com/?source=post_page-----ef897f52d1c5--------------------------------)![Zoumana Keita](https://zoumanakeita.medium.com/?source=post_page-----ef897f52d1c5--------------------------------)[](https://towardsdatascience.com/?source=post_page-----ef897f52d1c5--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----ef897f52d1c5--------------------------------) [Zoumana Keita](https://zoumanakeita.medium.com/?source=post_page-----ef897f52d1c5--------------------------------)

Â·å‘è¡¨äºŽ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----ef897f52d1c5--------------------------------) Â·é˜…è¯»æ—¶é—´ 11 åˆ†é’ŸÂ·2023 å¹´ 8 æœˆ 28 æ—¥

--

![](img/3282ab1d6eae7b1221f28b0d9665653d.png)

ç…§ç‰‡ç”± [Frederick Warren](https://unsplash.com/@carnations) æä¾›ï¼Œæ¥æºäºŽ [Unsplash](https://unsplash.com/photos/lOg_fQLHo7s)

# åŠ¨æœº

æƒ³è±¡ä¸€ä¸‹ä½ æ˜¯ä¸€å®¶é¢†å…ˆé‡‘èžæœºæž„çš„æ•°æ®ç§‘å­¦å®¶ï¼Œä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©å›¢é˜Ÿå°†çŽ°æœ‰å®¢æˆ·åˆ†ç±»ä¸ºä¸åŒçš„æ¡£æ¡ˆï¼š`ä½Ž`ã€`å¹³å‡`ã€`ä¸­`å’Œ`ç™½é‡‘`ï¼Œä»¥ä¾¿è¿›è¡Œè´·æ¬¾æ‰¹å‡†ã€‚

ä½†è¿™é‡Œæœ‰ä¸ªå…³é”®ç‚¹ï¼š

> ç”±äºŽè¿™äº›å®¢æˆ·æ²¡æœ‰åŽ†å²æ ‡ç­¾ï¼Œä½ è¯¥å¦‚ä½•è¿›è¡Œè¿™äº›ç±»åˆ«çš„åˆ›å»ºï¼Ÿ

è¿™å°±æ˜¯èšç±»èƒ½å¤Ÿæä¾›å¸®åŠ©çš„åœ°æ–¹ï¼Œå®ƒæ˜¯ä¸€ç§æ— ç›‘ç£çš„æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œç”¨äºŽå°†æœªæ ‡è®°çš„æ•°æ®åˆ†ç»„åˆ°ç±»ä¼¼çš„ç±»åˆ«ä¸­ã€‚

å­˜åœ¨å¤šç§èšç±»æŠ€æœ¯ï¼Œä½†æœ¬æ•™ç¨‹å°†æ›´ä¸“æ³¨äºŽ`å±‚æ¬¡èšç±»`æ–¹æ³•ã€‚

å®ƒé¦–å…ˆæä¾›äº†`å±‚æ¬¡èšç±»`çš„æ¦‚è¿°ï¼Œç„¶åŽå¸¦ä½ ä¸€æ­¥æ­¥ä½¿ç”¨æµè¡Œçš„`Scipy`åº“åœ¨`Python`ä¸­å®žçŽ°å®ƒã€‚

# ä»€ä¹ˆæ˜¯å±‚æ¬¡èšç±»ï¼Ÿ

`å±‚æ¬¡èšç±»` æ˜¯ä¸€ç§å°†æ•°æ®åˆ†ç»„ä¸ºç§°ä¸ºæ ‘çŠ¶å›¾çš„ç°‡çš„æŠ€æœ¯ï¼Œè¡¨ç¤ºåº•å±‚ç°‡ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ã€‚

å±‚æ¬¡èšç±»ç®—æ³•ä¾èµ–äºŽè·ç¦»åº¦é‡æ¥å½¢æˆç°‡ï¼Œé€šå¸¸åŒ…æ‹¬ä»¥ä¸‹ä¸»è¦æ­¥éª¤ï¼š

![](img/d6e321eb7c440c1384628f5c89d3497b.png)

å±‚æ¬¡èšç±»çš„å››ä¸ªä¸»è¦æ­¥éª¤ï¼ˆå›¾ç‰‡ä½œè€…æä¾›ï¼‰

+   è®¡ç®—åŒ…å«æ¯å¯¹æ•°æ®ç‚¹ä¹‹é—´è·ç¦»çš„è·ç¦»çŸ©é˜µï¼Œä½¿ç”¨å¦‚æ¬§å‡ é‡Œå¾—è·ç¦»ã€æ›¼å“ˆé¡¿è·ç¦»æˆ–ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ç‰¹å®šè·ç¦»åº¦é‡

+   åˆå¹¶ä¸¤ä¸ªè·ç¦»æœ€è¿‘çš„ç°‡

+   æ›´æ–°è·ç¦»çŸ©é˜µä»¥è€ƒè™‘æ–°ç°‡ã€‚

+   é‡å¤æ­¥éª¤ 1ã€2 å’Œ 3ï¼Œç›´åˆ°æ‰€æœ‰ç°‡éƒ½åˆå¹¶åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå•ä¸€çš„ç°‡ã€‚

## å±‚æ¬¡èšç±»çš„ä¸€äº›å›¾å½¢ç¤ºä¾‹

åœ¨æ·±å…¥æŠ€æœ¯å®žçŽ°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬äº†è§£ä¸¤ç§ä¸»è¦çš„å±‚æ¬¡èšç±»æ–¹æ³•ï¼š`agglomerative` å’Œ `divisive` èšç±»ã€‚

**#1\. èšåˆèšç±»**

èšåˆèšç±»ä¹Ÿç§°ä¸ºè‡ªä¸‹è€Œä¸Šçš„æ–¹æ³•ï¼Œå®ƒå¼€å§‹æ—¶å°†æ¯ä¸ªæ•°æ®ç‚¹è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç°‡ã€‚ç„¶åŽï¼Œå®ƒåå¤åˆå¹¶è¿™äº›ç°‡ï¼Œç›´åˆ°åªå‰©ä¸‹ä¸€ä¸ªã€‚

è®©æˆ‘ä»¬è€ƒè™‘ä¸‹é¢çš„ç¤ºæ„å›¾ï¼Œå…¶ä¸­ï¼š

+   æˆ‘ä»¬å¼€å§‹æ—¶å°†æ¯ä¸ªåŠ¨ç‰©è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç°‡ã€‚

+   ç„¶åŽæ ¹æ®åŠ¨ç‰©åˆ—è¡¨ï¼Œæ ¹æ®å®ƒä»¬çš„ç›¸ä¼¼æ€§å½¢æˆä¸‰ä¸ªä¸åŒçš„ç°‡ï¼šé¹°å’Œå­”é›€è¢«åˆ†ç±»ä¸º `Birds`ï¼Œç‹®å­å’Œç†Šä¸º `Mammals`ï¼ŒèŽå­å’Œèœ˜è››ä¸º `3+ legs`ã€‚

+   æˆ‘ä»¬ç»§ç»­åˆå¹¶è¿‡ç¨‹ï¼Œé€šè¿‡å°†ä¸¤ä¸ªæœ€ç›¸ä¼¼çš„ç°‡ï¼š`Birds` å’Œ `Mammals` åˆå¹¶æ¥åˆ›å»º `Vertebrate` ç°‡ã€‚

+   æœ€åŽï¼Œå°†å‰©ä¸‹çš„ä¸¤ä¸ªç°‡ `Vertebrate` å’Œ `3+ legs` åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„ `Animals` ç°‡ã€‚

![](img/029c881105fbde19ccf0088559ef9b26.png)

èšåˆèšç±»çš„ç¤ºæ„å›¾ï¼ˆå›¾ç‰‡ç”±ä½œè€…æä¾›ï¼‰

**#2\. åˆ’åˆ†èšç±»**

å¦ä¸€æ–¹é¢ï¼Œåˆ’åˆ†å¼èšç±»æ˜¯è‡ªä¸Šè€Œä¸‹çš„ã€‚å®ƒä»Žå°†æ‰€æœ‰æ•°æ®ç‚¹è§†ä¸ºä¸€ä¸ªç»Ÿä¸€çš„ç°‡å¼€å§‹ï¼Œç„¶åŽé€æ¸å°†å…¶æ‹†åˆ†ï¼Œç›´åˆ°æ¯ä¸ªæ•°æ®ç‚¹æˆä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç°‡ã€‚

é€šè¿‡è§‚å¯Ÿåˆ’åˆ†æ–¹æ³•çš„å›¾å½¢ï¼š

+   æˆ‘ä»¬æ³¨æ„åˆ°æ•´ä¸ª `Animal` æ•°æ®é›†è¢«è§†ä¸ºä¸€ä¸ªç»Ÿä¸€çš„å—ã€‚

+   ç„¶åŽï¼Œè¿™ä¸ªå—è¢«æ‹†åˆ†æˆä¸¤ä¸ªä¸åŒçš„ç°‡ï¼š`Vertebrate` å’Œ `3+ legs`

+   åˆ’åˆ†è¿‡ç¨‹ä¼šåå¤åº”ç”¨äºŽå…ˆå‰åˆ›å»ºçš„ç°‡ï¼Œç›´åˆ°æ¯ä¸ªåŠ¨ç‰©è¢«åŒºåˆ†ä¸ºå…¶è‡ªèº«çš„ç‹¬ç‰¹ç°‡ã€‚

![](img/ca2bdae58ead8064830ae0555950cf0b.png)

åˆ’åˆ†èšç±»çš„ç¤ºæ„å›¾ï¼ˆå›¾ç‰‡ç”±ä½œè€…æä¾›ï¼‰

## é€‰æ‹©æ­£ç¡®çš„è·ç¦»åº¦é‡

é€‰æ‹©åˆé€‚çš„è·ç¦»åº¦é‡æ˜¯èšç±»ä¸­çš„å…³é”®æ­¥éª¤ï¼Œè¿™å–å†³äºŽå…·ä½“çš„é—®é¢˜ã€‚

ä¾‹å¦‚ï¼Œä¸€ç»„å­¦ç”Ÿå¯ä»¥æ ¹æ®ä»–ä»¬çš„åŽŸç±å›½ã€æ€§åˆ«æˆ–å…ˆå‰çš„å­¦æœ¯èƒŒæ™¯è¿›è¡Œèšç±»ã€‚è™½ç„¶è¿™äº›æ ‡å‡†éƒ½æ˜¯æœ‰æ•ˆçš„èšç±»ä¾æ®ï¼Œä½†å®ƒä»¬ä¼ è¾¾äº†ç‹¬ç‰¹çš„æ„ä¹‰ã€‚

æ¬§å‡ é‡Œå¾—è·ç¦»æ˜¯è®¸å¤šèšç±»è½¯ä»¶ä¸­æœ€å¸¸ç”¨çš„åº¦é‡ã€‚ç„¶è€Œï¼Œè¿˜å­˜åœ¨å…¶ä»–è·ç¦»åº¦é‡ï¼Œå¦‚æ›¼å“ˆé¡¿è·ç¦»ã€å ªåŸ¹æ‹‰è·ç¦»ã€çš®å°”é€Šç›¸å…³æ€§å’Œé—µå¯å¤«æ–¯åŸºè·ç¦»ã€‚

## å¦‚ä½•åœ¨åˆå¹¶ç°‡ä¹‹å‰æµ‹é‡å®ƒä»¬

èšç±»å¯èƒ½è¢«è®¤ä¸ºæ˜¯å°†æ•°æ®åˆ†ç»„çš„ç®€å•è¿‡ç¨‹ã€‚ä½†å®ƒä¸ä»…ä»…æ˜¯è¿™æ ·ã€‚

åœ¨åˆå¹¶ç°‡ä¹‹å‰ï¼Œæœ‰ä¸‰ç§ä¸»è¦çš„æ ‡å‡†æ–¹æ³•æ¥æµ‹é‡æœ€è¿‘çš„ä¸€å¯¹ç°‡ï¼š`(1) å•é“¾èšç±»`ï¼Œ`(2) å®Œå…¨é“¾èšç±»` å’Œ `(3) å¹³å‡é“¾èšç±»`ã€‚è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°æŽ¢è®¨æ¯ä¸€ç§ã€‚

**#1\. å•é“¾èšç±»**

åœ¨å•é“¾æŽ¥èšç±»ä¸­ï¼Œä¸¤ä¸ªç»™å®šç°‡ `**C1**` å’Œ `**C2**` ä¹‹é—´çš„è·ç¦»å¯¹åº”äºŽä¸¤ä¸ªç°‡ä¸­æ‰€æœ‰é¡¹å¯¹ä¹‹é—´çš„æœ€å°è·ç¦»ã€‚

![](img/e33f6383a4c9cde530f4dc66bf1135b8.png)

å•é“¾æŽ¥çš„è·ç¦»å…¬å¼ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰

åœ¨ä¸¤ä¸ªç°‡ä¸­çš„æ‰€æœ‰é¡¹å¯¹ä¸­ï¼Œ`**b**` å’Œ `**k**` å…·æœ‰æœ€å°è·ç¦»ã€‚

![](img/21d98b7d4045e12a19f634ea858f1024.png)

*å•é“¾æŽ¥ç¤ºæ„å›¾ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰*

**#2\. å®Œæ•´é“¾æŽ¥**

å¯¹äºŽå®Œæ•´é“¾æŽ¥èšç±»ï¼Œä¸¤ä¸ªç»™å®šç°‡ `**C1**` å’Œ `**C2**` ä¹‹é—´çš„è·ç¦»æ˜¯ä¸¤ä¸ªç°‡ä¸­æ‰€æœ‰é¡¹å¯¹ä¹‹é—´çš„æœ€å¤§è·ç¦»ã€‚

![](img/034cbf779a83262f179f03e9ca6ec438.png)

å•é“¾æŽ¥çš„è·ç¦»å…¬å¼ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰

åœ¨ä¸¤ä¸ªç°‡ä¸­çš„æ‰€æœ‰é¡¹å¯¹ä¸­ï¼Œç”¨ç»¿è‰²çªå‡ºæ˜¾ç¤ºçš„é¡¹ï¼ˆ`**f**` å’Œ `**m**`ï¼‰å…·æœ‰æœ€å¤§è·ç¦»ã€‚

![](img/8c4c45e3f50b77495dfe4e93857e9023.png)

*å®Œæ•´é“¾æŽ¥ç¤ºæ„å›¾ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰*

**#3\. å¹³å‡é“¾æŽ¥**

åœ¨å¹³å‡é“¾æŽ¥èšç±»ä¸­ï¼Œä¸¤ä¸ªç»™å®šç°‡ `**C1**` å’Œ `**C2**` ä¹‹é—´çš„è·ç¦»æ˜¯é€šè¿‡è®¡ç®—ä¸¤ä¸ªç°‡ä¸­æ¯å¯¹é¡¹ä¹‹é—´æ‰€æœ‰è·ç¦»çš„å¹³å‡å€¼æ¥å¾—åˆ°çš„ã€‚

![](img/f330b8ff9697d4976f3bd94d241a2d44.png)

å¹³å‡é“¾æŽ¥çš„è·ç¦»å…¬å¼ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰

![](img/c058c6dea29f61e257ed0c0bb594980b.png)

*å¹³å‡é“¾æŽ¥ç¤ºæ„å›¾ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰*

ä»Žä¸Šè¿°å…¬å¼å¯ä»¥è®¡ç®—å‡ºå¹³å‡è·ç¦»å¦‚ä¸‹ï¼š

![](img/96869318a79aec1b19cba846cfe567db.png)

å¹³å‡é“¾æŽ¥çš„è·ç¦»è®¡ç®—ï¼ˆå›¾åƒæ¥æºï¼šä½œè€…ï¼‰

# åœ¨ Python ä¸­å®žçŽ°å±‚æ¬¡èšç±»

çŽ°åœ¨ä½ å·²ç»ç†è§£äº†å±‚æ¬¡èšç±»çš„å·¥ä½œåŽŸç†ï¼Œè®©æˆ‘ä»¬æ·±å…¥æŽ¢è®¨ä½¿ç”¨ `Python` çš„æŠ€æœ¯å®žçŽ°ã€‚

æˆ‘ä»¬é¦–å…ˆé…ç½®çŽ¯å¢ƒï¼Œäº†è§£æ•°æ®åŠç›¸å…³é¢„å¤„ç†ä»»åŠ¡ï¼Œæœ€åŽåº”ç”¨èšç±»ã€‚

## é…ç½®çŽ¯å¢ƒ

`[Python](https://www.python.org/downloads/)` æ˜¯å¿…éœ€çš„ï¼Œå¹¶ä¸”éœ€è¦ä¸Žä»¥ä¸‹åº“ä¸€èµ·å®‰è£…ï¼š

+   `Pandas` ç”¨äºŽåŠ è½½æ•°æ®æ¡†

+   `Scikit-learn` ç”¨äºŽæ•°æ®å½’ä¸€åŒ–

+   `Seaborn å’Œ Matplotlib` ç”¨äºŽæ•°æ®å¯è§†åŒ–

+   `Scipy` ç”¨äºŽåº”ç”¨èšç±»

æ‰€æœ‰è¿™äº›åº“éƒ½é€šè¿‡ä»¥ä¸‹ `pip` å‘½ä»¤ä»Žä½ çš„ç¬”è®°æœ¬ä¸­å®‰è£…ï¼š

```py
%%bash
pip install scikit-learn
pip install pandas
pip install matplotlib seaborn
pip install scipy
```

æˆ‘ä»¬ä½¿ç”¨ `%%bash` è¯­å¥æ¥ä»£æ›¿é€ä¸ªå®‰è£…æ¯ä¸ªåº“çš„ `!pip [library]`ï¼Œä½¿å¾—ç¬”è®°æœ¬å•å…ƒè¢«è§†ä¸º shell å‘½ä»¤ï¼Œä»Žè€Œå¿½ç•¥ `!`ï¼Œä¾¿äºŽå®‰è£…ã€‚

## ç†è§£æ•°æ®

æˆ‘ä»¬ä½¿ç”¨äº†è‘¡è„ç‰™é“¶è¡Œæœºæž„çš„é“¶è¡Œè¥é”€æ´»åŠ¨ï¼ˆç”µè¯ï¼‰çš„æ•°æ®å­é›†ã€‚

è¯¥æ•°æ®é›†æ¥è‡ª [UCI](https://archive.ics.uci.edu/dataset/222/bank+marketing)ï¼Œå¹¶ä¸”æ ¹æ® [çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…](https://creativecommons.org/licenses/by/4.0/legalcode)ï¼ˆCC BY 4.0ï¼‰è®¸å¯è¯è¿›è¡ŒæŽˆæƒã€‚

ç”±äºŽæœ¬æ•™ç¨‹çš„æ— ç›‘ç£æ€§è´¨ï¼Œæˆ‘ä»¬åŽ»æŽ‰äº†ç›®æ ‡åˆ— `y`ï¼Œè¯¥åˆ—æŒ‡å®šå®¢æˆ·æ˜¯å¦è®¢é˜…äº†å®šæœŸå­˜æ¬¾ã€‚

ä½¿ç”¨ `head` å‡½æ•°ä»…è¿”å›žå‰äº”æ¡è®°å½•ï¼Œè¿™ä¸è¶³ä»¥æä¾›æœ‰å…³æ•°æ®ç»“æž„çš„è¶³å¤Ÿä¿¡æ¯ã€‚

```py
import pandas as pd

URL = "https://raw.githubusercontent.com/keitazoumana/Medium-Articles-Notebooks/main/data/bank.csv"
bank_data = pd.read_csv(URL, sep=";")
bank_data.head()
```

![](img/db9c933625656f134e39726a7d8c79ac.png)

*åŠ è½½æ•°æ®çš„å‰äº”è¡Œï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

ç„¶è€Œï¼Œå¦‚æžœæˆ‘ä»¬ä½¿ç”¨ `info` å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å¾—æœ‰å…³æ•°æ®é›†çš„æ›´è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š

+   æ€»æ¡ç›®æ•°ï¼ˆ4,521ï¼‰å’Œåˆ—æ•°ï¼ˆ17ï¼‰

+   æ¯åˆ—çš„åç§°åŠå…¶ç±»åž‹ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä¸»è¦æœ‰ä¸¤ç§åˆ—ç±»åž‹ï¼š`int64` å’Œ `object`

+   æ¯åˆ—ç¼ºå¤±å€¼çš„æ€»æ•°

```py
bank_data.info()
```

è¾“å‡ºï¼š

![](img/afb6cdf2e0c353909b4c9b9b84508124.png)

*å…³äºŽæ•°æ®çš„ä¿¡æ¯ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

## æ•°æ®é¢„å¤„ç†

æ•°æ®é¢„å¤„ç†æ˜¯æ¯ä¸ªæ•°æ®ç§‘å­¦ä»»åŠ¡ä¸­çš„ä¸»è¦æ­¥éª¤ï¼Œèšç±»ä¹Ÿä¸ä¾‹å¤–ã€‚å¯¹è¿™äº›æ•°æ®åº”ç”¨çš„ä¸»è¦ä»»åŠ¡åŒ…æ‹¬ï¼š

+   å¡«è¡¥ç¼ºå¤±å€¼çš„é€‚å½“ä¿¡æ¯

+   è§„èŒƒåŒ–åˆ—å€¼

+   æœ€åŽï¼Œåˆ é™¤ä¸ç›¸å…³çš„åˆ—

**#1\. å¤„ç†ç¼ºå¤±å€¼**

ç¼ºå¤±å€¼ä¼šä¸¥é‡å½±å“åˆ†æžçš„æ•´ä½“è´¨é‡ï¼Œå¯ä»¥åº”ç”¨å¤šé‡æ’è¡¥æŠ€æœ¯æ¥æœ‰æ•ˆè§£å†³è¿™äº›é—®é¢˜ã€‚

`percent_missing` æŠ¥å‘Šæ¯ä¸€åˆ—ä¸­ç¼ºå¤±å€¼çš„ç™¾åˆ†æ¯”ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæ•°æ®ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ã€‚

```py
percent_missing =round(100*(loan_data.isnull().sum())/len(loan_data),2)
percent_missing
```

è¾“å‡ºï¼š

![](img/d9dfec3912f70989d3fd142674190146.png)

*æ•°æ®ä¸­ç¼ºå¤±å€¼çš„ç™¾åˆ†æ¯”ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

**#2\. åˆ é™¤ä¸ç›¸å…³çš„åˆ—**

ä¿ç•™æ•°æ®é›†ä¸­ `object` åˆ—éœ€è¦æ›´å¤šå¤„ç†ä»»åŠ¡ï¼Œå¦‚ä½¿ç”¨ç›¸å…³ç¼–ç æŠ€æœ¯å°†åˆ†ç±»æ•°æ®ç¼–ç ä¸ºå…¶æ•°å€¼è¡¨ç¤ºã€‚

ä¸ºäº†ç®€åŒ–åˆ†æžï¼Œä»…ä½¿ç”¨ `int64`ï¼ˆæ•°å€¼åž‹ï¼‰åˆ—ã€‚ä½¿ç”¨ `select_dtypes` å‡½æ•°ï¼Œæˆ‘ä»¬é€‰æ‹©è¦ä¿ç•™çš„åˆ—ç±»åž‹ã€‚

```py
import numpy as np 

cleaned_data = bank_data.select_dtypes(include=[np.int64])
cleaned_data.info()
```

è¾“å‡ºï¼š

![](img/bb03f127706563e06a274d3ece499adc.png)

*åŽ»é™¤ä¸éœ€è¦çš„åˆ—çš„æ–°æ•°æ®ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

**#3\. åˆ†æžç¦»ç¾¤å€¼**

å±‚æ¬¡èšç±»çš„ä¸€ä¸ªæ˜¾è‘—ç¼ºç‚¹æ˜¯å¯¹ç¦»ç¾¤å€¼çš„æ•æ„Ÿæ€§ï¼Œè¿™å¯èƒ½ä¼šæ‰­æ›²æ•°æ®ç‚¹æˆ–èšç±»ä¹‹é—´çš„è·ç¦»è®¡ç®—ã€‚

ç¡®å®šè¿™äº›ç¦»ç¾¤å€¼çš„ç®€å•æ–¹æ³•æ˜¯åˆ†æžæ•°æ®çš„åˆ†å¸ƒï¼Œä½¿ç”¨ `boxplot` å¦‚ä¸‹æ‰€ç¤ºçš„ `show_boxplot` è¾…åŠ©å‡½æ•°ï¼Œå®ƒåˆ©ç”¨äº† `Seaborn` å†…ç½®çš„ `boxplot` å‡½æ•°ã€‚

```py
import matplotlib.pyplot as plt
import seaborn as sns
```

```py
def show_boxplot(df):
  plt.rcParams['figure.figsize'] = [14,6]
  sns.boxplot(data = df, orient="v")
  plt.title("Outliers Distribution", fontsize = 16)
  plt.ylabel("Range", fontweight = 'bold')
  plt.xlabel("Attributes", fontweight = 'bold')

show_boxplot(cleaned_data)
```

è¾“å‡ºï¼š

![](img/31df9d8434d876b8998f4bff505d2bea.png)

*æ•°æ®ä¸­æ‰€æœ‰å˜é‡çš„ç®±å½¢å›¾ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

`balance` å±žæ€§ä»£è¡¨å®¢æˆ·çš„å¹´å¹³å‡ä½™é¢ï¼Œæ˜¯å”¯ä¸€ä¸€ä¸ªä¸Žå…¶ä»–æ•°æ®ç‚¹ç›¸å·®è¾ƒè¿œçš„ã€‚

é€šè¿‡ä½¿ç”¨å››åˆ†ä½æ•°èŒƒå›´æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤æ‰€æœ‰è¶…å‡ºå››åˆ†ä½æ•°å®šä¹‰èŒƒå›´ `+/-1.5*IQR` çš„ç‚¹ï¼Œå…¶ä¸­ `IQR` æ˜¯ `å››åˆ†ä½æ•°èŒƒå›´`ã€‚

æ•´ä½“é€»è¾‘åœ¨ `remove_outliers` è¾…åŠ©å‡½æ•°ä¸­å®žçŽ°ã€‚

```py
def remove_outliers(data):

  df = data.copy()

  for col in list(df.columns):

        Q1 = df[str(col)].quantile(0.05)
        Q3 = df[str(col)].quantile(0.95)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5*IQR
        upper_bound = Q3 + 1.5*IQR

        df = df[(df[str(col)] >= lower_bound) & (df[str(col)] <= upper_bound)]

  return df
```

ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥å‡½æ•°åº”ç”¨äºŽæ•°æ®é›†ï¼Œå¹¶æ¯”è¾ƒæ–°ç®±åž‹å›¾ä¸ŽåŽ»é™¤å¼‚å¸¸å€¼å‰çš„ç®±åž‹å›¾ã€‚

```py
without_outliers = remove_outliers(cleaned_data)

# Display the new boxplot
show_boxplot(without_outliers)
```

è¾“å‡ºï¼š

![](img/70f2d6fa723355ee848c284f885ef4c5.png)

ä¸å†æœ‰æ•°æ®ç‚¹ä½äºŽå››åˆ†ä½æ•°èŒƒå›´ä¹‹å¤–ï¼ˆä½œè€…æä¾›çš„å›¾ç‰‡ï¼‰

```py
without_outliers.shape

# (4393, 7)
```

æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†ä¸€ä¸ª 4,393 è¡Œå’Œ 7 åˆ—çš„æ•°æ®é›†ï¼Œè¿™æ„å‘³ç€ä»Žæ•°æ®ä¸­å‰”é™¤çš„å‰©ä½™ 127 ä¸ªè§‚æµ‹å€¼æ˜¯å¼‚å¸¸å€¼ã€‚

**#4\. é‡æ–°ç¼©æ”¾æ•°æ®**

ç”±äºŽå±‚æ¬¡èšç±»ä½¿ç”¨çš„æ¬§å‡ é‡Œå¾—è·ç¦»å¯¹ä¸åŒå°ºåº¦çš„å˜é‡æ•æ„Ÿï¼Œå› æ­¤åœ¨è®¡ç®—è·ç¦»ä¹‹å‰æœ€å¥½é‡æ–°ç¼©æ”¾æ‰€æœ‰å˜é‡ã€‚

`StandardScaler`ç±»çš„`fit_transform`å‡½æ•°å°†åŽŸå§‹æ•°æ®è½¬æ¢ï¼Œä½¿æ¯åˆ—å…·æœ‰é›¶å‡å€¼å’Œå•ä½æ ‡å‡†å·®ã€‚

```py
from sklearn.preprocessing import StandardScaler

data_scaler = StandardScaler()

scaled_data = data_scaler.fit_transform(without_outliers)
scaled_data.shape

# (4393, 7)
```

æ•°æ®çš„å½¢çŠ¶ä¿æŒä¸å˜ï¼ˆ4,393 è¡Œå’Œ 7 åˆ—ï¼‰ï¼Œå› ä¸ºå½’ä¸€åŒ–ä¸ä¼šå½±å“æ•°æ®çš„å½¢çŠ¶ã€‚

## åº”ç”¨å±‚æ¬¡èšç±»ç®—æ³•

æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½æ·±å…¥æŽ¢è®¨èšç±»ç®—æ³•çš„å®žçŽ°ï¼

æ­¤é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šé‡‡ç”¨å“ªç§é“¾æŽ¥æ–¹æ³•ç”¨äºŽ`linkage()`å‡½æ•°çš„`method`å±žæ€§çš„èšç±»ã€‚

ä¸ä»…ä»…å…³æ³¨ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»æ¶µç›–æ‰€æœ‰ä¸‰ç§é“¾æŽ¥æŠ€æœ¯ã€‚

```py
from scipy.cluster.hierarchy import linkage, dendrogram

complete_clustering = linkage(scaled_data, method="complete", metric="euclidean")
average_clustering = linkage(scaled_data, method="average", metric="euclidean")
single_clustering = linkage(scaled_data, method="single", metric="euclidean")
```

è®¡ç®—å®Œæ‰€æœ‰ä¸‰ç§èšç±»æ–¹æ³•åŽï¼Œä½¿ç”¨`scipy.cluster`æ¨¡å—ä¸­çš„`dendogram`å‡½æ•°å’Œ`matplotlib`ä¸­çš„`pyplot`å‡½æ•°å¯è§†åŒ–ç›¸åº”çš„æ ‘çŠ¶å›¾ã€‚

æ¯ä¸ªæ ‘çŠ¶å›¾çš„ç»„ç»‡æ–¹å¼å¦‚ä¸‹ï¼š

+   `x è½´`ä»£è¡¨æ•°æ®ä¸­çš„èšç±»

+   `y è½´`å¯¹åº”æ ·æœ¬ä¹‹é—´çš„è·ç¦»ã€‚çº¿æ¡è¶Šé«˜ï¼Œèšç±»ä¹‹é—´çš„å·®å¼‚è¶Šå¤§

+   é€šè¿‡åœ¨è¯¥æœ€é«˜åž‚ç›´çº¿å¤„ç»˜åˆ¶ä¸€æ¡æ°´å¹³çº¿ï¼Œå¯ä»¥èŽ·å¾—é€‚å½“çš„èšç±»æ•°

+   ä¸Žæ°´å¹³çº¿çš„äº¤ç‚¹æ•°é‡å¯¹åº”äºŽèšç±»æ•°

```py
dendrogram(complete_clustering)
plt.show()
```

è¾“å‡ºï¼š

![](img/61cffad592b6a5825b5560ac02038ab6.png)

*å®Œæ•´èšç±»æ–¹æ³•çš„æ ‘çŠ¶å›¾ï¼ˆä½œè€…æä¾›çš„å›¾ç‰‡ï¼‰*

```py
dendrogram(average_clustering)
plt.show()
```

è¾“å‡ºï¼š

![](img/0cf8185d76703dda473b6b6539a4eb35.png)

*å¹³å‡èšç±»æ–¹æ³•çš„æ ‘çŠ¶å›¾ï¼ˆä½œè€…æä¾›çš„å›¾ç‰‡ï¼‰*

å½“è¿è¡Œ`å•ä¸€èšç±»`æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°`é€’å½’é™åˆ¶`é—®é¢˜ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨`setrecursionlimit`å‡½æ•°å¹¶è®¾ç½®è¶³å¤Ÿå¤§çš„å€¼æ¥è§£å†³ï¼š

```py
import sys
sys.setrecursionlimit(1000000)
```

çŽ°åœ¨æˆ‘ä»¬å±•ç¤ºæ ‘çŠ¶å›¾ï¼š

```py
dendrogram(single_clustering)
plt.show()
```

è¾“å‡ºï¼š

![](img/213dd0f2e473460ae94de48665c56713.png)

*å•ä¸€èšç±»æ–¹æ³•çš„æ ‘çŠ¶å›¾ï¼ˆä½œè€…æä¾›çš„å›¾ç‰‡ï¼‰*

## ç¡®å®šæ ‘çŠ¶å›¾ä¸­çš„æœ€ä½³èšç±»æ•°

é€šè¿‡è¯†åˆ«ä¸ä¸Žä»»ä½•å…¶ä»–èšç±»ï¼ˆæ°´å¹³çº¿ï¼‰äº¤å‰çš„æœ€é«˜åž‚ç›´çº¿ï¼Œå¯ä»¥èŽ·å¾—æœ€ä½³èšç±»æ•°ã€‚è¿™æ ·çš„ä¸€æ¡çº¿åœ¨ä¸‹é¢ç”¨çº¢åœˆå’Œç»¿å‹¾æ ‡è®°ã€‚

+   å¯¹äºŽå®Œæ•´é“¾æŽ¥æ³•ï¼šç”Ÿæˆçš„èšç±»æ•°æ²¡æœ‰æ˜¾è‘—çš„å˜åŒ–

![](img/145ed832d0138585ac979f80ab12393d.png)

*å®Œæ•´é“¾æŽ¥æ³•ï¼šä»Žæœ€é«˜è·ç¦»è€Œæ— äº¤é›†çš„æœ€ä½³èšç±»æ•°ï¼ˆä½œè€…æä¾›çš„å›¾ç‰‡ï¼‰*

+   å¯¹äºŽå¹³å‡é“¾æŽ¥æ³•ï¼šä¸¤æ¡æ°´å¹³æ©™çº¿ä¹‹é—´çš„å·®è·ç¨å¾®å¤šäºŽä¸€ä¸ªã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸¤ä¸ªç°‡ã€‚

![](img/4e8a50666bbedfea41365c83e549e923.png)

*å¹³å‡é“¾æŽ¥æ³•ï¼šä»Žæ²¡æœ‰äº¤é›†çš„æœ€å¤§è·ç¦»å¾—åˆ°çš„æœ€ä½³èšç±»æ•°ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

+   å¯¹äºŽå•é“¾æŽ¥æ³•ï¼šæ— æ³•ç¡®å®šæ˜Žç¡®çš„ç°‡æ•°

![](img/0509cb687acdb3b1d8f47e5b6580541c.png)

*å•é“¾æŽ¥æ³•ï¼šä»Žæ²¡æœ‰äº¤é›†çš„æœ€å¤§è·ç¦»å¾—åˆ°çš„æœ€ä½³èšç±»æ•°ï¼ˆä½œè€…æä¾›çš„å›¾åƒï¼‰*

æ ¹æ®ä¸Šè¿°åˆ†æžï¼Œå¹³å‡é“¾æŽ¥æ³•ä¼¼ä¹Žæ¯”å•é“¾æŽ¥æ³•å’Œå®Œå…¨é“¾æŽ¥æ³•æä¾›äº†æœ€ä½³çš„èšç±»æ•°ï¼Œå› ä¸ºåŽä¸¤è€…æ²¡æœ‰æä¾›æ¸…æ™°çš„èšç±»æ•°ç†è§£ã€‚

çŽ°åœ¨æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æœ€ä½³çš„ç°‡æ•°ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`cut_tree`å‡½æ•°åœ¨å®¢æˆ·çš„å¹³å‡å¹´ä½™é¢çš„èƒŒæ™¯ä¸‹è§£é‡Šè¿™äº›ç°‡ã€‚

```py
cluster_labels = cut_tree(average_clustering, n_clusters=2).reshape(-1, )
without_outliers["Cluster"] = cluster_labels

sns.boxplot(x='Cluster', y='balance', data=without_outliers)
```

![](img/9c1d9ed75b591101fab3fd7a540b561a.png)

ä¸¤ç§å€Ÿæ¬¾äººçš„ç®±çº¿å›¾ *(ä½œè€…æä¾›çš„å›¾åƒ)*

ä»Žä¸Šé¢çš„`boxplot`ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼š

+   æ¥è‡ªç°‡ 0 çš„å®¢æˆ·æ‹¥æœ‰æœ€é«˜çš„å¹³å‡å¹´ä½™é¢

+   æ¥è‡ªç°‡ 1 çš„å€Ÿæ¬¾äººå¹³å‡å¹´ä½™é¢ç›¸å¯¹è¾ƒä½Ž

# ç»“è®º

ç¥è´ºä½ ï¼ï¼ï¼ðŸŽ‰

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æä¾›äº†è¶³å¤Ÿçš„å·¥å…·ï¼Œå¸®åŠ©ä½ å°†çŸ¥è¯†æå‡åˆ°ä¸€ä¸ªæ–°æ°´å¹³ã€‚ä»£ç å¯ä»¥åœ¨æˆ‘çš„ [GitHub](https://github.com/keitazoumana/Medium-Articles-Notebooks/blob/main/Hierarchical_Clustering_Bank_Marketing.ipynb) ä¸Šæ‰¾åˆ°ã€‚

åŒæ—¶ï¼Œå¦‚æžœä½ å–œæ¬¢é˜…è¯»æˆ‘çš„æ–‡ç« å¹¶å¸Œæœ›æ”¯æŒæˆ‘çš„å†™ä½œï¼Œå¯ä»¥è€ƒè™‘æˆä¸º Medium çš„ä¼šå‘˜ã€‚æ¯æœˆä»…éœ€ 5 ç¾Žå…ƒï¼Œä½ å¯ä»¥æ— é™è®¿é—®æ•°åƒä¸ª Python æŒ‡å—å’Œæ•°æ®ç§‘å­¦æ–‡ç« ã€‚

é€šè¿‡ä½¿ç”¨ [æˆ‘çš„é“¾æŽ¥](https://zoumanakeita.medium.com/membership) æ³¨å†Œï¼Œæˆ‘å°†èŽ·å¾—ä¸€å°ç¬”ä½£é‡‘ï¼Œè€Œä½ ä¸éœ€è¦æ”¯ä»˜é¢å¤–è´¹ç”¨ã€‚

[](https://zoumanakeita.medium.com/membership?source=post_page-----ef897f52d1c5--------------------------------) [## é€šè¿‡æˆ‘çš„æŽ¨èé“¾æŽ¥åŠ å…¥ Medium - Zoumana Keita

### ä½œä¸º Medium çš„ä¼šå‘˜ï¼Œä½ çš„éƒ¨åˆ†ä¼šå‘˜è´¹ç”¨å°†ç›´æŽ¥æ”¯æŒä½ é˜…è¯»çš„ä½œè€…ï¼Œå¹¶ä¸”ä½ å¯ä»¥å®Œå…¨è®¿é—®æ¯ä¸€ä¸ªæ•…äº‹â€¦

[zoumanakeita.medium.com](https://zoumanakeita.medium.com/membership?source=post_page-----ef897f52d1c5--------------------------------)

æ¬¢è¿Žå…³æ³¨æˆ‘çš„ [YouTube](https://www.youtube.com/channel/UC9xKdy8cz6ZuJU5FTNtM_pQ)é¢‘é“ï¼Œæˆ–åœ¨ [LinkedIn](https://www.linkedin.com/in/zoumana-keita/)ä¸Šæ‰“ä¸ªæ‹›å‘¼ã€‚å¦‚æžœä½ éœ€è¦æ›´å¤šä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ [1 å¯¹ 1 è®¨è®º](https://topmate.io/zoumanakeita)ã€‚

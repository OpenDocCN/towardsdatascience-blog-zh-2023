# **ChatGPT 代码解释器：它如何节省了我几个小时的工作**

> 原文：[`towardsdatascience.com/chatgpt-code-interpreter-how-it-saved-me-hours-of-work-3c65a8dfa935`](https://towardsdatascience.com/chatgpt-code-interpreter-how-it-saved-me-hours-of-work-3c65a8dfa935)

## 用几句话创建一个国家人口的互动世界地图。

[](https://sonery.medium.com/?source=post_page-----3c65a8dfa935--------------------------------)![Soner Yıldırım](https://sonery.medium.com/?source=post_page-----3c65a8dfa935--------------------------------)[](https://towardsdatascience.com/?source=post_page-----3c65a8dfa935--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----3c65a8dfa935--------------------------------) [Soner Yıldırım](https://sonery.medium.com/?source=post_page-----3c65a8dfa935--------------------------------)

·发布在[Towards Data Science](https://towardsdatascience.com/?source=post_page-----3c65a8dfa935--------------------------------) ·6 分钟阅读·2023 年 7 月 9 日

--

![](img/2b19bb15e991fa804dc87657a1aedb63.png)

图片由[Arpit Rastogi](https://unsplash.com/@arptrastogi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)提供，来源于[Unsplash](https://unsplash.com/photos/xv7DTjnx2YQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

2023 年 7 月 6 日，OpenAI 宣布**代码解释器**将在接下来的一周内向 ChatGPT Plus 用户开放。这可能是增强 ChatGPT 功能和能力的所有插件中最出色的一种。

**代码解释器**运行代码并允许上传数据，以便你可以用于数据清理、分析、可视化以及许多其他功能。它就像是一个触手可及的数据分析师。

听起来很棒？那我们继续吧。

我在一个任务中使用了它，这个任务本来需要我花费几个小时才能完成。根据你的任务和对 Python 库的熟悉程度，这个任务可能需要更长的时间。

使用 ChatGPT，我只需写几句话并上传两个 CSV 文件。

我将一步一步带你了解这个过程，以及**代码解释器**在各种任务中的惊人表现，例如理解数据、清理和预处理数据，以及创建数据可视化。

## 你需要先启用它

为了在聊天中使用**代码解释器**，你需要先通过设置启用它。

![](img/b7d7607618e6ae97d7901dce463f225b.png)

如何启用**代码解释器**（图片由作者提供）

现在在你开始一个新聊天时就可以使用它了。

## 任务

我打算创建一个世界地图可视化，用点表示国家，点的大小与国家人口成比例。

我有两个数据集，一个用于国家人口，另一个用于经纬度位置。

你可以轻松地在网上找到这些数据集。如果找不到，我在我的[数据集](https://github.com/SonerYldrm/datasets)仓库中有它们。

你还可以将代码解释器用作你的[导师、同事或第二双眼睛。](https://sonery.medium.com/chatgpt-code-interpreter-your-mentor-coworker-and-second-pair-of-eyes-3a2995d0ea31)

[## ChatGPT Code Interpreter: Your Mentor, Coworker, and Second Pair of Eyes](https://sonery.medium.com/chatgpt-code-interpreter-your-mentor-coworker-and-second-pair-of-eyes-3a2995d0ea31?source=post_page-----3c65a8dfa935--------------------------------)

### 利用最新的 ChatGPT 插件。

[sonery.medium.com](https://sonery.medium.com/chatgpt-code-interpreter-your-mentor-coworker-and-second-pair-of-eyes-3a2995d0ea31?source=post_page-----3c65a8dfa935--------------------------------)

## 让我们开始吧……

由于这是一个简单的任务，我没有花费太多时间在提示工程上。以下是我向 ChatGPT 提出的请求的第一句：

![](img/bb60cb84e4cf65494f85b89d897c744a.png)

(图片来源：作者)

你可以使用提示窗口左侧的加号来上传数据集。

![](img/f0a1a3d47bee781efd200f7823b264d8.png)

使用 + 上传数据集（图片来源：作者）

它开始读取数据集，这是显而易见的事情。目前还不算令人印象深刻！

```py
# code generated by Code Interpreter
import pandas as pd

# Load the CSV data into a pandas DataFrame
population_data = pd.read_csv('/mnt/data/country_population_historic.csv')

# Display the first few rows of the DataFrame
population_data.head()
```

接着，ChatGPT 询问了国家位置：

![](img/64626e1ed6d3aa6d202ec779bdc50bd5.png)

(图片来源：作者)

我已经有了数据，所以我直接上传了：

![](img/12757cb1c6dbcdeb5308af1d4193f6ed.png)

(图片来源：作者)

```py
# code generated by Code Interpreter
# Load the country coordinates data
country_coordinates = pd.read_csv('/mnt/data/country_coordinates.csv')

# Display the first few rows
country_coordinates.head()
```

## 数据清理和预处理

读取数据后的下一步是清理和预处理数据。我相信你已经听到过很多次，这一步通常需要最多的时间。

在创建世界地图可视化之前，有几个问题需要处理。ChatGPT 发现了这些问题，并在不到一分钟的时间内提供了解决方案。非常令人印象深刻！

![](img/bf2e77a550f5ad9b9d7bb3052a31fece.png)

(图片来源：作者)

上述代码片段中的代码：

```py
# code generated by Code Interpreter
# Check if the country names are consistent across both dataframes
population_countries = set(population_data['Country Name'])
coordinates_countries = set(country_coordinates['name'])

# Countries in the population data but not in the coordinates data
missing_in_coordinates = population_countries - coordinates_countries

# Countries in the coordinates data but not in the population data
missing_in_population = coordinates_countries - population_countries
```

在坐标数据集中和人口数据集中都缺少一些国家。

ChatGPT 在上述代码片段中做了什么：

+   在两个数据集中创建国家名称的 Python 集合

+   分别比较它们以找出差异作为一个集合

ChatGPT 在不到一分钟的时间内解决了这个问题。

![](img/ca9a7887f80f244f2df5722c4a401b54.png)

上述代码片段中的代码：

```py
# code generated by Code Interpreter
# Mapping of country names from the population dataset to the coordinates dataset
country_name_mapping = {
    'Bahamas, The': 'Bahamas',
    'Brunei Darussalam': 'Brunei',
    'Cabo Verde': 'Cape Verde',
    'Congo, Dem. Rep.': 'Congo [DRC]',
    'Congo, Rep.': 'Congo [Republic]',
    "Cote d'Ivoire": "Côte d'Ivoire",
    'Czechia': 'Czech Republic',
    'Egypt, Arab Rep.': 'Egypt',
    'Gambia, The': 'Gambia',
    'Hong Kong SAR, China': 'Hong Kong',
    'Iran, Islamic Rep.': 'Iran',
    "Korea, Dem. People's Rep.": 'North Korea',
    'Korea, Rep.': 'South Korea',
    'Kyrgyz Republic': 'Kyrgyzstan',
    'Lao PDR': 'Laos',
    'Macao SAR, China': 'Macau',
    'Micronesia, Fed. Sts.': 'Micronesia',
    'Myanmar': 'Myanmar [Burma]',
    'North Macedonia': 'Macedonia [FYROM]',
    'Russian Federation': 'Russia',
    'Sao Tome and Principe': 'São Tomé and Príncipe',
    'Slovak Republic': 'Slovakia',
    'Syrian Arab Republic': 'Syria',
    'Turkiye': 'Turkey',
    'Venezuela, RB': 'Venezuela',
    'Yemen, Rep.': 'Yemen',
    'Eswatini': 'Swaziland'
}

# Clean the population dataset
population_data_clean = population_data.replace({"Country Name": country_name_mapping})

# Drop the rows that do not exist in the coordinates dataset
population_data_clean = population_data_clean[population_data_clean['Country Name'].isin(coordinates_countries)]

# Merge the population data with the country coordinates data
merged_data = pd.merge(population_data_clean, country_coordinates, left_on='Country Name', right_on='name')

# Keep only the necessary columns
merged_data = merged_data[['Country Name', '2022', 'latitude', 'longitude']]

# Rename the columns for clarity
merged_data.columns = ['Country', 'Population', 'Latitude', 'Longitude']

merged_data.head()
```

![](img/284174604d0e48c2dc54dfe17f42286d.png)

清理和预处理数据（图片来源：作者）

我们现在的数据格式整洁漂亮。这个步骤通常需要大量时间和人工努力。ChatGPT 只用了大约一分钟。

## 创建可视化

ChatGPT 首先尝试使用 Matplotlib 库进行操作。然而，由于缺少世界地图图像，它未能成功：

![](img/b8516b545cda4db247f70731946e1342.png)

(图片来源：作者)

然后，我简单地要求它使用 Plotly，这也是我一开始想到的。

![](img/5429bf44b386d7e03d68f82eee4c28a4.png)

（图片作者提供）

![](img/02ea920f2fa35ae744f9d7969f46a342.png)

（图片作者提供）

上述代码片段中的代码：

```py
# code generated by Code Interpreter
import plotly.graph_objects as go

# Create the scatter geo plot
fig = go.Figure(data=go.Scattergeo(
    lon = merged_data['Longitude'],
    lat = merged_data['Latitude'],
    text = merged_data['Country'] + ': ' + merged_data['Population'].astype(str),
    mode = 'markers',
    marker = dict(
        size = (merged_data['Population'] / 1000000) ** 0.5,  # Take square root to better visualize differences
        sizemode = 'diameter',
        sizeref = 1,
        sizemin = 4,
        color = merged_data['Population'],
        colorscale = 'Viridis',
        colorbar_title = "Millions",
    )
))

# Update the layout
fig.update_layout(
    title_text = '2022 World Population',
    geo = dict(
        showframe = False,
        showcoastlines = True,
        projection_type = 'equirectangular'
    )
)

fig.show()
```

它无法在浏览器中显示交互式世界地图，但成功编写了生成它的代码。我只需将代码复制并粘贴到 Jupyter notebook 中即可。

这里是最终结果：

![](img/88a3afd24c862f4563a83cfbf458602f.png)

国家人口的交互式世界地图（GIF 由作者提供）

## 最后的话

我们做了什么：

+   读取数据集

+   清理、预处理并合并它们

+   创建交互式数据可视化

我们只需写两个句子（加上告诉 ChatGPT 使用 Plotly）。我觉得这非常令人印象深刻！

我还创建了一个[仓库](https://github.com/SonerYldrm/world_map_of_country_populations)，其中包含一个 Jupyter notebook，里面有所有的代码片段和使用的数据集。随时下载并重新生成可视化。这也是数据清理的一个很好的实践。

*你可以成为一个* [*Medium 会员*](https://sonery.medium.com/membership) *以解锁对我所有写作的完整访问权限，以及 Medium 的其余内容。如果你已经是会员，别忘了* [*订阅*](https://sonery.medium.com/subscribe) *以便我每次发布新文章时收到邮件通知。*

感谢阅读。如果你有任何反馈，请告诉我。

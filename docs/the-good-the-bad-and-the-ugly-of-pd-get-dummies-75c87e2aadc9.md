# Pd.Get_Dummies çš„åˆ©ä¸å¼Š

> åŸæ–‡ï¼š[`towardsdatascience.com/the-good-the-bad-and-the-ugly-of-pd-get-dummies-75c87e2aadc9`](https://towardsdatascience.com/the-good-the-bad-and-the-ugly-of-pd-get-dummies-75c87e2aadc9)

## è¿™æ˜¯é’ˆå¯¹ pd.get_dummies çš„æ­»å¿ ç²‰

[](https://adamrossnelson.medium.com/?source=post_page-----75c87e2aadc9--------------------------------)![äºšå½“Â·ç½—æ–¯Â·å°¼å°”æ£®](https://adamrossnelson.medium.com/?source=post_page-----75c87e2aadc9--------------------------------)[](https://towardsdatascience.com/?source=post_page-----75c87e2aadc9--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----75c87e2aadc9--------------------------------) [äºšå½“Â·ç½—æ–¯Â·å°¼å°”æ£®](https://adamrossnelson.medium.com/?source=post_page-----75c87e2aadc9--------------------------------)

Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----75c87e2aadc9--------------------------------) Â·5 åˆ†é’Ÿé˜…è¯»Â·2023 å¹´ 7 æœˆ 26 æ—¥

--

å¤§å®¶å¥½ ğŸ¤ 

å¥½çš„ï¼Œæˆ‘æ˜ç™½äº†ã€‚åœ¨ Python ä¸­ï¼Œå°†åˆ†ç±»æ•°æ®è½¬æ¢ä¸ºè™šæ‹Ÿå˜é‡æ•°ç»„æœ€ç®€å•çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨ Pandas çš„ `pd.get_dummies()`ã€‚ä¸ºä»€ä¹ˆè¿˜è¦èŠ±æ—¶é—´å¯¼å…¥ `OneHotEncoder` ä» sklearnï¼Œæ‰§è¡Œ `.fit_transform()` ç­‰ç­‰ï¼ŸçœŸæ˜¯ç¹çï¼

è¿™ç¯‡æ–‡ç« é¦–å…ˆä»‹ç»ä¸€ä¸ªç®€å•çš„æ•°æ®é›†ï¼Œç”¨äºæ¼”ç¤ºç›®çš„ï¼Œå…¶ä¸­æµ‹è¯•é›†åŒ…å«åœ¨è®­ç»ƒé›†ä¸­æœªå‘ç°çš„åˆ†ç±»æ•°æ®ã€‚ç„¶åï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ `pd.get_dummies()` å¯èƒ½ä¼šå¯¼è‡´æ¼”ç¤ºæ•°æ®å‡ºç°é—®é¢˜ã€‚æœ€åï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ sklearn çš„ `OneHotEncoder` é¿å…è¿™ä¸ªé—®é¢˜ã€‚

![](img/fa8e91379f5a2edc4d962a235f228a29.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…åœ¨ Canva ä¸Šä½¿ç”¨æ–‡æœ¬åˆ°å›¾åƒçš„æ’å›¾ã€‚æç¤ºï¼šâ€œä¸‰åªç©¿ç€ä¹¡æ‘è¥¿éƒ¨ç‰›ä»”æœè£…çš„ç†ŠçŒ«ã€‚â€

# æ¼”ç¤ºç”¨çš„ç®€å•æ•°æ®é›†

è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªåä¸º OS çš„åˆ†ç±»ç‰¹å¾ã€‚OS åˆ—åˆ—å‡ºäº†è®¡ç®—æœºæ“ä½œç³»ç»Ÿã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›è™šæ‹Ÿæ•°æ®è¿›è¡Œæ¼”ç¤ºã€‚åœ¨ `train_df` ä¸­åŒ…å«è™šæ‹Ÿæ¼”ç¤ºè®­ç»ƒæ•°æ®ï¼Œè€Œåœ¨ `test_df` ä¸­åŒ…å«è™šæ‹Ÿæ¼”ç¤ºæµ‹è¯•æ•°æ®ã€‚

åœ¨æˆ‘ä»¬çš„è™šæ‹Ÿæ¼”ç¤ºæ¡ˆä¾‹ä¸­ï¼Œæµ‹è¯•é›†åŒ…å«åœ¨è®­ç»ƒé›†ä¸­ä¸å­˜åœ¨çš„åˆ†ç±»å€¼ã€‚è¿™ç§ä¸åŒ¹é…ä¼šå¯¼è‡´é—®é¢˜ã€‚

```py
import pandas as pd

train_df = pd.DataFrame({'OS': ['Windows', 'MacOS', 
                                'Linux', 'Windows', 'MacOS']})
test_df = pd.DataFrame({'OS': ['Windows', 'MacOS', 
                               'Android', 'Unix' 'iOS']})
```

åœ¨æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§æ“ä½œç³»ç»Ÿï¼šWindowsã€MacOS å’Œ Linuxã€‚ä½†åœ¨æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ä¸­ï¼Œè¿˜åŒ…æ‹¬ Androidã€Unix å’Œ iOS ç­‰é¢å¤–ç±»åˆ«ã€‚

ä½¿ç”¨ `pd.get_dummies(train_df)` æ‹Ÿåˆçš„æ¨¡å‹å°†æ— æ³•ä¸ `pd.get_dummies(test_df)` çš„æµ‹è¯•æ•°æ®ä¸€èµ·ä½¿ç”¨ã€‚ç»“æœå°†ä¸åŒ¹é…â€”â€”å› ä¸ºç±»åˆ«ä¸åŒ¹é…ã€‚

![](img/928ac32f04f9d59aa60f5d4c932fcc7f.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…åœ¨ Canva ä¸Šä½¿ç”¨ Canva åº“å›¾åƒåˆ›å»ºçš„æ’å›¾ã€‚è‰ºæœ¯ç”¨å“è™šæ‹Ÿæ¨¡å‹ã€‚

# Pd.get_dummies() çš„é—®é¢˜

å½“å°†`pd.get_dummies()`å‡½æ•°åº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†æ—¶ï¼Œä½ ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœã€‚

```py
train_encoded = pd.get_dummies(train_df, columns=['OS'])
test_encoded = pd.get_dummies(test_df, columns=['OS'])
```

å¦‚æœä½ è¯„ä¼°`train_encoded`å’Œ`test_encoded` DataFramesï¼Œä½ ä¼šæ³¨æ„åˆ°å®ƒä»¬çš„åˆ—æ•°ä¸åŒã€‚è¿™æ˜¯å› ä¸ºæµ‹è¯•é›†ä¸­ä»…å­˜åœ¨çš„'Android'ç±»åˆ«åœ¨`test_encoded`ä¸­åˆ›å»ºäº†ä¸€ä¸ªé¢å¤–çš„åˆ—ã€‚è¿™ç§è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ç‰¹å¾æ•°é‡çš„ä¸ä¸€è‡´å¯èƒ½åœ¨æ„å»ºå’Œè¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹æ—¶é€ æˆé‡å¤§é—®é¢˜ï¼Œå› ä¸ºè¿™äº›æ¨¡å‹æœŸæœ›ä¸¤ä¸ªæ•°æ®é›†ä¸­çš„ç‰¹å¾ç©ºé—´ç›¸åŒã€‚

![](img/380c309a5fac4b5da8a646a4858c2347.png)

å›¾ç‰‡æ¥æºï¼šä½œè€…çš„å±å¹•æˆªå›¾ï¼Œä½¿ç”¨æ­¤å¤„æ˜¾ç¤ºçš„ä»£ç ç”Ÿæˆã€‚

# ä½¿ç”¨ OneHotEncoder çš„è§£å†³æ–¹æ¡ˆ

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ sklearn çš„`OneHotEncoder`å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å½“ä½¿ç”¨`OneHotEncoder`æ—¶ï¼Œç¼–ç å™¨åœ¨è®­ç»ƒæ•°æ®çš„`.fit()`æˆ–`.fit_transform()`æ–¹æ³•æœŸé—´å­¦ä¹ ç±»åˆ«ã€‚ç„¶åï¼Œåœ¨`.transform()`æ–¹æ³•æœŸé—´ï¼Œå®ƒä¸ºæ‰€æœ‰å­¦ä¹ åˆ°çš„ç±»åˆ«åˆ›å»ºåˆ—ã€‚å¦‚æœåœ¨æµ‹è¯•æ•°æ®ä¸­å‘ç°äº†æ–°ç±»åˆ«ï¼Œåˆ™æœ‰ä¸¤ä¸ªé€‰é¡¹ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥å¿½ç•¥æ–°çš„æœªè§ç±»åˆ«ã€‚

```py
from sklearn.preprocessing import OneHotEncoder

encoder = OneHotEncoder(
    sparse_output=False, 
    handle_unknown='ignore').set_output(transform="pandas")

train_encoded = encoder.fit_transform(train_df[['OS']])
test_encoded = encoder.transform(test_df[['OS']])
```

æ³¨æ„ï¼Œæˆ‘ä»¬è®¾ç½®äº†`handle_unknown='ignore'`ä»¥å‘Šè¯‰ç¼–ç å™¨å¿½ç•¥ï¼ˆè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ï¼‰åœ¨æµ‹è¯•é›†ä¸­çœ‹åˆ°çš„ä½†åœ¨è®­ç»ƒé›†ä¸­æœªè§çš„ä»»ä½•ç±»åˆ«ã€‚

è¿˜è¦æ³¨æ„ï¼Œè‡ª 2023 å¹´èµ·ï¼Œsklearn æä¾›äº†`.set_output(transform="pandas")`é€‰é¡¹ï¼Œè¿™å°†ç¡®ä¿ç¼–ç å™¨è¿”å›ä¸€ä¸ª Pandas DataFrameï¼ˆå…·æœ‰æ›´æ˜“è¯»å’Œè§£é‡Šçš„åˆ—åï¼‰ï¼Œè€Œä¸æ˜¯æ›´ç®€æ´çš„ NumPy æ•°ç»„ã€‚

é€šè¿‡ä½¿ç”¨`handle_unknown='ignore'`å¤„ç†æœªçŸ¥ç±»åˆ«ï¼Œ`OneHotEncoder`ç¡®ä¿è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®å…·æœ‰ç›¸åŒçš„ç‰¹å¾ç©ºé—´ï¼Œæ— è®ºæµ‹è¯•æ•°æ®ä¸­å‡ºç°äº†ä»€ä¹ˆç±»åˆ«å€¼ã€‚

# OneHotEncoder çš„é™„åŠ å¥½å¤„

Sklearn çš„`OneHotEncoder`ä¸ä»…åœ¨å¤„ç†æµ‹è¯•æ•°æ®ä¸­æœªè§ç±»åˆ«æ—¶éå¸¸æœ‰ç”¨ï¼Œå®ƒè¿˜æä¾›äº†å…¶ä»–ä¸€äº›é™„åŠ åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½ä¹Ÿå¯èƒ½å¾ˆæœ‰ç”¨ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸¤ä¸ªé™„åŠ é€‰é¡¹åŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚

## min_frequency

`min_frequency`æ˜¯å¦ä¸€ä¸ªå¼ºå¤§çš„é€‰é¡¹ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šä¸€ä¸ªæœ€ä½é¢‘ç‡é˜ˆå€¼ã€‚é¢‘ç‡ä½äºæ­¤é˜ˆå€¼çš„ç±»åˆ«ä¼šè¢«é‡æ–°ç¼–ç ä¸ºâ€œç½•è§â€ã€‚è¿™åœ¨ä½ æœ‰ä¸€äº›åªå‡ºç°å‡ æ¬¡çš„ç±»åˆ«æ—¶éå¸¸æœ‰ç”¨ï¼Œè¿™äº›ç±»åˆ«å¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥å¸®åŠ©æ¨¡å‹ï¼Œå¯èƒ½ä¼šä½¿æ¨¡å‹å¤æ‚åŒ–ï¼Œå¢åŠ æ— ç”¨çš„ç‰¹å¾ï¼Œä»è€Œé™ä½æ€§èƒ½è€Œæ²¡æœ‰ä»»ä½•é¢„æµ‹ä»·å€¼ã€‚

è¿™æ˜¯å¦‚ä½•è®¾ç½®`min_frequency`ä¸º 2 çš„ï¼š

```py
encoder = OneHotEncoder(
    sparse_output=False, 
    handle_unknown='infrequent_if_exist').set_output(transform="pandas")
train_encoded = encoder.fit_transform(train_df[['OS']])
test_encoded = encoder.transform(test_df[['OS']])
```

## max_categories

å¦ä¸€ä¸ªæœ‰ç”¨çš„é€‰é¡¹æ˜¯`max_categories`ã€‚`max_categories`å‚æ•°å…è®¸ä½ é™åˆ¶è™šæ‹Ÿæ•°ç»„ä¸­çš„è¾“å‡ºåˆ—æ•°ã€‚ç¼–ç å™¨å°†é€‰æ‹©æœ€å¸¸è§çš„ç±»åˆ«è¿›è¡Œç¼–ç ã€‚

è¿™ä¸ªé€‰é¡¹åœ¨å¤„ç†å…·æœ‰è®¸å¤šç±»åˆ«çš„ç‰¹å¾æ—¶ç‰¹åˆ«æœ‰ç›Šï¼Œè¿™äº›ç‰¹å¾é€šå¸¸ä¼šå¯¼è‡´ç»´åº¦æ•°ç›®å¾ˆé«˜ã€‚è¿™å¯èƒ½ä¼šæ˜¾è‘—é™ä½è®­ç»ƒæ•ˆç‡ï¼ŒåŒæ—¶å¢åŠ æ¨¡å‹å¤æ‚æ€§ï¼Œå¹¶ä¸”å‡ ä¹æ²¡æœ‰æé«˜é¢„æµ‹èƒ½åŠ›çš„ä»·å€¼ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™å‡å°‘äº†æ•°æ®çš„ç»´åº¦ã€‚

è¿™æ˜¯é™åˆ¶ç¼–ç åˆ°å‰ 4 ä¸ªæœ€é¢‘ç¹ç±»åˆ«çš„æ–¹æ³•ï¼š

```py
encoder = OneHotEncoder(
    sparse_output=False, 
    handle_unknown='ignore', 
    max_categories=4).set_output(transform="pandas")

train_encoded = encoder.fit_transform(train_df[['OS']])
test_encoded = encoder.transform(test_df[['OS']])
```

# ç»“è®º

ä»æ›´å®è§‚çš„è§’åº¦æ¥çœ‹ï¼Œä½¿ç”¨`pd.get_dummies()`è€Œä¸æ˜¯çœŸæ­£çš„æ‹Ÿåˆå’Œè½¬æ¢è¿‡ç¨‹ï¼Œåœ¨æ•°æ®ç§‘å­¦é¢†åŸŸè¿˜æœ‰æ›´ä¸¥é‡çš„é”™è¯¯ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¸€ç›´åšæŒä½¿ç”¨`pd.get_dummies()`ï¼Œç°åœ¨ä½ å·²ç»äº†è§£äº†å®ƒçš„ä¼˜ç‚¹ã€ç¼ºç‚¹å’Œä¸è¶³â€”â€”é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åï¼Œä½ åº”è¯¥è€ƒè™‘è°ƒæ•´ä½ çš„åšæ³•ã€‚

è™½ç„¶`pd.get_dummies()`åœ¨ Python ä¸­åˆ›å»ºè™šæ‹Ÿå˜é‡æ˜¯å¿«é€Ÿä¸”ç®€ä¾¿çš„ï¼Œä½†å½“ä½ çš„æµ‹è¯•æ•°æ®åŒ…å«åœ¨è®­ç»ƒæ•°æ®ä¸­æœªè§è¿‡çš„ç±»åˆ«æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚å¦ä¸€æ–¹é¢ï¼Œsklearn çš„`OneHotEncoder`ä¼˜é›…åœ°å¤„ç†äº†è¿™ç§æƒ…å†µï¼Œç¡®ä¿äº†æ•°æ®é›†é—´ä¸€è‡´çš„ç‰¹å¾ç©ºé—´ã€‚å€¼å¾—å¤šå†™å‡ è¡Œä»£ç ï¼Œä»¥é¿å…æ½œåœ¨çš„é™·é˜±ã€‚

# æ„Ÿè°¢é˜…è¯»

ä½ å‡†å¤‡å¥½äº†è§£æ›´å¤šæ•°æ®ç§‘å­¦é¢†åŸŸçš„èŒä¸šäº†å—ï¼Ÿæˆ‘æä¾›ä¸€å¯¹ä¸€çš„èŒä¸šæŒ‡å¯¼ï¼Œå¹¶æœ‰æ¯å‘¨çš„ç”µå­é‚®ä»¶åˆ—è¡¨ï¼Œå¸®åŠ©æ•°æ®ä¸“ä¸šçš„æ±‚èŒè€…ã€‚[è”ç³»æˆ‘äº†è§£æ›´å¤š](https://coaching.adamrossnelson.com/)ã€‚

æ„Ÿè°¢é˜…è¯»ã€‚è¯·æŠŠä½ çš„æƒ³æ³•å’Œå»ºè®®å‘ç»™æˆ‘ã€‚ä½ å¯ä»¥åªæ˜¯è¯´å£°ä½ å¥½ã€‚å¦‚æœä½ çœŸçš„éœ€è¦å‘Šè¯‰æˆ‘å“ªé‡Œåšé”™äº†ï¼Œæˆ‘æœŸå¾…å¾ˆå¿«ä¸ä½ èŠèŠã€‚Twitter: [@adamrossnelson](https://twitter.com/adamrossnelson) LinkedIn: [Adam Ross Nelson](https://www.linkedin.com/in/arnelson/)ã€‚

- en: How Does the Uncertainty Principle Limit Time Series Analysis?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/how-does-the-uncertainty-principle-limit-time-series-analysis-c94c442ba953?source=collection_archive---------2-----------------------#2023-08-31](https://towardsdatascience.com/how-does-the-uncertainty-principle-limit-time-series-analysis-c94c442ba953?source=collection_archive---------2-----------------------#2023-08-31)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why we can’t extract precise time and frequency information from a time series
    mutually, and how wavelet analysis can tackle this limitation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@rodrigodamottacc?source=post_page-----c94c442ba953--------------------------------)[![Rodrigo
    da Motta C. Carvalho](../Images/ed77f9c38a0a40b3d3ec2c119a350bbb.png)](https://medium.com/@rodrigodamottacc?source=post_page-----c94c442ba953--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c94c442ba953--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c94c442ba953--------------------------------)
    [Rodrigo da Motta C. Carvalho](https://medium.com/@rodrigodamottacc?source=post_page-----c94c442ba953--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd17b17427c47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-does-the-uncertainty-principle-limit-time-series-analysis-c94c442ba953&user=Rodrigo+da+Motta+C.+Carvalho&userId=d17b17427c47&source=post_page-d17b17427c47----c94c442ba953---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----c94c442ba953--------------------------------)
    ·6 min read·Aug 31, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc94c442ba953&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-does-the-uncertainty-principle-limit-time-series-analysis-c94c442ba953&user=Rodrigo+da+Motta+C.+Carvalho&userId=d17b17427c47&source=-----c94c442ba953---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc94c442ba953&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-does-the-uncertainty-principle-limit-time-series-analysis-c94c442ba953&source=-----c94c442ba953---------------------bookmark_footer-----------)![](../Images/f598499ff3876f16e054b121077babb8.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Jamie Street](https://unsplash.com/@jamie452?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The connection between the Fourier Transform, Uncertainty Principle, and time
    series analysis unveils a fascinating interplay that shapes the extraction of
    simultaneous temporal and frequency information. To understand this relationship,
    it's important to first briefly understand what a Fourier Transform (FT) and the
    uncertainty principle are as a consequence. Then, we explore Wavelet Transform
    (WT) as a promising tool for this limitation, revealing specific frequency temporal
    occurrences with sufficient clarity.
  prefs: []
  type: TYPE_NORMAL
- en: 1.1 Fourier Transform
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The Fourier Transform (FT) serves as a mathematical bridge between the time
    and frequency domains of a function. An FT can be described as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4bf90da2fd330d15fda1260b8a0a9dad.png)'
  prefs: []
  type: TYPE_IMG
- en: I’m not going into detail in this integral, but the important part is that an
    **FT transforms the function *f(x)* to another function g*(ω)* in the frequency
    space.** Hold that information for later, it’s going to be important. (To better
    understand the FT I highly recommend the video from [3Blue1Brow](https://www.youtube.com/watch?v=spUNpyF58BY).)
  prefs: []
  type: TYPE_NORMAL
- en: 1.2 Uncertainty Principle as a Consequence of Fourier Transform
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In 1927 physicist Werner Heisenberg introduced what is probably one of the most
    famous concepts about quantum mechanics, the uncertainty principle [1]. **The
    principle is basically a theorem about Fourier Transforms**, when two functions
    are a Fourier Transform of one another, the uncertainty principle comes into play.
  prefs: []
  type: TYPE_NORMAL
- en: 'While we momentarily sidestep its intricate physics, consider just the essence:
    **the product of uncertainties in *position* *x* and *momentum p* remains bounded.**
    This limitation underscores the inherent boundary in measuring these quantities
    with infinite precision (if you’re interested check out this [video](https://www.youtube.com/watch?v=a8FTr2qMutA)).'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/900ab9b23c2af9f7219e9ab3abfffb6b.png)'
  prefs: []
  type: TYPE_IMG
- en: Uncertainty Principle in the context of Physics.
  prefs: []
  type: TYPE_NORMAL
- en: '**This happens because position and momentum are a Fourier Transform of each
    other!** In the case of time series analysis, the analogue of *position* ***x***and
    momentum ***p*** is the time series in temporal ***t*** and frequency ***ω***
    space, respectively.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b82832e03ca8365856e0f84b676cfb0f.png)'
  prefs: []
  type: TYPE_IMG
- en: Uncertainty Principle in the context of signal processing.
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Conjuring Frequencies with FT in Time Series
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A very important application of the Fourier Transform is in time series analysis.
    Consider a scenario where we need to find the inherent frequencies in the time
    series. For instance, think about discerning the prevalent frequencies that people
    re-watch a given content. Therefore, we want to **transform *f(t) (a time series)*
    into g(*ω*), a function of the frequencies, using an FT**.
  prefs: []
  type: TYPE_NORMAL
- en: 2.1 Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To exemplify let's use the Mauna Loa Weekly Atmospheric CO2 Dataset [2].
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/050388b44bde5d1995b6332b94e9d3d7.png)'
  prefs: []
  type: TYPE_IMG
- en: Mauna Loa Weekly Atmospheric CO2 time series. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Removing the linear trend to remove fake low-frequency contributions:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2d6577a47b9676c5d90e42c44954ab50.png)'
  prefs: []
  type: TYPE_IMG
- en: Time series detrended. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Using the Fast Fourier Transform algorithm (FFT) to calculate the FT:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fa78c9c1a4517c90a27bd2a91059b2aa.png)'
  prefs: []
  type: TYPE_IMG
- en: Fourier Transform of the time series. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Whence, it’s possible to obtain the frequency that composes the series, and
    in this case are visible two distinct peaks, one yearly and the other half-yearly.
    This is a visualization of the clear seasonality of the dataset.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, the most interesting aspects happen when there is a perturbation in
    the time series, which could be the impact of an event or an external variable
    (e.g. a near volcano eruption). To simulate this we can take the same series plus
    a stochastic sine addition:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f49dae0bb49eeed7541656edca19a89f.png)'
  prefs: []
  type: TYPE_IMG
- en: Mauna Loa Weekly Atmospheric CO2 detrended time series plus a perturbation.
    Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying the FFT to get the FT of the series:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cef7a1f66b39659b5fc107ba1c10f718.png)'
  prefs: []
  type: TYPE_IMG
- en: Fourier transform of the perturbed time series. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Now, there is another set of peaks between 0.5 and 0.75 that is caused by the
    perturbation.
  prefs: []
  type: TYPE_NORMAL
- en: 2.2 The limitation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: At times, we want to know when the perturbation and frequency change happened,
    or simply the temporal placement of each frequency within the series. In our simulation
    o the series with and without perturbation, it's clear that most of the impact
    is at the beginning of the series. **Yet, a visual inspection of the series combined
    with FT information is not enough to know where that perturbation happened. Therefore,
    we need to find another tool to help us.**
  prefs: []
  type: TYPE_NORMAL
- en: '**However, the Fourier Transform (FT) comes with a trade-off: it strips away
    temporal information as the uncertainty principle shows, rendering us unaware
    of when these frequencies manifest in the series.** This is where the uncertainty
    principle steps in. Instead of pursuing infinite accuracy in either frequency
    or time, we can harness the uncertainty principle, allowing us to gain insights
    into both quantities at a reduced resolution, all the while maintaining balance.'
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Wavelet Transform as a tool for Time and Frequency trade-off
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**The Wavelet Transform (WT) emerges as a resolution balancing act, which transforms
    our function *f(t)* in *F(t,ω)*,a composition of time and frequency.** I''m not
    going into detail about how WT works, but, to summarize, the transformation process
    uses a series of different wavelets (signals with known frequency and shape) to
    match temporal synchronization with the time series by dot products of two functions.
    Hence, it''s possible to get a sense of the frequency and temporal occurrence
    but limited by less resolution in both quantities.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/74e71c18079e59e40a890bd5e8cb0e71.png)'
  prefs: []
  type: TYPE_IMG
- en: Example of a morlet wavelet signal (it's a complex signal, hence, there is an
    imaginary and real part). Image of the author.
  prefs: []
  type: TYPE_NORMAL
- en: To visualize the wavelet transform of a signal, it's common to represent the
    x-axis as the time scale and y-axis as the frequency scale, and the colour scale
    as the Power of the frequency.
  prefs: []
  type: TYPE_NORMAL
- en: For the detrended time series without perturbation,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e3d99cbb4a6d894e0d7aaab138857132.png)'
  prefs: []
  type: TYPE_IMG
- en: Wavelet Transform of the Mauna Loa Weekly Atmospheric CO2 time series. Image
    by the author.
  prefs: []
  type: TYPE_NORMAL
- en: it’s possible to see clearly that the seasonality repeats over the years as
    we expected by visual inspection. But the huge peak of 1-year seasonality from
    the FT is now wider, so our certainty about the value decreased.
  prefs: []
  type: TYPE_NORMAL
- en: The most interesting analysis is for the simulated scenario.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/786492f03a58acbbbd260ece4979f91a.png)'
  prefs: []
  type: TYPE_IMG
- en: Wavelet Transform of the perturbed time series. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: The WT show that the lower frequency perturbation observed in the FT happens
    in the early years of the series, with significant consequences after 20–25 years.
    **Even though the WT lose resolution both in time and frequency, the new information
    about the frequency occurrence is valuable and capable of answering a variety
    of questions.**
  prefs: []
  type: TYPE_NORMAL
- en: 4\. Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In short, the Uncertainty Principle imposes a fundamental limitation on time
    series analysis, as revealed by the constraints of the Fourier Transform. While
    the Fourier Transform efficiently extracts frequency information from time series
    data, it sacrifices any knowledge of when those frequencies occur. Therefore,
    the Wavelet Transform is a useful tool that enables us to trade off time and frequency
    resolution to gain insights into the temporal occurrence of frequency components
    accepting a degree of uncertainty inherent to the principle.
  prefs: []
  type: TYPE_NORMAL
- en: Acknowledgements
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This amazing video from [**Artem Kirsanov**](https://www.youtube.com/watch?v=jnxqHcObNK4)inspired
    me to do this article. If you do want to go further on this topic I also recommend
    watching the video.
  prefs: []
  type: TYPE_NORMAL
- en: Remarks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Fourier Transform (FT) is super important not only for quantum mechanics
    and time series analysis. It's also being used at this exact moment to store this
    article's data in a cloud service. One of the most famous and used algorithms
    in history is called Fast Fourier Transform (FFT) and it’s behind basically every
    data compression nowadays.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To model the nature of subatomic particles characteristic mathematically a Fourier
    Transform appears naturally in quantum mechanics. Reflecting in a fundamental
    shift of perspective that the uncertainty principle brings to our understanding
    of nature. Measuring the position of a particle makes you lose information about
    the velocity of that same particle, and vice-versa.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The notebook for this article is available** [**here**](https://github.com/Rodrigo-Motta/wavelet_analysis/tree/main)**.**'
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] [https://en.wikipedia.org/wiki/Uncertainty_principle](https://en.wikipedia.org/wiki/Uncertainty_principle)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] [https://www.statsmodels.org/dev/datasets/generated/co2.html](https://www.statsmodels.org/dev/datasets/generated/co2.html)
    (public domain)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] [Wavelet transform (Wikipedia)](https://en.wikipedia.org/wiki/Wavelet_transform)'
  prefs: []
  type: TYPE_NORMAL

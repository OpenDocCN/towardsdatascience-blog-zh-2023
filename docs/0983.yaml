- en: Make your sklearn models up to 100 times faster
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/make-your-sklearn-models-up-to-100-times-faster-563bb682665e?source=collection_archive---------5-----------------------#2023-03-16](https://towardsdatascience.com/make-your-sklearn-models-up-to-100-times-faster-563bb682665e?source=collection_archive---------5-----------------------#2023-03-16)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How to considerable reduce training time changing only 1 line of code
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://tvdboom.medium.com/?source=post_page-----563bb682665e--------------------------------)[![Marco
    vd Boom](../Images/3fc053efda1c23dd84a6418ded2603ca.png)](https://tvdboom.medium.com/?source=post_page-----563bb682665e--------------------------------)[](https://towardsdatascience.com/?source=post_page-----563bb682665e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----563bb682665e--------------------------------)
    [Marco vd Boom](https://tvdboom.medium.com/?source=post_page-----563bb682665e--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2091b627921&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-sklearn-models-up-to-100-times-faster-563bb682665e&user=Marco+vd+Boom&userId=e2091b627921&source=post_page-e2091b627921----563bb682665e---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----563bb682665e--------------------------------)
    ·4 min read·Mar 16, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F563bb682665e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-sklearn-models-up-to-100-times-faster-563bb682665e&user=Marco+vd+Boom&userId=e2091b627921&source=-----563bb682665e---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F563bb682665e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-sklearn-models-up-to-100-times-faster-563bb682665e&source=-----563bb682665e---------------------bookmark_footer-----------)![](../Images/049ac26c14904f369766d5570268cd8c.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Markus Winkler](https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With the [Intel® Extension for Scikit-learn](https://intel.github.io/scikit-learn-intelex/index.html)
    package (or *sklearnex,* for brevity) you can accelerate sklearn models and transformers,
    keeping full conformance with sklearn’s API. Sklearnex is a free software AI accelerator
    that offers you a way to make sklearn code 10–100 times faster.
  prefs: []
  type: TYPE_NORMAL
- en: The software acceleration is achieved through the use of vector instructions,
    IA hardware-specific memory optimizations, threading, and optimizations for all
    upcoming Intel platforms at launch time.
  prefs: []
  type: TYPE_NORMAL
- en: In this story, we’ll explain how to use the [ATOM](https://github.com/tvdboom/ATOM)
    library to leverage the speed of sklearnex. ATOM is an open-source Python package
    designed to help data scientists with the exploration of machine learning pipelines.
    Read [this other story](/atom-a-python-package-for-fast-exploration-of-machine-learning-pipelines-653956a16e7b)
    if you want a gentle introduction to the library.
  prefs: []
  type: TYPE_NORMAL
- en: Hardware requirements
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Additional hardware requirements for sklearnex to take into account:'
  prefs: []
  type: TYPE_NORMAL
- en: The processor must have x86 architecture.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The processor must support at least one of SSE2, AVX, AVX2, AVX512 instruction
    sets.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ARM* architecture is **not** supported.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Intel® processors provide better performance than other CPUs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Note:** sklearnex and ATOM are also capable of acceleration through GPU,
    but we won’t discuss that option this story. For now, let’s focus on CPU acceleration.'
  prefs: []
  type: TYPE_NORMAL
- en: Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s walk you through an example to understand how to get started. We initialize
    *atom* the usual way, and specify the `engine` parameter. The engine parameter
    stipulates which library to use for the models. The options are:'
  prefs: []
  type: TYPE_NORMAL
- en: sklearn (default)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: sklearnex (our choice for this story)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: cuml (for GPU acceleration)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/122bd0d4ac298fef38faa1889e35a4bd.png)'
  prefs: []
  type: TYPE_IMG
- en: Next, call the `[run](https://tvdboom.github.io/ATOM/latest/API/ATOM/atomclassifier/#atomclassifier-run)`
    method to train a model. See [here](https://tvdboom.github.io/ATOM/latest/user_guide/accelerating/#supported-estimators)
    a list of models that support sklearnex acceleration.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/4dfc7c88fb7d0ef335d1a4cd32fff020.png)'
  prefs: []
  type: TYPE_IMG
- en: It took 1.7 seconds to train and validate the model. Note how the model is from
    [daal4py](https://intelpython.github.io/daal4py/). This library is the backend
    engine for sklearnex.
  prefs: []
  type: TYPE_NORMAL
- en: For comparison purposes, let’s train also another Random Forest model, but now
    on sklearn instead of sklearnex. We can specify the `engine` parameter also directly
    on the `run` method.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/d0b15fb128a2977cf48c741a8253c264.png)'
  prefs: []
  type: TYPE_IMG
- en: This time it took 1.5 min instead of merely seconds! The former model is almost
    60 times faster, and it even performs slightly better on the test set.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s visualize the results.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: It’s importance to note that there are no big differences between the models,
    both in terms of performance and in the logic used by the model to make its predictions.
    The latter statement can be visualized with a [feature importance plot](https://tvdboom.github.io/ATOM/latest/API/plots/plot_feature_importance/#plot_feature_importance)
    (where features have similar importance) and a comparison of [shap decision plots](https://tvdboom.github.io/ATOM/latest/API/plots/plot_shap_decision/#prediction-plots)
    (where the decision patterns match).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/c57976f628ab16193fdc7cea61bee7d0.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/c3cb039bb688bfb08001c53c39a6db55.png)'
  prefs: []
  type: TYPE_IMG
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We have learned how to easily speed up the training of your sklearn models using
    the ATOM library. The acceleration is achieved on CPU. How to do this on GPU is
    the scope of a future story, so stay tuned.
  prefs: []
  type: TYPE_NORMAL
- en: For further information about ATOM, have a look at the package’s [documentation](https://tvdboom.github.io/ATOM/).
    For bugs or feature requests, don’t hesitate to open an issue on [GitHub](https://github.com/tvdboom/ATOM)
    or send me an email.
  prefs: []
  type: TYPE_NORMAL
- en: 'Related stories:'
  prefs: []
  type: TYPE_NORMAL
- en: '[atom-a-python-package-for-fast-exploration-of-machine-learning-pipelines](/atom-a-python-package-for-fast-exploration-of-machine-learning-pipelines-653956a16e7b)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[how-to-test-multiple-machine-learning-pipelines-with-just-a-few-lines-of-python](/how-to-test-multiple-machine-learning-pipelines-with-just-a-few-lines-of-python-1a16cb4686d)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[from-raw-data-to-web-app-deployment-with-atom-and-streamlit](/from-raw-data-to-web-app-deployment-with-atom-and-streamlit-d8df381aa19f)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[exploration-of-deep-learning-pipelines-made-easy](/exploration-of-deep-learning-pipelines-made-easy-e1cf649892bc)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[deep-feature-synthesis-vs-genetic-feature-generation](/deep-feature-synthesis-vs-genetic-feature-generation-6ba4d05a6ca5)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[from-raw-text-to-model-prediction-in-under-30-lines-of-python](/from-raw-text-to-model-prediction-in-under-30-lines-of-python-32133d853407)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[how-to-make-40-interactive-plots-to-analyze-your-machine-learning-pipeline](/how-to-make-40-interactive-plots-to-analyze-your-machine-learning-pipeline-ee718afd7bc2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[machine-learning-on-multioutput-datasets-a-quick-guide](/machine-learning-on-multioutput-datasets-a-quick-guide-ebeba81b97d1)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[using-mlflow-with-atom-to-track-all-your-machine-learning-experiments-without-additional-code](https://medium.com/towards-data-science/using-mlflow-with-atom-to-track-all-your-machine-learning-experiments-without-additional-code-583128687d45)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'References:'
  prefs: []
  type: TYPE_NORMAL
- en: All plots and images (except the featured image) are created by the author.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

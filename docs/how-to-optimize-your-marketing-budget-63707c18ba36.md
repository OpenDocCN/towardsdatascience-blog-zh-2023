# å¦‚ä½•ä¼˜åŒ–ä½ çš„è¥é”€é¢„ç®—

> åŸæ–‡ï¼š[`towardsdatascience.com/how-to-optimize-your-marketing-budget-63707c18ba36`](https://towardsdatascience.com/how-to-optimize-your-marketing-budget-63707c18ba36)

## [è¥é”€åˆ†æ](https://medium.com/tag/marketing-analytics)

## æ˜¯æ—¶å€™æ”¶è·ä½ è¾›è‹¦çš„è¥é”€ç»„åˆæ¨¡å‹è®­ç»ƒæˆæœäº†ï¼

[](https://dr-robert-kuebler.medium.com/?source=post_page-----63707c18ba36--------------------------------)![Dr. Robert KÃ¼bler](https://dr-robert-kuebler.medium.com/?source=post_page-----63707c18ba36--------------------------------)[](https://towardsdatascience.com/?source=post_page-----63707c18ba36--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----63707c18ba36--------------------------------) [Dr. Robert KÃ¼bler](https://dr-robert-kuebler.medium.com/?source=post_page-----63707c18ba36--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----63707c18ba36--------------------------------) Â·é˜…è¯»æ—¶é—´ 11 åˆ†é’Ÿ Â·2023 å¹´ 7 æœˆ 3 æ—¥

--

![](img/d591a198d3af1704d0affe022ea503b5.png)

å›¾ç‰‡ç”± DALL-E åˆ›å»ºã€‚

è¥é”€ç»„åˆæ¨¡å‹æ˜¯ç†è§£ä¸åŒè¥é”€æ¸ é“å¯¹é”€å”®å½±å“çš„å¼ºå¤§å·¥å…·ã€‚é€šè¿‡æ„å»ºè¥é”€ç»„åˆæ¨¡å‹ï¼Œè¥é”€äººå‘˜å¯ä»¥é‡åŒ–æ¯ä¸ªæ¸ é“å¯¹æ•´ä½“é”€å”®çš„è´¡çŒ®ï¼Œç„¶ååˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥ä¼˜åŒ–é¢„ç®—åˆ†é…ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»å†™äº†ä¸€æ•´ç³»åˆ—å…³äº [**æ„å»º** è¥é”€ç»„åˆæ¨¡å‹](https://kuebler.ai/list/marketing-mix-modeling-cc3268801754) çš„æ–‡ç« ï¼Œä½†æˆ‘ä»æ¬ ä½ ä¸€ç¯‡å…³äºå¦‚ä½•ä½¿ç”¨è¿™äº›æ¨¡å‹æ¥ä¼˜åŒ–åª’ä½“æ”¯å‡ºçš„æ–‡ç« ã€‚ä»Šå¤©æ˜¯ä½ çš„å¹¸è¿æ—¥ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼

![](img/301f2f390f4783a046362ae4ce16ac23.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¦‚æœä½ å¯¹è¥é”€ç»„åˆå»ºæ¨¡ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥ä»æˆ‘çš„ä»‹ç»æ–‡ç« å¼€å§‹ï¼š

[](/introduction-to-marketing-mix-modeling-in-python-d0dd81f4e794?source=post_page-----63707c18ba36--------------------------------) ## Python ä¸­çš„è¥é”€ç»„åˆå»ºæ¨¡ç®€ä»‹

### å“ªäº›å¹¿å‘Šæ”¯å‡ºçœŸæ­£æ¨åŠ¨äº†ä½ çš„é”€å”®ï¼Ÿ

towardsdatascience.com

# å‰ææ¡ä»¶

åœ¨æˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ä»»ä½•ä¸œè¥¿ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆæ„å»ºä¸€ä¸ªæ¨¡å‹ã€‚æˆ‘ä»¬å°†éå¸¸å¿«é€Ÿåœ°å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œä»¥ä¾¿å°½å¿«è¿›å…¥æœ¬æ–‡çš„ä¸»è¦éƒ¨åˆ†ã€‚

## æ•°æ®

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åŠ è½½ä¸€äº›æ•°æ®ã€‚æˆ‘å°†ä½¿ç”¨ä¸æˆ‘æ—§æ–‡ç« ä¸­ç›¸åŒçš„æ•°æ®é›†ã€‚

```py
import pandas as pd
from sklearn.model_selection import cross_val_score, TimeSeriesSplit

data = pd.read_csv(
    'https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv',
    parse_dates=['Date'],
    index_col='Date'
)

X = data.drop(columns=['Sales'])
y = data['Sales']
```

æ•°æ®é›†å¦‚ä¸‹æ‰€ç¤ºï¼š

![](img/24c7ab64e15add9ff0d1613d885153a7.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™ä¸ªè¡¨æ ¼çš„é€»è¾‘å¦‚ä¸‹ï¼šå‡è®¾ä½ åœ¨ä¸€å®¶é”€å”®æŸç§äº§å“çš„å…¬å¸å·¥ä½œã€‚ä½ å¯ä»¥åœ¨â€œ**é”€å”®**â€åˆ—ä¸­çœ‹åˆ°è¯¥äº§å“çš„æ¯å‘¨é”€å”®æƒ…å†µã€‚ä¸ºäº†æå‡è¿™äº›é”€å”®ï¼Œä½ åœ¨å¹¿å‘Šä¸ŠèŠ±äº†ä¸€äº›é’±ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­åŒ…æ‹¬ **ç”µè§†**ã€**å¹¿æ’­** å’Œ **æ¨ªå¹…** å¹¿å‘Šã€‚æˆ‘ä»¬ç°åœ¨æƒ³é€šè¿‡å¹¿å‘Šæ”¯å‡ºå’Œæ›´å¤šçš„*æ§åˆ¶å˜é‡*æ¥å»ºæ¨¡é”€å”®æƒ…å†µï¼Œä¾‹å¦‚å·¥ä½œæ—¥ã€æœˆä»½ã€äº§å“ä»·æ ¼ã€å¤©æ°”ç­‰ã€‚

![](img/32f1a68a3513553c78f8f5ebf94160f8.png)

ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚

## æ¨¡å‹

å»ºç«‹å¤æ‚çš„æ¨¡å‹ï¼Œå¦‚ XGBoost æˆ–æ·±åº¦ç¥ç»ç½‘ç»œï¼Œéš¾ä»¥è§£é‡Šå’Œä¼˜åŒ–ã€‚æˆ‘ä»¬è½¬å‘ä¸€ç§ç»è¿‡éªŒè¯çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨å¯è§£é‡Šçš„æ»åæ•ˆåº”å’Œé¥±å’Œåº¦æ•ˆåº”æ¥å»ºç«‹å¹¿ä¹‰åŠ æ€§æ¨¡å‹ï¼Œå¦‚è¿™é‡Œæ‰€åšçš„ï¼š

![](img/c03a53a00fe537940285ec6153e3e608.png)

ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚

æ»åæ•ˆåº”å’Œé¥±å’Œåº¦æ¨¡å—æ˜¯ç›´è§‚çš„ç‰¹å¾è½¬æ¢ï¼š

+   **æ»åæ•ˆåº”**æ¨¡å‹è¡¨ç¤ºæŸä¸ªæ—¶é—´ *t* çš„åª’ä½“æ”¯å‡ºå¯èƒ½ä»ç„¶ä¼šå½±å“æ—¶é—´ *t* + 1ã€*t* + 2 ç­‰çš„é”€å”®ï¼Œæˆ–åä¹‹ï¼Œå³åœ¨æ—¶é—´ *t* è§‚å¯Ÿåˆ°çš„é”€å”®ä¹Ÿå—åˆ°æ—¶é—´ *t* - 1ã€*t* - 2 ç­‰çš„æ”¯å‡ºçš„å½±å“ã€‚

+   **é¥±å’Œåº¦** æ¨¡å‹æ˜¾ç¤ºæ”¶ç›Šé€’å‡çš„æ•ˆåº”ï¼Œä¾‹å¦‚ï¼Œå°†ä½ åœ¨ä¸€ä¸ªæ¸ é“çš„æ”¯å‡ºä» 0 æ¬§å…ƒå¢åŠ åˆ° 100,000 æ¬§å…ƒä¼šæœ‰å¾ˆå¤§çš„å½±å“ï¼Œä½†å°†æ”¯å‡ºä» 1,000,000,000 å¢åŠ åˆ° 1,000,100,000 å°±ä¸ä¼šæœ‰å¤ªå¤§å½±å“äº†ã€‚

> ***æ³¨æ„ï¼š*** *åœ¨å›¾ç¤ºä¸­ï¼Œæ§åˆ¶å˜é‡è¢«çœç•¥äº†ã€‚è¿™æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å®ƒä»¬æ¥è¿›è¡Œä¼˜åŒ–â€”â€”æˆ‘ä»¬æ— æ³•åƒæŠ•å…¥åˆ°åª’ä½“æ¸ é“ä¸­çš„èµ„é‡‘é‚£æ ·æ”¹å˜å®ƒä»¬ã€‚æˆ‘ä»¬* ***å¯ä»¥*** *æ”¹å˜çš„å”¯ä¸€æ§åˆ¶å˜é‡æ˜¯ä»·æ ¼ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾ä»·æ ¼æ˜¯å¸¸é‡ï¼Œæˆ‘ä»¬åªå¸Œæœ›ä¼˜åŒ–æˆ‘ä»¬çš„åª’ä½“æ”¯å‡ºã€‚*

æ‰€ä»¥ï¼Œæ¨¡å‹çš„å½¢å¼æ˜¯

![](img/4b51a35e328a1e4efc3821a4157cc826.png)

ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚

å¯¹äºä¸€äº›å°šæœªå®šä¹‰çš„å‡½æ•° **é¥±å’Œåº¦** å’Œ **æ»åæ•ˆåº”**ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾

![](img/6891575de9e0d6382feeaea5ccf10fe7.png)

ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚

å’Œ

![](img/5cc9a7612fbeb9e3172a64cc7b906e97.png)

ä½œè€…æä¾›çš„å›¾ç‰‡ã€‚

*Î²* æ˜¯é¥±å’Œåº¦ç³»æ•°ï¼Œ*Î»* æ˜¯æ»åæ•ˆåº”å¼ºåº¦ï¼Œ*â„“* æ˜¯æ»åæ•ˆåº”é•¿åº¦ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¿™äº›å‚æ•°è§†ä¸ºè¶…å‚æ•°ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨è´å¶æ–¯æ–¹æ³•å¹¶å°†å…¶è§†ä¸ºå¸¸è§„çš„å¯å­¦ä¹ å‚æ•°æ¥å­¦ä¹ è¿™äº›å‚æ•°ã€‚åœ¨æˆ‘ä¹‹å‰å…³äºè¥é”€ç»„åˆå»ºæ¨¡çš„æ‰€æœ‰æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº†å¦‚ä½•è·å¾—è¿™äº›å‚æ•°ï¼Œå› æ­¤åœ¨æ­¤æˆ‘å°†ä¸å†æ·±å…¥æ¢è®¨ã€‚

ç›¸åï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰äº†è¿™äº›æ•°å­—ï¼Œå¹¶å¸Œæœ›ç”¨å®ƒä»¬æ¥åˆ›å»ºä¸€ä¸ªä¼˜åŒ–çš„åª’ä½“é¢„ç®—åˆ†é…è®¡åˆ’ã€‚

# åª’ä½“é¢„ç®—ä¼˜åŒ–

å‡è®¾æˆ‘ä»¬ä¹‹å‰çš„è¥é”€ç»„åˆå»ºæ¨¡å°è¯•ç»™æˆ‘ä»¬ç•™ä¸‹äº†ä»¥ä¸‹å‚æ•°ï¼š

```py
N = 200 # number of observations

# previous marketing mix modeling has given us these parameters
tv_coef = 10000       # Î±
tv_lags = 4           # â„“
tv_carryover = 0.5    # Î»
tv_saturation = 0.002 # Î²

radio_coef = 8000
radio_lags = 2
radio_carryover = 0.2
radio_saturation = 0.0001

banners_coef = 14000
banners_lags = 0
banners_carryover = 0.2
banners_saturation = 0.001
```

æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨ numpy åœ¨ Python ä¸­é‡æ–°æ„å»ºè¥é”€ç»„åˆæ¨¡å‹ã€‚

> ä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä»¬å·²ç»ä½¿ç”¨äº† scikit-learn æˆ– PyMC æ„å»ºäº†æ¨¡å‹ï¼éš¾é“ä¸èƒ½é‡ç”¨è¿™äº›æ¨¡å‹å—ï¼Ÿ

å¥½é—®é¢˜ï¼æˆ‘ä»¬*å¯ä»¥*ä½¿ç”¨æˆ‘ä»¬é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œå¹¶å°†å…¶äº¤ç»™ä¸€ä¸ªé€šç”¨ä¼˜åŒ–ç®—æ³•ï¼Œè¯•å›¾æ‰¾åˆ°æœ€å¤§åŒ–é”€å”®çš„åª’ä½“æ”¯å‡ºè¾“å…¥ã€‚ç„¶è€Œï¼Œè¿™è¢«ç§°ä¸º**é»‘ç®±ä¼˜åŒ–**ï¼Œå®ƒçš„é—®é¢˜åœ¨äºå®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜è€Œä¸æ˜¯æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚

é»‘ç®±ä¼˜åŒ–çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ç®—æ³•é€šå¸¸æœ‰å„ç§å‚æ•°ï¼Œä½ éœ€è¦è°ƒæ•´è¿™äº›å‚æ•°æ¥æ‰¾åˆ°ä¸€ä¸ªå¥½çš„ï¼ˆä½†å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼‰è§£å†³æ–¹æ¡ˆã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰äº›äººè¯´è¿™ç§ä¼˜åŒ–æ›´åƒæ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œè€Œä¸æ˜¯ç§‘å­¦ã€‚

## å‡¸æ€§æ¥æ‹¯æ•‘

å¦‚æœæˆ‘ä»¬èƒ½å°†é—®é¢˜è¡¨è¿°ä¸º**å‡¸ä¼˜åŒ–é—®é¢˜**ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¸å¦‚[cvxpy](https://www.cvxpy.org/)ä¹‹ç±»çš„åº“æ¥è§£å†³ï¼Œå®ƒä»¬**ä¿è¯**èƒ½æ‰¾åˆ°æœ€ä½³çš„åª’ä½“é¢„ç®—åˆ†é…ã€‚æˆ‘å·²ç»åœ¨[è¿™é‡Œ](https://medium.com/towards-data-science/introduction-to-linear-programming-b6647d20d5f6)ä½¿ç”¨äº†è¿™ä¸ªåº“æ¥è§£å†³å¦ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ã€‚

ä¸ºäº†ä½¿ç”¨å‡¸ä¼˜åŒ–æ–¹æ³•ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¿…é¡»æ˜¯å‡¸çš„**æˆ–å‡¹çš„**ï¼Œè¿™æ„å‘³ç€åœ¨æ¨¡å‹å‰é¢åŠ ä¸Šè´Ÿå·ä½¿å…¶æˆä¸ºå‡¸çš„ã€‚

![](img/794f1d794c83d050fe1f203412d4311a.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„æ¨¡å‹æ˜¯*y* = *x*Â²ï¼Œå®ƒå°†æ˜¯ä¸€ä¸ªå®¹æ˜“æœ€å°åŒ–çš„å‡¹å‡½æ•°ã€‚*y* = 100 - *x*Â²å°†æ˜¯ä¸€ä¸ªå®¹æ˜“æœ€å¤§åŒ–çš„å‡¹æ¨¡å‹ã€‚

æˆ‘ä¸ä¼šè¿›ä¸€æ­¥è¯¦ç»†è¯´æ˜ï¼›åªéœ€çŸ¥é“**æˆ‘ä»¬çš„æ¨¡å‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡¹å‡½æ•°**ï¼åœ¨æˆ‘ä»¬åˆ›å»ºçš„æ¨¡å‹è¿‡æ¸¡é¥±å’Œæ¨¡å‹ä¸­ï¼Œå¦‚æœé¥±å’Œå‡½æ•°çš„äºŒé˜¶å¯¼æ•°ä¸ºè´Ÿï¼Œé‚£ä¹ˆæ¨¡å‹å°±æ˜¯å‡¹çš„ã€‚

![](img/98bb1b16ee41681693e187f5bfc37034.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å…¶ä»–é¥±å’Œå‡½æ•°ï¼Œå¦‚ Adbudg æˆ–å…¶ä»–å…¸å‹çš„ S å‹å‡½æ•°ï¼Œå®ƒä»¬å¯èƒ½æ—¢ä¸æ˜¯å‡¹çš„ä¹Ÿä¸æ˜¯å‡¸çš„ï¼Œè¿™ä½¿å¾—ä¼˜åŒ–å˜å¾—æ›´åŠ å›°éš¾ã€‚

![](img/93c58294240fb77ab36095b71959fcb5.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¥½çš„ï¼Œç†è®ºè¯´å¤Ÿäº†ã€‚ç°åœ¨åªéœ€è®°ä½ï¼Œæˆ‘ä»¬çš„æ¨¡å‹æ˜¯**å‡¹çš„**ï¼Œè¿™å¾ˆå¥½ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ï¼Œå³èƒ½å¤Ÿå¸¦æ¥æœ€å¤§é”€å”®é¢çš„é¢„ç®—åˆ†é…ã€‚

## åœ¨ Numpy ä¸­é‡æ–°å®ç°æˆ‘ä»¬çš„æ¨¡å‹

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å¤„ç†è¿‡æ¸¡æ•ˆåº”çš„çŸ©é˜µã€‚

```py
import numpy as np

tv_carryover_matrix = sum([np.diag(tv_carryover**i*np.ones(N-i), k=-i) for i in range(tv_lags)])
radio_carryover_matrix = sum([np.diag(radio_carryover**i*np.ones(N-i), k=-i) for i in range(radio_lags)])
banners_carryover_matrix = np.eye(N)
```

æˆ‘çŸ¥é“è¿™å¾ˆéš¾ç†è§£ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›çŸ©é˜µä¸­çš„ä¸€ä¸ªã€‚

![](img/3616eca2b6c43641ff02e1d43fbcef23.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™å®ç°äº†ä¸€ä¸ªå¼ºåº¦ä¸º 0.2ã€é•¿åº¦ä¸º 1 çš„è¿‡æ¸¡æ•ˆæœã€‚å¦‚æœå°†è¿™ä¸ªçŸ©é˜µä¸æ”¯å‡ºå‘é‡ç›¸ä¹˜ï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚

![](img/4141fda8f28c4d3ccdd183e6c844974b.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¤„ç†å®Œè¿™äº›ä¹‹åï¼Œè®©æˆ‘ä»¬ç»§ç»­è°ˆè°ˆé¥±å’Œåº¦ã€‚è¿™åªæ˜¯ä¸€ä¸ªæ¶‰åŠ`exp`çš„ç®€å•å…¬å¼ï¼Œæ‰€ä»¥æ²¡é—®é¢˜ã€‚

æˆ‘ä»¬å¯ä»¥å†™ï¼š

```py
sales = (
    tv_coef * np.sum(1 - np.exp(-tv_saturation * tv_carryover_matrix @ data["TV"])) 
    + radio_coef * np.sum(1 - np.exp(-radio_saturation * radio_carryover_matrix @ data["Radio"])) 
    + banners_coef * np.sum(1 - np.exp(-banners_saturation * banners_carryover_matrix @ data["Banners"]))
)
```

è¿™ç»™å‡ºäº†**æ¥è‡ªæˆ‘ä»¬çš„è¥é”€æ´»åŠ¨**çš„é”€å”®æ€»é¢ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œå¿½ç•¥äº†æ§åˆ¶å˜é‡ã€‚è¿™ä¸ªæ•°å­—æ˜¯ 3,584,648.73 â‚¬ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³é€šè¿‡æ”¹å˜æˆ‘ä»¬çš„åª’ä½“æ”¯å‡ºå°†å…¶å¢åŠ ï¼å‰§é€ï¼šäº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥**å°†è¿™ä¸ªæ•°å­—å¢åŠ çº¦ 150 ä¸‡ï¼Œè¾¾åˆ° 5,054,070.21 â‚¬**ã€‚å“‡ï¼ä»…ä»…è°ƒæ•´ä¸€äº›æ•°å­—å°±èƒ½å¾—åˆ°è¿™æ ·çš„ç»“æœï¼ŒçœŸä¸é”™ã€‚

![](img/08b72a924611ccf4b624d43cf8b50b31.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

## å…³äºç»“æœ

ä½ è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„æ¨¡å¼ã€‚

> çœ‹èµ·æ¥ï¼Œå‡ç­‰åˆ†é…é¢„ç®—æ˜¯æœ€ä½³é€‰æ‹©ã€‚

åªæœ‰ç¬¬ä¸€æœŸçš„æ”¯å‡ºç¨é«˜ï¼Œä½†éšåä¼šæœ‰æ‰€å¹³è¡¡ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„æ¨¡å‹çš„å·¥ä½œåŸç†ï¼šåœ¨ç¬¬ä¸€æœŸï¼Œæ²¡æœ‰å¹¿å‘Šå­˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å¤šæŠ•èµ„ä¸€äº›æ¥æ¨åŠ¨é”€å”®ã€‚è‡ªç¬¬äºŒæœŸå¼€å§‹ï¼Œæˆ‘ä»¬åªéœ€åœ¨æ¨¡å‹ä¸­æŠ•å…¥è¶³å¤Ÿçš„é‡‘é¢æ¥ä¿æŒå¹¿å‘Šå­˜é‡é«˜ï¼Œä½†åˆä¸èƒ½è¿‡é«˜ä»¥å…é¥±å’Œã€‚åœ¨æœ€åä¸€æœŸï¼Œå¹¿å‘Šå­˜é‡ä¸å†é‡è¦ï¼Œå› ä¸ºæ—¶é—´åˆ°é‚£é‡Œç»“æŸï¼Œå°±æ¨¡å‹è€Œè¨€ã€‚å› æ­¤ï¼Œä¼˜åŒ–é¢„ç®—åœ¨é‚£é‡Œè¾ƒä½ã€‚

## åœ¨ CVXPY ä¸­é‡æ–°å®ç°æˆ‘ä»¬çš„æ¨¡å‹

å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨ cvxpy å¾—åˆ°é‚£ä¸ªæœ€ä½³è§£ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡ï¼Œåœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œæ¯ä¸ªæ¸ é“å’Œæ¯ä¸ªæ—¶é—´æ­¥é•¿ä¸€ä¸ªï¼Œå› æ­¤æ€»å…±æœ‰ 3**N* = 3*200 = 600 ä¸ªå˜é‡ã€‚

å¦‚æœæ²¡æœ‰å…¶ä»–å› ç´ ï¼Œæœ€ä¼˜è§£å°†æ˜¯å°†æ‰€æœ‰å˜é‡è®¾ä¸ºæ— ç©·å¤§ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€äº›çº¦æŸã€‚å˜é‡åº”è¯¥éƒ½æ˜¯

1.  éè´Ÿçš„ï¼Œä»¥åŠ

1.  æˆ‘ä»¬å¸Œæœ›è¿™ 600 ä¸ªå˜é‡çš„æ€»å’Œå°äºæˆ–ç­‰äºæˆ‘ä»¬å†å²ä¸Šæ”¯å‡ºçš„é‡‘é¢ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¸Œæœ›ä¼˜åŒ–ä½¿ç”¨ numpy å‡½æ•°å®ç°çš„æ¨¡å‹ï¼Œä½†ä½¿ç”¨å…¶ cvxpy ç­‰æ•ˆå‡½æ•°ï¼Œè¿™é€šå¸¸æ„å‘³ç€ç¼–å†™`cp`è€Œä¸æ˜¯`np`ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥é‡ç”¨ä¹‹å‰çš„ carryover çŸ©é˜µï¼

```py
import cvxpy as cp

original_total_spends = data[["TV", "Radio", "Banners"]].sum().sum()

# declaring variables to be optimized, N=200 per channel
tv = cp.Variable(N)
radio = cp.Variable(N)
banners = cp.Variable(N)

# the constraints, positive spends and a bounded total budget
constraints = [
    tv >= 0,
    radio >= 0,
    banners >= 0,
    cp.sum(tv + radio + banners) <= original_total_spends,
]

# cvxpy formulation, the model looks like the numpy version
problem = cp.Problem(
    cp.Maximize(
        tv_coef * cp.sum(1 - cp.exp(-tv_saturation * tv_carryover_matrix @ tv)) \
        + radio_coef * cp.sum(1 - cp.exp(-radio_saturation * radio_carryover_matrix @ radio)) \
        + banners_coef * cp.sum(1 - cp.exp(-banners_saturation * banners_carryover_matrix @ banners))
    ), # like the numpy model, sum of all sales
    constraints
)
```

æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨**éå¸¸çŸ­çš„æ—¶é—´**å†…è§£å†³è¿™ä¸ªæœ€å¤§åŒ–é—®é¢˜

```py
problem.solve()

# Output:
# 5054070.207463957
```

å¤ªå¥½äº†ï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡`tv.value, radio.value, banners.value`è·å¾—æœ€ä½³é¢„ç®—ã€‚ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ¸ é“çš„æ”¯å‡ºåœ¨æ¯å‘¨éƒ½ä¿æŒç›¸å¯¹ç¨³å®šï¼Œè¿™å¯èƒ½æ²¡æœ‰é¢„æœŸçš„é‚£ä¹ˆæœ‰è¶£ã€‚ä½†æœ€ä½³å°±æ˜¯æœ€ä½³ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å—å®ƒã€‚

> æˆ‘ä»¬æœ¬æ¥å¯ä»¥åœ¨è¿‡å»è·å¾— 500 ä¸‡ï¼Œè€Œä¸æ˜¯ 360 ä¸‡ã€‚è™½ç„¶çŸ¥é“è¿™ä¸€ç‚¹å¾ˆä¸é”™ï¼Œä½†ç°åœ¨å·²ç»æ²¡æœ‰ä»·å€¼ï¼Œå¯èƒ½è¿˜ä¼šè®©ä¸šåŠ¡æ„Ÿåˆ°ä¸å¿«ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥åˆ©ç”¨è¿™ä¸ªé€»è¾‘æ¥ä¼˜åŒ–æœªæ¥çš„è¥é”€æ”¯å‡ºï¼

## è¿›ä¸€æ­¥çš„çº¦æŸ

å°±è¿™æ ·ï¼Œä½ ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªåŸºæœ¬çš„é¢„ç®—ä¼˜åŒ–å·¥å…·ï¼å¥½çš„ä¸€éƒ¨åˆ†æ˜¯ï¼Œä½ å¯ä»¥å»ºæ¨¡æ›´å¤šå¯èƒ½æ¥è‡ªä¸šåŠ¡çš„çº¦æŸã€‚ä¾‹å¦‚ï¼Œä¸šåŠ¡å¯èƒ½ä¼šè¯´å¹¿æ’­æ€»æ”¯å‡ºç›¸å½“é«˜ï¼š

```py
sum(radio.value)

# Output: 
# 524290.3686626207 (= 524,290.37 â‚¬)
```

ä¸šåŠ¡å¸Œæœ›å…¶ä½äº 300,000 â‚¬ï¼Œå‡ºäºæ¨¡å‹æ— æ³•çŸ¥æ™“çš„æˆ˜ç•¥åŸå› ã€‚å¥½çš„ï¼Œæ²¡é—®é¢˜ï¼Œè®©æˆ‘ä»¬å°†å…¶åŠ å…¥çº¦æŸé›†ï¼

```py
constraints = [
    tv >= 0,
    radio >= 0,
    banners >= 0,
    cp.sum(tv + radio + banners) <= original_total_spends,
    cp.sum(radio) <= 300000 # new constraint
]
```

å°±è¿™ä¹ˆç®€å•ã€‚æˆ‘ä»¬å¯ä»¥è®©ä¼˜åŒ–å†æ¬¡è¿è¡Œï¼Œæœ€ç»ˆå¾—åˆ°ç•¥å¾®å‡å°‘çš„ä¼˜åŒ–é”€å”®é¢ä¸º 4,990,178.80 â‚¬ã€‚ä½†å¦‚æœæˆ‘ä»¬ç°åœ¨æ£€æŸ¥å¹¿æ’­æ”¯å‡ºçš„æ€»å’Œ

```py
sum(radio.value)

# Output: 
# 299999.9992275703
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å•†ä¸šçº¦æŸå¾—åˆ°äº†å°Šé‡ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ æ›´å¤šçš„çº¦æŸï¼Œæ¯”å¦‚

+   ä¸¤ä¸ªé¢‘é“çš„æ€»å’Œåº”è¯¥å°äºæˆ–å¤§äºæŸä¸ªæ•°å­—ï¼Œæˆ–è€…

+   åœ¨æŸäº›å‘¨ï¼Œæˆ‘ä»¬ä¸å…è®¸ä»»ä½•åª’ä½“æ”¯å‡ºã€‚

ä½ åªéœ€ä½¿ç”¨ä¸€äº›æ€»å’Œå’Œç­‰å¼æˆ–ä¸ç­‰å¼æ¥å»ºæ¨¡å³å¯ã€‚

# ç»“è®º

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå›é¡¾äº†å¸‚åœºè¥é”€æ··åˆæ¨¡å‹çš„å…¬å¼ã€‚è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦é‡æ–°å®ç°è¿™äº›æ¨¡å‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„æ¨¡å‹ç®€å•ä¸”æ˜“äºè§£é‡Šï¼Œè¿™å®Œå…¨ä¸æ˜¯é—®é¢˜ã€‚

æˆ‘ä»¬çš„æ¨¡å‹å®é™…ä¸Šè¿˜æœ‰å¦ä¸€ä¸ªå¾ˆæ£’çš„å±æ€§ï¼šå®ƒæ˜¯å‡¹çš„ï¼åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé”€å”®çš„æœ€å¤§å€¼æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡¸ä¼˜åŒ–æ¥è·å¾—å®ƒã€‚ä¼˜åŒ–éå‡¸æˆ–éå‡¹å‡½æ•°ä¸€èˆ¬æ˜¯å›°éš¾çš„ï¼Œæ›´åƒæ˜¯ä¸€ç§è‰ºæœ¯ï¼Œæ¶‰åŠåˆ°è°ƒæ•´è®¸å¤šè¶…å‚æ•°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰é€‰æ‹©è¿™ç§æ–¹æ³•ã€‚

ä½œä¸ºå¤§ç»“å±€ï¼Œæˆ‘ä»¬ä¼˜åŒ–äº†æˆ‘ä»¬çš„åª’ä½“é¢„ç®—ï¼æ˜¯æ—¶å€™äº†ã€‚æˆ‘ä»¬ç”šè‡³çœ‹åˆ°å¦‚ä½•åœ¨æ¨¡å‹ä¸­åŠ å…¥æ›´å¤šçš„çº¦æŸï¼Œä¾‹å¦‚æŸäº›é¢‘é“éœ€è¦ä¸€äº›æœ€ä½æˆ–æœ€é«˜é¢„ç®—åˆ†é…ã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œä½ ç°åœ¨å¯ä»¥ä¼˜åŒ–æœªæ¥çš„åª’ä½“é¢„ç®—åˆ†é…ã€‚

å¦ä¸€ä¸ªæˆ‘ä»¬æ²¡æœ‰è®¨è®ºçš„ä¼˜åŒ–æ˜¯**åœ¨ä½ æƒ³è¾¾åˆ°æŸä¸ªæœ€ä½é”€å”®é¢çš„çº¦æŸä¸‹æœ€å°åŒ–ä½ çš„åª’ä½“é¢„ç®—**ï¼Œå³å°½å¯èƒ½å°‘èŠ±é’±ä»ç„¶è¾¾åˆ°ç›®æ ‡ã€‚è¿™æ˜¯ä½ ä¹Ÿå¯ä»¥è½»æ¾å®ç°çš„ï¼ç›¸åï¼Œåœ¨ä¹‹å‰æˆ‘ä»¬æŠŠæ‰€æœ‰çš„é’±éƒ½ç”¨äº†ï¼Œåšäº†å°½å¯èƒ½å¤šçš„é”€å”®ã€‚

æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„å’Œæœ‰ä»·å€¼çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼

**æœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ **

1.  **æƒ³æ”¯æŒæˆ‘å†™æ›´å¤šå…³äºæœºå™¨å­¦ä¹ çš„å†…å®¹**

1.  **åæ­£è®¡åˆ’è®¢é˜…ä¸€ä¸ª Medium è´¦å·ï¼Œ**

**ä¸ºä»€ä¹ˆä¸é€šè¿‡è¿™ä¸ª[é“¾æ¥](https://dr-robert-kuebler.medium.com/membership)æ¥åšå‘¢**ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š

*ä¸ºäº†é€æ˜èµ·è§ï¼Œå¯¹ä½ æ¥è¯´ä»·æ ¼ä¸ä¼šæ”¹å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç”¨ç›´æ¥å½’æˆ‘æ‰€æœ‰ã€‚*

**å¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘ï¼Œéå¸¸æ„Ÿè°¢ï¼**

> *å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥åœ¨* [*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šç»™æˆ‘å†™ä¿¡ï¼*

å¦‚æœä½ æƒ³æ·±å…¥äº†è§£ç®—æ³•çš„ä¸–ç•Œï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹æˆ‘çš„æ–°å‡ºç‰ˆç‰©**ã€Šå…¨å…³äºç®—æ³•ã€‹**ï¼æˆ‘è¿˜åœ¨å¯»æ‰¾ä½œè€…ï¼

[](https://medium.com/all-about-algorithms?source=post_page-----63707c18ba36--------------------------------) [## å…¨å…³äºç®—æ³•

### ä»ç›´è§‚è§£é‡Šåˆ°æ·±å…¥åˆ†æï¼Œç®—æ³•é€šè¿‡ç¤ºä¾‹ã€ä»£ç å’Œç²¾å½©å†…å®¹ç”ŸåŠ¨èµ·æ¥â€¦

[medium.com](https://medium.com/all-about-algorithms?source=post_page-----63707c18ba36--------------------------------)

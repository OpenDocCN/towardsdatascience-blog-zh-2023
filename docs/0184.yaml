- en: What I learned after running AB tests for one year as a data scientist ‚Äî Part
    2/2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/what-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-2-2-4b30118fec26?source=collection_archive---------9-----------------------#2023-01-11](https://towardsdatascience.com/what-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-2-2-4b30118fec26?source=collection_archive---------9-----------------------#2023-01-11)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A real-world case study on how data scientists approach and analyze the results
    of an AB test
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@alex.vamvakaris.ds?source=post_page-----4b30118fec26--------------------------------)[![Alex
    Vamvakaris](../Images/bf8cf7c92a94d2b0d9242afcc03bf425.png)](https://medium.com/@alex.vamvakaris.ds?source=post_page-----4b30118fec26--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4b30118fec26--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4b30118fec26--------------------------------)
    [Alex Vamvakaris](https://medium.com/@alex.vamvakaris.ds?source=post_page-----4b30118fec26--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8072260dd591&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-2-2-4b30118fec26&user=Alex+Vamvakaris&userId=8072260dd591&source=post_page-8072260dd591----4b30118fec26---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4b30118fec26--------------------------------)
    ¬∑10 min read¬∑Jan 11, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b30118fec26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-2-2-4b30118fec26&user=Alex+Vamvakaris&userId=8072260dd591&source=-----4b30118fec26---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b30118fec26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-2-2-4b30118fec26&source=-----4b30118fec26---------------------bookmark_footer-----------)![](../Images/ee9a711c370050b2b00232e310dde1fd.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Luca Bravo](https://unsplash.com/@lucabravo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/O453M2Liufs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Intro
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Welcome to the second and last part of the series! In [**Part 1**](https://medium.com/towards-data-science/what-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-1-2-5277911e89ec),
    we covered the design of an experiment and sample size estimations. In this part
    of the series, we will focus on the knowledge and skills you will need to analyze
    AB tests. This is very much at the core of how data scientists provide value in
    a business. Instead of making decisions based on our subjective beliefs, we rely
    on data and statistical tests to steer the company in the right direction.
  prefs: []
  type: TYPE_NORMAL
- en: Part 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Understanding the Fundamentals:** Formulating test hypothesis and exploring
    type I and type II errors'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Exploratory Data Analysis (EDA):** Recruitment into the test, trends over
    time, and distribution of KPIs'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Analyzing the Results of the AB Test:** Explaining the central limit theorem,
    p-values, confidence intervals, and running parametric and non-parametric bootstrapping'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*We will continue using the case study from Part 1\. You can explore the two
    versions of the AB test and the selection of KPIs in the link below üëá*'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/what-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-1-2-5277911e89ec?source=post_page-----4b30118fec26--------------------------------)
    [## What I learned after running AB tests for one year as a data scientist ‚Äî Part
    1/2'
  prefs: []
  type: TYPE_NORMAL
- en: Set up your A/B tests like a data scientist by following these simple steps
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/what-i-learned-after-running-ab-tests-for-one-year-as-a-data-scientist-part-1-2-5277911e89ec?source=post_page-----4b30118fec26--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Understanding the Fundamentals
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/e59ec70d88c3765075472e1273cc5f15.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Stefan Steinbauer](https://unsplash.com/@usinglight?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/HK8IoD-5zpg?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Formulating the Hypotheses
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In every statistical test, there is an **initial** and **alternative hypothesis**.
    The initial assumes no difference for our two KPIs between the control (¬£10 off)
    and treatment (20% off), while the alternative hypothesis assumes that there is
    a significant difference. The initial hypothesis is often called null as it represents
    the default or ‚Äúnormal‚Äù state of affairs (i.e., no difference).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0ff51b5d2e987ac4e211af7becbdf04c.png)'
  prefs: []
  type: TYPE_IMG
- en: Formulating the initial and alternative hypothesis for our two KPIs [Image by
    the author]
  prefs: []
  type: TYPE_NORMAL
- en: A tricky part to be aware of in data science interviews is how you express your
    objective around these hypotheses. We are trying to either **reject** or **fail
    to reject** the initial hypothesis. We will never be able to accept it. Now in
    terms of how you will communicate results to the stakeholders, that will not make
    a difference. But with data scientists, it will!
  prefs: []
  type: TYPE_NORMAL
- en: Let's look at the example of black swans. Imagine a world where we have only
    witnessed white swans. We will never be able to accept the initial hypothesis
    that there are no black swans. We can collect unlimited data, and still, we might
    have missed that one black swan that we needed. So we can **fail to reject the
    hypothesis** that all swans are white **but never accept it**! On the other hand,
    we can always reject the initial hypothesis if we witness one black swan. Now,
    granted, black swans represent rare events, which we will hardly try to measure
    in business scenarios (minimum detectable effects, MDEs, are set usually at 2%),
    but still, it is a useful way to understand how we approach AB tests as data scientists.
  prefs: []
  type: TYPE_NORMAL
- en: Type I and Type II Errors
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Okay, so we have our initial and alternative hypotheses, and we can either reject
    or fail to reject the initial hypothesis. That translates into four eventualities,
    as shown in the table below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/677c09d446ad6444fb1105093cb20da0.png)'
  prefs: []
  type: TYPE_IMG
- en: Type I and Type II errors [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: 'Using the data we gathered from running our experiment, we will either accept
    (got you didn''t I, remember it is fail to reject) or reject the null hypothesis.
    But no methodology is perfect, i.e., it is impossible to eliminate false positives
    and negatives entirely (the red boxes in the image above). In the words of Neyman
    and Pearson (1933):'
  prefs: []
  type: TYPE_NORMAL
- en: '***We are inclined to think that as far as a particular hypothesis is concerned,
    no test based upon the theory of probability can by itself provide any valuable
    evidence of the truth or falsehood of that hypothesis***'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'That doesn''t sound very promising, does it? Fortunately, they continue by
    adding the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '***But we may look at the purpose of tests from another viewpoint. Without
    hoping to know whether each separate hypothesis is true or false, we may search
    for rules to govern our behavior with regard to them, in following which we ensure
    that, in the long run of experience, we shall not be too often wrong***'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This above is an important point to understand. In statistics, we do not deal
    with certainty. We will never infer anything with 100% certainty. However, we
    have statistical tools (like p-values and confidence intervals, more on that later)
    that we can use to help us make decisions. Decisions or rules, if you prefer,
    that in the long run will give us a certain (acceptable) probability of making
    a type I or type II error.
  prefs: []
  type: TYPE_NORMAL
- en: '**Type I Error**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Occurs when we conclude that there is a difference, even though there is none.
    In other words, we reject the null hypothesis even though it is true
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The probability for this error is called the **significance level** of a test
    and is symbolized by the greek letter **Œ±.** The significance level of a test
    is usually set at 5%
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Type II Error**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Occurs when we conclude that there is no difference, even though there is one.
    In other words, we fail to reject the null hypothesis even though it is false
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The probability for this error is symbolized by the greek letter **Œ≤**. The
    complement of that probability (**1 ‚Äî Œ≤)** is called the **power** of a test and
    is usually set at 80%
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2\. Exploratory Data Analysis (EDA)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/5f4e7b536a1bf6537ef0056878368c84.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Scott Webb](https://unsplash.com/@scottwebb?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/wallpapers/colors?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: This must be by far the step that is most often rushed or skipped altogether,
    despite being present in all the major frameworks. However, there are real benefits
    to having an EDA, as it answers important questions that we need to know before
    we start analyzing the results.
  prefs: []
  type: TYPE_NORMAL
- en: Recruitment into the Test
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this part, we just want to examine that there were no issues with the allocation
    of visitors to control and treatment:'
  prefs: []
  type: TYPE_NORMAL
- en: Recruitment only occurs on Fridays, as we intended, with the same volume of
    visitors recruited into control and treatment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The majority of visitors enter the test on the first Friday, and then the volume
    of recruits decreases. This is a well-known trend. The most engaged (existing)
    visitors will be recruited immediately, and then after two or three weeks, we
    will be mostly recruiting new visitors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/ad81d99a79b612fbef3720b0e27bc3c8.png)'
  prefs: []
  type: TYPE_IMG
- en: Recruitment of visitors in the test by variant [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: Time Series
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Next, we want to examine any trends or seasonality in our KPIs of interest.
    Let‚Äôs take the graph below that showcases average daily revenue (as a proxy for
    28-day ARPV):'
  prefs: []
  type: TYPE_NORMAL
- en: There is no pre-test difference between the two versions. If the two versions
    differed in the weeks before the test started, we would need to adjust our KPIs
    in the test period to correct for any pre-test biases
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The metric is not very volatile (no extreme up and downs from day to day)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Treatment is higher than the control for every Friday since we launched the
    test (clear spikes). The uplift is increasing as time passes (the last two Fridays
    have the highest uplift)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/ed8b51488fbe64cf238bb65454463eb2.png)'
  prefs: []
  type: TYPE_IMG
- en: Time series of average daily revenue [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: Distributions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Finally, we want to examine the distributions of control and treatment:'
  prefs: []
  type: TYPE_NORMAL
- en: Looking at revenue, there are no extreme outliers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We can clearly see a third peak for revenue in treatment (between ¬£70 and ¬£90).
    The first is at ¬£0 and the second at ¬£50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ARPV is higher for treatment by 19% (up by ¬£4.70, ¬£29.2‚Äì¬£24.5)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Looking at ATPV, there is also a clear uplift for treatment (more visitors making
    3 or 4 transactions)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/a6d2b6608a52d1836394cff9db93ab7c.png)'
  prefs: []
  type: TYPE_IMG
- en: Distributions of ARPV and ATPV split by variant [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Analyzing the Results of the AB Test
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/5195f3ad25fdd2879e91539e0b231c18.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Tim Stief](https://unsplash.com/@timstief?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/YFFGkE3y4F8?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: As you can imagine, if we had taken a different sample of the same size, we
    would have observed different statistics (ARPV and ATPV). This means that **a
    (sample) statistic is a random variable**. Like any other random variable, a statistic
    has a distribution called a **sampling distribution**. You can think of thesampling
    distribution asthe population of all possible values for the statistic if we were
    to take exhaustively all the possible samples of size n from a population of size
    N and compute the statistic for each one. Let‚Äôs see how the sampling distribution
    and bootstrapping will help us analyze the results of the AB test.
  prefs: []
  type: TYPE_NORMAL
- en: Why Bootstrapping?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's start with the hero of most data science interviews, the **p-value**.
    Simply put, the p-value is the probability of collecting data that lead us to
    believe there is a difference, even though there is none. The lower the p-value,
    the more statistically significant the difference. That is because it would have
    been that much more improbable (due to luck only) to observe the given dataset
    if there was, in fact, no difference. If the p-value is lower than our acceptable
    level of statistical significance (**p-value** < **Œ±**), we reject the null hypothesis.
  prefs: []
  type: TYPE_NORMAL
- en: '**If you can write a result as a confidence interval instead of a p-value,
    you should**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Confidence intervals** (CIs) can answer the same questions as p-values, with
    the advantage that they provide more information and are more straightforward
    to interpret. If you want to test whether two versions are statistically different,
    you can construct a 95% confidence interval (1- **a%)** of their difference and
    check whether the interval includes zero. In the process, you get the added bonus
    of learning how precise your estimate is (a wider interval indicates higher uncertainty).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bootstrapping is a method for estimating the sampling distribution of a statistic**
    and computing CIs'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Ordinary bootstrapping**, also known as simple bootstrapping, is a basic
    version of the method and the one we will be using for our analysis. It involves
    taking repeated samples of the same size as the original sample (with replacement)
    and calculating the statistic of interest for each one. We can then use all these
    different samples (and their respective statistics) to calculate a 95% confidence
    interval. This can be non-parametric based on the percentiles (between the 0.025
    and 0.975 percentile), or we can follow a parametric approach and compute normal
    confidence intervals. We will do both.'
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing AB Results with Bootstrapping CIs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For our purposes, we will use the [**boot**](https://www.rdocumentation.org/packages/boot/versions/1.3-28.1/topics/boot)
    package in R. First, we will need to create the following inputs:'
  prefs: []
  type: TYPE_NORMAL
- en: The datasets we will use in the boot function (see snapshot below)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A function that computes the % difference in our statistics within each sample
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/981da07e001a06e4d7d608177dfd463b.png)'
  prefs: []
  type: TYPE_IMG
- en: Overview of bootstrap input datasets [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: We will then take 2000 samples and compute 95% confidence intervals of the %
    difference between control and treatment for ARPV and ATPV, respectively (using
    the [**boot.ci**](https://www.rdocumentation.org/packages/boot/versions/1.3-28.1/topics/boot.ci)
    function, with the result of the boot function as input).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/2da63f7f4bbb7b4e6f21458ba9d749d1.png)'
  prefs: []
  type: TYPE_IMG
- en: Confidence intervals from ordinary bootstrapping [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: 'So let''s interpret the results:'
  prefs: []
  type: TYPE_NORMAL
- en: The 95% Cl for the % difference of ARPV between treatment and control is between
    17.7% and 20.6% in favor of treatment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The 95% Cl for the % difference of ATPV between treatment and control is between
    14.7% and 18% in favor of treatment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Both differences are significant as the 95% intervals are far from including
    zero
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In case you are wondering why the normal 95% CI was so close to the non-parametric
    percentile one, there is a very well-known theorem that sheds some light.
  prefs: []
  type: TYPE_NORMAL
- en: According to the CLT, given a sufficiently large sample size from a population,
    the (sampling) distribution of the sample means will be approximately normal
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When the underlying distribution is Normal, then the CLT applies automatically
    for the mean. What happens in all other cases, though? Well, the further we deviate
    from the Normal distribution, the higher the sample size we will need. The boot
    function provides a nice plot to check the sampling distribution of your statistic,
    which you can see below for our ARPV % difference sampling distribution. Both
    plots show that the sampling distribution is approximately Normal, which explains
    why the non-parametric CIs and the Normal one are almost identical.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/29df7423da8aaa54a164639a4d9f5d81.png)'
  prefs: []
  type: TYPE_IMG
- en: Checking normality assumption from ordinary bootstrapping [Image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: And with that last step, we have successfully run an AB test! üöÄüöÄ
  prefs: []
  type: TYPE_NORMAL
- en: ‚úÖ We explained basic concepts like error types I and II, p-values, confidence
    intervals, and the CLT
  prefs: []
  type: TYPE_NORMAL
- en: ‚úÖ We run through the EDA checklist for an AB test
  prefs: []
  type: TYPE_NORMAL
- en: ‚úÖ We analyzed the results of our experiment using parametric and non-parametric
    bootstrap confidence intervals
  prefs: []
  type: TYPE_NORMAL
- en: I hope the above was useful in helping you get a step closer to your goal of
    landing your first data science job. I tried to cover both the theory you will
    need for your data science interviews and also give you the skills to run and
    analyze your own experiments like a data scientist!
  prefs: []
  type: TYPE_NORMAL
- en: Stay in Touch!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you enjoyed reading this article and want to learn more, don‚Äôt forget to
    [subscribe](https://medium.com/@alex.vamvakaris.ds/subscribe) to get my stories
    sent directly to your inbox.
  prefs: []
  type: TYPE_NORMAL
- en: On the link below, you can also find a free PDF Walkthrough on completing a
    Customer Cluster Analysis in a real-life business scenario using data science
    techniques and best practices in R. *üëá*
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.aspiringdatascientist.net/community?source=post_page-----4b30118fec26--------------------------------)
    [## Data Science Project Checklist - Aspiring Data Scientist'
  prefs: []
  type: TYPE_NORMAL
- en: I am a Data Scientist with 7+ years of analytics experience, currently working
    in a gaming company in London, UK. My‚Ä¶
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.aspiringdatascientist.net](https://www.aspiringdatascientist.net/community?source=post_page-----4b30118fec26--------------------------------)
  prefs: []
  type: TYPE_NORMAL

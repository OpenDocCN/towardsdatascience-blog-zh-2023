- en: Unit testing PySpark code using Pytest
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/unit-testing-pyspark-code-using-pytest-b5ab2fd54415?source=collection_archive---------15-----------------------#2023-01-16](https://towardsdatascience.com/unit-testing-pyspark-code-using-pytest-b5ab2fd54415?source=collection_archive---------15-----------------------#2023-01-16)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[](https://julianwest155.medium.com/?source=post_page-----b5ab2fd54415--------------------------------)[![Julian
    West](../Images/c7740cd407ed17e84af2c49a37dbbe92.png)](https://julianwest155.medium.com/?source=post_page-----b5ab2fd54415--------------------------------)[](https://towardsdatascience.com/?source=post_page-----b5ab2fd54415--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----b5ab2fd54415--------------------------------)
    [Julian West](https://julianwest155.medium.com/?source=post_page-----b5ab2fd54415--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F257ac04bf615&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funit-testing-pyspark-code-using-pytest-b5ab2fd54415&user=Julian+West&userId=257ac04bf615&source=post_page-257ac04bf615----b5ab2fd54415---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----b5ab2fd54415--------------------------------)
    ·10 min read·Jan 16, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5ab2fd54415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funit-testing-pyspark-code-using-pytest-b5ab2fd54415&user=Julian+West&userId=257ac04bf615&source=-----b5ab2fd54415---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5ab2fd54415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funit-testing-pyspark-code-using-pytest-b5ab2fd54415&source=-----b5ab2fd54415---------------------bookmark_footer-----------)![](../Images/314b8ebf1cb2596498d48e1f09861a50.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Jez Timms](https://unsplash.com/@jeztimms?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/_Ch_onWf38o?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: '**I am a big fan of unit-testing.**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Reading two books —** [**The Pragmatic Programmer**](https://engineeringfordatascience.com/book-notes/pragmatic-programmer/)
    **and** [**Refactoring**](https://engineeringfordatascience.com/book-notes/refactoring/)
    **— completely changed the way I viewed unit-testing.**'
  prefs: []
  type: TYPE_NORMAL
- en: “Testing is not about finding bugs.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: We believe that the major benefits of testing happen when you think about and
    write the tests, not when you run them.”
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*— The Pragmatic Programmer, David Thomas and Andrew Hunt*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Instead of seeing testing as a chore to complete after I have finished my data
    pipelines, I see it as a powerful tool to improve the design of my code, reduce
    coupling, iterate more quickly and build trust with others in my work.
  prefs: []
  type: TYPE_NORMAL
- en: However, writing good tests for data applications can be difficult.
  prefs: []
  type: TYPE_NORMAL
- en: Unlike traditional software applications with relatively well defined inputs,
    data applications in production depend on large and constantly changing input
    data.
  prefs: []
  type: TYPE_NORMAL
- en: It can be very challenging to accurately represent this data in a test environment
    in enough detail to cover all edge cases. Some people argue there is little point
    in unit-testing data pipelines, and focus on data validation techniques instead.
  prefs: []
  type: TYPE_NORMAL

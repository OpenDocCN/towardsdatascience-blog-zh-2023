- en: Mastering Customer Segmentation with LLM
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 掌握客户细分的终极技巧
- en: 原文：[https://towardsdatascience.com/mastering-customer-segmentation-with-llm-3d9008235f41?source=collection_archive---------0-----------------------#2023-09-26](https://towardsdatascience.com/mastering-customer-segmentation-with-llm-3d9008235f41?source=collection_archive---------0-----------------------#2023-09-26)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/mastering-customer-segmentation-with-llm-3d9008235f41?source=collection_archive---------0-----------------------#2023-09-26](https://towardsdatascience.com/mastering-customer-segmentation-with-llm-3d9008235f41?source=collection_archive---------0-----------------------#2023-09-26)
- en: Unlock advanced customer segmentation techniques using LLMs, and improve your
    clustering models with advanced techniques
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用 LLM 解锁高级客户细分技术，并通过先进技术改进你的聚类模型
- en: '[](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)[![Damian
    Gil](../Images/8b378c321ee21b0bd40faa14db7e9487.png)](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)[](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)
    [Damian Gil](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)[![Damian
    Gil](../Images/8b378c321ee21b0bd40faa14db7e9487.png)](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)[](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)
    [Damian Gil](https://medium.com/@damiangilgonzalez?source=post_page-----3d9008235f41--------------------------------)'
- en: ·
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87864cbc1dda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-customer-segmentation-with-llm-3d9008235f41&user=Damian+Gil&userId=87864cbc1dda&source=post_page-87864cbc1dda----3d9008235f41---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)
    ·24 min read·Sep 26, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d9008235f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-customer-segmentation-with-llm-3d9008235f41&user=Damian+Gil&userId=87864cbc1dda&source=-----3d9008235f41---------------------clap_footer-----------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[关注](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87864cbc1dda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-customer-segmentation-with-llm-3d9008235f41&user=Damian+Gil&userId=87864cbc1dda&source=post_page-87864cbc1dda----3d9008235f41---------------------post_header-----------)
    发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----3d9008235f41--------------------------------)
    ·24 分钟阅读·2023年9月26日'
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d9008235f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-customer-segmentation-with-llm-3d9008235f41&source=-----3d9008235f41---------------------bookmark_footer-----------)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d9008235f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmastering-customer-segmentation-with-llm-3d9008235f41&source=-----3d9008235f41---------------------bookmark_footer-----------)'
- en: Content Table
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 内容目录
- en: '**·** [**Intro**](#fbea) **·** [**Data**](#7ac3) **·** [**Method 1: Kmeans**](#c662)
    **·** [**Method 2: K-Prototype**](#1422) **·** [**Method 3: LLM + Kmeans**](#3a33)
    **·** [**Conclusion**](#e320)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**·** [**简介**](#fbea) **·** [**数据**](#7ac3) **·** [**方法 1: Kmeans**](#c662)
    **·** [**方法 2: K-Prototype**](#1422) **·** [**方法 3: LLM + Kmeans**](#3a33) **·**
    [**结论**](#e320)'
- en: Intro
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: A customer segmentation project can be approached in multiple ways. In this
    article I will teach you advanced techniques, not only to define the clusters,
    but to analyze the result. This post is intended for those data scientists who
    want to have several tools to address clustering problems and be one step closer
    to being seniors DS.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 客户细分项目可以通过多种方式进行。在这篇文章中，我将教你高级技术，不仅是定义簇，还包括分析结果。此帖面向那些希望掌握多种工具以解决聚类问题并向成为资深数据科学家迈进的数据科学家。
- en: What will we see in this article?
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 我们在这篇文章中会看到什么？
- en: 'Let’s see 3 methods to approach this type of project:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看三种方法来处理这种类型的项目：
- en: '**Kmeans**'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Kmeans**'
- en: '**K-Prototype**'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**K-Prototype**'
- en: '**LLM + Kmeans**'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**LLM + Kmeans**'
- en: 'As a small preview I will show the following comparison of the 2D representation
    (PCA) of the different models created:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个小预览，我将展示以下不同模型创建的二维表示（PCA）的比较：
- en: '![](../Images/c1271719684d43f409e5765fd0eb7aa7.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c1271719684d43f409e5765fd0eb7aa7.png)'
- en: '**Graphic comparison of the three methods** (Image by Author).'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '**三种方法的图形比较**（图片由作者提供）。'
- en: 'You will also learn dimensionality reduction techniques such as:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 你还将学习诸如以下的降维技术：
- en: '**PCA**'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PCA**'
- en: '**t-SNE**'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**t-SNE**'
- en: '**MCA**'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MCA**'
- en: 'Some of the results being these:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![](../Images/f9eb2a950a822ada5b1ad3afadc701fe.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f9eb2a950a822ada5b1ad3afadc701fe.png)'
- en: '**Graphical comparison of the three dimensionality reduction methods** (Image
    by Author).'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**三种降维方法的图形比较**（图片由作者提供）。'
- en: 'You can find the project with the notebooks [**here**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM)**.**
    And you can also take a look at my github:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在[**这里**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM)找到带有笔记本的项目。你也可以查看我的github：
- en: '[](https://github.com/damiangilgonzalez1995?source=post_page-----3d9008235f41--------------------------------)
    [## damiangilgonzalez1995 - Overview'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://github.com/damiangilgonzalez1995?source=post_page-----3d9008235f41--------------------------------)
    [## damiangilgonzalez1995 - 概述'
- en: Passionate about data, I transitioned from physics to data science. Worked at
    Telefonica, HP, and now CTO at…
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 对数据充满热情，我从物理学转行到了数据科学。曾在Telefonica、HP工作，现在担任CTO…
- en: github.com](https://github.com/damiangilgonzalez1995?source=post_page-----3d9008235f41--------------------------------)
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: github.com](https://github.com/damiangilgonzalez1995?source=post_page-----3d9008235f41--------------------------------)
- en: 'A very important clarification is that this is not an end-to-end project. This
    is because we have skipped one of the most important parts in this type of project:
    **The exploratory data analysis (EDA) phase or the selection of variables.**'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 一个非常重要的说明是，这不是一个完整的项目。这是因为我们跳过了这种类型项目中最重要的部分之一：**探索性数据分析（EDA）阶段或变量选择。**
- en: Data
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据
- en: 'The original data used in this project is from a public Kaggle: [Banking Dataset
    — Marketing Targets](https://www.kaggle.com/datasets/prakharrathi25/banking-dataset-marketing-targets).
    Each row in this data set contains information about a company’s customers. Some
    fields are numerical and others are categorical, we will see that this expands
    the possible ways to approach the problem.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 本项目使用的原始数据来自公开的Kaggle：[银行数据集 — 市场营销目标](https://www.kaggle.com/datasets/prakharrathi25/banking-dataset-marketing-targets)。此数据集中的每一行包含有关公司客户的信息。一些字段是数值型的，其他的是分类的，我们将看到这扩展了处理问题的可能方法。
- en: 'We will only be left with the first 8 columns. Our dataset looks like this:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只会保留前8列。我们的数据集如下所示：
- en: '![](../Images/a7f07db265fac93d2a304ea879240b76.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a7f07db265fac93d2a304ea879240b76.png)'
- en: 'Let’s see a brief description of the columns of our dataset:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们简要了解一下数据集中的列：
- en: '**age** (numeric)'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**年龄**（数值型）'
- en: '**job** : type of job (categorical: “admin.” ,”unknown”,”unemployed”, ”management”,
    ”housemaid”, ”entrepreneur”, ”student”, “blue-collar”, ”self-employed”, ”retired”,
    ”technician”, ”services”)'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作**：工作类型（分类： “行政”，“未知”，“失业”，“管理”，“家政”，“企业家”，“学生”，“蓝领”，“自雇”，“退休”，“技术人员”，“服务”）'
- en: '**marital** : marital status (categorical: “married”,”divorced”,”single”; note:
    “divorced” means divorced or widowed)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**婚姻状况**：婚姻状态（分类： “已婚”，“离婚”，“单身”；注：“离婚”指离婚或丧偶）'
- en: '**education** (categorical: “unknown”,”secondary”,”primary”,”tertiary”)'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**教育**（分类： “未知”，“中等”，“小学”，“高等”）'
- en: '**defaul**t: has credit in default? (binary: “yes”,”no”)'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**违约**：是否有信用违约？（二元： “是”，“否”）'
- en: '**balance**: average yearly balance, in euros (numeric)'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**余额**：年平均余额，单位欧元（数值型）'
- en: '**housing**: has housing loan? (binary: “yes”,”no”)'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**住房**：是否有住房贷款？（二元： “是”，“否”）'
- en: '**loan**: has personal loan? (binary: “yes”,”no”)'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**贷款**：是否有个人贷款？（二元： “是”，“否”）'
- en: For the project, I’ve utilized the training dataset by Kaggle.[**In the project
    repository**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM), you
    can locate the ***“data”*** folder where a compressed file of the dataset used
    in the project is stored. Additionally, you will find two CSV files inside of
    the compressed file. One is the training dataset provided by Kaggle **(train.csv)**,
    and the other is the dataset after performing an embedding (**embedding_train.csv**),
    which we will explain further later on.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，我利用了Kaggle提供的训练数据集。[**在项目仓库**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM)中，你可以找到***“data”***文件夹，其中存储了用于项目的压缩数据集文件。此外，你还会在压缩文件内找到两个CSV文件，一个是Kaggle提供的训练数据集**（train.csv）**，另一个是经过嵌入处理后的数据集（**embedding_train.csv**），我们将在稍后进一步解释。
- en: 'To further clarify how the project is structured, the project tree is shown:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进一步澄清项目的结构，展示了项目树：
- en: '[PRE0]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Method 1: Kmeans'
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方法1：Kmeans
- en: This is the most common method and the one you will surely know. Anyway, we
    are going to study it because I will show advanced analysis techniques in these
    cases. The Jupyter notebook where you will find the complete procedure is called
    [**kmeans.ipynb**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kmeans.ipynb)
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 这是最常见的方法，也是你一定熟悉的方法。无论如何，我们将研究它，因为我将在这些情况下展示高级分析技巧。你可以在名为[**kmeans.ipynb**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kmeans.ipynb)的Jupyter笔记本中找到完整的过程。
- en: Preprocessed
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预处理
- en: 'A preprocessing of the variables is carried out:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 变量的预处理如下：
- en: It consists of converting categorical variables into numeric ones.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这包括将分类变量转换为数值变量。
- en: We are going to apply Onehot encoder for the nominal variables and a OrdinalEncoder
    for the ordinals features (*education*).
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们将对名义变量应用Onehot编码器，对序数特征（*教育*）应用OrdinalEncoder。
- en: We try to ensure that the numerical variables have a Gaussian distribution.
    For them we will apply a PowerTransformer.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们尝试确保数值变量具有高斯分布。为此，我们将应用PowerTransformer。
- en: Let’s see how it looks in code.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看它在代码中是如何表现的。
- en: '[PRE1]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Output:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/6e0a4a2e7e601e8d71cc086968d5c904.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6e0a4a2e7e601e8d71cc086968d5c904.png)'
- en: Outliers
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常值
- en: It is crucial that there are as few outliers in our data as Kmeans is very sensitive
    to this. We can apply the typical method of choosing outliers using the z score,
    but in this post I will show you a much more advanced and cool method.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 关键在于我们的数据中异常值要尽可能少，因为Kmeans对异常值非常敏感。我们可以使用z分数的典型方法来选择异常值，但在这篇文章中我将展示一种更高级且酷的方法。
- en: Well, what is this method? Well, we will use the [Python Outlier Detection (PyOD)
    library](https://pyod.readthedocs.io/en/latest/). This library is focused on detecting
    outliers for different cases. To be more specific we will use the **ECOD** method
    (“**empirical cumulative distribution functions for outlier detection**”).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，这种方法是什么呢？我们将使用[Python异常检测（PyOD）库](https://pyod.readthedocs.io/en/latest/)。这个库专注于检测不同情况下的异常值。更具体来说，我们将使用**ECOD**方法（“**用于异常检测的经验累积分布函数**”）。
- en: This method seeks to obtain the distribution of the data and thus know which
    are the values ​​where the probability density is lower (outliers). Take a look
    at the [Github](https://medium.com/r?url=https%3A%2F%2Fgithub.com%2Fyzhao062%2Fpyod)
    if you want.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法旨在获取数据的分布，从而了解哪些值的概率密度较低（异常值）。如果你想的话，可以看看[Github](https://medium.com/r?url=https%3A%2F%2Fgithub.com%2Fyzhao062%2Fpyod)。
- en: '[PRE2]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Modeling
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建模
- en: 'One of the disadvantages of using the Kmeans algorithm is that you must choose
    the number of clusters you want to use. In this case, in order to obtain that
    data, we will use [Elbow Method](https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/).
    It consists of calculating the distortion that exists between the points of a
    cluster and its centroid. The objective is clear, to obtain the least possible
    distortion. In this case we use the following code:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Kmeans算法的一个缺点是你必须选择要使用的簇数。在这种情况下，为了获取这些数据，我们将使用[肘部法则](https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/)。它的原理是计算簇内点与其质心之间的失真。目标很明确，尽量减少失真。在这种情况下，我们使用以下代码：
- en: '[PRE3]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Output:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/c1f9dbd17d6bf7a464b92bc1bf1eacad.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c1f9dbd17d6bf7a464b92bc1bf1eacad.png)'
- en: '**Elbow score for different numbers of clusters** (Image by Author).'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同簇数的肘部评分**（作者提供的图片）。'
- en: 'We see that from **k=5**, the distortion does not vary drastically. It is true
    that the ideal is that the behavior starting from k= 5 would be almost flat. This
    rarely happens and other methods can be applied to be sure of the most optimal
    number of clusters. To be sure, we could perform a [**Silhoutte**](https://www.scikit-yb.org/en/latest/api/cluster/silhouette.html)
    **visualization**. The code is the following:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到从**k=5**开始，失真没有明显变化。理想的情况是，从k=5开始，行为几乎保持平坦。这种情况很少发生，可以应用其他方法来确定最优的集群数量。为了确保，我们可以进行[**Silhouette**](https://www.scikit-yb.org/en/latest/api/cluster/silhouette.html)
    **可视化**。代码如下：
- en: '[PRE4]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'It can be seen that the highest silhouette score is obtained with n_cluster=9,
    but it is also true that the variation in the score is quite small if we compare
    it with the other scores. At the moment the previous result does not provide us
    with much information. On the other hand, the previous code creates the Silhouette
    visualization, which gives us more information:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看出，最高的轮廓得分是在n_cluster=9时获得的，但如果与其他得分比较，得分的变化确实很小。目前，之前的结果并没有提供太多信息。另一方面，之前的代码创建了轮廓可视化，这为我们提供了更多信息：
- en: '![](../Images/8cbb7e81daf794103550e8d419037673.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8cbb7e81daf794103550e8d419037673.png)'
- en: '**Graphic representation of the silhouette method for different numbers of
    clusters** (Image by Author).'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同集群数量的轮廓方法的图形表示**（作者提供的图片）。'
- en: Since understanding these representations well is not the goal of this post,
    I will conclude that there seems to be no very clear decision as to which number
    is best. After viewing the previous representations, we can choose **K=5 or K=
    6**. This is because for the different clusters, their Silhouette score is above
    the average value and there is no imbalance in cluster size. Furthermore, in some
    situations, the marketing department may be interested in having the smallest
    number of clusters/types of customers (This may or may not be the case).
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 由于深入理解这些表示并不是本文的目标，我将总结为似乎没有非常明确的决定哪个数字最好。在查看了之前的表示后，我们可以选择**K=5或K=6**。这是因为对于不同的集群，它们的轮廓得分都高于平均值，并且集群大小没有不平衡。此外，在某些情况下，市场部门可能会希望拥有最少的集群/客户类型（这可能会或不会发生）。
- en: Finally we can create our Kmeans model with K=5.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以创建Kmeans模型，K=5。
- en: '[PRE5]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Evaluation
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评估
- en: The way of evaluating kmeans models is somewhat more open than for other models.
    We can use
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 评估kmeans模型的方法比其他模型稍微开放一些。我们可以使用
- en: metrics
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指标
- en: visualizations
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化
- en: interpretation (Something very important for companies).
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释（对公司来说非常重要）。
- en: 'In relation to the **model evaluation metrics**, we can use the following code:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 关于**模型评估指标**，我们可以使用以下代码：
- en: '[PRE6]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: As far as can be shown, we do not have an excessively good model. **Davies’
    score** is telling us that the distance between clusters is quite small.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 据显示，我们没有一个特别好的模型。**Davies得分**告诉我们集群之间的距离相当小。
- en: This may be due to several factors, but keep in mind that the energy of a model
    is the data; if the data does not have sufficient predictive power, you cannot
    expect to achieve exceptional results.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能由几个因素造成，但请记住，模型的能量就是数据；如果数据没有足够的预测能力，你不能期望得到卓越的结果。
- en: For **visualizations**, we can use the method to **reduce dimensionality, PCA**.
    For them we are going to use the [**Prince**](https://github.com/MaxHalford/prince)library,
    focused on exploratory analysis and dimensionality reduction. If you prefer, you
    can use Sklearn’s PCA, they are identical.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 对于**可视化**，我们可以使用**降维方法，PCA**。我们将使用[**Prince**](https://github.com/MaxHalford/prince)库，专注于探索性分析和降维。如果你愿意，也可以使用Sklearn的PCA，它们是相同的。
- en: 'First we will calculate the principal components in 3D, and then we will make
    the representation. These are the two functions performed by the previous steps:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将计算3D中的主成分，然后进行表示。这是前面步骤执行的两个功能：
- en: '[PRE7]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Don’t worry too much about those functions, use them as follows:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 不用过于担心这些功能，按如下方式使用它们：
- en: '[PRE8]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Output:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/b991037bdf1dd3d0c83db66f2a6ddd13.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b991037bdf1dd3d0c83db66f2a6ddd13.png)'
- en: '**PCA space and the clusters created by the model** (Image by Author).'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCA空间及模型创建的集群**（作者提供的图片）。'
- en: It can be seen that the clusters have almost no separation between them and
    there is no clear division. This is in accordance with the information provided
    by the metrics.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看出，集群之间几乎没有分隔，也没有明确的划分。这与指标提供的信息一致。
- en: Something to keep in mind and that very few people keep in mind is the PCA and
    the **variability of the eigenvectors.**
  id: totrans-96
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 需要牢记的一点是 PCA 和 **特征向量的变异性**，这是很少有人关注的。
- en: Let’s say that each field contains a certain amount of information, and this
    adds its bit of information. If the accumulated sum of the 3 main components adds
    up to around 80% variability, we can say that it is acceptable, obtaining good
    results in the representations. If the value is lower, we have to take the visualizations
    with a grain of salt since we are missing a lot of information that is contained
    in other eigenvectors.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 假设每个领域包含一定量的信息，这会增加它的信息量。如果前 3 个主要组件的累积和约为 80% 的变异性，我们可以说这是可以接受的，并且在表示中获得了良好的结果。如果这个值较低，我们必须对可视化结果持保留态度，因为我们遗漏了其他特征向量中包含的大量信息。
- en: 'The next question is obvious: What is the variability of the PCA executed?'
  id: totrans-98
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 接下来的问题很明显：PCA 执行的变异性是多少？
- en: 'The answer is the following:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 答案如下：
- en: '![](../Images/26a4fbdc878720fdb241a57f77e1d75d.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/26a4fbdc878720fdb241a57f77e1d75d.png)'
- en: As can be seen, we have 27.98% variability with the first 3 components, something
    insufficient to draw informed conclusions.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如图所示，我们用前三个组件的变异性为 27.98%，这不足以得出有根据的结论。
- en: When we apply the PCA method, since it is a linear algorithm, it is not capable
    of capturing more complex relationships. Luckily there is a method called **t-SNE**,
    which is capable of capturing ***these complex polynomial relationships***. This
    can help us visualize, since with the previous method we have not had much success.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们应用 PCA 方法时，由于它是线性算法，它无法捕捉更复杂的关系。幸运的是，有一种称为 **t-SNE** 的方法，能够捕捉到 ***这些复杂的多项式关系***。这可以帮助我们进行可视化，因为我们之前的方法效果不佳。
- en: 'If you try it on your computers, keep in mind that it has a higher computational
    cost. For this reason, I sampled my original dataset and it still took me about
    5 minutes to get the result. The code is as follows:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在自己的计算机上尝试，请记住这会有较高的计算成本。因此，我对原始数据集进行了抽样，但仍然花了大约 5 分钟才得到结果。代码如下：
- en: '[PRE9]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: As a result, I got the following image. It shows a clearer separation between
    clusters but unfortunately, we still don’t have good results.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，我得到了以下图像。它显示了聚类之间更清晰的分离，但不幸的是，我们仍然没有得到很好的结果。
- en: '![](../Images/fa9abe56ddb5c100324777929b894326.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fa9abe56ddb5c100324777929b894326.png)'
- en: '**t-SNE space and the clusters created by the model** (Image by Author).'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '**t-SNE 空间和模型创建的聚类**（作者提供的图像）。'
- en: In fact, we can compare the reduction carried out by the **PCA and by the t-SNE,
    in 2 dimensions**. The improvement is clear using the second method.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们可以比较 **PCA 和 t-SNE 在 2 维中的降维效果**。使用第二种方法的改进是显而易见的。
- en: '![](../Images/e53af2aade94ed7dc1d6b79ab146e31c.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e53af2aade94ed7dc1d6b79ab146e31c.png)'
- en: '**Different results for different dimensionality reduction methods and clusters
    defined by the model** (Image by Author).'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同降维方法和模型定义的聚类的不同结果**（作者提供的图像）。'
- en: Finally, let’s explore a little how the model works, in which features are the
    most important and what are the main characteristics of the clusters.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们稍微探讨一下模型的工作原理，哪些特征最重要，以及聚类的主要特征是什么。
- en: To see the importance of each of the variables we will use a typical “trick”
    in this type of situation. We are going to create a classification model where
    the “X” is the inputs of the Kmeans model, and the “y” is the clusters predicted
    by the Kmeans model.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 为了查看每个变量的重要性，我们将使用这种情况中的典型“技巧”。我们将创建一个分类模型，其中“X”是 Kmeans 模型的输入，而“y”是 Kmeans
    模型预测的聚类。
- en: 'The chosen model is an [**LGBMClassifier**](https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.LGBMClassifier.html).
    This model is quite powerful and works well having categorical and numerical variables.
    Having the new model trained, using the [**SHAP**](https://shap.readthedocs.io/en/latest/)library,
    we can obtain the importance of each of the features in the prediction. The code
    is:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 选择的模型是 [**LGBMClassifier**](https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.LGBMClassifier.html)。这个模型非常强大，并且能很好地处理分类和数值变量。在训练好新模型后，使用
    [**SHAP**](https://shap.readthedocs.io/en/latest/) 库，我们可以获取每个特征在预测中的重要性。代码如下：
- en: '[PRE10]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Output:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/0e4c8e00f1bf8d52176769cc8a90303c.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0e4c8e00f1bf8d52176769cc8a90303c.png)'
- en: '**The importance of the variables in the model** (Image by Author).'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型中变量的重要性**（作者提供的图像）。'
- en: It can be seen that feature ***age*** has the greatest predictive power. It
    can also be seen that cluster number 3 (green) is mainly differentiated by the
    ***balance*** variable.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看出特征***age***具有最大的预测能力。还可以看出，簇编号3（绿色）主要通过***balance***变量区分。
- en: 'Finally we must analyze the characteristics of the clusters. This part of the
    study is what is decisive for the business. For them we are going to obtain the
    means (for the numerical variables) and the most frequent value (categorical variables)
    of each of the features of the dataset for each of the clusters:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，我们必须分析簇的特征。这部分研究对业务至关重要。我们将为每个簇获取数据集中每个特征的均值（对于数值变量）和最频繁的值（对于分类变量）：
- en: '[PRE11]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Output:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/95880af6faec1e9d360bc420abaf2c5d.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/95880af6faec1e9d360bc420abaf2c5d.png)'
- en: We see that the clusters with **job=blue-collar** do not have a great differentiation
    between their characteristics, except by the age feature. This is something that
    is not desirable since it is difficult to differentiate the clients of each of
    the clusters. In the **job=management** case, we obtain better differentiation.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到**job=blue-collar**的簇在特征之间没有很大的差异，除了年龄特征。这是不理想的，因为很难区分每个簇的客户。在**job=management**的情况下，我们得到更好的差异化。
- en: 'After carrying out the analysis in different ways, they converge on the same
    conclusion: **“We need to improve the results”.**'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 经过不同方式的分析，它们得出了相同的结论：**“我们需要改进结果”**。
- en: 'Method 2: K-Prototype'
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方法2：K-Prototype
- en: If we remember our original dataset, we see that we have categorical and numerical
    variables. Unfortunately, the Kmeans algorithm provided by Skelearn does not accept
    categorical variables, forcing the original dataset to be modified and drastically
    altered.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们记住原始数据集，我们会看到我们有分类和数值变量。不幸的是，Skelearn提供的Kmeans算法不接受分类变量，迫使原始数据集被修改并严重改变。
- en: Luckily, you’ve taken with me and my post. But above all, thanks to **ZHEXUE
    HUANG** and his article [**Extensions to the k-Means Algorithm for Clustering
    Large Data Sets with Categorical Values**](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.15.4028&rep=rep1&type=pdf),
    there is an algorithm that accepts categorical variables for clustering. This
    algorithm is called **K-Prototype**. The bookstore that provides it is [**Prince**](https://github.com/MaxHalford/prince/blob/master/README.md).
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，你与我和我的帖子一起前进。但最重要的是，感谢**ZHEXUE HUANG**及其文章[**Extensions to the k-Means
    Algorithm for Clustering Large Data Sets with Categorical Values**](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.15.4028&rep=rep1&type=pdf)，存在一种接受分类变量的聚类算法。这个算法叫做**K-Prototype**。提供它的书店是[**Prince**](https://github.com/MaxHalford/prince/blob/master/README.md)。
- en: The procedure is the same as in the previous case. In order not to make this
    article eternal, let’s go to the most interesting parts. But remember that you
    can access the [**Jupyter notebook here**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kprototypes.ipynb).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 程序与之前的情况相同。为了不让这篇文章变得冗长，我们直接进入最有趣的部分。但请记住，您可以通过[**Jupyter notebook 这里**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kprototypes.ipynb)访问。
- en: Preprocessed
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预处理
- en: 'Because we have numerical variables, we must make certain modifications to
    them. It is always recommended that all numerical variables be on similar scales
    and with distributions as close as possible to Gaussian ones. The dataset that
    we will use to create the models is created as follows:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们有数值变量，我们必须对其进行某些修改。通常建议所有数值变量处于类似的尺度上，并且分布尽可能接近高斯分布。我们将用于创建模型的数据集是这样创建的：
- en: '[PRE12]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![](../Images/11cc86976685f0fd416311a6ab0fbc45.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/11cc86976685f0fd416311a6ab0fbc45.png)'
- en: Outliers
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常值
- en: 'Because the method that I have presented for outlier detection **(ECOD)** only
    accepts numerical variables, the same transformation must be performed as for
    the kmeans method. We apply the outlier detection model that will provide us with
    which rows to eliminate, finally leaving the dataset that we will use as input
    for the K-Prototype model:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我提出的异常值检测方法**(ECOD)**仅接受数值变量，因此必须进行与kmeans方法相同的转换。我们应用异常值检测模型，这将告诉我们要删除哪些行，最后留下我们将作为K-Prototype模型输入的数据集：
- en: '![](../Images/a98ec365178e9a9c8db1123e62d92d38.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a98ec365178e9a9c8db1123e62d92d38.png)'
- en: Modeling
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建模
- en: 'We create the model and to do this we first need to obtain the optimal k. To
    do this we use the **Elbow Method** and this piece of code:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们创建模型，为此我们首先需要获得最佳的k。为此，我们使用**Elbow Method**和这段代码：
- en: '[PRE13]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Output:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '![](../Images/7edaed91d38897cafd9b86388121b704.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7edaed91d38897cafd9b86388121b704.png)'
- en: '**Elbow score for different numbers of clusters** (Image by Author).'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同聚类数量的肘部评分**（图像由作者提供）。'
- en: We can see that the best option is **K=5**.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，最佳选项是**K=5**。
- en: Be careful, since this algorithm takes a little longer than those normally used.
    For the previous graph, 86 minutes were needed, something to keep in mind.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 小心，因为这个算法比通常使用的算法要慢一点。对于之前的图表，需要86分钟，这一点需要注意。
- en: '![](../Images/4449fc4681f03208a1bbea5558a8c25c.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4449fc4681f03208a1bbea5558a8c25c.png)'
- en: 'Well, we are now clear about the number of clusters, we just have to create
    the model:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我们现在已经明确了聚类数量，只需要创建模型：
- en: '[PRE14]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: We already have our model and its predictions, we just need to evaluate it.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经有了我们的模型及其预测，现在只需要对其进行评估。
- en: Evaluation
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评估
- en: 'As we have seen before we can apply several visualizations to obtain an intuitive
    idea of how good our model is. Unfortunately the PCA method and t-SNE do not admit
    categorical variables. But don’t worry, since the [**Prince**](https://github.com/MaxHalford/prince/blob/master/README.md)
    library contains the [**MCA (Multiple correspondence analysis)**](https://maxhalford.github.io/prince/mca/)
    method and it does accept a mixed dataset. In fact, I encourage you to visit the
    [**Github**](https://github.com/MaxHalford/prince) of this library, it has several
    super useful methods for different situations, see the following image:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前所见，我们可以应用多种可视化方法来直观地了解模型的好坏。不幸的是，PCA方法和t-SNE不接受分类变量。但不用担心，因为[**Prince**](https://github.com/MaxHalford/prince/blob/master/README.md)库包含了[**MCA（多重对应分析）**](https://maxhalford.github.io/prince/mca/)方法，并且可以接受混合数据集。事实上，我鼓励你访问这个库的[**Github**](https://github.com/MaxHalford/prince)，它有许多非常有用的方法适用于不同情况，见下图：
- en: '![](../Images/a2500d92228134365fd7622e8bc462d4.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a2500d92228134365fd7622e8bc462d4.png)'
- en: '**The different methods of dimensionality reduction by type of case** (Image
    by Author and Prince Documentation).'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同类型案例的降维方法**（图像由作者和Prince文档提供）。'
- en: 'Well, the plan is to apply a MCA to reduce the dimensionality and be able to
    make graphical representations. For this we use the following code:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，计划是应用MCA来减少维度并进行图形表示。为此我们使用以下代码：
- en: '[PRE15]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '**Remember that if you want to follow each step 100%, you can take a look at**
    [**Jupyter notebook.**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kprototypes.ipynb)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '**记住，如果你想完全按照每一步操作，可以查看** [**Jupyter notebook.**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/kprototypes.ipynb)'
- en: 'The dataset named ***mca_3d_df*** contains that information:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 名为***mca_3d_df***的数据集包含了这些信息：
- en: '![](../Images/ee1d6c7977ffd3adb5dffd1be597b218.png)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ee1d6c7977ffd3adb5dffd1be597b218.png)'
- en: 'Let’s make a plot using the reduction provided by the MCA method:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们来绘制一个使用MCA方法提供的降维结果的图：
- en: '![](../Images/8ee972b3bc56c7b24139a73a20832f7a.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8ee972b3bc56c7b24139a73a20832f7a.png)'
- en: '**MCA space and the clusters created by the model** (Image by Author)'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '**MCA空间和模型创建的聚类**（图像由作者提供）'
- en: Wow, it doesn’t look very good… It is not possible to differentiate the clusters
    from each other. We can say then that the model is not good enough, right?
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 哇，这看起来不太好……无法区分各个聚类。那么我们可以说模型不够好，对吗？
- en: 'I hope you said something like:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望你说了类似的话：
- en: '**“Hey Damian, don’t go so fast!! Have you looked at the variability of the
    3 components provided by the MCA?”**'
  id: totrans-162
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**“嘿，Damian，别这么快！！你看过MCA提供的3个组件的变异性吗？”**'
- en: 'Indeed, we must see if the variability of the first 3 components is sufficient
    to be able to draw conclusions. The MCA method allows us to obtain these values
    in a very simple way:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们必须查看前三个组件的变异性是否足够以得出结论。MCA方法允许我们以非常简单的方式获得这些值：
- en: '[PRE16]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![](../Images/bf26aeea4e957ace0aa9a5106cc11687.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bf26aeea4e957ace0aa9a5106cc11687.png)'
- en: Aha, here we have something interesting. Due to our data we obtain basically
    zero variability.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 啊哈，这里有一些有趣的东西。由于我们的数据，基本上获得了零变异性。
- en: '**In other words, we cannot draw clear conclusions from our model with the
    information provided by the dimensionality reduction provided by MCA.**'
  id: totrans-167
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**换句话说，我们不能仅凭MCA提供的降维信息得出明确的结论。**'
- en: By showing these results I try to give an example of what happens in real data
    projects. Good results are not always obtained, but a good data scientist knows
    how to recognize the causes.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 通过展示这些结果，我尝试举例说明实际数据项目中会发生什么。好结果并不总是能获得，但一个好的数据科学家知道如何识别原因。
- en: 'We have one last option to visually determine if the model created by the K-Prototype
    method is suitable or not. This path is simple:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有一个最后的选项来直观地确定K-Prototype方法创建的模型是否合适。这个路径很简单：
- en: This is applying PCA to the dataset to which preprocessing has been performed
    to transform the categorical variables into numerical ones.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这就是对经过预处理的数据集应用PCA，将分类变量转换为数值变量。
- en: Obtain the components of the PCA
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取PCA的组件
- en: Make a representation using the PCA components such as the axes and the color
    of the points to predict the K-Prototype model.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用PCA组件制作表示图，例如轴线和点的颜色，以预测K-Prototype模型。
- en: 'Note that the components provided by the PCA will be the same as for method
    1: Kmeans, since it is the same dataframe.'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，PCA提供的组件将与方法1中的Kmeans相同，因为它使用的是相同的数据框。
- en: Let’s see what we get…
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看我们得到什么…
- en: '![](../Images/76483d5d757f720120829057b3750c34.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/76483d5d757f720120829057b3750c34.png)'
- en: '**PCA space and the clusters created by the model** (Image by Author).'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCA空间和模型创建的簇**（图片由作者提供）。'
- en: It doesn’t look bad, in fact it has a certain resemblance to what has been obtained
    in Kmeans.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来不错，实际上与Kmeans得到的结果有一定的相似性。
- en: 'Finally we obtain the average value of the clusters and the importance of each
    of the variables:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们获得簇的平均值以及每个变量的重要性：
- en: '![](../Images/e89e459dbfc54cb895d47ce3c551cb51.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e89e459dbfc54cb895d47ce3c551cb51.png)'
- en: '**The importance of the variables in the model. The table represents the most
    frequent value of each of the clusters** (Image by Author).'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型中变量的重要性。表格表示每个簇中最常见的值**（图片由作者提供）。'
- en: The variables with the greatest weight are the numerical ones, notably seeing
    that the confinement of these two features is almost sufficient to differentiate
    each cluster.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 权重大的是数值变量，特别是看到这两个特征的限制几乎足以区分每个簇。
- en: In short, it can be said that results similar to those of Kmeans have been obtained.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，可以说得到的结果与Kmeans类似。
- en: 'Method 3: LLM + Kmeans'
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方法3：LLM + Kmeans
- en: This combination can be quite powerful and improve the results obtained. Let’s
    get to the point!
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 这种组合可能非常强大，并且能提高获得的结果。直接进入正题！
- en: '**LLMs** cannot understand written text directly, we need to transform the
    input of this type of models. For this, **Sentence** **Embedding** is carried
    out. It consists of transforming the text into numerical vectors. The following
    image can clarify the idea:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '**LLMs**无法直接理解书面文本，我们需要对这种类型模型的输入进行转换。为此，**句子** **嵌入**被执行。它包括将文本转换为数值向量。以下图像可以阐明这个概念：'
- en: '![](../Images/3d290fea0c92e1135c7398c91a83cebb.png)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3d290fea0c92e1135c7398c91a83cebb.png)'
- en: '**Concept of embedding and similarity** (Image by Author).'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '**嵌入和相似性的概念**（图片由作者提供）。'
- en: 'This coding is done intelligently, that is, phrases that contain a similar
    meaning will have a more similar vector. See the following image:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 这种编码是智能完成的，即具有相似含义的短语将具有更相似的向量。请参见下图：
- en: '![](../Images/0842dedc820bb2634fb26a9e3c1621af.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0842dedc820bb2634fb26a9e3c1621af.png)'
- en: '**Concept of embedding and similarity** (Image by Author).'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '**嵌入和相似性的概念**（图片由作者提供）。'
- en: 'Sentence embedding is carried out by so-called transforms, algorithms specialized
    in this coding. Typically you can choose what the size of the numerical vector
    coming from this encoding is. And here is one of the key points:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 句子嵌入是通过所谓的变换进行的，这些算法专门用于这种编码。通常可以选择来自这种编码的数值向量的大小。这里是一个关键点：
- en: Thanks to the large dimension of the vector created by embedding, small variations
    in the data can be seen with greater precision.
  id: totrans-192
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 由于嵌入创建的向量维度较大，可以更精确地观察数据中的小变化。
- en: '**Therefore, if we provide input to our information-rich Kmeans model, it will
    return better predictions.** This is the idea we are pursuing and these are its
    steps:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '**因此，如果我们向信息丰富的Kmeans模型提供输入，它将返回更好的预测。** 这是我们追求的目标，以下是步骤：'
- en: Transform our original dataset through Sentence embedding
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过句子嵌入转换我们的原始数据集
- en: Create a Kmeans model
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个Kmeans模型
- en: Evaluate it
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 评估一下
- en: 'Well, the first step is to encode the information through Sentence embedding.
    What is intended is to take the information of each client and unify it into text
    that contains all its characteristics. This part takes a lot of computing time.
    That’s why I created a script that did this job, call [**embedding_creation.py**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/embedding_creation.py).
    This script collects the values contained in the training dataset and creates
    a new dataset provided by the embedding. This is the script code:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 首先一步是通过句子嵌入（Sentence embedding）来编码信息。目的是将每个客户的信息整合成包含其所有特征的文本。这部分需要大量计算时间。因此，我创建了一个脚本来完成这项工作，脚本名为[**embedding_creation.py**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/embedding_creation.py)。这个脚本收集训练数据集中包含的值，并创建一个由嵌入提供的新数据集。这是脚本的代码：
- en: '[PRE17]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'As it is quite important that this step is understood. Let’s go by points:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这一步骤的理解非常重要。我们逐点来看：
- en: '**Step 1**: The text is created for each row, which contains the complete customer/row
    information. We also store it in a python list for later use. See the following
    image that exemplifies it.'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 1 步**：为每一行创建文本，其中包含完整的客户/行信息。我们还将其存储在一个 Python 列表中以备后用。请参见下面的图片进行示例。'
- en: '![](../Images/6efefc20ec2db48dfc909a07ea91ed06.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6efefc20ec2db48dfc909a07ea91ed06.png)'
- en: '**Graphic description of the first step** (Image by Author).'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**第一步的图示**（图片作者提供）。'
- en: '**Step 2**: This is when the call to the transformer is made. For this we are
    going to use the model stored in [**HuggingFace**](https://huggingface.co). This
    model is specifically trained to perform embedding at the sentence level, unlike
    **Bert’s model**, which is focused on encoding at the level of tokens and words.
    To call the model you only have to give the repository address, which in this
    case is ***“sentence-transformers/paraphrase-MiniLM-L6-v2”***. The numerical vector
    that is returned to us for each text will be normalized, since the Kmeans model
    is sensitive to the scales of the inputs. The vectors created have a length of
    **384**. With them what we do is create a dataframe with the same number of columns.
    See the following image:'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 2 步**：这是调用转换器的阶段。为此，我们将使用存储在[**HuggingFace**](https://huggingface.co)上的模型。这个模型专门用于句子级别的嵌入，而不是**Bert
    模型**，后者专注于令牌和单词级别的编码。要调用模型，你只需提供存储库地址，这里的地址是 ***“sentence-transformers/paraphrase-MiniLM-L6-v2”***。返回给我们的每个文本的数值向量将被归一化，因为
    Kmeans 模型对输入的尺度敏感。创建的向量长度为**384**。我们用这些向量创建一个具有相同列数的数据框。请参见下面的图片：'
- en: '![](../Images/b658af3dd5b4fd45b9bc9acec31cb458.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b658af3dd5b4fd45b9bc9acec31cb458.png)'
- en: '**Graphic description of the second step** (Image by Author),'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**第二步的图示**（图片作者提供），'
- en: Finally we obtain the dataframe from the embedding, which will be the input
    of our Kmeans model.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 最终我们从嵌入中获得数据框，这将作为我们 Kmeans 模型的输入。
- en: '![](../Images/af3900f4d0c391bb833854baf8a987a0.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/af3900f4d0c391bb833854baf8a987a0.png)'
- en: This step has been one of the most interesting and important, since we have
    created the input for the Kmeans model that we will create.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 这一步是最有趣和重要的步骤之一，因为我们已经为即将创建的 Kmeans 模型创建了输入。
- en: The creation and evaluation procedure is similar to that shown above. In order
    not to make the post excessively long, only the results of each point will be
    shown. Don’t worry, all the code is contained in the [**jupyter notebook called
    *embedding***](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/embedding.ipynb)**,**
    so you can reproduce the results for yourself.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 创建和评估过程类似于上面所示。为了不使帖子过于冗长，只展示每个点的结果。别担心，所有代码都包含在[**名为 *embedding* 的jupyter notebook**](https://github.com/damiangilgonzalez1995/Clustering-with-LLM/blob/main/embedding.ipynb)**中**，所以你可以自己复现结果。
- en: In addition, the dataset resulting from applying the Sentence embedding has
    been saved in a csv file. This csv file is called ***embedding_train.csv***. In
    the Jupyter notebook you will see that we access that dataset and create our model
    based on it.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，应用句子嵌入后得到的数据集已保存为 csv 文件。该 csv 文件名为 ***embedding_train.csv***。在 Jupyter notebook
    中，你将看到我们如何访问该数据集并基于此创建我们的模型。
- en: '[PRE18]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Preprocessed
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预处理
- en: We could consider embedding as preprocessing.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将嵌入视为预处理。
- en: Outliers
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 离群点
- en: We apply the method already presented to detect outliers, **ECOD**. We create
    a dataset that does not contain these types of points.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应用了之前介绍的方法来检测离群点，即**ECOD**。我们创建了一个不包含这些类型点的数据集。
- en: '[PRE19]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Modeling
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建模
- en: First we must find out what the optimal number of clusters is. For this we use
    **Elbow Method**.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 首先我们必须找出最佳的簇数。为此我们使用**肘部法则**。
- en: '![](../Images/b8bf00f56eb101982c8bb2709a943f8d.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b8bf00f56eb101982c8bb2709a943f8d.png)'
- en: '**Elbow score for different numbers of clusters** (Image by Author).'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同簇数量的肘部得分**（图片来源：作者）。'
- en: After viewing the graph, we choose **k=5** as our number of clusters.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在查看了图表后，我们选择**k=5**作为簇的数量。
- en: '[PRE20]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Evaluation
  id: totrans-223
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评估
- en: 'The next thing is to create our Kmeans model with k=5\. Next we can obtain
    some metrics like these:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是创建我们的Kmeans模型，k=5。接下来我们可以获得一些类似于这些的指标：
- en: '[PRE21]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Seeing then that the values are really similar to those obtained in the previous
    case. Let’s study the representations obtained with PCA analysis:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 从而看到这些值与之前获得的值非常相似。我们来看一下通过PCA分析获得的表示：
- en: '![](../Images/2fb3b3166194753e03ac576a46b9539f.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2fb3b3166194753e03ac576a46b9539f.png)'
- en: '**PCA space and the clusters created by the model** (Image by Author).'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCA空间和模型创建的簇**（图片来源：作者）。'
- en: It can be seen that the clusters are much better differentiated than with the
    traditional method. This is good news. Let us remember that it is important to
    take into account the variability contained in the first 3 components of our PCA
    analysis. From experience, I can say that when it is around 50% (3D PCA) more
    or less clear conclusions can be drawn.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看出，簇的区分比传统方法好得多。这是好消息。我们要记住，考虑到PCA分析中前三个组件的变异性是很重要的。根据经验，当变异性在50%左右（3D PCA）时，可以得出比较明确的结论。
- en: '![](../Images/425669b9db5825251def7820d142dd08.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/425669b9db5825251def7820d142dd08.png)'
- en: '**PCA space and the clusters created by the model. The variability of the first
    3 components of the PCA is also shown** (Image by Author).'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCA空间和模型创建的簇。还显示了PCA前三个组件的变异性**（图片来源：作者）。'
- en: We see then that it is 40.44% cumulative variability of the 3 components, it
    is acceptable but not ideal.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到3个组件的累积变异性为40.44%，这虽然可以接受，但不理想。
- en: 'One way I can visually see how compact the clusters are is by modifying the
    opacity of the points in the 3D representation. This means that when the points
    are agglomerated in a certain space, a black spot can be observed. In order to
    understand what I’m saying, I show the following gif:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以通过修改3D表示中点的透明度来直观地查看簇的紧凑程度。这意味着当点在某个空间中聚集时，可以观察到黑点。为了理解我的意思，我展示以下gif：
- en: '[PRE22]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![](../Images/1624503423cef2263b7c21f07799acfa.png)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1624503423cef2263b7c21f07799acfa.png)'
- en: '**PCA space and the clusters created by the model** (Image by Author).'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '**PCA空间和模型创建的簇**（图片来源：作者）。'
- en: As can be seen, there are several points in space where the points of the same
    cluster cluster together. This indicates that they are well differentiated from
    the other points and that the model knows how to recognize them quite well.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 从图中可以看出，空间中存在几个点，其中同一簇的点聚集在一起。这表明它们与其他点区分良好，且模型能相当准确地识别它们。
- en: 'Even so, it can be seen that various clusters cannot be differentiated well
    (Ex: cluster 1 and 3). For this reason, we carry out a **t-SNE** analysis, which
    we remember is a method that allows reducing dimensionality, taking into account
    complex polynomial relationships.'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 即便如此，可以看出有些簇无法很好地区分（例如：簇1和簇3）。因此，我们进行**t-SNE**分析，记住这是一种能够考虑复杂多项式关系的降维方法。
- en: '![](../Images/1720bda644e33898311476d74e34ac27.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1720bda644e33898311476d74e34ac27.png)'
- en: '**t-SNE space and the clusters created by the model** (Image by Author).'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '**t-SNE空间和模型创建的簇**（图片来源：作者）。'
- en: 'A noticeable improvement is seen. The clusters do not overlap each other and
    there is a clear differentiation between points. The improvement obtained using
    the second dimensionality reduction method is notable. Let’s see a 2D comparison:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 显著的改进可以观察到。簇之间没有重叠，点之间的区分很清晰。使用第二种降维方法获得的改进是显著的。我们来看一下2D对比：
- en: '![](../Images/c5058a99e44ac62a383ad3c7b7c7965c.png)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c5058a99e44ac62a383ad3c7b7c7965c.png)'
- en: '**Different results for different dimensionality reduction methods and clusters
    defined by the model** (Image by Author).'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同降维方法和模型定义的簇的不同结果**（图片来源：作者）。'
- en: Again, it can be seen that the clusters in the t-SNE are more separated and
    better differentiated than with the PCA. Furthermore, the difference between the
    two methods in terms of quality is smaller than when using the traditional Kmeans
    method.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 再次可以看出，t-SNE中的集群比PCA中的集群更为分离和区分。此外，两个方法在质量上的差异比传统Kmeans方法时要小。
- en: 'To understand which variables our Kmeans model relies on, we do the same move
    as before: we create a *classification model (LGBMClassifier) and analyze the
    importance of the features.*'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解我们的Kmeans模型依赖于哪些变量，我们进行与之前相同的操作：我们创建一个*分类模型（LGBMClassifier）并分析特征的重要性。*
- en: '![](../Images/606c851fed35b10f19d97c135ebff89d.png)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/606c851fed35b10f19d97c135ebff89d.png)'
- en: '**The importance of the variables in the model** (Image by Author).'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型中变量的重要性**（图像来源：作者）。'
- en: We see then that this model is based above all on the “***marital***” and “***job***”
    variables. On the other hand we see that there are variables that do not provide
    much information. In a real case, a new version of the model should be created
    without these variables with little information.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到这个模型主要基于“***婚姻状态***”和“***职业***”变量。另一方面，我们看到有些变量提供的信息不多。在实际情况中，应该创建一个不包含这些信息较少的变量的新版本模型。
- en: '**The Kmeans + Embedding model is more optimal since it needs fewer variables
    to be able to give good predictions**. Good news!'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '**Kmeans + 嵌入模型更为优化，因为它需要的变量更少，就能提供良好的预测**。好消息！'
- en: We finish with the part that is most revealing and important.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 我们结束于最具揭示性和重要的部分。
- en: Managers and the business are not interested in PCA, t-SNE or embedding. What
    they want is to be able to know what the main traits are, in this case, of their
    clients.
  id: totrans-251
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 管理者和业务方对PCA、t-SNE或嵌入并不感兴趣。他们想要的是能够了解主要特征，这里指的是他们客户的主要特征。
- en: 'To do this, we create a table with information about the predominant profiles
    that we can find in each of the clusters:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们创建了一张表格，列出我们在每个集群中可以找到的主要特征信息：
- en: '![](../Images/e65d0d21fb227b2310e3ecfe29c98eb6.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e65d0d21fb227b2310e3ecfe29c98eb6.png)'
- en: 'Something very curious happens: the clusters where the most frequent position
    is that of “***management***” are 3\. In them we find a very peculiar behavior
    where the single managers are younger, those who are married are older and the
    divorced are the how older they are. On the other hand, the balance behaves differently,
    single people have a higher average balance than divorced people, and married
    people have a higher average balance. What was said can be summarized in the following
    image:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 发生了一个非常有趣的现象：集群中最频繁的职位是“***管理***”的有3个。在这些集群中，我们发现一个非常特殊的行为，单身的管理者较年轻，已婚者较年长，而离婚者则较老。另一方面，余额的行为则不同，单身人士的平均余额高于离婚人士，已婚人士的平均余额更高。上述情况可以在以下图像中总结：
- en: '![](../Images/f4b304ccef2795bed37f9d5dce880a27.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f4b304ccef2795bed37f9d5dce880a27.png)'
- en: '**Different customer profiles defined by the model** (Image by Author).'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '**模型定义的不同客户档案**（图像来源：作者）。'
- en: This revelation is in line with reality and social aspects. It also reveals
    very specific customer profiles. **This is the magic of data science.**
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 这一揭示与现实和社会方面一致。它还揭示了非常具体的客户档案。**这就是数据科学的魅力。**
- en: Conclusion
  id: totrans-258
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: 'The conclusion is clear:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 结论很明确：
- en: '![](../Images/63460fbab29ae05068d9b91c87bc35b9.png)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/63460fbab29ae05068d9b91c87bc35b9.png)'
- en: (Image by Author)
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: （图像来源：作者）
- en: You have to have different tools because in a real project, not all strategies
    work and you must have resources to add value. It is clearly seen that the model
    created with the help of the LLMs stands out.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须拥有不同的工具，因为在实际项目中，并非所有策略都有效，你必须有资源来增值。显然，利用LLMs创建的模型表现突出。
- en: '*Thank you for reading!*'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: '*感谢您的阅读！*'
- en: '*If you find my work useful, you can subscribe to* [***get an email every time
    that I publish a new article***](https://medium.com/@damiangilgonzalez/subscribe)***.***'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果你觉得我的工作有用，可以订阅* [***每次发布新文章时接收邮件***](https://medium.com/@damiangilgonzalez/subscribe)***。***'
- en: '*If you’d like,* [***follow******me on Linkedin****!*](https://www.linkedin.com/in/damiangilgonzalez/)'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果你愿意，* [***在Linkedin上关注我***](https://www.linkedin.com/in/damiangilgonzalez/)
    ***！***'

- en: Differential Equations as a Pytorch Neural Network Layer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/differential-equations-as-a-pytorch-neural-network-layer-7614ba6d587f?source=collection_archive---------3-----------------------#2023-04-26](https://towardsdatascience.com/differential-equations-as-a-pytorch-neural-network-layer-7614ba6d587f?source=collection_archive---------3-----------------------#2023-04-26)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How to use differential equations layers in pytorch
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@moleculeboy24?source=post_page-----7614ba6d587f--------------------------------)[![Kevin
    Hannay](../Images/6dfcf0384e2a8aac0dd27a216ed2d92c.png)](https://medium.com/@moleculeboy24?source=post_page-----7614ba6d587f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----7614ba6d587f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----7614ba6d587f--------------------------------)
    [Kevin Hannay](https://medium.com/@moleculeboy24?source=post_page-----7614ba6d587f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2aee0cbca1e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferential-equations-as-a-pytorch-neural-network-layer-7614ba6d587f&user=Kevin+Hannay&userId=2aee0cbca1e1&source=post_page-2aee0cbca1e1----7614ba6d587f---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----7614ba6d587f--------------------------------)
    ·17 min read·Apr 26, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7614ba6d587f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferential-equations-as-a-pytorch-neural-network-layer-7614ba6d587f&user=Kevin+Hannay&userId=2aee0cbca1e1&source=-----7614ba6d587f---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7614ba6d587f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferential-equations-as-a-pytorch-neural-network-layer-7614ba6d587f&source=-----7614ba6d587f---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: Differential equations are the mathematical foundation for most of modern science.
    They describe the state of a system using an equation for the rate of change (differential).
    It is remarkable how many systems can be well described by equations of this form.
    For example, the physical laws describing motion, electromagnetism and quantum
    mechanics all take this form. More broadly, differential equations describe chemical
    reaction rates through the law of mass action, neuronal firing and disease spread
    through the SIR model.
  prefs: []
  type: TYPE_NORMAL
- en: The deep learning revolution has brought with it a new set of tools for performing
    large scale optimizations over enormous datasets. In this post, we will see how
    you can use these tools to fit the parameters of a custom differential equation
    layer in pytorch.
  prefs: []
  type: TYPE_NORMAL
- en: What is the problem we are trying to solve?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s say we have some time series data y(t) that we want to model with a differential
    equation. The data takes the form of a set of observations yᵢ at times tᵢ. Based
    on some domain knowledge of the underlying system we can write down a differential
    equation to approximate the system.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the most general form this takes the form:'
  prefs: []
  type: TYPE_NORMAL
- en: where y is the state of the system, t is time, and θ are the parameters of the
    model. In this post we will assume that the…
  prefs: []
  type: TYPE_NORMAL

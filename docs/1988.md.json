["```py\nWITH transactions AS (\n  SELECT 1000001 AS order_id, TIMESTAMP('2017-12-18 15:02:00') AS order_time,\n          STRUCT(65401 AS id, 'John Doe' AS name, 'Norway' AS location) AS customer,\n          [\n            STRUCT('xxx123456' AS sku, 3 AS quantity, 1.3 AS price),\n            STRUCT('xxx535522' AS sku, 6 AS quantity, 500.4 AS price),\n            STRUCT('xxx762222' AS sku, 4 AS quantity, 123.6 AS price)\n          ] AS orders\n  UNION ALL\n  SELECT 1000002, TIMESTAMP('2017-12-16 11:34:00'),\n        STRUCT(74682, 'Jane Smith', 'Poland') AS customer,\n        [\n            STRUCT('xxx635354',   4,      345.7),\n            STRUCT('xxx828822', 2,      9.5)\n        ] AS orders\n)\n\nselect *\n\nfrom\ntransactions\n```", "```py\nselect customer.name, sum(a.quantity)\n\nfrom\ntransactions t, UNNEST(t.orders) as a\ngroup by  customer.name\n```", "```py\nMERGE INTO client AS tgt\nUSING (\n    SELECT \nClient_id,\nName,       \nSurname,\nCity\n      GETDATE() AS ValidFrom\n    ‘20199-01-01’ AS ValidTo\nfrom client_stg\n) AS src\nON (tgt.Clinet_id = src.Clinet_id AND tgt.iscurrent = 1)\nWHEN MATCHED THEN\n    UPDATE SET tgt.iscurrent = 0, ValidTo = GETDATE()\nWHEN NOT MATCHED THEN\n    INSERT (Client_id, name, Surname, City, ValidFrom, ValidTo, iscurrent)\n    VALUES (Client_id, name, Surname, City, ValidFrom, ValidTo,1);\n```"]
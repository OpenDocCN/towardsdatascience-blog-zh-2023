["```py\n=TEXT(DATE(2020,1,1)+ROW(A1)/24, “yyyy-mm-dd hh:mm:ss”)\n```", "```py\n'Use Option Base 1 before this subroutine if you want to start the list from 1 instead of 0.\n'https://excelchamps.com/vba/arrays/\nOption Base 1\nSub GetMonthlyAverage()\n\n'defining an array for 4 strings\nDim columns(4) As String\ncolumns(1) = \"B\"\ncolumns(2) = \"C\"\ncolumns(3) = \"D\"\ncolumns(4) = \"E\"\n\n'Refer to cell A1\nDim datetime As Range\nSet datetime = Range(\"datetime\")\n\n'Definining mnth because Month is a function\nDim mnth As Integer\nDim row As Integer\n\nDim sum As Double\nDim num_hours As Double \n```", "```py\n'Loop through column for each city\nFor Each column In columns\n\n    'Loop through each month of the year\n    For mnth = 1 To 12\n\n        sum = 0\n        num_hours = 0\n\n        'Loop through each row\n        For row = 2 To 8785\n\n            If MONTH(Cells(row, datetime.column)) = mnth Then\n                Range(column & row).Interior.Color = RGB(255, 255, 0)\n                num_hours = num_hours + 1\n                sum = sum + Range(column & row).Value\n\n            End If\n\n        Next row\n\n        Range(column & mnth).Offset(1, 7).Value = sum / num_hours\n\n    Next mnth\n\nNext column\n\nEnd Sub\n```", "```py\nOption Base 1\nSub GetHourlyAverage()\n\n‘defining an array for 4 strings\nDim columns(4) As String\ncolumns(1) = “B”\ncolumns(2) = “C”\ncolumns(3) = “D”\ncolumns(4) = “E”\n\n'Definining mnth because Month is a function\nDim mnth As Integer\nDim row As Integer\n\nDim sum As Double\nDim num_hours As Double\n\nDim wb As Workbook\nDim ws As Worksheet\nDim datetime As Range\nDim last_row As Integer\n\nSet wb = ThisWorkbook\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\nSet datetime = ws.Range(\"datetime\")\nlast_row = Cells(datetime.row, datetime.column).End(xlDown).row\n\nDebug.Print datetime.Value\nDebug.Print \"Row: \" & datetime.row & \" Column: \" & datetime.column\nDebug.Print \"Last row: \" & last_row\n\n'Loop through column for each city\nFor Each column In columns\n\n    'Loop through each hour of the day\n    For hr = 0 To 23\n\n        sum = 0\n        num_hours = 0\n\n        'Loop through each row\n        For row = datetime.row + 1 To last_row\n\n            If Hour(Cells(row, datetime.column).Value) = hr Then\n                Range(column & row).Interior.Color = RGB(255, 255, 0)\n                num_hours = num_hours + 1\n                sum = sum + Range(column & row).Value\n\n            End If\n\n        Next row\n\n        Range(column & hr + 2).Offset(0, 14).Value = sum / num_hours\n\n    Next hr\n\nNext column\n\nEnd Sub\n```", "```py\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os\nimport sys\n\n#Enter os system to current working directory\nos.chdir(sys.path[0])\nfile = \"solar_irradiance.xlsm\"\n\n#read all rows and first 5 columns\ndf = pd.read_excel(file).iloc[:, :5]\ndf[\"Datetime\"] = pd.to_datetime(df[\"Datetime\"])\ndf.set_index([\"Datetime\"], inplace = True)\n\nfrequency = input(\"Enter the frequency you want to display? \\n1\\. Original \\n2\\. Monthly average\\n3\\. Daily average \\n4\\. Weekly average\\n 5.Quarterly average \\n 6.All of the above \\n 7\\. Hourly average \\n? \")\n\nif frequency == \"Original\":\n    print (df)\n    df.plot()\n    plt.title(\"Original solar irradiance in 2020\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.legend()\n    plt.show()\n\nelif frequency == \"Monthly average\":\n    print (df.resample(rule = \"M\").mean())\n    df.resample(rule = \"M\").mean().plot()\n    plt.title(\"Monthly average solar irradiance in 2022\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.legend()\n    plt.show()\n\nelif frequency == \"Daily average\":\n    print (df.resample(rule = \"D\").mean())\n    df.resample(rule = \"D\").mean().plot()\n    plt.title(\"Daily average solar irradiance in 2022\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.show()\n\nelif frequency == \"Weekly average\":\n    print (df.resample(rule = \"W\").mean())\n    df.resample(rule = \"W\").mean().plot()\n    plt.title(\"Weekly average solar irradiance in 2022\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.legend()\n    plt.show()\n\nelif frequency == \"Quarterly average\":\n    print (df.resample(rule = \"Q\").mean())\n    df.resample(rule = \"Q\").mean().plot()\n    plt.title(\"Quarterly average solar irradiance in 2022\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.legend()\n    plt.show()\n\nelif frequency == \"All of the above\":\n    fig, axs = plt.subplots(2, 2, figsize = (20, 10), sharex = True, sharey = True)\n    df.resample(rule = \"D\").mean().plot(ax = axs[0, 0])\n    axs[0, 0].set_title(\"Daily mean\")\n    axs[0, 0].set_ylabel(\"Wh/m$^2$\")\n    df.resample(rule = \"W\").mean().plot(ax = axs[0, 1])\n    axs[0, 1].set_title(\"Weekly mean\")\n    df.resample(rule = \"M\").mean().plot(ax = axs[1, 0])\n    axs[1, 0].set_title(\"Monthly mean\")\n    axs[1, 0].set_ylabel(\"Wh/m$^2$\")\n    df.resample(rule = \"Q\").mean().plot(ax = axs[1, 1])\n    axs[1, 1].set_title(\"Quarterly mean\")fig.suptitle(\"Mean solar irradiance in four locations converted to different temporal frequencies\")\n    plt.show()\n\nelif frequency == \"Hourly average\":\n    #average value in each hour within 24 hours of a day\n    print (df.groupby(df.index.hour).mean())\n    df.groupby(df.index.hour).mean().plot()\n    plt.title(\"Hourly average solar irradiance in 2022\")\n    plt.ylabel(\"Wh/m$^2$\")\n    plt.legend()\n    plt.show()\n\nelse:\n    print (\"The frequency you entered is incorrect.\")\n```", "```py\nSub RunPythonScript()\nDim objShell As Object\nDim PythonExePath As String, PythonScriptPath As String\nActiveWorkbook.Save\n\n'Enter into the path of given workbook\nChDir Application.ThisWorkbook.Path\nSet objShell = VBA.CreateObject(“Wscript.Shell”)\n\n'Enter into the path of given workbook\nChDir Application.ThisWorkbook.Path\n\n    Set objShell = VBA.CreateObject(\"Wscript.Shell\")\n\n    'Goto cmd. Type where python to get this path. Note that there are three quotes below.\n    ' The hash symbol # below needs to be filled with the path in your system.\n    PythonExePath = \"\"\"C:\\Users\\#######################\\python.exe\"\"\"\n\n    'Get the path of the file.\n    PythonScriptPath = Application.ThisWorkbook.Path & \"\\python_script.py\"\n\n    objShell.Run PythonExePath & PythonScriptPath\n\nEnd Sub\n```"]
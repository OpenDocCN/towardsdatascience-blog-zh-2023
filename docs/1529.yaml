- en: Exploratory Correlational Analysis in R
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/exploratory-correlational-analysis-in-r-c99449b2e3f8?source=collection_archive---------5-----------------------#2023-05-05](https://towardsdatascience.com/exploratory-correlational-analysis-in-r-c99449b2e3f8?source=collection_archive---------5-----------------------#2023-05-05)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Painless and tidyverse-friendly correlational analysis using rstatix
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@mapes.brendan?source=post_page-----c99449b2e3f8--------------------------------)[![Brendan
    Mapes](../Images/689cbc16c4e916eefcaf5a58d46d76ed.png)](https://medium.com/@mapes.brendan?source=post_page-----c99449b2e3f8--------------------------------)[](https://towardsdatascience.com/?source=post_page-----c99449b2e3f8--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----c99449b2e3f8--------------------------------)
    [Brendan Mapes](https://medium.com/@mapes.brendan?source=post_page-----c99449b2e3f8--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F225e9dd00ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-correlational-analysis-in-r-c99449b2e3f8&user=Brendan+Mapes&userId=225e9dd00ec5&source=post_page-225e9dd00ec5----c99449b2e3f8---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----c99449b2e3f8--------------------------------)
    ·7 min read·May 5, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc99449b2e3f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-correlational-analysis-in-r-c99449b2e3f8&user=Brendan+Mapes&userId=225e9dd00ec5&source=-----c99449b2e3f8---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc99449b2e3f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploratory-correlational-analysis-in-r-c99449b2e3f8&source=-----c99449b2e3f8---------------------bookmark_footer-----------)![](../Images/086179378c48b920caad6a73b74f5d86.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Armand Khoury](https://unsplash.com/@armand_khoury?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 'Correlational analysis is one of the most basic and foundational ways to explore
    the relationship between two or more variables. You may have already performed
    correlational analysis at some point using R, and it might have looked something
    like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'With an output looking like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/91734a2460dee78382fd3ef4e328addc.png)'
  prefs: []
  type: TYPE_IMG
- en: This is the base R way to run a simple correlation for two variables that you’ve
    already picked out in advance.
  prefs: []
  type: TYPE_NORMAL
- en: But what if you didn’t really know what you were looking for? If you’re just
    at the stage of conducting some [exploratory data analysis](https://www.ibm.com/topics/exploratory-data-analysis),
    you might not know what variables you’re interested in, or where you might want
    to look for associations. What might be useful in this case is to be able to pick
    a variable of interest, and then check against a dataset with multiple, maybe
    even hundreds of variables, in order to figure out a good starting point for further
    analysis. Thanks to the rstatix package developed by [kassambara](https://github.com/kassambara),
    there is a quick and relatively painless way to do this.
  prefs: []
  type: TYPE_NORMAL
- en: Getting the Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For an example, I’ll use data from the World Bank’s [World Development Indicators](https://data.worldbank.org/)
    (WDI) dataset — a repository of open access data on global development indicators.
    We could access the WDI from the website linked above, but there’s also an [R
    package for that](https://github.com/vincentarelbundock/WDI) —
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Specific data series can be imported from WDI using the WDI() function, but
    because we’re interested in exploratory analysis covering possible relationship
    between lots of variables, I’m going to bulk download the whole database…
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Let’s say we’re interested in trying to figure out what other country characteristics
    might be associated with countries that trade more, relative to the size of their
    economy, and we’re also interested in data from the year 2020.
  prefs: []
  type: TYPE_NORMAL
- en: Once we’ve identified the right variable (here I’m going to use [Trade as a
    % of GDP](https://data.worldbank.org/indicator/NE.TRD.GNFS.ZS)), we need to clean
    up the data a bit. We’ll create a list of series that are annual that we can filter
    on, and then apply another filtering step to make sure that we are only using
    variables that have a good number of observations to use in the analysis (arbitrarily,
    n>100 in the example below).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Running the Analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: So now we have a list of variables to run through — about 790 of them — to see
    which might be correlated with our trade level variable. This would take forever
    to run through manually, or with a loop on cor.test() from base R. This is where
    the cor_test() function in rstatix shines — it runs pretty quickly, output from
    the correlational analysis is dumped into a tibble format (making it easy to perform
    additional manipulation and analysis), and the functions are pipe-friendly, meaning
    that we can combine filtering, mutation, and execution steps together into a single
    piped framework, and we can also group variable inputs for grouped output from
    rstatix (we’ll look at some examples of this a little later).
  prefs: []
  type: TYPE_NORMAL
- en: 'So, to run the analysis:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This populates a [tidy](/what-is-tidy-data-d58bb9ad2458) tibble with the variable
    pairings, correlation coefficient (*r*), t-statistic, confidence level (*p*),
    and a low and high confidence estimate. For our example run above, it looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9ca7e003bfa70af679963f5a578ea5af.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Because the output is a tibble, we can sort and decompose it however we want.
    Let’s make a key with the variable name and description, join that into our output
    data, filter for only variable pairings that were significant at *p* > 0.05 levels,
    and check out what variables had the highest *r* value:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/0234ddf54f28f90079499cf2d0878c6b.png)'
  prefs: []
  type: TYPE_IMG
- en: Some of the variables with the highest correlations wont be surprising — overall
    trade is positively correlated at a high level across countries with trade in
    services and merchandise, for example. Others might be more unexpected — like
    the moderately high positive correlation (*r* = 0.43) between level of trade and
    the amount of Official Development Assistance (aid funding) that a country receives
    as a percent of gross capital formation (often used as an [indicator of aid “dependency”](https://data.worldbank.org/indicator/DT.ODA.ODAT.GI.ZS)
    — the bottom row in the image above).
  prefs: []
  type: TYPE_NORMAL
- en: Grouped Analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: So what if we wanted to look into this relationship more? For example — is the
    relationship still strong if we look at other years besides 2020? This is where
    the pipe-friendly nature of cor_test() again comes in handy.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s filter our initial data to include just the two indicators we’re interested
    in, and then group the data by year before piping it into cor_test() this time:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'This will give us output on the correlation between the two variables, in each
    year with observations (I filtered the data to only years prior to 2021, because
    the ODA data only runs up to 2020). And because the correlation data is stored
    in a tidy way, we can easily run additional code to visualize our results:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Here we can see that historically there hasn’t been much of a relationship
    between these two variables at all (apart from a few years here and there with
    a weak negative relationship), but in the past few years the correlation has trended
    significant and positive:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7ca548f47f06697ba250b6c7303b19a9.png)'
  prefs: []
  type: TYPE_IMG
- en: So what does this mean? In terms of any potential questions around the relationship
    between trade and aid — we’d have to do a lot more research. C[orrelation doesn’t
    imply causation](https://www.britannica.com/topic/causation) after all, but this
    is a good hypothesis generator - are aid-receiving countries becoming increasingly
    trade-oriented? Or are the patterns of aid delivery shifting to favor countries
    who trade more? These are new avenues for us to explore. These sorts of quick
    correlational analyses can be a really useful tool for things like trends analysis
    or signal spotting — and having a tidyverse-friendly way to do it really avoids
    a potential headache.
  prefs: []
  type: TYPE_NORMAL
- en: In terms of our ability to conduct some useful exploratory analysis quickly
    and easily, we can see that rstatix is a helpful companion package. However, there
    are a few drawbacks to cor_test() in rstatix —
  prefs: []
  type: TYPE_NORMAL
- en: You are limited to Pearson (r*)*, Spearman (ρ), and Kendall (τ) correlation
    methods, compared to quite a few more in the “[correlation](https://cran.r-project.org/web/packages/correlation/correlation.pdf)”
    package, for example. These are however, the most common for casual users and
    should be more than sufficient for basic analysis.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Confidence intervals are only reported in the output for Pearson’s r. Meaning
    that if confidence intervals are needed for Spearman’s rho or Kendall’s tau, additional
    code will be required.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sample size and degrees of freedom are not reported, which could be annoying
    if the user’s aim is to develop multiple reports on outputs based on different
    grouped segments, for example.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: But these won’t typically apply for the casual user. Additionally, beyond cor_test(),
    rstatix also has a large number of other functions for various other statistical
    tests and procedures, which are definitely worth looking into the next time you
    need to do some exploratory statistical analysis — so shout out to the developers
    on this one.
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: *For a more in-depth look at the differences between rstatix and other
    available packages for correlational analysis in R, interested readers can see:*
    [*https://www.r-bloggers.com/2021/01/correlation-analysis-in-r-part-2-performing-and-reporting-correlation-analysis/*](https://www.r-bloggers.com/2021/01/correlation-analysis-in-r-part-2-performing-and-reporting-correlation-analysis/)'
  prefs: []
  type: TYPE_NORMAL
- en: Enjoyed this story? [Follow me](https://medium.com/@mapes.brendan) on Medium,
    or connect with me on [LinkedIn](https://www.linkedin.com/in/mapesbrendan/) or
    [Twitter](https://twitter.com/MapesBrendan).
  prefs: []
  type: TYPE_NORMAL

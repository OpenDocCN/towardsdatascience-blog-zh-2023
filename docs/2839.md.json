["```py\n# bit and byte configuration\nbnb_config = transformers.BitsAndBytesConfig(\n    load_in_4bit=True,  # 4-bit quantization\n    bnb_4bit_quant_type='nf4',  # Normalized float 4\n    bnb_4bit_use_double_quant=True,  # Second quantization after the first\n    bnb_4bit_compute_dtype=bfloat16  # Computation type\n)\nmodel_id= \"meta-llama/Llama-2-7b-chat-hf\"\ndevice = f'cuda:{cuda.current_device()}' if cuda.is_available() else 'cpu'\n\n# Llama 2 Tokenizer\ntokenizer =transformers.AutoTokenizer.from_pretrained(model_id)\n\n# Llama 2 Model\nmodel = transformers.AutoModelForCausalLM.from_pretrained(\n    model_id,\n    trust_remote_code=True,\n    quantization_config=bnb_config,\n    device_map='auto',\n)\nmodel.eval()\n\n# Difine pipeline \n transformers.pipeline(model=model,\n    tokenizer=tokenizer,\n    return_full_text=True,  # langchain expects the full text\n    task='text-generation',\n    # we pass model parameters here too\n    max_new_tokens=500,  # max number of tokens to generate in the output\n    temperature=0.1,\n    )\n```", "```py\nParis, the capital of France, is known for its stunning architecture, art museums, historical landmarks, and romantic atmosphere. everybody's dream destination. Here are some of the top things to do in Paris:\n\n1\\. Visit iconic landmarks: The Eiffel Tower, the Louvre Museum, Notre-Dame Cathedral, Arc de Triomphe, and the Champs-Élysées are must-visit attractions.\n\n2\\. Explore museums and art galleries: The Louvre, Musée d'Orsay, and Centre Pompidou are some of the world's most famous museums.\n\n3\\. Take a river cruise: A Seine River cruise is a great way to see the city's landmarks and bridges while learning about its history and culture.\n\n4\\. Discover the city's neighborhoods: From the fashionable Champs-Élysées to the charming Montmartre, each Parisian neighborhood has its own unique character and charm.\n\n# I skipped some text here because of the limt of space# \n\nOf course, there are countless\n```", "```py\nclass EosTokenRewardLogitsProcessor(LogitsProcessor):\n  def __init__(self,  eos_token_id: int, max_length: int):\n\n        if not isinstance(eos_token_id, int) or eos_token_id < 0:\n            raise ValueError(f\"`eos_token_id` has to be a positive integer, but is {eos_token_id}\")\n\n        if not isinstance(max_length, int) or max_length < 1:\n          raise ValueError(f\"`max_length` has to be a integer bigger than 1, but is {max_length}\")\n\n        self.eos_token_id = eos_token_id\n        self.max_length=max_length\n\n  def __call__(self, input_ids: torch.LongTensor, scores: torch.FloatTensor) -> torch.FloatTensor:\n    cur_len = input_ids.shape[-1]\n    # start to increese the reward of the  eos_tokekn from 80% max length  progressively on length\n    for cur_len in (max(0,int(self.max_length*0.8)), self.max_length ):\n      ratio = cur_len/self.max_length\n      num_tokens = scores.shape[1] # size of vocab\n      scores[:, [i for i in range(num_tokens) if i != self.eos_token_id]] =\\\n      scores[:, [i for i in range(num_tokens) if i != self.eos_token_id]]*ratio*10*torch.exp(-torch.sign(scores[:, [i for i in range(num_tokens) if i != self.eos_token_id]]))\n      scores[:, self.eos_token_id] = 1e2*ratio\n    return scores\n```", "```py\npipe = transformers.pipeline(model=model,\n    tokenizer=tokenizer,\n    return_full_text=True,  # langchain expects the full text\n    task='text-generation',\n    # we pass model parameters here too\n    #stopping_criteria=stopping_criteria,  # without this model rambles during chat\n    logits_processor=logits_process_list,\n    max_new_tokens=500,  # max number of tokens to generate in the output\n    temperature=0.1,\n    )\n```", "```py\nParis, the capital of France, is known for its stunning architecture, art museums, historical landmarks, and romantic atmosphere.\n```", "```py\n<s>[INST] <<SYS>>\n{your_system_message}\n<</SYS>> {user_message_1} [/INST]\n```", "```py\n# Load LoRA configuration\npeft_config = LoraConfig(\n    lora_alpha=lora_alpha,\n    lora_dropout=lora_dropout,\n    r=lora_r,\n    bias=\"none\",\n    task_type=\"CAUSAL_LM\",\n)\n\n# Set supervised fine-tuning parameters\ntrainer = SFTTrainer(\n    model=model,\n    train_dataset=dataset,\n    peft_config=peft_config,\n    dataset_text_field=\"text\",\n    max_seq_length=max_seq_length,\n    tokenizer=tokenizer,\n    args=training_arguments,\n    packing=packing,\n)\n\n# Train model\ntrainer.train()\n```", "```py\n Paris, the capital of France, is known for its stunning architecture, rich history, and cultural attractions. Here are some popular things to do in Paris:\n\n1\\. Visit iconic landmarks: The Eiffel Tower, Arc de Triomphe, Notre-Dame Cathedral, and the Louvre Museum are some of the most famous landmarks in Paris.\n2\\. Explore museums and art galleries: Paris is home to many world-class museums and art galleries, including the Louvre, the Musée d'Orsay, and the Pompidou Center.\n3\\. Enjoy the city's gardens and parks: Paris has several beautiful gardens and parks, including the Luxembourg Gardens, the Tuileries Garden, and the Champ de Mars.\n4\\. Take a river cruise: A river cruise along the Seine is a great way to see the city's sights and learn about its history.\n5\\. Shop on the Champs-Élysées: The famous avenue is lined with high-end boutiques, department stores, and cafes.\n6\\. Attend a cabaret show: The Moulin Rouge is a famous cabaret that offers a lively and entertaining show.\n7\\. Visit Montmartre: The charming neighborhood of Montmartre is known for its artistic vibe, street performers, and stunning views of the city.\n8\\. Take a food tour: Paris is known for its culinary delights, and a food tour is a great way to sample the city's famous cuisine.\n9\\. Visit the Palace of Versailles: The Palace of Versailles is a beautiful royal palace located just outside of Paris.\n10\\. Attend a fashion show: Paris is the fashion capital of the world, and attending a fashion show is a great way to see the latest trends and styles.\n\nThese are just a few of the many things to do in Paris. The city has something for everyone, from history and culture to food and entertainment.\n```", "```py\nSure! Here are five things you can do in Paris: 1\\. Visit the Eiffel Tower, a iconic landmark that offers stunning views of the city. 2\\. Explore the Louvre Museum and see famous artworks like the Mona Lisa. 3\\. Stroll along the Seine River and enjoy the city's picturesque bridges and charming streets. 4\\. Visit the Notre-Dame Cathedral, a beautiful and historic church. 5\\. Enjoy a delicious French meal at a traditional bistro or restaurant.\n```", "```py\n# define custom stopping criteria object\nclass StopOnTokens(StoppingCriteria):\n    def __call__(self, input_ids: torch.LongTensor, scores: torch.FloatTensor, **kwargs) -> bool:\n        for stop_ids in stop_token_ids:\n            if torch.eq(input_ids[0][-len(stop_ids):], stop_ids).all():\n                return True\n        return False\n\nstopping_criteria = StoppingCriteriaList([StopOnTokens()])\n```"]
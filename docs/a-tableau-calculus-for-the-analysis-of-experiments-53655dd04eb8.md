# å®éªŒåˆ†æçš„è¡¨æ ¼å¾®ç§¯åˆ†

> åŸæ–‡ï¼š[`towardsdatascience.com/a-tableau-calculus-for-the-analysis-of-experiments-53655dd04eb8`](https://towardsdatascience.com/a-tableau-calculus-for-the-analysis-of-experiments-53655dd04eb8)

## è§£å¼€å®éªŒåˆ†æçš„åŸºæœ¬æ•°æ®ç»“æ„

[](https://dataneversleeps.medium.com/?source=post_page-----53655dd04eb8--------------------------------)![Jared M. Maruskin, PhD](https://dataneversleeps.medium.com/?source=post_page-----53655dd04eb8--------------------------------)[](https://towardsdatascience.com/?source=post_page-----53655dd04eb8--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----53655dd04eb8--------------------------------) [Jared M. Maruskin, PhD](https://dataneversleeps.medium.com/?source=post_page-----53655dd04eb8--------------------------------)

Â·å‘å¸ƒåœ¨[Towards Data Science](https://towardsdatascience.com/?source=post_page-----53655dd04eb8--------------------------------) Â·21 min readÂ·2023 å¹´ 10 æœˆ 3 æ—¥

--

![](img/b26caa5a37392803d3b6c958678d500a.png)

ç…§ç‰‡ç”±[Markus Spiske](https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral)æ‹æ‘„ï¼Œå‘å¸ƒåœ¨[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

å®éªŒåˆ†æé€šå¸¸æ¶‰åŠåˆ†æåŒ…å«ä¸åŒæ•°é‡å…ƒç´ çš„ç»„ï¼›ä¾‹å¦‚ï¼Œæ¯ä¸ªå±‚æ¬¡ä¸­çš„æ¯ç§å¤„ç†åˆ†é…çš„å•ä½æ•°é‡ä¸åŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡åˆ°çš„å¯¹è±¡*ç±»ä¼¼äºçŸ©é˜µ*ï¼Œä½†å®ƒä»¬ä¸æ˜¯å®Œç¾çš„çŸ©å½¢å—ï¼›å³ï¼Œå®ƒä»¬å¹¶ä¸æ€»æ˜¯â€œå¡«æ»¡â€ã€‚

åœ¨è¿™ç¯‡ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ç§æ–°çš„ç»“æ„ï¼Œç§°ä¸º*è¡¨æ ¼*ï¼Œå®ƒå¯ä»¥è¢«è§†ä¸ºéƒ¨åˆ†å¡«å……çš„çŸ©é˜µï¼Œå¹¶å¯»æ±‚å½¢å¼åŒ–åœ¨å®éªŒåˆ†æä¸­ä½¿ç”¨çš„è¡¨æ ¼æ“ä½œã€‚æˆ‘ä»¬ç„¶åå±•ç¤ºäº†å¦‚ä½•åœ¨å„ç§ç»Ÿè®¡èƒŒæ™¯ä¸­ä½¿ç”¨*è¡¨æ ¼ç¬¦å·*æ¥è¡¨è¾¾å…³é”®æ–¹ç¨‹ï¼ŒåŒ…æ‹¬åˆ†å±‚ã€èšç±»å’Œå¹³æ–¹å’Œåˆ†è§£ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†è¿™äº›æ–¹ç¨‹ä»¥*ä¸å˜*å’Œ*ç´¢å¼•*å½¢å¼è¡¨è¾¾ï¼š

1.  *ä¸å˜ç¬¦å·ï¼ˆæ— åæ ‡å½¢å¼ï¼‰* â€” ä»¥*å¯¹è±¡*å’Œ*è¿ç®—ç¬¦*çš„å½¢å¼å®šä¹‰ï¼Œå°±åƒçŸ©é˜µ-å‘é‡ç§¯ Aâ‹…x ä¸€æ ·ï¼Œ

1.  *ç´¢å¼•ç¬¦å·ï¼ˆåæ ‡å½¢å¼ï¼‰* â€” æ˜ç¡®ä»¥ç´¢å¼•æ•°ç»„å’Œå¤šé‡ç´¢å¼•çš„æ±‚å’Œå½¢å¼å®šä¹‰ï¼Œå°±åƒå°†çŸ©é˜µ-å‘é‡ç§¯è¡¨ç¤ºä¸º*âˆ‘â±¼Aáµ¢â±¼ xâ±¼*ä¸€æ ·ã€‚

## å¤§çº²

æœ¬æ–‡ç”±å››ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š

1.  ç»å…¸ç¬¦å·çš„å›é¡¾ï¼Œä¼˜ç¼ºç‚¹ï¼›

1.  è¡¨æ ¼å¾®ç§¯åˆ†çš„ç†è®ºå‘å±•ï¼›

1.  å®éªŒçš„åº”ç”¨ï¼ˆå®Œå…¨éšæœºåŒ–ã€å—éšæœºåŒ–ã€è°ƒæ•´å…¬å¼ã€é›†ç¾¤éšæœºåŒ–ã€å—é›†ç¾¤å’Œ ANOVA å¹³æ–¹å’Œåˆ†è§£ï¼‰ï¼›

1.  Python å®ç°

# ç»å…¸ç¬¦å·ï¼šä¼˜ç¼ºç‚¹

åœ¨å®éªŒåˆ†æä¸­ï¼Œå¸¸ç”¨çš„ç¬¦å·é£æ ¼æœ‰ä¸‰ç§ï¼š

1.  *ç»å…¸è®°å·* â€” å¤„ç†åˆ†é…è¢«æ˜ç¡®åˆ—å‡ºï¼šå•å…ƒ*(ijk)*æè¿°äº†ç¬¬*i*ä¸ªå¤„ç†ç»„ç¬¬*j*å±‚ä¸­çš„ç¬¬*k*ä¸ªå•å…ƒï¼ˆè§ [1]ï¼Œ[2] å’Œ [5]ï¼‰ï¼›

1.  *åˆ†é…è®°å·* â€” åˆ†é…æœºåˆ¶è¢«è§†ä¸ºä¸€ä¸ªç‹¬ç«‹å˜é‡ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹ *Záµ¢Yáµ¢* æˆ– *Záµ¢â±¼ Yáµ¢â±¼* ç­‰é‡çš„æ±‚å’Œï¼ˆè§ [2]ï¼Œ[3] å’Œ [4]ï¼‰ï¼›å’Œ

1.  *é›†åˆè®°å·* â€” æ˜¾å¼å˜é‡æŒ‡ä»£å¤„ç†å’Œå¯¹ç…§é›†åˆï¼›*Yáµ—* å’Œ *Yá¶œ*ï¼Œæˆ–è€… *Yâºâ±¼* ç”¨äºç¬¬ *j* ä¸ªç°‡çš„æ€»å’Œï¼Œç„¶å *Yâºâ‚œ* å’Œ *Yâº_c* ç”¨äºå¤„ç†å’Œå¯¹ç…§ç°‡çš„æ€»å’Œé›†åˆï¼Œç­‰ç­‰ï¼ˆè§ [5]ï¼‰ã€‚

ç»å…¸è®°å·å…è®¸ä»¥æœ€ç´§å‡‘çš„æ–¹å¼è¡¨è¾¾å…¬å¼ï¼Œå› ä¸ºå¤„ç†åˆ†é…åœ¨å“åº”æ•°ç»„ä¸­ç›´æ¥ç´¢å¼•ï¼Œè¿™åœ¨æè¿°åˆ†å±‚ã€å¤šå±‚å®éªŒå’Œæ–¹å·®åˆ†æä¸­éå¸¸æœ‰ç”¨ã€‚ç„¶è€Œï¼Œè¿™ç§è®°å·åœ¨å“²å­¦ä¸Šä»¤äººä¸å®‰ï¼Œå› ä¸ºå•å…ƒçš„åˆ—ä¸¾ç›´æ¥ä¾èµ–äºå¤„ç†åˆ†é…ã€‚

å¦ä¸€æ–¹é¢ï¼Œåˆ†é…è®°å·åˆ—ä¸¾äº†å•å…ƒè€Œä¸è€ƒè™‘å¤„ç†åˆ†é…ï¼Œä½†éœ€è¦ä¸€ä¸ªè¾…åŠ©çš„åˆ†é…æœºåˆ¶ *Z* å’ŒåŒå€çš„å¤šé‡æ±‚å’Œï¼Œå…¶ä¸­ä¸€ç»„æ±‚å’ŒåŒ…å«å› å­ *Z*ï¼Œå¦ä¸€ç»„åˆ™åŒ…å«å› å­ *(1-Z)*ã€‚è¿™ä¸€ç‚¹çš„ä¸è¶³ä¹‹å¤„åœ¨äºä¸é€‚ç”¨äºå¤šå±‚æ¬¡è®¾è®¡ã€‚

æœ€åï¼Œé›†åˆè®°å·å¤§å¤§ç®€åŒ–äº†é—®é¢˜ï¼Œä½†éœ€è¦ä¸ºæ¯ä¸ªä¸åŒçš„é›†åˆæä¾›ç‰¹æ®Šå®šä¹‰ï¼šåœ¨èšç±»ä¸­ï¼Œ*Yâºâ±¼* æ˜¯ç¬¬ *j* ä¸ªç°‡çš„æ€»å’Œï¼Œ*Yâºâ‚œ={Yâºâ±¼ : zâ±¼=1}*ï¼Œä½†è¿™äº›åœ¨åŒºç»„è®¾è®¡ä¸­æœªä½¿ç”¨ï¼›å³æˆ‘ä»¬å¿…é¡»ä¸æ–­å®šä¹‰ä¸åŒçš„è®°å·æ¥æŒ‡ä»£ä¸åŒçš„ç»„ã€å­ç»„æˆ–å•ä¸€åŸºæœ¬å¯¹è±¡çš„æ€»å’Œã€‚

Tableau è®°å·åŠ›æ±‚å…¼å…·å„æ–¹é¢ä¼˜ç‚¹ï¼šå…¶åŸºæœ¬ä¸–ç•Œè§‚ä¸åˆ†é…è®°å·ä¸€è‡´ï¼Œä½†æˆ‘ä»¬å®šä¹‰äº†ä¸€ç§ç§°ä¸º tableau çš„ç»“æ„ä»¥åŠä¸€ç»„æ“ä½œï¼Œè¿™ä½¿å¾—å¯ä»¥ä»¥ä¸å˜çš„å½¢å¼ä¹¦å†™æ–¹ç¨‹ï¼Œè¿™æ ·å¯ä»¥åœ¨ä¸åŒèƒŒæ™¯ä¸‹ç†è§£è€Œæ— éœ€æ¯æ¬¡å®šä¹‰ç‰¹å®šé›†åˆã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†åˆ†é…æœºåˆ¶çš„å…¨æ–°è§£é‡Šè§†ä¸º*æ©ç *ï¼Œä»è€Œå¯ä»¥è€ƒè™‘åŒ…å«å¤„ç†å’Œå¯¹ç…§åˆ†é…çš„*å­è¡¨æ ¼*ï¼Œç„¶ååœ¨è¿™äº›å­è¡¨æ ¼ä¸Šåº”ç”¨åŸºæœ¬æ“ä½œä»¥è¡¨è¾¾å…³é”®ç»Ÿè®¡å…¬å¼ã€‚

# Tableau è®°å·

## å…¥é—¨ï¼šè¡¨æ ¼ã€å½¢çŠ¶å’Œç´¢å¼•ç©ºé—´

è®°ä½ï¼Œ*l* ç»´çŸ©é˜µæ˜¯ç”±å…¶è¾¹é•¿*(nâ‚, â€¦, nâ‚—)*æŒ‡å®šçš„çŸ©å½¢æ•°ç»„ç»“æ„ã€‚å…¶ *nâ‚â€¦nâ‚—* ç»„ä»¶ç”±ä¸€ä¸ªç´¢å¼•ç©ºé—´ç´¢å¼•ã€‚

ä¸€ä¸ª *l* ç»´ *tableau* *T* æ˜¯ä¸€ä¸ªç”±æ­£æ•´æ•°æ•°ç»„çš„æœ‰é™é›†åˆ *I âŠ‚ â„¤Ë¡â‚Š* ä¸­çš„å€¼ç´¢å¼•çš„ *l* ç»´æ•°ç»„ã€‚æ‰€ä»¥ tableau åªæ˜¯ä¸€ä¸ªéƒ¨åˆ†å¡«å……çš„çŸ©é˜µã€‚

æˆ‘ä»¬è¯´ä¸€ä¸ªè¡¨æ ¼ *T* æ˜¯ *æ ‡å‡†å½¢å¼* å¦‚æœæ¯ä¸ªç´¢å¼•çš„èŒƒå›´ä» 1 åˆ°æŸä¸ªç»ˆç«¯æ•´æ•°ï¼ˆæ²¡æœ‰è·³è¿‡ï¼‰ï¼Œå¹¶ä¸”ç´¢å¼• *iâ‚–* çš„èŒƒå›´ä»…ä¾èµ–äº *ï¼ˆk-1ï¼‰* ä¸ªå‰é¢çš„ç´¢å¼•çš„å€¼ã€‚ä¸€ä¸ª *l*-ç»´æ ‡å‡†å½¢å¼çš„è¡¨æ ¼å¯ä»¥ç”±å…¶ *å½¢çŠ¶ Î·Ë¡* æè¿°ï¼Œ*Î·Ë¡* æœ¬èº«æ˜¯ä¸€ä¸ª *(l-1)*-ç»´æ ‡å‡†è¡¨æ ¼ï¼Œå®šä¹‰ä¸ºå½“ä¸”ä»…å½“ *Î¹=(iâ‚,â€¦,iâ‚—)âˆˆI* å½“ä¸”ä»…å½“ *(iâ‚,â€¦,iâ‚—â‚‹â‚)âˆˆI(Î·Ë¡)* ä¸” *iâ‚— âˆˆ {1,â€¦, Î·Ë¡_{iâ‚,â€¦,iâ‚—â‚‹â‚}}*ã€‚

æˆ–è€…ï¼Œå½¢çŠ¶ç”±ä¸€ç³»åˆ—è¡¨æ ¼ *âŸ¨Î·Â¹,â€¦,Î·Ë¡âŸ©* ç»™å‡ºï¼Œå…¶ä¸­ *Î·áµ* æ˜¯ä¸€ä¸ª *(k-1)*-ç»´è¡¨æ ¼ï¼Œé€šè¿‡é€’å½’åœ°å®šä¹‰ä¸º *Î·áµâºÂ¹* çš„å½¢çŠ¶ï¼Œé€‚ç”¨äº *k=(l-1),â€¦,1*ã€‚å› æ­¤ï¼Œè¡¨æ ¼ *Î·áµ* ç¡®å®šäº†ç´¢å¼• *iâ‚–* çš„èŒƒå›´ï¼Œå› ä¸ºå®ƒä¾èµ–äºå‰é¢çš„ç´¢å¼•ã€‚è¿™é€šè¿‡å…³ç³» *iâ‚âˆˆ{1,â€¦Î·Â¹}* é€’å½’åœ°å®šä¹‰äº†ç´¢å¼•ç©ºé—´ã€‚

å¯¹äº *k=2, â€¦, l*ã€‚æ³¨æ„æ¯ä¸ªç´¢å¼•çš„èŒƒå›´å¯èƒ½ä¾èµ–äºå‰é¢çš„ç´¢å¼•çš„å€¼ã€‚

åœ¨å®éªŒä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯ *ä»æ ‡å‡†å½¢å¼å¼€å§‹*ï¼›å³ï¼Œæ ‡å‡†å½¢å¼æ˜¯å¯¹é›†ç¾¤ã€å±‚æ¬¡ç­‰ä¸­çš„å®éªŒå•å…ƒçš„æšä¸¾ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„è¡¨æ ¼å®šä¹‰æ›´ä¸ºä¸€èˆ¬ï¼Œä»¥é€‚åº”æˆ‘ä»¬ç¨åå°†é‡åˆ°çš„å…¶ä»–ç»“æ„ï¼ˆå³ *æ©è”½è¡¨æ ¼*ï¼Œåœ¨å®éªŒçš„èƒŒæ™¯ä¸‹ï¼Œå®ƒä»¬æ˜¯åˆ†é…ç»™å¤„ç†æˆ–å¯¹ç…§çš„ç»„ä»¶çš„å­é›†ï¼›æ›´å¤šå†…å®¹ç¨åä»‹ç»ï¼‰ã€‚

**ç¤ºä¾‹ 1\.** ä½œä¸ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè€ƒè™‘ä¸€ä¸ªå½¢çŠ¶ä¸º *Î·Â³* çš„ä¸‰ç»´è¡¨æ ¼ *T*ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/502b5e5f593bcaa06d553475ccafd9bf.png)

è¡¨ 1\. ä¸‰ç»´è¡¨æ ¼ T çš„å½¢çŠ¶ Î·Â³ï¼›å›¾åƒç”±ä½œè€…æä¾›ã€‚

è¿™é‡Œï¼Œ*Î·Â¹=5*ï¼Œè€Œ *Î·Â²=âŸ¨ 5, 2, 3, 2, 4 âŸ©* è¡¨ç¤ºæ¯è¡Œä¸­çš„å…ƒç´ æ•°é‡ã€‚ä¾‹å¦‚ï¼Œå½“ *i=3* å’Œ *j=2* æ—¶ï¼Œç»„ä»¶ *k* çš„èŒƒå›´æ˜¯ *k=1,â€¦, 22*ï¼Œä¾æ­¤ç±»æ¨ã€‚

## p-å•å…ƒæ ¼ï¼›å¤–éƒ¨å’Œå†…éƒ¨ç´¢å¼•ç©ºé—´

å¯¹äºä»»ä½• *p=1, â€¦, l*ï¼Œä¸€ä¸ªè¡¨æ ¼ *T* çš„ *p*-å•å…ƒæ ¼æ˜¯ä¸€ä¸ªå­è¡¨æ ¼ï¼ŒåŒ…å«æ‰€æœ‰å…±äº«å‰ *p* ä¸ªç»„ä»¶çš„å•å…ƒï¼›å³ï¼Œå•ä¸ª *p*-å•å…ƒæ ¼ç”± *Î¹â‚š = (iâ‚, â€¦, iâ‚š)* æŒ‡å®šï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º *T_[iâ‚, â€¦, iâ‚š]*ã€‚åœ¨å®éªŒçš„èƒŒæ™¯ä¸‹ï¼Œ*cells*ï¼Œä¸å‚è€ƒ *p*ï¼Œé€šå¸¸è¢«å‡å®šä¸º *å€’æ•°ç¬¬äºŒå•å…ƒæ ¼*ï¼Œå…¶ä¸­ *p=l-1*ã€‚ä¸€ä¸ª *p*-å•å…ƒæ ¼æ˜¯ä¸€ä¸ª *q*-ç»´è¡¨æ ¼ï¼Œ*q=l-p*ï¼Œåœ¨ç©ºé—´ä¸Šè¿›è¡Œç´¢å¼•ã€‚

æˆ‘ä»¬å°†å…¶ç§°ä¸º *å¤–éƒ¨ç´¢å¼•ç©ºé—´* åœ¨ *Î¹â‚š*ã€‚æ‰€æœ‰ *p*-å•å…ƒæ ¼çš„é›†åˆç”± *å†…éƒ¨ç´¢å¼•ç©ºé—´* è¿›è¡Œç´¢å¼•ã€‚

å…¶ä¸­ *Î â‚š* æ˜¯æŠ•å½±ç®—å­ã€‚è¿™æ ·ï¼Œå¯¹äºä»»ä½• *p*ï¼Œæˆ‘ä»¬å¯ä»¥ *loosely* å°†ç´¢å¼•ç©ºé—´çœ‹ä½œ *bundle structure*

å…¶ä¸­ *I_[Î¹â‚š]* çš„çº¤ç»´æ ¹æ®åŸºç‚¹ *Î¹â‚š* çš„ä½ç½®è€Œå˜åŒ–ã€‚(*æ³¨æ„ï¼šæˆ‘ä½¿ç”¨è¿™ä¸ªè¯* loosely*ï¼Œå› ä¸ºè¿™äº›çº¤ç»´è™½ç„¶ç»´åº¦ç›¸åŒï¼Œä½†åœ¨åŸºç©ºé—´ä¸­ä½ç½®å˜åŒ–æ—¶å½¢çŠ¶é€šå¸¸ä¸åŒï¼Œè¿™å°±æ˜¯å®ƒä»¬ä¾èµ–äº Î¹â‚š* çš„åŸå› ã€‚)

åœ¨ç»§ç»­å‰ä¸€èŠ‚çš„ä¾‹å­æ—¶ï¼Œ*(3,2)* å¤„çš„å•å…ƒå°†åŒ…å«æœªæ˜¾ç¤ºçš„ 22 ä¸ªç»„ä»¶çš„ä¸€ç»´æ•°ç»„ï¼Œè€Œ *(3,1)* å¤„çš„å•å…ƒä»…åŒ…å« 10 ä¸ªç»„ä»¶ã€‚å†…éƒ¨ç©ºé—´ *Iâ‚‚* åŒ…å«è¡¨ä¸­æ˜¾ç¤ºçš„ *(ij)* çš„ 16 ç§æ’åˆ—ã€‚

ç±»ä¼¼åœ°ï¼Œ*i=4* å¤„çš„ 1-å•å…ƒå°†æ˜¯ä¸€ä¸ª 2-ç»´è¡¨ï¼Œç”±å¤–éƒ¨ç©ºé—´ *i=4* ç´¢å¼•ï¼Œç»™å‡º {*1}* Ã— *{1,â€¦,5} âˆª {2} Ã— {1,â€¦,15}*ã€‚å†…éƒ¨ç©ºé—´ *Iâ‚* åªæ˜¯è¡Œçš„æšä¸¾ï¼š*Iâ‚={1,2,3,4,5}*ã€‚

## æ€»å’Œä¸éƒ¨åˆ†å’Œ

ä¸€ä¸ªè¡¨ *T* çš„ *æ€»å’Œ*ï¼Œè®°ä½œ *T*âˆ˜ï¼Œæ˜¯å…¶æ‰€æœ‰ç»„ä»¶çš„æ€»å’Œã€‚

ç»™å®šçš„ *p*-å•å…ƒ *(iâ‚â€¦iâ‚š)* çš„æ€»å’Œç§°ä¸º *q*-éƒ¨åˆ†å’Œçš„ *T*ï¼Œå› ä¸ºå®ƒéœ€è¦ *q=l-p* æ¬¡æ±‚å’Œï¼Œå¹¶ç”±ä»¥ä¸‹å®šä¹‰

ç¬¬äºŒä¸ªç­‰å¼åœ¨ *T* å¤„äºæ ‡å‡†å½¢å¼æ—¶æˆç«‹ã€‚

å› æ­¤ï¼Œå¯¹äºç»™å®šçš„ *p*ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç”±æ‰€æœ‰ *q*-éƒ¨åˆ†å’Œç»„æˆçš„ *p*-è¡¨ï¼Œç”¨ *âŠ•_q T* æˆ– *T_(q)* è¡¨ç¤ºï¼Œå…¶ä¸­ *Î¹â‚š* ç»„ä»¶è¢«å®šä¹‰ä¸º

å¯¹äºæ‰€æœ‰ *Î¹â‚š âˆˆ I*ã€‚

æ€»ç»“æ¥è¯´ï¼Œå¯¹äº *p+q=l*ï¼š

+   ä¸€ä¸ª *p*-å•å…ƒåœ¨ *Î¹â‚š* å¤„æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨å¤–éƒ¨ç´¢å¼•ç©ºé—´ *I[Î¹â‚š]* ä¸Šçš„ *q*-ç»´å­è¡¨ *T_[Î¹â‚š]*ï¼Œå…¶ä¸­å‰ *p* ä¸ªç´¢å¼•ä¿æŒå›ºå®šï¼›å¹¶ä¸”

+   ç¬¬ *q* ä¸ªéƒ¨åˆ†å’Œ *âŠ•_qT* æˆ– *T_(q)* æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨å†…éƒ¨ç´¢å¼•ç©ºé—´ *Iâ‚š* ä¸Šçš„ *p*-ç»´è¡¨ï¼Œä½œä¸ºå•ä¸ª *p*-å•å…ƒçš„æ€»å’Œã€‚

é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ“ä½œç¬¦ *ğ’ª* å¯¹ä¸€ä¸ª *p*-å•å…ƒè¿›è¡Œä½œç”¨æ—¶ï¼Œå®ƒä¼šä½œç”¨äº *q*-ç»´çš„ *å¤–éƒ¨ç´¢å¼•ç©ºé—´*ï¼ˆå³ï¼Œçº¤ç»´ï¼‰ï¼Œè€Œç»“æœåˆ™åœ¨ *p*-ç»´çš„ *å†…éƒ¨ç´¢å¼•ç©ºé—´*ï¼ˆå³ï¼ŒåŸºï¼‰ä¸­å˜åŒ–ï¼›ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¼šå°†é‡ *ğ’ª(T_{[Î¹â‚š]})* è§†ä½œ *Iâ‚š* ä¸Šçš„ *p*-è¡¨ã€‚

## å•ä½è¡¨å’Œè®¡æ•°

ä¸€ä¸ª *å•ä½è¡¨* æ˜¯ä¸€ä¸ªå¸¸æ•°è¡¨ï¼Œå€¼ä¸º 1ã€‚ç»™å®šä¸€ä¸ªè¡¨ *T*ï¼Œå…¶å…³è”çš„å•ä½è¡¨ *U* åªæ˜¯ä¸€ä¸ªå…·æœ‰ç›¸åŒå½¢çŠ¶çš„å•ä½è¡¨ã€‚*U* çš„éƒ¨åˆ†å’Œæ˜¯å¯¹åº”çš„ *p*-å•å…ƒçš„è®¡æ•°ï¼š

å½“æˆ‘ä»¬å¸Œæœ›ä»¥ä¸å˜å½¢å¼å¼•ç”¨æ­¤è¡¨æ—¶ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º *náµ–*ã€‚

## å¹³å‡å€¼å’Œæ–¹å·®

å¯¹äºä»»ä½•å…·æœ‰ *n=|T|* ç»„ä»¶çš„è¡¨ *T*ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¹³å‡å€¼å®šä¹‰ä¸º

åŠå…¶åŠ æƒå¹³å‡å€¼ä¸º

æ³¨æ„ï¼Œ*å¹³æ–¹* *(T â€” Î¼(T))Â²* å½¢æˆäº†ä¸€ä¸ªä¸ *T* å…·æœ‰ç›¸åŒå½¢çŠ¶çš„è¡¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å®šä¹‰ä»¥ä¸‹ *å¹³æ–¹å’Œ*ï¼š

ï¼ˆæ ‡å‡†å’ŒåŠ æƒï¼›è¯·æ³¨æ„ï¼Œä¸åŠ æƒå¹³å‡çš„å®šä¹‰ä¸åŒï¼Œè¿™é‡Œçš„æƒé‡*ä¸æ˜¯*è‡ªåŠ¨å½’ä¸€åŒ–çš„ï¼‰ã€‚æœ€åï¼Œæ ·æœ¬æ–¹å·®å’Œæ–¹å·®ï¼š

å½“å¯¹å•ç‹¬çš„ *p*-å•å…ƒåº”ç”¨è¿™äº›æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å°† *p*-å•å…ƒè§†ä¸ºå›ºå®šï¼Œä½œä¸ºæ“ä½œçš„ç›®çš„ï¼Œä½†åœ¨æ“ä½œå®Œæˆåå…è®¸ *p*-å•å…ƒé€šè¿‡ *Iâ‚š* å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œ*SS(T_[iâ‚ â€¦ iâ‚š])* åº”è¢«è§†ä¸ºåœ¨å†…éƒ¨ç©ºé—´ *Iâ‚š* ä¸Šçš„ *p*-è¡¨ï¼Œå°½ç®¡å®é™…çš„å¹³æ–¹å’Œæ“ä½œæ˜¯åœ¨å•ä¸ªå¤–éƒ¨ç©ºé—´ *I_[iâ‚â€¦iâ‚š]* ä¸Šè¿›è¡Œçš„ã€‚

## è¡¨çš„åŠ æ³•å’Œä¹˜æ³•ï¼šç‰¹æ®Šæƒ…å†µ

åŠ æ³•å’Œä¹˜æ³•é€šå¸¸æŒ‰ç»„ä»¶å®šä¹‰ï¼ˆåœ¨ç‰¹æ®Šçš„çŸ©é˜µæƒ…å†µä¸‹ï¼Œå‡å°‘ä¸ºçŸ©é˜µå’ŒåŠ Hadamard ä¹˜ç§¯ï¼‰ã€‚ç„¶è€Œï¼Œæœ‰ä¸¤ä¸ªç‰¹æ®Šæƒ…å†µã€‚

è€ƒè™‘ä¸¤ä¸ª tableaus *T* å’Œ *S*ï¼Œå®ƒä»¬çš„ç´¢å¼•ç©ºé—´åˆ†åˆ«ä¸º *I_T* å’Œ *I_S*ã€‚é‚£ä¹ˆ *å¤–éƒ¨å’Œ T+S* åœ¨è”åˆç´¢å¼•ç©ºé—´ *I_T âˆª I_S* ä¸Šå®šä¹‰ï¼Œé‡‡ç”¨çš„çº¦å®šæ˜¯ *x +* **null** *= x*ã€‚

å¦‚æœ *A* æ˜¯åœ¨ä¸€ä¸ªæ›´é«˜ç»´åº¦çš„ç¬¬äºŒä¸ª tableau *T* çš„å†…éƒ¨ç´¢å¼•ç©ºé—´ *Iâ‚š* ä¸Šå®šä¹‰çš„ *p*-tableauï¼Œé‚£ä¹ˆ (å¤–éƒ¨æŠ•å½±) ä¹˜ç§¯ *AT* æŒ‰è‡ªç„¶æ–¹å¼å®šä¹‰ï¼š

å³ï¼Œtableau *A* è¢«â€œæŠ•å°„â€åˆ°æ›´é«˜çš„ç©ºé—´ï¼Œç„¶åæŒ‰ç»„ä»¶è¿›è¡Œä¹˜æ³•ã€‚ï¼ˆè¿™åœ¨ç¾¤ä½“éšæœºåŒ–çš„èƒŒæ™¯ä¸‹ä¼šå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºåˆ†é…æ˜¯åœ¨ç¾¤ä½“çº§åˆ«è¿›è¡Œçš„ï¼Œå› æ­¤è¡¨ç¤ºä¸€ä¸ªæ¯”å®Œæ•´å“åº” tableau æ›´ä½ç»´åº¦çš„ tableauã€‚ï¼‰

## æ©ç 

tableau *T* çš„ *æ©ç  M* æ˜¯å…·æœ‰ç›¸åŒå½¢çŠ¶çš„äºŒè¿›åˆ¶ tableauï¼Œæˆ–ä»»ä½•å†…éƒ¨ç´¢å¼•ç©ºé—´çš„å½¢çŠ¶ã€‚å…¶è¡¥é›†ä¹Ÿæ˜¯ä¸€ä¸ªæ©ç ï¼Œç”± *Má¶œ=1-M = Â¬M* å®šä¹‰ã€‚

ä¸€ä¸ªæ©ç åŠå…¶è¡¥é›†çš„å’Œæ„æˆå•ä½ tableauï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªåˆ†åŒºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœ *{Mâ‚, â€¦, Mâ‚˜}* å½¢æˆ *I* çš„ä¸€ä¸ªåˆ†åŒºï¼Œå½“ä¸”ä»…å½“ *Mâ‚+â€¦+Mâ‚˜ = U*ï¼Œå…¶ä¸­ *U* æ˜¯ *I* ä¸Šçš„å•ä½ tableauã€‚ï¼ˆæ³¨æ„ä½¿ç”¨*å¤–éƒ¨å’Œ*ï¼Œå› ä¸ºæ©ç å®šä¹‰åœ¨ç´¢å¼•ç©ºé—´çš„äº’æ–¥å­é›†ä¸Šã€‚ï¼‰

*æ©ç  tableau* *MT*ï¼ˆä¹Ÿå¯å†™ä½œ *T[M]*ï¼‰æ˜¯é€šè¿‡å°†ç´¢å¼•ç©ºé—´é™åˆ¶ä¸ºé›†åˆå½¢æˆçš„ *T* çš„å­ tableau

ä¸é€é¡¹ä¹˜æ³•ä¸åŒï¼Œæ©ç  tableau çš„å¤§å°ä¸æ˜¯åŸå§‹ tableau çš„å¤§å°ï¼Œè€Œæ˜¯ç¼©å‡ç©ºé—´çš„å¤§å°ï¼Œè¿™ç­‰åŒäºæ©ç çš„æ€»å’Œï¼š*|MT| = Mâˆ˜*ã€‚

*æ³¨æ„ï¼šåœ¨æˆ‘ä»¬çš„å®šä¹‰ä¸­ï¼Œæ©ç çš„çœŸå€¼é€‰æ‹©äº†åº•å±‚ tableau çš„â€œæ´»åŠ¨â€ç»„ä»¶ï¼Œè¿™ä¸ numpy æ©ç æ•°ç»„ä½¿ç”¨çš„ç›¸åçº¦å®šä¸åŒ*ã€‚

# Tableau è¯•éªŒçš„è®°å·

å…³äºå®éªŒï¼Œ

1.  å®éªŒè®¾è®¡åŒ…æ‹¬ç¡®å®šå½¢çŠ¶ *Î·* å’Œé€‰æ‹©åˆ†é…æœºåˆ¶ *Z* çš„éšæœºåŒ–ç¨‹åºï¼Œé€šå¸¸ç”±å…¶å›ºå®šçš„éƒ¨åˆ†å’Œçº¦æŸï¼Œæˆ‘ä»¬å°†ç”¨ *a* è¡¨ç¤ºï¼›

1.  å„ä¸ªå•å…ƒçš„ååº”å­˜å‚¨åœ¨å½¢çŠ¶ä¸º *Î·* çš„ tableau *Y* ä¸­ï¼›ä»¥åŠ

1.  åˆ†é…æœºåˆ¶ *Z* æ˜¯ *Y* ä¸Šçš„ä¸€ä¸ªæ©ç ã€‚

å¦‚æœæˆ‘ä»¬è€ƒè™‘ *æ½œåœ¨ç»“æœ* Y(1)=Y(Z=1) å’Œ Y(0)=Y(Z=0)ï¼Œå®é™…ååº”ç”±ä¸‹å¼ç»™å‡º

*Y = ZY(1) + (1-Z)Y(0)ã€‚*

æ³¨æ„è¿™é‡Œæä¾›çš„è§£é‡Šå·®å¼‚ï¼š*ZY(1)* å’Œ *(1-Z)Y(0)* æ˜¯ *æ©ç * æ½œåœ¨ç»“æœï¼Œå› æ­¤å®ƒä»¬åœ¨å„è‡ªä¸é‡å çš„å­ tableaux ä¸Šå®šä¹‰ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå®éªŒçš„ç›®æ ‡æ˜¯ä¼°è®¡ *æ€»å¤„ç†æ•ˆåº”*ï¼ˆæˆ‘å°†ç§°ä¹‹ä¸º *Î”* æˆ– *Ï„*ï¼‰ï¼š

ç„¶è€Œï¼Œè¿™ç§æƒ…å†µæ˜¯ä¸å¯è§‚å¯Ÿçš„ï¼Œå› ä¸ºæˆ‘ä»¬åªèƒ½çŸ¥é“ä»»ä½•å•ä¸€å®éªŒå•å…ƒä¸‹çš„å¤„ç†ååº”æˆ–å¯¹ç…§ååº”ã€‚

å¯¹äºå…·æœ‰ *m* ç§å¯èƒ½å¤„ç†åˆ†é…ï¼ˆåŒ…æ‹¬å¯¹ç…§ï¼‰çš„å¤šçº§å®éªŒï¼Œæˆ‘ä»¬è®© *Z* ä¸ºä¸€ä¸ª *åˆ†ç±»è¡¨æ ¼*ï¼Œå…¶ä¸­ç±»åˆ«ç¼–å·ä¸º *1, â€¦, m*ï¼Œç„¶åå®šä¹‰æ©ç é›†

å¯¹äº *z=1,â€¦, m*ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ½œåœ¨ç»“æœå…¬å¼è¡¨ç¤ºä¸º

## å®Œå…¨éšæœºè®¾è®¡

åœ¨å®Œå…¨éšæœºè®¾è®¡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ç»„ *n* å•å…ƒï¼Œå…¶ä¸­æˆ‘ä»¬å°†éšæœºåˆ†é… *a* åˆ°å¤„ç†ç»„ã€‚å“åº” *Y* æ˜¯ä¸€ä¸ªèŒƒå›´ä¸º *i=1,â€¦, n* çš„ä¸€ç»´è¡¨æ ¼ï¼Œåˆ†é…æœºåˆ¶ *Z* æ˜¯ä¸€ä¸ªç›¸åŒå¤§å°çš„ä¸€ç»´æ©ç ï¼Œä»ç©ºé—´ *ğ”¹â¿* éšæœºé€‰æ‹©ï¼Œæ»¡è¶³çº¦æŸ *||Z||â‚ = a*ã€‚å¦‚æœæˆ‘ä»¬å®šä¹‰å¤„ç†å’Œå¯¹ç…§çš„æ©ç è¡¨æ ¼ä¸º

æˆ‘ä»¬å¯ä»¥å°†ç»å…¸çš„ *å‡å€¼å·®å¼‚ä¼°è®¡é‡* è¡¨ç¤ºä¸ºï¼š

æ³¨æ„æˆ‘ä»¬å¯¹ *Yáµ—* å’Œ *Yá¶œ* çš„è§£é‡Šä¸ºå“åº”è¡¨æ ¼çš„å­è¡¨æ ¼ã€‚å› æ­¤ï¼Œå¤„ç†å’Œå¯¹ç…§å¹³å‡å€¼å¯ä»¥ç”¨ç´¢å¼•ç¬¦å·è¡¨ç¤ºä¸º

ç”±äºæˆ‘ä»¬å°† *ZY* è§£é‡Šä¸ºæ©ç è¡¨æ ¼ï¼Œæˆ‘ä»¬é™¤ä»¥ *a=Zâˆ˜*ï¼Œå³å¤„ç†å•å…ƒçš„æ•°é‡ï¼Œè€Œä¸æ˜¯ *n*ï¼›å¯¹ *(1-Z)Y* ä¹Ÿæ˜¯ç±»ä¼¼ã€‚

*T* ç»Ÿè®¡é‡å®šä¹‰ä¸º

å…¶ä¸­ç»„å†…å‡æ–¹è¯¯å·®å®šä¹‰ä¸º

æ³¨æ„ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹é€šè¿‡åˆ†é…æ©ç åŠå…¶è¡¥å……è·å¾—çš„å¤„ç†å’Œå¯¹ç…§å­è¡¨æ ¼åº”ç”¨å¹³æ–¹å’Œæ“ä½œã€‚åœ¨åæ ‡ä¸­ï¼Œè¿™å¯ä»¥è¡¨è¾¾ä¸º

åœ¨æ— æ•ˆå‡è®¾ä¸‹ï¼Œæ£€éªŒç»Ÿè®¡é‡ *T* æœä»è‡ªç”±åº¦ä¸º *n-2* çš„ *t* åˆ†å¸ƒã€‚

## å—éšæœºè®¾è®¡

åœ¨å—éšæœºè®¾è®¡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°†å®éªŒå•å…ƒåˆ’åˆ†ä¸º *s* ä¸ªå±‚æ¬¡ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ *(ij)* ç´¢å¼•è¿™äº›å•å…ƒï¼Œå…¶ä¸­ *i=1,â€¦,s* è¡¨ç¤ºå±‚æ¬¡ï¼Œ*j=1,â€¦,náµ¢* è¡¨ç¤ºç¬¬ *i* ä¸ªå±‚æ¬¡ä¸­çš„ç¬¬ *j* ä¸ªå…ƒç´ ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ–½åŠ çº¦æŸï¼Œéšæœºåˆ†é… *aáµ¢* å•å…ƒåˆ°ç¬¬ *i* ä¸ªå±‚æ¬¡çš„å¤„ç†ç»„ï¼Œæ»¡è¶³ *å¹³è¡¡å±æ€§*ï¼Œè¦æ±‚æ¯ä¸ªå±‚æ¬¡åŒ…å«ç›¸åŒæ¯”ä¾‹çš„å¤„ç†å•å…ƒï¼›å³ï¼Œå€¾å‘ *Ï€áµ¢=aáµ¢/náµ¢* ä¸ *i* ç‹¬ç«‹ã€‚ï¼ˆè¿™å¯¹äºä¸Šè¿°å®šä¹‰çš„å‡å€¼å·®å¼‚ä¼°è®¡é‡æ˜¯æ— åçš„ã€‚ï¼‰

æˆ‘ä»¬çš„å•å…ƒå®‰æ’å®šä¹‰äº†ä¸€ä¸ª *l*-å½¢ *Î·=âŸ¨s, náµ¢âŸ©*ï¼Œå› æ­¤æˆ‘ä»¬çš„åˆ†é…æœºåˆ¶ *Z* æ˜¯åœ¨å½¢çŠ¶ä¸º *Î·* çš„äºŒç»´è¡¨æ ¼ä¸Šéšæœºé€‰æ‹©çš„ï¼Œæ»¡è¶³ *aáµ¢=Záµ¢âˆ˜= Ï€ náµ¢* æ˜¯å›ºå®šçš„ã€‚

*T* ç»Ÿè®¡é‡çš„å…¬å¼ä¿æŒä¸å˜ï¼Œåªæ˜¯ç°åœ¨å¤„ç†å’Œå¯¹ç…§çš„å¹³å‡å€¼ç”±ä»¥ä¸‹ç»™å‡º

MSW ç”±ä»¥ä¸‹ç»™å‡º

æ³¨æ„ï¼Œå¹³æ–¹å’Œæ“ä½œä½œç”¨äº 1-å•å…ƒï¼Œåœ¨æ¯ä¸ªå±‚æ¬¡ä¸Šå›ºå®šï¼Œå¹¶è¢«åˆ†é…æœºåˆ¶ï¼ˆå¤„ç†ï¼‰æˆ–å…¶è¡¥å……ï¼ˆå¯¹ç…§ï¼‰æ©ç›–ã€‚åœ¨ç´¢å¼•ç¬¦å·ä¸­ï¼Œè¿™ç­‰ä»·äº

å¤„ç†å’Œå¯¹ç…§å±‚æ¬¡çš„å¹³å‡å€¼ä»¥æ˜æ˜¾çš„æ–¹å¼å®šä¹‰ï¼š

æ³¨æ„æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ï¼šå¹³å‡æ“ä½œåœ¨ *å¤–éƒ¨ç´¢å¼•ç©ºé—´* ä¸Šè¿›è¡Œï¼Œå› ä¸ºå®ƒä½œç”¨äº *i* çš„ 1-å•å…ƒã€‚ç»“æœå¯ä»¥åœ¨ *å†…éƒ¨ç´¢å¼•ç©ºé—´* ä¸Šå˜åŒ–ï¼Œç”± *I_1={1, â€¦, s}* å®šä¹‰ã€‚

åœ¨æ— æ•ˆå‡è®¾ä¸‹ï¼Œæµ‹è¯•ç»Ÿè®¡é‡*T*çš„åˆ†å¸ƒä¸ºå…·æœ‰*n-2s*è‡ªç”±åº¦çš„*t*åˆ†å¸ƒã€‚

## è°ƒæ•´å…¬å¼

å½“*å¹³è¡¡å±æ€§*ä¸æˆç«‹æ—¶ï¼Œè¿™åœ¨è§‚å¯Ÿæ€§ç ”ç©¶ï¼ˆ*è‡ªç„¶å®éªŒ*ï¼‰ä¸­å¸¸è§ï¼Œæˆ‘ä»¬ç”¨*è°ƒæ•´å…¬å¼*æ›¿ä»£ä¸Šè¿°å®šä¹‰çš„å‡å€¼å·®å¼‚ä¼°è®¡é‡ï¼š

è°ƒæ•´å…¬å¼æ˜¯é€šè¿‡å–æ¯ä¸ªå±‚æ¬¡è§‚å¯Ÿåˆ°çš„ç»å…¸*å‡å€¼å·®å¼‚*ä¼°è®¡é‡çš„*åŠ æƒ*å¹³å‡æ¥è·å¾—çš„ï¼Œä½¿ç”¨æ¯ä¸ªå±‚æ¬¡ä¸­å•ä½æ•°*náµ¢*ä½œä¸ºæƒé‡ã€‚

## é›†ç¾¤éšæœºåŒ–è®¾è®¡

é›†ç¾¤éšæœºåŒ–ç±»ä¼¼äºåŒºç»„è®¾è®¡ï¼Œåªä¸è¿‡åˆ†é…æ˜¯åœ¨*é›†ç¾¤çº§åˆ«*è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªå±‚æ¬¡å†…çš„å•ç‹¬å•ä½çº§åˆ«ã€‚è¿™åœ¨å‡†å®éªŒä¸­å¾ˆå¸¸è§ï¼Œå½“ä¸ªä½“çº§åˆ«çš„éšæœºåŒ–ä¸åˆ‡å®é™…æˆ–ä¸å¯èƒ½æ—¶ï¼›ä¾‹å¦‚ï¼Œåœ¨*æˆ·å¤–ï¼ˆOOHï¼‰*å¸‚åœºæ¨å¹¿æ´»åŠ¨ä¸­ï¼ŒéšæœºåŒ–å¯èƒ½åœ¨*åŸå¸‚*çº§åˆ«è¿›è¡Œã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å“åº”æ˜¯ä¸€ä¸ª 2 ç»´è¡¨æ ¼*Y*ï¼ŒèŒƒå›´ä¸º*i=1,â€¦, c*å’Œ*j=1,â€¦, náµ¢*ï¼Œå…¶ä¸­*i*ä¸ªé›†ç¾¤ä¸­æœ‰*náµ¢*ä¸ªå•ä½ï¼Œæ¯ä¸ª*c*ä¸ªé›†ç¾¤ã€‚

ç„¶è€Œï¼Œåˆ†é…æœºåˆ¶æ˜¯ä¸€ä¸ª 1 ç»´è¡¨æ ¼*Z*ï¼Œåœ¨å†…ç´¢å¼•ç©ºé—´*Iâ‚={1,â€¦,c}*ä¸Šéšæœºå®šä¹‰ï¼Œå—çº¦æŸ*||Z||â‚=a*ã€‚æ³¨æ„â€œå¤–éƒ¨ä¹˜æ³•â€è§„åˆ™çš„é‡è¦æ€§ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ©è”½å“åº”ä»ç„¶å¯ä»¥é€šè¿‡*Yáµ— = ZY*å’Œ*Yá¶œ = (1-Z)Y*æ¥æè¿°ã€‚è¿˜è¦æ³¨æ„ï¼Œå˜é‡*a=Zâˆ˜*è¡¨ç¤ºåˆ†é…åˆ°æ²»ç–—ç»„çš„*é›†ç¾¤æ€»æ•°*ã€‚è¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºæ²»ç–—å•ä½æ˜¯*é›†ç¾¤*ï¼Œè€Œä¸æ˜¯ä¸ªä½“ã€‚æ€»ä½“æ²»ç–—æ•ˆæœçš„ä¼°è®¡é‡ä»¥å…¶ä¸å˜å½¢å¼ç»™å‡º

æ³¨æ„ï¼Œéƒ¨åˆ†å’Œé¦–å…ˆè®¡ç®—ï¼Œç„¶ååœ¨æ²»ç–—å’Œå¯¹ç…§é›†ç¾¤ä¹‹é—´å¹³å‡ã€‚ï¼ˆå³ä¾§ç‰ˆæœ¬åœ¨è¿™é‡Œå¯èƒ½æ›´ç›´è§‚ï¼Œå°½ç®¡å·¦ä¾§æ˜¯â€œæœ€â€ä¸å˜å½¢å¼ã€‚ï¼‰

è¿™åªæ˜¯ä½¿ç”¨æ²»ç–—é›†ç¾¤çš„*a/c*å€¾å‘å’Œå¯¹ç…§é›†ç¾¤çš„*(a-c)/a*å€¾å‘çš„æ±¤æ™®æ£®-éœç»´èŒ¨ä¼°è®¡é‡çš„ä¸€ä¸ªåº”ç”¨ã€‚åœ¨ç´¢å¼•ç¬¦å·ä¸­ï¼Œè¿™ç­‰åŒäº

## åŒºç»„é›†ç¾¤éšæœºåŒ–è®¾è®¡

åœ¨åŒºç»„-é›†ç¾¤è®¾è®¡ä¸­ï¼Œé›†ç¾¤é¦–å…ˆè¢«åˆ†ç»„åˆ°å±‚æ¬¡ä¸­ã€‚è¿™åœ¨ä¾‹å¦‚å°†ç±»ä¼¼å¤§å°çš„åŸå¸‚åˆ†ç»„åˆ°ä¸€ä¸ªå›½å®¶å†…æ—¶å¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼Œä»¥ç¡®ä¿æ²»ç–—åˆ†é…çš„å¹³è¡¡ã€‚

*(ijk)*å¤„çš„ä¸ªä½“æ˜¯é›†ç¾¤*(ij)*ä¸­çš„*k*ä¸ªå•ä½ï¼Œé›†ç¾¤*(ij)*æ˜¯å±‚æ¬¡*i*ä¸­çš„*j*ä¸ªé›†ç¾¤ï¼Œå…¶ä¸­*i=1,â€¦,s*ï¼Œ*j=1,â€¦,cáµ¢*ï¼Œ*k=1,â€¦,náµ¢â±¼*ã€‚å› æ­¤ï¼Œå“åº”ç”±å½¢çŠ¶ä¸º*Î·=âŸ¨s, cáµ¢, náµ¢â±¼âŸ©*çš„ 3 ç»´è¡¨æ ¼*Y*æè¿°ã€‚åˆ†é…æœºåˆ¶*Z*æ˜¯å½¢çŠ¶ä¸º*Î·=âŸ¨s, cáµ¢âŸ©*çš„ 2 ç»´è¡¨æ ¼ï¼›å³ï¼Œåœ¨å†…ç©ºé—´*Iâ‚‚*ä¸Šéšæœºé€‰æ‹©ï¼Œå—é™äºåœ¨*i*å±‚æ¬¡å†…çš„*aáµ¢*é›†ç¾¤è¢«åˆ†é…åˆ°æ²»ç–—ç»„ï¼Œäº§ç”Ÿ*Ï€áµ¢=aáµ¢/cáµ¢*çš„å€¾å‘ã€‚

ç»™å®šæˆ‘ä»¬çš„å¤–éƒ¨æ¡ˆä¾‹ä¹˜æ³•è§„åˆ™ï¼Œæ©è”½é‡*Yáµ—=ZY*å’Œ*Yá¶œ=(1-Z)Y*ä»ç„¶æ˜¯æœ‰æ„ä¹‰çš„ã€‚

æ€»ä½“æ²»ç–—æ•ˆæœçš„ä¼°è®¡ç”±ä¸‹å¼ç»™å‡º

æ³¨æ„è¿™ä¸ªå…¬å¼ã€ç®€å•ç°‡å…¬å¼å’Œè°ƒæ•´å…¬å¼ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨æ¯ä¸ªç°‡å†…æ‰§è¡Œç¬¬ä¸€æ¬¡éƒ¨åˆ†å’Œ*before*å¹³å‡ï¼›æ¥ä¸‹æ¥ï¼Œåœ¨æ¯ä¸ªå±‚å†…å¯¹ç°‡è¿›è¡Œå¹³å‡ï¼ˆå› æ­¤åˆ†åˆ«é™¤ä»¥*aáµ¢*å’Œ*cáµ¢-aáµ¢*ï¼‰ï¼Œæœ€åï¼Œæˆ‘ä»¬åº”ç”¨è°ƒæ•´å…¬å¼ä»¥åœ¨å±‚é—´è¿›è¡Œå¹³å‡ã€‚

è¯¦ç»†åˆ†è§£è¿™äº›æ“ä½œï¼š

1.  *Yáµ—=ZY* æ˜¯æ©è”½çš„å­è¡¨æ ¼ï¼Œç”±å¤„ç†å•å…ƒç»„æˆï¼Œä¸€ä¸ª 3 ç»´è¡¨æ ¼ä»ç„¶æŒ‰*(ijk)*æšä¸¾ï¼›

1.  *âŠ•â‚Yáµ—* æ˜¯ç¬¬ä¸€æ¬¡éƒ¨åˆ†å’Œï¼Œé€šè¿‡å¯¹*(ij)*ç°‡å†…æ‰€æœ‰å¤„ç†å•å…ƒçš„å“åº”æ±‚å’Œå¾—åˆ°ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ª*èšåˆå“åº”*çš„ 2 ç»´è¡¨æ ¼ï¼›

1.  *âŠ•â‚Yáµ—_[i]* æ˜¯ 1-å•å…ƒï¼ˆç”±*j*ç´¢å¼•ï¼‰ï¼Œç”±æ¯ä¸ªå¤„ç†ç°‡å†…çš„èšåˆå“åº”ç»„æˆï¼›

1.  *Î¼(âŠ•â‚Yáµ—_[i])* æ˜¯é€šè¿‡å¯¹æ¯å±‚çš„ç°‡çº§èšåˆå“åº”è¿›è¡Œå¹³å‡å¾—åˆ°çš„ï¼Œå¾—åˆ°ä¸€ä¸ªæŒ‰å±‚* i* ç´¢å¼•çš„ 1 ç»´è¡¨æ ¼ï¼›

1.  æœ€ç»ˆå¹³å‡å€¼æ˜¯åŠ æƒçš„å±‚å¹³å‡å€¼ï¼Œè®¡ç®—å…¬å¼ä¸º*Î¼(âŠ•â‚Yáµ—_[i]) â€” Î¼(âŠ•â‚Yá¶œ_[i])*ã€‚

åœ¨ç´¢å¼•ç¬¦å·ä¸­ï¼Œè¿™ç­‰ä»·äº

è¿™æœ‰ç‚¹åƒé­”æ³•ã€‚

## æ–¹å·®åˆ†æå¹³æ–¹å’Œåˆ†è§£

åœ¨æ–¹å·®åˆ†æï¼ˆANOVAï¼‰ä¸­ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯æ€»å¹³æ–¹å’Œçš„åˆ†è§£ï¼Œåˆ†ä¸ºç»„é—´å¹³æ–¹å’Œå’Œç»„å†…å¹³æ–¹å’Œã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰*m*ç»„ï¼Œå…¶ä¸­ç¬¬*i*ç»„æœ‰*náµ¢*ä¸ªå•å…ƒã€‚å“åº”*Y*æŒ‰*(ij)*çš„èŒƒå›´è¿›è¡Œç´¢å¼•ã€‚

æ€»å¹³æ–¹å’Œï¼ˆSSTï¼‰ç”±ä»¥ä¸‹å…¬å¼ç»™å‡º

åˆ†è§£è§„åˆ™è¡¨æ˜è¿™ç­‰åŒäºç»„é—´å¹³æ–¹å’Œï¼ˆSSBï¼‰å’Œç»„å†…å¹³æ–¹å’Œï¼ˆSSWï¼‰çš„æ€»å’Œã€‚SSW ç”±ä»¥ä¸‹å…¬å¼ç»™å‡º

ï¼ˆæ³¨æ„è¿™ä¸æˆ‘ä»¬åœ¨å—éšæœºè®¾è®¡ä¸­è·å¾—çš„ MSW å…¬å¼ç›¸åŒ¹é…ã€‚ï¼‰å¹³æ–¹å’Œåº”ç”¨äºå„ä¸ª 1-å•å…ƒï¼ˆç»„ï¼‰ï¼Œç»“æœåœ¨ç»„é—´æ±‡æ€»ã€‚

SSB ç”±ä»¥ä¸‹å…¬å¼ç»™å‡º

è¿™é‡Œï¼Œé¦–å…ˆè®¡ç®—ç»„å¹³å‡å€¼ï¼Œç„¶ååœ¨ç»„å¹³å‡å€¼ä¸Šè¿›è¡Œï¼ˆåŠ æƒï¼‰å¹³æ–¹å’Œæ“ä½œã€‚

ç”¨è¡¨æ ¼ç¬¦å·è¡¨ç¤ºï¼Œå¹³æ–¹å’Œåˆ†è§£ç”±ä»¥ä¸‹å…¬å¼ç»™å‡º

# Python å®ç°

ä»¥ä¸‹æä¾›äº† Python å®ç°ã€‚å®ƒç”±ä¸‰ä¸ªç±»ç»„æˆï¼šä¸€ä¸ª Tableau ç±»ï¼Œæ¥ç€æ˜¯ CountTableau å’Œ Mask ç±»çš„å­ç±»ã€‚æ¯ä¸ª Tableau å¯¹è±¡æ„é€ ä¸€ä¸ª CountTableau å¯¹è±¡ï¼Œç”¨äºè·å–å•å…ƒè®¡æ•°ã€‚Mask ç±»é‡å†™äº† __init__ æ–¹æ³•ï¼Œä»¥æ–­è¨€ä¼ å…¥çš„æ‰€æœ‰å€¼éƒ½æ˜¯å¸ƒå°”å€¼ï¼Œå¹¶é‡å†™äº† __mul__ æ–¹æ³•ï¼Œä»¥ä¿®æ”¹è¢«æ©è”½çš„è¿”å›å¯¹è±¡çš„è®¡æ•°ã€‚

```py
class Tableau:

    def __init__(self, dim, values):
        self.dim, self.p = dim, dim
        self.values = copy.deepcopy(values)
        self.count = CountTableau(dim, values)

    def __len__(self):
        return self.count.sum()

    def __bool__(self):
        return (len(self) > 0)

    def __getitem__(self, key):
        """ Returns p-cells if dim(key) < self.dim """
        key = [key] if isinstance(key, int) else list(key)
        if len(key) > self.dim:
            key = key[:self.dim]
        dim_out = self.dim - len(key)
        while len(key) < self.dim:
            key.append(slice(None, None, None))
        out = self.values.copy()
        while key:
            out = out[key.pop(0)]
        if dim_out == 0:
            return out 
        return Tableau(dim_out, out)

    def __setitem__(self, key, value):
        key = [key] if isinstance(key, int) else list(key)
        if isinstance(value, Tableau):
            assert len(key) + value.dim == self.dim 
            value = value.values
        def recursive_set(A, key, value):
            i = key.pop(0)
            if key:
                recursive_set(A[i], key, value)
            else:
                A[i] = value
        recursive_set(self.values, key, value)

    def __contains__(self, loc):
        try:
            self[loc]
            return True 
        except:
            return False

    def __call__(self, p):
        self.p = p 
        return self

    def __iter__(self):
        """ for i, x in T(p):  will iterate i in I_p, and return p-cells. """
        def recursive_loop(A, dim, loc=None):
            if loc is None:
                loc = [0] * self.p
            if dim < self.p-1:
                for i, x in enumerate(A):
                    loc[dim] = i
                    yield from recursive_loop(x, dim+1, loc)
            else:
                for i, x in enumerate(A):
                    loc[dim] = i 
                    yield loc 
        for index in recursive_loop(self.values, 0):
            yield tuple(index), self[index]
        self.p = self.dim 

    def __add__(self, other):
        """ Self may be higher dimension than other """
        new = Tableau(self.dim, copy.deepcopy(self.values))
        if np.isscalar(other):
            for i, _ in new:
                new[i] += other 
            return new 
        assert other.dim <= self.dim
        for i, x in other:
            if i in new:
                new[i] = new[i] + x
        return new 

    def __sub__(self, other):
        new = Tableau(self.dim, copy.deepcopy(self.values))
        if np.isscalar(other):
            for i, _ in new:
                new[i] -= other 
            return new 
        assert other.dim <= self.dim

        for i, x in other:
            if i in new:
                new[i] -= x 
        return new         

    def __mul__(self, other):
        """ Self may be lower dimension than other """
        if np.isscalar(other):
            new = Tableau(self.dim, copy.deepcopy(self.values))
            for i, _ in new:
                new[i] *= other 
            return new 

        assert self.dim <= other.dim 
        new = Tableau(other.dim, copy.deepcopy(other.values))
        for i, x in self:
            new[i] *= x 
        return new 

    def __truediv__(self, other):
        if np.isscalar(other):
            new = Tableau(self.dim, copy.deepcopy(self.values))
            for i, _ in new:
                new[i] /= other 
            return new         
        assert self.dim == other.dim 
        new = Tableau(self.dim, copy.deepcopy(self.values))
        for i, x in other:
            new[i] /= x
        return new        

    def __pow__(self, n):
        """ Defines Square of Tableau """
        assert n==2 
        return self * self

    def getPShell(self, p):
        shell = Tableau(p, copy.deepcopy(self.values))
        for i, _ in self(p):
            shell[i] = None 
        return shell

    def sum(self, p=0):
        if p == 0:
            total = 0
            for _, x in self:
                total += x 
            return total 
        S = self.getPShell(p)
        for i, x in self(p):
            S[i] = x.sum()
            if not isinstance(self, CountTableau) and not any(self.count[i].values):
                S.count[i] = 0
        return S 

    def mean(self, p=0, weights=None):
        if weights is None:
            return self.sum(p) / self.count.sum(p)
        weights /= weights.sum()
        Tw = weights * self
        return Tw.sum(p)

    def sumSquares(self, p=0, weights=None):
        if weights is None:
            S = (self - self.mean(p))**2 
        else:
            S = weights * (self - self.mean(p, weights=weights))**2
        return S.sum(p)

class CountTableau(Tableau):

    def __init__(self, dim, values):
        self.dim, self.p = dim, dim
        self.values = copy.deepcopy(values)
        for i, _ in self:
            self[i] = 1

class Mask(Tableau):

    def __init__(self, dim, values):
        super().__init__(dim, values)
        for _, x in self:
            assert x in (0, 1)

    def __len__(self):
        return self.sum() 

    def __mul__(self, other):
        new = super().__mul__(other)
        new.count = super().__mul__(new.count)
        return new 

    def __neg__(self):
        """ Use (-M) for logical negation of M """
        new = Mask(self.dim, copy.deepcopy(self.values))
        return new * (-1) + 1
```

__iter__ æ–¹æ³•ä½¿ç”¨é€’å½’éå†è¡¨æ ¼ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼ˆç±»ä¼¼äº enumerate(some_list)æˆ– k, v in some_dict.items()ï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å®ç°äº† __call__ æ–¹æ³•ï¼Œå¯ä»¥ä¸è¿­ä»£ç»“åˆä½¿ç”¨ï¼Œè¿™æ ·**for k, v in T(2):** å°±ä¼šéå†å†…å±‚ç´¢å¼•ç©ºé—´*Iâ‚‚*ï¼Œè¿”å›æ¯ä¸ª*Î¹â‚šâˆˆ Iâ‚‚*çš„çº¤ç»´*T_{Î¹â‚š}*ã€‚

ç±»ä¼¼åœ°ï¼Œ*mean*å’Œ*sumSquares*æ–¹æ³•éƒ½æ¥å—ä¸€ä¸ªå¯é€‰çš„å‚æ•°*p*ï¼Œè®¡ç®—å°†ä¼šåœ¨çº¤ç»´ä¸Šè¿›è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªåœ¨å†…ç´¢å¼•ç©ºé—´ä¸Šçš„*p*-ç»´ tableauã€‚

å¦‚æœ*A*çš„ç»´åº¦é«˜äº*B*ï¼Œåˆ™å®šä¹‰*A+B*ï¼Œè¿™å¯¹äºå¹³æ–¹å’Œè®¡ç®—æ˜¯å¿…éœ€çš„ã€‚ä¹˜æ³•åˆ™ç›¸åï¼Œåªè¦*A*çš„ç»´åº¦ä½äº*B*ï¼Œåˆ™å®šä¹‰*AB*ã€‚è¿™å¯¹äºä¸ä½ç»´æ©ç çš„å·¦ä¹˜å…¼å®¹æ€§æ˜¯å¿…éœ€çš„ï¼Œè¿™åœ¨èšç±»åˆ†æä¸­æ˜¯å¿…éœ€çš„ã€‚

æˆ‘ä»¬è¿˜å®ç°äº† __getitem__ å’Œ __setitem__ã€‚å‰è€…æœ‰ä¸€äº›é…·ç‚«çš„åœ°æ–¹ï¼Œä¸åµŒå¥—æ•°ç»„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¦å· T[1,2,3]æ¥è·å–ä½äº*(1,2,3)*çš„*p*-å•å…ƒã€‚ï¼ˆæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦ç”¨*:*å¡«å……å…¶ä½™ç»´åº¦ï¼›ä¾‹å¦‚ï¼Œå¯¹äº 5 ç»´çš„ tableauï¼Œ*T[1,2,3]*å°±å¯ä»¥ï¼Œè€Œæ— éœ€å†™*T[1,2,3,:,:]*ï¼è¿™æ¯”å¤„ç†åŸå§‹åµŒå¥—æ•°ç»„æ›´å¥½ï¼Œåè€…éœ€è¦ A[1][2][3]ã€‚ï¼‰__setitem__ ä½¿ç”¨é€’å½’è®¾ç½®å€¼ï¼Œæ‚¨ç”šè‡³å¯ä»¥åœ¨è¿™é‡Œä¼ é€’ä¸€ä¸ªé€‚å½“å½¢çŠ¶çš„å­ tableauã€‚

åŸºæœ¬æ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
def genx(n, maxval=100):
    return list(np.random.randint(0, maxval+1, size=n))

A = [[genx(2), genx(3), genx(4), genx(2), genx(2)], [genx(3), genx(4)], [genx(3), genx(2), genx(3)], [genx(5), genx(1)], [genx(2),genx(4),genx(3),genx(2)]]
T = Tableau(3, A)

for i, x in T(2):
    print(i, x.values)

# Outputs (contains all 2-cells of the tableau; indexed over I_2)
# (0, 0) [31, 75]
# (0, 1) [43, 57, 23]
# (0, 2) [47, 53, 38, 82]
# (0, 3) [69, 87]
# (0, 4) [65, 23]
# (1, 0) [42, 49, 8]
# (1, 1) [61, 13, 69, 37]
# (2, 0) [88, 84, 45]
# (2, 1) [21, 64]
# (2, 2) [83, 21, 83]
# (3, 0) [72, 42, 54, 83, 43]
# (3, 1) [3]
# (4, 0) [14, 55]
# (4, 1) [87, 49, 93, 65]
# (4, 2) [94, 95, 15]
# (4, 3) [27, 71]

T[4].values # same as T[4, :, :].values; returns a 2-tableau
# [[14, 55], [87, 49, 93, 65], [94, 95, 15], [27, 71]]

T[4, 1].values # returns a 1-tableau
# [87, 49, 93, 65]

T[4,1,3] # returns a scalar
# 65 

B = [[genx(2,1), genx(3,1), genx(4,1), genx(2,1), genx(2,1)], [genx(3,1), genx(4,1)], [genx(3,1), genx(2,1), genx(3,1)], [genx(5,1), genx(1,1)], [genx(2,1),genx(4,1),genx(3,1),genx(2,1)]]
M = Mask(3, B)

MT = M * T
len(T), len(M), M.sum(), len(MT)
# (45, 25, 25, 25)

MT.mean() # average of treatment values only
# 52.16
MT.sumSquares(1).values # sum-of-squares at the 1st level
# [19443.3125, 6934.4375, 9796.0, 6443.0, 30566.75]

MT[4].values  # compare with T[4].values, above; this is randomly masked
# [[0, 0], [87, 49, 0, 0], [0, 95, 15], [0, 0]]
```

ä¸‹é¢ç»™å‡ºäº†ä¸€ä¸ªå—è®¾è®¡çš„æ¨¡æ‹Ÿã€‚æˆ‘ä»¬ä½¿ç”¨äº† 5 ä¸ªå±‚æ¬¡ï¼Œå¤„ç†å€¾å‘ä¸º 30%ã€‚åœ¨æˆ‘ä»¬çš„æ¨¡æ‹Ÿä¸­ï¼Œå¤„ç†æ•ˆåº”æ˜¯ä¸€ä¸ªæ’å®šçš„ 10ï¼›å±‚æ¬¡å“åº”æœä»æ ‡å‡†å·®ä¸º 10 çš„æ­£æ€åˆ†å¸ƒï¼Œå±‚æ¬¡å‡å€¼æŒ‰ 10 çš„å¢é‡åˆ†éš”ã€‚æ¯ä¸ªå±‚æ¬¡åŒ…å« 400 åˆ° 500 ä¹‹é—´çš„éšæœºå•ä½ã€‚æˆ‘ä»¬æµ‹é‡äº†å‡å€¼å·®å¼‚ä¸º 9.7ï¼Œå¹¶ä»¥ 95%çš„ç½®ä¿¡åº¦æ‹’ç»äº†åŸå‡è®¾ã€‚

```py
n_strata = 5
pi = 0.3
shape = np.random.randint(400,500, size=n_strata)
n_t = (shape * pi).astype(int)
n_c = shape - n_t
A = [ list(np.random.normal(50+10*i, 10, size=shape[i]))  for i in range(n_strata)]
Z = [ list(np.random.choice([1]*n_t[i] + [0]*n_c[i], size=shape[i], replace=False )) for i in range(n_strata)]

Y = Tableau(2, A)
Z = Mask(2, Z)

Y = Y + (Z * 10)  # add a treatment effect of 10 to treated units

Yt = Z * Y 
Yc = (-Z) * Y

tau_hat = Yt.mean() - Yc.mean()
print(tau_hat)
# 9.74

dof = len(Y) - 2 * n_strata

MSW = (Yt.sumSquares(1).sum() + Yc.sumSquares(1).sum()) / dof
T = tau_hat / sqrt(MSW * (1/len(Yt) + 1/len(Yc)))

T_crit = scipy.stats.t.isf(0.05, dof)
print(T, T_crit, T > T_crit)
#  2.71, 1.65, True
```

æœ€åï¼Œç»™å‡ºäº†ä¸€ä¸ªèšç±»è®¾è®¡çš„ç¤ºä¾‹ã€‚

```py
n_cluster = 10
pi = 0.5
c_t = int(pi * n_cluster)
c_c = n_cluster - c_t
shape = np.random.randint(40,50, size=n_cluster)

A = [ list(np.random.normal(50+1*i, 10, size=shape[i]))  for i in range(n_cluster)]
Z = list(np.random.choice([1]*c_t + [0]*c_c, size=n_cluster, replace=False ))

Y = Tableau(2, A)
Z = Mask(1, Z)

Y = Y + (Z * 10)  # add a treatment effect of 10 to treated units

Yt = Z * Y 
Yc = (-Z) * Y

tau_hat = n_cluster / len(Y) * ( (Yt.sum(1)).mean() - (Yc.sum(1)).mean() )
print(tau_hat)
# 15.975
```

å…³äºèšç±»ç¤ºä¾‹çš„ä¸€äº›è¯´æ˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è®©èšç±»å‡å€¼éå¸¸æ¥è¿‘ã€‚å±‚æ¬¡åŒ–çš„ä¼°è®¡é‡æ–¹å·®ä¸»è¦ä¾èµ–äºå±‚æ¬¡å†…çš„æ–¹å·®ï¼Œè€Œåœ¨èšç±»çš„æƒ…å†µä¸‹ï¼Œå®ƒä¾èµ–äºèšç±»é—´çš„æ–¹å·®ã€‚ç”±äºæˆ‘ä»¬ä»…æ¨¡æ‹Ÿäº†å°‘é‡èšç±»ï¼Œè¿™æ˜¯ä¸€é¡¹éå¸¸ä½åŠŸæ•ˆçš„ç»“æœã€‚æœ€åï¼Œè¯·æ³¨æ„ï¼Œ`tau_hat`çš„å…¬å¼ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬*Tableau*ç±»çš„*sum*æ–¹æ³•æœ«å°¾çš„*if not any*é€»è¾‘ï¼›å¦åˆ™éƒ¨åˆ†å’Œä¼šé‡ç½®è®¡æ•°è¡¨ï¼Œè¿™ä¼šå¯¼è‡´é™¤ä»¥æ€»èšç±»æ•°ï¼Œè€Œä¸æ˜¯è¢«æ©ç›–çš„èšç±»æ•°ã€‚

ä½†æˆ‘ä»¬èƒ½å¦æŠµæŒ¡ä½åšä¸€ä¸ªå—èšç±»è®¾è®¡çš„ç¤ºä¾‹ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®©èšç±»å‡å€¼æŒ‰å±‚æ¬¡å˜åŒ–ï¼Œå¹¶å±•ç¤ºå¦‚ä½•å®ç°å—èšç±»å…¬å¼ã€‚

```py
n_strata = 3 
c_shape = [4, 8, 12]
cw = Tableau(1, c_shape)
a_t = [2, 4, 6]

A = [ [  list( np.random.normal(50 + 10 * i, size=np.random.randint(100,200)) )  for j in range(c_shape[i])  ]    for i in range(n_strata)]
Z = [  list( np.random.choice([1]*a_t[i] + [0]*a_t[i], size=c_shape[i], replace=False)    )  for i in range(n_strata)]

Y = Tableau(3, A)
Z = Mask(2, Z)

Y = Y + (Z * 10)

Yt = Z * Y 
Yc = (-Z) * Y

tau_hat = sum(c_shape) / len(Y) * (Yt.sum(2).mean(1) - Yc.sum(2).mean(1)).mean(weights=cw) 
print(tau_hat)
#16.64
```

# ç»“è®º

æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ˜¾å¼çš„ä»£æ•°ç»“æ„å«åš*tableau*ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªéƒ¨åˆ†å¡«å……çš„çŸ©é˜µï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†å„ç§æ“ä½œã€‚

å¯¹äºç»™å®šç»´åº¦*p*ï¼Œæˆ‘ä»¬å®šä¹‰äº†å†…å¤–ç´¢å¼•ç©ºé—´ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•åœ¨å¤–ç´¢å¼•ç©ºé—´ä¸Šåº”ç”¨æ“ä½œç¬¦å¯¹*p*-å•å…ƒè¿›è¡Œæ“ä½œï¼Œè¿”å›åœ¨å†…ç´¢å¼•ç©ºé—´ä¸Šå˜åŒ–çš„é‡ã€‚

æˆ‘ä»¬é€šè¿‡æ£€æŸ¥å„ç§å…³é”®ç»Ÿè®¡å…¬å¼ï¼ˆå‡å€¼å·®å¼‚ã€*T*ç»Ÿè®¡é‡ã€é›†ç¾¤éšæœºåŒ–çš„ä¼°è®¡å¤„ç†æ•ˆæœã€ç»„å†…å’Œç»„é—´å¹³æ–¹å’Œï¼‰ï¼Œå±•ç¤ºäº†è¿™äº›åŸºæœ¬æ“ä½œå¦‚ä½•ä¿ƒè¿›å®éªŒåˆ†æï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºä¸å˜å½¢å¼å’ŒæŒ‡æ•°å½¢å¼ã€‚

æœ€åï¼Œæˆ‘ä»¬æä¾›äº†æˆ‘ä»¬çš„ Tableau æ•°æ®ç»“æ„çš„ Python å®ç°ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å‡ è¡Œä»£ç æ‰§è¡Œå…³é”®å…¬å¼ã€‚

# å‚è€ƒæ–‡çŒ®

[1] P.D. Berger, R.E. Mauer, å’Œ G.B. Celli, *å®éªŒè®¾è®¡ï¼šåœ¨ç®¡ç†ã€å·¥ç¨‹å’Œç§‘å­¦ä¸­çš„åº”ç”¨*ï¼ˆ2018 å¹´ï¼‰ï¼Œç¬¬ 2 ç‰ˆï¼ŒSpringerã€‚

[2] J. Maruskin, [*æ•°æ®ç§‘å­¦ä¸‰éƒ¨æ›²ï¼šå®éªŒã€æ¨¡å‹ã€å­¦ä¹ *](https://www.amazon.com/Fundamentals-Data-Science-Trilogy-Experiment-Model-Learn/dp/1941043038/ref=sr_1_5?crid=23E5N6RECFXJF&keywords=jared+maruskin&qid=1695921221&sprefix=jared+maruski%2Caps%2C245&sr=8-5)ï¼ˆ2022 å¹´ï¼‰ï¼ŒCayenne Canyon Pressã€‚

[3] P.R. Rosenbaum, *è§‚å¯Ÿç ”ç©¶*ï¼ˆ2002 å¹´ï¼‰ï¼Œç¬¬ 2 ç‰ˆï¼ŒSpringerã€‚

[4] P.D. Rosenbaum, *è§‚å¯Ÿç ”ç©¶çš„è®¾è®¡*ï¼ˆ2020 å¹´ï¼‰ï¼Œç¬¬ 2 ç‰ˆï¼ŒSpringerã€‚

[5] M. Saveski, J. Pouget-Abadie, G. Saint-Jacques, W. Duan, S. Ghosh, Y. Xu, E.M. Airoldi, [æ£€æµ‹ç½‘ç»œæ•ˆåº”ï¼šåœ¨éšæœºåŒ–å®éªŒä¸­éšæœºåŒ–](https://www.kdd.org/kdd2017/papers/view/detecting-network-effects-randomizing-over-randomized-experiments)ï¼ˆ2017 å¹´ï¼‰ï¼ŒKDD ç ”ç©¶è®ºæ–‡ï¼Œå“ˆåˆ©æ³•å…‹æ–¯ï¼ŒåŠ æ‹¿å¤§ã€‚

[6] D. Selvamutha å’Œ D. Das, *ç»Ÿè®¡æ–¹æ³•ã€å®éªŒè®¾è®¡å’Œç»Ÿè®¡è´¨é‡æ§åˆ¶å¯¼è®º*ï¼ˆ2018 å¹´ï¼‰ï¼ŒSpringerã€‚

*é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å›¾ç‰‡å‡ç”±ä½œè€…æä¾›ã€‚*

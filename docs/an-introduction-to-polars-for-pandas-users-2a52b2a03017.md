# ã€ŠPandas ç”¨æˆ·çš„ Polars ä»‹ç»ã€‹

> åŸæ–‡ï¼š[`towardsdatascience.com/an-introduction-to-polars-for-pandas-users-2a52b2a03017`](https://towardsdatascience.com/an-introduction-to-polars-for-pandas-users-2a52b2a03017)

## å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªå…¨æ–°çš„ã€æé€Ÿçš„ DataFrame åº“ä¸è¡¨æ ¼æ•°æ®è¿›è¡Œäº¤äº’

[](https://dkhundley.medium.com/?source=post_page-----2a52b2a03017--------------------------------)![David Hundley](https://dkhundley.medium.com/?source=post_page-----2a52b2a03017--------------------------------)[](https://towardsdatascience.com/?source=post_page-----2a52b2a03017--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----2a52b2a03017--------------------------------) [David Hundley](https://dkhundley.medium.com/?source=post_page-----2a52b2a03017--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----2a52b2a03017--------------------------------) Â·17 min é˜…è¯»Â·2023 å¹´ 3 æœˆ 5 æ—¥

--

![](img/703b01459d9d9be0836f9fc0c45e973d.png)

æ ‡é¢˜å¡ç”±ä½œè€…åˆ›å»º

å¦‚æœä½ åƒæˆ‘ä¸€æ ·ï¼Œå¯èƒ½ä¼šå¬åˆ°å¾ˆå¤šå…³äºè¿™ä¸ªæ–° [Polars](https://www.pola.rs) åº“çš„å®£ä¼ ï¼Œä½†ä¸ç¡®å®šå®ƒæ˜¯ä»€ä¹ˆæˆ–å¦‚ä½•å¼€å§‹ä½¿ç”¨ã€‚å¦‚æœä½ å®Œå…¨é™Œç”Ÿï¼Œç†è§£ Polars æœ€ç®€å•çš„æ–¹å¼æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¯”ä¼ ç»Ÿçš„ Pandas DataFrame åº“æ›´å¿«çš„æ›¿ä»£å“ã€‚æœ¬æ–‡å°†ä¸“æ³¨äº Polars çš„ Python å®ç°ï¼Œä½†è¯·æ³¨æ„ï¼Œå®ƒä¹Ÿå¯ä»¥ä¸è¶Šæ¥è¶Šæµè¡Œçš„ Rust è¯­è¨€ä¸€èµ·ä½¿ç”¨ã€‚

åœ¨ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘é¦–å…ˆè¡¨è¾¾æˆ‘å¯¹ä»»ä½•æ–°è½¯ä»¶çš„è°¨æ…ä¹è§‚æ€åº¦ã€‚æ€»æ˜¯æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼šâ€œè¿™ä¼šå˜å¾—ä¸»æµå—ï¼Ÿâ€ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘å·²ç»è§è¯äº†å¤ªå¤šæ¬¡ä¸€æ¬¾å¾ˆé…·çš„è½¯ä»¶åœ¨æœ€åˆå¼•èµ·äº†å¤§é‡å…³æ³¨ï¼Œä½†åæ¥å´é€æ¸æ¶ˆå¤±ã€‚å…³äº Polarsï¼Œæˆ‘è®¤ä¸ºç°åœ¨åšå‡ºé•¿æœŸçš„åˆ¤æ–­ä¸ºæ—¶å°šæ—©ï¼Œä½†æˆ‘å°†åœ¨æœ¬æ–‡çš„æœ«å°¾æä¾›æˆ‘å¯¹ Polars çš„ä¸ªäººçœ‹æ³•ã€‚

æœ¬ä»‹ç»æŒ‡å—ä¸“é—¨ä¸ºé‚£äº›å·²ç»ç†Ÿæ‚‰ Pandas åº“çš„äººç¼–å†™ï¼Œæˆ‘å°†ç›´æ¥æ¯”è¾ƒ Polars å’Œ Pandas çš„è¯­æ³•å’Œæ€§èƒ½ã€‚å¦‚æœä½ å¸Œæœ›æ›´é¡ºç•…åœ°è·Ÿéšï¼Œè¯· [åœ¨ GitHub ä¸ŠæŸ¥æ‰¾æˆ‘çš„ä»£ç ](https://github.com/dkhundley/ds-quick-tips/blob/master/016_intro_to_polars/intro_to_polars.ipynb)ã€‚ä¸ºäº†æ¼”ç¤ºçš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [ç»å…¸çš„ Titanic æ•°æ®é›†](https://www.tensorflow.org/datasets/catalog/titanic)ã€‚å¦å¤–ï¼Œä¸ºäº†è¯´æ˜æˆ‘å±•ç¤ºçš„æ€§èƒ½æŒ‡æ ‡ï¼Œæˆ‘å°†åœ¨ä¸€å°æ ‡å‡†çš„ 2021 å¹´ MacBook Pro M1 Pro èŠ¯ç‰‡ä¸Šè¿›è¡Œæ‰€æœ‰æ“ä½œã€‚ï¼ˆæˆ‘è¿˜åœ¨è¿è¡Œ Windows 11 çš„ Microsoft Surface Pro 9 ä¸Šè¿›è¡Œäº†æµ‹è¯•ï¼Œå¹¶ç¡®è®¤å®ƒçš„è¡¨ç°ç±»ä¼¼ã€‚ï¼‰

åœ¨æ·±å…¥æ–‡ç« ä¸»ä½“ä¹‹å‰çš„æœ€åä¸€ç‚¹è¯´æ˜ï¼šPolars ä»å¤„äºéå¸¸æ—©æœŸçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼Œæ‰€ä»¥å³ä½¿ 6 ä¸ªæœˆåï¼Œæœ¬æ–‡çš„å†…å®¹ä¹Ÿå¯èƒ½å·²ç»è¿‡æ—¶ï¼Œä¸è¦æ„Ÿåˆ°æƒŠè®¶ã€‚

å¥½çš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ¢ç´¢ Polars å§ï¼ ğŸ»â€â„ï¸

# å®‰è£…

å¹¸è¿çš„æ˜¯ï¼Œå®‰è£… Polars éå¸¸ç®€å•ã€‚ä½ å¯ä»¥åƒå®‰è£…å…¶ä»– Python åº“ä¸€æ ·å®‰è£… Polarsã€‚è¿™é‡Œæ˜¯ä» PyPI å®‰è£… Polars çš„å…·ä½“å‘½ä»¤ã€‚

```py
pip install polars
```

åœ¨æœ¬æŒ‡å—çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦åœ¨ Pandas å’Œ Polars ä¹‹é—´è¿›è¡Œä¸€äº›è½¬æ¢ã€‚ï¼ˆæ˜¯çš„ï¼Œè¿™å¹¶ä¸ç†æƒ³ï¼Œæˆ‘æ›´æ„¿æ„é¿å…è¿™ç§æƒ…å†µï¼Œä½†ç›®å‰ï¼Œè¿™æ˜¯è§£å†³æˆ‘é‡åˆ°çš„ä¸€äº›é—®é¢˜çš„å”¯ä¸€æ–¹æ³•ã€‚ï¼‰ä¸ºæ­¤ï¼Œä½ è¿˜éœ€è¦å®‰è£… PyArrow Python åº“ã€‚ä¸å®‰è£… Polars ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ä» PyPI å®‰è£… PyArrowã€‚

```py
pip install pyarrow
```

æœ€åçš„å®‰è£…æ­¥éª¤æ˜¯å¯é€‰çš„ï¼Œä½†ä½ å¯èƒ½ä¼šå‘ç°å®ƒå¯¹æœªæ¥çš„å·¥ä½œå¾ˆæœ‰ç”¨ã€‚æ­£å¦‚ä»‹ç»ä¸­æåˆ°çš„ï¼Œæˆ‘æ‰“ç®—æ¼”ç¤º Pandas ä¸ Polars çš„æ€§èƒ½å¯¹æ¯”ï¼Œè€Œåœ¨ Jupyter notebook ä¸­è¿›è¡Œè¿™é¡¹å·¥ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ Jupyter é­”æ³•å‘½ä»¤`%% time`æ¥è¾“å‡ºæ¯ä¸ªç‰¹å®šå•å…ƒæ ¼çš„è¿è¡Œæ—¶é—´ã€‚è¿™è‡ªç„¶ä¼šå˜å¾—éå¸¸ç¹çï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£…ä¸€ä¸ªç‰¹æ®Šçš„ Jupyter æ‰©å±•ï¼Œå®ƒä¼šåœ¨æ¯ä¸ªè¿è¡Œçš„å•å…ƒæ ¼ä¸‹æ–¹è‡ªåŠ¨æ˜¾ç¤ºä¸€ä¸ªå°æ–‡æœ¬è¡Œæ¥æ˜¾ç¤ºè¿è¡Œæ—¶é—´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä½ çš„ CLI ä¸­è¿è¡Œä»¥ä¸‹ 3 ä¸ªå‘½ä»¤ã€‚

```py
pip install jupyter_contrib_nbextensions
jupyter contrib nbextension install --user
jupyter nbextension enable execute_time/ExecuteTime
```

ä¸Šè¿°å‘½ä»¤æ‰€å¯ç”¨çš„æ˜¯ Jupyter ç”¨æˆ·ç•Œé¢ä¸­çš„ä¸€ä¸ªæ–°åˆ‡æ¢æŒ‰é’®ï¼Œå®ƒå¯ä»¥æ­£ç¡®æ˜¾ç¤ºæ¯ä¸ªå•å…ƒæ ¼è¿è¡Œçš„è¿è¡Œæ—¶é—´ã€‚è¦åœ¨ Jupyter notebook ç•Œé¢ä¸­å¯ç”¨æ­¤åŠŸèƒ½ï¼Œå¯¼èˆªåˆ° `Cell > Execution Timings` å¹¶é€‰æ‹© `Toggle Visibility (all)`ã€‚ä¸‹é¢çš„æˆªå›¾ä¹Ÿæ°å½“åœ°æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ã€‚

![](img/d994115ff6980b9841e5028199f2f595.png)

ä½œè€…æ•æ‰çš„æˆªå›¾

# å¼€å§‹ä½¿ç”¨

åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å±•ç¤ºä¸€äº›å¸¸è§å‘½ä»¤ï¼Œè®¸å¤šæ•°æ®ç§‘å­¦å®¶å’Œæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆåœ¨å¤„ç†ä»»ä½•æ–°æ•°æ®é›†æ—¶éƒ½å–œæ¬¢å…ˆè¿è¡Œè¿™äº›å‘½ä»¤ã€‚ä½œä¸ºæé†’ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Titanic æ•°æ®é›†ï¼Œæˆ‘å·²ç»å°†å…¶ä¿å­˜ä¸º CSV æ–‡ä»¶åœ¨ä¸€ä¸ªç›¸é‚»çš„ç›®å½•ä¸­ã€‚

## å¯¼å…¥ Pandas å’Œ Polars

å½“ç„¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€‚å½“åœ°å¯¼å…¥å„è‡ªçš„ Python åº“ã€‚æ­£å¦‚ Pandas ç”¨æˆ·æ‰€çŸ¥é“çš„ï¼ŒPandas åœ¨å¯¼å…¥æ—¶å‡ ä¹è¢«åˆ«åä¸º `pd`ã€‚åŒæ ·ï¼ŒPolars ä¹Ÿé€šå¸¸ç”¨ä¸¤ä¸ªå­—æ¯ `pl` ä½œä¸ºåˆ«åã€‚

```py
# Importing Pandas and Polars
import pandas as pd
import polars as pl
```

## ä» CSV æ–‡ä»¶åŠ è½½æ•°æ®

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½ ä¼šå‘ç° Polars å’Œ Pandas æœ‰æ—¶åœ¨åšäº‹æƒ…çš„æ–¹å¼ä¸Šä¼šéå¸¸ä¸åŒï¼Œè€Œæœ‰æ—¶è¯­æ³•åˆ™å®Œå…¨ç›¸åŒã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ç¬¬ä¸€æ¬¡ç¤ºä¾‹ä¸­ä» Pandas åˆ° Polars çš„è¯­æ³•æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†è¿™ç§ç›¸ä¼¼æ€§ã€‚

```py
# Setting the filepath where I have saved the Titanic dataset locally
TITANIC_FILEPATH = '../data/titanic/train.csv'

# Loading the Titanic dataset with Pandas
df_pandas = pd.read_csv(TITANIC_FILEPATH)

# Loading the Titanic dataset with Polars
df_polars = pl.read_csv(TITANIC_FILEPATH)
```

åœ¨ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¼€å§‹è®¨è®ºè¿™äº›åº“çš„æ€§èƒ½ã€‚æ­£å¦‚ä¸‹é¢çš„æˆªå›¾æ‰€ç¤ºï¼ŒPolars çš„åŠ è½½æ¯” Pandas çš„åŠ è½½å¿«äº† 1 æ¯«ç§’ã€‚é€æ˜åœ°è¯´ï¼Œæ¯æ¬¡è¿è¡Œè¿™äº›å•å…ƒæ ¼æ—¶æˆ‘å¾—åˆ°çš„ç»“æœä¸åŒï¼Œä½†æˆ‘å¯ä»¥è¯´ Polars ä¸€ç›´æ¯”è¾ƒå¿«ã€‚è¿™å°†æ˜¯æœ¬æ–‡ä¸­çš„ä¸€ä¸ªåå¤å‡ºç°çš„ä¸»é¢˜ã€‚

![](img/a81ee9ee2adf7aa1ef5a518cd505c450.png)

ä½œè€…æˆªå›¾

## æŸ¥çœ‹æ¯ä¸ª DataFrame çš„å‰å‡ è¡Œ

åœ¨åŠ è½½ CSV æ–‡ä»¶åï¼Œæˆ‘å–œæ¬¢åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŸ¥çœ‹ DataFrame çš„å‰å‡ è¡Œï¼Œä»¥ä¾¿äº†è§£æˆ‘æ­£åœ¨å¤„ç†çš„æ•°æ®ã€‚ä»è¯­æ³•è§’åº¦æ¥çœ‹ï¼ŒPandas ç”¨æˆ·ä¼šå‘ç° Polars çš„å®ç°å®Œå…¨ç›¸åŒï¼Œä½¿ç”¨èµ·æ¥éå¸¸å¾—å¿ƒåº”æ‰‹ã€‚

```py
# Viewing the first few rows of the Pandas DataFrame
df_pandas.head()

# Viewing the first few rows of the Polars DataFrame
df_polars.head()
```

å°½ç®¡è¯­æ³•ç›¸åŒï¼Œä½† Pandas å’Œ Polars ä¹‹é—´çš„è¾“å‡ºæœ‰è¶£åœ°ä¸åŒï¼Œè€Œä¸”å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘å®é™…ä¸Šéå¸¸å–œæ¬¢ Polars åœ¨è¿™é‡Œæ˜¾ç¤ºçš„è¾“å‡ºã€‚æ­£å¦‚ä½ åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼ŒPolars ç›´æ¥åœ¨æ¯ä¸ªç‰¹å¾çš„åç§°ä¸‹æ–¹æ˜¾ç¤ºæ¯ä¸ªç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚æ­¤å¤–ï¼ŒåŸºäºå­—ç¬¦ä¸²çš„åˆ—çš„è¯­æ³•ä¼šå°†å€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚æˆ‘ä¸ªäººéå¸¸å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œå› ä¸º Pandas å¯¹æ¯åˆ—çš„æ•°æ®ç±»å‹å¹¶ä¸ç‰¹åˆ«æ˜ç¡®ï¼Œå°¤å…¶æ˜¯å­—ç¬¦ä¸²åˆ—ã€‚Polars å”¯ä¸€å¥‡æ€ªçš„åœ°æ–¹æ˜¯ï¼Œå®ƒä¸ä¼šåƒ Pandas é‚£æ ·å°†æ¯è¡Œçš„ç´¢å¼•å€¼æ˜¾ç¤ºåœ¨å·¦ä¾§ã€‚éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œç´¢å¼•å€¼ä»ç„¶å­˜åœ¨ï¼Œåªæ˜¯æ²¡æœ‰åœ¨æ­¤è§†å›¾ä¸­æ˜¾ç¤ºã€‚ï¼ˆè¿˜è¦æ³¨æ„ï¼ŒPolars åœ¨è¿™ä¸ªå®ä¾‹ä¸­è¿è¡Œé€Ÿåº¦æ˜¯ Pandas çš„ä¸¤å€ã€‚ï¼‰

![](img/77491e9e6f6e522038c99211c9ed321e.png)

ä½œè€…æˆªå›¾

## æŸ¥çœ‹ DataFrame çš„ä¿¡æ¯

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸¤ä¸ªåº“çš„è¯­æ³•ä¸€ç›´ç›¸åŒï¼Œä½†ç°åœ¨æˆ‘ä»¬è¿›å…¥å®ƒä»¬åœ¨åŠŸèƒ½ä¸Šå¼€å§‹å¤§ç›¸å¾„åº­çš„éƒ¨åˆ†ã€‚Pandas ç”¨æˆ·ä¼šç†Ÿæ‚‰ä¸¤ä¸ªå‡½æ•°ï¼Œå®ƒä»¬åˆ†åˆ«å±•ç¤ºå…³äº DataFrame çš„ä¿¡æ¯ï¼š`info()` å’Œ `describe()`ã€‚`info()` æ˜¾ç¤ºè¯¸å¦‚ç‰¹å¾åç§°ã€æ•°æ®ç±»å‹å’Œç©ºå€¼ç­‰ä¿¡æ¯ï¼Œè€Œ `describe()` æ˜¾ç¤ºä¸æ¯ä¸ªç‰¹å¾ç›¸å…³çš„ä¸€èˆ¬ç»Ÿè®¡æ•°æ®ï¼Œå¦‚å‡å€¼å’Œæ ‡å‡†å·®ã€‚ä»¥ä¸‹æ˜¯ Pandas ä»£ç ä»¥åŠæ¯ä¸ªå‡½æ•°è¾“å‡ºçš„æˆªå›¾ã€‚

```py
# Viewing the general contents of the Pandas DataFrame
df_pandas.info()

# Viewing stats about the Pandas DataFrame
df_pandas.describe()
```

![](img/7257c3eeb2171b3849283f789eb764f0.png)

ä½œè€…æˆªå›¾

åœ¨è¿™æ–¹é¢ï¼ŒPolars ä¸ Pandas å¤§ç›¸å¾„åº­ã€‚é¦–å…ˆï¼Œå®ƒæ²¡æœ‰ `info()` å‘½ä»¤ã€‚ç›¸åï¼Œå®ƒå°† `describe()` å‘½ä»¤è¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„èåˆï¼Œå°†æˆ‘ä»¬ä¹ æƒ¯äºçœ‹åˆ°çš„ Pandas `info()` å’Œ `describe()` å‡½æ•°çš„è¾“å‡ºåˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„è¾“å‡ºã€‚ä»¥ä¸‹æ˜¯å…¶æ ·å­ã€‚

```py
# Viewing information about the Polars DataFrame
df_polars.describe()
```

![](img/17664d4ae512f1016ed06d2128f64a1b.png)

ä½œè€…æˆªå›¾

è¯´å®è¯ï¼Œæˆ‘å¯¹è¿™ä¸ªå®ç°çš„æ„Ÿå—æœ‰äº›å¤æ‚ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘è®¤ä¸º Polars çš„è¾“å‡ºæ›´æ¸…æ¥šåœ°æ˜¾ç¤ºäº†ç©ºå€¼çš„æ•°é‡ï¼Œå› ä¸ºä½ éœ€è¦åšä¸€ç‚¹å¿ƒç†æ•°å­¦æ¥ç†è§£ Pandas è¾“å‡ºä¸­çš„ç©ºå€¼æ•°é‡ã€‚ä½†å¦ä¸€æ–¹é¢ï¼ŒPolars ä¸¢å¤±äº† Pandas æä¾›çš„ä¿¡æ¯ï¼Œå¦‚å››åˆ†ä½æ•°èŒƒå›´å€¼ã€‚è¿˜è¦æ³¨æ„ï¼Œåœ¨ Pandas çš„ `describe()` è¾“å‡ºä¸­ï¼Œå®ƒåˆç†åœ°æ’é™¤äº†åŸºäºå­—ç¬¦ä¸²çš„åˆ—ï¼Œè€Œ Polars ä»ç„¶ä¿ç•™å®ƒä»¬ã€‚æˆ‘é€šå¸¸ä¸ä¼šåœ¨æ„ï¼Œä½†å¦‚æœä½ çœ‹çœ‹â€œæ€§åˆ«â€ç‰¹å¾çš„â€œæœ€å°â€å’Œâ€œæœ€å¤§â€å€¼ï¼Œä¾‹å¦‚ï¼Œå®ƒç»™å‡ºäº†ä¸€äº›â€¦â€¦å—¯â€¦â€¦ä¸å¤ªä»¤äººæ„‰å¿«çš„ç»“æœï¼

## æ˜¾ç¤ºç‰¹å®šç‰¹å¾çš„å€¼è®¡æ•°

å¦ä¸€ä»¶æˆ‘å–œæ¬¢åœ¨å¼€å§‹ä½¿ç”¨åˆ†ç±»æ•°æ®é›†æ—¶åšçš„äº‹æƒ…æ˜¯æŸ¥çœ‹æ¯ä¸ªåˆ†ç±»ç‰¹å¾çš„å€¼è®¡æ•°ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å›åˆ°äº† Pandas ç”¨æˆ·ä¼šç†Ÿæ‚‰çš„ç±»ä¼¼è¯­æ³•ï¼Œåªæ˜¯ä½ ä¼šæ³¨æ„åˆ°è¾“å‡ºç•¥æœ‰ä¸åŒã€‚

```py
# Viewing the values associated to the "Embarked" column in the Pandas DataFrame
df_pandas['Embarked'].value_counts()

# Viewing the values associated to the "Embarked" column in the Polars DataFrame
df_polars['Embarked'].value_counts()
```

![](img/220da36c5be2321c116817c435d79ce2.png)

ä½œè€…æˆªå›¾

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼ŒPolars çš„è¾“å‡ºå®é™…ä¸Šæ›´å…·ä¿¡æ¯æ€§ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ç©ºå€¼çš„æ•°é‡ï¼Œè€Œ Pandas çš„è¾“å‡ºå®Œå…¨æ²¡æœ‰æåˆ°ç©ºå€¼ã€‚è¿™æ˜¯ä¸€ä¸ªæˆ‘å¿…é¡»æ‰¿è®¤ Polars ç»å¯¹èƒœå‡ºçš„ä¾‹å­ã€‚è¿™çœŸçš„å¾ˆæ–¹ä¾¿ï¼

# æ•°æ®æ•´ç†

ç°åœ¨æˆ‘ä»¬å·²ç»æ¢ç´¢äº†ä¸€äº›éå¸¸åˆæ­¥çš„å‘½ä»¤ï¼Œè®©æˆ‘ä»¬è¿›å…¥æ•°æ®æ•´ç†çš„æ›´å¤æ‚åŠŸèƒ½ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€äº›å¸¸è§çš„æ•´ç†ç­–ç•¥ï¼Œå¹¶ç»§ç»­æ¯”è¾ƒ Pandas å’Œ Polarsã€‚

## è·å– DataFrame çš„åˆ‡ç‰‡

è®°å¾—æˆ‘æåˆ°è¿‡ Polars åœ¨ `head()` è¾“å‡ºä¸­æ²¡æœ‰æ˜¾ç¤ºæ¯è¡Œçš„ç´¢å¼•å€¼ï¼Œä½†å®ƒä»¬ä»ç„¶å­˜åœ¨å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¼”ç¤ºå¦‚ä½•è·å–æ¯ä¸ª DataFrame çš„åˆ‡ç‰‡æ¥è¯æ˜è¿™ä¸€ç‚¹ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPolars å’Œ Pandas çš„è¯­æ³•å’Œè¾“å‡ºåœ¨è¿™é‡Œå®Œå…¨ç›¸åŒã€‚æ­¤å¤–ï¼Œå¿«é€ŸæŸ¥çœ‹æˆ‘ä»¬çš„æ€§èƒ½æŒ‡æ ‡ï¼Œæ³¨æ„åˆ° Polars æ‰§è¡Œåˆ‡ç‰‡çš„é€Ÿåº¦æ˜¯ Pandas çš„ä¸¤å€ã€‚

```py
# Getting a slice of the Pandas DataFrame using index values
df_pandas[15:30]

# Getting a slice of the Polars DataFrame using index values
df_polars[15:30]
```

![](img/5a9d0db740d6c18e987436ad631640cd.png)

ä½œè€…æˆªå›¾

## æŒ‰ç‰¹å¾å€¼è¿‡æ»¤ DataFrame

åœ¨æˆ‘ä»¬å°†åœ¨è¿™ç¯‡æ–‡ç« ä¸­å±•ç¤ºçš„æ‰€æœ‰å†…å®¹ä¸­ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥ä»¥å¤šç§ä¸åŒæ–¹å¼æ‰§è¡Œç›¸ä¼¼åŠŸèƒ½çš„é¢†åŸŸã€‚æˆ‘ä¸ä¼šå°è¯•æ¼”ç¤ºæ‰€æœ‰æ–¹æ³•ï¼Œå› æ­¤æˆ‘é€‰æ‹©äº†ä»¥ä¸‹æ–¹å¼æ¥å±•ç¤º Polars å¦‚ä½•ä»¥ç•¥æœ‰ä¸åŒçš„è¯­æ³•æ¨¡æ‹Ÿ Pandas çš„ç›¸ä¼¼åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯æå–æ‰€æœ‰ä»£è¡¨æ³°å¦å°¼å…‹å·ä¸Šé’å°‘å¹´çš„è¡Œçš„ä»£ç ã€‚ï¼ˆç”±äºæœ‰ 95 åé’å°‘å¹´ï¼Œè¾“å‡ºæœ‰ç‚¹é•¿ï¼Œå› æ­¤æˆ‘ä¸ä¼šæ˜¾ç¤ºè¾“å‡ºã€‚åªéœ€çŸ¥é“è¾“å‡ºç¡®å®æ˜¯ç›¸åŒçš„ã€‚ï¼‰

```py
# Extracting teenagers from the Pandas DataFrame
df_pandas[df_pandas['Age'].between(13, 19)]

# Extracting teenagers from the Polars DataFrame
df_polars.filter(df_polars['Age'].is_between(13, 19))
```

å†æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸åŒçš„è¯­æ³•åœ¨ Pandas å’Œ Polars ä¸­å®ç°ç›¸åŒçš„ç»“æœã€‚æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œ[å®˜æ–¹ Polars æ–‡æ¡£](https://pola-rs.github.io/polars/py-polars/html/reference/dataframe/api/polars.DataFrame.filter.html#polars.DataFrame.filter)æ¼”ç¤ºäº†æˆ‘ä¸Šé¢åšçš„äº‹æƒ…ï¼Œä½¿ç”¨äº†æˆ‘è®¤ä¸ºæ¯”è¾ƒå¥‡æ€ªçš„è¯­æ³•ã€‚å½“æˆ‘ä½¿ç”¨`df_polars['Age']`æ¥å¼•ç”¨ Polars DataFrame ä¸­çš„â€œAgeâ€åˆ—æ—¶ï¼Œå®˜æ–¹æ–‡æ¡£æ¨èä½¿ç”¨è¿™ç§è¯­æ³•ï¼š`pl.col('Age')`ã€‚è¾“å‡ºæ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œæ‰€ä»¥è¯´å“ªä¸€ç§éƒ½æ˜¯å¯¹çš„ä¹Ÿæœªå¿…ã€‚ä½ ä¼šè§‰å¾— Polars åº”è¯¥å°½å¯èƒ½åœ°å±•ç¤ºä¸ Pandas ç±»ä¼¼çš„å†…å®¹ï¼Œå› ä¸ºå¤§å¤šæ•°ä½¿ç”¨ Polars çš„äººéƒ½æ˜¯ Pandas ç”¨æˆ·ï¼Œæ­£å¦‚æˆ‘æˆåŠŸå±•ç¤ºçš„é‚£æ ·ï¼Œ`df_polars['Age']`çš„ç±»é€‰æ‹©æ•ˆæœå¾ˆå¥½ã€‚è¿™åœ¨ Polars æ–‡æ¡£ä¸­å®é™…ä¸Šå¾ˆå¸¸è§ï¼Œå› æ­¤è¯·æ³¨æ„ï¼Œå°½ç®¡æ–‡æ¡£å¯èƒ½è¯´ä¸€å›äº‹ï¼Œä½†ä½ å¯èƒ½å¯ä»¥ä½¿ç”¨ä½ å·²ç»ç†Ÿæ‚‰çš„æ›´ç»å…¸çš„è¯­æ³•ã€‚

## å¡«å…… Null å€¼

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯¹ Polars çš„ä½“éªŒä»ä¸­æ€§åˆ°ç§¯æã€‚é—æ†¾çš„æ˜¯ï¼Œåœ¨è¿™ä¸ªç‰¹å®šçš„åŠŸèƒ½ä¸Šï¼Œæˆ‘ä»¬å¼€å§‹è¿›å…¥ä¸€äº›è´Ÿé¢é¢†åŸŸã€‚åœ¨ Pandas ä¸­ï¼Œç”¨ null å€¼å¡«å……ä¸€åˆ—æ˜¯ç›¸å¯¹ç®€å•çš„ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç›´æ¥ä½¿ç”¨`inplace`å‚æ•°æ¥å®Œæˆå¡«å……ã€‚

```py
# Filling "Embarked" nulls in the Pandas DataFrame
df_pandas['Embarked'].fillna('S', inplace = True)
```

ä¸å¹¸çš„æ˜¯ï¼ŒPolars åœ¨è¿™é‡Œæœ‰ç‚¹å¥‡æ€ªã€‚é¦–å…ˆï¼Œæ²¡æœ‰`inplace`å‚æ•°çš„ç­‰æ•ˆé¡¹ï¼Œè¿™å®é™…ä¸Šæ˜¯ Polars ä¸­ä¸€ä¸ªåå¤å‡ºç°çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬ç¨åä¼šå†æ¬¡çœ‹åˆ°ã€‚æ­¤å¤–ï¼ŒPolars å®é™…ä¸Šæœ‰ä¸¤ä¸ªä¸åŒçš„å¡«å…… null å€¼çš„å‡½æ•°ï¼š`fill_null()`å’Œ`fill_nan()`ã€‚æŸ¥çœ‹æ¯ä¸ªå‡½æ•°çš„æ–‡æ¡£ï¼Œæˆ‘è¯šå®åœ°å‘Šè¯‰ä½ æˆ‘ä¸æ˜ç™½ä¸ºä»€ä¹ˆé€‰æ‹©å…¶ä¸­ä¸€ä¸ªè€Œä¸æ˜¯å¦ä¸€ä¸ªã€‚ï¼ˆå½“ç„¶ï¼Œè¿™å¯èƒ½æ˜¯æˆ‘è‡ªå·±çš„æ— çŸ¥ã€‚ï¼‰åœ¨ä¸‹é¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†`fill_null()`å‡½æ•°ï¼Œå…¶æ•ˆæœä¸ Pandas çš„`fillna()`ç›¸åŒã€‚

```py
# Filling "Embarked" nulls in the Polars DataFrame
df_polars = df_polars.with_columns(df_polars['Embarked'].fill_null('S'))
```

## æŒ‰ç‰¹å¾åç§°åˆ†ç»„æ•°æ®

ä¸ºäº†æ›´æ·±å…¥åœ°ç†è§£æ•°æ®ï¼Œæ•°æ®ä»ä¸šè€…é€šå¸¸ä¼šå°†æ•°æ®åˆ†ç»„ä»¥äº†è§£æ•°æ®ç»„å¯èƒ½å¸¦æ¥çš„æ–°è§è§£ã€‚åœ¨è¿™æ–¹é¢ï¼ŒPandas ç”¨æˆ·ä¼šéå¸¸ç†Ÿæ‚‰`groupby()`å‡½æ•°ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒPolars ç¡®å®ä¹Ÿæœ‰ä¸€ä¸ª`groupby()`å‡½æ•°ï¼Œä½†å®ƒçš„è¾“å‡ºå´å¤§ç›¸å¾„åº­ã€‚Pandas ç”¨æˆ·ä¼šå‘ç°è¿™ç§å·®å¼‚å¾ˆçªå…€ï¼Œæˆ‘å¦ç‡åœ°è¯´æ²¡æœ‰æ‰¾åˆ°ä½¿ç”¨ä¸åŒ Polars è¯­æ³•æ¥æ¨¡æ‹Ÿ Pandas è¾“å‡ºçš„æ–¹æ³•ã€‚ï¼ˆå½“ç„¶ï¼Œæˆ‘æ‰¿è®¤æˆ‘æ²¡æœ‰å°è¯•å¾—å¾ˆè®¤çœŸã€‚ğŸ˜…ï¼‰è§ä¸‹æ–‡ï¼Œå¦‚ä½•ç”¨ç›¸åŒçš„è¯­æ³•åœ¨æ¯ä¸ªåº“ä¸­äº§ç”Ÿæˆªç„¶ä¸åŒçš„ç»“æœã€‚

```py
# Grouping data by ticket class and gender to view counts in the Pandas DataFrame
df_pandas.groupby(by = ['Pclass', 'Sex']).count()

# Grouping data by ticket class and gender to view counts in the Polars dataframe
df_polars.groupby(by = ['Pclass', 'Sex']).count()
```

![](img/787392a5661e492c2433c0acafb38a14.png)

ä½œè€…æˆªå›¾

# ç‰¹å¾å·¥ç¨‹

è™½ç„¶ç‰¹å¾å·¥ç¨‹ç¡®å®å¯ä»¥è¢«è§†ä¸ºæ•°æ®å¤„ç†çš„ä¸€ç§ç±»å‹ï¼Œä½†æˆ‘å†³å®šå°†å…¶åˆ†å¼€æˆç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒä¸æˆ‘è¿‡å»åšçš„å…¶ä»–å·¥ä½œç›¸å…³ã€‚ä½œä¸º [GitHub ä¸Šè¿™ä¸ªç¬”è®°æœ¬](https://github.com/dkhundley/titanic-byoc/blob/main/notebooks/feature-engineering.ipynb) çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•å¯¹ Titanic æ•°æ®é›†è¿›è¡Œç‰¹å¾å·¥ç¨‹ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨è¿™ä¸€éƒ¨åˆ†è¦†ç›–æ¯ä¸€ä¸ªç‰¹å¾å·¥ç¨‹ï¼Œä½†æˆ‘ä»¬ä¼šå±•ç¤ºä¸€äº›å†…å®¹ï¼Œä»¥ä¾¿ä½ å¯ä»¥äº†è§£è¿™äº›ç›¸åŒçš„å·¥ä½œåœ¨ Pandas å’Œ Polars ä¸­çš„æ¯”è¾ƒã€‚æˆ‘ä»¬å°†é€šè¿‡ä½¿ç”¨ä»¥ä¸‹ä»£ç ä»å¤´å¼€å§‹é‡æ–°åŠ è½½æ¯ä¸ª DataFrame æ¥é‡æ–°å¼€å§‹ã€‚

```py
# Reloading each DataFrame from scratch
df_pandas = pd.read_csv(TITANIC_FILEPATH)
df_polars = pl.read_csv(TITANIC_FILEPATH)
```

## åˆ é™¤ä¸å¿…è¦çš„ç‰¹å¾

åœ¨å‡ ä¹æ‰€æœ‰ä½ ä¼šå¤„ç†çš„æ•°æ®é›†ä¸­ï¼Œä½ éƒ½ä¼šå‘ç°ä¸€äº›æ— å…³çš„ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾åœ¨ä¼ é€’ç»™ä»»ä½•æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹å‰éœ€è¦è¢«åˆ é™¤ã€‚è™½ç„¶åœ¨ Polars ä¸­è¿™å¹¶ä¸å›°éš¾ï¼Œä½†è¯·è®°ä½ï¼ŒPolars çš„å‡½æ•°æ²¡æœ‰ç±»ä¼¼ `inplace` å‚æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•å°±åœ°æ›´æ–° Polars DataFrameã€‚ä¸‹é¢æ˜¯ä¸¤ç§åº“ä¸­åˆ é™¤ç‰¹å¾çš„è¯­æ³•ã€‚

```py
# Dropping unnecessary features from the Pandas DataFrame
df_pandas.drop(columns = ['PassengerId', 'Name', 'Ticket', 'Cabin'], inplace = True)

# Dropping unnecessary features from the Polars DataFrame
df_polars = df_polars.drop(columns = ['PassengerId', 'Name', 'Ticket', 'Cabin'])
```

## å¯¹åˆ†ç±»ç‰¹å¾è¿›è¡Œç‹¬çƒ­ç¼–ç 

è¿˜è®°å¾—æˆ‘æœ€å¼€å§‹æåˆ°æˆ‘ä»¬å¿…é¡»å®‰è£… PyArrow ä»¥å°†æˆ‘ä»¬çš„ Polars DataFrame è½¬æ¢ä¸º Pandas DataFrame å—ï¼Ÿå¥½å§ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¿…é¡»è¿™ä¹ˆåšçš„ç¬¬ä¸€ä¸ªå®ä¾‹ã€‚æˆ‘ä¸ªäººæ›´å–œæ¬¢ä½¿ç”¨ [Category Encoder çš„ç‹¬çƒ­ç¼–ç å®ç°](https://contrib.scikit-learn.org/category_encoders/onehot.html) æ¥è¿›è¡Œç‹¬çƒ­ç¼–ç ã€‚ä¸ºäº†è¯´æ˜ï¼Œè¿™é‡Œæ˜¯å®‰è£…åå¦‚ä½•å¯¼å…¥å®ƒã€‚

```py
# Importing the one-hot encoding object from Category Encoders
from category_encoders.one_hot import OneHotEncoder
```

å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Pandas å¯¹â€œæ€§åˆ«â€ï¼ˆå³æ€§åˆ«ï¼‰ç‰¹å¾è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Œä»¥ä¸‹æ˜¯è¯­æ³•ç¤ºä¾‹ã€‚

```py
# Instantiating One Hot Encoder objects for the Pandas DataFrame
sex_ohe_encoder_pandas = OneHotEncoder(use_cat_names = True, handle_unknown = 'ignore')

# Performing a one hot encoding on the "Sex" column for the Pandas DataFrame
sex_dummies_pandas = sex_ohe_encoder_pandas.fit_transform(X_pandas['Sex'])

# Concatenating the gender dummies back to the original Pandas DataFrame
X_pandas = pd.concat([X_pandas, sex_dummies_pandas], axis = 1)

# Dropping the original "Sex" column in the Pandas DataFrame
X_pandas.drop(columns = ['Sex'], inplace = True)
```

ä¸å¹¸çš„æ˜¯ï¼ŒCategory Encoder çš„ `OneHotEncoder` å¹¶æœªè®¾ç½®ä¸ºä¸ Polars ä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸‹é¢æˆªå›¾ä¸­çš„é”™è¯¯ã€‚

```py
# Performing a one hot encoding on the "Sex" column for the Polars DataFrame
sex_dummies_polars = sex_ohe_encoder_polars.fit_transform(X_polars['Sex'])
```

![](img/2f75467a70dbf45a14f5592e0f666ca0.png)

ä½œè€…æˆªå›¾

æœ‰ä¸€ç§è§£å†³æ–¹æ³•ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ä¼šæ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡é‡åˆ°ç±»ä¼¼çš„ç ´åæ€§é—®é¢˜ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ Polars æ‰§è¡Œç‹¬çƒ­ç¼–ç çš„å®Œæ•´è§£å†³æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œåœ¨å°† Polars DataFrame æ‹Ÿåˆåˆ° `OneHotEncoder` å¯¹è±¡ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°†å…¶è½¬æ¢ä¸º Pandas DataFrameã€‚ç„¶ååœ¨è½¬æ¢åï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å…¶è½¬æ¢å› Polars DataFrameã€‚

```py
# Instantiating One Hot Encoder objects for the Polars DataFrame
sex_ohe_encoder_polars = OneHotEncoder(use_cat_names = True, handle_unknown = 'ignore')

# Performing a one hot encoding on the "Sex" column for the Polars DataFrame
sex_dummies_polars = sex_ohe_encoder_polars.fit_transform(X_polars['Sex'].to_pandas())

# Converting the Polars dummies from a Pandas DataFrame to a Polars DataFrame
sex_dummies_polars = pl.from_pandas(sex_dummies_polars)

# Concatenating the gender dummies back to the original Polars DataFrame
X_polars = pl.concat([X_polars, sex_dummies_polars], how = 'horizontal')

# Dropping the original "Sex" column in the Polars DataFrame
X_polars = X_polars.drop(columns = ['Sex'])
```

æœ€åï¼Œè¯·æ³¨æ„ï¼ŒPolars çš„ `concat()` å‡½æ•°çš„å®ç°ä¸ Pandas æœ‰äº›ä¸åŒã€‚Pandas ä½¿ç”¨ `axis` å‚æ•°æ¥æŒ‡ç¤ºå¦‚ä½•æ‰§è¡Œè¿æ¥ï¼Œè€Œ Polars åˆ™ä½¿ç”¨ `how` å’ŒåŸºäºå­—ç¬¦ä¸²çš„å€¼ã€‚æˆ‘ä¸ªäººæ›´å–œæ¬¢ Polars åœ¨è¿™é‡Œçš„å®ç°ã€‚

## æ•°å€¼æ•°æ®åˆ†ç®±

æˆ‘é€‰æ‹©æ‰§è¡Œâ€œå¹´é¾„â€ç‰¹å¾å·¥ç¨‹çš„æ–¹å¼æ˜¯å°†å…¶åˆ†ç®±ä¸ºé€‚å½“çš„å¹´é¾„ç»„ã€‚ä¾‹å¦‚ï¼Œ13 è‡³ 19 å²çš„äººè¢«åˆ†ç±»ä¸ºé’å°‘å¹´ï¼Œè€Œ 60 å²ä»¥ä¸Šçš„äººè¢«è®¤ä¸ºæ˜¯è€å¹´äººã€‚Pandas æœ‰ä¸€ä¸ªéå¸¸å¥½çš„å‡½æ•°å«åš`cut()`ï¼Œå¯ä»¥æ ¹æ®ä½ æä¾›çš„è¾“å…¥æ­£ç¡®åœ°è¿›è¡Œåˆ†ç®±ã€‚è¿™æ˜¯æ‰§è¡Œæ­¤æ“ä½œçš„è¯­æ³•ã€‚

```py
# Establishing our bins values and names
bin_labels = ['child', 'teen', 'young_adult', 'adult', 'elder']
bin_values = [-1, 12, 19, 30, 60, 100]

# Applying "Age" binning for the Pandas DataFrame
age_bins_pandas = pd.DataFrame(pd.cut(X_pandas['Age'], bins = bin_values, labels = bin_labels))
```

Polars ç¡®å®æä¾›äº†è‡ªå·±å®ç°çš„`cut()`å‡½æ•°ï¼Œä½†å…¶è¾“å‡ºä¸ Pandas çš„å·®å¼‚éå¸¸å¤§ï¼Œä»¥è‡³äºæˆ‘ä¸ªäººè§‰å¾—æ— æ³•ä½¿ç”¨ã€‚è¿™æ˜¯è¯¥ä»£ç çš„è¯­æ³•å’Œè¾“å‡ºã€‚

```py
# Applying "Age" binning for the Polars DataFrame
age_bins_polars = pl.cut(X_polars['Age'], bins = bin_values)
age_bins_polars.head()
```

![](img/dc0c1a4929db2da4a03c4721c8ef94ed.png)

ä½œè€…æ•è·çš„æˆªå›¾

çœ‹è¾“å‡ºç»“æœï¼Œå®é™…ä¸Šçœ‹èµ·æ¥åˆ†ç®±æ“ä½œç¡®å®æœ‰æ•ˆï¼Œä½†å®ƒåšäº†ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œå®ƒæ²¡æœ‰ä½¿ç”¨æˆ‘é€šè¿‡`bin_labels`æ•°ç»„å»ºç«‹çš„è¯­ä¹‰åç§°ã€‚å…¶æ¬¡ï¼Œå®ƒæ²¡æœ‰ä¿æŒä¼ å…¥å‡½æ•°çš„è¡Œé¡ºåºã€‚ç›¸åï¼Œä½ å¯ä»¥çœ‹åˆ° Polars çš„è¾“å‡ºç°åœ¨å·²ç»æŒ‰ç…§ä»æœ€ä½å€¼ï¼ˆå³æœ€å¹´è½»çš„å¹´é¾„ï¼‰å¼€å§‹çš„å‡åºæ’åºã€‚æˆ‘ç›¸ä¿¡æˆ‘å¯ä»¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•ï¼Œä½†ç¬¬äºŒä¸ªé—®é¢˜ä½¿å¾—è¿™ä¸ªè¾“å‡ºå¯¹æˆ‘æ¥è¯´æ¯«æ— ç”¨å¤„ã€‚è¯±æƒ‘æ˜¯å°†å¹´é¾„ä¸åŸå§‹ DataFrame åŒ¹é…ï¼Œä½†æ­£å¦‚ä½ åœ¨è¿™ä¸ªç®€å•çš„è¾“å‡ºä¸­çœ‹åˆ°çš„ï¼Œè¡Œ 4 å’Œè¡Œ 5 æœ‰ç›¸åŒçš„`0.75`å€¼ã€‚è™½ç„¶åœ¨è¿™ä¸ªç‰¹å®šç”¨ä¾‹ä¸­å¯èƒ½æ²¡é—®é¢˜ï¼Œä½†è¿™ç§åšæ³•å¯¹ä¸åŒçš„æ•°æ®é›†å¯èƒ½æ˜¯å±é™©çš„ã€‚

ï¼ˆæ³¨ï¼šåœ¨æˆ‘è‰æ‹Ÿè¿™ç¯‡æ–‡ç« æ—¶ï¼Œæˆ‘ä» Polars 0.16.8 å‡çº§åˆ° 0.16.10ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼ŒPolars çš„`cut()`å‡½æ•°ç°åœ¨è¢«å¼ƒç”¨ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ Polars Series å®ç°çš„`cut()`ã€‚ä¼¼ä¹è¿™ä¸ªæ–°å®ç°æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œåœ¨å‘å¸ƒæ—¶ï¼Œ[ä¸€ä¸ª GitHub é—®é¢˜](https://github.com/pola-rs/polars/issues/4286)å·²è¢«æŒ‡å‡ºè¯·æ±‚æ·»åŠ è¡Œç´¢å¼•ä¿ç•™ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æé†’ï¼ŒPolars ä»å¤„äºæ—©æœŸé˜¶æ®µï¼ï¼‰

# æœºå™¨å­¦ä¹ ä¸­çš„é¢„æµ‹å»ºæ¨¡

æœ€åçš„éƒ¨åˆ†å°†ç®€è¦ä»‹ç»ï¼Œå› ä¸ºä¸å¹¸çš„æ˜¯ï¼Œè¿™æ˜¯ Polars æœ€ç»ˆå¯¹æˆ‘æ¥è¯´è¡¨ç°ä¸ä½³çš„åœ°æ–¹ï¼Œè‡³å°‘åœ¨å‘å¸ƒè¿™ç¯‡æ–‡ç« çš„æ—¶å€™æ˜¯è¿™æ ·ã€‚ç±»ä¼¼äºæˆ‘åœ¨ä¹‹å‰çš„ Titanic é¡¹ç›®ä¸­ä¸ºç‰¹å¾å·¥ç¨‹åˆ›å»º Jupyter ç¬”è®°æœ¬çš„æ–¹å¼ï¼Œæˆ‘å°†å°è¯•æ¨¡æ‹Ÿåœ¨[æˆ‘åŸæ¥çš„ Titanic é¢„æµ‹å»ºæ¨¡ç¬”è®°æœ¬](https://github.com/dkhundley/titanic-byoc/blob/main/notebooks/predictive-modeling.ipynb)ä¸­å®Œæˆçš„ç›¸åŒæ­¥éª¤ã€‚

## æ‰§è¡Œè®­ç»ƒ-æµ‹è¯•æ‹†åˆ†

ä»»ä½•è‰¯å¥½çš„æœºå™¨å­¦ä¹ å®è·µçš„æ ‡å¿—ï¼Œä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•è¿›è¡Œè®­ç»ƒ-æµ‹è¯•ï¼ˆæˆ–è®­ç»ƒ-éªŒè¯ï¼‰æ‹†åˆ†ï¼Œä»¥ä¿ç•™æ•°æ®é›†ç”¨äºåç»­æ¨¡å‹éªŒè¯ã€‚ç”±äºæˆ‘ä»¬å°†ä½¿ç”¨ Scikit-Learn çš„`train_test_split`å‡½æ•°ï¼Œè¿™é‡Œæ²¡æœ‰å¤ªå¤šéœ€è¦æ³¨æ„çš„ï¼Œå› ä¸º Pandas å’Œ Polars DataFrames çš„è¯­æ³•å®Œå…¨ç›¸åŒã€‚æˆ‘åªæ˜¯æƒ³å¼ºè°ƒï¼Œä»Šå¤©è¿™åœ¨ Polars ä¸­å¼€ç®±å³ç”¨ï¼Œæ— éœ€ä»»ä½•ç‰¹æ®Šçš„è§£å†³æ–¹æ³•ã€‚ ğŸ˜ƒ

```py
# Importing Scikit-Learn's train_test_split function
from sklearn.model_selection import train_test_split

# Performing a train-validation split on the Pandas data
X_train_pandas, X_val_pandas, y_train_pandas, y_val_pandas = train_test_split(X_pandas, y_pandas, test_size = 0.2, random_state = 42)

# Performing a train-validation split on the Polars data
X_train_polars, X_val_polars, y_train_polars, y_val_polars = train_test_split(X_polars, y_polars, test_size = 0.2, random_state = 42)
```

## æ‰§è¡Œé¢„æµ‹å»ºæ¨¡

æˆ‘ä»¬ç»ˆäºæ¥åˆ°äº† Polars ä¸å¹¸å‡ºé”™çš„åœ°æ–¹ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘æ¼”ç¤ºäº†å¦‚ä½•å°† Pandas DataFrames é€‚é…åˆ° Scikit-Learn çš„éšæœºæ£®æ—åˆ†ç±»å™¨ï¼Œè¿™åº”è¯¥ä¼šåœ¨é‚£ä¸ªæ¼‚äº®çš„è“è‰²æ¡†ä¸­äº§ç”Ÿè¾“å‡ºã€‚

```py
# Instantiating a Random Forest Classifier object for the Pandas DataFrame
rfc_model_pandas = RandomForestClassifier(n_estimators = 50,
                                          max_depth = 20,
                                          min_samples_split = 10,
                                          min_samples_leaf = 2)

# Fitting the Pandas DataFrame to the Random Forest Classifier algorithm
rfc_model_pandas.fit(X_train_pandas, y_train_pandas.values.ravel())
```

![](img/cf94b6c20626534769b49c6d1e7848ce.png)

ä½œè€…æ•è·çš„æˆªå›¾

ä¸å¹¸çš„æ˜¯ï¼Œå½“å°è¯•ç”¨ Polars DataFrame åšåŒæ ·çš„äº‹æƒ…æ—¶ï¼Œæˆ‘é‡åˆ°äº†ç“¶é¢ˆã€‚å½“æˆ‘å°è¯•è¿è¡Œä¸‹é¢çš„ä»£ç å—æ—¶ï¼Œæˆ‘æ”¶åˆ°äº†ä¸‹å›¾ä¸­çš„é”™è¯¯ã€‚

```py
# Instantiating a Random Forest Classifier object for the Polars DataFrame
rfc_model_polars = RandomForestClassifier(n_estimators = 50,
                                          max_depth = 20,
                                          min_samples_split = 10,
                                          min_samples_leaf = 2)

# Fitting the Polars DataFrame to the Random Forest Classifier algorithm
rfc_model_polars.fit(X_train_polars, y_train_polars.values.ravel())
```

![](img/564dc0c090ee1d6eb0a650bdcad85558.png)

ä½œè€…æ•è·çš„æˆªå›¾

æˆ‘èŠ±äº†ä¸€ä¸ªå°æ—¶ä»”ç»†æ£€æŸ¥ Scikit-Learn çš„æºä»£ç ï¼Œä»¥äº†è§£è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†ä»ç„¶ä¸å¤ªç¡®å®šä¸ºä»€ä¹ˆå®ƒæ— æ³•åƒ Pandas DataFrames ä¸€æ ·ä¸€è‡´åœ°è¯»å– Polars DataFrame çš„å½¢çŠ¶ã€‚å½“è¿è¡Œåƒ `df_polars.shape` è¿™æ ·çš„å‘½ä»¤æ—¶ï¼Œå®ƒå§‹ç»ˆæ˜¾ç¤ºä¸ç›¸å…³ Pandas å‘½ä»¤ç›¸åŒçš„è¾“å‡ºã€‚è¿™ç¡®å®è®©äººå›°æƒ‘ã€‚

ç°åœ¨é€æ˜åœ°è¯´ï¼ŒScikit-Learn æ˜¯æˆ‘ä¸ºæ­¤å®éªŒå°è¯•çš„å”¯ä¸€ç®—æ³•åº“ã€‚ä½ å¯èƒ½ä¼šåœ¨å…¶ä»–ç®—æ³•åº“å¦‚ XGBoost æˆ– LightGBM ä¸­é‡åˆ°ä¸åŒçš„ç»“æœï¼Œä½†è€å®è¯´ï¼Œæˆ‘å€¾å‘äºç›¸ä¿¡å¤§å¤šæ•° â€” å¦‚æœä¸æ˜¯å…¨éƒ¨çš„è¯ â€” éƒ½ä¼šæœ‰ä¸ Scikit-Learn ç›¸åŒçš„é—®é¢˜ã€‚ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¦ç‡çš„å¤©çœŸå‡è®¾ï¼Œæ‰€ä»¥è¯·æ£€æŸ¥æˆ‘çš„å·¥ä½œï¼ğŸ˜‚ï¼‰

# ç»“è®º

ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘å¯¹ Polars çš„è¡¨ç°éå¸¸æ»¡æ„ã€‚æˆ‘ä»¬ consistently çœ‹åˆ° Polars çš„æ€§èƒ½æ›´å¿«ï¼Œè™½ç„¶è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„ç”¨ä¾‹ï¼Œä½†æˆ‘å¯ä»¥æƒ³è±¡è¿™äº›æ€§èƒ½æå‡åœ¨å¤§è§„æ¨¡åº”ç”¨æ—¶ä¼šæ˜¾è‘—æ„Ÿå—åˆ°ã€‚æˆ‘ä¹Ÿéå¸¸å–œæ¬¢å…¶ä»–åŠŸèƒ½ï¼Œæ¯”å¦‚ä½¿ç”¨ `head()` å‡½æ•°æ—¶æ˜¾ç¤ºæ¯ä¸ªç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚åƒè¿™æ ·çš„ç»†èŠ‚æ¯”é¢„æœŸçš„æ›´å—æˆ‘ä»¬è¿™äº›äººå–œæ¬¢ã€‚

ä¸å¹¸çš„æ˜¯ï¼ŒåŸºäºç›®å‰çš„çŠ¶æ€ï¼Œæˆ‘æ— æ³•æ¨è Polars ç”¨äºâ€œé»„é‡‘æ—¶é—´â€çš„æœºå™¨å­¦ä¹ ç”Ÿäº§åœºæ™¯ã€‚ï¼ˆæé†’ï¼šæˆªè‡³æœ¬å‡ºç‰ˆæ—¶ï¼Œæœ€æ–°ç‰ˆæœ¬ä¸º 0.16.10ï¼‰ã€‚æˆ‘å‘ç°çš„ `cut()` å‡½æ•°é—®é¢˜ä»¥åŠæ— æ³•ä¸ Category Encoders æˆ– Scikit-Learn çš„éšæœºæ£®æ—åˆ†ç±»å™¨é›†æˆå¯¹æˆ‘æ¥è¯´éƒ½æ˜¯æ— æ³•æ¥å—çš„ã€‚æˆ‘æƒ³è¿™ç§éšœç¢åœ¨ç°åœ¨ä¹ æƒ¯ä½¿ç”¨ Pandas çš„è®¸å¤šå…¶ä»–åº“ä¸­ä¹Ÿå­˜åœ¨ã€‚

å¦‚æœæˆ‘æ˜¯ä¸€åçº¯ç²¹çš„æ•°æ®åˆ†æå¸ˆï¼Œè€Œä¸æ˜¯è¿›è¡Œæœºå™¨å­¦ä¹ ï¼Œæˆ–è®¸ Polars å¯ä»¥åœ¨é‚£ä¸ªç‰¹å®šçš„ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚ç›®å‰ï¼ŒPolars é‡åˆ°çš„æœ€å¤§éº»çƒ¦ä¼¼ä¹æ˜¯åœ¨å°è¯•ä¸å…¶ä»–åº“é›†æˆæ—¶ã€‚ï¼ˆè¿™å½“ç„¶ä¸æ˜¯ Polars çš„é”™ï¼ï¼‰æˆ‘èƒ½ç†è§£æ•°æ®åˆ†æå¸ˆå¯èƒ½åªä½¿ç”¨ Polars è€Œæ²¡æœ‰å…¶ä»–åº“ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·å°å¿ƒä½¿ç”¨ã€‚ï¼ˆå°å¿ƒä¸è¦è¢« `cut()` é™·é˜±å›°ä½ï¼ğŸ˜‚ï¼‰

åˆ°å¤´æ¥ï¼Œæˆ‘åªæ˜¯éå¸¸æ„Ÿæ¿€é‚£äº›ä¼˜ç§€çš„äººä»¬è‡´åŠ›äºè®©å·²ç»å¾ˆå¥½çš„ä¸œè¥¿å˜å¾—æ›´å¥½ã€‚å½“ Numpy å’Œ Pandas æœ€åˆæ¨å‡ºæ—¶ï¼Œç›¸æ¯”äºæ™®é€šçš„ Pythonï¼Œå…¶æ€§èƒ½æå‡æ˜¯ä»¤äººæƒŠå¹çš„ï¼Œç”šè‡³è®©äººè§‰å¾—å†ä¹Ÿæ— æ³•æ›´å¥½ã€‚ç„¶è€Œï¼ŒPolars çš„å‡ºç°å‘æˆ‘ä»¬å±•ç¤ºäº†æˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ã€‚è¿™çœŸæ˜¯å¤ªæ£’äº†ã€‚æ„Ÿè°¢ Polars å›¢é˜Ÿçš„è¾›å‹¤å·¥ä½œï¼Œæˆ‘æœŸå¾…ç€çœ‹åˆ° Polars çš„å‘å±•ï¼ğŸ»â€â„ï¸

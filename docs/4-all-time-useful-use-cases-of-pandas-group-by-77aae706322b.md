# 4 ä¸ªå†æ¥æœ€æœ‰ç”¨çš„ pandas groupby æŠ€å·§

> åŸæ–‡ï¼š[`towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b`](https://towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b)

## æ•°æ®ç§‘å­¦

## ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼šè§£ç­”ä½ å…³äºä½¿ç”¨ pandas groupby è¿›è¡Œæ•°æ®æ±‡æ€»çš„æ‰€æœ‰é—®é¢˜

[](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)![Suraj Gurav](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------) [Suraj Gurav](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)

Â·å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------) Â·é˜…è¯»æ—¶é—´ 8 åˆ†é’ŸÂ·2023 å¹´ 3 æœˆ 24 æ—¥

--

![](img/6cb476af3f438709882dc9b91ed40ea2.png)

å›¾ç‰‡ç”± [Hands off my tags! Michael Gaida](https://pixabay.com/users/652234-652234/?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182) æä¾›ï¼Œæ¥è‡ª [Pixabay](https://pixabay.com//?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182)

åœ¨ Python ä¸­ï¼Œpandas æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ•°æ®åˆ†æåº“ã€‚å‡­å€Ÿå…¶ä¼—å¤šå†…ç½®å‡½æ•°å’Œæ–¹æ³•ï¼Œå®ƒä½¿æ•°æ®åˆ†æå˜å¾—æ›´å¿«ã€æ›´ç®€å•ã€‚

æ•°æ®åˆ†æä¸­æœ€é‡è¦çš„æ–¹é¢ä¹‹ä¸€æ˜¯æ•°æ®æ±‡æ€»ï¼Œå®ƒå¸®åŠ©ä½ æŒ‰ä¸€ä¸ªå˜é‡å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å°†å…¶ä½™çš„æ•°å€¼æ•°æ®æ±‡æ€»ä»¥è·å–æ‘˜è¦ç»Ÿè®¡ä¿¡æ¯ã€‚æœ€ç»ˆï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ‘˜è¦ç»Ÿè®¡ä¿¡æ¯æ¥å›ç­”ä¸šåŠ¡é—®é¢˜ã€‚

è¿™å°±æ˜¯ pandas å‡½æ•° `**groupby()**` çš„ç”¨é€”ï¼Œå®ƒæ ¹æ®åˆ†ç±»æˆ–éæ•°å€¼åˆ—çš„å€¼å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¸®åŠ©ä½ æŒ‰è¿™äº›æ–°å½¢æˆçš„ç»„åˆ†ææ•°æ®ã€‚

åœ¨æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­ â€” **ä½ åº”è¯¥çŸ¥é“çš„ 5 ä¸ª pandas groupby æŠ€å·§**â€” ä½ å¯ä»¥äº†è§£ä»€ä¹ˆæ˜¯ `groupby` ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡Š 4 ä¸ªéå¸¸æœ‰ç”¨ä¸”å¸¸è¢«æœç´¢çš„ pandas `groupby` æŠ€å·§ï¼Œå¹¶é™„æœ‰ç¤ºä¾‹ï¼Œè¿™æ˜¯ä½ è¿›è¡Œæ•°æ®åˆ†ææ—¶å¿…é¡»äº†è§£çš„ã€‚

æœ¬æ–‡æœ«å°¾æˆ‘è¿˜é™„ä¸Šäº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç¤ºä¾‹çš„å®Œæ•´ Jupyter Notebookã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† [UC Irvine Machine Learning Repository](https://archive-beta.ics.uci.edu/) ä¸Šæœ€å—æ¬¢è¿çš„æ•°æ®é›† â€” [**Iris**](https://archive-beta.ics.uci.edu/dataset/53/iris) â€” è¯¥æ•°æ®é›†ç”± R.A. Fisher åˆ›å»ºï¼Œå¹¶åœ¨ [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/legalcode) è®¸å¯è¯ä¸‹æä¾›ã€‚

è®©æˆ‘ä»¬å°†æ•°æ®é›†å¯¼å…¥ pandas DataFrame â€” `**df**`

```py
import pandas as pd
df = pd.read_csv("iris.data",
                 header=None,
                 names=["sepal_length", "sepal_width",
                        "petal_length","petal_width","class"])
df.head()
```

![](img/79e8cd00ebbadae913c4c7509e98407c.png)

Iris æ•°æ®é›† | ä½œè€…å›¾ç‰‡

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ 150 x 5 æ•°æ®é›†ï¼ŒåŒ…å« 3 ç§ Iris æ¤ç‰©çš„ç›¸å…³ä¿¡æ¯ã€‚

æˆ‘ä»¬å…ˆä»ç¬¬ä¸€ä¸ªç”¨ä¾‹å¼€å§‹ï¼Œå‡è®¾ä½ å·²ç»æ¢ç´¢äº†***å¦‚ä½•ä½¿ç”¨*** `***groupby***`ï¼Œå¦‚ä¸Šæ–‡æ‰€è¿°ã€‚

# å¯¹ä¸åŒåˆ—åº”ç”¨ä¸åŒå‡½æ•°

åœ¨ Pandas `groupby` ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡åˆ†ç±»/éæ•°å€¼åˆ—å¯¹æ•°æ®é›†ä¸­çš„æ‰€æœ‰è¡Œè¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¯¹å…¶ä»–æ‰€éœ€çš„æ•°å€¼åˆ—åº”ç”¨å‡½æ•°ä»¥è¿›è¡Œèšåˆã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³è·å–æ¯ä¸ª Iris æ¤ç‰©ç±»åˆ«çš„èŠ±è¼é•¿åº¦ã€‚ä½ å¯ä»¥ç®€å•åœ°åœ¨`groupby`ä¸­ä¼ é€’åˆ—*class*ï¼Œå¹¶å¯¹åˆ—*sepal_length*ä½¿ç”¨`sum()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby('class')['sepal_length'].sum()
```

![](img/2471355f94eb96b80b0c29106416f90b.png)

ç®€å•çš„ pandas groupby | ä½œè€…å›¾ç‰‡

è¿™éå¸¸ç®€å•ã€‚

> ä½†æ˜¯å¦‚æœä½ æƒ³è·å–æ¯ä¸ªç±»åˆ«çš„æ€»èŠ±è¼é•¿åº¦å’Œå¹³å‡èŠ±è¼å®½åº¦å‘¢ï¼Ÿ

è¿™æ—¶ï¼Œ`**agg()**`å‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå®ƒç”¨äºå¯¹é€šè¿‡ä½¿ç”¨`pandas.DataFrame.groupby`è·å¾—çš„ pandas DataFrame `groupby` å¯¹è±¡åº”ç”¨èšåˆå‡½æ•°ã€‚

å½“ç„¶ï¼Œä½ ä¸éœ€è¦å¤šæ¬¡ä½¿ç”¨`groupby()`ï¼Œè€Œæ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ groupby å¯¹è±¡ï¼Œå°†åˆ—åŠå…¶èšåˆå‡½æ•°ä½œä¸ºé”®å€¼å¯¹ä¼ é€’ç»™`agg()`å‡½æ•°ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç°ã€‚

åœ¨è¿™é‡Œï¼Œä½ æƒ³å¯¹å…¶åº”ç”¨èšåˆå‡½æ•°çš„ä¸¤åˆ—æ˜¯ â€” *sepal_length* å’Œ *sepal_width* â€” å®é™…ä¸Šä½ è¦å¯¹è¿™äº›åˆ—åº”ç”¨çš„èšåˆå‡½æ•°æ˜¯ `sum` å’Œ `mean`

å› æ­¤ï¼Œé”®å€¼å¯¹ï¼Œå³å­—å…¸ï¼Œå°†å¦‚ä¸‹æ‰€ç¤º

```py
dict1 = {'sepal_length':'sum', 'sepal_width':'mean'}
```

è€Œ `groupby` å¯¹è±¡å°†è¢«åˆ›å»ºä¸ºï¼š

```py
groupby_object = df.groupby(["class"])
```

ç„¶åä½ å¯ä»¥å¯¹è¿™ä¸ª groupby å¯¹è±¡åº”ç”¨`agg()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

```py
groupby_object.agg(dict1)
```

ä»¥ä»¥ä¸‹è¾“å‡ºä¸ºä¾‹ â€”

![](img/ef725afff98ed58ce4cf568d5a87a8b4.png)

å¯¹ä¸åŒåˆ—åº”ç”¨å¤šä¸ªå‡½æ•° | ä½œè€…å›¾ç‰‡

å¥½å§ï¼Œä½ ä¸éœ€è¦å°†ä»£ç æ‹†åˆ†æˆ 3 è¡Œï¼Œæˆ‘è¿™æ ·åšåªæ˜¯ä¸ºäº†ç®€åŒ–é—®é¢˜ã€‚

é€šè¿‡å°†æ‰€æœ‰å†…å®¹åˆå¹¶åˆ°ä»¥ä¸‹å•è¡Œä»£ç ä¸­ï¼Œä½ å°†å¾—åˆ°å®Œå…¨ç›¸åŒçš„è¾“å‡ºã€‚

```py
df.groupby(["class"]).agg({'sepal_length':'sum', 'sepal_width':'mean'})
```

æ‰©å±•ç›¸åŒçš„é€»è¾‘ï¼Œä½ å¯ä»¥åœ¨åŒä¸€åˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•°ï¼Œä½†æ–¹å¼ç•¥æœ‰ä¸åŒã€‚

# å¯¹åŒä¸€åˆ—åº”ç”¨å¤šä¸ªå‡½æ•°

é€šå¸¸ï¼Œä½ éœ€è¦ä¸ºåŒä¸€åˆ—åœ¨ç±»åˆ«é—´æ‰¾åˆ°å¤šä¸ªç»Ÿè®¡æ•°æ®ï¼Œä¾‹å¦‚è®¡ç®—æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥å°†**å‡½æ•°åˆ—è¡¨**ä¼ é€’ç»™`agg()`æ–¹æ³•ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³è·å–æ¯ä¸ª Iris æ¤ç‰©ç±»åˆ«çš„èŠ±è¼é•¿åº¦çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œä¸­ä½æ•°ã€‚

ä½ è¦å¯¹è¿™åˆ—åº”ç”¨çš„å®é™…èšåˆå‡½æ•°æ˜¯ `min`ã€`max` å’Œ `median`ï¼Œè¿™äº›å¿…é¡»ä½œä¸ºåˆ—è¡¨ä¼ é€’ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby('class')['sepal_length'].agg(['min', 'max', 'median'])
```

![](img/1436e641416c4fa702cb84eb6c3e4fe6.png)

åœ¨åŒä¸€åˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…

æŒ‰ç…§ç›¸åŒçš„æ–¹æ³•ï¼Œä½ å¯ä»¥åŒæ—¶åœ¨å¤šä¸ªåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•°ã€‚

ä¾‹å¦‚ï¼Œé™¤äº†ä¸Šè¿°è®¡ç®—ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥è·å¾— sepal width çš„ç›¸åŒåº¦é‡ã€‚

ç”±äºè¿™æ˜¯ä¸€ä¸ªå¤šåˆ—åœºæ™¯ï¼Œä½ åº”è¯¥åƒåœ¨å‰ä¸€ä¸ªæ–¹æ³•ä¸­é‚£æ ·åˆ‡æ¢å›**åˆ—åå’Œå‡½æ•°åçš„é”®å€¼å¯¹**ã€‚ç„¶è€Œï¼Œè¿™æ¬¡ä½ å°†ä¼ é€’å‡½æ•°åçš„åˆ—è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby(["class"]).agg({'sepal_length':['min', 'max', 'median'],
                           'sepal_width':['min', 'max', 'median']})
```

![](img/209525957ca952409784147a152b788b.png)

åœ¨å¤šåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…

å› æ­¤ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªæ˜“äºç†è§£çš„ DataFrameã€‚

ç„¶è€Œï¼Œå®ƒä»ç„¶æœ‰ä¸¤è¡Œä½œä¸ºåˆ—æ ‡é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡ç®€å•åœ°é‡å‘½åèšåˆåˆ—æ¥å»æ‰å®ƒä»¬ã€‚

# è‡ªå®šä¹‰èšåˆåˆ—åç§°

ä½ å¯ä»¥ä¸ºåˆ—èšåˆä½¿ç”¨ä½ é€‰æ‹©çš„åç§°ï¼Œä»¥ä¾¿è½»æ¾è¯†åˆ«è¿”å›çš„åˆ—èšåˆï¼Œå¹¶å»æ‰åˆ—æ ‡é¢˜ä¸­çš„ç¬¬äºŒè¡Œã€‚

ä½ éœ€è¦åšçš„å°±æ˜¯åˆ›å»º**åˆ—åå’Œèšåˆå‡½æ•°çš„å…ƒç»„**ï¼Œå¹¶å°†è¿™ä¸ªå…ƒç»„åˆ†é…ç»™åˆ—åã€‚

ç»§ç»­ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ å¸Œæœ›åœ¨åˆ— *sepal_length* ä¸Šåº”ç”¨å‡½æ•° `â€˜minâ€™`ï¼Œå› æ­¤å…ƒç»„å°†æ˜¯ `(â€˜sepal_lengthâ€™, â€˜minâ€™)`ï¼Œä½ å°†æŠŠè¿™ä¸ªå…ƒç»„åˆ†é…ç»™åä¸º *min_sepal_length* çš„åˆ—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
min_sepal_length = ('sepal_length','min')
```

åŒæ ·ï¼Œä½ å¯ä»¥ä¸ºæ‰€æœ‰åˆ—èšåˆåˆ›å»ºå…ƒç»„ï¼Œå¹¶å°†å®ƒä»¬åˆ†é…ç»™è‡ªå®šä¹‰åç§°ã€‚

```py
min_sepal_length = ('sepal_length','min')
max_sepal_length = ('sepal_length','max')
median_sepal_length = ('sepal_length','median')

min_sepal_width = ('sepal_width','min')
max_sepal_width = ('sepal_width','max')
median_sepal_width = ('sepal_width','median')
```

æœ€åï¼Œå°†å®ƒä»¬ç”¨é€—å·åˆ†éš”ä¼ é€’ç»™ `agg()` å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby(["class"]).agg(min_sepal_length = ('sepal_length','min'),
                          max_sepal_length = ('sepal_length','max'),
                          median_sepal_length = ('sepal_length','median'),
                          min_sepal_width = ('sepal_width','min'),
                          max_sepal_width = ('sepal_width','max'),
                          median_sepal_width = ('sepal_width','median'))
```

![](img/6101aa4b62c7f84beae6c7b9559e61df.png)

åœ¨ Pandas èšåˆå‡½æ•°ä¸­å‘½åè¿”å›çš„åˆ— | å›¾ç‰‡æ¥æºï¼šä½œè€…

å¿«é€Ÿè§£å†³ï¼

ç°åœ¨ï¼Œè¿™çœ‹èµ·æ¥ç®€åŒ–äº†å¾ˆå¤šï¼Œæ˜“äºé˜…è¯»ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ ä»…åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ä¸Šåº”ç”¨äº†æ ‡å‡†æˆ–å†…ç½®å‡½æ•°ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ä½ éœ€è¦åº”ç”¨ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œä½¿ç”¨èšåˆå‡½æ•°ä½ å¯ä»¥è½»æ¾åšåˆ°è¿™ä¸€ç‚¹ã€‚

# åº”ç”¨è‡ªå®šä¹‰æˆ–ç”¨æˆ·å®šä¹‰çš„å‡½æ•°

é€šå¸¸ï¼Œpandas ä¸­å†…ç½®çš„èšåˆå‡½æ•°ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ éœ€è¦ä¸ºåˆ†æå®šä¹‰è‡ªå·±çš„è‡ªå®šä¹‰å‡½æ•°ã€‚

ç°åœ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ `agg` æ–¹æ³•å°†è¿™äº›ç”¨æˆ·å®šä¹‰æˆ–è‡ªå®šä¹‰å‡½æ•°åº”ç”¨äºåˆ†ç»„æ•°æ®ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°æ¥è®¡ç®—åˆ—çš„èŒƒå›´ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
def my_range(x):
    return x.max() - x.min()
```

ç°åœ¨ä½ å¸Œæœ›è®¡ç®—é¸¢å°¾èŠ±çš„ sepal lengthã€sepal widthã€petal length å’Œ petal width çš„èŒƒå›´ï¼Œå¹¶æŒ‰å…¶ç±»åˆ«è¿›è¡ŒåŒºåˆ†ã€‚

å†æ¬¡è¿™æ˜¯å¤šåˆ—åœºæ™¯ï¼Œå› æ­¤ä½ å¿…é¡»ä½¿ç”¨**é”®å€¼å¯¹**ï¼Œå…¶ä¸­**é”®æ˜¯åˆ—å**ï¼Œ**å€¼æ˜¯ç”¨æˆ·å®šä¹‰å‡½æ•°çš„åç§°**ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby(["class"]).agg({'sepal_length':my_range,
                           'sepal_width':my_range,
                           'petal_length':my_range,
                           'petal_width':my_range})
```

è¿™å°†å¿«é€Ÿç»™å‡ºå¦‚ä¸‹è¾“å‡º â€”

![](img/5750d9dee5d36f4b104128ea6a99120a.png)

åœ¨å¤šåˆ—ä¸Šåº”ç”¨ç”¨æˆ·å®šä¹‰çš„å‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…

ç„¶è€Œï¼Œå¯¹äºä¸Šè¿° DataFrame çš„æŸ¥çœ‹è€…æ¥è¯´ï¼Œç†è§£è¿™äº›æ•°å­—ä½¿ç”¨äº†å“ªç§èšåˆå‡½æ•°å°†ä¼šæ¯”è¾ƒå›°éš¾ã€‚

å› æ­¤ï¼Œæ·»åŠ æ›´å¤šä¸Šä¸‹æ–‡æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ æ¯åˆ—çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ¥å®ç°ã€‚

æœ‰è¶£çš„æ˜¯ï¼Œä½ è¿˜å¯ä»¥å°†è‡ªå®šä¹‰å‡½æ•°ä¸å†…ç½®å‡½æ•°ç»“åˆä½¿ç”¨ï¼Œå¹¶å°†å®ƒä»¬åº”ç”¨äº`agg()`å‡½æ•°ä¸­çš„å¤šä¸ªåˆ—ã€‚

è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚

å‡è®¾ä½ æƒ³è®¡ç®—æ•°æ®é›†ä¸­æ‰€æœ‰æ•°å€¼åˆ—çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œè‡ªå®šä¹‰å‡½æ•°ã€‚

ç°åœ¨è¿™æ˜¯**å¤šåˆ—â€”â€”å¤šå‡½æ•°**çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€ä½ ä»ç„¶ä¼šä½¿ç”¨é”®å€¼å¯¹ï¼Œä½†å°†å‡½æ•°åˆ—è¡¨ä½œä¸ºå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```py
df.groupby(["class"]).agg({'sepal_length':['min', 'max', my_range],
                           'sepal_width':['min', 'max', my_range],
                           'petal_length':['min', 'max', my_range],
                           'petal_width':['min', 'max', my_range]})
```

ä»¥å¿«é€Ÿè¾“å‡ºä¸ºä¾‹ â€”

![](img/52aa6edd63f961511e83f4b3760b8c89.png)

åœ¨å¤šä¸ªåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | ä½œè€…æä¾›çš„å›¾ç‰‡

æœ‰è¶£ï¼Œå¯¹å§ï¼Ÿ

ä½†ä»ç„¶å¾ˆéš¾è¯´`my_range`å‡½æ•°çš„å†…å®¹ä»¥åŠåœ¨è¯¥å‡½æ•°ä¸­å‘ç”Ÿäº†ä»€ä¹ˆè®¡ç®—ã€‚

ç»™è¿™ä¸ªå‡½æ•°ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°ï¼Œç„¶åå†æ¬¡ä½¿ç”¨è¯¥å‡½æ•°è¿›è¡Œèšåˆæ›´ä¸ºåˆç†ã€‚

ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç è½»æ¾ä¸ºå‡½æ•°æŒ‡å®šåç§°ã€‚

```py
my_range.__name__ = 'Max - Min'
```

ç„¶ååœ¨æ‰€æœ‰éœ€è¦çš„åˆ—ä¸Šé‡æ–°åº”ç”¨`my_range`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

```py
df.groupby(["class"]).agg({'sepal_length':['min', 'max', my_range],
                           'sepal_width':['min', 'max', my_range],
                           'petal_length':['min', 'max', my_range],
                           'petal_width':['min', 'max', my_range]})
```

![](img/465cc4daff2866fa3bd47bff2fcdea45.png)

pandas groupby agg è‡ªå®šä¹‰å‡½æ•° å¤šåˆ— | ä½œè€…æä¾›çš„å›¾ç‰‡

ç°åœ¨ï¼Œè¿™ä¸ªè¾“å‡ºçœ‹èµ·æ¥æ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå‡†ç¡®åœ°å‘Šè¯‰ä½ å¯¹æ¯åˆ—è¿›è¡Œäº†ä»€ä¹ˆç±»å‹çš„è®¡ç®—ã€‚

è¿™å°±æ˜¯å…³äºä½¿ç”¨ pandas `groupby`çš„æ•°æ®èšåˆï¼ ğŸ†

æˆ‘å¸Œæœ›ä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸º pandas `.groupby()`ç”¨ä¾‹çš„**ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ**ã€‚

äº†è§£å…³äºä½¿ç”¨ pandas `.groupby()`çš„æ•°æ®èšåˆçš„è¿™äº›çµæ´»ç‰¹æ€§æ— ç–‘å¯ä»¥æå‡ä½ çš„ç”Ÿäº§åŠ›ã€‚å®ƒè¿˜å¸®åŠ©ä½ ä»¥æ›´å¥½å’Œæ˜“äºç†è§£çš„æ–¹å¼æ±‡æ€»å’Œè¡¨ç¤ºæ•°æ®ã€‚

> *å¯¹é˜…è¯»æ›´å¤š Medium ä¸Šçš„æ•…äº‹æ„Ÿå…´è¶£å—ï¼Ÿ*

ğŸ’¡ è€ƒè™‘ [**æˆä¸º Medium ä¼šå‘˜**](https://medium.com/@17.rsuraj/membership) ä»¥**æ— é™è®¿é—®**Medium ä¸Šçš„æ•…äº‹å’Œæ¯æ—¥æœ‰è¶£çš„ Medium æ‘˜è¦ã€‚æˆ‘å°†ä»ä½ çš„è´¹ç”¨ä¸­è·å¾—ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”ä½ æ— éœ€é¢å¤–ä»˜è´¹ã€‚

ğŸ’¡ ç¡®ä¿ [**æ³¨å†Œæˆ‘çš„é‚®ä»¶åˆ—è¡¨**](https://medium.com/subscribe/@17.rsuraj) ä»¥å…é”™è¿‡æœ‰å…³æ•°æ®ç§‘å­¦æŒ‡å—ã€æŠ€å·§å’Œçªé—¨ã€SQL å’Œ Python çš„å…¶ä»–æ–‡ç« ã€‚

ğŸ’¡ è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ [**Notebook**](https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/4_Use_cases_Pandas_Group_By.ipynb) åŒ…å«æ‰€æœ‰ç¤ºä¾‹ã€‚

**æ„Ÿè°¢é˜…è¯»ï¼**

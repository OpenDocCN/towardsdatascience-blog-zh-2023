- en: 'Simulation 105: Double Pendulum Modeling with Numerical Integration'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/simulation-105-double-pendulum-modeling-with-numerical-integration-53189ae63959?source=collection_archive---------5-----------------------#2023-08-14](https://towardsdatascience.com/simulation-105-double-pendulum-modeling-with-numerical-integration-53189ae63959?source=collection_archive---------5-----------------------#2023-08-14)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Modeling a chaotic system
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@ln8378?source=post_page-----53189ae63959--------------------------------)[![Le
    Nguyen](../Images/05289b40bb528d5ba2a0ee00d1a75990.png)](https://medium.com/@ln8378?source=post_page-----53189ae63959--------------------------------)[](https://towardsdatascience.com/?source=post_page-----53189ae63959--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----53189ae63959--------------------------------)
    [Le Nguyen](https://medium.com/@ln8378?source=post_page-----53189ae63959--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb34fcbf59198&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimulation-105-double-pendulum-modeling-with-numerical-integration-53189ae63959&user=Le+Nguyen&userId=b34fcbf59198&source=post_page-b34fcbf59198----53189ae63959---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----53189ae63959--------------------------------)
    ·9 min read·Aug 14, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F53189ae63959&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimulation-105-double-pendulum-modeling-with-numerical-integration-53189ae63959&user=Le+Nguyen&userId=b34fcbf59198&source=-----53189ae63959---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53189ae63959&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimulation-105-double-pendulum-modeling-with-numerical-integration-53189ae63959&source=-----53189ae63959---------------------bookmark_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: The pendulum is a classical physics system that we are all familiar with. Be
    it a grandfather clock or a child on a swing, we have seen the regular, periodic
    motion of the pendulum. A single pendulum is well defined in classical physics,
    but the double pendulum (a pendulum attached to the end of another pendulum) is
    [literal chaos](https://en.wikipedia.org/wiki/Chaos_theory). In this article,
    we are going to build on our intuitive understanding of pendulums and model the
    chaos of the double pendulum. The physics is interesting and the numerical methods
    needed are an essential tool in anyone’s arsenal.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d5fc100fbdb7588fd0524ba6653bf8e0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1: [Example of a chaotic double pendulum](https://commons.wikimedia.org/wiki/File:Double_pendulum_predicting_dynamics.gif)'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this article we will:'
  prefs: []
  type: TYPE_NORMAL
- en: Learn about harmonic motion and model the behavior of a single pendulum
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Learn the fundamentals of chaos theory
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Model the chaotic behavior of a double pendulum numerically
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Harmonic Motion and the Single Pendulum
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Simple Harmonic Motion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We describe the periodic oscillating movement of a pendulum as [harmonic motion](https://en.wikipedia.org/wiki/Simple_harmonic_motion).
    Harmonic motion occurs when there is movement in a system that is balanced out
    by a proportional restoring force in the opposite direction of said movement.
    We see an example of this in figure 2 where a mass on a spring is being pulled
    down due to gravity, but this puts energy into the spring which then recoils and
    pulls the mass back up. Next to the spring system, we see the height of the mass
    going around in a circle called a [phasor diagram](https://en.wikipedia.org/wiki/Phasor)
    which further illustrates the regular motion of the system.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c2bcaadc06cec4ffcd78e75d63ae954c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2: Example of [simple harmonic motion of a mass on a spring](https://mathimages.swarthmore.edu/index.php/File:SpringCircle2.gif)'
  prefs: []
  type: TYPE_NORMAL
- en: Harmonic motion can be damped (decreasing in amplitude due to drag forces) or
    driven (increasing in amplitude due to outside force being added), but we will
    start with the simplest case of indefinite harmonic motion with no outside forces
    acting on it (undamped motion). This is kind of motion is a good approximation
    for modeling a single pendulum that swings at a small angle/low amplitude. In
    this case we can model the motion with equation 1 below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/99380611fb900783b01c62a9c7221444.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Equation 1: Simple harmonic motion for a small angle pendulum'
  prefs: []
  type: TYPE_NORMAL
- en: We can easily put this function into code and simulate a simple pendulum over
    time.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/4319f9bdb1e1b926f305eee27e17190a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3: Simple pendulum simulation'
  prefs: []
  type: TYPE_NORMAL
- en: Full Pendulum Motion with Lagrangian Mechanics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A simple small angle pendulum is a good start, but we want to go beyond this
    and model the motion of a full pendulum. Since we can no longer use [small angle
    approximations](https://en.wikipedia.org/wiki/Small-angle_approximation) it is
    best to model the pendulum using [Lagrangian mechanics](https://en.wikipedia.org/wiki/Lagrangian_mechanics).
    This is an essential tool in physics that switches us from looking at the forces
    in a system to looking at the energy in a system. We are switching our frame of
    reference from driving force vs restoring force to [kinetic](https://en.wikipedia.org/wiki/Kinetic_energy)
    vs [potential](https://en.wikipedia.org/wiki/Potential_energy) energy.
  prefs: []
  type: TYPE_NORMAL
- en: The Lagrangain is the difference between kinetic and potential energy given
    in equation 2.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cd59b2b9c3212f5c308c9ac300e3e3d1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Equation 2: The Lagrangian'
  prefs: []
  type: TYPE_NORMAL
- en: Substituting in the Kinetic and Potential of a pendulum given in equation 3
    yields the Lagrangain for a pendulum seen is equation 4
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4626a9fa15c967eea4f06f6ae0a3f5e6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Equation 3: Kinetic and potential energy for a pendulum'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2575a56e48aca50c294f382c5d7891a1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Equation 4: Lagrangian for a pendulum'
  prefs: []
  type: TYPE_NORMAL
- en: With the Lagrangian for a pendulum we now describe the energy of our system.
    There is one last math step to go through to transform this into something that
    we can build a simulation on. We need to bridge back to the dynamic/force oriented
    reference from the energy reference using the [Euler-Lagrange equation](https://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation).
    Using this equation we can use the Lagrangian to get the angular acceleration
    of our pendulum.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c74ff56138a49800ed2bd957059188f4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Equation 5: Angular acceleration from the Euler-Lagrange equation'
  prefs: []
  type: TYPE_NORMAL
- en: After going through the math, we have angular acceleration which we can use
    to get angular velocity and angle itself. This will require some [numerical integration](https://en.wikipedia.org/wiki/Numerical_integration)
    that will be laid out in our full pendulum simulation. Even for a single pendulum,
    the [non-linear dynamics](https://en.wikipedia.org/wiki/Nonlinear_system) means
    there is no analytical solution for solving for *theta,* thus the need for a numerical
    solution. The integration is quite simple (but powerful), we use angular acceleration
    to update angular velocity and angular velocity to update *theta* by adding the
    former quantity to the latter and multiplying this by some time step. This gets
    us an approximation for the area under the acceleration/velocity curve. The smaller
    the time step, the more accurate the approximation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/df966baad829d1a82839980c7186c0b9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 4: Simulation of a full pendulum'
  prefs: []
  type: TYPE_NORMAL
- en: We have simulated a full pendulum, but this is still a well defined system.
    It is now time to step into the chaos of the double pendulum.
  prefs: []
  type: TYPE_NORMAL
- en: Chaos and the Double Pendulum
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Chaos](https://en.wikipedia.org/wiki/Chaos_theory), in the mathematical sense,
    refers to systems that are highly sensitive to their initial conditions. Even
    slight changes in the system’s start will lead to vastly different behaviors as
    the system evolves. This perfectly describes the motion of the double pendulum.
    Unlike the single pendulum, it is not a well behaved system and will evolve in
    a vastly different way with even slight changes in starting angle.'
  prefs: []
  type: TYPE_NORMAL
- en: To model the motion of the double pendulum, we will use the same Lagrangian
    approach as before ([see full derivation](https://mse.redwoods.edu/darnold/math55/DEproj/sp08/jaltic/presentation.pdf)).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/62c62acceea8661fa7a1d0cb4d673b80.png)'
  prefs: []
  type: TYPE_IMG
- en: We will also be using the same numerical integration scheme as before when implementing
    this equation into code and finding theta.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/08913f06219e3671259de47ec97ae3a3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5: Double pendulum simulation'
  prefs: []
  type: TYPE_NORMAL
- en: We’ve finally done it! We have successfully modeled a double pendulum, but now
    it’s time to observe some chaos. Our final simulation will be of two double pendulums
    with slightly different starting condition. We will set one pendulum to have a
    *theta 1* of 90 degrees and the other to have a *theta 1* of 91 degrees. Let’s
    see what happens.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aeb23d51e522d12e3787090afee94c7a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6: 2 Double pendulums with slightly different starting conditions'
  prefs: []
  type: TYPE_NORMAL
- en: We can see that both pendulums start off with similar trajectories but quickly
    diverge. This is what we mean when we say chaos, even a 1 degree difference in
    angle cascades into vastly different end behavior.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this article we learned about pendulum motion and how to model it. We started
    from the simplest harmonic motion model and built up to the complex and chaotic
    double pendulum. Along the way we learned about the Lagrangian, chaos, and numerical
    integration.
  prefs: []
  type: TYPE_NORMAL
- en: The double pendulum is the simplest example of a chaotic system. These systems
    exist everywhere in our world from [population dynamics](https://support.goldsim.com/hc/en-us/articles/115011378368-Chaotic-Behavior-in-Population-Dynamics),
    [climate](https://earth.stanford.edu/news/climate-chaos-why-warming-makes-weather-less-predictable),
    and even [billiards](https://plus.maths.org/content/chaos-billiard-table#:~:text=It%20turns%20out%20that%20the,explore%20all%20of%20the%20table.).
    We can take the lessons we have learned from the double pendulum and apply them
    whenever we encounter a chaotic systems.
  prefs: []
  type: TYPE_NORMAL
- en: Key Take Aways
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Chaotic systems are very sensitive to initial conditions and will evolve in
    vastly different ways with even slight changes to their start.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When dealing with a system, especially a chaotic system, is there another frame
    of reference to look at it that makes it easier to work with? (Like the force
    reference frame to the energy reference frame)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When systems get too complicated we need to implement numerical solutions to
    solve them. These solutions are simple but powerful and offer good approximations
    to the actual behavior.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: All figures used in this article were either created by the author or are from
    [Math Images](https://mathimages.swarthmore.edu/index.php/Main_Page) and full
    under the [GNU Free Documentation License 1.2](http://www.gnu.org/copyleft/fdl.html)
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.wired.com/2016/07/everything-harmonic-oscillator/?source=post_page-----53189ae63959--------------------------------)
    [## Everything-Yes, Everything-Is a Harmonic Oscillator'
  prefs: []
  type: TYPE_NORMAL
- en: Physics undergrads might joke that the universe is made of harmonic oscillators,
    but they're not far off.
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.wired.com](https://www.wired.com/2016/07/everything-harmonic-oscillator/?source=post_page-----53189ae63959--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Classical Mechanics, John Taylor [https://neuroself.files.wordpress.com/2020/09/taylor-2005-classical-mechanics.pdf](https://neuroself.files.wordpress.com/2020/09/taylor-2005-classical-mechanics.pdf)
  prefs: []
  type: TYPE_NORMAL
- en: Full Code
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Simple Pendulum
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Pendulum
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Double Pendulum
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE

- en: A Good Description Is All You Need
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/a-good-description-is-all-you-need-1d0b47be10ec?source=collection_archive---------12-----------------------#2023-08-10](https://towardsdatascience.com/a-good-description-is-all-you-need-1d0b47be10ec?source=collection_archive---------12-----------------------#2023-08-10)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How to use few shot learning to improve text classification performance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@ilia.teimouri?source=post_page-----1d0b47be10ec--------------------------------)[![Ilia
    Teimouri PhD](../Images/0eb948c4d3f81c116cd16fa4d5016629.png)](https://medium.com/@ilia.teimouri?source=post_page-----1d0b47be10ec--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1d0b47be10ec--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1d0b47be10ec--------------------------------)
    [Ilia Teimouri PhD](https://medium.com/@ilia.teimouri?source=post_page-----1d0b47be10ec--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf9b9036159&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-good-description-is-all-you-need-1d0b47be10ec&user=Ilia+Teimouri+PhD&userId=bf9b9036159&source=post_page-bf9b9036159----1d0b47be10ec---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1d0b47be10ec--------------------------------)
    ·7 min read·Aug 10, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d0b47be10ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-good-description-is-all-you-need-1d0b47be10ec&user=Ilia+Teimouri+PhD&userId=bf9b9036159&source=-----1d0b47be10ec---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d0b47be10ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-good-description-is-all-you-need-1d0b47be10ec&source=-----1d0b47be10ec---------------------bookmark_footer-----------)![](../Images/03be7b5832a9d134961e51b08dd7a5a7.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Photo by [Patrick Tomasso](https://unsplash.com/@impatrickt) on [Unsplash](https://unsplash.com/).
  prefs: []
  type: TYPE_NORMAL
- en: I have been using large language models (LLMs) for a while now, both for personal
    projects and as part of my day-to-day work. Like many people, I am excited by
    the powerful capabilities of these models. Yet it’s important to know that while
    these models are very strong, one can always improve them for various tasks.
  prefs: []
  type: TYPE_NORMAL
- en: And NO, I am not going to write about [fine-tuning LLMs](https://platform.openai.com/docs/guides/fine-tuning),
    which can be costly and often requires a good GPU-powered device. In fact, I’m
    going to show you a very simple method of improving your model using few-shot
    learning.
  prefs: []
  type: TYPE_NORMAL
- en: 'Few-shot learning is a machine learning technique where models are trained
    to solve new tasks using only a few examples, often just 1–5 examples per class.
    There are a number of key points to few-shot learning:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Learning to generalize from small data: Few-shot learning methods aim to learn
    models that can generalize well from a small number of examples, in contrast to
    traditional deep learning methods that require thousands or millions of examples.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Transfer learning: Few-shot learning methods leverage knowledge gained from
    solving previous tasks and transfer that knowledge to help learn new tasks faster
    and from less data. This transfer learning capability is key.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Learning similarity metrics: Some few-shot learning techniques focus on learning
    a similarity metric between examples. This allows comparing new examples to existing
    labeled examples to make predictions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: But how can one use few-shot learning in a classification problem to improve
    model performance? Let’s walk through an example.
  prefs: []
  type: TYPE_NORMAL
- en: Data and Prep
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have started my analysis by obtaining data from HuggingFace. The dataset is
    called [financial-reports-sec](https://huggingface.co/datasets/JanosAudran/financial-reports-sec)
    (This dataset has Apache License 2.0 and permits for commercial use), and according
    to the dataset authors, it contains the annual reports of U.S. public companies
    filing with the SEC [EDGAR system](https://www.sec.gov/edgar/sec-api-documentation)
    from 1993–2020\. Each annual report (10-K filing) is divided into 20 sections.
  prefs: []
  type: TYPE_NORMAL
- en: 'Two relevant attributes of this data are useful for the current task:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Sentence**: Excerpts from the 10-K filing reports'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Section**: Labels denoting the section of the 10-K filing that the sentence
    belongs to'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'I have focused on three sections:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Business (Item 1): Describes the company’s business, including subsidiaries,
    markets, recent events, competition, regulations, and labor. Denoted by 0 in the
    data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Risk Factors (Item 1A): Discusses risks that could impact the company, such
    as external factors, potential failures, and other disclosures to warn investors.
    Denoted by 1.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Properties (Item 2): Details significant physical property assets. Does not
    include intellectual or intangible assets. Denoted by 3.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For each label, I sampled 10 examples without replacement. The data is structured
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7efd497ca2a4c2bd5f4fa465874d2a60.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Off the shelf** prediction'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once the data is ready, all I have to do is to make a classifier function that
    takes the sentence from the dataframe and predicts the label.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'I’m using GPT-4 here since it’s OpenAI’s most capable model so far. I’ve also
    set the temperature to 0 just to make sure the model does not go off track. The
    really fun part is how I define the Role — that’s where I get to guide the model
    on what I want it to do. The Role tells it to stay focused and deliver the kind
    of output I’m looking for. Defining a clear role for the model helps it generate
    relevant, high-quality responses. The prompt in this function is:'
  prefs: []
  type: TYPE_NORMAL
- en: You are expert in SEC 10-K forms.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: You will be presented by a text and you need to classify the text into either
    ‘Item 1’, ‘Item 1A’ or ‘Item 2’.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The text only belongs to one of the mentioned categories so only return one
    category.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: After applying the classification function across all data rows, I generated
    a classification report to evaluate model performance. The macro average F1 score
    was 0.62, indicating reasonably strong predictive capabilities for this multi-class
    problem. Since the number of examples was balanced across all 3 classes, the macro
    and weighted averages converged to the same value. This baseline score reflects
    the out-of-the-box accuracy of the pretrained model prior to any additional tuning
    or optimization.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Description is all you need (few-shot prediction)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As mentioned, few-shot learning is all about generalising the model with a
    few good examples. To that end, I’ve modified my class by describing what Item
    1, Item 1A and Item2 are ([based on Wikipedia](https://en.wikipedia.org/wiki/Form_10-K)):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The prompt now reads:'
  prefs: []
  type: TYPE_NORMAL
- en: You are expert in SEC 10-K forms.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: You will be presented by a text and you need to classify the text into either
    ‘Item 1’, ‘Item 1A’ or ‘Item 2’.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The text only belongs to one of the mentioned categories so only return one
    category.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**In your classification take the following definitions into account:**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Item 1 (i.e. Business) describes the business of the company: who and what
    the company does, what subsidiaries it owns, and what markets it operates in.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: It may also include recent events, competition, regulations, and labor issues.
    (Some industries are heavily regulated, have complex labor requirements, which
    have significant effects on the business.)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Other topics in this section may include special operating costs, seasonal factors,
    or insurance matters.**
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Item 1A (i.e. Risk Factors) is the section where the company lays anything
    that could go wrong, likely external effects, possible future failures to meet
    obligations, and other risks disclosed to adequately warn investors and potential
    investors.**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Item 2 (i.e. Properties) is the section that lays out the significant properties,
    physical assets, of the company. This only includes physical types of property,
    not intellectual or intangible property.**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'If we run this on the texts we get the following performance:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The macro average **F1 is now 0.80, that is 29%** improvement in our prediction,
    only by providing a good description of each class.
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally you can see the full dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ac490bda07bc6c8fd2c5bc560fd643b0.png)'
  prefs: []
  type: TYPE_IMG
- en: In fact the examples I provided gives the model concrete instances to learn
    from. Examples allow the model to infer patterns and features, by looking at multiple
    examples, the model can start to notice commonalities and differences that characterise
    the overall concept being learned. This helps the model form a more robust representation.
    Furthermore, providing examples essentially acts as a weak form of supervision,
    guiding the model towards the desired behaviour in lieu of large labeled datasets.
  prefs: []
  type: TYPE_NORMAL
- en: In the few-shot function, concrete examples help point the model to the types
    of information and patterns it should pay attention to. In summary, concrete examples
    are important for few-shot learning as they provide anchor points for the model
    to build an initial representation of a novel concept, which can then be refined
    over the few examples provided. The inductive learning from specific instances
    helps models develop nuanced representations of abstract concepts.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you’ve enjoyed reading this and want to keep in touch, you can find me on
    my [LinkedIn](https://www.linkedin.com/in/iliateimouri/) or via my webpage: [iliateimouri.com](https://www.iliateimouri.com)'
  prefs: []
  type: TYPE_NORMAL
- en: '*Note: All images, unless otherwise noted, are by the author.*'
  prefs: []
  type: TYPE_NORMAL

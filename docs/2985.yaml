- en: 'Energy Supply and Demand Optimisation: Mathematical Modelling Using Gurobi
    Python'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/energy-supply-and-demand-optimisation-mathematical-modelling-using-gurobi-python-8a8b1cb9559a?source=collection_archive---------6-----------------------#2023-09-29](https://towardsdatascience.com/energy-supply-and-demand-optimisation-mathematical-modelling-using-gurobi-python-8a8b1cb9559a?source=collection_archive---------6-----------------------#2023-09-29)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Efficient energy allocation through mathematical optimisation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@kongyouliow?source=post_page-----8a8b1cb9559a--------------------------------)[![Kong
    You Liow](../Images/47a8a8fc860df365882c3e82c9fb81d4.png)](https://medium.com/@kongyouliow?source=post_page-----8a8b1cb9559a--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8a8b1cb9559a--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8a8b1cb9559a--------------------------------)
    [Kong You Liow](https://medium.com/@kongyouliow?source=post_page-----8a8b1cb9559a--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·
  prefs: []
  type: TYPE_NORMAL
- en: '[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8a77c8a1ff64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-supply-and-demand-optimisation-mathematical-modelling-using-gurobi-python-8a8b1cb9559a&user=Kong+You+Liow&userId=8a77c8a1ff64&source=post_page-8a77c8a1ff64----8a8b1cb9559a---------------------post_header-----------)
    Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8a8b1cb9559a--------------------------------)
    ·11 min read·Sep 29, 2023[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8a8b1cb9559a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-supply-and-demand-optimisation-mathematical-modelling-using-gurobi-python-8a8b1cb9559a&user=Kong+You+Liow&userId=8a77c8a1ff64&source=-----8a8b1cb9559a---------------------clap_footer-----------)'
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8a8b1cb9559a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fenergy-supply-and-demand-optimisation-mathematical-modelling-using-gurobi-python-8a8b1cb9559a&source=-----8a8b1cb9559a---------------------bookmark_footer-----------)![](../Images/8575284610537ef9896c0a9a99a84b33.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Photo of power pylons at sunset. Source: image by [Matthew Henry](https://unsplash.com/@matthewhenry)
    from [Unsplash](https://unsplash.com/).'
  prefs: []
  type: TYPE_NORMAL
- en: We are currently in an era where the equilibrium between energy supply and demand
    has become particularly important. Traditional energy sources like oil and gas
    are facing difficult challenges like geopolitical factors such as the Russian-Ukrainian
    conflict, which has disrupted natural gas supplies, and the overall depletion
    of natural reserves.
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, there is also a growing demand for energy, particularly as
    more countries transition from developing to developed status. This economic growth
    signifies an increased need for energy to fuel production and industrial processes.
    The urgency of addressing climate change further emphasises the need for renewable
    energy sources. Combining all factors, this means that achieving a well-balanced
    energy supply and demand has only become increasingly crucial.
  prefs: []
  type: TYPE_NORMAL
- en: Mathematical optimisation is the study of selecting criteria to minimise or
    maximise a specific objective within predefined constraints, all managed through
    mathematical models. It is useful in solving a variety of real-world problems,
    each with its own unique complexities.
  prefs: []
  type: TYPE_NORMAL
- en: For instance, in logistics and transportation, mathematical optimisation can
    be used to solve challenges like the vehicle routing problem, which optimises
    routes for fleets, therfore reducing costs and environmental impact by using efficient
    routes. In computational biology, this approach is instrumental in understanding
    complex biological processes, improving drug discovery, genomics, and the study
    of disease pathways by developing precise models. Additionally, mathematical optimisation
    plays a key role in supply chain, a crucial element in modern commerce and industry.
    It optimises resource allocation, ensuring efficient production and distribution
    systems that minimize waste and costs while enhancing customer satisfaction. In
    summary, mathematical optimisation empowers decision makers in various fields
    to navigate complex problems to achieve optimal solutions for their problems.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, we show how to use mathematical optimisation to solve a basic
    energy supply and demand problem. We will start by explaining the problem statement
    and outlining the mathematical formulation. Then, we will take a practical example
    and use the Gurobi solver in Python to run the model. Finally, we will analyse
    the results obtained from this simulation.
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Problem statement
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let us envision a hypothetical situation where we are responsible for formulating
    the yearly budget for energy production and storage in a fictitious country. In
    this country, there are only four energy sources, namely solar, wind, natural
    gas, and nuclear.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3e80138ba2dbb78a26d0509ca2c9d47b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Artist illustrations of the different energy sources in our problem: solar,
    wind, natural gas, and nuclear. Sources: icons by [small.smiles](https://www.flaticon.com/authors/smallsmiles),
    [wanicon](https://www.flaticon.com/authors/wanicon), [Freepik](https://www.freepik.com/)
    from [Flaticon](https://www.flaticon.com/).'
  prefs: []
  type: TYPE_NORMAL
- en: 'We have access to data detailing their monthly production and storage capacities,
    and also insights into the associated production and storage costs. Additionally,
    we assume to have the understanding of the energy demand throughout the year.
    The key question is: how can we optimise the monthly production and storage quantities
    for each energy source to minimise the total annual cost?'
  prefs: []
  type: TYPE_NORMAL
- en: '**2\. Mathematical formulation**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now, let us delve into the mathematical formulation of our model. Feel free
    to skip this section if you are not a fan of equations. However, for those who
    find mathematics intriguing, the insights gained will be well worth the journey.
    We will outline the parameters, objective functions, and constraints in precise
    mathematical terms.
  prefs: []
  type: TYPE_NORMAL
- en: '**2.1\. Parameters**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let us define the mathematical notations used in our model. We denote *e* ∈
    *E* as the type of energy source in the set of all energy sources *E* (solar,
    wind, natural gas, and nuclear), and *t* ∈ *T* as the month in the set of all
    the months *T* (January, February, March, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, we introduce the following parameters given for our problem:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Dₜ* is the total projected energy demand for month *t.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Pₜₑ* is the production upper limit of energy source *e* in month *t.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Sₜₑ is* the storage upper limit of energy source *e* in month *t.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Aₑ* is the production cost of energy source *e* .'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Bₑ* is the storage cost of energy source *e.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The variables of our model are defined as follow:'
  prefs: []
  type: TYPE_NORMAL
- en: '*xₜₑ* is the amount of energy source *e* produced in month *t.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*yₜₑ* is the amount of energy source *e* remained in month *t*, which is also
    the amount that will be stored during that month.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*zₜₑ* is the amount of energy source *e* used in month *t* to satisfy the energy
    demand for that month.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**2.2\. Objective function**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now, let us define our objective function. Our aim is to minimise the total
    cost for the entire year. This can be expressed in mathematical terms as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8e8885ff70110c935ca95219c2170c02.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, *Aₑxₜₑ* represents the production cost of energy *e* in month *t*, while
    *Bₑyₜₑ* denotes the storage cost of energy *e* in month *t*. The two summation
    signs Σ signify the summation of these production and storage costs over all energy
    sources throughout the year. The goal is to find the values for the variables
    *xₜₑ* and *yₜₑ* that minimise the total cost.
  prefs: []
  type: TYPE_NORMAL
- en: 2.3\. Constraints
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Constraints are a vital part of our problem-solving approach. They ensure the
    solutions we find are both realistic and feasible, given our parameters.
  prefs: []
  type: TYPE_NORMAL
- en: 2.3.1\. Mass balance constraint
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The first constraint, also known as the mass balance constraint, ensures that
    for each energy source in a given month, the sum of the amount produced and the
    amount carried over from the previous month equals the sum of the amount used
    and the amount carried over to the next month. We assume that in the first month
    *t*₀ (January), there is no energy in storage yet. Mathematically, this constraint
    can be expressed as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1a0e5d58b509d4ff5b7aea09ce2f09ba.png)![](../Images/afd9db947f89187a5b167cb0872a4654.png)'
  prefs: []
  type: TYPE_IMG
- en: 2.3.2\. Demand constraint
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Next, we have the demand constraint, which is a fundamental aspect of our problem.
    It ensures that in any given month, the combined energy produced and carried forward
    from the previous month must be sufficient to meet the energy demand for that
    month. Mathematically, this constraint can be expressed as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a0820c642a9b6a057152c0d79dd7d595.png)![](../Images/d032dbcdd91dca99acd200e89ab0855b.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, Σ*ₑ* represents the sum over all energy source e. The constraint ensures
    that the total energy available (the sum of production and storage across all
    energy sources) in a given month *t* is greater than or equal to the energy demand
    *Dₜ* for that month. Given that there is no energy storage in the first month
    *t*₀, we simply ensure that the total energy produced in the first month is sufficient
    to meet the demand for that month.
  prefs: []
  type: TYPE_NORMAL
- en: 2.3.3\. Variable domains constraints
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The final set of constraints involves defining the domains of our variables,
    which are crucial for ensuring that the values of these variables remain within
    meaningful and feasible bounds. In our case, we have production limits and storage
    limits that restrict the values of *xₜₑ* and *yₜₑ*, respectively. Additionally,
    given that these variables should not take negative values, we need to set lower
    limits on their domains. Mathematically, the domain constraints can be expressed
    as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/354ab213ed0eeb29e5042b28f489a8db.png)![](../Images/0cb5d1b7f80bbd594275f05de476706d.png)![](../Images/4fc0f9859a6fda96951f2b89ed9202fd.png)'
  prefs: []
  type: TYPE_IMG
- en: There is no need to explicitly define the upper limit for *zₜₑ* because it is
    inherently determined by the mass balance constraint.
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Code
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here, we will provide a brief description of the code implementation. We start
    by importing the Gurobi library and a custom `Data` class responsible for loading
    data. The code can be found on GitHub here: [energy-optimisation](http://kyliow/energy-optimisation:
    Energy optimisation exploration (github.com)).'
  prefs: []
  type: TYPE_NORMAL
- en: The first step is to define the model and the necessary variables.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: We have the option to set the upper limit of a variable using either the `ub`
    argument in the `model.addVars()` method, or by specifying constraints using the
    `model.addConstrs()` method. Here, we have illustrate how to set the upper limit
    for energy production `X` within the `model.addVars()` method. Later on, we will
    demonstrate how to establish the upper limit for energy storage `Y` using the
    `model.addConstrs()` method.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we define the objective function.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Lastly, we define the constraints, with the first one is the mass balance constraint.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: After defining the mass balance constraint, we proceed to establish the demand
    constraint.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: In the final step, we illustrate how to set the upper limit for storage `Y`
    using the `model.addConstrs()` method.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 4\. Mock analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To evaluate our model, we require some mock data. Here, we use the monthly energy
    demand figures for the UK in the year 2022 as our mock energy demand. We also
    use the energy production figures for these energy sources in the UK during the
    year 2022, multiplied by a factor of 1.5, as an approximation for the monthly
    production capacity. The energy demand and production capacities are shown in
    figure below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1058d67ffb406f670531dfe1694209e4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'A bar chart of production limit of each energy source per month and the energy
    demand of the month. Source: image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: For storage capacities, we use a proxy of 10% of the EU’s gas storage capacity,
    equivalent to approximately 9500 GWh per month, to represent natural gas storage.
    We allocate a storage capacity of about 2000 GWh per month for other energy sources,
    presuming they are stored in large energy storage facilities.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we approximate our production cost figures on the real costs of these
    energy sources in 2022\. For storage, we adopt the physical storage cost of natural
    gas, which is about £16,000 per GWh. However, for other energy sources, we assume
    they are stored using lithium energy packs, which usually come at an exceptionally
    high cost compared to the physical storage cost of natural gas. To show this substantial
    cost difference, we set the storage cost for other energy sources at £80,000,000
    per GWh.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ebd382aa11ca0b629ba091a9ece49f50.png)'
  prefs: []
  type: TYPE_IMG
- en: 'A pie chart of the production cost in GBP per GWh. Source: image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: Figure below shows the energy production and storage costs throughout the year
    by dashed and dotted lines, respectively. Given that the storage cost of natural
    gas is exceptionally inexpensive in comparison to other energy sources, and it
    can even be lower than the production cost of some energy sources, the optimal
    strategy is to store natural gas consistently throughout the year. Consequently,
    the storage cost is only attributed to natural gas storage. The only exception
    is December, where no storage occurs. This is due to our analysis being designed
    to conclude in December, and therefore, there is no incentive to store energy
    beyond our analysis period.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e5ba4fe8566a979836aeefae007f8445.png)'
  prefs: []
  type: TYPE_IMG
- en: 'A stack bar chart of energy production per month, and the plots of costs. Source:
    image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, our analysis reveals that natural gas production emerges as the
    most cost-effective option due to its lower production cost compared to other
    energy sources. In the case of wind and solar, we observe fluctuations in production
    over the course of the year, likely influenced by seasonal variations in production
    capabilities (for instance, maximum sunlight and peak solar power generation typically
    occur during the mid-year). This fluctuation is evident from the bar chart of
    production limits.
  prefs: []
  type: TYPE_NORMAL
- en: When we combine the monthly production and storage costs, the result is an optimised
    annual cost of £17.01 billion.
  prefs: []
  type: TYPE_NORMAL
- en: It’s worth noting that we have utilised the same energy demand figures as the
    actual demand in the UK for 2022\. This suggests that our optimised energy supply
    and storage allocation outperform the actual scenario. This conclusion becomes
    even more apparent when considering that countries like the UK often export surplus
    energy to other nations in exchange for revenue. The export of excess energy is
    not factored into our model but represents an additional potential benefit in
    a real-world context.
  prefs: []
  type: TYPE_NORMAL
- en: In the spirit of experimentation, we have reduced the storage cost for all energy
    sources except natural gas by 1000 times to simulate a hypothetical situation
    in which large-scale battery storage becomes significantly affordable. The results
    are depicted in the figure below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7514c5b9d97d47a41d11cb030bdce5ee.png)'
  prefs: []
  type: TYPE_IMG
- en: 'A stack bar chart of energy production per month, and the plots of costs, given
    the revised storage costs. Source: image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: In this new scenario, we can see an increase in energy storage, while production
    costs generally decrease because it becomes more economical to store energy rather
    than produce it. Interestingly, we also notice an actual need to produce nuclear
    energy, although only in January.
  prefs: []
  type: TYPE_NORMAL
- en: In terms of cost, the total annual cost calculated by the model in this new
    scenario is £11.87 billion, approximately half of the actual annual cost. This
    demonstrates the significant impact of storage costs on the overall total annual
    cost.
  prefs: []
  type: TYPE_NORMAL
- en: 5\. Summary
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We have showcased the application of mathematical optimisation in solving a
    simple energy supply and demand problem, demonstrating its effectiveness in determining
    optimal energy production and storage quantities to minimise the total annual
    cost.
  prefs: []
  type: TYPE_NORMAL
- en: However, it’s important to acknowledge some potential limitations and challenges
    associated with mathematical optimisation. One such challenge is the need to simplify
    the problem during the formulation of the mathematical model, which can lead to
    an incomplete representation of the real-world problem. Attempting to incorporate
    more complexities can result in a more intricate formulation, making it harder
    to comprehend and solve.
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, solving large-scale mathematical optimisation problems often demands
    substantial computational resources. To address this issue, various strategies
    can be employed. Heuristics offer a practical approach to quickly obtain approximate
    solutions that may be close to the optimal solution. Additionally, metaheuristics,
    such as genetic algorithm (which I explain in details [here](https://medium.com/towards-artificial-intelligence/optimizing-object-avoidance-with-genetic-algorithm-in-python-4f69a734982f)),
    provide higher-level techniques for iteratively searching for solutions that are
    sufficiently close to the optimal solution. These approaches are valuable tools
    for tackling complex optimisation problems and can lead to practical solutions
    in scenarios where exact optimisation is challenging or computationally intensive.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: K. Y. Liow, [Optimizing Object Avoidance With Genetic Algorithm in Python](https://medium.com/towards-artificial-intelligence/optimizing-object-avoidance-with-genetic-algorithm-in-python-4f69a734982f)
    (2023), Towards AI @ Medium
  prefs: []
  type: TYPE_NORMAL
- en: References and data sources
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] [Monthly Electricity Statistics](https://www.iea.org/data-and-statistics/data-product/monthly-electricity-statistics)
    (2023), International Energy Agency'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] T. Stehly and P. Duffy, [2021 Cost of Wind Energy Review](https://www.nrel.gov/docs/fy23osti/84774.pdf)
    (2022), National Renewable Energy Laboratory'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] M. Roser, [Why did renewables become so cheap so fast?](https://ourworldindata.org/cheap-renewables-growth)
    (2020), Our World In Data'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] [EU reaches 90% gas storage target ahead of winter](https://energy.ec.europa.eu/news/eu-reaches-90-gas-storage-target-ahead-winter-2023-08-18_en)
    (2023), European Commission'
  prefs: []
  type: TYPE_NORMAL
- en: '[5] GlobalData, [Top five energy storage projects in the UK](https://www.power-technology.com/data-insights/top-five-energy-storage-projects-in-the-uk/)
    (2023), Power Technology'
  prefs: []
  type: TYPE_NORMAL
- en: '[6] J. Witwer, [The Role of Methane Storage in Achieving Renewable Energy Goals
    and Enhancing Energy Resiliency](https://onboarddynamics.com/the-role-of-methane-storage-in-achieving-renewable-energy-goals-and-enhancing-energy-resiliency/#:~:text=Relying%20on%20natural%20geologic%20features,kwh%20for%20the%20storage%20facility.)
    (2022), Onboard Dynamics'
  prefs: []
  type: TYPE_NORMAL

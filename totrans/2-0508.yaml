- en: 'Choosing the Right Path: Churn Models vs. Uplift Models'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/choosing-the-right-path-churn-models-vs-uplift-models-b8489306aa80](https://towardsdatascience.com/choosing-the-right-path-churn-models-vs-uplift-models-b8489306aa80)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Do we really need churn models? Maybe uplift modelling can give us more comprehensive
    answer?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://markeltsefon.medium.com/?source=post_page-----b8489306aa80--------------------------------)[![Mark
    Eltsefon](../Images/5ab4cccd496f73cd155bbb253f85ec4d.png)](https://markeltsefon.medium.com/?source=post_page-----b8489306aa80--------------------------------)[](https://towardsdatascience.com/?source=post_page-----b8489306aa80--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----b8489306aa80--------------------------------)
    [Mark Eltsefon](https://markeltsefon.medium.com/?source=post_page-----b8489306aa80--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----b8489306aa80--------------------------------)
    ·5 min read·Jun 16, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/36738e16e1255cb2287618e37fe708cd.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [cmophoto.net](https://unsplash.com/@cmophoto?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Let’s imagine that we work in e-commerce and the product manager comes to us
    and asks to build the churn model.
  prefs: []
  type: TYPE_NORMAL
- en: But what in reality he asked us ?
  prefs: []
  type: TYPE_NORMAL
- en: What can the churn model give us ?
  prefs: []
  type: TYPE_NORMAL
- en: 'Well, it’s all about understanding the likelihood of a specific customer leaving
    us. Our next steps are are driven by **heuristic**:'
  prefs: []
  type: TYPE_NORMAL
- en: If we provide a discount to the clients who are likely to churn then they will
    stay.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'However our goal is a bit different . Let’s imagine that we can do only two
    things : give a treat or not give a treat , in our case it’s gonna be a discount.
    There are 4 possible outcomes.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e52359e2c4fc5518f1b2b20265e59b4d.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Margin giveaway.** We offered a discount, the user used it and purchased
    an item, but the user would have made the purchase even without the discount.It’s
    a negative outcome because margin has been given away.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Treatment costs.** We offered a discount, but the users haven’t used it and
    haven’t made any purchases. This is also considered a negative outcome because
    we incur costs for treatments such as sending SMS messages, especially when dealing
    with a large user base.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Success.** We offered a discount, the user used it, and made a purchase solely
    due to the offer. This is the desired outcome we are aiming for.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Lost customer.** We offered a discount, but the user ended up leaving us.
    For example, in the case of a subscription service, the user received a notification
    with a discount, only to realize they had been paying for the subscription for
    the past 6 months and decided to cancel. This is the most negative outcome we
    can encounter.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Our true goal is not to estimate the probability to churn but we aim to apply
    the most appropriate treatment to each user.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How do we start achieving this goal ?
  prefs: []
  type: TYPE_NORMAL
- en: To begin, it is crucial to conduct a simple AB test. This involves providing
    a discount to one group while maintaining a control group without any discount.
  prefs: []
  type: TYPE_NORMAL
- en: After the experiment we have three primary approaches.
  prefs: []
  type: TYPE_NORMAL
- en: '**Two-Model Approach**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The first approach involves building two separate models: one for the control
    group (without any discount) and one for the treatment group (with an discount).
    To build these separate models we can choose any type of ML model.'
  prefs: []
  type: TYPE_NORMAL
- en: By running each client through both models, we can calculate the uplift as the
    difference between the predicted outcomes.
  prefs: []
  type: TYPE_NORMAL
- en: '**Pros:**'
  prefs: []
  type: TYPE_NORMAL
- en: It is easy to implement.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cons:**'
  prefs: []
  type: TYPE_NORMAL
- en: It does not directly predict uplift. We estimate the probability of the users’
    action (purchase).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The two-model setup introduces double error modeling, as both models have their
    own errors, leading to larger overall errors.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Target Transformation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The second approach revolves around transforming the target variable itself.
    By creating a new target that represents uplift, we can calculate the desired
    outcome directly.
  prefs: []
  type: TYPE_NORMAL
- en: 'We introduce a new target variable using the following formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/25fd3350344d31d633dd6b22646f6782.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Here, Y represents the original target variable, and W indicates whether the
    target treatment was applied or not. In other words Y represents whether the discount
    was given or not, and W indicates whether a purchase was made or not.
  prefs: []
  type: TYPE_NORMAL
- en: 'The transformed variable Z takes the value of 1 in two cases :'
  prefs: []
  type: TYPE_NORMAL
- en: The user belongs to the target group (W = 1) and Y = 1 ( the discount was given
    to the user and he has purchased ).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The user belongs to the control group (W = 0) and Y = 0 ( the discount wasn’t
    given to the user and the user hasn’t purchased).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Then we just need to train the model ( for example logistic regression) with
    a new target.
  prefs: []
  type: TYPE_NORMAL
- en: 'To calculate uplift, we can use the following formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/33cfd3a56869c7434f265fe11dd65b07.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '**Pros :**'
  prefs: []
  type: TYPE_NORMAL
- en: It is still easy to implement.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It’s more robust and stable than the first approach due the fact that we have
    only one model.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cons :**'
  prefs: []
  type: TYPE_NORMAL
- en: It still does not directly predict uplift. We predict the transformed variable.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tree-Based Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The third approach capitalizes on tree-based models.
  prefs: []
  type: TYPE_NORMAL
- en: The goal is to identify the subpopulations within a dataset that are most responsive
    to the treatment, thereby enabling targeted interventions for maximum impact.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6fe3a645bcfb2b0349e96037fe23e67d.png)'
  prefs: []
  type: TYPE_IMG
- en: The tree-based uplift model. [https://github.com/uber/causalml](https://github.com/uber/causalml)
  prefs: []
  type: TYPE_NORMAL
- en: The example decision tree for uplift purposes is depicted in the highlighted
    image above. The red color indicates the uplift values. By observing the image,
    we can conclude that the overall uplift difference is 0.0127 (based on a random
    metric). However, as we descend into the tree, we observe certain subpopulations
    exhibiting higher uplift differences.
  prefs: []
  type: TYPE_NORMAL
- en: These subpopulations become our target as they hold the potential for maximum
    benefits.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**How to build this tree ?**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are numerous tutorials available on constructing decision trees, but here
    I will outline the basic approach.
  prefs: []
  type: TYPE_NORMAL
- en: Select features and identify the target variable, which, in our case, is uplift.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Choose a splitting criterion to determine how nodes are divided.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Build the tree by recursively repeating the splitting process until a stopping
    criterion is met.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It’s worth noting that there are three commonly used splitting criteria for
    building uplift trees, listed below in order of popularity:'
  prefs: []
  type: TYPE_NORMAL
- en: KL divergence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Chi-Square
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Euclidean Distance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pros :**'
  prefs: []
  type: TYPE_NORMAL
- en: One of the most accurate methods
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We have a decision tree , therefore we can construct the forest of trees and
    different ensembles that increase the accuracy and reduce variance.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cons :**'
  prefs: []
  type: TYPE_NORMAL
- en: It’s a decision tree method , therefore the algorithm tends to overestimate
    the categorical variables with many levels. To fix it we can use mean imputation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now we know that addressing customer churn requires strategies that go beyond
    just estimating the probability of churn. The ultimate goal is to apply the most
    appropriate treatment to each user and deliver business impact instead of churn
    probability.
  prefs: []
  type: TYPE_NORMAL
- en: Uplift modeling, which can be applied to various business challenges beyond
    churn, offers a powerful solution with immediate business impact.
  prefs: []
  type: TYPE_NORMAL
- en: There are still a lot of intriguing questions about uplift modelling such as
    handling multiple treatments, estimating different uplift models, and utilizing
    multi-armed bandits for production, but I will keep answers for the next post.
  prefs: []
  type: TYPE_NORMAL
- en: Thanks for reading and don’t be afraid to make mistakes and learn. It’s the
    only way to progress!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL

- en: 'Hitting Time Forecasting: The Other Way for Time Series Probabilistic Forecasting'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/hitting-time-forecasting-the-other-way-for-time-series-probabilistic-forecasting-6c3b6496c353](https://towardsdatascience.com/hitting-time-forecasting-the-other-way-for-time-series-probabilistic-forecasting-6c3b6496c353)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How long does it take to reach a specific value?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@cerlymarco?source=post_page-----6c3b6496c353--------------------------------)[![Marco
    Cerliani](../Images/48a07a024349bac3c8e397bf5a0372e2.png)](https://medium.com/@cerlymarco?source=post_page-----6c3b6496c353--------------------------------)[](https://towardsdatascience.com/?source=post_page-----6c3b6496c353--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----6c3b6496c353--------------------------------)
    [Marco Cerliani](https://medium.com/@cerlymarco?source=post_page-----6c3b6496c353--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----6c3b6496c353--------------------------------)
    ·4 min read·Jun 27, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/56b7e137fff75e868c9e0625e9861608.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Mick Haupt](https://unsplash.com/@rocinante_11?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: The ability to make accurate predictions is fundamental for every time series
    forecasting application. Following this purpose, **data scientists are used to
    choosing the best models that minimize errors from a point forecast perspective**.
    That’s correct but may not be always the best effective approach.
  prefs: []
  type: TYPE_NORMAL
- en: Data scientists should also consider the possibility of developing probabilistic
    forecasting models. These models produce, together with point estimates, also
    upper and lower reliability bands in which future observations are likely to fall
    in. Despite probabilistic forecasting seeming to be a prerogative of statistical
    or deep learning solutions, **any model can be used to produce probabilistic forecasts**.
    The concept is explained in one of my [previous posts](https://medium.com/towards-data-science/time-series-forecasting-with-conformal-prediction-intervals-scikit-learn-is-all-you-need-4b68143a027a)
    where **I introduced conformal prediction as a way to estimate prediction intervals
    with any scikit-learn models**.
  prefs: []
  type: TYPE_NORMAL
- en: For sure a point forecast is considerably easier to communicate to non-technical
    stakeholders. At the same time, the possibility to generate KPIs on the reliability
    of our predictions is an added value. **A probabilistic output may carry more
    information to support decision-making**. Communicating that there is a 60% chance
    of rain in the next hours may be more informative than reporting how many millimeters
    of rain will fall.
  prefs: []
  type: TYPE_NORMAL
- en: In this post, **we propose a forecasting technique, known as forecasting hitting
    time, used to estimate when a specific event or condition will occur**. It reveals
    to be **accurate** since it’s based on conformal prediction, **interpretable**
    because it has probabilistic interpretability, and **reproducible** with any forecasting
    technique.
  prefs: []
  type: TYPE_NORMAL
- en: Introducing Hitting Time Forecasting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Forecasting hitting time** is a concept commonly used in various fields.
    It **refers to predicting or estimating the time it takes for a certain event
    or condition to occur**, often in the context of reaching a specific threshold
    or level.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/eb8f530a2196a19c4336cad464771fda.png)'
  prefs: []
  type: TYPE_IMG
- en: Simulated seasonality and trend [image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f5a31e966e27f11efbcdee2a9ee11296.png)'
  prefs: []
  type: TYPE_IMG
- en: Simulated time series (seasonality + trend) with an example of hitting time
    level [image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: The most known applications of hitting time refer to fields like reliability
    analysis and survival analysis. It involves estimating the time it takes for a
    system or process to experience a specific event, such as a failure or reaching
    a particular state. In finance, hitting time is often applied to determine which
    is the probability of a signal/index following a desired direction.
  prefs: []
  type: TYPE_NORMAL
- en: Overall, forecasting hitting time involves making predictions about the time
    it takes for a particular event, which follows temporal dynamics, to occur.
  prefs: []
  type: TYPE_NORMAL
- en: From Point-wise to Probabilistic Forecasting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**To correctly estimate hitting times we have to start from point forecasting**.
    As a first step, we choose the desired forecasting algorithm. For this article,
    we adopt a simple recursive estimator easily available in scikit-learn style from
    [**tspiral**](https://github.com/cerlymarco/tspiral).'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/854290476aeb6ffdcb7bf2617fc64183.png)'
  prefs: []
  type: TYPE_IMG
- en: Predicted vs real data points on test set [image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Our aim is to produce forecasting distributions for each predicted point
    from which extract probabilistic insights**. This is done following a three-step
    approach and making use of the theory behind conformal prediction:'
  prefs: []
  type: TYPE_NORMAL
- en: Forecasts are collected on the training set through cross-validation and then
    averaged together.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Conformity scores are calculated on the training data as absolute residuals
    from cross-validated predictions and real values.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Future forecast distributions are obtained by adding conformity scores to test
    predictions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/5eb9b302230308caa202d69e51e59f85.png)'
  prefs: []
  type: TYPE_IMG
- en: Predicted distribution on test data [image by the author]
  prefs: []
  type: TYPE_NORMAL
- en: Following the procedure depicted above, we end up with a collection of plausible
    trajectories that future values may follow. We have all that we need to provide
    a probabilistic representation of our forecasts.
  prefs: []
  type: TYPE_NORMAL
- en: From Probabilistic to Hitting Time Forecasting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For each future time point, it’s recorded **how many times the values in the
    estimated test distributions exceed a predefined threshold (our hit target level)**.
    This count is transformed into a probability simply normalizing by the number
    of values in each estimated test distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, a transformation is applied to the array of probabilities to have a
    series of monotonic increasing probabilities.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/15913e9ec659b55788bc632b62a4759d.png)'
  prefs: []
  type: TYPE_IMG
- en: Predicted vs real data points on test set plus hitting time probabilities [image
    by the author]
  prefs: []
  type: TYPE_NORMAL
- en: '**Whatever the event we are trying to forecast, we can generate a curve of
    probabilities simply starting from the point forecasts**. The interpretation remains
    straightforward, i.e. for each forecasted time point we can derive the probability
    of our target series reaching a predefined level.'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this post, we introduced a way to provide probabilistic outcomes to our forecasting
    models. It doesn’t require the application of strange and intensive additional
    estimation techniques. Simply starting from a point forecasting problem, it’s
    possible to add a probabilistic overview of the task by applying a hitting time
    approach.
  prefs: []
  type: TYPE_NORMAL
- en: '[**CHECK MY GITHUB REPO**](https://github.com/cerlymarco/MEDIUM_NoteBook)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Keep in touch: [Linkedin](https://www.linkedin.com/in/marco-cerliani-b0bba714b/)'
  prefs: []
  type: TYPE_NORMAL

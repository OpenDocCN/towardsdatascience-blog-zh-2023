- en: Frequentist vs. Bayesian Statistics with Tensorflow
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/frequentist-vs-bayesian-statistics-with-tensorflow-fbba2c6c9ae5](https://towardsdatascience.com/frequentist-vs-bayesian-statistics-with-tensorflow-fbba2c6c9ae5)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Probabilistic deep learning
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@luisroque?source=post_page-----fbba2c6c9ae5--------------------------------)[![Lu√≠s
    Roque](../Images/e281d470b403375ba3c6f521b1ccf915.png)](https://medium.com/@luisroque?source=post_page-----fbba2c6c9ae5--------------------------------)[](https://towardsdatascience.com/?source=post_page-----fbba2c6c9ae5--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----fbba2c6c9ae5--------------------------------)
    [Lu√≠s Roque](https://medium.com/@luisroque?source=post_page-----fbba2c6c9ae5--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----fbba2c6c9ae5--------------------------------)
    ¬∑10 min read¬∑Jan 5, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This article belongs to the series ‚ÄúProbabilistic Deep Learning‚Äù. This weekly
    series covers probabilistic approaches to deep learning. The main goal is to extend
    deep learning models to quantify uncertainty, i.e. know what they do not know.
  prefs: []
  type: TYPE_NORMAL
- en: The frequentist approach to statistics is based on the idea of repeated sampling
    and long-run relative frequency. It involves constructing hypotheses about a population
    and testing them using sample data. On the other hand, the Bayesian approach is
    based on subjective probability and involves updating an initial belief about
    a population using collected data. Both methods have their strengths and limitations
    and which one to use depends on the problem and analysis goals. In this article,
    we will explore the differences between the frequentist and the Bayesian approach
    and discuss how they can be implemented using TensorFlow and TensorFlow Probability.
  prefs: []
  type: TYPE_NORMAL
- en: 'Articles published so far:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Gentle Introduction to TensorFlow Probability: Distribution Objects](https://medium.com/towards-data-science/gentle-introduction-to-tensorflow-probability-distribution-objects-1bb6165abee1)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Gentle Introduction to TensorFlow Probability: Trainable Parameters](https://medium.com/towards-data-science/gentle-introduction-to-tensorflow-probability-trainable-parameters-5098ea4fed15)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Maximum Likelihood Estimation from scratch in TensorFlow Probability](/maximum-likelihood-estimation-from-scratch-in-tensorflow-probability-2fc0eefdbfc2)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Probabilistic Linear Regression from scratch in TensorFlow](/probabilistic-linear-regression-from-scratch-in-tensorflow-2eb633fffc00)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Probabilistic vs. Deterministic Regression with Tensorflow](https://medium.com/towards-data-science/probabilistic-vs-deterministic-regression-with-tensorflow-85ef791beeef)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Frequentist vs. Bayesian Statistics with Tensorflow](https://medium.com/towards-data-science/frequentist-vs-bayesian-statistics-with-tensorflow-fbba2c6c9ae5)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](../Images/a4570c7be657d4edef2f441ce79f6f04.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1: Moto for today: there is not a unique way to look at probabilities
    ([source](https://unsplash.com/photos/V3qzwMY2ak0)).'
  prefs: []
  type: TYPE_NORMAL
- en: We develop our models using TensorFlow and TensorFlow Probability. TensorFlow
    Probability is a Python library built on top of TensorFlow. We are going to start
    with the basic objects that we can find in TensorFlow Probability and understand
    how can we manipulate them. We will increase complexity incrementally over the
    following weeks and combine our probabilistic models with deep learning on modern
    hardware (e.g. GPU).
  prefs: []
  type: TYPE_NORMAL
- en: As usual, the code is available on my [GitHub](https://github.com/luisroque/probabilistic_deep_learning_with_TFP).
  prefs: []
  type: TYPE_NORMAL
- en: Frequentist vs. Bayesian Approach to Problems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Frequentist statistics and Bayesian statistics are two main approaches to statistical
    inference, which is the process of using data to draw conclusions about a population.
    Both approaches are used to estimate unknown quantities, make predictions, and
    test hypotheses, but they differ in their interpretation of probability and how
    they incorporate prior knowledge and evidence.
  prefs: []
  type: TYPE_NORMAL
- en: In frequentist statistics, probability is interpreted as the long-run relative
    frequency of an event in an infinite number of trials. This approach is based
    on the idea that the true value of a population parameter is fixed, but is unknown
    and must be estimated from data. In this framework, statistical inferences are
    drawn from the observed data by making assumptions about the underlying data-generating
    process and using techniques such as point estimation, confidence intervals, and
    hypothesis testing.
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, Bayesian statistics interprets probability as a measure of
    belief or degree of certainty about an event. This approach allows for the incorporation
    of prior knowledge and evidence into statistical analysis through the use of Bayes‚Äô
    theorem. In this framework, the true value of a population parameter is treated
    as a random variable and is updated as new data is collected. This results in
    a full distribution over the parameter space, known as a posterior distribution,
    which can be used to make probabilistic predictions and to quantify uncertainty.
  prefs: []
  type: TYPE_NORMAL
- en: One key difference between the two approaches is how they handle uncertainty.
    In frequentist statistics, uncertainty is quantified through the use of confidence
    intervals, which provide an estimate of the likely range of the true population
    parameter based on the observed data. In Bayesian statistics, uncertainty is represented
    by the full posterior distribution, which allows for a more complete characterization
    of the uncertainty surrounding the true value of the parameter.
  prefs: []
  type: TYPE_NORMAL
- en: Another difference is that Bayesian statistics allows for the incorporation
    of prior knowledge, which can be particularly useful in cases where there is limited
    data or when the data-generating process is complex. However, the choice of prior
    distribution can significantly influence the results of a Bayesian analysis, and
    it is important to choose a prior that is appropriate for the problem at hand.
  prefs: []
  type: TYPE_NORMAL
- en: The Problem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As an example of applying a frequentist approach to a problem, consider the
    task of estimating the mean income of a population based on a sample of data.
    In this case, the goal is to use the sample data to make inferences about the
    true mean income of the population (we are going to assume that the standard deviation
    of the income of the population is known for now).
  prefs: []
  type: TYPE_NORMAL
- en: 'Let‚Äôs generate some data:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/bb1676894082a75eb3e8d331a522c244.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2: Histogram of the sample mean of the income of the population ‚Äî synthetically
    generated data.'
  prefs: []
  type: TYPE_NORMAL
- en: The Frequentist Way
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: One way to approach this problem using a frequentist approach is through point
    estimation. Point estimation involves using a single point estimate, such as the
    sample mean, to represent the unknown population parameter.
  prefs: []
  type: TYPE_NORMAL
- en: 'The sample mean, *ùúá*ÃÇ, is a commonly used point estimate for the population
    mean, *ùúá*. It is calculated as the sum of the sample values, *ùë•*1,*ùë•*2,‚Ä¶,*ùë•ùëõ*,
    divided by the sample size, *ùëõ*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e8683864dfca212802019de01e5c0e3d.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: However, point estimates alone do not provide a complete characterization of
    the uncertainty surrounding the estimate. To quantify this uncertainty, we can
    use a confidence interval. A confidence interval is an estimate of the likely
    range of the true population parameter based on the observed data, and it is constructed
    by adding and subtracting a margin of error from the point estimate. The margin
    of error is determined by the desired level of confidence and the sample size,
    and it reflects the variability in the sample data. For example, a 95% confidence
    interval indicates that we are 95% confident that the true population parameter
    falls within the interval.
  prefs: []
  type: TYPE_NORMAL
- en: 'A confidence interval for the population mean is constructed by adding and
    subtracting a margin of error, *ùëö*, to the point estimate:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1660d16b740375d1eba7e5e97c1aa79f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The margin of error is determined by the desired level of confidence, 1‚àí*ùõº*,
    and the sample size, *ùëõ*. It reflects the variability in the sample data and is
    typically calculated using the standard error, *ùëÜùê∏*, of the point estimate:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/69cc8f472cbbd1706ff712d9cd3bf4b7.png)'
  prefs: []
  type: TYPE_IMG
- en: where *ùë°*1‚àí*ùõº*2,*ùëõ*‚àí1 is the critical value of the *ùë°*-distribution with *ùëõ*‚àí1
    degrees of freedom for the desired level of confidence.
  prefs: []
  type: TYPE_NORMAL
- en: 'The standard error of the sample mean is calculated as the standard deviation
    of the sample, *ùúé*, divided by the square root of the sample size:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aa7358e49e38f104231074c38e6eda34.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: We can define a helper function to plot our predicting mean and confidence interval
    overlayed on the sampled data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/8018f59799dbb1fe66945a8ded152fc7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3: Mean and confidence interval for the estimated parameter using a
    frequentist approach.'
  prefs: []
  type: TYPE_NORMAL
- en: The Bayesian Way
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As an example of applying a Bayesian approach to a problem, consider the task
    of estimating the mean income of a population based on a sample of data. In this
    case, the goal is to use the sample data and any available prior knowledge to
    make inferences about the true mean income of the population.
  prefs: []
  type: TYPE_NORMAL
- en: 'One way to approach this problem using a Bayesian approach is through the use
    of Bayes‚Äô theorem, which allows us to update our belief about the value of the
    population mean income based on the observed data. Bayes‚Äô theorem states that
    the posterior probability of a hypothesis given some data is equal to the prior
    probability of the hypothesis multiplied by the likelihood of the data given the
    hypothesis, normalized by the marginal probability of the data. This can be written
    mathematically as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5104070b345c851739bee6f11763fb64.png)'
  prefs: []
  type: TYPE_IMG
- en: where *ùúÉ* is the population mean income, *ùë•* is the observed data (i.e., the
    sample of income values), and *ùëÉ*(*ùúÉ*|*ùë•*), *ùëÉ*(*ùë•*|*ùúÉ*), *ùëÉ*(*ùúÉ*), and *ùëÉ*(*ùë•*)
    are the posterior probability, likelihood, prior probability, and marginal probability,
    respectively.
  prefs: []
  type: TYPE_NORMAL
- en: To apply this approach to the income example, we must first specify a prior
    distribution over the population mean income, *ùëÉ*(*ùúÉ*). This prior distribution
    represents our belief about the value of the population mean income before we
    observe the data. The choice of prior distribution will depend on any available
    prior knowledge and the characteristics of the data-generating process. For example,
    if we have strong prior knowledge that the population mean income is normally
    distributed with a mean of 45,000 and a standard deviation of 5,000, we could
    use a normal prior distribution with these parameters.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The likelihood function, *ùëÉ*(*ùë•*|*ùúÉ*), represents the probability of observing
    the sample data, *ùë•*, given a particular value of the population mean income,
    *ùúÉ*. Since the sample data are assumed to be independent and identically distributed
    (i.i.d.), the likelihood function is simply the product of the individual probability
    density functions of the sample values. For example, if the sample data are normally
    distributed with a known standard deviation, *ùúé*, the likelihood function is a
    normal distribution with mean equal to the population mean income, *ùúÉ*, and standard
    deviation equal to the sample standard deviation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cdf307247325c7851dde09709c019f0d.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, we use Bayes‚Äô theorem to compute the posterior distribution:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5a7e464737f73240911ed517243fcaa1.png)'
  prefs: []
  type: TYPE_IMG
- en: The posterior distribution can be used to make probabilistic predictions and
    to quantify the uncertainty surrounding the estimate of the population mean income.
    For example, we can use the posterior distribution to compute the posterior mean
    and posterior standard deviation as estimates of the population mean income and
    the uncertainty around the estimate, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: As we saw above, the posterior distribution is a result of multiplying two Gaussian
    distributions. For us to accomplish that, we need to introduce one more concept
    ‚Äî conjugate distributions. In our case, we have a normal-normal conjugate family
    which is a parametric family of distributions where the prior distribution and
    the likelihood function are both normal distributions. This class of models has
    several attractive properties, including the ability to analytically compute the
    posterior distribution and the closed-form solution for the maximum a posteriori
    (MAP) estimate.
  prefs: []
  type: TYPE_NORMAL
- en: 'The posterior distribution is defined as the distribution of the model parameters
    (in this case, the mean *ùúá* and standard deviation *ùúé* of the normal distribution)
    given the observed data *ùë¶*. The mean and standard deviation of the posterior
    distribution can be calculated using the following equations:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ffab0505eda21264e5334da4daa4c4b1.png)'
  prefs: []
  type: TYPE_IMG
- en: where *ùúá*0 and *ùúé*2_0 are the mean and variance of the prior distribution, respectively,
    *ùúá_ùëô* and *ùúé2_l* are the mean and the variance of the likelihood function and
    *ùëõ* is the sample size.
  prefs: []
  type: TYPE_NORMAL
- en: These equations assume that the prior distribution and the likelihood function
    are both normal distributions, as is the case in a normal-normal conjugate model.
    If the prior and likelihood are not normal, or if the posterior distribution does
    not have a closed-form solution, these parameters can be approximated using techniques
    such as Markov Chain Monte Carlo (MCMC) sampling.
  prefs: []
  type: TYPE_NORMAL
- en: We are ready to implement our new equations.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: We can see how updating our prior belief with data resulted in our posterior
    distribution.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/54e2b201408727822e8af4ab347490a6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 4: Prior, Likelihood and Posterior probability functions.'
  prefs: []
  type: TYPE_NORMAL
- en: Finally, as we did for the frequentist case, we can plot our estimate for the
    mean of the population. Notice that we are actually computing the credible interval
    and not the confidence interval with the Bayesian approach.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/0e3221655e11c5b959a0c870598ba212.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5: Mean and credible interval for the estimated parameter using a Bayesian
    approach'
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In conclusion, the frequentist and Bayesian approaches are two different ways
    of analyzing data and making predictions. The frequentist approach is based on
    the idea of statistical significance and involves constructing hypotheses about
    a population and testing them using sample data. The Bayesian approach is based
    on subjective probability and involves updating an initial belief about a population
    using collected data.
  prefs: []
  type: TYPE_NORMAL
- en: Using TensorFlow and TensorFlow Probability, we demonstrated how to compute
    the mean and confidence interval for the frequentist approach and the mean and
    credible interval for the Bayesian approach. Both approaches can be useful for
    different types of problems and it is important to understand the strengths and
    limitations of each one in order to choose the most appropriate method for a given
    situation.
  prefs: []
  type: TYPE_NORMAL
- en: 'Keep in touch: [LinkedIn](https://www.linkedin.com/in/luisbrasroque/)'
  prefs: []
  type: TYPE_NORMAL

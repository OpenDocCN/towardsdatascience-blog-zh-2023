# 数据分析师数据清洗指南

> 原文：[https://towardsdatascience.com/data-analyst-guide-to-data-cleaning-6409159ebf3](https://towardsdatascience.com/data-analyst-guide-to-data-cleaning-6409159ebf3)

## 如何处理不同类型的数据清洗

[](https://madfordata.medium.com/?source=post_page-----6409159ebf3--------------------------------)[![Vicky Yu](../Images/54a32f45ebd13a18811912877f60f2f7.png)](https://madfordata.medium.com/?source=post_page-----6409159ebf3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----6409159ebf3--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----6409159ebf3--------------------------------) [Vicky Yu](https://madfordata.medium.com/?source=post_page-----6409159ebf3--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----6409159ebf3--------------------------------) ·阅读时间6分钟·2023年8月4日

--

![](../Images/07a0be03e19ccd76543c5e5b692bc784.png)

图片来源于 [Janeke88](https://pixabay.com/users/janeke88-975535/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=880462) 来自 [Pixabay](https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=880462)

虽然有很多资源可以学习技术技能，但很少有深入讲解如何清洗数据的资源——这是数据分析师必备的技能。你可能会认为可以应用相同的规则来清洗数据，但情况并非总是如此。今天，我想分享我作为数据分析师多年来学习到的，关于如何处理不同类型的数据以进行数据分析和报告的经验。

## 数字值

我所说的数字值是指那些对数据分析和报告有用的值。一个好的经验法则是看平均值是否有用。例如，数字订单号字段的平均值是没有意义的。然而，平均收入金额是有用的。

**作为数字字段存储的数字**

对于保存在数字字段中的数字，请应用以下清洗规则：

1.  计算***最小值***、***最大值***、***中位数***、***99百分位***和***平均值***。如果***最小值***是负数，但值应该是零或更高，则在适用的情况下将其替换为零。在下面的示例销售数据中，注意**第13行**的***中位数***为**$800**与**第12行**的***平均值***为**$20,560**之间的巨大差异。如果中位数和平均值或最大值和99百分位之间差异很大，我通常会检查异常值，特别是当我不熟悉数据时。如果你报告包括第4行$100,000的平均销售额，它将是$20,560，而不是$560，如果你排除了$100,000。这就是为什么检查异常值并排除它们是好的，尤其是当你计划报告平均值或使用数据来构建机器学习模型时，因为异常值可能会影响模型结果。根据最重要的字段优先安排你的时间，因为你可能有数十个字段需要检查，检查所有字段会非常耗时。

![](../Images/e719daf0612f9ec95762414163e89177.png)

作者创建的示例数据

2\. 计算缺失值和非缺失值。如果缺失值的数量超过非缺失值，那么这个数值字段在你的分析中可能不可用。例如，如果你有1,000条记录，但其中900条缺失，那么100条非缺失值在你的分析中可能不会有用。如果缺失值的数量少于非缺失值，则在适用的情况下将缺失值替换为零。如果缺失值意味着除零以外的值，则用你认为更合适的值替换，如中位数或平均数，前提是你已经去除了异常值。例如，我曾经遇到过一天的缺失[DAU](https://baremetrics.com/academy/daily_active_user)（每日活跃用户）数据。由于DAU根据一年中的时间有所不同，我用前7天的平均值来替换缺失那一天的DAU。

**作为字符串字段存储的数字**

数值可以作为字符串值加载到数据库中，因为它们包含需要移除的字符，才能转换为数字。识别这些字符串字段的经验法则是问一下平均值是否有用。

这些字符串值的例子包括带有货币的销售金额，如$100.55或包含逗号的数字，如1,000。在这些情况下，你需要移除字符值，即删除货币符号以转换为100.55，删除逗号以转换为1000，然后将字符串值转换为数字。字符串值转换为数字后，应用上述数据清理规则，处理作为数值字段保存的数字。

## **字符串值**

对于字符串值字段，应用以下清理规则：

1.  按表中的 [主键](https://www.techopedia.com/definition/5547/primary-key) 检查重复项。主键通常是唯一标识符，如客户 ID 或使行在表中唯一的字段组合。在进行数据分析时，您需要确保数据源中没有重复项，因为这可能导致报告错误的数字。

1.  计算 [空值](https://www.w3schools.com/sql/sql_null_values.asp) 和非空值的数量。确定是否可以用字符串值替换空值。有时我会将空值替换为‘N/A’或‘None’以用于报告，但这取决于您的要求。

1.  计算每个唯一字符串值的行数，并按降序排列。查找具有相同含义的字符串值，并将其更改为相同的值。

在下面的示例 SQL 查询中，第 1 到第 7 行，我计算了每个***item_name*** 值的行数，并按降序排列。由于可能有数百个唯一的字符串值，因此要集中处理行数最多的唯一值，优先清理这些，因为更改行数较少的值会花费过多时间，并且可能不会影响分析结果。

SQL 结果第 1 到第 3 行显示，***item_count*** 为 33 的 ***apples***，19 的 ***apple*** 和 17 的 ***Apples***。可以将 ***Apples***、***apple*** 和 ***apples*** 更改为 ***apple***。第 4 行和第 5 行中的 ***strawberries*** 和 ***strawberry*** 可以更改为 ***strawberry***。数据清理后，第 1 行和第 2 行显示的 ***item_count*** 为 ***apple*** 69 和 ***strawberry*** 26。

![](../Images/8865c7fa7198def36b46be3027cd618b.png)

作者创建的清理前唯一 item_name 值计数的截图

![](../Images/f7238f01b61f5580472eb10f81609a4b.png)

作者创建的清理后唯一 item_name 值计数的截图

搜索并根据需要移除特殊字符。这在非英语文本或自由格式文本中很常见，其中制表符和回车符可能是加载到数据库中的文本的一部分。大多数字符串字段不包含特殊字符，但如果在查询特定字符串值时没有返回任何行，则特殊字符可能是原因。

日期或日期时间值可以作为字符串值加载。确认字段中的日期值格式相同，并根据需要将其转换为日期或日期时间字段，以便可以使用日期函数。

## 日期和日期时间值

对具有日期或日期时间字段的表应用以下数据清理规则：

1.  检查那些每个日期或日期与其他字段组合应仅有一行的表中的重复项。例如，日活跃用户（DAU）表是每日活跃用户的计数，每天应仅有一行。另一个例子是按国家的收入，其中日期和国家组合使行在收入表中唯一。我曾经继承了一个 ETL 作业，该作业没有删除更新日期相同的数据。我不小心重新运行了同一天的作业，并在收入表中引入了重复项。我只有在运行了重复检查后才意识到这一点，否则我会向利益相关者报告过多的收入。

1.  在连接多个含有日期时间值的表时，请确认日期时间值处于相同的时区。我曾经需要创建一个报告，展示发送电子邮件后24小时内用户升级的数量。电子邮件表的日期时间是 CST（中央时间），但升级表的日期时间是 UTC（协调世界时间）。UTC 比 CST 快 5 小时。如果我仅仅检查 CST 的电子邮件发送日期时间后的24小时，我会错过在电子邮件发送后升级的5小时用户。幸运的是，大多数数据库都有一个 SQL 函数叫做 CONVERT_TIMEZONE，用于将日期时间转换到不同的时区。请查看你的数据库文档以确认。

## 最后思考

虽然数据清洗不是数据分析师，包括我自己，在工作中最喜欢的任务，但我希望我所介绍的方法能在你下一次需要为项目清洗数据时帮到你。祝数据清洗愉快！

*注意：以上所有 SQL 查询都在* [*BigQuery 沙盒*](https://cloud.google.com/bigquery/docs/sandbox) *上运行，该沙盒对任何拥有 Google 账户的人都是免费的。*

## 你可能还会喜欢……

[](/data-cleaning-the-unsexy-side-of-data-science-680fedabcb20?source=post_page-----6409159ebf3--------------------------------) [## 数据清洗：数据科学中不性感的一面

### 对实际案例的深入分析

towardsdatascience.com](/data-cleaning-the-unsexy-side-of-data-science-680fedabcb20?source=post_page-----6409159ebf3--------------------------------) [](/bigquery-functions-for-data-cleaning-4b96181fbc3?source=post_page-----6409159ebf3--------------------------------) [## BigQuery SQL 函数用于数据清洗

### 适用的用例和函数

towardsdatascience.com](/bigquery-functions-for-data-cleaning-4b96181fbc3?source=post_page-----6409159ebf3--------------------------------) [](/what-you-dont-learn-about-data-in-school-2bf872ceda47?source=post_page-----6409159ebf3--------------------------------) [## 你在学校里学不到的数据知识

### 如何使用不完美的数据获得可用的结果

towardsdatascience.com](/what-you-dont-learn-about-data-in-school-2bf872ceda47?source=post_page-----6409159ebf3--------------------------------)

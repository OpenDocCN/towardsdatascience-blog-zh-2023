["```py\nlibrary(nlme)\nlibrary(tidyverse)\nlibrary(ggridges)\n```", "```py\n# Dataset\ndata(\"Gasoline\")\n```", "```py\n# Check for the best correlations\ncor(Gasoline[,-3])\n\n              yield   endpoint        API      vapor       ASTM\nyield     1.0000000  0.7115262  0.2463260  0.3840706 -0.3150243\nendpoint  0.7115262  1.0000000 -0.3216782 -0.2979843  0.4122466\nAPI       0.2463260 -0.3216782  1.0000000  0.6205867 -0.7001539\nvapor     0.3840706 -0.2979843  0.6205867  1.0000000 -0.9062248\nASTM     -0.3150243  0.4122466 -0.7001539 -0.9062248  1.0000000\n```", "```py\n# OLS model\nmodel_ols <- lm(yield ~ endpoint, data=Gasoline)\nsummary(model_ols)\n\n[OUT]\nCall:\nlm(formula = yield ~ endpoint, data = Gasoline)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-14.7584  -6.2783   0.0525   5.1624  17.8481 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -16.66206    6.68721  -2.492   0.0185 *  \nendpoint      0.10937    0.01972   5.546 4.98e-06 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 7.659 on 30 degrees of freedom\nMultiple R-squared:  0.5063, Adjusted R-squared:  0.4898 \nF-statistic: 30.76 on 1 and 30 DF,  p-value: 4.983e-06\n\n# Calculate Log Likelihood\nlogLik(model_ols)\n'log Lik.' -109.5206 (df=3)\n```", "```py\n# Multilevel Model with fixed slope and random intercept\nmodel_multi <- lme(fixed = yield ~ endpoint,\n                       random = ~ 1 | Sample,\n                       data = Gasoline,\n                       method = \"REML\")\n\n[OUT]\nLinear mixed-effects model fit by REML\n  Data: Gasoline \n       AIC      BIC   logLik\n  183.4306 189.0354 -87.7153\n\nRandom effects:\n Formula: ~1 | Sample\n        (Intercept) Residual\nStdDev:    8.387862  1.88046\n\nFixed effects:  yield ~ endpoint \n                Value Std.Error DF   t-value p-value\n(Intercept) -33.30626  3.287182 21 -10.13216       0\nendpoint      0.15757  0.005703 21  27.62678       0\n Correlation: \n         (Intr)\nendpoint -0.582\n\nStandardized Within-Group Residuals:\n       Min         Q1        Med         Q3        Max \n-1.6759908 -0.4857902 -0.0397993  0.5128182  1.8518205 \n\nNumber of Observations: 32\nNumber of Groups: 10 \n```", "```py\n# Multilevel Model with random slope and intercept\nmodel_multi2 <- lme(fixed = yield ~ endpoint + vapor,\n                   random = ~ endpoint | Sample,\n                   data = Gasoline,\n                   method = \"REML\")\n\n# Look how the fitted values are presented\n# It is divided in Fixed and the result with the levels\n# \"Sample\" is the final prediction, with the random effects considered\nmodel_multi2$fitted\n\n        fixed     Sample\n1   9.9034036  6.2878876\n2  17.4490277 16.9089759\n3   6.2864457  8.2047743\n4  13.2051879 10.0773886\n5  -0.3240537  6.1951732\n```", "```py\n# Results table\nresults <- data.frame(\n   yield = Gasoline$yield,\n   pred_ols = model_ols$fitted.values,\n   pred_ols2 = model_ols2$fitted.values,\n   pred_multi = model_multi$fitted[,'Sample'],\n   pred_multi2 = model_multi2$fitted[,'Sample']\n\n   yield  pred_ols  pred_ols2 pred_multi pred_multi2\n1    6.9  9.040133 11.2681120  5.8234477   6.2878876\n2   14.4 16.914846 17.8195910 17.5516334  16.9089759\n3    7.4  6.524599  8.0634010  8.6490752   8.2047743\n4    8.5 23.258365 13.5848551  9.9282663  10.0773886\n5    8.0  7.180825  1.9380928  6.1502045   6.1951732\n6    2.8  9.040133 -0.2448399 -0.2263362   0.6677289\n7    5.0 14.508684  5.1154648  5.7778750   5.0504530\n8   12.2  5.759002 13.7816308 12.3278463  11.9321042\n9   10.0 12.540005 13.3171528 10.1678972  10.3006218\n10  15.2 16.149249 20.3249040 16.0654477  16.3795097\n11  26.8 23.477107 26.1797067 27.0057873  27.2203084\n12  14.0 21.727171 17.5245089 13.0730720  13.5617889\n13  14.7 24.789559 15.5355488 12.1342356  12.1958142\n14   6.4 13.414973  5.3285706  6.0764330   6.4725490\n15  17.6 23.258365 16.2622858 18.3834134  18.1474338\n16  22.3 13.414973 23.5350992 23.3576925  23.3378940\n```"]
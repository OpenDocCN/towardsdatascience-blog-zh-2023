["```py\nCREATE TABLE taxi (\n  id varchar,\n  vendor_id integer,\n  pickup_datetime datetime,\n  dropoff_datetime datetime,\n  trip_seconds integer,\n  distance float\n);\n\nINSERT INTO taxi \nVALUES\n('id2875421', 2, '2016-03-14 17:24:55', '2016-03-14 17:32:30', 455, 0.93), \n('id2377394', 1, '2016-06-12 00:43:35', '2016-06-12 00:54:38', 663, 1.12), \n('id3858529', 2, '2016-01-19 11:35:24', '2016-01-19 12:10:48', 2124, 3.97), \n('id3504673', 2, '2016-04-06 19:32:31', '2016-04-06 19:39:40', 429, 0.92), \n('id2181028', 2, '2016-03-26 13:30:55', '2016-03-26 13:38:10', 435, 0.74), \n('id0801584', 2, '2016-01-30 22:01:40', '2016-01-30 22:09:03', 443, 0.68), \n('id1813257', 1, '2016-06-17 22:34:59', '2016-06-17 22:40:40', 341, 0.82), \n('id1324603', 2, '2016-05-21 07:54:58', '2016-05-21 08:20:49', 1551, 3.55), \n('id1301050', 1, '2016-05-27 23:12:23', '2016-05-27 23:16:38', 255, 0.82), \n('id0012891', 2, '2016-03-10 21:45:01', '2016-03-10 22:05:26', 1225, 3.19), \n('id1436371', 2, '2016-05-10 22:08:41', '2016-05-10 22:29:55', 1274, 2.37), \n('id1299289', 2, '2016-05-15 11:16:11', '2016-05-15 11:34:59', 1128, 2.35), \n('id1187965', 2, '2016-02-19 09:52:46', '2016-02-19 10:11:20', 1114, 1.16), \n('id0799785', 2, '2016-06-01 20:58:29', '2016-06-01 21:02:49', 260, 0.62), \n('id2900608', 2, '2016-05-27 00:43:36', '2016-05-27 01:07:10', 1414, 3.97), \n('id3319787', 1, '2016-05-16 15:29:02', '2016-05-16 15:32:33', 211, 0.41), \n('id3379579', 2, '2016-04-11 17:29:50', '2016-04-11 18:08:26', 2316, 2.13), \n('id1154431', 1, '2016-04-14 08:48:26', '2016-04-14 09:00:37', 731, 1.58), \n('id3552682', 1, '2016-06-27 09:55:13', '2016-06-27 10:17:10', 1317, 2.86), \n('id3390316', 2, '2016-06-05 13:47:23', '2016-06-05 13:51:34', 251, 0.81), \n('id2070428', 1, '2016-02-28 02:23:02', '2016-02-28 02:31:08', 486, 1.56), \n('id0809232', 2, '2016-04-01 12:12:25', '2016-04-01 12:23:17', 652, 1.07), \n('id2352683', 1, '2016-04-09 03:34:27', '2016-04-09 03:41:30', 423, 1.29), \n('id1603037', 1, '2016-06-25 10:36:26', '2016-06-25 10:55:49', 1163, 3.03), \n('id3321406', 2, '2016-06-03 08:15:05', '2016-06-03 08:56:30', 2485, 12.82), \n('id0129640', 2, '2016-02-14 13:27:56', '2016-02-14 13:49:19', 1283, 2.84), \n('id3587298', 1, '2016-02-27 21:56:01', '2016-02-27 22:14:51', 1130, 3.77), \n('id2104175', 1, '2016-06-20 23:07:16', '2016-06-20 23:18:50', 694, 2.33), \n('id3973319', 2, '2016-06-13 21:57:27', '2016-06-13 22:12:19', 892, 1.57), \n('id1410897', 1, '2016-03-23 14:10:39', '2016-03-23 14:49:30', 2331, 6.18);\n```", "```py\nSELECT CAST(STRFTIME('%H', pickup_datetime) AS INT) AS hour_of_day, \n       trip_seconds,\n       distance\nFROM taxi\nWHERE pickup_datetime > '2016-01-01'\n  AND pickup_datetime < '2016-04-01'\nORDER BY hour_of_day;\n```", "```py\nWITH relevantrides AS\n(\nSELECT CAST(STRFTIME('%H', pickup_datetime) AS INT) AS hour_of_day, \n       trip_seconds,\n       distance\nFROM taxi\nWHERE pickup_datetime > '2016-01-01'\n  AND pickup_datetime < '2016-04-01'\nORDER BY hour_of_day\n)\nSELECT hour_of_day,\n       COUNT(1) AS num_trips,\n       ROUND(3600 * SUM(distance) / SUM(trip_seconds), 2) AS avg_speed\nFROM relevantrides\nGROUP BY hour_of_day\nORDER BY hour_of_day;\n```", "```py\nSELECT hour_of_day,\n       COUNT(1) AS num_trips,\n       ROUND(3600 * SUM(distance) / SUM(trip_seconds), 2) AS avg_speed\nFROM (\n SELECT CAST(STRFTIME('%H', pickup_datetime) AS INT) AS hour_of_day, \n           trip_seconds,\n           distance\n FROM taxi\n WHERE pickup_datetime > '2016-01-01'\n    AND pickup_datetime < '2016-04-01'\n ORDER BY hour_of_day\n)\nGROUP BY hour_of_day\nORDER BY hour_of_day;\n```", "```py\nSELECT CAST(STRFTIME('%m', pickup_datetime) AS INT) AS month,\n       COUNT(1) AS trip_count,\n       ROUND(SUM(distance), 3) AS total_distance,\n       ROUND(AVG(distance), 3) AS avg_distance,\n       MIN(distance) AS min_distance,\n       MAX(distance) AS max_distance\nFROM taxi\nGROUP BY month;\n```", "```py\nWITH aggregate AS\n(\nSELECT id,\n       pickup_datetime,\n       CAST(STRFTIME('%m', pickup_datetime) AS INT) AS month, \n       distance\nFROM taxi\n)\nSELECT *,\n       COUNT(1) OVER(PARTITION BY month) AS trip_count,\n       ROUND(SUM(distance) OVER(PARTITION BY month), 3) AS total_month_distance,\n       ROUND(AVG(distance) OVER(PARTITION BY month), 3) AS avg_month_distance,\n       MIN(distance) OVER(PARTITION BY month) AS min_month_distance,\n       MAX(distance) OVER(PARTITION BY month) AS max_month_distance\nFROM aggregate;\n```", "```py\nWITH ranking AS\n(\nSELECT id,\n       pickup_datetime,\n       CAST(STRFTIME('%m', pickup_datetime) AS INT) AS month, \n       distance\nFROM taxi\n)\nSELECT *,\n       RANK() OVER(ORDER BY distance DESC) AS overall_rank,\n       RANK() OVER(PARTITION BY month ORDER BY distance DESC) AS month_rank\nFROM ranking\nORDER BY pickup_datetime;\n```", "```py\nSELECT id,\n       pickup_datetime,\n       distance,\n       LAG(distance) OVER(ORDER BY pickup_datetime) AS prev_distance,\n       LEAD(distance) OVER(ORDER BY pickup_datetime) AS next_distance\nFROM taxi\nORDER BY pickup_datetime;\n```", "```py\nSELECT id,\n       pickup_datetime,\n       distance,\n       LAG(distance, 2) OVER(ORDER BY pickup_datetime) AS prev_distance,\n       LEAD(distance, 2) OVER(ORDER BY pickup_datetime) AS next_distance\nFROM taxi\nORDER BY pickup_datetime;\n```"]
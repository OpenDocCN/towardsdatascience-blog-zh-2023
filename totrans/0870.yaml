- en: What is the Negative Binomial Distribution
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/failures-trials-and-successes-the-negative-binomial-distribution-explained-944ea2aef936](https://towardsdatascience.com/failures-trials-and-successes-the-negative-binomial-distribution-explained-944ea2aef936)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A dive into one of the lesser known probability distributions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@egorhowell?source=post_page-----944ea2aef936--------------------------------)[![Egor
    Howell](../Images/1f796e828f1625440467d01dcc3e40cd.png)](https://medium.com/@egorhowell?source=post_page-----944ea2aef936--------------------------------)[](https://towardsdatascience.com/?source=post_page-----944ea2aef936--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----944ea2aef936--------------------------------)
    [Egor Howell](https://medium.com/@egorhowell?source=post_page-----944ea2aef936--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----944ea2aef936--------------------------------)
    ·5 min read·Aug 17, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/de00aa6fcf673800a6d98b7c1af5ff49.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Alperen Yazgı](https://unsplash.com/@armato?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Perhaps you have heard of the [**binomial distribution**](https://pub.towardsai.net/decoding-the-binomial-distribution-a-fundamental-concept-for-data-scientists-81c64c7e4580),
    but have you heard of its cousin the [**negative binomial distribution**](https://en.wikipedia.org/wiki/Negative_binomial_distribution)?
    This discrete probability distribution is applied in numerous industries such
    as insurance and manufacturing (mainly count-based data), hence is a useful concept
    for Data Scientists to understand. In this article, we will dive into this distribution
    and what problems it can solve.
  prefs: []
  type: TYPE_NORMAL
- en: Supplemental Video.
  prefs: []
  type: TYPE_NORMAL
- en: What is the Negative Binomial Distribution?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To understand the negative binomial distribution, it’s important to gain intuition
    about the binomial distribution.
  prefs: []
  type: TYPE_NORMAL
- en: 'The binomial distribution measures the probability of measuring a certain number
    of successes, ***x***, in a given number of trials, ***n***. The trials in this
    case are [**Bernoulli**](https://en.wikipedia.org/wiki/Bernoulli_trial) trials,
    where every outcome is binary (success or failure). If you are unfamiliar with
    the binomial distribution, check out my previous post on it here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://pub.towardsai.net/decoding-the-binomial-distribution-a-fundamental-concept-for-data-scientists-81c64c7e4580?source=post_page-----944ea2aef936--------------------------------)
    [## Decoding the Binomial Distribution: A Fundamental Concept for Data Scientists'
  prefs: []
  type: TYPE_NORMAL
- en: Understanding the basic building blocks of the binomial distribution
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: pub.towardsai.net](https://pub.towardsai.net/decoding-the-binomial-distribution-a-fundamental-concept-for-data-scientists-81c64c7e4580?source=post_page-----944ea2aef936--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: The negative binomial distribution flips this and models the number of trials,
    ***x***, needed to reach a certain number of successes, ***r***. This is why it
    is known as ‘negative’ because it is inadvertently modeling the number of failures
    before the certain number of successes.
  prefs: []
  type: TYPE_NORMAL
- en: 'A better way of thinking about the negative distribution is:'
  prefs: []
  type: TYPE_NORMAL
- en: Probability of the “***r”*** success happening on the “***x”*** trial
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'A special case of the negative binomial distribution is the [**geometric distribution**](https://medium.com/towards-data-science/geometric-distribution-simply-explained-9177c816794f).
    This models the number of trials needed before we get our first success. You can
    read more about the geometric distribution here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/geometric-distribution-simply-explained-9177c816794f?source=post_page-----944ea2aef936--------------------------------)
    [## Geometric Distribution Simply Explained'
  prefs: []
  type: TYPE_NORMAL
- en: A simple description and uses of the Geometric distribution
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/geometric-distribution-simply-explained-9177c816794f?source=post_page-----944ea2aef936--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Key Assumptions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are the main assumptions of the data for the negative binomial
    distribution:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Two outcomes per trial (Bernoulli)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Each trial is independent*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*The probability of success is constant*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Formula & Derivation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let’s say we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '***p:*** *probability of success*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***1-p:*** *the probability of failure*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***x:*** *number trials for* ***r*** *success*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***r****: number of successes for* ***x*** *trials*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Consequently, we must have ***r-1*** successes in ***x-1*** trials and the
    probability of this is simply the binomial distribution [**probability mass function
    (PMF)**](https://en.wikipedia.org/wiki/Probability_mass_function):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/56fbfccb2c6dab8f87ad03e5323fb345.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'The next bit of information we have is that the ***r*** success must occur
    on ***x*** trial, and it will have a probability of ***p.*** Therefore, we simply
    multiply the above formula by ***p***:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/52cfd2cdf0b6a2f406b052562e618eb5.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: That’s the negative binomial distribution’s PMF!
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The mean of the distribution can be shown to be:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f45964ad3e048b7bb9a8f6b1e44ef333.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: Derivation of the mean and standard deviation can be found [here](https://online.stat.psu.edu/stat414/lesson/11/11.5)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Example Problem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: What would be the probability of rolling a second 4 on the 6th roll?
  prefs: []
  type: TYPE_NORMAL
- en: '***p = 1/6***'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***r = 2***'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***x = 6***'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Inputting these into the above PMF leads to:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/68ad78f0fc16be61ddac5dcffb887f11.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: So, it is quite unlikely that we will get our second 4 on the 6th roll. You
    can also try out some of your calculations with [this negative binomial calculator](https://stattrek.com/online-calculator/negative-binomial).
  prefs: []
  type: TYPE_NORMAL
- en: 'What about if we want to know the probability of rolling our second 4 on other
    rolls? Well, to do this we need to plot the second roll as a function of the number
    of rolls, ***x***:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/64363ae45aee5cadfa09851d6d00c84c.png)'
  prefs: []
  type: TYPE_IMG
- en: Plot generated by author in Python.
  prefs: []
  type: TYPE_NORMAL
- en: We see that the most likely roll to obtain our our second 4 roll 6 and 7\. However,
    the expected value is 12 (2/(1/6)), which can be derived from the formula we showed
    earlier.
  prefs: []
  type: TYPE_NORMAL
- en: Applications in Data Science
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Below is a list of areas where the negative binomial distribution is used:'
  prefs: []
  type: TYPE_NORMAL
- en: '***Time until an event****: This is useful for churn models, where we want
    to predict when a customer may cancel their subscription. If we know when and
    who will churn, we can apply specialised retention strategies to try and keep
    the customer.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***Defect prediction:*** *Predicting the number of defects in a manufactured
    product before it becomes fully functional. You can think of this as how many
    versions of the product to make before we reach a final proposal.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***Sports Analytics:*** *There are several examples such as predicting after
    how many missed shots will a footballer score a goal. This is useful for betting
    companies to produce their odds.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***Marketing****: Determine how many advertisements to show a customer before
    they convert onto a subscription or click on the website. This is predicting conversion
    rates.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***Epidemiology:*** *Estimating the volume of endangered species and how the
    environment is affecting their numbers.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary & Further Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The negative binomial distribution models the probability of a certain number
    of failures it takes to reach a certain number of successes. This has applications
    in many areas of data science, the most notable being churn prediction. Hence,
    it is a useful topic for Data Scientists to understand.
  prefs: []
  type: TYPE_NORMAL
- en: 'The full code is available on my GitHub here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/Distributions/negative_binomial.py?source=post_page-----944ea2aef936--------------------------------)
    [## Medium-Articles/Statistics/Distributions/negative_binomial.py at main · egorhowell/Medium-Articles'
  prefs: []
  type: TYPE_NORMAL
- en: Code I use in my medium blog/articles. Contribute to egorhowell/Medium-Articles
    development by creating an account on…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/Distributions/negative_binomial.py?source=post_page-----944ea2aef936--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: References & Further Reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Great video on the negative binomial distribution.*](https://www.youtube.com/watch?v=BPlmjp2ymxw)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Great summary article on the negative binomial distribution.*](https://statisticsbyjim.com/probability/negative-binomial-distribution/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Applications of the distribution.*](https://onlinelibrary.wiley.com/doi/abs/10.1002/9781118445112.stat07353)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Another Thing!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have a free newsletter, [**Dishing the Data**](https://dishingthedata.substack.com/),
    where I share weekly tips for becoming a better Data Scientist. There is no “fluff”
    or “clickbait,” just pure actionable insights from a practicing Data Scientist.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://newsletter.egorhowell.com/?source=post_page-----944ea2aef936--------------------------------)
    [## Dishing The Data | Egor Howell | Substack'
  prefs: []
  type: TYPE_NORMAL
- en: How To Become A Better Data Scientist. Click to read Dishing The Data, by Egor
    Howell, a Substack publication with…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: newsletter.egorhowell.com](https://newsletter.egorhowell.com/?source=post_page-----944ea2aef936--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Connect With Me!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**YouTube**](https://www.youtube.com/@egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**LinkedIn**](https://www.linkedin.com/in/egor-howell-092a721b3/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Twitter**](https://twitter.com/EgorHowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**GitHub**](https://github.com/egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

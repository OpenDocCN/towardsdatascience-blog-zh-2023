["```py\ndef preprocess(text):\n    output = clean(str(text), punct=True,\n                              extra_spaces=True,\n                              stopwords=True,\n                              lowercase=True,\n                              numbers = True)\n    return output\n```", "```py\ndata_clean = data.with_columns([\n    pl.col(\"headline\").apply(preprocess)\n])\n```", "```py\nfrom vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer\n\n# calculate the compound score\ndef sentiment_vader(sentence):\n\n    # create a SentimentIntensityAnalyzer object\n    sid_obj = SentimentIntensityAnalyzer()\n\n    sentiment_dict = sid_obj.polarity_scores(sentence)\n\n    # create overall (compound) indicator\n    compound = sentiment_dict['compound']\n\n    return compound\n```", "```py\n# apply the function with Polars\n\nsentiment = data_clean.with_columns([\n    pl.col(\"headline\").apply(sentiment_vader)\n])\n```", "```py\n# aggregate over months\n\ntimeseries = (sentiment.lazy()\n    .groupby(\"date_monthly\")\n    .agg(\n        [\n            pl.avg(\"headline\")\n        ]\n    ).sort(\"date_monthly\")\n).collect()\n```"]
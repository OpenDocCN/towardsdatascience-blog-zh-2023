- en: A Bayesian Comparison of School Leaver Outcomes with R and brms
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/a-bayesian-comparison-of-school-leaver-outcomes-with-r-and-brms-4da9ae5f9895](https://towardsdatascience.com/a-bayesian-comparison-of-school-leaver-outcomes-with-r-and-brms-4da9ae5f9895)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ANOVA — Bayesian Style
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://mmgillin.medium.com/?source=post_page-----4da9ae5f9895--------------------------------)[![Murray
    Gillin](../Images/40619967eb8911fa1d651503143b940c.png)](https://mmgillin.medium.com/?source=post_page-----4da9ae5f9895--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4da9ae5f9895--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4da9ae5f9895--------------------------------)
    [Murray Gillin](https://mmgillin.medium.com/?source=post_page-----4da9ae5f9895--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4da9ae5f9895--------------------------------)
    ·9 min read·Sep 2, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: Much is made of what we want to do when we leave school. We get asked as young
    children what we want to do when we grow up, and then proceed to spend 13 years
    in pre-Tertiary education. In public policy, much is made around the differences
    between the Government, Catholic, and Independent school systems, particularly
    when it comes to public funding of non-Government schools, and how resources should
    be allocated.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Is there any real difference between student outcomes given the school sector?
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: In Victoria, Australia, the State Government conduct an annual survey to gauge
    post-High School outcomes ([On Track Survey](https://www.vic.gov.au/on-track-survey)).
    This [dataset](https://www.education.vic.gov.au/Documents/about/research/OnTrack2022/DestinationData2022.xlsx)
    (available under [CC BY 4.0](https://discover.data.vic.gov.au/dataset/2021-on-track-survey-year-12-or-equivalent-completers-post-school-destinations))
    is available across several years, and we’ll only look at the most recent available
    as of the authoring of this article, 2021.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: This article will seek to answer these questions applying Bayesian analysis
    methodologies, using the R package brms.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6fc796bd31faf209865d27bb584ba25e.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
- en: Photo by [Good Free Photos](https://unsplash.com/@goodfreephoto_com?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: Load Libraries and Dataset
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Below we load our required packages, the dataset is a presented in a wide report
    format, with many merged cells. R doesn’t like this so we have do a bit of hard
    coding to relabel vectors and create a tidy data frame.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Here is an sample of what our dataset looks like.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1ccd7662031c28dd6e88a6f2d57f646a.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
- en: Sample of initial data frame (Image by Author)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: The dataset has 14 fields.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: VCAA Code — Administrative ID for each code
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: School Name
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sector — G = Government, C = Catholic & I = Independent
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Locality or Suburb
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Total Students Completing Year 12
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: On Track Consenters
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Respondents
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rest of Columns Represent the Percentage of Respondents for Each Outcome
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For the purposes of our cross-sectional study we are interested in the outcome
    proportions by sector, and thus we need to convert this wide data frame into a
    long format.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/34a43ed27ee0827c6e86eff03616b07b.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
- en: Long data frame with features of interest (Image by Author)
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: Exploratory Data Analysis
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s briefly visualize and summarize our dataset. The government sector has
    157, Independent has 57, and Catholic has 50 schools listed in this dataset.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/20762b69934621cc85f2422c8ca4d97b.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
- en: Count of Schools by Sector (Image by Author)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](../Images/f5bf8f3f68291ad4b44eb969e0e34a63.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
- en: Distribution of Proportions by Sector and Outcome (Image by Author)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: The distributions tell an interesting story. Bachelors outcome shows the greatest
    variability across all sectors, with Independent schools having the greatest median
    student proportion electing to pursue undergraduate education. Interesting to
    note that Government schools have the highest median proportion of students going
    on to employment after completing high school. All other outcomes don’t vary too
    much — we’ll revisit this soon.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: Statistical Modelling — Beta Likelihood Regression
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We’re focused on proportions of students by school and their outcomes after
    high school graduation. A beta likelihood is our best bet in these instances.
    brms is a brilliant package by [Buerkner](https://github.com/paul-buerkner/brms)
    to develop Bayesian models. Our goal is to model the distribution of proportions
    by outcome and sector.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: Beta regression models two parameters, μ and φ. μ represents the mean proportion,
    and φ is a measure of precision (or variance).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: Our first model is represented below, note we are already starting with an interaction
    between Sector and Outcome because this is the question we want the model to answer,
    and hence this is an ANOVA model.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: We are asking the model to create individual Beta terms for each combination
    of Sector and Outcome, with a pooled φ term, or model different proportion means
    with the same variance. We expect 50% of these proportions to sit between (-3,
    1) on the logit scale or (0.01, 0.73) as proportions. This is sufficiently wide
    but informed prior. The global Phi estimate is a positive number, so we use a
    gamma distribution that is sufficiently wide.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/605ad780bfee25e35dc12016ea0901e1.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
- en: Mathematical Form for Model m3a — Image by Author
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/2aa048487686b66516cd8319ac344acd.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
- en: Output Summary for Model m3a — Image By Author
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: Note in the model setup we’ve added a 1% increment to all proportions — this
    is because Beta regression does not handle zero-values. We attempted to model
    this with zero inflated beta but it took much longer to converge.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, we can model without a pooled phi, this intuitively makes sense given
    what we observed in the distributions above, there is variation amongst each of
    the sector and outcome combinations. The model is defined below.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/4c3ae4b71c27ca103dea911705457625.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
- en: Output Summary for m3b — Image by Author
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: Model Diagnostics and Comparison
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With two models in hand, we’ll now compare their out of sample predictive accuracy
    using Bayesian LOO estimate of the expected log pointwise predictive density (elpd_loo).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/293a97d27e01605fbce03850aef25b20.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
- en: LOO Comparison of Models m3a and m3b — Image by Author
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: Simply put, the higher the expected logpoint wise leave one out value is, the
    greater the predictive accuracy on unseen data. This gives us a good *relative*
    measure of model accuracy between models. We can further check this by completing
    a posterior predictive check, a comparison of observed and simulated values. In
    our case, model m3b is the better models the observed data.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/243b0d7ed1a73032126516a309e5593a.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
- en: Posterior Predictive Check for Model m3a — Image by Author
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2df487150626b39439d35cf33846e553.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
- en: Posterior Predictive Check for Model m3b — Image by Author
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
- en: Model m3b given it’s non-pooled variance or phi term is capable of better capturing
    the variation in proportion distributions by sector and outcome.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: ANOVA — Bayesian Style
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Recall, our research question is about seeking to understand if there are differences
    in outcomes amongst sectors and by how much. In frequentist statistics, we might
    use ANOVA, a difference of means approach between groups. The weakness of this
    approach is that the results provide an estimate and a confidence interval, without
    sense of uncertainty about these estimates, and a counterintuitive p-value stating
    whether or not the difference in means is statistically significant. No, thank
    you.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: Below we generate a set of expected values for each sector and outcome combination
    interaction, then use the excellent tidybayes::compare_levels() function that
    performs the heavy lifting. It computes the difference in posterior means between
    sector for each outcome. We excluded the ‘other’ outcome for sake of brevity.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/2b475e080761cff5c4b94118e79e144f.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
- en: Bayesian ANOVA — Image by Author
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: Alternatively we can summarise all these distributions with a neat table for
    easier interpretation and a 89% credible interval.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/02d71896f3b75822fd1ef70d259568e5.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
- en: Summary Table of Difference in Posterior Means by Sector and Outcome with 89%
    Credible Interval— Image by Author
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: For example if we were to summarise a comparison in a formal report we might
    write the following.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: Students in Government schools are less likely to begin undergraduate degrees
    then their counterparts in Catholic and Independent Schools post-VCE completion.
  id: totrans-78
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-79
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: On average, 42.5% (between 39.5% and 45.6%) of Government school students, 53.2%
    (between 47.7% and 58.4%) of Catholic school students and 65% (between 60.1% and
    69.7%) of Independent school students begin undergraduate education after completion
    of Year 12 students.
  id: totrans-80
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 平均而言，42.5%（介于39.5%和45.6%之间）的政府学校学生，53.2%（介于47.7%和58.4%之间）的天主教学校学生和65%（介于60.1%和69.7%之间）的独立学校学生在完成12年级后开始接受本科教育。
- en: ''
  id: totrans-81
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: There is an 89% posterior probability that the difference between Catholic and
    Government student undergraduate enrolment is between 5.6% and 15.7% with a mean
    of 10.7%. Additionally, the difference between Independent and Government student
    undergraduate enrolment is between 17.8% and 27% with a mean of 22.5%.
  id: totrans-82
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在89%的后验概率下，天主教学校与政府学校学生本科入学的差异在5.6%到15.7%之间，平均值为10.7%。此外，独立学校与政府学校学生本科入学的差异在17.8%到27%之间，平均值为22.5%。
- en: ''
  id: totrans-83
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: These differences are substantial, and there’s a 100% chance that these differences
    are not zero.
  id: totrans-84
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这些差异是显著的，差异不为零的概率为100%。
- en: Summary and Conclusion
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结与结论
- en: In this article we have demonstrated how to model proportional data using a
    Beta likelihood function using Bayesian modelling, and then perform Bayesian ANOVA
    to explore the differences in proportional outcomes between sectors.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在本文中，我们展示了如何使用贝塔似然函数和贝叶斯建模来建模比例数据，然后执行贝叶斯方差分析（ANOVA）以探索不同部门之间比例结果的差异。
- en: We have not sought to create a causal understanding of these differences. One
    can imagine that there are several factors that influence how individual students
    perform, socioeconomic background, parents educational attainment, in addition
    to impacts at school level, resourcing etc. It’s an incredibly complex area of
    public policy that can often get bogged down in zero-sum rhetoric.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们没有试图创建这些差异的因果理解。可以想象，有几个因素影响个体学生的表现，包括社会经济背景、父母的教育水平，以及学校层面的影响、资源等。这是一个极其复杂的公共政策领域，常常被零和博弈的
    rhetoric 所困扰。
- en: Personally, I’m the first person in my extended family to attend and complete
    tertiary education. I went to a middle band public high school and achieved reasonably
    good scores to gain entrance into my first preference. My parents encouraged me
    to pursue education, both electing to leave school at the age of 16\. Whilst this
    article provides evidence that the difference between Government and Non-Government
    schools is real, it is purely descriptive in nature.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 就个人而言，我是我大家庭中第一个接受并完成高等教育的人。我上了一所中等水平的公立高中，并取得了相当不错的成绩，顺利进入了我首选的学校。我的父母鼓励我继续接受教育，他们在16岁时选择了辍学。虽然本文提供了政府学校和非政府学校之间差异的证据，但它本质上只是描述性的。

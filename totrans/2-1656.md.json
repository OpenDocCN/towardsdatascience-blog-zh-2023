["```py\nSELECT \n    *,\n    SUM(\"PlayTime\") OVER UserLevelWindow AS \"time_spent_on_level\",\n    (a.\"Max_Level\" - a.\"Min_Level\") AS \"levels_completed_in_last_7_days\",\n    COALESCE(CAST(\"total_wins_in_last_14_days\" AS DECIMAL)/NULLIF(\"total_losses_in_last_14_days\", 0), 0.0) AS \"win_to_lose_ratio_in_last_14_days\",\n    COALESCE(SUM(\"UsedCoins\") OVER User1DayWindow, 0) AS \"UsedCoins_in_last_1_days\",\n    COALESCE(SUM(\"UsedCoins\") OVER User7DayWindow, 0) AS \"UsedCoins_in_last_7_days\",\n    COALESCE(SUM(\"UsedCoins\") OVER User14DayWindow, 0) AS \"UsedCoins_in_last_14_days\",\n    COALESCE(SUM(\"ExtraMoves\") OVER User1DayWindow, 0) AS \"ExtraMoves_in_last_1_days\",\n    COALESCE(SUM(\"ExtraMoves\") OVER User7DayWindow, 0) AS \"ExtraMoves_in_last_7_days\",\n    COALESCE(SUM(\"ExtraMoves\") OVER User14DayWindow, 0) AS \"ExtraMoves_in_last_14_days\",\n    AVG(\"RollingLosses\") OVER User7DayWindow AS \"RollingLosses_mean_last_7_days\",\n    AVG(\"MaxLevel\") OVER PastWindow AS \"MaxLevel_mean\"\nFROM (\n    SELECT\n        *,\n        MAX(\"Level\") OVER User7DayWindow AS \"Max_Level\",\n        MIN(\"Level\") OVER User7DayWindow AS \"Min_Level\",\n        SUM(CASE WHEN \"EndType\" = 'Lose' THEN 1 ELSE 0 END) OVER User14DayWindow AS \"total_losses_in_last_14_days\",\n        SUM(CASE WHEN \"EndType\" = 'Win' THEN 1 ELSE 0 END) OVER User14DayWindow AS \"total_wins_in_last_14_days\",\n        SUM(\"PlayTime\") OVER User7DayWindow AS \"PlayTime_cumul_7_days\",\n        SUM(\"RollingLosses\") OVER User7DayWindow AS \"RollingLosses_cumul_7_days\",\n        SUM(\"PlayTime\") OVER UserPastWindow AS \"PlayTime_cumul\"\n    FROM \"game_data_levels\"\n    WINDOW\n        User7DayWindow AS (\n            PARTITION BY \"UserID\"\n            ORDER BY \"ServerTime\"\n            RANGE BETWEEN INTERVAL '7' DAY PRECEDING AND CURRENT ROW\n        ),\n        User14DayWindow AS (\n            PARTITION BY \"UserID\"\n            ORDER BY \"ServerTime\"\n            RANGE BETWEEN INTERVAL '14' DAY PRECEDING AND CURRENT ROW\n        ),\n        UserPastWindow AS (\n        PARTITION BY \"UserID\"\n        ORDER BY \"ServerTime\"\n        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        )\n) AS a\nWINDOW\n    UserLevelWindow AS (\n        PARTITION BY \"UserID\", \"Level\"\n        ORDER BY \"ServerTime\"\n        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ),\n    PastWindow AS (\n        ORDER BY \"ServerTime\"\n        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ),\n    User1DayWindow AS (\n        PARTITION BY \"UserID\" \n        ORDER BY \"ServerTime\" \n        RANGE BETWEEN INTERVAL '1' DAY PRECEDING AND CURRENT ROW\n    ),\n    User7DayWindow AS (\n        PARTITION BY \"UserID\"\n        ORDER BY \"ServerTime\"\n        RANGE BETWEEN INTERVAL '7' DAY PRECEDING AND CURRENT ROW\n    ),\n    User14DayWindow AS (\n        PARTITION BY \"UserID\"\n        ORDER BY \"ServerTime\"\n        RANGE BETWEEN INTERVAL '14' DAY PRECEDING AND CURRENT ROW\n    )\nORDER BY \"ServerTime\";\n```", "```py\n┌─────────────────────────────────────────────────────────┬───────────┐\n│                         Model                           │ AUC (ROC) │\n├─────────────────────────────────────────────────────────┼───────────┤\n│ [Original features](https://app.actable.ai/r/C3FLuD7jpJY2NaV2VLdKDg)                                       │     0.675 │\n│ [Original features + optim. for quality](https://app.actable.ai/r/ze61cu96uA3ZKApZgUCztA)                  │     0.709 │\n│ [Engineered features](https://app.actable.ai/r/GDfT0fXaMmYO-5cmt-XxZA)                                     │     0.918 │\n│ [Engineered features + optim. for quality + longer time](https://app.actable.ai/r/G8frdBHCjbl9twVSTKuP8w)  │     0.923 │\n└─────────────────────────────────────────────────────────┴───────────┘\n```"]
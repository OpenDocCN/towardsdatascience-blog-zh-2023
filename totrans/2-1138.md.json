["```py\nimport pandas as pd \nimport numpy as np\nimport matplotlib.pyplot as plt \nfrom matplotlib.colors import ListedColormap\nimport seaborn as sns \nfrom matplotlib.patches import Patch\nfrom matplotlib.lines import Line2D\nfrom matplotlib.patches import Rectangle\n```", "```py\ndf = pd.read_csv('Bacterial_strain_heatmap_tutorial_data.csv').set_index('Strain')\ndf.head()\n```", "```py\namr_columns_to_extract = ['OqxA', 'OqxB', 'emrAB', 'nfsA', 'nfsB', 'MexAB-OprM',\n       'mdt Efflux pump genes','blaSHV-28', 'blaSHV-148', 'aac(3)-IId', 'aac(3)-IIe',\n       \"aac(6')-Ib-cr\", \"strA\", \"strB\", 'blaCTX-M-14',\n       'blaCTX-M-15', 'blaLAP-2', 'blaOXA-1', 'blaTEM-1B', 'dfrA1', 'dfrA14',\n       'qnrB1', 'qnrS1', 'sul1', 'sul2', 'tet(A)']\n\nvirulence_columns_to_extract = ['clpK', 'traT',\n       'fecIRABCDE', 'acrAB', 'acrREF', 'mrkD', 'iutA', 'entABCDEFHS', 'treC',\n       'pgaABC', 'ureDABCEFG']\n\ncapsule_type = ['Capsule K2', 'Capsule K3','Capsule K123']\n```", "```py\ncmap_dict = {0: '#E9EEEC', 1: '#6B83A9',2: '#868B89'}\ncmap = ListedColormap([cmap_dict[i] for i in range(0,3)])\n\ncmap_dict_2 = {3: '#D43B34', 4: '#79D170',5: '#E9EEEC'}\ncmap2 = ListedColormap([cmap_dict_2[i] for i in range(3,6)])\n```", "```py\nfig = plt.figure(figsize=(15, 4))\n\nax1 = plt.subplot2grid((1, 12), (0, 0), colspan=6)\nax2 = plt.subplot2grid((1, 12), (0, 6), colspan=3)\nax3 = plt.subplot2grid((1, 12), (0, 9), colspan=2)\n```", "```py\nfig = plt.figure(figsize=(15, 4))\n\nax1 = plt.subplot2grid((1, 12), (0, 0), colspan=6)\nax2 = plt.subplot2grid((1, 12), (0, 6), colspan=3)\nax3 = plt.subplot2grid((1, 12), (0, 9), colspan=2)\n\nax1.set_title('Antimicrobial resistance genes',size=12, pad=30, fontname='Ubuntu')\n\nax1 = sns.heatmap(df[amr_columns_to_extract], cmap=cmap, cbar=False,linewidths=0.4, \n                  linecolor='black', alpha=0.8, ax=ax1)\n\nfor tick in ax1.get_xticklabels():\n    tick.set_fontname('Ubuntu')\n    tick.set_style('italic')\nax1.tick_params(axis='x', labelsize=10.5)\n\nfor tick in ax1.get_yticklabels():\n    tick.set_fontname('Ubuntu')\nax1.tick_params(axis='y', labelsize=10.5)\n\nax1.set_ylabel(\"Strain\\n\", fontname='Ubuntu', fontsize=14)\n\nlegend_elements = [ Patch(facecolor='#868B89', edgecolor='#323436',\n                         label='Present on chromosome'),\n                   Patch(facecolor='#6B83A9', edgecolor='#323436',\n                         label='Present on plasmid'),\n                  Patch(facecolor='#D43B34', edgecolor='#323436',\n                         label='Capsule K1'),\n                  Patch(facecolor='#79D170', edgecolor='#323436',\n                         label='Capsule K2/K57'),\n                  Patch(facecolor='#E9EEEC', edgecolor='#323436',\n                         label='Absent')]\n\nax1.legend(handles=legend_elements, \n          bbox_to_anchor=[0.9, -0.7], \n          title='Strain key', \n          ncol=5,\n          frameon=False,\n          prop={'size': 12, 'family': 'Ubuntu'},\n          title_fontsize=12,\n          handleheight=3, \n          handlelength=3,\n          handletextpad=0.5,\n          labelspacing=1.2,\n          loc='center')\n\nax1.axhline(y=0, color='k',linewidth=3)\nax1.axhline(y=df[amr_columns_to_extract].shape[1], color='k',linewidth=3)\nax1.axvline(x=0, color='k',linewidth=3)\nax1.axvline(x=df[amr_columns_to_extract].shape[1], color='k',linewidth=3); \n```", "```py\nax2 = sns.heatmap(df[virulence_columns_to_extract], cmap=cmap, cbar=False,linewidths=0.4, \n                  linecolor='black', alpha=0.8, ax=ax2)\n\nax2.set_title('Virulence genes',size=12, pad=30, fontname='Ubuntu')\n\nfor tick in ax2.get_xticklabels():\n    tick.set_fontname('Ubuntu')\n    tick.set_style('italic')\nax2.tick_params(axis='x', labelsize=10.5)\n\nfor tick in ax2.get_yticklabels():\n    tick.set_visible(False)\n\nax2.tick_params(left=False)\nax2.set_ylabel('')    \n\nax2.axhline(y=0, color='k',linewidth=3)\n\nax2.axvline(x=0, color='k',linewidth=3)\nax2.axvline(x=df[virulence_columns_to_extract].shape[1], color='k',linewidth=3); \n```", "```py\nax3 = sns.heatmap(df[capsule_type], cmap=cmap2, cbar=False,linewidths=0.4, \n                  linecolor='black', alpha=0.8, ax=ax3)\n\nax3.set_title('Capsule type',size=12, pad=30, fontname='Ubuntu')\n\nfor tick in ax3.get_xticklabels():\n    tick.set_fontname('Ubuntu')\n    tick.set_style('italic')\nax3.tick_params(axis='x', labelsize=10.5)\n\nfor tick in ax3.get_yticklabels():\n    tick.set_visible(False)\n\nax3.tick_params(left=False)\nax3.set_ylabel('')\n\nax3.axvline(x=0, color='k',linewidth=3)\nax3.axvline(x=df[capsule_type].shape[1], color='k',linewidth=3); \n```"]
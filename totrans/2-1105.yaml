- en: How to Improve Your Code Quality with Python Pre-Commit Hooks?
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¦‚ä½•é€šè¿‡ Python é¢„æäº¤é’©å­æå‡ä»£ç è´¨é‡ï¼Ÿ
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/how-to-automate-code-quality-with-python-pre-commit-hooks-e550debbd62e](https://towardsdatascience.com/how-to-automate-code-quality-with-python-pre-commit-hooks-e550debbd62e)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/how-to-automate-code-quality-with-python-pre-commit-hooks-e550debbd62e](https://towardsdatascience.com/how-to-automate-code-quality-with-python-pre-commit-hooks-e550debbd62e)
- en: Commit your code with peace of mind
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å®‰å¿ƒæäº¤ä½ çš„ä»£ç 
- en: '[](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)[![Ahmed
    Besbes](../Images/93804d9291439715e578f204b79c9bdd.png)](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)
    [Ahmed Besbes](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)[![Ahmed
    Besbes](../Images/93804d9291439715e578f204b79c9bdd.png)](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)
    [Ahmed Besbes](https://ahmedbesbes.medium.com/?source=post_page-----e550debbd62e--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)
    Â·7 min readÂ·Jul 22, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e550debbd62e--------------------------------)
    Â·7 åˆ†é’Ÿé˜…è¯»Â·2023å¹´7æœˆ22æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/e3c1be9eec7e621417f6b1786fbe9dd9.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e3c1be9eec7e621417f6b1786fbe9dd9.png)'
- en: Photo by [Roman Synkevych](https://unsplash.com/@synkevych?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[Roman Synkevych](https://unsplash.com/@synkevych?utm_source=medium&utm_medium=referral)
    çš„ç…§ç‰‡ï¼Œæ¥è‡ª [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)'
- en: If youâ€™re a Python developer, you may frequently come across situations where
    your team members have different coding styles that make the codebase inconsistent.
    As a result, **this leads to bugs, decreases productivity**, and **makes collaboration
    difficult**.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ˜¯ Python å¼€å‘è€…ï¼Œä½ å¯èƒ½ç»å¸¸é‡åˆ°å›¢é˜Ÿæˆå‘˜æœ‰ä¸åŒçš„ç¼–ç é£æ ¼ï¼Œè¿™ä½¿å¾—ä»£ç åº“ä¸ä¸€è‡´ã€‚å› æ­¤ï¼Œ**è¿™ä¼šå¯¼è‡´é”™è¯¯ï¼Œé™ä½ç”Ÿäº§åŠ›**ï¼Œå¹¶ä¸”**ä½¿åˆä½œå˜å¾—å›°éš¾**ã€‚
- en: As someone who strives to maintain code quality, I know how painful this situation
    can be.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºä¸€ä¸ªåŠªåŠ›ä¿æŒä»£ç è´¨é‡çš„äººï¼Œæˆ‘çŸ¥é“è¿™ç§æƒ…å†µæœ‰å¤šä¹ˆç—›è‹¦ã€‚
- en: 'ğŸ‘‰ There is fortunately a solution that solves this issue: **pre-commit hooks**.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ‘‰ å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š**é¢„æäº¤é’©å­**ã€‚
- en: Pre-commit hooks are scripts or tools that run before you make a commit to your
    version control system. They can automatically format your code, run tests, check
    for linting errors, and much more.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æäº¤é’©å­æ˜¯æäº¤ä»£ç åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¹‹å‰è¿è¡Œçš„è„šæœ¬æˆ–å·¥å…·ã€‚å®ƒä»¬å¯ä»¥è‡ªåŠ¨æ ¼å¼åŒ–ä½ çš„ä»£ç ï¼Œè¿è¡Œæµ‹è¯•ï¼Œæ£€æŸ¥ lint é”™è¯¯ç­‰ç­‰ã€‚
- en: I started using pre-commit hooks in both my personal and professional projects.
    They have helped me catch and fix potential issues early on, ensuring that my
    code is always clean and consistent. Plus, they have saved me a lot of time and
    effort by automating repetitive tasks.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¼€å§‹åœ¨ä¸ªäººå’Œä¸“ä¸šé¡¹ç›®ä¸­ä½¿ç”¨é¢„æäº¤é’©å­ã€‚å®ƒä»¬å¸®åŠ©æˆ‘æ—©æœŸå‘ç°å¹¶ä¿®å¤æ½œåœ¨é—®é¢˜ï¼Œç¡®ä¿æˆ‘çš„ä»£ç å§‹ç»ˆå¹²å‡€å’Œä¸€è‡´ã€‚æ­¤å¤–ï¼Œå®ƒä»¬é€šè¿‡è‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡ä¸ºæˆ‘èŠ‚çœäº†å¤§é‡æ—¶é—´å’Œç²¾åŠ›ã€‚
- en: In ***this practical blog post, we will dive into this topic. We will explore
    how to set pre-commits, customize them to suit your needs, and integrate them
    into your development workflow.***
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åœ¨***è¿™ç¯‡å®ç”¨çš„åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è¿™ä¸ªè¯é¢˜ã€‚æˆ‘ä»¬å°†æ¢ç´¢å¦‚ä½•è®¾ç½®é¢„æäº¤é’©å­ï¼Œå®šåˆ¶å®ƒä»¬ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œå¹¶å°†å®ƒä»¬æ•´åˆåˆ°ä½ çš„å¼€å‘å·¥ä½œæµä¸­ã€‚***
- en: If youâ€™re a Python developer looking to enhance your code quality and productivity
    across your team, this post is for you.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ˜¯ä¸€ä¸ªå¸Œæœ›æå‡å›¢é˜Ÿä»£ç è´¨é‡å’Œç”Ÿäº§åŠ›çš„ Python å¼€å‘è€…ï¼Œè¿™ç¯‡æ–‡ç« é€‚åˆä½ ã€‚
- en: So, without further ado, letâ€™s have a look ğŸ”
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œäº‹ä¸å®œè¿Ÿï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ ğŸ”
- en: 'Pre-commits: how they integrate into the Git workflow'
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: é¢„æäº¤ï¼šå®ƒä»¬å¦‚ä½•èå…¥ Git å·¥ä½œæµ
- en: Pre-commit hooks are scripts that run automatically before each commit to check
    your code for errors. These hooks are language agnostic and help to catch issues
    before they are committed to the repository, ensuring that only high-quality code
    is committed.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æäº¤é’©å­æ˜¯è‡ªåŠ¨è¿è¡Œçš„è„šæœ¬ï¼Œåœ¨æ¯æ¬¡æäº¤ä¹‹å‰æ£€æŸ¥ä½ çš„ä»£ç æ˜¯å¦æœ‰é”™è¯¯ã€‚è¿™äº›é’©å­æ˜¯è¯­è¨€æ— å…³çš„ï¼Œå¸®åŠ©åœ¨æäº¤åˆ°ä»“åº“ä¹‹å‰æ•æ‰é—®é¢˜ï¼Œç¡®ä¿åªæœ‰é«˜è´¨é‡çš„ä»£ç è¢«æäº¤ã€‚
- en: 'The following diagram visualizes a git workflow that includes the pre-commit
    hooks: once you hit the `git commit` command, these scripts are triggered. And
    when theyâ€™re done executing, a final step verifies that all the checks passed.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹å›¾ç¤ºå±•ç¤ºäº†ä¸€ä¸ªåŒ…å«é¢„æäº¤é’©å­çš„ git å·¥ä½œæµç¨‹ï¼šå½“æ‚¨æ‰§è¡Œ `git commit` å‘½ä»¤æ—¶ï¼Œè¿™äº›è„šæœ¬ä¼šè¢«è§¦å‘ã€‚æ‰§è¡Œå®Œæˆåï¼Œæœ€åä¸€æ­¥ä¼šéªŒè¯æ‰€æœ‰æ£€æŸ¥æ˜¯å¦é€šè¿‡ã€‚
- en: '![](../Images/0145ccfc38da7687e199c9ac4d0b7805.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0145ccfc38da7687e199c9ac4d0b7805.png)'
- en: My pre-commit configuration for my personal projects
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä¸ªäººé¡¹ç›®çš„é¢„æäº¤é…ç½®
- en: âœ… If the pre-commit checks donâ€™t pass, you need to iterate on your codebase
    and provide the fixes accordingly.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: âœ… å¦‚æœé¢„æäº¤æ£€æŸ¥æœªé€šè¿‡ï¼Œæ‚¨éœ€è¦åœ¨ä»£ç åº“ä¸­è¿›è¡Œè¿­ä»£ï¼Œå¹¶ç›¸åº”åœ°æä¾›ä¿®å¤ã€‚
- en: âŒ If the pre-commit check pass, your code is committed successfully
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: âŒ å¦‚æœé¢„æäº¤æ£€æŸ¥é€šè¿‡ï¼Œæ‚¨çš„ä»£ç å°†æˆåŠŸæäº¤
- en: Setting up and configuring pre-commit hook in your Python project
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åœ¨ Python é¡¹ç›®ä¸­è®¾ç½®å’Œé…ç½®é¢„æäº¤é’©å­
- en: 'To start using pre-commit in your Python project, you first need to install
    it. You can do this using pip, the Python package installer. Run the following
    command in your terminal:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: è¦åœ¨ Python é¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨é¢„æäº¤ï¼Œé¦–å…ˆéœ€è¦å®‰è£…å®ƒã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Python åŒ…ç®¡ç†å™¨ pip æ¥å®Œæˆè¿™ä¸€æ“ä½œã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Once pre-commit is installed, you need to set up a configuration file named
    `.pre-commit-config.yaml` in the root directory of your project. This file will
    specify which hooks pre-commit should use.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: å®‰è£…å®Œé¢„æäº¤åï¼Œæ‚¨éœ€è¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­è®¾ç½®ä¸€ä¸ªåä¸º `.pre-commit-config.yaml` çš„é…ç½®æ–‡ä»¶ã€‚æ­¤æ–‡ä»¶å°†æŒ‡å®šé¢„æäº¤åº”è¯¥ä½¿ç”¨å“ªäº›é’©å­ã€‚
- en: 'Hereâ€™s a configuration I use in my`.pre-commit-config.yaml` file:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹æ˜¯æˆ‘åœ¨ `.pre-commit-config.yaml` æ–‡ä»¶ä¸­ä½¿ç”¨çš„é…ç½®ï¼š
- en: '[PRE1]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In this configuration, weâ€™re using three hooks from the pre-commit-hooks [repository](https://github.com/pre-commit/pre-commit-hooks)
    (a repo that contains some out-of-the-box hooks for pre-commit) `trailing-whitespace`,
    `check-yaml`, and `end-of-file-fixer`.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ­¤é…ç½®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ¥è‡ªé¢„æäº¤é’©å­ [repository](https://github.com/pre-commit/pre-commit-hooks)ï¼ˆä¸€ä¸ªåŒ…å«ä¸€äº›å¼€ç®±å³ç”¨é’©å­çš„åº“ï¼‰ä¸­çš„ä¸‰ä¸ªé’©å­
    `trailing-whitespace`ã€`check-yaml` å’Œ `end-of-file-fixer`ã€‚
- en: '`trailing-whitespace`trims trailing whitespace'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`trailing-whitespace`ä¿®å‰ªå°¾éšç©ºç™½å­—ç¬¦'
- en: '`check-yaml` checks that YAML files are correctly formatted'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`check-yaml` æ£€æŸ¥ YAML æ–‡ä»¶æ˜¯å¦æ ¼å¼æ­£ç¡®'
- en: '`end-of-file-fixer` makes sure files end in a new line and only a new line'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`end-of-file-fixer` ç¡®ä¿æ–‡ä»¶ä»¥æ¢è¡Œç¬¦ç»“æŸï¼Œå¹¶ä¸”ä»…ä»¥æ¢è¡Œç¬¦ç»“æŸ'
- en: 'After setting up the configuration file, you need to install the git hooks.
    Run the following command in your terminal:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: è®¾ç½®å®Œé…ç½®æ–‡ä»¶åï¼Œæ‚¨éœ€è¦å®‰è£… git é’©å­ã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
- en: '[PRE2]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Now, pre-commit will run automatically on `git commit`. If any of these hooks
    in your configuration file fail, the commit will be aborted.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œé¢„æäº¤å°†åœ¨ `git commit` æ—¶è‡ªåŠ¨è¿è¡Œã€‚å¦‚æœé…ç½®æ–‡ä»¶ä¸­çš„ä»»ä½•é’©å­å¤±è´¥ï¼Œæäº¤å°†è¢«ä¸­æ­¢ã€‚
- en: Remember, you can customize your `.pre-commit-config.yaml` file to include any
    hooks that are relevant to your project. There are many pre-built hooks available,
    but you can also create your own if needed.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è®°ä½ï¼Œæ‚¨å¯ä»¥è‡ªå®šä¹‰ `.pre-commit-config.yaml` æ–‡ä»¶ï¼Œä»¥åŒ…æ‹¬ä¸æ‚¨çš„é¡¹ç›®ç›¸å…³çš„ä»»ä½•é’©å­ã€‚è™½ç„¶æœ‰è®¸å¤šç°æˆçš„é’©å­å¯ç”¨ï¼Œä½†å¦‚æœéœ€è¦ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„é’©å­ã€‚
- en: Some common pre-commit hooks for Python
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä¸€äº›å¸¸è§çš„ Python é¢„æäº¤é’©å­
- en: 'There are many pre-built hooks available that can help improve the quality
    of your Python code. Here are a few common ones:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰è®¸å¤šç°æˆçš„é’©å­å¯ä»¥å¸®åŠ©æå‡æ‚¨çš„ Python ä»£ç è´¨é‡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ï¼š
- en: '1 â€” `black`: This is a code formatter for Python. It automatically formats
    your code to make it more readable and consistent. Here''s how you can add it
    to your `.pre-commit-config.yaml` file:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '1 â€” `black` : è¿™æ˜¯ä¸€ä¸ª Python ä»£ç æ ¼å¼åŒ–å·¥å…·ã€‚å®ƒä¼šè‡ªåŠ¨æ ¼å¼åŒ–æ‚¨çš„ä»£ç ï¼Œä½¿å…¶æ›´å…·å¯è¯»æ€§å’Œä¸€è‡´æ€§ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å°†å®ƒæ·»åŠ åˆ° `.pre-commit-config.yaml`
    æ–‡ä»¶ä¸­ï¼š'
- en: '[PRE3]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '2 â€” `flake8` : This is a tool for enforcing coding standards in Python. It
    checks your code against PEP8, Python''s official style guide, and also looks
    for logical errors. Here''s how you can add it:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '2 â€” `flake8` : è¿™æ˜¯ä¸€ä¸ªç”¨äºå¼ºåˆ¶æ‰§è¡Œ Python ç¼–ç æ ‡å‡†çš„å·¥å…·ã€‚å®ƒä¼šæ£€æŸ¥æ‚¨çš„ä»£ç æ˜¯å¦ç¬¦åˆ PEP8ï¼ˆPython çš„å®˜æ–¹é£æ ¼æŒ‡å—ï¼‰ï¼ŒåŒæ—¶ä¹Ÿä¼šæŸ¥æ‰¾é€»è¾‘é”™è¯¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•æ·»åŠ å®ƒï¼š'
- en: '[PRE4]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '3 â€” `isort`: This tool automatically sorts and formats your Python imports.
    Here''s how you can add it:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '3 â€” `isort` : è¿™ä¸ªå·¥å…·ä¼šè‡ªåŠ¨æ’åºå’Œæ ¼å¼åŒ–æ‚¨çš„ Python å¯¼å…¥ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•æ·»åŠ å®ƒï¼š'
- en: '[PRE5]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '4 â€” `mypy`: This is a static type checker for Python. It helps catch certain
    types of errors before your code is even run. Here''s how you can add it:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '4 â€” `mypy` : è¿™æ˜¯ä¸€ä¸ªç”¨äº Python çš„é™æ€ç±»å‹æ£€æŸ¥å™¨ã€‚å®ƒæœ‰åŠ©äºåœ¨ä»£ç è¿è¡Œä¹‹å‰æ•æ‰æŸäº›ç±»å‹çš„é”™è¯¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•æ·»åŠ å®ƒï¼š'
- en: '[PRE6]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '5 â€” `pycln` : This is a tool that helps find and remove unused import statements'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '5 â€” `pycln` : è¿™æ˜¯ä¸€ä¸ªå¸®åŠ©æŸ¥æ‰¾å’Œåˆ é™¤æœªä½¿ç”¨çš„å¯¼å…¥è¯­å¥çš„å·¥å…·'
- en: '[PRE7]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '6 â€” `pydocstyle` : this is a static analysis tool for checking compliance with
    Python docstring conventions.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '6 â€” `pydocstyle` : è¿™æ˜¯ä¸€ä¸ªé™æ€åˆ†æå·¥å…·ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦ç¬¦åˆ Python docstring è§„èŒƒã€‚'
- en: '[PRE8]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '7 â€” Custom hooks for running **unit tests**: Instead of referencing an external
    repository, you can specify a custom command that should be triggered at each
    commit. In this example, we run unit tests. This will probably introduce a slight
    overhead depending on your test suite.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 7 â€” è¿è¡Œ **å•å…ƒæµ‹è¯•** çš„è‡ªå®šä¹‰é’©å­ï¼šä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰å‘½ä»¤ï¼Œåœ¨æ¯æ¬¡æäº¤æ—¶è§¦å‘ï¼Œè€Œä¸æ˜¯å¼•ç”¨å¤–éƒ¨ä»“åº“ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿è¡Œå•å…ƒæµ‹è¯•ã€‚è¿™å¯èƒ½ä¼šå¼•å…¥ä¸€ä¸ªè½»å¾®çš„å¼€é”€ï¼Œå…·ä½“å–å†³äºä½ çš„æµ‹è¯•å¥—ä»¶ã€‚
- en: '[PRE9]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: These are just a few examples of the many pre-commit hooks available for Python.
    For more info, you can check this [repository](https://github.com/pre-commit/pre-commit-hooks)
    or add your custom quality code checks.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›åªæ˜¯è®¸å¤šå¯ç”¨äº Python çš„ pre-commit é’©å­ä¸­çš„å‡ ä¸ªç¤ºä¾‹ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹è¿™ä¸ª [repository](https://github.com/pre-commit/pre-commit-hooks)
    æˆ–æ·»åŠ ä½ è‡ªå®šä¹‰çš„è´¨é‡ä»£ç æ£€æŸ¥ã€‚
- en: How to run pre-commit hooks and fix a codebase
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¦‚ä½•è¿è¡Œ pre-commit é’©å­å¹¶ä¿®å¤ä»£ç åº“
- en: In this section, Iâ€™ll share with you the pre-commit configuration I use in my
    personal projects. Then, Iâ€™ll show you how it works in practice and prevents potential
    errors.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘å°†ä¸ä½ åˆ†äº«æˆ‘åœ¨ä¸ªäººé¡¹ç›®ä¸­ä½¿ç”¨çš„ pre-commit é…ç½®ã€‚ç„¶åï¼Œæˆ‘å°†å±•ç¤ºå®ƒå¦‚ä½•åœ¨å®è·µä¸­å·¥ä½œï¼Œå¹¶é˜²æ­¢æ½œåœ¨çš„é”™è¯¯ã€‚
- en: 'First, hereâ€™s my configuration:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè¿™æ˜¯æˆ‘çš„é…ç½®ï¼š
- en: '[PRE10]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now Iâ€™,m going to add the following poorly formatted dummy script to my existing
    codebase:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘è¦å°†ä»¥ä¸‹æ ¼å¼ä¸è‰¯çš„è™šæ‹Ÿè„šæœ¬æ·»åŠ åˆ°ç°æœ‰çš„ä»£ç åº“ä¸­ï¼š
- en: '[PRE11]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'As you see, this script has many issues:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸ªè„šæœ¬æœ‰è®¸å¤šé—®é¢˜ï¼š
- en: 'an unused import statement: `math`'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœªä½¿ç”¨çš„å¯¼å…¥è¯­å¥ï¼š`math`
- en: 'no black formatting: extra spaces between the arguments and the variable'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ— é»‘è‰²æ ¼å¼åŒ–ï¼šå‚æ•°å’Œå˜é‡ä¹‹é—´æœ‰å¤šä½™çš„ç©ºæ ¼
- en: a lot of trailing spaces
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®¸å¤šå°¾éšç©ºæ ¼
- en: 'If we add this file and commit the code, we get these errors from the hooks:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æ·»åŠ è¿™ä¸ªæ–‡ä»¶å¹¶æäº¤ä»£ç ï¼Œæˆ‘ä»¬ä¼šä»é’©å­ä¸­å¾—åˆ°è¿™äº›é”™è¯¯ï¼š
- en: '![](../Images/443e8bf3e0a8487e6751f4d9c3ddf107.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/443e8bf3e0a8487e6751f4d9c3ddf107.png)'
- en: Screenshot by the author
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æˆªå›¾
- en: '`black` failed but reformatted the code automatically'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`black` å¤±è´¥ä½†è‡ªåŠ¨é‡æ–°æ ¼å¼åŒ–äº†ä»£ç '
- en: '`pydoctyle` failed and indicated where the documentation is missing'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pydoctyle` å¤±è´¥å¹¶æŒ‡å‡ºäº†æ–‡æ¡£ç¼ºå¤±çš„åœ°æ–¹'
- en: '`pycln` failed and automatically removed the unused import statement'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pycln` å¤±è´¥å¹¶è‡ªåŠ¨ç§»é™¤äº†æœªä½¿ç”¨çš„å¯¼å…¥è¯­å¥'
- en: If we add the automatically modified script and commit the code again, we notice
    that everything passes except the `pyodstyle` hook.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æ·»åŠ è‡ªåŠ¨ä¿®æ”¹è¿‡çš„è„šæœ¬å¹¶å†æ¬¡æäº¤ä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°é™¤äº† `pyodstyle` é’©å­å¤–ï¼Œå…¶ä»–éƒ½é€šè¿‡äº†ã€‚
- en: '![](../Images/2e3e623d1292a25f40b6cc3fc94a135a.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2e3e623d1292a25f40b6cc3fc94a135a.png)'
- en: Screenshot by the author
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æˆªå›¾
- en: In this case, we have to update the documentation manually,
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨æ›´æ–°æ–‡æ¡£ï¼Œ
- en: '[PRE12]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'add the code, and commit:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: æ·»åŠ ä»£ç ï¼Œå¹¶æäº¤ï¼š
- en: '![](../Images/7d34f2060fc47e193ad2bd1b73bd2d8c.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7d34f2060fc47e193ad2bd1b73bd2d8c.png)'
- en: Screenshot by the author
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æˆªå›¾
- en: Now, youâ€™re ready to push your code.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œä½ å‡†å¤‡å¥½æ¨é€ä½ çš„ä»£ç äº†ã€‚
- en: Observing the impact of pre-commit on code quality
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è§‚å¯Ÿ pre-commit å¯¹ä»£ç è´¨é‡çš„å½±å“
- en: 'The impact of pre-commit on code quality is significant and multifaceted. Here
    are a few ways in which pre-commit can enhance the quality of your Python code:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: pre-commit å¯¹ä»£ç è´¨é‡çš„å½±å“æ˜¯æ˜¾è‘—è€Œå¤šæ–¹é¢çš„ã€‚ä»¥ä¸‹æ˜¯ pre-commit å¯ä»¥æå‡ä½ çš„ Python ä»£ç è´¨é‡çš„å‡ ç§æ–¹å¼ï¼š
- en: '**Consistent Code Formatting**: With hooks like `black` and `isort`, your code
    will follow a consistent style. This makes the code easier to read and understand,
    not just for you, but for anyone else who might work on your project.'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**ä¸€è‡´çš„ä»£ç æ ¼å¼åŒ–**ï¼šä½¿ç”¨ `black` å’Œ `isort` ç­‰é’©å­ï¼Œä½ çš„ä»£ç å°†éµå¾ªä¸€è‡´çš„é£æ ¼ã€‚è¿™ä½¿å¾—ä»£ç ä¸ä»…å¯¹ä½ è‡ªå·±ï¼Œæ›´å¯¹ä»»ä½•å¯èƒ½å‚ä¸ä½ é¡¹ç›®çš„å…¶ä»–äººæ¥è¯´éƒ½æ›´æ˜“è¯»å’Œç†è§£ã€‚'
- en: '**Catching Errors Early**: Hooks like `flake8` and `mypy` can catch potential
    errors and bugs before your code is even run. This can save you a lot of time
    debugging later on.'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ—©æœŸæ•è·é”™è¯¯**ï¼šåƒ `flake8` å’Œ `mypy` è¿™æ ·çš„é’©å­å¯ä»¥åœ¨ä»£ç è¿è¡Œä¹‹å‰æ•è·æ½œåœ¨çš„é”™è¯¯å’Œæ¼æ´ã€‚è¿™å¯ä»¥èŠ‚çœä½ å¾ˆå¤šåç»­è°ƒè¯•çš„æ—¶é—´ã€‚'
- en: '**Enforcing Best Practices:** Many hooks enforce Python best practices, such
    as PEP8 compliance. This can help you write cleaner, more efficient code.'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å¼ºåˆ¶æœ€ä½³å®è·µ**ï¼šè®¸å¤šé’©å­å¼ºåˆ¶æ‰§è¡Œ Python æœ€ä½³å®è·µï¼Œä¾‹å¦‚ PEP8 åˆè§„æ€§ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´æ¸…æ™°ã€æ›´é«˜æ•ˆçš„ä»£ç ã€‚'
- en: '**Running Unit tests**: Pre-commits allow you to run your unit tests locally
    and check they succeed before pushing your code. This prevents you from encountering
    test errors during your CICD.'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è¿è¡Œå•å…ƒæµ‹è¯•**ï¼špre-commits å…è®¸ä½ åœ¨æœ¬åœ°è¿è¡Œå•å…ƒæµ‹è¯•å¹¶æ£€æŸ¥å®ƒä»¬æ˜¯å¦æˆåŠŸï¼Œç„¶åå†æ¨é€ä½ çš„ä»£ç ã€‚è¿™å¯ä»¥é˜²æ­¢ä½ åœ¨ CICD è¿‡ç¨‹ä¸­é‡åˆ°æµ‹è¯•é”™è¯¯ã€‚'
- en: By integrating pre-commit into your development workflow, you can ensure that
    your code is always of the highest quality. Itâ€™s a tool that can save you time,
    effort, and potentially a lot of headaches in the long run.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡å°† pre-commit é›†æˆåˆ°ä½ çš„å¼€å‘å·¥ä½œæµä¸­ï¼Œä½ å¯ä»¥ç¡®ä¿ä½ çš„ä»£ç å§‹ç»ˆä¿æŒæœ€é«˜è´¨é‡ã€‚è¿™æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨é•¿è¿œä¸­èŠ‚çœæ—¶é—´ã€ç²¾åŠ›å’Œæ½œåœ¨å¾ˆå¤šéº»çƒ¦çš„å·¥å…·ã€‚
- en: Conclusion
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: pre-commit is a powerful tool that can significantly enhance the quality of
    your Python code. By automating checks for common issues, enforcing best practices,
    and preventing bad commits, pre-commit can save you time, effort, and a lot of
    debugging headaches.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: pre-commit æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥æ˜¾è‘—æå‡ä½ çš„ Python ä»£ç è´¨é‡ã€‚é€šè¿‡è‡ªåŠ¨æ£€æŸ¥å¸¸è§é—®é¢˜ã€æ‰§è¡Œæœ€ä½³å®è·µå¹¶é˜²æ­¢é”™è¯¯æäº¤ï¼Œpre-commit
    å¯ä»¥èŠ‚çœä½ å¤§é‡çš„æ—¶é—´å’Œè°ƒè¯•ç²¾åŠ›ã€‚
- en: Itâ€™s easy to integrate into your development workflow and highly customizable,
    allowing you to choose the hooks that best fit your projectâ€™s needs.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒå¾ˆå®¹æ˜“é›†æˆåˆ°ä½ çš„å¼€å‘å·¥ä½œæµç¨‹ä¸­ï¼Œå¹¶ä¸”é«˜åº¦å¯å®šåˆ¶ï¼Œè®©ä½ å¯ä»¥é€‰æ‹©æœ€é€‚åˆä½ é¡¹ç›®éœ€æ±‚çš„é’©å­ã€‚
- en: New to Medium? You can subscribe for $5 per month and unlock unlimited articles
    on various topics (tech, design, entrepreneurshipâ€¦) You can support me by clicking
    on my referral [link](https://ahmedbesbes.medium.com/membership)
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆšåˆšæ¥è§¦ Mediumï¼Ÿä½ å¯ä»¥æ¯æœˆä»¥ $5 è®¢é˜…ï¼Œè§£é”å„ç§ä¸»é¢˜çš„æ— é™æ–‡ç« ï¼ˆæŠ€æœ¯ã€è®¾è®¡ã€åˆ›ä¸šâ€¦ï¼‰ä½ å¯ä»¥é€šè¿‡ç‚¹å‡»æˆ‘çš„æ¨è[é“¾æ¥](https://ahmedbesbes.medium.com/membership)æ¥æ”¯æŒæˆ‘ã€‚
- en: '[](https://ahmedbesbes.medium.com/membership?source=post_page-----e550debbd62e--------------------------------)
    [## Join Medium with my referral link - Ahmed Besbes'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '[## ä½¿ç”¨æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium - Ahmed Besbes](https://ahmedbesbes.medium.com/membership?source=post_page-----e550debbd62e--------------------------------)'
- en: As a Medium member, a portion of your membership fee goes to writers you read,
    and you get full access to every storyâ€¦
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½œä¸º Medium ä¼šå‘˜ï¼Œä½ çš„éƒ¨åˆ†ä¼šè´¹å°†åˆ†é…ç»™ä½ é˜…è¯»çš„ä½œè€…ï¼ŒåŒæ—¶ä½ å¯ä»¥å…¨é¢è®¿é—®æ¯ä¸€ç¯‡æ–‡ç« â€¦
- en: ahmedbesbes.medium.com](https://ahmedbesbes.medium.com/membership?source=post_page-----e550debbd62e--------------------------------)
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[ahmedbesbes.medium.com](https://ahmedbesbes.medium.com/membership?source=post_page-----e550debbd62e--------------------------------)'
- en: Resources
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: èµ„æº
- en: '[https://pre-commit.com/](https://pre-commit.com/)'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://pre-commit.com/](https://pre-commit.com/)'
- en: '[https://github.com/pre-commit/pre-commit/](https://github.com/pre-commit/pre-commit/)'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://github.com/pre-commit/pre-commit/](https://github.com/pre-commit/pre-commit/)'
- en: '[https://www.youtube.com/watch?v=psjz6rwzMdk&ab_channel=mCoding](https://www.youtube.com/watch?v=psjz6rwzMdk&ab_channel=mCoding)'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.youtube.com/watch?v=psjz6rwzMdk&ab_channel=mCoding](https://www.youtube.com/watch?v=psjz6rwzMdk&ab_channel=mCoding)'

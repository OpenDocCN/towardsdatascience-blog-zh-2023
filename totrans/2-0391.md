# å¤§æ•°æ®æ–‡ä»¶æ ¼å¼è§£é‡Š

> åŸæ–‡ï¼š[https://towardsdatascience.com/big-data-file-formats-explained-275876dc1fc9](https://towardsdatascience.com/big-data-file-formats-explained-275876dc1fc9)

## Parquet ä¸ ORC ä¸ AVRO ä¸ JSONã€‚è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Œå¦‚ä½•ä½¿ç”¨ï¼Ÿ

[](https://mshakhomirov.medium.com/?source=post_page-----275876dc1fc9--------------------------------)[![ğŸ’¡Mike Shakhomirov](../Images/bc6895c7face3244d488feb97ba0f68e.png)](https://mshakhomirov.medium.com/?source=post_page-----275876dc1fc9--------------------------------)[](https://towardsdatascience.com/?source=post_page-----275876dc1fc9--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----275876dc1fc9--------------------------------) [ğŸ’¡Mike Shakhomirov](https://mshakhomirov.medium.com/?source=post_page-----275876dc1fc9--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----275876dc1fc9--------------------------------) Â·é˜…è¯»æ—¶é—´ 9 åˆ†é’ŸÂ·2023å¹´2æœˆ28æ—¥

--

![](../Images/ce5abf8987056d730cd51c36eda44998.png)

ç…§ç‰‡ç”± [James Lee](https://unsplash.com/@picsbyjameslee?utm_source=medium&utm_medium=referral) æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

æˆ‘æ˜¯é‡‡ç”¨ ELTï¼ˆExtract-Load-Transformï¼‰è®¾è®¡çš„æ•°æ®ä»“åº“ï¼ˆDWHï¼‰è§£å†³æ–¹æ¡ˆçš„å¿ å®ç²‰ä¸ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘é¢ä¸´äº†*å¤„ç†*åŸå§‹äº‹ä»¶æ•°æ®çš„è¦æ±‚ï¼Œå¹¶ä¸”å¿…é¡»**é€‰æ‹©æ–‡ä»¶æ ¼å¼**ç”¨äºæ•°æ®æ–‡ä»¶ã€‚

> *è¿™æ˜¯ä¸€ç§å…¸å‹çš„åœºæ™¯ï¼Œå½“æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆè¢«è¦æ±‚åˆ›å»ºè¡Œä¸ºæ•°æ®é›†ä»¥è®­ç»ƒæ¨¡å‹å¹¶ç”Ÿæˆæ›´å¥½çš„äº§å“æ¨èæˆ–é¢„æµ‹å®¢æˆ·æµå¤±æ—¶ã€‚*

ä¸ºæˆ‘ä»¬çš„æœºå™¨å­¦ä¹ ç®¡é“é€‰æ‹©æ­£ç¡®çš„æ–‡ä»¶æ ¼å¼è‡³å…³é‡è¦ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¾è‘—æ”¹å˜æ•°æ®çš„ I/O æ—¶é—´ï¼Œå¹¶ä¸”è‚¯å®šä¼šå¯¹æˆ‘ä»¬çš„æ¨¡å‹è®­ç»ƒæ€§èƒ½äº§ç”Ÿæ›´å¹¿æ³›çš„å½±å“ã€‚

[](https://pub.towardsai.net/supercharge-your-data-engineering-skills-with-this-machine-learning-pipeline-b69d159780b7?source=post_page-----275876dc1fc9--------------------------------) [## åˆ©ç”¨è¿™ä¸ªæœºå™¨å­¦ä¹ ç®¡é“æå‡ä½ çš„æ•°æ®å·¥ç¨‹æŠ€èƒ½

### æ•°æ®å»ºæ¨¡ã€Pythonã€DAGsã€å¤§æ•°æ®æ–‡ä»¶æ ¼å¼ã€æˆæœ¬â€¦â€¦åº”æœ‰å°½æœ‰ã€‚

[pub.towardsai.net](https://pub.towardsai.net/supercharge-your-data-engineering-skills-with-this-machine-learning-pipeline-b69d159780b7?source=post_page-----275876dc1fc9--------------------------------)

å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„å› ç´ æ˜¯æ•°æ®çš„å¤§å°ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»ä¸ºæ–‡ä»¶å­˜å‚¨æ”¯ä»˜äº†è¿‡å¤šè´¹ç”¨ã€‚

æœ¬æ–‡æ—¨åœ¨æ¢è®¨è¿™äº›é‡è¦é—®é¢˜åŠå…¶ä»–é€‰é¡¹ï¼Œä»¥æ‰¾åˆ°æ•°æ®ç®¡é“çš„æœ€ä½³å¤§æ•°æ®æ–‡ä»¶æ ¼å¼ã€‚

*éœ€æ±‚å¾ˆç®€å•ï¼Œå¼ºè°ƒäº†ä½¿ç”¨æ•°æ®æ¹–çš„æƒ³æ³•ï¼Œå¹¶å‡å°‘ä¸æ•°æ®ä»“åº“ä¸­æ•°æ®å­˜å‚¨ç›¸å…³çš„æˆæœ¬ã€‚*

æˆ‘åˆ›å»ºäº†ä¸€ä¸ª**å½’æ¡£**å­˜å‚¨æ¡¶ï¼Œè¿™æ˜¯æœ€ä¾¿å®œçš„å­˜å‚¨ç±»åˆ«ï¼Œå¹¶å‡†å¤‡*æå–*æˆ‘åœ¨ DWH ä¸­çš„ä¸€äº›éå¸¸å¤§çš„è¡¨çš„æ•°æ®ã€‚æˆ‘ä¸å¾—ä¸è¯´ï¼Œé‚£äº›è¡¨éå¸¸åºå¤§ï¼ŒåŒ…å«äº†å¤§é‡çš„ç”¨æˆ·å‚ä¸æ•°æ®åŸå§‹äº‹ä»¶ã€‚å› æ­¤ï¼Œå®ƒä»¬æ˜¯æ•´ä¸ªæ•°æ®å¹³å°ä¸­æœ€æ˜‚è´µçš„å­˜å‚¨éƒ¨åˆ†ã€‚

ç„¶åæˆ‘ä¸å¾—ä¸åœä¸‹æ¥å†³å®šä½¿ç”¨å“ªç§æ–‡ä»¶æ ¼å¼ï¼Œå› ä¸ºå­˜å‚¨å¤§å°å¹¶ä¸æ˜¯å”¯ä¸€çš„è€ƒè™‘å› ç´ ã€‚

> *ç¡®å®ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œè¯»å†™æ—¶é—´æˆ–æ›´å¥½çš„æ¨¡å¼æ”¯æŒå¯èƒ½æ›´é‡è¦*

# Parquet vs ORC vs AVRO vs JSON

éšç€æ•°æ®ç½‘æ ¼çš„å…´èµ·ä»¥åŠ**Hadoop** ç”Ÿæ€ç³»ç»Ÿä¸­å¤§é‡æ•°æ®å¤„ç†å·¥å…·çš„å‡ºç°ï¼Œ**åœ¨æ•°æ®æ¹–ä¸­å¤„ç†åŸå§‹äº‹ä»¶æ•°æ®**å¯èƒ½æ›´æœ‰æ•ˆã€‚

> *ç°ä»£æ•°æ®ä»“åº“è§£å†³æ–¹æ¡ˆéå¸¸æ£’ï¼Œä½†æœ‰äº›* ***å®šä»·æ¨¡å‹*** *æ¯”å…¶ä»–æ¨¡å‹æ›´è´µï¼Œè€Œä¸”è‚¯å®šæ¯”æ•°æ®æ¹–å·¥å…·æ›´è´µ*

å¤§æ•°æ® **æ–‡ä»¶æ ¼å¼** çš„ **æœ€å¤§ä¼˜åŠ¿** ä¹‹ä¸€æ˜¯å®ƒä»¬æºå¸¦äº†æ¨¡å¼ä¿¡æ¯ã€‚å› æ­¤ï¼ŒåŠ è½½æ•°æ®ã€æ‹†åˆ†æ•°æ®ä»¥æ›´é«˜æ•ˆåœ°å¤„ç†ç­‰æ“ä½œè¦å®¹æ˜“å¾—å¤šã€‚JSON æ— æ³•æä¾›æ­¤åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡è¯»å–ã€åŠ è½½æˆ–éªŒè¯æ•°æ®æ—¶å®šä¹‰æ¨¡å¼ã€‚

# åˆ—å¼ ORC å’Œ Parquet

**Parquet** æ˜¯ä¸€ç§ ***é¢å‘åˆ—*** çš„æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œä¸“ä¸º *Apache Hadoop* ç”Ÿæ€ç³»ç»Ÿè®¾è®¡ï¼ˆç”± Cloudera æ”¯æŒï¼Œä¸ Twitter åˆä½œï¼‰ã€‚å®ƒåœ¨ä½¿ç”¨**Spark**çš„æ•°æ®æ˜¾ç¤ºç§‘å­¦å®¶å’Œæ•°æ®å·¥ç¨‹å¸ˆä¸­éå¸¸å—æ¬¢è¿ã€‚å½“å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œä½ ä¼šå¼€å§‹æ³¨æ„åˆ°åˆ—å¼æ•°æ®çš„ä¸»è¦ä¼˜åŠ¿ï¼Œè¿™æ˜¯åœ¨è¡¨ä¸­è¡Œæ•°è¿œå¤šäºåˆ—æ•°æ—¶å®ç°çš„ã€‚

![](../Images/45fc6ec974c1bc982924ea6d8d9a1976.png)

Parquet æ–‡ä»¶å¸ƒå±€ã€‚æ¥æºï¼š[apache.org](http://apache.org)ï¼ˆApache 2.0 è®¸å¯è¯ï¼‰

> *Spark æ‰©å±•æ€§å¾ˆå¥½ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å®¶å–œæ¬¢å®ƒ*

å®é™…ä¸Šï¼ŒParquet æ˜¯ Spark çš„é»˜è®¤æ•°æ®æ–‡ä»¶æ ¼å¼ã€‚**Parquet** åœ¨æŸ¥è¯¢å’Œå¤„ç†åˆ†æå·¥ä½œè´Ÿè½½æ—¶è¡¨ç°å‡ºè‰²ã€‚

> *åˆ—å¼æ ¼å¼æ›´é€‚åˆ OLAP åˆ†ææŸ¥è¯¢ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›ä»…æ£€ç´¢æ‰§è¡Œåˆ†ææŸ¥è¯¢æ‰€éœ€çš„åˆ—ã€‚è¿™å¯¹å†…å­˜æœ‰ä¸€å®šçš„å½±å“ï¼Œå› æ­¤å¯¹æ€§èƒ½å’Œé€Ÿåº¦ä¹Ÿæœ‰å½±å“ã€‚*

**ORCï¼ˆä¼˜åŒ–è¡Œåˆ—å¼ï¼‰** ä¹Ÿæ˜¯ä¸€ç§åˆ—å¼æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œä¸ Parquet ç±»ä¼¼ï¼Œå¹¶ä¸”æºå¸¦äº†æ¨¡å¼ä¿¡æ¯ã€‚è¿™æ„å‘³ç€åƒ Parquet ä¸€æ ·ï¼Œå®ƒæ˜¯**è‡ªæè¿°**çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒå°†æ•°æ®åŠ è½½åˆ°ä¸åŒçš„ç£ç›˜æˆ–èŠ‚ç‚¹ä¸­ã€‚

![](../Images/b7301da75334cf83797ce798485045a3.png)

ORC æ–‡ä»¶å¸ƒå±€ã€‚æ¥æºï¼š[apache.org](http://apache.org)ï¼ˆApache 2.0 è®¸å¯è¯ï¼‰

æˆ‘åšäº†ä¸€ä¸ªå°æµ‹è¯•ï¼Œç»“æœæ˜¾ç¤º **Parquet å’Œ ORC** æä¾›äº†ç±»ä¼¼çš„å‹ç¼©æ¯”ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§è§‚ç‚¹è®¤ä¸º ORC çš„å‹ç¼©æ•ˆç‡æ›´é«˜ã€‚

> *10 Mb ä½¿ç”¨* ***SNAPPY*** *ç®—æ³•å‹ç¼©åä¼šå˜æˆ 2.4Mb çš„* ***Parquet***

ä¸è¿‡ï¼Œæˆ‘æ„Ÿè§‰**ORC**çš„æ”¯æŒé¡¹ç›®æ•°é‡å°‘äº Parquetï¼Œä¾‹å¦‚ Hive å’Œ Pigã€‚

å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨æ•°æ®æ¹–ä¸­è¿è¡Œæ›´å¹¿æ³›çš„ OLAP åˆ†æå·¥å…·ï¼Œæˆ‘å»ºè®®ä½¿ç”¨**Parquet**ã€‚å®ƒæœ‰æ›´å¹¿æ³›çš„é¡¹ç›®æ”¯æŒï¼Œå°¤å…¶æ˜¯**Spark**ã€‚

> *å®é™…ä¸Šï¼ŒPARQUET å’Œ ORC çš„åˆ—å¼æ¶æ„æœ‰æ‰€ä¸åŒã€‚*

ä¸¤è€…éƒ½éå¸¸æœ‰æ•ˆåœ°èŠ‚çœäº†å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚

ä¸è¿‡ï¼Œ**ORC** æ–‡ä»¶ä¸­çš„æ•°æ®ç»„ç»‡æˆç‹¬ç«‹çš„*æ¡å¸¦*ã€‚æ¯ä¸ªæ¡å¸¦éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ç´¢å¼•ã€è¡Œæ•°æ®å’Œé¡µè„šã€‚è¿™ä½¿å¾—ä» HDFS è¿›è¡Œå¤§è§„æ¨¡é«˜æ•ˆè¯»å–æˆä¸ºå¯èƒ½ã€‚

æ•°æ®ä»¥é¡µé¢å½¢å¼å­˜å‚¨åœ¨**Parquet**ä¸­ï¼Œæ¯é¡µåŒ…å«å¤´éƒ¨ä¿¡æ¯ã€å®šä¹‰çº§åˆ«ä¿¡æ¯å’Œé‡å¤çº§åˆ«ä¿¡æ¯ã€‚

å½“æ”¯æŒå¤æ‚çš„**åµŒå¥—**æ•°æ®ç»“æ„æ—¶ï¼Œå®ƒéå¸¸æœ‰æ•ˆï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œ IO ç±»å‹çš„æ•°æ®æ“ä½œæ—¶ä¼¼ä¹æ›´é«˜æ•ˆã€‚è¿™é‡Œçš„ä¸€ä¸ªå·¨å¤§ä¼˜åŠ¿æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åªé€‰æ‹©æ‰€éœ€çš„åˆ—ï¼Œ**è¯»å–æ—¶é—´**å¯ä»¥æ˜¾è‘—å‡å°‘ã€‚

æˆ‘çš„ä¸ªäººç»éªŒè¡¨æ˜ï¼Œåªé€‰æ‹©å‡ åˆ—å¯ä»¥â€¦å°†æ•°æ®è¯»å–é€Ÿåº¦æé«˜è‡³ 30 å€ï¼ˆï¼ï¼‰ï¼Œæ¯”è¯»å–åŒ…å«å®Œæ•´æ¨¡å¼çš„ç›¸åŒæ–‡ä»¶å¿«ã€‚

> è¯»å–æ•°æ®é€Ÿåº¦å¿« 30 å€ï¼ˆï¼ï¼‰

ä¸é”™å§ï¼Ÿæ•°æ®å·¥ç¨‹å¸ˆè¿›è¡Œçš„å…¶ä»–æµ‹è¯•ä¹Ÿè¯å®äº†è¿™ä¸€ç‚¹ã€‚æˆ‘ä¼šåœ¨åº•éƒ¨æ·»åŠ é‚£ä¸ªé“¾æ¥ã€‚

> *é•¿è¯çŸ­è¯´ï¼Œå¦‚æœä½ åœ¨ HIVE ä¸Šå·¥ä½œï¼Œé€‰æ‹© ORC æ›´ä½³ã€‚å®ƒå¯¹ HIVE æ›´ä¼˜åŒ–ã€‚è€Œé€‰æ‹© Parquet å¦‚æœä½ ä¸ Spark å·¥ä½œï¼Œå› ä¸ºè¿™å°†æ˜¯ Spark çš„é»˜è®¤å­˜å‚¨æ ¼å¼ã€‚*

åœ¨å…¶ä»–æ–¹é¢ï¼ŒORC å’Œ Parquet çš„æ¶æ„ç›¸ä¼¼ï¼ŒKPIs çœ‹èµ·æ¥å¤§è‡´ç›¸åŒã€‚

# AVRO

**AVRO** æ˜¯ä¸€ç§**åŸºäºè¡Œ**çš„å­˜å‚¨æ ¼å¼ï¼Œæ•°æ®ç»è¿‡ç´¢å¼•ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚

å®ƒä½¿ç”¨ JSON æ•°æ®å®šä¹‰æ•°æ®ç±»å‹å’Œæ¨¡å¼ï¼Œå¹¶ä»¥äºŒè¿›åˆ¶æ ¼å¼ï¼ˆå‹ç¼©ï¼‰å­˜å‚¨æ•°æ®ï¼Œä»¥å¸®åŠ©èŠ‚çœç£ç›˜ç©ºé—´ã€‚

![](../Images/6535c558a34c0ed7ca5047e18c4ffd04.png)

avro æ–‡ä»¶ç»“æ„ã€‚æ¥æºï¼š[apache.org](http://apache.org)ï¼ˆApache 2.0 è®¸å¯è¯ï¼‰

ä¸ Parquet å’Œ ORC ç›¸æ¯”ï¼ŒAVRO ä¼¼ä¹æä¾›äº†è¾ƒä½æ•ˆçš„å‹ç¼©ä½†æ›´å¿«çš„**å†™å…¥**é€Ÿåº¦ã€‚

+   *10 Mb* ***Parquet*** *ç”¨* ***SNAPPY*** *ç®—æ³•å‹ç¼©åå°†å˜ä¸º 2.4Mb*

+   *10 Mb* ***AVRO*** *ç”¨* ***SNAPPY*** *ç®—æ³•å‹ç¼©åå°†å˜ä¸º 6.2Mb*

+   *ç›¸åŒçš„ 10 Mb* ***AVRO*** *ç”¨* ***DEFLATE*** *ç®—æ³•å‹ç¼©åå°†éœ€è¦ 4Mb å­˜å‚¨ç©ºé—´*

AVRO çš„ä¸»è¦ä¼˜åŠ¿æ˜¯**æ¨¡å¼æ¼”è¿›æ”¯æŒ**ã€‚æ¢å¥è¯è¯´ï¼Œéšç€æ•°æ®æ¨¡å¼çš„æ¼”å˜ï¼Œ***AVRO*** é€šè¿‡å®¹å¿æ·»åŠ ã€åˆ é™¤æˆ–æ›´æ”¹çš„å­—æ®µæ¥æ”¯æŒè¿™äº›å˜åŒ–ã€‚

> *AVRO åœ¨å¤„ç†å¦‚æ–°å¢å­—æ®µã€å˜æ›´å­—æ®µå’Œç¼ºå¤±å­—æ®µæ—¶è¡¨ç°éå¸¸å¥½ã€‚*

AVRO åœ¨å¤„ç†***å†™å…¥å¯†é›†å‹***å¤§æ•°æ®æ“ä½œæ—¶æ›´é«˜æ•ˆã€‚

å®ƒæ˜¯å­˜å‚¨æ•°æ®äºæ•°æ®å¹³å°çš„`source`å±‚æˆ–`landing`åŒºåŸŸçš„ä¸€ä¸ªä¼˜ç§€é€‰æ‹©ï¼Œå› ä¸ºè¿™äº›*æ–‡ä»¶é€šå¸¸ä¼šè¢«ä½œä¸ºæ•´ä½“è¯»å–*ä»¥è¿›è¡Œè¿›ä¸€æ­¥è½¬æ¢ï¼Œå…·ä½“å–å†³äºæ•°æ®ç®¡é“ã€‚ä»»ä½•æ¨¡å¼æ¼”å˜æ›´æ”¹éƒ½èƒ½è½»æ¾å¤„ç†ã€‚

[](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----275876dc1fc9--------------------------------) [## æ•°æ®ç®¡é“è®¾è®¡æ¨¡å¼

### é€‰æ‹©åˆé€‚çš„æ¶æ„å¹¶é™„å¸¦ç¤ºä¾‹

towardsdatascience.com](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----275876dc1fc9--------------------------------)

å³ä½¿æ˜¯ç”¨ä¸åŒè¯­è¨€ç¼–å†™çš„åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥å…±äº«ä½¿ç”¨AVROä¿å­˜çš„æ•°æ®ã€‚æ•°æ®äº¤æ¢æœåŠ¡å¯èƒ½éœ€è¦ä¸€ä¸ª**ç¼–ç ç”Ÿæˆå™¨**æ¥è§£è¯»æ•°æ®è§„æ ¼å¹¶ç”Ÿæˆè®¿é—®æ•°æ®çš„ä»£ç ã€‚AVROæ˜¯è„šæœ¬è¯­è¨€çš„ç†æƒ³é€‰æ‹©ï¼Œå› ä¸ºå®ƒ[ä¸éœ€è¦è¿™ä¸ª](https://avro.apache.org/docs/1.11.1/getting-started-python/#serializing-and-deserializing-without-code-generation)ã€‚

# JSON

å¯¹äºåœ¨çº¿åº”ç”¨ç¨‹åºï¼Œç»“æ„åŒ–æ•°æ®é€šå¸¸ä»¥JavaScriptå¯¹è±¡è¡¨ç¤ºæ³•ï¼ˆJSONï¼‰æ ¼å¼è¿›è¡Œåºåˆ—åŒ–å’Œå‘é€ã€‚

è¿™æ„å‘³ç€å¤§éƒ¨åˆ†å¤§æ•°æ®ä»¥JSONæ ¼å¼æ”¶é›†å’Œå­˜å‚¨ã€‚

ç„¶è€Œï¼Œç”±äºJSONæ—¢ä¸é«˜åº¦ç±»å‹åŒ–ä¹Ÿæ²¡æœ‰ä¸°å¯Œçš„æ¨¡å¼ï¼Œå¤„ç†å¤§æ•°æ®æŠ€æœ¯å¦‚Hadoopä¸­çš„JSONæ–‡ä»¶å¯èƒ½ä¼šå¾ˆç¼“æ…¢ã€‚

åŸºæœ¬ä¸Šï¼Œå®ƒå¯¹å¤§æ•°æ®å¤„ç†æ¡†æ¶æ¥è¯´æ˜¯ä¸å¯è¡Œçš„ã€‚è¿™ä¹Ÿæ˜¯Parquetå’ŒORCæ ¼å¼è¢«åˆ›å»ºçš„ä¸»è¦åŸå› ã€‚

# å‹ç¼©

> *å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ*

å¦‚æœæˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯æé«˜æ•°æ®å¤„ç†æ€§èƒ½ï¼Œé‚£ä¹ˆé€‰æ‹©**å¯æ‹†åˆ†**å‹ç¼©ç±»å‹æ˜¯å¿«é€Ÿç­”æ¡ˆï¼›å¦‚æœå­˜å‚¨æˆæœ¬å‡å°‘æ˜¯æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡ï¼Œé‚£ä¹ˆé€‰æ‹©éå¯æ‹†åˆ†çš„å¦‚**GZIP**å’Œ**DEFLATE**ã€‚

> *ä»€ä¹ˆæ˜¯å¯æ‹†åˆ†çš„ï¼Ÿ*

***å¯æ‹†åˆ†***æ„å‘³ç€Hadoop Mapperå¯ä»¥æ‹†åˆ†æˆ–åˆ’åˆ†å¤§å‹æ–‡ä»¶å¹¶å¹¶è¡Œå¤„ç†å®ƒã€‚å‹ç¼©ç¼–è§£ç å™¨åœ¨å—çº§åˆ«åº”ç”¨å‹ç¼©ï¼Œå½“å®ƒåœ¨å—çº§åˆ«åº”ç”¨æ—¶ï¼Œå³ä½¿æ˜¯éå¸¸å¤§çš„æ–‡ä»¶ï¼Œæ˜ å°„å™¨ä¹Ÿå¯ä»¥åŒæ—¶è¯»å–å•ä¸ªæ–‡ä»¶ã€‚

è¯è™½å¦‚æ­¤ï¼Œ*å¯æ‹†åˆ†çš„*å‹ç¼©ç±»å‹æœ‰**LZO**ã€**LZ4**ã€**BZIP2**å’Œ**SNAPPY**ï¼Œè€Œ**GZIP**ä¸æ˜¯ã€‚è¿™äº›å‹ç¼©å™¨å’Œè§£å‹å™¨éå¸¸å¿«ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å®¹å¿è¾ƒå¤§çš„å­˜å‚¨ï¼Œé‚£ä¹ˆå®ƒæ¯”**GZIP**æ›´å¥½çš„é€‰æ‹©ã€‚

**GZIP**å¹³å‡å…·æœ‰30%çš„æ›´å¥½å‹ç¼©ç‡ï¼Œå¯¹äºä¸éœ€è¦é¢‘ç¹è®¿é—®ï¼ˆå†·å­˜å‚¨ï¼‰çš„æ•°æ®æ¥è¯´æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

# å¤–éƒ¨æ•°æ®åœ¨æ•°æ®æ¹–å’Œæ•°æ®ä»“åº“ä¸­

> *æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®ä»“åº“æŸ¥è¯¢å¤–éƒ¨æ•°æ®å­˜å‚¨å—ï¼Ÿ*

é€šå¸¸ï¼Œæ‰€æœ‰ç°ä»£æ•°æ®ä»“åº“éƒ½æä¾›å¤–éƒ¨åˆ†åŒºè¡¨åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®æ¹–ä¸­çš„æ•°æ®è¿›è¡Œåˆ†æã€‚

å½“ç„¶æœ‰ä¸€äº›é™åˆ¶ï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼Œå®ƒè¶³å¤Ÿå°†ä¸¤ä¸ªä¸–ç•Œè¿æ¥èµ·æ¥ï¼Œä»¥ä¾¿ç†è§£å®ƒçš„å·¥ä½œåŸç†ã€‚

ä¾‹å¦‚ï¼Œåœ¨BigQueryä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åœ¨æ•°æ®ä»“åº“ä¸­åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è¡¨ï¼š

[PRE0]

ä½ ä¼šæ³¨æ„åˆ°ï¼Œåœ¨ä»»ä½•æ•°æ®ä»“åº“ä¸­ï¼Œå¤–éƒ¨è¡¨çš„é€Ÿåº¦éƒ½è¾ƒæ…¢ï¼Œå¹¶ä¸”åœ¨è®¸å¤šæ–¹é¢å—é™ï¼Œä¾‹å¦‚å¹¶å‘æŸ¥è¯¢æ•°é‡æœ‰é™ã€ä¸æ”¯æŒæ•°æ®æ“ä½œè¯­è¨€ï¼ˆDMLï¼‰å’Œé€šé…ç¬¦æ”¯æŒï¼Œå¹¶ä¸”å¦‚æœåœ¨æŸ¥è¯¢è¿è¡ŒæœŸé—´åº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä¼šå‡ºç°ä¸ä¸€è‡´çš„é—®é¢˜ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯èƒ½æƒ³è¦åƒè¿™æ ·*åŠ è½½*å®ƒï¼š

[PRE1]

> æœ¬åœ°è¡¨æ›´å¿«ã€‚

å¦‚æœæœ‰å…¶ä»–æ•°æ®å¤„ç†å·¥å…·ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä½¿ç”¨ Hive åˆ†åŒºå¸ƒå±€ã€‚è¿™é€šå¸¸æ˜¯ä¸ºäº†å¯ç”¨å¤–éƒ¨åˆ†åŒºã€‚ä¾‹å¦‚ï¼š

[PRE2]

åœ¨è¿™é‡Œï¼Œåˆ†åŒºé”®å¿…é¡»å§‹ç»ˆä¿æŒç›¸åŒçš„é¡ºåºã€‚å¯¹äºåˆ†åŒºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ `key = value` å¯¹ï¼Œè¿™äº›å¯¹ä¹Ÿå°†ä½œä¸ºå­˜å‚¨æ–‡ä»¶å¤¹ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•å…¶ä»–æ”¯æŒ *HIVE* å¸ƒå±€çš„æ•°æ®å¤„ç†æ¡†æ¶ä¸­ä½¿ç”¨å®ƒã€‚

[](https://mydataschool.com/blog/hive-partitioning-layout/?source=post_page-----275876dc1fc9--------------------------------) [## Hive åˆ†åŒºå¸ƒå±€

### Lakehouse è®¾è®¡æ˜¯æˆ‘æœ€å–œæ¬¢çš„è®¾è®¡ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒèåˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ã€‚åœ¨æ•°æ®ä»“åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç®¡ç†â€¦

mydataschool.com](https://mydataschool.com/blog/hive-partitioning-layout/?source=post_page-----275876dc1fc9--------------------------------)

# ç»“è®º

å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹å¤æ‚åµŒå¥—æ•°æ®ç»“æ„è¿›è¡Œé«˜æ•ˆæŸ¥è¯¢çš„å¹³é¢åˆ—å¼æ ¼å¼æ”¯æŒï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ Parquetã€‚å®ƒä¸ Apache Spark é«˜åº¦é›†æˆï¼Œå¹¶ä¸”å®é™…ä¸Šæ˜¯è¯¥æ¡†æ¶çš„é»˜è®¤æ–‡ä»¶æ ¼å¼ã€‚

å¦‚æœæˆ‘ä»¬çš„æ•°æ®å¹³å°æ¶æ„ä¾èµ–äºä½¿ç”¨ Hive æˆ– Pig æ„å»ºçš„æ•°æ®ç®¡é“ï¼Œé‚£ä¹ˆ ORC æ•°æ®æ ¼å¼æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å®ƒå…·å¤‡åˆ—å¼æ ¼å¼çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œåœ¨åˆ†ææ•°æ®æ¹–æŸ¥è¯¢ä¸­è¡¨ç°å‡ºè‰²ï¼Œä½†ä¸ Hive å’Œ Pig æ›´å¥½åœ°é›†æˆã€‚å› æ­¤ï¼Œä¸ Parquet ç›¸æ¯”ï¼Œå®ƒçš„æ€§èƒ½å¯èƒ½æ›´å¥½ã€‚

å½“æˆ‘ä»¬éœ€è¦æ›´é«˜çš„å‹ç¼©æ¯”å’Œæ›´å¿«çš„è¯»å–æ—¶é—´æ—¶ï¼ŒParquet æˆ– ORC ä¼šæ›´åˆé€‚ã€‚ä¸ AVRO ç›¸æ¯”ï¼Œè¯»å–æ—¶é—´å¯èƒ½å¿«å¤šè¾¾ 3 å€ã€‚å¦‚æœæˆ‘ä»¬å‡å°‘é€‰æ‹©è¯»å–çš„åˆ—æ•°ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥æé«˜æ€§èƒ½ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬ä¸å¤ªæ‹…å¿ƒè¾“å…¥æ“ä½œçš„é€Ÿåº¦ï¼ŒAVRO å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå®ƒæä¾›äº†åˆç†çš„å‹ç¼©ï¼ˆä½¿ç”¨å¯æ‹†åˆ†çš„SNAPPYï¼‰ã€æ¨¡å¼æ¼”å˜æ”¯æŒï¼Œå¹¶ä¸”å†™å…¥é€Ÿåº¦æ¯”å…¶ä»–æ ¼å¼å¿«å¾—å¤šï¼ˆè®°ä½ï¼Œå®ƒæ˜¯åŸºäºè¡Œçš„ï¼‰ã€‚AVRO åœ¨*å†™å…¥å¯†é›†å‹*çš„å¤§æ•°æ®æ“ä½œä¸­ç»å¯¹é¢†å…ˆã€‚å› æ­¤ï¼Œå®ƒæ›´é€‚åˆç”¨äºæˆ‘ä»¬æ•°æ®å¹³å°æºå±‚çš„æ•°æ®å­˜å‚¨ã€‚

`GZIP`ã€`DEFLATE` å’Œå…¶ä»–ä¸å¯æ‹†åˆ†çš„å‹ç¼©ç±»å‹åœ¨å†·å­˜å‚¨ä¸­æ•ˆæœæœ€å¥½ï¼Œè¿™é‡Œä¸éœ€è¦é¢‘ç¹è®¿é—®æ•°æ®ã€‚

# æ¨èé˜…è¯»

[1\. https://cwiki.apache.org/confluence/display/hive/languagemanual+orc](https://cwiki.apache.org/confluence/display/hive/languagemanual+orc)

[2\. https://parquet.apache.org/](https://parquet.apache.org/)

[3\. https://avro.apache.org/](https://avro.apache.org/)

[4\. https://avro.apache.org/docs/1.11.1/getting-started-python/#serializing-and-deserializing-without-code-generation](https://avro.apache.org/docs/1.11.1/getting-started-python/#serializing-and-deserializing-without-code-generation)

[5\. https://avro.apache.org/docs/1.11.1/specification/](https://avro.apache.org/docs/1.11.1/specification/)

[6\. https://stackoverflow.com/questions/14820450/best-splittable-compression-for-hadoop-input-bz2](https://stackoverflow.com/questions/14820450/best-splittable-compression-for-hadoop-input-bz2)

[7\. https://stackoverflow.com/questions/35789412/spark-sql-difference-between-gzip-vs-snappy-vs-lzo-compression-formats](https://stackoverflow.com/questions/35789412/spark-sql-difference-between-gzip-vs-snappy-vs-lzo-compression-formats)

[https://medium.com/ssense-tech/csv-vs-parquet-vs-avro-choosing-the-right-tool-for-the-right-job-79c9f56914a8](https://medium.com/ssense-tech/csv-vs-parquet-vs-avro-choosing-the-right-tool-for-the-right-job-79c9f56914a8)

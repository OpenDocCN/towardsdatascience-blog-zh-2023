# åˆ›å»ºä½ è‡ªå·±çš„ç”Ÿæˆ AI æ–‡æœ¬åˆ°å›¾åƒ API

> åŸæ–‡ï¼š[https://towardsdatascience.com/create-your-own-generative-ai-text-to-image-api-548c07a4d839](https://towardsdatascience.com/create-your-own-generative-ai-text-to-image-api-548c07a4d839)

## å°†ä½ çš„éšæƒ³è½¬åŒ–ä¸ºæ°ä½œï¼ŒæŒ‰éœ€åˆ¶ä½œ

[](https://medium.com/@omermx?source=post_page-----548c07a4d839--------------------------------)[![å¥¥é»˜å°”Â·é©¬èµ«ç©†å¾·](../Images/0c87da4134bea397c77bc4ba6640e34b.png)](https://medium.com/@omermx?source=post_page-----548c07a4d839--------------------------------)[](https://towardsdatascience.com/?source=post_page-----548c07a4d839--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----548c07a4d839--------------------------------) [å¥¥é»˜å°”Â·é©¬èµ«ç©†å¾·](https://medium.com/@omermx?source=post_page-----548c07a4d839--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----548c07a4d839--------------------------------) Â·17åˆ†é’Ÿé˜…è¯»Â·2023å¹´4æœˆ12æ—¥

--

![](../Images/738244045935fe00f21f0a7c31c3f546.png)

å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨ Midjourney æ ¹æ®ä¸€èˆ¬å•†ä¸šæ¡æ¬¾ç”Ÿæˆã€‚

# TL;DR

+   ç”Ÿæˆ AI çš„æœ€æ–°è¿›å±•å¯¼è‡´äº†ä¸€ç³»åˆ—æœåŠ¡çš„æ¨å‡ºï¼Œå¦‚ DALL-E 2ã€Midjourney å’Œ Stability AIï¼Œå®ƒä»¬æœ‰æ½œåŠ›å½»åº•æ”¹å˜æˆ‘ä»¬å¯¹å†…å®¹åˆ›ä½œçš„æ–¹å¼ã€‚

+   åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•é€šè¿‡ API æ„å»ºå¹¶æä¾›ä½ è‡ªå·±é«˜æ€§èƒ½çš„æ–‡æœ¬åˆ°å›¾åƒæœåŠ¡ã€‚åŸºäº [ç¨³å®šæ‰©æ•£](https://github.com/CompVis/stable-diffusion) é€šè¿‡ [HuggingFace](https://medium.com/towards-data-science/whats-hugging-face-122f4e7eb11a)ï¼Œä½¿ç”¨ Vertex AI Workbench å’Œ Endpointsã€‚

# ğŸš£ğŸ¼ æˆ‘ä»¬æ˜¯å¦‚ä½•åˆ°è¾¾è¿™é‡Œçš„

æ­£å¦‚ä¹”æ²»Â·åŠ³é¡¿åœ¨ä»–çš„ [æ–‡ç« ](https://www.techtarget.com/searchenterpriseai/definition/generative-AI) ä¸­æåˆ°çš„ï¼šâ€œç”Ÿæˆ AI æ˜¯ä¸€ç§äººå·¥æ™ºèƒ½æŠ€æœ¯ï¼Œèƒ½å¤Ÿç”Ÿæˆå„ç§ç±»å‹çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘å’Œåˆæˆæ•°æ®ã€‚æœ€è¿‘å›´ç»•ç”Ÿæˆ AI çš„çƒ­è®®æ˜¯ç”±äºæ–°ç”¨æˆ·ç•Œé¢çš„ç®€ä¾¿æ€§ï¼Œè¿™äº›ç•Œé¢å¯ä»¥åœ¨å‡ ç§’é’Ÿå†…åˆ›å»ºé«˜è´¨é‡çš„æ–‡æœ¬ã€å›¾å½¢å’Œè§†é¢‘ã€‚â€[2]

æœºå™¨å­¦ä¹ å¹¶ä¸æ˜¯ä»€ä¹ˆæ–°é²œäº‹ï¼Œäº‹å®ä¸Šï¼Œè‡ª1960å¹´ä»£ä»¥æ¥ï¼Œå®ƒä»¥æŸç§å½¢å¼å­˜åœ¨ã€‚â€œä½†ç›´åˆ°2014å¹´ï¼Œéšç€ [ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ](https://en.wikipedia.org/wiki/Generative_adversarial_network)ï¼ˆGANsï¼‰çš„å¼•å…¥ï¼Œä¸€ç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç”Ÿæˆ AI æ‰å¾—ä»¥åˆ›é€ ä»¤äººä¿¡æœçš„çœŸå®äººç‰©å›¾åƒã€è§†é¢‘å’ŒéŸ³é¢‘ã€‚â€[2]

ç»“åˆèƒ½å¤Ÿæ¥æ”¶è‡ªç„¶è¯­è¨€æç¤ºå¹¶ç”Ÿæˆç…§ç‰‡çº§çœŸå®å›¾åƒçš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬åœ¨çŸ­æ—¶é—´å†…å–å¾—äº†å·¨å¤§çš„è¿›æ­¥ã€‚ç¬¬ä¸€ä¸ªåšåˆ°è¿™ä¸€ç‚¹çš„æ˜¯[OpenAIçš„DALLÂ·E](https://openai.com/product/dall-e-2)ï¼Œäº2022å¹´4æœˆæ¨å‡ºï¼Œéšåæ˜¯2022å¹´8æœˆçš„Disco Diffusionï¼Œæœ€ç»ˆè¢«ç¨³å®šæ‰©æ•£æ‰€å–ä»£ã€‚ä¸è¿™äº›äº§å“å¹¶è¡Œçš„æ˜¯ä¸€å®¶åä¸º[Midjourney](https://www.midjourney.com/home/?callbackUrl=%2Fapp%2F)çš„å…¬å¸ï¼Œå®ƒå¼€å‘äº†ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¨¡å‹ï¼Œé€šè¿‡ä¸Discordæœºå™¨äººäº’åŠ¨ä½¿ç”¨ã€‚

ä»é‚£æ—¶èµ·ï¼Œè‰ºæœ¯çŠ¶æ€çš„è¿›å±•ä»¤äººæƒŠå¹ã€‚ä¸‹é¢çš„æˆªå›¾å±•ç¤ºäº†ä»…åœ¨å‡ ä¸ªæœˆçš„æ—¶é—´å†…æ‰€å–å¾—çš„æˆå°±â€”â€”ä¸¤ä¸ªä¸åŒçš„æ¨¡å‹æä¾›äº†ç›¸åŒçš„æç¤ºï¼Œä½†æ—©æœŸæ¨¡å‹å’ŒåæœŸæ¨¡å‹ä¹‹é—´çš„å¯¹æ¯”éå¸¸æ˜æ˜¾ï¼

![](../Images/c0322ec3ed14c73845d0dc9300b08599.png)

*å›¾1ï¼šç”Ÿæˆæ€§äººå·¥æ™ºèƒ½è‰ºæœ¯çš„è¿›å±•ï¼Œç”±Disco Diffusionå’ŒMidjourneyç”Ÿæˆçš„å›¾åƒã€‚*

å¿«è¿›åˆ°2023å¹´ï¼ŒMidjourneyäº3æœˆ15æ—¥åˆšåˆšå‘å¸ƒäº†ç¬¬5ç‰ˆã€‚è¿™ä¸ªæ¨¡å‹å…·æœ‰éå¸¸é«˜çš„è¿è´¯æ€§ï¼Œæ“…é•¿è§£é‡Šè‡ªç„¶è¯­è¨€æç¤ºï¼Œåˆ†è¾¨ç‡æ›´é«˜ï¼Œå¹¶æ”¯æŒåƒé‡å¤å›¾æ¡ˆè¿™æ ·çš„é«˜çº§åŠŸèƒ½[4]ã€‚Stability AIä¹Ÿå‘å¸ƒäº†ç¨³å®šæ‰©æ•£2.1ã€‚è¿™äº›æ¨¡å‹çš„å‘å±•é€Ÿåº¦éå¸¸è¿…çŒ›ï¼

æ­£å¦‚å¾·å‹¤æœ€è¿‘å‘å¸ƒçš„[ç™½çš®ä¹¦](https://www2.deloitte.com/us/en/pages/consulting/articles/generative-artificial-intelligence.html)ä¸­æè¿°çš„ï¼šâ€œæˆ‘ä»¬æ„Ÿè§‰å¯èƒ½åªæ˜¯åˆšåˆšå¼€å§‹çœ‹åˆ°ç”Ÿæˆæ€§äººå·¥æ™ºèƒ½æ¨¡å‹æ‰€èƒ½å¸¦æ¥çš„å½±å“ã€‚è™½ç„¶æ—©æœŸçš„å¸å¼•åŠ›ä¸»è¦æ¥è‡ªæ¶ˆè´¹è€…å‘å¸ƒï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºå®šä¹‰æ—¶ä»£çš„é‡Œç¨‹ç¢‘ï¼Œä½†ç”Ÿæˆæ€§äººå·¥æ™ºèƒ½ä¹Ÿæœ‰æ½œåŠ›ä¸ºå‡ ä¹æ‰€æœ‰ç”Ÿæ´»é¢†åŸŸå¢åŠ æƒ…å¢ƒæ„è¯†å’Œç±»äººå†³ç­–èƒ½åŠ›ã€‚

å› æ­¤ï¼Œç”Ÿæˆæ€§äººå·¥æ™ºèƒ½å¸å¼•äº†æ¥è‡ªä¼ ç»Ÿï¼ˆä¾‹å¦‚é£é™©æŠ•èµ„ï¼ˆVCï¼‰ï¼Œå¹¶è´­ï¼ˆM&Aï¼‰ï¼‰å’Œæ–°å…´ï¼ˆä¾‹å¦‚ç”Ÿæ€ç³»ç»Ÿåˆä½œä¼™ä¼´ï¼‰æ¥æºçš„å…´è¶£ã€‚ä»…åœ¨2022å¹´ï¼Œé£é™©æŠ•èµ„å…¬å¸å°±æŠ•èµ„äº†è¶…è¿‡20äº¿ç¾å…ƒï¼Œç§‘æŠ€é¢†è¢–ä¹Ÿè¿›è¡Œäº†é‡è¦æŠ•èµ„ï¼Œå¦‚å¾®è½¯å¯¹OpenAIçš„100äº¿ç¾å…ƒæŠ•èµ„å’Œè°·æ­Œå¯¹Anthropicçš„3äº¿ç¾å…ƒæŠ•èµ„ã€‚â€[3]

# ğŸ§ ä»€ä¹ˆæ˜¯ç¨³å®šæ‰©æ•£ï¼Ÿ

ç¨³å®šæ‰©æ•£æ˜¯ä¸€ç§ç”¨äºäººå·¥æ™ºèƒ½æ–‡æœ¬ç”Ÿæˆå›¾åƒçš„æ–¹æ³•ï¼Œå®ƒåˆ©ç”¨æ‰©æ•£æ¨¡å‹ä»æ–‡æœ¬æè¿°ä¸­åˆ›å»ºå›¾åƒã€‚æ‰©æ•£æ¨¡å‹ä»ä¸€å¼ éšæœºå›¾åƒå¼€å§‹ï¼Œç„¶åé€æ­¥å‘å…¶ä¸­æ·»åŠ å™ªå£°ã€‚å™ªå£°ä»¥å—æ§çš„æ–¹å¼æ·»åŠ ï¼Œä½¿å¾—å›¾åƒä»ç„¶å¯ä»¥è¾¨è®¤ã€‚

åœ¨æ¯ä¸ªæ‰©æ•£æ­¥éª¤ä¸­ï¼Œå›¾åƒå˜å¾—æ›´åŠ ç²¾ç»†ï¼Œç»†èŠ‚å˜å¾—æ›´åŠ æ¸…æ™°ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæŒç»­å‡ ä¸ªæ‰©æ•£æ­¥éª¤ï¼Œç›´åˆ°ç”Ÿæˆçš„å›¾åƒè¢«è®¤ä¸ºâ€œç¨³å®šâ€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å·²ç»è¾¾åˆ°äº†ä¸€ä¸ªè¿›ä¸€æ­¥è¿­ä»£ä¸ä¼šæ”¹å–„å›¾åƒçš„ç‚¹ã€‚è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š

![](../Images/ce6279d504e7f24b30e95752aabbdd18.png)

*å›¾ 2ï¼šStable Diffusion è¿‡ç¨‹ï¼Œå›¾åƒæ¥æºï¼š* [*Benlisquare*](https://en.wikipedia.org/wiki/Stable_Diffusion#/media/File:X-Y_plot_of_algorithmically-generated_AI_art_of_European-style_castle_in_Japan_demonstrating_DDIM_diffusion_steps.png)*ï¼Œæ ¹æ®è®¸å¯å…±äº«ï¼š* [*CC BY-SA 4.0*](http://creativecommons.org/licenses/by-nc/4.0/)

æ‰©æ•£æ¨¡å‹åœ¨ä¸€ä¸ªå›¾åƒå’Œæ–‡æœ¬æè¿°çš„æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå®ƒå­¦ä¼šå°†æ–‡æœ¬æè¿°ä¸åŒ¹é…çš„å›¾åƒå…³è”èµ·æ¥ã€‚å½“ä½ ç»™æ‰©æ•£æ¨¡å‹ä¸€ä¸ªæ–°çš„æ–‡æœ¬æè¿°æ—¶ï¼Œå®ƒä¼šåˆ©ç”¨å…¶çŸ¥è¯†ç”Ÿæˆä¸€ä¸ªåŒ¹é…æè¿°çš„å›¾åƒã€‚

Stable Diffusion çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå®ƒéå¸¸å¿«é€Ÿã€‚å®ƒå¯ä»¥åœ¨å‡ ç§’é’Ÿå†…ä»æ–‡æœ¬æè¿°ç”Ÿæˆå›¾åƒã€‚è¿™æ¯”å…¶ä»–æ–¹æ³•ï¼ˆå¦‚ GANsï¼‰å¿«å¾—å¤šã€‚æˆ‘ä»¬çš„ç°ä»£ç«äº‰è€…ï¼ˆä¾‹å¦‚ Midjourneyã€DALL E ç­‰ï¼‰éƒ½ä½¿ç”¨æŸç§å˜ä½“çš„ Stable Diffusion æŠ€æœ¯ã€‚

ä½† Stable Diffusion å¹¶ä¸å®Œç¾ã€‚è™½ç„¶åœ¨è¿‡å»ä¸€å¹´ä¸­å®ƒçš„åº”ç”¨æœ‰äº†é£è·ƒå¼çš„è¿›æ­¥ï¼Œä½†æœ‰æ—¶ç”Ÿæˆçš„å›¾åƒå¯èƒ½ä¼šå¤±çœŸæˆ–ç¼ºä¹ç»†èŠ‚ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºåƒè¿™æ ·çš„æ¨¡å‹ä¼šæ ¹æ®è®­ç»ƒæ•°æ®æ¥â€œçŒœæµ‹â€å›¾åƒåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚éšç€è®­ç»ƒæ•°æ®é›†å’Œæ¨¡å‹ç®—æ³•çš„æ”¹è¿›ï¼Œè¿™ä¸ªé—®é¢˜å°†ä¼šå‡å°‘ã€‚

# ğŸ‘·ğŸ¾â€â™€ï¸ å¼€å§‹å§ï¼

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ä¸€äº›ä»£ç æ¥ï¼š

1.  **äº’åŠ¨åœ°å®éªŒ Stable Diffusion** æ¨¡å‹ï¼Œç”Ÿæˆä¸€äº›é…·ç‚«çš„è‰ºæœ¯ä½œå“ï¼

1.  **é€šè¿‡ç«¯ç‚¹æœåŠ¡æ¨¡å‹** ä½¿ç”¨ Vertex AIã€‚

1.  **ä½¿ç”¨ FLASK åˆ›å»ºä¸€ä¸ªç®€å•çš„ RESTful API**ã€‚

å½“ç„¶ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨æˆ‘ä»¬åœ¨å‰é¢ç« èŠ‚ä¸­æåˆ°çš„ç°æœ‰çš„é¢å‘æ¶ˆè´¹è€…çš„æ¨¡å‹ï¼Œä½†é‚£æ ·ä¼šæ²¡æœ‰ä¹è¶£å•Šï¼ŸğŸ˜œ

â¡ï¸ éšæ„è·³åˆ°ä½ æ„Ÿå…´è¶£çš„éƒ¨åˆ†ï¼

ğŸ‘¾ æˆ‘ä¼šæŠŠä»»ä½•ä»£ç ç‰‡æ®µï¼ˆå¦‚æœæ²¡æœ‰é“¾æ¥çš„è¯ï¼‰æ”¾åœ¨ä¸€ä¸ª github ä»“åº“ä¸­ï¼Œé“¾æ¥è§æœ€åçš„æœ‰ç”¨èµ„æºéƒ¨åˆ†

# ğŸ‘©ğŸ»â€ğŸ’» 1. å®éªŒ Stable Diffusion

å½“ä½ å¼€å§‹å¤„ç†ä¸€ä¸ªæ–°çš„æœºå™¨å­¦ä¹ é—®é¢˜æ—¶ï¼Œç¬”è®°æœ¬æä¾›äº†ä¸€ç§éå¸¸çµæ´»çš„æ–¹å¼æ¥æµ‹è¯•æ¨¡å‹å’Œå¿«é€Ÿè¿­ä»£ã€‚ä¹Ÿè®¸ä½ å–œæ¬¢åœ¨æœ¬åœ°ç¯å¢ƒä¸­è¿è¡Œ [Jupyter](https://jupyter.org/)ï¼Œä½¿ç”¨ [Kaggle Kernel](https://www.kaggle.com/code)ï¼Œæˆ–è€…æˆ‘ä¸ªäººæœ€å–œæ¬¢çš„ [Colab](https://colab.research.google.com/)ã€‚æœ‰äº†è¿™äº›å·¥å…·ï¼Œåˆ›å»ºå’Œå®éªŒæœºå™¨å­¦ä¹ å˜å¾—è¶Šæ¥è¶Šå¯åŠã€‚

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¿«é€Ÿçš„ç¬”è®°æœ¬ï¼Œå‘ä½ ä»‹ç» Stable Diffusion æ¨¡å‹

ğŸ’¨ å¦‚æœä½ æ²¡æœ‰æ—¶é—´ï¼ˆæˆ–ä¸æƒ³ï¼‰ä¸€æ­¥æ­¥æ„å»ºï¼Œå¯ä»¥æŸ¥çœ‹èµ„æºéƒ¨åˆ†ä¸‹è½½ç¬”è®°æœ¬æ–‡ä»¶ï¼

**å‰ææ¡ä»¶ï¼š**

+   ç”¨äºç™»å½• Colab å’Œä¿å­˜ç¬”è®°æœ¬çš„ Google è´¦æˆ·

+   HuggingFace è´¦æˆ·å’Œ API ä»¤ç‰Œï¼ˆå…è´¹ï¼‰

1. è®¿é—® [https://colab.research.google.com/](https://colab.research.google.com/)ã€‚è¿™å°†ä¸ºä½ åˆ›å»ºä¸€ä¸ªæ–°çš„ Python ç¬”è®°æœ¬ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°ä½ çš„ Google Drive ä¸­ã€‚

2. Colab å…è´¹æä¾›ï¼Œä½†å¦‚æœä½ éœ€è¦æ›´å¤šçš„å†…å­˜å’Œè®¡ç®—èµ„æºæ¥è¿è¡Œä½ çš„ç¬”è®°æœ¬ï¼Œä½ éœ€è¦ä»˜è´¹ã€‚æˆ‘ä»¬å°†åªä½¿ç”¨å…è´¹çš„èµ„æºï¼Œé¦–å…ˆä½ éœ€è¦é…ç½®ç¬”è®°æœ¬è¿è¡Œæ—¶ä»¥åŒ…å« GPU åŠ é€Ÿå™¨ã€‚ä½¿ç”¨ GPU ä¼šåŠ å¿«æ¨¡å‹ç”Ÿæˆå›¾åƒçš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ¨ç†ã€‚å…è´¹å±‚æä¾›äº† 12GB å†…å­˜çš„ NVIDIA Tesla T4 GPUï¼ˆè¿™å¯¹æˆ‘ä»¬è¦åšçš„äº‹æƒ…æ­£å¥½è¶³å¤Ÿï¼‰ã€‚ä»æ–‡ä»¶èœå•ä¸­é€‰æ‹© *è¿è¡Œæ—¶ -> æ›´æ”¹è¿è¡Œæ—¶ç±»å‹*ï¼Œç„¶åé€‰æ‹©ç¡¬ä»¶åŠ é€Ÿå™¨ = GPUã€‚

![](../Images/f221b1b327a28f16c52af8d6322c8787.png)

*å›¾ 3ï¼šColab ç¬”è®°æœ¬ï¼Œæ›´æ”¹ç¬”è®°æœ¬è¿è¡Œæ—¶ã€‚*

ç„¶åä½ éœ€è¦è¿æ¥åˆ°ä½ çš„è¿è¡Œæ—¶ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ‰§è¡Œç¬”è®°æœ¬ä¸­ç¼–å†™çš„ä»»ä½•ä»£ç ã€‚ç‚¹å‡» *è¿æ¥/é‡æ–°è¿æ¥ -> è¿æ¥åˆ°æ‰˜ç®¡è¿è¡Œæ—¶*ï¼š

![](../Images/ba22e38c451cbb8a3098582d01982b16.png)

*å›¾ 4ï¼šColab ç¬”è®°æœ¬ï¼Œâ€œ+ ä»£ç â€æŒ‰é’®æ·»åŠ å•å…ƒæ ¼ï¼Œä»¥åŠè¿æ¥åˆ°æ‰˜ç®¡è¿è¡Œæ—¶ã€‚*

3. ä¸€æ—¦ä½ è¿æ¥åˆ°ä½ çš„è¿è¡Œæ—¶ï¼Œå°±å¯ä»¥è¾“å…¥ä¸€äº›ä»£ç äº†ï¼ä½ å¯ä»¥åœ¨å•ä¸ªç¬”è®°æœ¬â€œå•å…ƒæ ¼â€ä¸­è¾“å…¥ä»£ç ï¼Œæˆ–è€…å¦‚æœä½ æƒ³å•ç‹¬æ‰§è¡Œæ­¥éª¤ï¼Œå¯ä»¥ä½¿ç”¨â€œ+ ä»£ç â€æŒ‰é’®åˆ›å»ºä¸€ä¸ªæ–°çš„â€œå•å…ƒæ ¼â€ã€‚æˆ‘å‘ç°å°†ä»£ç åˆ†è§£æˆå•å…ƒæ ¼å¾ˆæœ‰ç”¨ï¼Œè¿™æ ·æ›´å®¹æ˜“è¯†åˆ«å’Œè°ƒè¯•é—®é¢˜ã€‚æ¯ä¸ªå•å…ƒæ ¼åœ¨ä½ æ‚¬åœæ—¶éƒ½æœ‰ä¸€ä¸ªâ€œæ’­æ”¾â€æŒ‰é’®ï¼Œç‚¹å‡»å®ƒä»¥è¿è¡Œä»£ç ã€‚è¾“å…¥æˆ–å¤åˆ¶ç²˜è´´ä»£ç åˆ°æ–°çš„å•å…ƒæ ¼ä¸­åï¼Œä½ å¯ä»¥è¿è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

a. ç”±äºæˆ‘ä»¬éœ€è¦ä» HuggingFace æ‹‰å–æ¨¡å‹ï¼Œå› æ­¤éœ€è¦å®‰è£…ä¸€äº› Python åº“å¹¶ä½¿ç”¨ API ä»¤ç‰Œè¿›è¡Œè®¤è¯ï¼š

[PRE0]

b. æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ [ä½¿ç”¨ä½  HuggingFace è´¦æˆ·çš„ä»¤ç‰Œè¿›è¡Œè®¤è¯](https://huggingface.co/docs/hub/security-tokens#how-to-manage-user-access-tokens)ï¼Œå½“ä½ æ‰§è¡Œä»¥ä¸‹ä»£ç æ—¶ï¼Œä½ ä¼šåœ¨ç¬”è®°æœ¬ä¸­è¢«æç¤ºç²˜è´´ä½ çš„ HuggingFace API ä»¤ç‰Œï¼š

[PRE1]

c. æˆåŠŸç™»å½•ä½ çš„ HuggingFace è´¦æˆ·åï¼Œæˆ‘ä»¬å°†ä¸‹è½½ diffusers å’Œ transformers Python åº“ï¼š

[PRE2]

d. æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª StableDiffusion æ¨¡å‹ç®¡é“ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å°†æ¨¡å‹ä¼ é€’ä¸€äº›æ–‡æœ¬ï¼Œå¹¶æ ¹æ®è¯¥æç¤ºç”Ÿæˆå›¾åƒã€‚ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°æˆ‘ä»¬ä¼ é€’çš„å‚æ•°ä¹‹ä¸€æ˜¯ HuggingFace ä¸Šæ‰˜ç®¡çš„ Stable Diffusion æ¨¡å‹çš„è·¯å¾„ã€‚æ­¤å¸–å­ä¸­çš„ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯ v1.5ï¼Œä½ å¯ä»¥å°è¯•åœ¨å†™ä½œæ—¶äº¤æ¢ä¸ºæœ€æ–°çš„ï¼ˆv2.1ï¼‰ï¼š

[PRE3]

e. ç°åœ¨è¿›å…¥æœ‰è¶£çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆä¸€äº›è‰ºæœ¯ä½œå“ï¼åŠ è½½ torch Python åº“ï¼Œç„¶åæ·»åŠ ä¸€ä¸ªå•å…ƒæ ¼ï¼Œå°† prompt å˜é‡çš„å­—ç¬¦ä¸²å€¼æ›¿æ¢ä¸ºä½ æƒ³è¦çš„ä»»ä½•å†…å®¹ï¼æˆ‘æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»¥å¸®åŠ©ä½ å…¥é—¨ï¼š

[PRE4]

ä½ åº”è¯¥å¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ç»“æœï¼š

![](../Images/e98a0eeada649dd901d490466eea6b7c.png)

*å›¾ 5ï¼šColab ç¬”è®°æœ¬ï¼ŒStable Diffusion æ¨¡å‹ç”Ÿæˆçš„å›¾åƒè¾“å‡ºã€‚*

**ğŸ’¡æç¤ºï¼š** å¦‚æœä½ é‡åˆ°â€˜å†…å­˜ä¸è¶³â€™çš„é”™è¯¯ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨æ–‡æœ¬æç¤ºä¸Šæ–¹æ·»åŠ ä»¥ä¸‹ä»£ç è¡Œå®šæœŸæ¸…é™¤ GPU çš„ç¼“å­˜ï¼š

[PRE5]

åªéœ€åœ¨ä¸€ä¸ªç¬”è®°æœ¬ä¸­å†™å‡ è¡Œä»£ç ï¼Œä½ å°±å¯ä»¥ä»åŸºäºæ–‡æœ¬çš„æç¤ºç”Ÿæˆè‰ºæœ¯ä½œå“ï¼

# ğŸ¦ 2\. é€šè¿‡ Vertex AI ç«¯ç‚¹æœåŠ¡æ¨¡å‹

åˆ¶ä½œç”Ÿäº§åº”ç”¨ç¨‹åºæˆ–è®­ç»ƒå¤§å‹æ¨¡å‹éœ€è¦é¢å¤–çš„å·¥å…·æ¥å¸®åŠ©ä½ è¶…è¶Šç¬”è®°æœ¬ä¸­çš„ä»£ç ï¼Œå¹¶ä¸”ä½¿ç”¨äº‘æœåŠ¡æä¾›å•†å¯ä»¥æä¾›å¸®åŠ©ã€‚

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°† Stable Diffusion æ¨¡å‹æ‰“åŒ…ï¼Œå¹¶æ‰˜ç®¡åœ¨ä¸€ä¸ªå¯ä»¥å¤„ç†æ¥è‡ªåº”ç”¨ä»£ç çš„é¢„æµ‹è¯·æ±‚çš„ç«¯ç‚¹ä¸Šã€‚

ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–å…¬å…±äº‘æœåŠ¡æä¾›å•†æ¥å®ç°å¤§è‡´ç›¸åŒçš„ç»“æœï¼Œä½†æˆ‘å°†ä½¿ç”¨ Google Cloud Platform (GCP)ï¼Œç‰¹åˆ«æ˜¯å®ƒçš„ Vertex AI å·¥å…·é›†ï¼Œå› ä¸ºæˆ‘å¯¹æ­¤æœ€ä¸ºç†Ÿæ‚‰ã€‚

**å‰ææ¡ä»¶ï¼š**

+   å¯ç”¨è®¡è´¹çš„ GCP è´¦æˆ·/å…è´¹èµ·å§‹ç§¯åˆ†

+   å…·å¤‡ä¸€äº›åŸºæœ¬çš„ GCP ç®¡ç†çŸ¥è¯†ï¼Œä¾‹å¦‚å¦‚ä½•åˆ›å»ºé¡¹ç›®ã€è™šæ‹Ÿæœºã€å­˜å‚¨æ¡¶å’Œå…¶ä»–èµ„æºï¼Œ

+   é€šè¿‡ IAM ç»™æœåŠ¡è´¦æˆ·èµ‹äºˆæƒé™ï¼Œ

+   ä¸‹è½½æœåŠ¡è´¦æˆ·å¯†é’¥ï¼Œ

+   ä½¿ç”¨ Google Cloud SDK + ä¸€äº› Python ä»£ç ã€‚

1\. æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªé¢„æ„å»ºçš„ç¬”è®°æœ¬ç¤ºä¾‹ï¼š[https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/community/vertex_endpoints/torchserve/dreambooth_stablediffusion.ipynb](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/community/vertex_endpoints/torchserve/dreambooth_stablediffusion.ipynb)ï¼Œè¯¥ç¤ºä¾‹æ¥è‡ª GCP Vertex AI åœ¨ Github ä¸Šçš„å®˜æ–¹ä»“åº“ã€‚**æˆ‘ä¸ä¼šåœ¨è¿™é‡Œè¯¦ç»†å¤è¿°æ•´ä¸ªå†…å®¹**ï¼Œåªä¼šè§£é‡Šæœ€ç›¸å…³çš„éƒ¨åˆ†ä»¥åŠæˆ‘åœ¨å®é™…æ“ä½œä¸­é‡åˆ°çš„é—®é¢˜â€¦â€¦ä»£ç ç¤ºä¾‹é€šå¸¸æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆç®€å•ï¼

âš ï¸ **åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­åˆ›å»ºç”¨æˆ·ç®¡ç†çš„ç¬”è®°æœ¬å¹¶å°†æ¨¡å‹éƒ¨ç½²åˆ°ç«¯ç‚¹å°†äº§ç”Ÿè´¹ç”¨**ã€‚å½“ä½ ç¬¬ä¸€æ¬¡åˆ›å»º GCP è´¦æˆ·æ—¶ï¼Œå¯ä»¥è·å¾— $300 çš„å…è´¹ç§¯åˆ†ï¼Œä½†æ¨èçš„ç¡¬ä»¶é…ç½®ï¼ˆä»¥åŠæ¨¡å‹éƒ¨ç½²çš„ç«¯ç‚¹çš„ä»»ä½•åç»­è°ƒç”¨ï¼‰å¯èƒ½ä¼šå¾ˆå¿«æ¶ˆè€—è¿™äº›ç§¯åˆ†â€”â€”ä½ å·²ç»è¢«è­¦å‘Šäº†ã€‚æˆ‘å°†åœ¨â€œç»“è¯­â€éƒ¨åˆ†åˆ†äº«æˆ‘å®é™…äº§ç”Ÿçš„è´¹ç”¨ã€‚

2\. å¦‚æœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨ Vertex AIï¼Œè¯·ç™»å½•åˆ°ä½ çš„ GCP æ§åˆ¶å°ï¼Œå¹¶ç¡®ä¿ä» Vertex AI ä»ªè¡¨æ¿å¯ç”¨æ‰€æœ‰å¿…è¦çš„ APIï¼š

![](../Images/f5477d0fd316762a0569855edf4e1316.png)

*å›¾ 6: GCP ä¸­çš„ Vertex AI ä»ªè¡¨æ¿ï¼Œå¯ç”¨æ‰€æœ‰æ¨èçš„ API æŒ‰é’®ã€‚*

3\. æ‰“å¼€ [ç¬”è®°æœ¬](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/community/vertex_endpoints/torchserve/dreambooth_stablediffusion.ipynb)ï¼Œåœ¨æ ‡é¢˜ä¸‹æ–¹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€äº›æŒ‰é’®ï¼ŒåŒ…æ‹¬â€œåœ¨ Colab ä¸­è¿è¡Œâ€å’Œâ€œ**åœ¨ Vertex AI Workbench ä¸­æ‰“å¼€**â€ã€‚ä½ éœ€è¦ç‚¹å‡»åè€…ã€‚

4\. ç„¶åä½ éœ€è¦é…ç½®ä¸€ä¸ª VM å®ä¾‹æ¥æ‰˜ç®¡ç”¨æˆ·ç®¡ç†çš„ç¬”è®°æœ¬ã€‚ç¤ºä¾‹å»ºè®®ä½¿ç”¨å¸¦æœ‰ 85GB RAM çš„ NVIDIA A100 å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯â€œa2-highgpu-1gâ€ã€‚æ¨ç†ï¼ˆä»ç¬”è®°æœ¬ä¸­çš„ç¤ºä¾‹åˆ›å»ºå›¾åƒï¼‰å¾ˆå¿«ï¼Œå¤§çº¦ 11 ç§’é’Ÿå°±èƒ½ä» Stable Diffusion æ¨¡å‹ä¸­è¿”å›å›¾åƒã€‚

5\. ä¸€æ—¦ä½ çš„å®ä¾‹åˆ›å»ºå®Œæˆï¼Œä½ å¯ä»¥é€šè¿‡ *Workbench -> ç”¨æˆ·ç®¡ç†çš„ç¬”è®°æœ¬* è®¿é—®å®ƒã€‚

![](../Images/9f903e4a5efbd63cfc2ec27b1d02f917.png)

*å›¾ 7ï¼šVertex AI å·¥ä½œå°ï¼Œç”¨æˆ·ç®¡ç†çš„ç¬”è®°æœ¬åˆ—è¡¨ã€‚*

åœ¨ä½ æ·±å…¥å¹¶ç‚¹å‡» *OPEN JUPYTERLAB* ä¹‹å‰ï¼Œç¡®ä¿ç»™ä½ çš„ç¬”è®°æœ¬æ‰€åœ¨ VM çš„æœåŠ¡è´¦æˆ·æˆäºˆæƒé™ï¼Œä»¥ä¾¿è¿›è¡Œè¯¸å¦‚åˆ›å»ºå­˜å‚¨æ¡¶å’Œç«¯ç‚¹ç­‰æ“ä½œã€‚**ç”±äºå®ƒæ˜¯â€œç”¨æˆ·ç®¡ç†â€çš„ï¼Œè¿™ä¸ä¼šè‡ªåŠ¨ä¸ºä½ å®Œæˆã€‚**

6\. ç‚¹å‡»ç¬”è®°æœ¬åç§°ï¼Œåœ¨ç¬”è®°æœ¬è¯¦ç»†ä¿¡æ¯ä¸­ä½ å°†çœ‹åˆ°æ‰€æœ‰è€…æˆ–æœåŠ¡è´¦æˆ·åˆ«åã€‚

![](../Images/63111df16dbce5738f2d20cba3cb731a.png)

*å›¾ 8ï¼šVertex AIï¼Œç¬”è®°æœ¬è¯¦ç»†ä¿¡æ¯ã€‚*

7\. è½¬åˆ° *IAM & Admin -> IAM*ï¼Œç„¶åç‚¹å‡» *æˆäºˆè®¿é—®æƒé™*ï¼Œç²˜è´´æˆ–è¾“å…¥ä½ çš„ç¬”è®°æœ¬å®ä¾‹çš„æœåŠ¡è´¦æˆ·åˆ«åï¼Œä¸ºäº†ç®€åŒ–æ“ä½œï¼Œæˆ‘æˆäºˆäº†â€œç¼–è¾‘è€…â€è®¿é—®æƒé™ã€‚å¦‚æœä½ å¾ˆæŒ‘å‰”ï¼Œä½ å¯ä»¥åªæˆäºˆ `dreambooth_diffusion` ç¤ºä¾‹æ­¥éª¤æ‰€éœ€çš„ç‰¹å®šæƒé™ã€‚

![](../Images/a28ceee2caddfcc72ef7537fb5b7a97d.png)

*å›¾ 9ï¼šGCP IAM & Admin, IAM, ç¼–è¾‘è®¿é—®/åˆ†é…è§’è‰²ã€‚*

8\. ç°åœ¨ä½ åº”è¯¥å‡†å¤‡å¥½åœ¨ Jupyterlab ä¸­è¿è¡Œ `dreambooth_diffusion.ipynb` ç¬”è®°æœ¬ä»£ç äº†ï¼Œä»å·¥ä½œå°ä¸­æ‰“å¼€å®ƒï¼ˆå¦‚æ­¥éª¤ 5 æ‰€ç¤ºï¼‰ã€‚ç”±äºæŸç§åŸå› ï¼Œç¤ºä¾‹çš„ git ä»“åº“ä¸­çš„ä»£ç æ²¡æœ‰è¢«å¤åˆ¶åˆ°æˆ‘çš„ç¬”è®°æœ¬å®ä¾‹ä¸­ï¼Œæ‰€ä»¥æˆ‘åªæ˜¯æ‰“å¼€äº†ç»ˆç«¯å¹¶å¿«é€Ÿå…‹éš†äº† GitHub ä»“åº“ï¼š

[PRE6]

9\. ä¸€æ—¦ä½ åœ¨ Jupyterlab ä¸­æ‰“å¼€äº† `dreambooth_diffusion.ipynb`ï¼Œä½ åº”è¯¥èƒ½å¤Ÿè¿è¡Œç¬”è®°æœ¬å•å…ƒè€Œä¸ä¼šé‡åˆ°é‡å¤§é—®é¢˜ã€‚ç¬”è®°æœ¬çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯é€šè¿‡æ­¥éª¤ä¸‹è½½ Stable Diffusion æ¨¡å‹å¹¶ä»æç¤ºä¸­åˆ›å»ºå›¾åƒã€‚ä¸‹ä¸€æ­¥æ˜¯åˆ›å»º Vertex AI ç«¯ç‚¹å¹¶å°†æ¨¡å‹éƒ¨ç½²åˆ°é‚£é‡Œè¿›è¡ŒæœåŠ¡ã€‚

10\. æŒ‰ç…§ç¬”è®°æœ¬ä¸­çš„æ­¥éª¤è¿›è¡Œï¼š

a. åˆ›å»ºè‡ªå®šä¹‰ TorchServe å¤„ç†ç¨‹åºã€‚

b. å°†æ¨¡å‹å·¥ä»¶ä¸Šä¼ åˆ° Google Cloud Storageã€‚

c. ä½¿ç”¨æ¨¡å‹å·¥ä»¶å’Œé¢„æ„å»ºçš„ PyTorch å®¹å™¨é•œåƒåˆ›å»º Vertex AI æ¨¡å‹ã€‚

d. å°† Vertex AI æ¨¡å‹éƒ¨ç½²åˆ°ç«¯ç‚¹ä¸Šã€‚

åªè¦ä½ åœ¨ä¹‹å‰å¯ç”¨äº† Vertex APIï¼ˆå‚è§æ­¥éª¤ 2ã€‚å¦‚æœä½ å¿˜è®°äº†ï¼ï¼‰ï¼Œè¿™ä¸€åˆ‡åº”è¯¥éƒ½ä¼šé¡ºåˆ©è¿›è¡Œã€‚å¯¹æˆ‘è€Œè¨€ï¼Œåœ¨åˆ›å»ºç«¯ç‚¹ä¹‹åï¼Œæ¨¡å‹éƒ¨ç½²å¤§çº¦èŠ±è´¹äº† 30 åˆ†é’Ÿã€‚å½“å®ƒå‡†å¤‡å¥½æä¾›æœåŠ¡æ—¶ï¼Œä½ ä¼šåœ¨ *ç«¯ç‚¹* ä¸‹çœ‹åˆ°ç±»ä¼¼çš„å†…å®¹ï¼š

![](../Images/c7daecac9d9e3b07f85e43677b8db55e.png)

*å›¾ 10ï¼šVertex AI ç«¯ç‚¹ã€‚*

ä½ ç°åœ¨å‡†å¤‡å¥½ä»ä½ çš„ Stable Diffusion æ¨¡å‹ä¸­å¤„ç†è¯·æ±‚äº†ï¼ï¼æ­¤æ—¶ï¼Œå¦‚æœä½ æƒ³èŠ‚çœæˆæœ¬ï¼Œå¯ä»¥åœæ­¢ç¬”è®°æœ¬å®ä¾‹ VM å¹¶åˆ é™¤ä½ åˆ›å»ºçš„å­˜å‚¨æ¡¶ã€‚è¯·å‚è§ `dreambooth_diffusion.ipynb` æœ€åéƒ¨åˆ†çš„â€œæ¸…ç†â€æ­¥éª¤ã€‚

## ğŸ§ª æµ‹è¯•ä½ çš„ç«¯ç‚¹

è¦å‘ Vertex AI ç«¯ç‚¹å‘é€è¯·æ±‚ï¼Œä½ éœ€è¦ä½¿ç”¨æ”¯æŒå‘é€å…·æœ‰é€‚å½“ HTTP æ–¹æ³•å’Œè¯·æ±‚å‚æ•°çš„è¯·æ±‚çš„ HTTP å®¢æˆ·ç«¯åº“æˆ–å‘½ä»¤è¡Œå·¥å…·ã€‚

æˆ‘åœ¨æˆ‘çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿›è¡Œäº†æœ¬åœ°æµ‹è¯•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦ä¸‹è½½å¹¶å®‰è£… [Vertex AI Python SDK](https://cloud.google.com/python/docs/reference/aiplatform/latest/index.html#endpoints)ï¼Œç„¶ååˆ›å»ºå¹¶ä¸‹è½½ä¸€ä¸ªæœåŠ¡å¯†é’¥ç”¨äºè®¤è¯ã€‚

å¦‚æœä½ ä¿ç•™äº†ä½ çš„ç¬”è®°æœ¬å®ä¾‹è™šæ‹Ÿæœºï¼Œä½ å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„æœåŠ¡å¸æˆ·åˆ«åï¼Œæˆ–è€…åªéœ€åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡å¸æˆ·ï¼Œå…¶æƒé™è‡³å°‘åŒ…æ‹¬[ä»ç«¯ç‚¹è·å–é¢„æµ‹](https://cloud.google.com/vertex-ai/docs/general/iam-permissions)ã€‚

1\. è½¬åˆ° *IAM & Admin -> æœåŠ¡å¸æˆ·*ã€‚ç„¶åç‚¹å‡»æœåŠ¡å¸æˆ·åˆ«åå³ä¾§æ“ä½œä¸‹çš„ä¸‰ä¸ªç‚¹ï¼Œç„¶åç‚¹å‡» *ç®¡ç†å¯†é’¥*ï¼š

![](../Images/855a1d349360219d1836d9c84000eb22.png)

*å›¾ 11ï¼šGCP IAM & Adminï¼ŒæœåŠ¡å¸æˆ·ï¼Œç®¡ç†æœåŠ¡å¸æˆ·çš„å¯†é’¥ã€‚*

ç„¶åç‚¹å‡»*æ·»åŠ å¯†é’¥ -> åˆ›å»ºæ–°å¯†é’¥*ï¼Œå¹¶æŒ‰æ¨èçš„ .JSON æ ¼å¼ä¸‹è½½ï¼š

![](../Images/658dd6110b2eb15cc1c7f0f98d6f40c5.png)

*å›¾ 12ï¼šGCP IAM & Adminï¼ŒæœåŠ¡å¸æˆ·ï¼Œä¸ºæœåŠ¡å¸æˆ·åˆ›å»ºå¯†é’¥ã€‚*

âš ï¸ **è¯·è®°ä½ï¼ŒæœåŠ¡å¸æˆ·å¯†é’¥æ–‡ä»¶æˆäºˆä¸ä½ çš„ GCP é¡¹ç›®ä¸­æœåŠ¡å¸æˆ·ç›¸åŒçš„æƒé™ã€‚** å§‹ç»ˆéå¸¸å°å¿ƒå¤„ç†è¯¥æ–‡ä»¶ï¼Œåˆ é™¤å®ƒæ—¶ä¸è¦å†ä½¿ç”¨ï¼Œå¹¶ä¸”æ°¸è¿œä¸è¦å°†å…¶ä¸Šä¼ åˆ° Github ä»“åº“ï¼Œæˆ‘è§è¿‡å¤ªå¤šè¿™ç§æƒ…å†µï¼

2\. åœ¨ç»ˆç«¯çª—å£ä¸­ï¼Œæˆ–åœ¨ä½ è¿è¡Œä»£ç ä»¥æµ‹è¯•ç«¯ç‚¹çš„åœ°æ–¹ï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ªå˜é‡ä»¥æŒ‡å‘ä½ ä¸‹è½½çš„æœåŠ¡å¯†é’¥ã€‚è¿™å°†å¯¹ç«¯ç‚¹è¯·æ±‚è¿›è¡Œè®¤è¯ï¼š

[PRE7]

3\. ç°åœ¨åªéœ€ç”¨ä½ çš„é¡¹ç›®åç§°ã€åŒºåŸŸå’Œç«¯ç‚¹ ID ä¿®æ”¹è¿™ä¸ª Python ä»£ç ç‰‡æ®µã€‚å®ƒå°†å‘ä½ çš„ç«¯ç‚¹ä¼ é€’ä¸€ä¸ªæç¤ºï¼Œå¹¶å°†å“åº”ï¼ˆå³ç”± Stable Diffusion ç”Ÿæˆçš„å›¾åƒï¼‰å­˜å‚¨åœ¨ JPEG æ–‡ä»¶ä¸­ï¼š

[PRE8]

å¦‚æœä½ å®‰è£…äº† Vertex AI Python SDKã€è¿›è¡Œäº† GCP è®¤è¯ï¼Œå¹¶ä¸”ç«¯ç‚¹å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå‡ ç§’é’Ÿåä½ åº”è¯¥ä¼šçœ‹åˆ°ç”Ÿæˆçš„å›¾åƒæ–‡ä»¶å‡ºç°åœ¨ä½ çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼

# ğŸ 3\. ä½¿ç”¨ FLASK åˆ›å»ºä¸€ä¸ªç®€å•çš„ RESTful API

æ­¤æ—¶ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†è°ƒç”¨ç”Ÿæˆ AI æ¨¡å‹ç«¯ç‚¹çš„ä»£ç é›†æˆåˆ°ä½¿ç”¨ Vertex AI Python SDK çš„ç°æœ‰åº”ç”¨ç¨‹åºä¸­ã€‚

ä½†æˆ‘ç¡®å®æ‰¿è¯ºäº†ä¸€ä¸ª APIï¼Œæ‰€ä»¥æˆ‘å°†åœ¨è¿™ä¸€éƒ¨åˆ†çš„æœ€åéƒ¨åˆ†è¯¦ç»†ä»‹ç»å®ƒã€‚

**å‰ææ¡ä»¶ï¼š**

+   å®‰è£… [Flask](https://pypi.org/project/Flask/) å’Œ [Pillow](https://pypi.org/project/Pillow/) Python åº“ã€‚

+   [ä¸‹è½½ Postman](https://www.postman.com/downloads/?utm_source=postman-home) å¹¶å®‰è£…ï¼Œå®ƒæ˜¯å…è´¹çš„ï¼æˆ‘ä»¬å°†ç”¨å®ƒæ¥æ¨¡æ‹Ÿå¯¹æˆ‘ä»¬çš„ API çš„è°ƒç”¨ã€‚

1\. ä¸å‰ä¸€èŠ‚ä¸€æ ·ï¼Œç¡®ä¿ä½ æœ‰ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ŒæŒ‡å‘ä½ è®¡åˆ’è¿è¡Œä»£ç çš„åœ°æ–¹ï¼Œè¿™ä¸ªå˜é‡æŒ‡å‘ä½ çš„æœåŠ¡å¸æˆ·å¯†é’¥ã€‚

2\. è¿™æ˜¯ä½ éœ€è¦çš„ä»£ç ï¼Œç”¨äºä½¿ç”¨ Flask Web åº”ç”¨ç¨‹åºæ¡†æ¶åˆ›å»ºä¸€ä¸ªç®€å•çš„ RESTful APIã€‚è¯·å‚è§ä»£ç ä¸­çš„æ³¨é‡Šï¼Œäº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šä½¿ç”¨äº†ä¹‹å‰çš„ä»£ç æ¥æŸ¥è¯¢ç«¯ç‚¹ï¼Œå¹¶å°†å…¶å°è£…åœ¨ API è°ƒç”¨ä¸­ï¼š

[PRE9]

3\. è¿è¡Œç”Ÿæˆçš„æ–‡ä»¶ï¼Œä½ åº”è¯¥ä¼šæœ‰ä¸€ä¸ªæ‰˜ç®¡ä½  API çš„ Flask æœåŠ¡å™¨ï¼Œå‡†å¤‡æ¥æ”¶è¯·æ±‚ï¼š

![](../Images/7a83c0c778babc2f9b0881ebd22530da.png)

*å›¾ 13ï¼šMacOS ç»ˆç«¯ï¼Œæœ¬åœ°è¿è¡Œ Flask æœåŠ¡å™¨ã€‚*

4\. æ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯åŠ¨ Postmanï¼Œè¿›å…¥ *æ–‡ä»¶ -> å¯¼å…¥*ï¼Œç²˜è´´ä»¥ä¸‹ cURL å‘½ä»¤ï¼ˆå¦‚æœä½ çš„æœåŠ¡å™¨åœ°å€é…ç½®ä¸é»˜è®¤ä¸åŒï¼Œä½ å¯èƒ½éœ€è¦ä¿®æ”¹å®ƒï¼‰ï¼š

[PRE10]

æˆ‘ä»¬å¯ä»¥ä»ç»ˆç«¯è¿è¡Œè¿™ä¸ªï¼ŒAPI çš„å“åº”ä¼šè¢«ä¿å­˜ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„ JPEG å›¾åƒã€‚ä½†ä¸ºäº†æ¨¡æ‹Ÿä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè€Œä¸”å› ä¸ºæˆ‘æ²¡æœ‰æ—¶é—´ç¼–å†™ Discord æœºå™¨äººæˆ– HTML å‰ç«¯â€¦ ğŸ˜…

![](../Images/1ab9d69c5b3463030296060bc70e88b2.png)

*å›¾ 14ï¼šPostmanï¼ŒAPI è¯·æ±‚ç¤ºä¾‹ï¼ŒStable Diffusion æ¨¡å‹ç”Ÿæˆçš„å›¾åƒå“åº”ã€‚*

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªæ¼‚äº®ç”Ÿæˆçš„å›¾åƒï¼Œé€šè¿‡ä½ è‡ªå·±çš„ API æä¾›æœåŠ¡ã€‚ä½ å¯ä»¥åœ¨â€œBodyâ€æ ‡ç­¾ä¸‹ä¿®æ”¹æç¤ºï¼Œåˆ›é€ åŠ›æ˜¯å”¯ä¸€çš„é™åˆ¶ï¼

ğŸ—‘ï¸ **å®éªŒå®Œæˆäº†å—ï¼Ÿ** ä½ å¯ä»¥è¿”å›åˆ° *Vertex AI -> ç«¯ç‚¹*ï¼Œé€‰æ‹©ç«¯ç‚¹ï¼Œæ’¤é”€æ¨¡å‹éƒ¨ç½²ï¼Œè¿”å›ä¸Šä¸€å±‚åˆ é™¤å®ƒï¼ˆæç¤ºï¼šæ¯è¡Œæœ«å°¾çš„ä¸‰ç‚¹èœå•ï¼‰ã€‚ä»”ç»†æ£€æŸ¥ä½ æ˜¯å¦å…³é—­æˆ–åˆ é™¤äº†ä¸è¿™ç¯‡æ–‡ç« ç›¸å…³çš„ä»»ä½•å…¶ä»–å†…å®¹ï¼Œä»¥é¿å…æ¶ˆè€—èµ„æºã€‚ä½ ä¹Ÿå¯ä»¥æ’¤é”€ä½ åˆ›å»ºçš„æœåŠ¡è´¦æˆ·å¯†é’¥ï¼Œä»¥ç¡®ä¿å®‰å…¨ã€‚

âš ï¸ **æœ€åè­¦å‘Š â€”** è¿™æ˜¾ç„¶ä¸æ˜¯ç”Ÿäº§å°±ç»ªçš„ä»£ç ã€‚å¦‚æœä½ æ‰“ç®—è®©ä½ çš„ API å¯¹å¤–å…¬å¼€ï¼Œè¿˜æœ‰å¾ˆå¤šå·¥ä½œéœ€è¦åšï¼Œæ¯”å¦‚è®¤è¯ç­‰ï¼Œè¿™äº›è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼ç›¸å¯¹è€Œè¨€ï¼Œæˆ‘ä»¬çš„ç«¯ç‚¹æ¯æ¬¡è¯·æ±‚çš„æˆæœ¬ï¼ˆæˆ–è®¡ç®—æ—¶é—´ï¼‰ä¹Ÿæ¯” Midjourney æˆ– DALL-E 2 é«˜å¾—å¤šï¼Œå› æ­¤å¯èƒ½ä¸é€‚åˆä½œä¸ºæœåŠ¡ä¸Šçº¿ã€‚

# ğŸ† æ€»ç»“å’Œç»“æŸæ€è€ƒ

æˆ‘åœ¨å†™è¿™ç¯‡æ–‡ç« æ—¶**éå¸¸**å¼€å¿ƒï¼Œå¹¶ä¸”å­¦åˆ°äº†å¾ˆå¤šå…³äºç”Ÿæˆå¼ AIã€Stable Diffusion ä»¥åŠå°†å…¶æ‰“åŒ…æˆç±»ä¼¼ä»Šå¤©æµè¡Œçš„æ¶ˆè´¹è€…æœåŠ¡çš„å†…å®¹ã€‚æˆ‘å‘é‚£äº›ç«™åœ¨è¿™é¡¹æŠ€æœ¯æœ€å‰æ²¿çš„å¼€å‘å›¢é˜Ÿè‡´æ•¬ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªä»¤äººå…´å¥‹çš„é¢†åŸŸï¼

# ğŸ’¸ æˆæœ¬

æˆ‘æœ‰ç‚¹æ‹…å¿ƒè¿è¡Œå¤§å‹ GPU é™„åŠ å®ä¾‹ã€‚å¦‚æœä½ æ˜¯é•¿æœŸä½¿ç”¨å…¬å…±äº‘çš„ç”¨æˆ·ï¼Œä½ ä¼šçŸ¥é“æ²¡æœ‰é€‚å½“çš„æ£€æŸ¥å’Œåˆ¶è¡¡æœºåˆ¶ï¼Œå¾ˆå®¹æ˜“è¶…æ”¯ã€‚

åœ¨å†™å®Œè¿™ç¯‡æ–‡ç« çš„æœ€åï¼Œæˆ‘æŸ¥çœ‹äº† GCP æ§åˆ¶å°ä¸­çš„è´¦å•éƒ¨åˆ†ï¼Œçœ‹çœ‹èŠ±äº†å¤šå°‘é’±â€¦

![](../Images/f0e6619fbe9fabd43cfb448f83477b81.png)

*å›¾ 15ï¼šGCP è´¦å•ï¼ŒæŠ¥å‘Šã€‚*

åœ¨ä½¿ç”¨ GCP çš„ä¸¤å¤©é‡Œï¼Œä¸“é—¨ä¸ºè¿™ç¯‡æ–‡ç« åˆ›å»ºçš„é¡¹ç›®ä¸­ï¼Œæˆ‘èŠ±è´¹äº†å¤§çº¦ 40 ç¾å…ƒã€‚ä½ å¯ä»¥åœ¨ä¸Šé¢çš„æˆªå›¾ä¸­çœ‹åˆ°è¯¦ç»†åˆ†è§£ã€‚

å¤§éƒ¨åˆ†è´¹ç”¨ä¸æ¨ç†ç›¸å…³ï¼ˆå‚è§ Vertex AI æœåŠ¡æ¡ç›®ï¼‰ã€‚è¿™æ˜¯ä½¿æˆ‘çš„ç«¯ç‚¹èƒ½å¤Ÿä½¿ç”¨æˆ‘éƒ¨ç½²çš„ Stable Diffusion æ¨¡å‹ç”Ÿæˆå›¾åƒçš„â€œè®¡ç®—å°æ—¶â€è´¹ç”¨ã€‚

ç«¯ç‚¹ä½¿ç”¨äº†â€œVertex AI:åœ¨çº¿/æ‰¹å¤„ç†é¢„æµ‹ NVIDIA Tesla P100 GPU è¿è¡Œäºç¾æ´²çš„ AI å¹³å° SKUâ€ï¼Œè¿˜åŒ…æ‹¬è¿è¡Œé¢„å®šä¹‰å®ä¾‹çš„ä¸€äº›å…¶ä»–è´¹ç”¨ã€‚æˆ‘ä»¬æœ¬å¯ä»¥é€šè¿‡é€‰æ‹©æ›´ä¾¿å®œçš„ GPU å®¶æ—æ¥å‡å°‘å¼€æ”¯ï¼Œä½†è¿™å°†å¯¼è‡´ç”Ÿæˆå›¾åƒçš„æ—¶é—´å»¶é•¿ã€‚

ä¸å•†ä¸šä¸Šå¯ç”¨çš„è§£å†³æ–¹æ¡ˆç›¸æ¯”ï¼ŒMidjourney çš„ [åŸºç¡€è®¡åˆ’](https://docs.midjourney.com/docs/plans) æ¯æœˆè®¢é˜…è´¹ç”¨ä¸º 10 ç¾å…ƒã€‚è¿™ä¸ªè®¡åˆ’åŒ…æ‹¬æ¯æœˆ 3.3 å°æ—¶çš„å¿«é€Ÿ GPU è®¡ç®—ï¼Œè¶…å‡ºéƒ¨åˆ†è´¹ç”¨ä¸ºæ¯å°æ—¶ 4 ç¾å…ƒã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘è®©ç«¯ç‚¹è¿è¡Œäº†å¤§çº¦ 24 å°æ—¶ï¼ŒèŠ±è´¹äº† 30 ç¾å…ƒï¼Œæ²¡æœ‰å¹¶å‘æˆ–ä½œä¸šç­‰å¾…çš„é™åˆ¶ã€‚å†æ¬¡è¯´æ˜ï¼Œä¸ Midjourney è¿™æ ·çš„å®Œå…¨æ‰˜ç®¡æœåŠ¡ç›¸æ¯”ï¼Œå·¥ç¨‹å¸ˆä»¬å§‹ç»ˆåœ¨æ”¹è¿›æ¨¡å‹ï¼Œè€Œé€‰æ‹©åœ¨å¯æ‰©å±•çš„äº‘åŸºç¡€è®¾æ–½ä¸Šè¿­ä»£å’Œéƒ¨ç½²è‡ªå·±çš„æ¨¡å‹ä¹‹é—´å­˜åœ¨æƒè¡¡ã€‚

> **è¿™é‡Œéœ€è¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œä½ æ”¯ä»˜çš„ä¸æ˜¯æ¯æ¬¡é¢„æµ‹è¯·æ±‚çš„è´¹ç”¨ï¼Œè€Œæ˜¯ä½ çš„ç«¯ç‚¹è¿è¡Œçš„æ—¶é—´ä»¥åŠå®ƒæ‰€è¿è¡Œçš„å®ä¾‹çš„å¤§å°/ç±»å‹ã€‚**

æµ‹è¯•æ¨¡å‹å’Œé€šè¿‡ç”¨æˆ·ç®¡ç†çš„ç¬”è®°æœ¬å®é™…éƒ¨ç½²ç«¯ç‚¹çš„è´¹ç”¨ä¸åˆ° 10 ç¾å…ƒï¼ˆå‚è§è®¡ç®—å¼•æ“å’Œç¬”è®°æœ¬æ¡ç›®ï¼‰ã€‚

æ‰€ä»¥ï¼Œæœ¬æ–‡ç®€è¦æ¦‚è¿°äº†ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨ Stable Diffusion æŠ€æœ¯åˆ›å»ºè‰ºæœ¯çš„åº”ç”¨ã€‚æ¥ç€ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†ä¸€äº›ä»£ç ç¤ºä¾‹ï¼Œä»¥å±•ç¤ºä½¿ç”¨ Stable Diffusion æ¨¡å‹ç”Ÿæˆè‰ºæœ¯çš„æ­¥éª¤ï¼Œä»¥åŠå¦‚ä½•å°†å…¶éƒ¨ç½²åˆ°ç«¯ç‚¹å¹¶é€šè¿‡ API ä½¿ç”¨ã€‚**å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§ï¼** ğŸ‘‹ğŸ¼

æœ¬æ–‡ä¸­çš„æ•°æ®ç”±ä½œè€…åˆ›å»ºï¼Œé™¤éå¦æœ‰è¯´æ˜ã€‚

# ğŸ“‡ å‚è€ƒèµ„æ–™

[1] æœºå™¨å­¦ä¹ ï¼Œå†å²åŠå…¶ä¸å…¶ä»–é¢†åŸŸçš„å…³ç³»: [https://en.wikipedia.org/wiki/Machine_learning#History_and_relationships_to_other_fields](https://en.wikipedia.org/wiki/Machine_learning#History_and_relationships_to_other_fields)

[2] ä»€ä¹ˆæ˜¯ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ï¼Ÿä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡ï¼ŒGeorge Lawton: [https://www.techtarget.com/searchenterpriseai/definition/generative-AI](https://www.techtarget.com/searchenterpriseai/definition/generative-AI)

[3] ç”Ÿæˆå¼äººå·¥æ™ºèƒ½å¯¹ä¼ä¸šçš„å½±å“â€”â€”äººå·¥æ™ºèƒ½çš„æ–°å‰æ²¿ï¼ŒDeloitte LLP: [https://www2.deloitte.com/us/en/pages/consulting/articles/generative-artificial-intelligence.html](https://www2.deloitte.com/us/en/pages/consulting/articles/generative-artificial-intelligence.html)

[4] Midjourney æ–‡æ¡£ï¼Œç‰ˆæœ¬: [https://docs.midjourney.com/docs/model-versions#:~:text=Current%20Model,places%2C%20objects%2C%20and%20more](https://docs.midjourney.com/docs/model-versions#:~:text=Current%20Model,places%2C%20objects%2C%20and%20more)ã€‚

# ğŸ“š æœ‰ç”¨èµ„æº

+   ä½ å¯ä»¥ä»â€œ1. å®éªŒç¨³å®šæ‰©æ•£â€å’Œâ€œ2. é€šè¿‡ API æä¾›æ¨¡å‹ -> ç«¯ç‚¹â€ä¸­æ‰¾åˆ°å®Œæ•´çš„ç¬”è®°æœ¬ï¼ˆStableDiffusion_Hugging_Face.ipynbï¼‰å’Œ Python ä»£ç ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š[https://github.com/omermx/medium_text_to_image_api](https://github.com/omermx/medium_text_to_image_api)

+   ä½ å¯ä»¥å°†æˆ‘åœ¨ç¤ºä¾‹ä¸­ä½¿ç”¨çš„ç¨³å®šæ‰©æ•£ç‰ˆæœ¬ï¼ˆ1.5ï¼‰æ›¿æ¢ä¸ºå†™ä½œæ—¶çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆ2.1ï¼‰ï¼Œè¯·è®¿é—® Hugging Faceï¼š[https://huggingface.co/stabilityai/stable-diffusion-2-1](https://huggingface.co/stabilityai/stable-diffusion-2-1)

# 利用新图形工具彻底改变你的二分类分析，这一版本的binclass-tools

> 原文：[https://towardsdatascience.com/revolutionize-your-binary-classification-analysis-with-new-graphic-tools-in-binclass-tools-release-138793d5efd](https://towardsdatascience.com/revolutionize-your-binary-classification-analysis-with-new-graphic-tools-in-binclass-tools-release-138793d5efd)

## 在最新版本的binclass-tools中发现校准曲线、增益和提升图等强大功能——你解决二分类问题的**终极**方案！

[](https://lucazavarella.medium.com/?source=post_page-----138793d5efd--------------------------------)[![卢卡·扎瓦雷拉](../Images/6af72e50d79498ac378e2f1e469a0e65.png)](https://lucazavarella.medium.com/?source=post_page-----138793d5efd--------------------------------)[](https://towardsdatascience.com/?source=post_page-----138793d5efd--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----138793d5efd--------------------------------) [卢卡·扎瓦雷拉](https://lucazavarella.medium.com/?source=post_page-----138793d5efd--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----138793d5efd--------------------------------) ·阅读时间9分钟·2023年3月15日

--

![](../Images/fcef35a830c2dff148c8f38d56a4927c.png)

(图片来源于Unsplash)

**binclass-tools**包几天前达到了主要版本1.*并庆祝从PyPI获得**13K次下载**！新版本包含许多新功能，包括：

+   校准图

+   累积增益图

+   累积提升图

+   响应图

+   累积响应图

让我们更深入地探讨一下这个内容。

# 校准图

二分类模型性能评估可以通过使用校准图来辅助。这些图在评估预测概率与实际概率之间的对应程度时非常有用。校准的基本前提是，如果一个模型对一个观察值预测概率为0.8，那么实际情况下，这个观察值的正类概率也应为0.8。

要创建校准图，需要将预测概率分成离散的区间，例如0–0.1、0.1–0.2、0.2–0.3等。对于每个区间，需要计算平均预测概率以及利用真实标签和预测概率计算的正类比例。然后，将每个区间的平均预测概率与正类比例进行绘制。

这是来自*binclass-tools*的校准图示例：

![](../Images/ff5ec204867f0cfbb6c8e0f8b8e73b8a.png)

图1 — 校准曲线示例（图片由作者提供）

*图1* 显示了最佳的校准曲线，其形状为对角线。这种曲线对应于预测概率与实际概率完全匹配的情况。值得注意的是，不完美的校准曲线很常见，预测概率有时会高估或低估实际概率。

在*图1* 中，binclass-tools生成的校准曲线揭示了曲线上每个点的误差。校准曲线还可以帮助计算期望校准误差（ECE），该误差衡量了所有区间中预测概率与实际概率之间的平均差距。计算ECE时，将每个区间中预测概率的均值与正类比例之间的加权绝对差值相加，其中权重对应于区间的大小。

校准图在比较多个二分类模型时非常有用。通过比较不同模型的校准曲线，可以确定哪些模型校准得更好，并能够产生更精确的预测。Binclass-tools通过提供一个特殊功能来生成多个模型的校准曲线，从而简化了这一过程。

![](../Images/e4f598922c747106d628e99e35467beb.png)

图2 — 多个模型的校准曲线（作者提供的图像）

除了校准曲线，还可以生成每个模型的预测概率分布图。

预测概率分布图，也称为概率直方图或密度图，通常与校准曲线一起展示。这些图表展示了数据集中所有观察结果的预测概率分布。在二分类问题中，预测概率应范围在0到1之间，其中接近0的值表示属于正类的概率低，而接近1的值表示属于正类的概率高。

理想情况下，预测的概率分布应当经过良好的校准，大多数观察结果的预测概率应准确反映实际概率。一个经过良好校准的二分类器的预测概率分布应在0.5附近有一个峰值，这表明模型对正类和负类没有偏见。分布应逐渐在0和1附近下降，这表明模型可以对明显的正类或负类观察结果做出自信的预测。然而，预测概率分布在实际应用中可能会出现偏斜或多个峰值，表示模型校准不足，可能需要进一步调整。例如，如果直方图在0.5附近有一个峰值，但预测概率接近0或1的观察结果很少，这可能表明模型无法自信地区分正类和负类。

预测概率分布图提供了评估模型校准效果并识别可能改进区域的有用手段。检查预测概率的分布可以提供对模型表现的洞察，并帮助指出可能需要进一步优化的具体区域。

# 累积增益图

累积增益图是二分类模型识别正类能力的可视化展示。它指示在检查特定百分比的总体中，能够识别出的正类观察值的百分比。

创建此图的过程涉及将数据集中的观察值按预测概率递减排序。然后，将排序后的观察值分隔到预定数量的箱或百分位中，每个箱包含总人口的相同比例。累积增益图显示了每个箱中正类观察值的累积百分比，从最高到最低预测概率进行排列。图表的x轴反映了所考虑的人口百分比，范围从0%到100%，而y轴显示了在该人群中可以识别的正类观察值的百分比。

这里是一个来自*binclass-tools*的累积增益图示例：

![](../Images/804f63345861769c99bf3bf734983472.png)

图3 — 来自binclass-tools的累积增益曲线示例（图像由作者提供）

对于二分类器，一个理想的累积增益图应该是一条从原点延伸到右上角的直线，这表明模型能够有效地识别正类观察值，而不管所考虑的总体百分比。在实际操作中，难以实现完美的累积增益图，但接近对角线的模型被认为表现更好。

然而，在某些情况下，累积增益图偏离理想对角线的模型可能更为可取。例如，用于识别欺诈者的模型可能能够通过分析仅23%的按预测概率递减排序的人群来检测80%的欺诈者，如图3所示。如果目标是在有限资源下尽可能多地识别欺诈者，则该模型是合适的。然而，重要的是要在不同的总体百分位上评估模型的表现，以确定需要进一步改进的地方。

# 累积提升图

一种称为累积提升图或提升曲线的图表展示了二分类模型识别正类观察值的效果。为了将模型的表现与随机分类器进行比较——随机将正类或负类标签分配给数据集中的每个观察值——使用了提升图。

数据集在观测值按其预测正样本概率排序后，分成等大小的区间，也称为分位数或十位数。然后通过将观察到的正样本率除以该区间的预期正样本率来计算每个区间的提升值，并绘制出到达每个百分位数的累计提升值。

这是一个来自*binclass-tools*的提升曲线示例：

![](../Images/87e964040c6629cb7bbbfc8c9781e0e7.png)

图4 — binclass-tools中的提升曲线示例（作者提供的图像）

提升值表示模型在识别正样本的能力相较于随机分类器的改进。累计提升图中的随机模型线是一条水平线，从图的一端延伸到另一端，高度等于总体正样本率。提升值为1意味着模型的表现与随机分类器相同，而提升值大于1则表明模型在识别正样本方面优于随机分类器。如*图4*所示，选择按递减预测概率排序的前44%的观测样本，会得到2.2倍于随机模型预期的目标类样本比例。

因此，理想的累计提升图应是一条显著高于随机模型线的曲线，表明模型能比随机选择更有效地识别正样本。

# 响应图

答复可视化是一种用于评估二分类模型效率的图形表示形式。它是一个二维图示，显示了将预测概率排序后的十个等大小组中每组实际正样本的百分比。与之前的图表一样，响应可视化在x轴上以递减顺序显示预测概率的十位数，而y轴则表示每组实际正样本的百分比。

这是一个来自*binclass-tools*的响应曲线示例：

![](../Images/44b696c61121c5a67426e0675509bc4c.png)

图5 — binclass-tools中的响应曲线示例（作者提供的图像）

衡量二元分类模型性能的可靠方法是响应图。响应图显示每个预测概率十等分中实际正类观察的比例。在理想的响应图中，一个经过良好校准、预测能力强的模型应在预测概率的初始十等分中表现出实际正类观察的比例快速上升，随后在后续十等分中逐渐增加。例如，在*图 5* 中，第 2 十等分的 65% 的观察值被识别为目标类（类 1）。

随机模型的预期表现将是一条水平的平坦线，横跨整个图示，这对应于所有预测概率的十等分中正类观察的均匀分布。这是因为随机模型无法区分正类和负类，导致它无法提供任何预测能力。

# 累积响应图

与响应图相反，累积响应图计算当前正类观察的百分比，累计计算所有十等分，从最初的一个到正在分析的一个。

这是一个来自*binclass-tools* 的累积响应曲线示例：

![](../Images/ccb14f9c14fa810cc339bf2ce2056c21.png)

图 6 — binclass-tools 中的累积响应曲线示例（图片由作者提供）

在这种情况下，累积响应图不会穿过随机模型线，因为随机模型在第 10 十等分的累积响应值等于正类总比例，这与其他模型在第 10 十等分的累积响应值相同。

累积响应图是最常用的图之一，因为它回答了即使是非专业数据科学家也会提出的简单问题：“如果我们应用模型并选择最多到第 X 十等分，选择中目标类观察的预期百分比是多少？”。

例如，从*图 6* 中我们可以看到，百分位数从 1 到 29 的 63% 的观察值属于目标类。

# 太棒了！但是我如何绘制这些精彩的曲线呢？

要创建这些曲线的简单图示，你可以使用 Python *binclass-tools* 包，该工具在 GitHub 上作为开源工具提供。有关如何使用这些函数生成前述图示和示例代码的更多信息，请参阅项目的 GitHub 页面：

[](https://github.com/lucazav/binclass-tools?source=post_page-----138793d5efd--------------------------------) [## GitHub - lucazav/binclass-tools: binclass-tools 包含一组 Python 包装器和…]

### binclass-tools软件包包含一组Python封装器和交互式图表，有助于分析…

github.com](https://github.com/lucazav/binclass-tools?source=post_page-----138793d5efd--------------------------------)

请注意，本文中呈现的图表已添加到该软件包的1.0.0版本。如果你对早期版本中实现的图表背后的理论感兴趣，可以参考这篇关于交互式混淆矩阵的文章：

[](/finding-the-best-classification-threshold-for-imbalanced-classifications-with-interactive-plots-7d65828dda38?source=post_page-----138793d5efd--------------------------------) [## 寻找不平衡分类的最佳分类阈值，使用交互式图表

### 使用binclass-tools这个令人惊叹的Python软件包，将你的二分类问题分析提升到一个新水平！

towardsdatascience.com](/finding-the-best-classification-threshold-for-imbalanced-classifications-with-interactive-plots-7d65828dda38?source=post_page-----138793d5efd--------------------------------)

以及这篇关于交互式ROC和精准度-召回率图的文章：

[](/roc-and-pr-curves-probabilities-distribution-and-density-plots-now-in-binclass-tools-python-9351681a3803?source=post_page-----138793d5efd--------------------------------) [## ROC和PR曲线，概率分布和密度图，现在在binclass-tools Python中…

### binclass-tools软件包现在提供标准的二分类图表

towardsdatascience.com](/roc-and-pr-curves-probabilities-distribution-and-density-plots-now-in-binclass-tools-python-9351681a3803?source=post_page-----138793d5efd--------------------------------)

一如既往，欢迎对新软件包功能提供反馈。

["```py\n# Code snippet taken from <https://github.com/KonradHabel/learning_equality/blob/master/eval_cpu.py>\nfrom torch.quantization import quantize_dynamic\n\nmodel.transformer.embeddings = quantize_dynamic(model.transformer.embeddings, None, dtype=torch.float16)\n\nfor i in range(config.num_hidden_layers):\n    model.transformer.encoder.layer[i].attention = quantize_dynamic(model.transformer.encoder.layer[i].attention, None, dtype=torch.qint8)\n    model.transformer.encoder.layer[i].intermediate = quantize_dynamic(model.transformer.encoder.layer[i].intermediate, None, dtype=torch.float16)\n    model.transformer.encoder.layer[i].output = quantize_dynamic(model.transformer.encoder.layer[i].output, None, dtype=torch.float16)\n```"]
- en: 'Beginner Tutorial: Connect GPT Models with Company Data in Microsoft Azure'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/beginner-tutorial-connect-gpt-models-with-company-data-in-microsoft-azure-81177929da18](https://towardsdatascience.com/beginner-tutorial-connect-gpt-models-with-company-data-in-microsoft-azure-81177929da18)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Using OpenAI Studio, Cognitive Search and Storage Accounts
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@ebbeberge?source=post_page-----81177929da18--------------------------------)[![Eirik
    Berge, PhD](../Images/7507374e75980fd0c1056af3cd299eaa.png)](https://medium.com/@ebbeberge?source=post_page-----81177929da18--------------------------------)[](https://towardsdatascience.com/?source=post_page-----81177929da18--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----81177929da18--------------------------------)
    [Eirik Berge, PhD](https://medium.com/@ebbeberge?source=post_page-----81177929da18--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----81177929da18--------------------------------)
    ·10 min read·Oct 15, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d22b9b079dd194d6d903faa1cdd85800.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Volodymyr Hryshchenko](https://unsplash.com/@lunarts?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Overview
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Introduction](#a6cb)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Setting up the Data](#4b3e)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Creating an Index and Deploying a Model](#414d)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Other Considerations](#ded8)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Wrapping Up](#c801)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There has been a lot of hype in the last year about GPT models and generative
    AI in general. While promisesabout a full technological revolution can seem somewhat
    overblown, it is true that **GPT models are impressive in many ways**. However,
    the true value of GPT models comes when connecting them to internal documents.
    Why is this? 🤔
  prefs: []
  type: TYPE_NORMAL
- en: 'When you use plain vanilla GPT models provided by OpenAI, they do not really
    understand the inner workings of your company. If you ask it questions, it will
    **answer based on what it most likely finds out about other companies**. This
    is a problem when you want to use GPT models to ask questions like:'
  prefs: []
  type: TYPE_NORMAL
- en: What are the steps in an internal procedure that I must follow?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What is the full interaction history between my company and a specific customer?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who should I call if I have any issues with a specific software or routine?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Trying to ask plain vanilla GPT models these questions will give you nothing
    of value (try it!). But if you connect GPT models to your internal data, then
    you can get meaningful answers to these questions and many others.
  prefs: []
  type: TYPE_NORMAL
- en: '**In this tutorial, I want to show you how to connect GPT models with internal
    company data in Microsoft Azure.** Just in the last few months, this has become
    a lot simpler. I will walk slowly through setting up resources and doing the necessary
    configurations. This is a beginner tutorial, so if you are very comfortable with
    Microsoft Azure, then you can probably skim through the tutorial.'
  prefs: []
  type: TYPE_NORMAL
- en: 'You need to have two things before proceeding to follow along:'
  prefs: []
  type: TYPE_NORMAL
- en: A Microsoft Azure tenant where you have sufficient permissions to upload documents,
    create resources, etc.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As of publishing, your company needs to apply to get access to the Azure OpenAI
    resource that we will be using. This will probably be lifted sometime in the future,
    but for now, this is required. The time it takes after applying until you get
    access is a few days.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NOTE:** The real difficulty with making amazing AI assistants comes down
    to data quality, scoping the project correctly, understanding user needs, user
    testing, automating data ingestion, and much more. So don’t leave the tutorial
    thinking that creating a great AI assistant is simple. It is merely that setting
    up the infrastructure is simple.'
  prefs: []
  type: TYPE_NORMAL
- en: Setting up the Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Everything starts with data. The first step is to upload some internal company
    data to Azure. In my example, I will use the following text that you can also
    copy and use:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Save the text into a text file called `company_info.txt` and store it somewhere
    convenient. Now we will go to Microsoft Azure and upload the text document. Search
    the marketplace on Azure to find the **Storage account** resource:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/59cff553ceaa3661729e6422137d0157.png)'
  prefs: []
  type: TYPE_IMG
- en: 'When creating Azure resources there are many fields that you can fill out.
    For a storage account, the important ones are:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Subscription:** The [subscription](https://learn.microsoft.com/en-us/microsoft-365/enterprise/subscriptions-licenses-accounts-and-tenants-for-microsoft-cloud-offerings?view=o365-worldwide#subscriptions)
    you want to create the storage account in.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group:** The [resource group](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal#what-is-a-resource-group)
    you want to create the storage account in. You might also decide to create a new
    resource group for this tutorial.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Storage account name:** A unique name across all Azure accounts that is between
    3 and 24 characters long. It can only contain lowercase letters and numbers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Region:** The Azure region that will host the data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Performance:** The choice *Standard* is good enough for testing.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Redundancy:** The choice of *Locally-redundant storage* is good enough for
    testing.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once you’ve clicked **review** and then **create** there should be a storage
    account waiting for you in the resource group you chose within a few minutes.
    Once you go into the storage account, go to `Containers` on the left sidebar:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/344d1efa79db4becf1aa3297f652467d.png)'
  prefs: []
  type: TYPE_IMG
- en: In there, you can create a new container that essentially works as a namespace
    for your data. I named my container `newcontainer` and entered it. You can now
    see an upload button in the upper left corner. Click upload and then locate the
    beloved `company_info.txt` file you saved earlier.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f26ec02f55750367e09e9a1ac90b85e0.png)'
  prefs: []
  type: TYPE_IMG
- en: Now our data is in Azure. We can proceed to the next step 🔥
  prefs: []
  type: TYPE_NORMAL
- en: Creating an Index and Deploying a Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When I read a cookbook, I often consult the **index** at the back of the book.
    An index tells you quickly which recipe is on which page. Looking through the
    whole book every time I want to make pancakes is not good enough in a busy world.
  prefs: []
  type: TYPE_NORMAL
- en: Why am I telling you this? Because we are also going to make indexes for our
    internal data that we uploaded in the previous section! This will make sure that
    we can quickly locate relevant information in our internal documents. This way,
    don’t need to send all the data with every question to GPT models. This would
    not only be costly but also not possible for even medium-sized data sources due
    to the token limits in GPT models.
  prefs: []
  type: TYPE_NORMAL
- en: 'We’re going to need an **Azure Cognitive Search** resource. This is a resource
    that will help us to automatically index our documents. As before, head over to
    the Azure marketplace and find the Cognitive Search resource:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2585b2e773ceecb71a7979c183748a87.png)'
  prefs: []
  type: TYPE_IMG
- en: When creating the Azure cognitive search resource, you should choose the same
    **subscription, resource group,** and **location** as for the storage account.
    Give it a unique **service name** and choose the pricing tier *Standard*. Proceed
    by clicking the **Review** button and then click the **Create** button.
  prefs: []
  type: TYPE_NORMAL
- en: When it is completed, we are actually going to create another resource, namely
    the `Azure OpenAI` resource. The reason is that we are not going to create the
    index in the Cognitive Search resource, but rather do it indirectly from the Azure
    OpenAI resource. This is more convenient for simple applications where you don’t
    need a lot of fine-tuning of the index.
  prefs: []
  type: TYPE_NORMAL
- en: 'Head again over to the Azure marketplace and find the Azure OpenAI resource:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8f9d00a939a6df62ba311263c2c2ff49.png)'
  prefs: []
  type: TYPE_IMG
- en: You need to pick the same subscription, resource group, and region as the other
    resources. Give it a name and select the pricing tier `Standard SO`. Click your
    way towards the `Review and Submit` section, and then click `Create`. This was
    the final resource you needed for the tutorial. Grab a coffee or another beverage
    while you wait for the resource to complete.
  prefs: []
  type: TYPE_NORMAL
- en: 'When inside the Azure OpenAI resource, you should see something like this in
    the `Overview` section:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c25f1111e77711815d8bb35ade4a4f5e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on `Explore` , which takes you to `Azure OpenAI Studio`. In the studio,
    you can deploy models and connect your internal data by using a graphical user
    interface. You should now see something like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8058e32ee66eb1ca15e62d7d508c58c6.png)'
  prefs: []
  type: TYPE_IMG
- en: Let us first create a deployment of a GPT model. Head over to the `Models` section
    on the left sidebar. This will show you the available model that you can use.
    The models you see might be different than mine, based on the region you have
    chosen. I will select the model `gpt-35-turbo` and click `Deploy`. If you don’t
    have access to this model, then pick another one.
  prefs: []
  type: TYPE_NORMAL
- en: Pick a `Deployment name` and create the deployment. If you head over to the
    `Deployments` section on the left sidebar, then you can see your deployment. We
    will head over to the section `Chat` on the left sidebar where we will start to
    connect the data through an index.
  prefs: []
  type: TYPE_NORMAL
- en: 'You should see a tab called `Add you data (preview)` that you can select:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/265a10f0438fbeb54af4e8bafd12ef47.png)'
  prefs: []
  type: TYPE_IMG
- en: 'When you are reading this tutorial, this feature might be out of preview mode.
    Select `Add a data source` and select `Azure Blob Storage` as your data source.
    The rest of the information you need to input are the subscription, Azure Blob
    storage resource, the storage container where you placed the document `company_info.txt`
    , and the Azure Cognitive Search resource we created:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e9b21285a5f4036d954add22a87569f6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Enter an index name and leave the option `Indexer schedule` as `Once`. This
    is how often the index should be updated based on potentially new data. Since
    our data won’t change, we pick `Once` for simplicity. Accept that connecting to
    an Azure Cognitive Search account will incur usage charges and continue. You can
    pick `Keyword` as the `Search type` under `Data management`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/990e9bd84e2f7bcf35708c80195edf58.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click `Save and close` and wait for the indexing to finish. Now the deployed
    GPT model has access to your internal data! You can ask a question in the `Chat
    session` to try it out:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/543aa6e3a84e91421a3b43855f8c4d7f.png)'
  prefs: []
  type: TYPE_IMG
- en: The chatbot gives the correct answer based on the internal documents 😍
  prefs: []
  type: TYPE_NORMAL
- en: It gives a reference to the correct document so that you can check out the source
    material for confirmation.
  prefs: []
  type: TYPE_NORMAL
- en: There is also a button called `View code`, where you can see the requests made
    in various programming languages. You can send this request from anywhere, as
    long as you include the endpoint and access keys listed. Hence you are not limited
    to the playground here, but can incorporate this into your own applications.
  prefs: []
  type: TYPE_NORMAL
- en: You have now successfully connected a GPT model with internal data! Sure, the
    internal data is not very interesting in our tutorial. But you can imagine doing
    this with more pressing material than desk policies.
  prefs: []
  type: TYPE_NORMAL
- en: Other Considerations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Here I want to point you towards some further things to play with.
  prefs: []
  type: TYPE_NORMAL
- en: System Messages
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You can also specify a system message in the Chat playground:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b133c9c7f4e8b21bdb7f0d85d8c1f7e4.png)'
  prefs: []
  type: TYPE_IMG
- en: This is sometimes called a `pre-prompt` in other settings. This is a message
    that is sent every time before the actual question is being asked by the user.
    The purpose is here to give context to the GPT model about the task at hand. It
    defaults to something generic like `You are an AI assistant that helps people
    find information`.
  prefs: []
  type: TYPE_NORMAL
- en: You can change the system message to request a specific format of the response,
    or to change the tone of voice for the answer. Feel free to play around with this.
  prefs: []
  type: TYPE_NORMAL
- en: Parameters
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You can find a `Configuration` panel (it is either already visible or you need
    to go to `Show panels` and select it). It looks something like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4afd09c8915f93029ce3abc9505d7e9c.png)'
  prefs: []
  type: TYPE_IMG
- en: Here you can tweak many parameters. Maybe the most important one is `Temperature`,
    which indicates how deterministic the answer should be. A low value indicates
    highly deterministic, so it will give roughly the same answer each time. A high
    value is the opposite, so the answer is more varied each time. A high value often
    makes the model seem more creative.
  prefs: []
  type: TYPE_NORMAL
- en: Deploying to a web app
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: When you have finished your tweaking of system messages and parameters, you
    might want to deploy the model to a web application. This can be done rather easily
    from within the Azure OpenAI Studio. Simply click the `Deploy to` button and select
    `A new web app...`
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/db3657491e2a397a50f56bd35ee094d7.png)'
  prefs: []
  type: TYPE_IMG
- en: After filling out the relevant information you can access the model from a web
    application. This is one of the ways to make the model available to others.
  prefs: []
  type: TYPE_NORMAL
- en: Wrapping Up
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/4a06c775ef80f575c5d7cdfe36d7a151.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Spencer Bergen](https://unsplash.com/@spencerbergen?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: In this tutorial, I’ve shown you how to connect GPT models with internal company
    data in Azure. Again, I want to emphasize that this is only the first step to
    getting an amazing AI assistant. The next steps require expertise in areas such
    as data quality, index optimization, service design, and automation. But you now
    have a minimal setup that you can develop further 👋
  prefs: []
  type: TYPE_NORMAL
- en: If you are interested in AI or data science then feel free to follow me or connect
    on [LinkedIn](https://www.linkedin.com/in/eirik-berge/). What is your experience
    with connecting GPT models to company data? I’d love to hear what you have to
    say 😃
  prefs: []
  type: TYPE_NORMAL
- en: '**Like my writing?** Check out some of my other posts for more content:'
  prefs: []
  type: TYPE_NORMAL
- en: '[The Soft Skills You Need to Succeed as a Data Scientist](https://medium.com/towards-data-science/the-soft-skills-you-need-to-succeed-as-a-data-scientist-ceac760230d3)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Write High-Quality Python as a Data Scientist](/how-to-write-high-quality-python-as-a-data-scientist-cde99f582675)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Modernize Your Sinful Python Code with Beautiful Type Hints](/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Visualizing Missing Values in Python is Shockingly Easy](/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Introducing Anomaly/Outlier Detection in Python with PyOD 🔥](/introducing-anomaly-outlier-detection-in-python-with-pyod-40afcccee9ff)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

- en: New Scikit-Learn is More Suitable for Data Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/new-scikit-learn-is-more-suitable-for-data-analysis-8ca418e7bf1c](https://towardsdatascience.com/new-scikit-learn-is-more-suitable-for-data-analysis-8ca418e7bf1c)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Pandas Compatibility and More in Scikit-Learn Version ≥1.2.0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://saptashwa.medium.com/?source=post_page-----8ca418e7bf1c--------------------------------)[![Saptashwa
    Bhattacharyya](../Images/b01238113a1f6b91cb6fb0fbfa50303a.png)](https://saptashwa.medium.com/?source=post_page-----8ca418e7bf1c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8ca418e7bf1c--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8ca418e7bf1c--------------------------------)
    [Saptashwa Bhattacharyya](https://saptashwa.medium.com/?source=post_page-----8ca418e7bf1c--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8ca418e7bf1c--------------------------------)
    ·5 min read·Mar 8, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9b506c4e0906db732b941fdb09a6a595.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Some pretty cool updates in the New Sklearn! (Source: Author’s Notebook)'
  prefs: []
  type: TYPE_NORMAL
- en: Around last year December, Scikit-Learn released a major [stable update](https://scikit-learn.org/stable/auto_examples/release_highlights/plot_release_highlights_1_2_0.html)
    (v. 1.2.0–1) and finally I get to try some of the highlighted new features. It’s
    now more compatible with Pandas and a few other features will also help us in
    regression as well as classification tasks. Below, I go through some of the new
    updates with examples of how to use them. Let’s begin!
  prefs: []
  type: TYPE_NORMAL
- en: 'Compatibility with Pandas:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Applying some data standardization before using them for training an ML model
    like regression or neural net is a common technique to make sure different features
    with various ranges get equal importance (if or when necessary) for predictions.
    Scikit-Learn provides various pre-processing APIs like `StandardScaler` , `MaxAbsScaler`
    etc. With the newer version, **it is possible to keep the dataframe format even
    after the pre-processing**, let’s see below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/f29c45d59aed68fcb7074ef6b1f4fa2b.png)'
  prefs: []
  type: TYPE_IMG
- en: Part of the Wine dataset in Dataframe format
  prefs: []
  type: TYPE_NORMAL
- en: 'The newer version includes an option to keep this dataframe format even after
    the standardization:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/d88b2144e30e88fa9924b9fdacb565bc.png)'
  prefs: []
  type: TYPE_IMG
- en: Dataframe format is kept as it is even after standardization.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before, it would have changed the format to a Numpy array:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'With the dataframe format remaining intact, we don’t need to keep tabs on the
    columns, like we needed to do with the Numpy array format. Analysis and plotting
    become easier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e312b86b52eb6baeafb0fe3bfd3554e9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Fig. 1: Dependence of features before and after standardization! (Source: Author’s
    Notebook)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Even when we build a pipeline, **each transformer in the pipeline can be configured
    to return dataframes** as below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/bdb2208eda4f5e5b4d02e8fae995708f.png)'
  prefs: []
  type: TYPE_IMG
- en: Dataframe format can be kept as it is even within a pipeline!
  prefs: []
  type: TYPE_NORMAL
- en: 'Fetching DataSet is Faster and More Efficient:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[OpenML](https://www.openml.org/) is an open platform for sharing datasets
    and the Dataset API in Sklearn offers `fetch_openml` function to fetch data; With
    the updated Sklearn, this step is more efficient in memory and time.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Using `parser=''pandas''` makes a drastic improvement in runtime and memory
    consumption. One can easily check the memory consumption using `psutil` library
    as:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Partial Dependency Plots: Categorical Features'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Partial dependency plots existed before too, but only for numerical features,
    now this has been extended for categorical features.
  prefs: []
  type: TYPE_NORMAL
- en: 'As described in the Sklearn documentation:'
  prefs: []
  type: TYPE_NORMAL
- en: Partial dependence plots show the dependence between the targets and a set of
    input feature(s) of interest, marginalizing over the values of all other input
    features (the ‘complement’ features). Intuitively, we can interpret the partial
    dependence as the expected target response as a function of the input features
    of interest.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Using the ‘titanic’ dataset from above, we can easily plot the partial dependence
    of categorical features:'
  prefs: []
  type: TYPE_NORMAL
- en: 'With the code block above, we can get partial dependency plots as below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0dc981c467b471d286c099e503907c41.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Fig. 2: Partial dependency plots of categorical variables. (Source: Author’s
    Notebook)'
  prefs: []
  type: TYPE_NORMAL
- en: 'With version 0.24, we would be getting a value error for categorical variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Directly Plot Residuals (Regression Models):'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For analyzing the performance of a classification model, within Sklearn metrics
    API, plotting routines like `PrecisionRecallDisplay` , `RocCurveDisplay` existed
    in older versions (0.24); In the new update, it is possible to do similar for
    regression models. Let’s see an example below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9b506c4e0906db732b941fdb09a6a595.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Linear Model fit and corresponding residuals can be directly plotted using
    Sklearn. (Source: Author’s Notebook)'
  prefs: []
  type: TYPE_NORMAL
- en: While it’s always possible to plot the fitted line and residuals using matplotlib
    or seaborn, after we’ve settled down with the best model, it’s great to be able
    to quickly check the results directly within Sklearn environment.
  prefs: []
  type: TYPE_NORMAL
- en: There are a few more improvements/additions available in the new Sklearn, but
    I found these 4 major improvements to be particularly useful for standard data
    analysis more often than not.
  prefs: []
  type: TYPE_NORMAL
- en: 'References:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] [Sklearn Release Highlights: V 1.2.0](https://scikit-learn.org/stable/auto_examples/release_highlights/plot_release_highlights_1_2_0.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Sklearn Release Highlights: [Video](https://www.youtube.com/watch?v=5bCg8VfX2x8&feature=youtu.be&ab_channel=scikit-learn)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3]All the plots and codes: [My GitHub](https://github.com/suvoooo/Machine_Learning/blob/master/SklearnV1d2/Scikit_Pandas_Output.ipynb)'
  prefs: []
  type: TYPE_NORMAL
- en: '***If you’re interested in further fundamental machine learning concepts and
    more, you can consider joining Medium using*** [***My Link***](https://medium.com/@saptashwa/membership)***.
    You won’t pay anything extra but I’ll get a tiny commission. Appreciate you all!!***'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/@saptashwa/membership?source=post_page-----8ca418e7bf1c--------------------------------)
    [## Join Medium with my referral link - Saptashwa Bhattacharyya'
  prefs: []
  type: TYPE_NORMAL
- en: More from Saptashwa (& all other writers on Medium). Your membership fee directly
    supports Saptashwa and other writers…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: medium.com](https://medium.com/@saptashwa/membership?source=post_page-----8ca418e7bf1c--------------------------------)
  prefs: []
  type: TYPE_NORMAL

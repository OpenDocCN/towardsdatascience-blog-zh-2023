# Dirichlet 分布：基础直观理解及 Python 实现

> 原文：[https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2](https://towardsdatascience.com/dirichlet-distribution-the-underlying-intuition-and-python-implementation-59af3c5d3ca2)

## 关于 Dirichlet 分布你需要知道的一切

[](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Reza Bagheri](../Images/7c5a7dc9e6e31048ce31c8d49055987c.png)](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)[](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------) [Reza Bagheri](https://reza-bagheri79.medium.com/?source=post_page-----59af3c5d3ca2--------------------------------)

·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----59af3c5d3ca2--------------------------------) ·27分钟阅读·2023年8月1日

--

![](../Images/d401dd1e32b5386d115f5f45826440fe.png)

图片来源: [https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/](https://pixabay.com/vectors/cubes-dice-platonic-solids-numbers-160400/)

Dirichlet 分布是贝塔分布的一种推广。在贝叶斯统计中，它通常用作多项式分布的共轭先验，因此可以用来建模概率随机向量的不确定性。它具有广泛的应用，包括贝叶斯分析、文本挖掘、统计遗传学和非参数推断。本文对 Dirichlet 分布进行了直观介绍，并展示了它与多项式分布的联系。此外，还展示了如何在 Python 中建模和可视化 Dirichlet 分布。

**定义**

假设连续随机变量 *X*₁, *X*₂, …*Xₖ* (*k*≥2) 形成随机向量 ***X***，定义为：

![](../Images/2badf37a90938009e80bdb08529e453a.png)

我们还定义了向量 ***α*** 如下：

![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)

其中

![](../Images/d80069db2690a24ca16772c9735581b4.png)

现在，如果随机向量 ***X*** 具有参数 ***α*** 的 *Dirichlet 分布*，则它具有以下联合 PDF：

![](../Images/ebb95005954b232af99dee7d20387b43.png)

函数 B(***α***) 称为 *多变量* *贝塔函数*，其定义为

![](../Images/d8ddc644727cbf8a1dcefda6397b8fb3.png)

其中 Г(*x*) 是伽马函数。如果随机向量 ***X*** 具有参数 ***α*** 的 Dirichlet 分布，则记作 ***X*** ~ Dir(***α***)。多变量贝塔函数包含在联合概率密度函数（PDF）中用于归一化。联合 PDF 应该在其定义域上积分为 1：

![](../Images/95afa4275082e9598e960cadf411433f.png)

因此，我们有：

![](../Images/ed6529ee755626f0afbf5b80046f1db6.png)

基于方程1，随机变量*X*₁、*X*₂、…*Xₖ*的取值应满足以下条件，以使*f***ₓ**(***x***)>0：

![](../Images/7e1ec62ff43e62b50ef856bf367dcafe.png)

这些条件定义了Dirichlet分布的*支持*。***X***的支持及其分布的支持是所有***x***的集合（***X***可以取的值），其中*f***ₓ**(***x***)>0。如果***X***有*k*个元素，具有Dirichlet分布的***X***的支持是一个*k*-1维的*单纯形*。单纯形是由于方程3的约束而形成的有界线性流形。单纯形是三角形概念的高维推广。因此，*k*-1维单纯形可以被视为一个位于*k*维空间中的*k*-1维三角形。

例如，如果*k*=2，那么***X***的支持是图1（左）中显示的1维单纯形。它是一条直线，触及每个坐标轴，距离原点1个单位。对于这条线上的每一点，我们有：

![](../Images/1db12253f21dcde52287e2f96a49aa03.png)

对于*k*=3，那么***X***的支持是图1（右）中显示的2维单纯形。现在它是一个触及每个坐标轴的三角形，距离原点1个单位。

![](../Images/5ca6946080d9e82b734d028a02857ed4.png)

图1（作者提供）

对于这个三角形表面上的每一个点，我们有：

![](../Images/e911b8e900aab37ca329b00d39191c5d.png)

让随机向量

![](../Images/2badf37a90938009e80bdb08529e453a.png)

具有参数的Dirichlet分布：

![](../Images/edebc9c0398e18fdfb65ff9db3d3b9bc.png)

让

![](../Images/e10286164e5d097a6083200b8eccf504.png)

然后，可以证明***X***的均值如下：

![](../Images/01d94aca4c6ac3f42eb7f7e369185b7e.png)

也可以证明：

![](../Images/b428305ac29ad9482aff1db4baede1c1.png)

**直觉**

如前所述，Dirichlet分布通常作为多项分布的共轭先验。因此，为了理解其背后的直觉，我们首先需要回顾多项分布。假设离散随机向量***X***定义为：

![](../Images/2badf37a90938009e80bdb08529e453a.png)

让向量***p***为：

![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)

那么***X***被称为具有参数*n*和***p***的多项分布，如果它具有以下联合PMF：

![](../Images/78cb26b2cb78594406394c72e40b9991.png)

多项分布可以用于建模一个*k*面骰子。假设我们有一个*k*面骰子，并将其掷*n*次。让*pᵢ*表示获得第*i*面的概率，并让随机变量*Xᵢ*表示第*i*面观察到的总次数（*i*=1…*k*）。那么随机向量

![](../Images/2badf37a90938009e80bdb08529e453a.png)

具有参数*n*的多项分布

![](../Images/597eb91674761bc4e8f0e64cc45698f3.png)

这一点在图 2 中展示。

![](../Images/1f308405453930cb5be7b120f2a8633a.png)

图 2（作者提供的图片）

现在假设我们不知道向量 ***p*** 中的 *pᵢ* 值。因此，我们不知道每一面 *k*-面骰子的概率，我们想通过观察 *n* 次掷骰子的结果来推断它。***p*** 的元素表示一些互斥事件的概率，因此我们应该有：

![](../Images/f50f34ded99c35f004271471997ef16a.png)

***p*** 的值可以使用 *贝叶斯方法* 推断。在这里，我们假设未知的概率向量 ***p*** 由连续随机向量 ***P*** 表示。***P*** 的概率分布称为 *先验分布*。先验分布表示对估计参数 ***P*** 的先验知识或假设。在掷骰子之后，我们可以分析观察到的数据，并使用这些数据更新我们对 ***P*** 的信念。因此，我们得到一个新的 ***P*** 分布，这称为 *后验分布*。后验分布是通过用观察数据更新先验概率分布得到的。

请记住，随机向量***X***中的随机变量 *Xᵢ* 代表观察到的第 *i* 面的总次数。如果我们知道 ***p*** 的值，我们可以使用以下条件概率计算在 *n* 次掷骰子后观察到 *X*₁=*m*₁, *X*₂=*m*₂, … *Xₖ*=*mₖ* 的概率：

![](../Images/1f9257fe46c6db19625cc7eaa7eeb1ba.png)

其中：

![](../Images/d0b3d2dfc990e0ecb6df95d78a46640b.png)![](../Images/7286ebcb8f3c5fac15df0bc79272213d.png)

这个条件概率给出了在 *n* 次掷骰子后观察到每一面骰子特定次数的概率，假设我们知道 ***P*** 的真实值。如前所述，***P*** 的概率分布是我们的先验分布。我们用 *f_****P***(***p***) 来表示这个分布的联合概率密度函数。现在，我们可以使用贝叶斯定理将先验和后验联合概率密度函数连接起来：

![](../Images/f64975b1eaa9aa8d5d0cdf845944da3f.png)

这里 *f_****P***|***X*** (***p***|***X***=***m***) 是后验分布的联合概率密度函数。这个分布在观察到 ***X*** 后更新我们对 ***P*** 的信念。我们也称 *P*(***X***=***m***|***p***) 为似然函数，它可以写成一个已知 ***p*** 值的多项式分布的概率质量函数（方程 4）：

![](../Images/2f15581bd2006837ed36b459e5187544.png)

贝叶斯定理的分母是 ***X***=***m*** 的概率，称为 ***X*** 的边际概率质量函数：

![](../Images/cc6d0b47e85d4258a89ea0916d33bdea.png)

请注意，这与 ***p*** 的真实值无关。现在我们假设先验分布是具有参数 ***α***₁ 的 Dirichlet 分布。

![](../Images/c4c37e90e1f775ee43e325f8f950c66e.png)

其中

![](../Images/d6ce5f1d51afd5d8e3f5ffdb9a726d6d.png)

记住，具有 Dirichlet 分布的随机变量应遵循方程 3 中的条件，这些条件与方程 5 的条件完全相同。实际上，方程 3 中的条件允许我们使用 Dirichlet 分布来表示互斥事件的概率的随机变量。

现在我们可以使用贝叶斯规则（方程 6）来写：

![](../Images/418e868227eb5a117564c6229c3581f3.png)

这里 *c* 是一个不依赖于 *pᵢ* 值的常数。后验联合 PDF 应该被归一化，因此我们有以下条件：

![](../Images/80b71fa8c3c66beb644eed7fade78eb8.png)

通过将方程 7 和 8 与方程 1 和 2 进行比较，我们得出结论，后验分布是一个参数为的 Dirichlet 分布

![](../Images/a341d75cb1d476ef88fc4b2540515956.png)

和 *c* 仅仅是其归一化因子，我们得到：

![](../Images/88c4cde864ad1f7ecea1943c9cb9c257.png)

最后，我们可以写：

![](../Images/edd226985bb40724fcc37018af64e701.png)

所以，如果我们假设先验分布是 Dirichlet 分布，那么在观察到 ***X***=***m*** 之后的后验分布也是 Dirichlet 分布。我们只需将每个侧面观察到的数量 (*mᵢ*) 添加到先验分布中的相应参数 (*αᵢ*) 中，就能得到后验分布的参数。

在贝叶斯概率理论中，如果后验分布属于与先验分布相同的家族，那么先验和后验被称为 *共轭分布*。因此，我们得出结论，Dirichlet 分布是多项分布的共轭先验（图 3）。

![](../Images/c96ca617fe8f7f1229cca6c2aec2ee71.png)

图 3（作者提供的图片）

Dirichlet 分布的一个特殊情况是当

![](../Images/e74030855bcc495979276dd393694a24.png)

然后我们得到：

![](../Images/2c37ba9b37c4f048d44401175d103689.png)

这意味着

![](../Images/c9ccda7f5fde9ddc013fbf29f693515a.png)

与其 *k*-1 维单纯形上的均匀分布是一样的，因为联合 PDF 在单纯形上具有相同的值。

**在 Python 中建模和可视化**

我们可以使用 `scipy` 库在 Python 中对 Dirichlet 分布进行建模。在 `scipy` 中，Dirichlet 分布可以通过对象 `dirichlet` 创建。该对象接受参数 `alpha`，该参数对应于方程 1 中的 ***α***。我们也可以将 `alpha` 传递给此对象的方法。方法 `pdf()` 还接受参数 `x`，该参数对应于方程 1 中的 ***x***，并返回 `x` 处分布的联合 PDF。我们还可以使用方法 `mean()` 和 `var()` 计算分布的均值和方差。例如，设：

![](../Images/5935c0207086f3bfabb27caa02a87885.png)

现在我们想计算 ***X*** 的均值及其在 [0.5, 0.3, 0.2]ᵀ 的联合 PDF，使用以下代码片段：

[PRE0]

[PRE1]

如果 `x` 的值在单纯形之外，`pdf()` 会抛出错误：

[PRE2]

![](../Images/b12a46c92bf7e82419db89db477a8ea4.png)

我们可以可视化 *k*=2 和 3 时的 Dirichlet 联合 PDF（*k* 是 ***X*** 的元素个数）。如前所述，当我们在 ***X*** 中有 3 个随机变量（具有 Dirichlet 分布）时，单纯形是一个二维三角形（图 1）。我们可以计算这个单纯形表面上联合 PDF 的轮廓，并用 *重心坐标* 在二维图中绘制（图 4）。

![](../Images/d0b4cf6d74749675587b2f5be7538a7f.png)

图 4（作者提供的图像）

重心坐标是一个点在仿射空间中相对于单纯形的坐标。它们可以提供一个点相对于直线、三角形或四面体的位置，而不是全局笛卡尔坐标。在 *k* 维笛卡尔坐标系中，一个点的坐标可以表示为 *k*-1 维单纯形的边的归一化加权平均。这些权重给出了该点相对于单纯形的重心坐标。考虑图 5 中显示的二维空间。

![](../Images/9dc499125921610ff548db6fa55af521.png)

图 5（作者提供的图像）

一维单纯形是端点 [0,1] 和 [0,1] 之间的线段。在这个单纯形上的任意点 ***p*** 的坐标可以表示为端点坐标的归一化加权平均：

![](../Images/47068359c366bcd7e40be16900502a6a.png)

其中

![](../Images/3d0f2050c861427acde6ab36db98211d.png)

这里 *λ*₁ 是 ***p*** 到端点 [0,1] 的距离除以单纯形的长度 (*L*)。类似地，*λ*₂ 是 ***p*** 到端点 [1,0] 的距离除以 *L*。权重 *λ*₁ 和 *λ*₂ 是 ***p*** 相对于该单纯形的重心坐标，并且由于端点距离原点只有一个单位，它们与笛卡尔坐标具有相同的值。

接下来，考虑图 6 中显示的二维单纯形。这个单纯形是由端点 [1,0,0]、[0,1,0] 和 [0,0,1] 组成的三角形。该单纯形上点 ***p*** 的坐标等于这些端点坐标的归一化加权平均：

![](../Images/8ea24fca5e787855c4e16019e59d8f6c.png)

其中

![](../Images/82fbe85bf54cd613528c8f96e7eac3de.png)![](../Images/4253dba4fa736e1ac0ad54d325751433.png)

图 6（作者提供的图像）

在这个三角形中，每个节点代表一个坐标轴 *x*₁、*x*₂ 或 *x*₃。假设我们要计算 *x*₁ 的值。设每条边的长度为 *L*（这是一个等边三角形）。为了得到 *x*₁ 的值，我们绘制一条经过 ***p*** 并且与不经过 *x*₁ 所代表的节点的边（这里是 *x*₂*x*₃）平行的直线。这条直线将其余的每一边（*x*₁*x*₂ 和 *x*₁*x*₃）分成两个线段。在这些边上，不包含节点 *x*₁ 的线段长度是 *λ*₁*L*（见图 6）。我们可以类似地计算 *λ*₂ 和 *λ*₃ 的值。

现在，我们创建一个 Python 函数来绘制二维单纯形上 Dirichlet 分布的联合 PDF 的等高线。清单 1 导入了我们后续需要的所有库，并在二维图上定义了这个三角形单纯形的边。这些边存储在列表`edges`中。请注意，这个二维单纯形现在绘制在二维屏幕上，因此所有的边都是二维的。然而，点的重心坐标仍然是这些边的笛卡尔坐标的加权平均值：

![](../Images/dab451bf7a5108843011a4b91e72b685.png)

这里的*H*是三角形的高度（图 7）。

我们使用`matplotlib.tri`库来创建一个三角网格。数组`normal_vecs`保存了这个三角形每条边的法向量（每条边的法向量都垂直于该边）。

[PRE3]

在清单 2 中，函数`cart_to_bc()`将点的二维笛卡尔坐标转换为相对于`edges`中定义的二维三角形的重心坐标。

[PRE4]

图 7 展示了如何进行这些计算以计算*λ*₃（作为示例）。如图所示，三角形的一条边（***x***₁）位于二维笛卡尔坐标系统的原点。我们可以用向量***x***₁***p***来表示这个三角形上的点***p***。从几何学中，我们知道

![](../Images/354177cf624981cd8707f98879973b6a.png)

其中***n***是边***x***₁***x***₂的法向量。因此，如果我们知道点***p***的笛卡尔坐标、三角形的边以及每条边的法向量，我们就可以轻松计算出点***p***的重心坐标。

![](../Images/41fa71d84abcab86d00f6408b6ab99b8.png)

图 7（作者提供的图片）

需要注意的是，这个函数并不总是返回准确的重心坐标。如果重心坐标超出了区间 [1e-10 -10, 1–1e-10]，则会使用`numpy`中的`clip()`函数将其裁剪到区间边界。原因将在后文中解释。

我们还有函数`bc_to_cart()`，它将这个三角形的重心坐标转换为笛卡尔坐标。点***p***的笛卡尔坐标等于三角形边的笛卡尔坐标的加权平均值，而重心坐标只是这些权重：

![](../Images/dab451bf7a5108843011a4b91e72b685.png)

最后，列表 3 定义了函数`plot_contours()`，该函数绘制 Dirichlet 分布在这个三角形上的联合 PDF 等高线。此函数在笛卡尔 2D 空间上创建一个三角网格。接下来，计算网格上每个点的重心坐标。然后，它使用重心坐标计算该点的联合 PDF。在计算完三角形上所有点的联合 PDF 后，绘制等高线。请注意，三角网格上的某些点可能稍微超出简单边界。这意味着该点的 *x*₁+*x*₂+*x*₃ 可能稍微小于零或大于 1。将这样的点传递给 `dirichlet` 对象的 `pdf()` 方法会引发错误。因此，我们在 `cart_to_bc()` 中裁剪重心坐标以避免此错误。

[PRE5]

让我们尝试 `plot_contours()`。我们首先绘制等高线

![](../Images/00f502b15f804340c982c11da81ccc1f.png)

如前所述，由于联合 PDF 在单纯形上具有相同的值，因此它与其 2D 单纯形上的均匀分布相同。列表 4 绘制了联合 PDF 的等高线，结果图如图 8 所示。

[PRE6]

![](../Images/38963084896ec1105c15b27faccce308.png)

图 8

如您所见，联合 PDF 在整个单纯形上具有相同的值。接下来，我们绘制等高线

![](../Images/35b339bbaa93837fff3e44c2effe8ae4.png)

作为列表 5 中的第二个示例。结果如图 9 所示。

[PRE7]

![](../Images/a7493ee0e421c84271d08d91d00124a8.png)

图 9

**影响 *α* 对联合 PDF 的影响**

我们还可以创建联合 PDF 表面的 3D 图。这里我们假设 2D 单纯形位于 XY 平面，Z 轴给出 PDF 的值。列表 6 中的函数`plot_surface()`生成这样的图。

[PRE8]

列表 7 使用此函数绘制了具有不同参数的 Dirichlet 分布的联合 PDF。图形如图 10 所示。

[PRE9]

![](../Images/618d3c48b4f154c6ea26dd59ecf4c888.png)

图 10

这些图可以帮助您理解 ***α*** 对联合 PDF 形状的影响。具有 Dirichlet 分布的随机变量 *p*₁、*p*₂ 和 *p*₃ 可以表示 3 个相互排斥事件的概率。因此，单纯形的每条边表示这些事件中的一个，相应的 *αᵢ* 就像是该事件发生概率的权重。

如前所述，***α***=[1 1 1]ᵀ 意味着我们在单纯形上有均匀分布。这里，PDF 的值在单纯形上处处为 2，因此联合 PDF 具有平坦的表面。当 *αᵢ* 相对于其他元素增加时，这意味着第 *i* 个事件发生的机会更高，因为与其他事件相比，它被观察得更多（这里我们可以假设我们从 Dir([1 1 1]ᵀ) 作为先验分布开始）。一个例子是图 10 中 Dir([1 7 1]ᵀ) 的图形。现在，表面在单纯形的边缘附近升高，表示该事件。

当总和*α*₁+*α*₂+*α*₃增加时，意味着观察的总数量增加了。这将减少我们对***P***的分布的不确定性，并使Dirichlet分布的联合PDF看起来更尖锐。正如你在图10中看到的，Dir([30 30 30]ᵀ)相比Dir([5 5 5]ᵀ)要尖锐得多。然而，两者在边缘上看起来都是对称的。因为所有事件被观察的次数相同。当某个*αᵢ*相对于其他值变大时，联合PDF的峰值会向表示该事件的边缘移动。这在Dir([5 5 30]ᵀ)中得到了体现。这里第三个事件的权重（*α*₃）较大，意味着第三个事件被观察得更多，因此发生的概率更高。

请注意，所有的***α***元素应大于零，因此我们不能给事件分配零权重。然而，如果我们设置*αᵢ*<1，则相应事件的权重会显著下降。这在图10中的Dir([0.65 7 1]ᵀ)的图示中得到了体现。如果你将其与Dir([1 7 1]ᵀ)的图示进行比较，你会发现为了得到非零PDF，*p*₁的重心坐标应非常小。这几乎像在*p*₂和*p*₃上有一个1维的简单形体。

列表8绘制了Dirichlet分布的联合PDF的对数尺度图（以更好地展示联合PDF表面的变化）。结果如图11所示。

[PRE10]

![](../Images/27330f5767d38ee71d06e8a7b5cdf848.png)

图11

请注意，当所有*αᵢ*小于1时，联合PDF有一个凸面的表面。PDF在三角形简单形体的边缘和侧面几乎非常小。它几乎像在三角形的边上有三个1维的简单形体。因此，具有这种分布的先验表示一个设置，其中一个或两个*pᵢ*非常小，它们对应的事件发生的概率很小。

通过比较Dir([0.2 0.2 0.2]ᵀ)和Dir([0.8 0.8 0.8]ᵀ)，你会发现增加*αᵢ*的值倾向于使联合PDF的表面变平。因此，它减少了边缘和侧面的联合PDF值，并增加了在简单形体中部区域的值。

最后，需要注意的是，Dirichlet分布的参数也可以是非整数的。但例如Dir([1.65 6 20]ᵀ)是什么意思呢？在这里，我们可以将参数的小数部分分配给先验分布。例如，我们可以将其写成Dir([0.65+1 1+5 7+13]ᵀ)。这意味着我们从Dir([0.65 1 7]ᵀ)作为先验分布开始（Dir([0.65 1 7]ᵀ)的联合PDF如图10所示）。选择这个先验分布意味着我们最初认为*p*₁几乎为零，它对应的事件发生的可能性非常小。然后我们观察到第一个事件只发生了一次，而第二个和第三个事件分别发生了5次和13次。这些数字被加到先验分布的参数中，形成了后验分布。

**Python中的贝叶斯推断**

现在我们可以绘制轮廓图了，我们可以使用狄利克雷分布来推断多项式分布的参数分布。假设我们有一个3面的骰子（当然，它也可以是一个6面的骰子，只是上面有3个标签（1、2和3），每个标签出现在两个面上）。设获得面*i*的概率为*pᵢ*，*Xᵢ*表示观察到面*i*的总次数（*i*=1..3）。如前所述，随机向量

![](../Images/006a1af2819afa650680787c5c308e93.png)

具有参数*n*的多项式分布

![](../Images/d188b4d9b61ded8c5496e576d5c1a5c9.png)

设实际的***p***值为：

![](../Images/6453b087015e8994d484ff2684c9c0ae.png)

因此，这不是一个公平的骰子！我们可以使用`scipy`中的多项式对象来建模这个分布。以下代码片段显示了掷这个骰子10次的结果：

[PRE11]

[PRE12]

因此，如果我们掷10次，我们会得到以下观察结果：

+   面 1：6 次

+   面 2：3 次

+   面 3：仅 1 次

当然，这些是一些随机事件，因此如果我们在`rvs()`中更改`random_state`，我们可以获得不同的观察结果（我们固定`random_state`以使这个特定的观察结果可重复）。

现在假设我们不知道每一面的概率，因此实际的向量***p***（如方程10所示）的值未知。然而，我们仍然可以掷这个骰子*n*次并观察结果，因此，我们知道*Xᵢ*的值。如果我们假设未知的概率向量***p***由随机向量***P***表示，我们可以使用狄利克雷分布来推断掷骰子后的***P***的概率分布。

列表9首先生成掷骰子*n*次的结果并存储在*m*中。然后计算*f_****P***|***X*** (***p***|***X***=***m***)，这是后验分布的联合PDF，并在二维简单形上绘制其轮廓。我们尝试了5个不同的*n*值，范围从3到10000，图12展示了这些图形。我们以Dir([1 1 1]ᵀ)作为***P***的先验分布。因此，最初我们对***P***有均匀分布，其中不同的***P***值是同样可能的。因此，我们对***P***有最大的未知。

用于生成观察数据的实际***P***值（方程10）在这些图中用白色标记显示。随着*n*的增加，我们获得了更多的观察数据，我们对***P***的未知性减少。通过增加*n*，狄利克雷分布从最初的均匀分布变得更加尖锐，并更接近表示***p_***act的白色标记。

[PRE13]

![](../Images/e9b10068baa3d1ea19209ec0c842add6.png)

图12

**与贝塔分布的关系**

让随机向量

![](../Images/1d7b0906c55e7665b39555d37f684d66.png)

具有参数的狄利克雷分布

![](../Images/1e404962725486e815990629ee7c36a0.png)

基于方程1，***X***的联合PDF是：

![](../Images/d3815b3d3ede2a05fbdc400a2841b1c2.png)

其中

![](../Images/fef44e2b3afeba4ec60e4bcdd74cb58e.png)

由于我们有

![](../Images/1d44daabfec25c2808416b1e908b7a3c.png)

我们可以从 PDF 中去除 *x*₂：

![](../Images/3aabe4d4a829d12f9bf731017f1da34a.png)

如你所见，*X*₁ 和 *X*₂ 的联合 PDF 仅是 *x*₁ 的函数。因此，随机向量 ***X*** 由单一随机变量 *X*₁ 决定，这意味着上式右侧也是随机变量 *X*₁ 的 PDF。所以，我们可以写成：

![](../Images/494efee0e0e6b51426f6f0f88ac722d0.png)

具有这种 PDF 的连续随机变量称为具有参数 *α*₁ 和 *α*₂ 的 *贝塔分布*，我们用 *X*₁ ~ Beta(*α*₁, *α*₂) 来表示。类似地，我们可以用 *x*₂ 表达 PDF：

![](../Images/8ea15208fc8561125f3824fc5dd81bf7.png)

因此，我们得出结论 *X*₂ ~ Beta(*α*₂, *α*₁)，并得出：

![](../Images/01b7cb9281703d6911bf38e33978c074.png)

*X*₁ 和 *X*₂ 的分布被称为 ***X*** 的 *边际分布*。当 ***α*** 仅有两个元素，并且我们仅考虑 ***X*** 中的一个随机变量时，贝塔分布是狄利克雷分布的特例。因此，它是一个单变量分布。列表 10 绘制了 Dir([5 1]ᵀ) 的联合 PDF 以及其边际分布的 PDF：Beta(5,1) 和 Beta(1,5)。这些图示见图 13。

[PRE14]

![](../Images/a333cfe560f0d57eaa5d6912d0c7d235.png)

图 13

请注意，方程 11 中 Dir([*α*₁ *α*₂]ᵀ) 的联合 PDF 与方程 12 中其边际分布 (Beta(*α*₁, *α*₂)) 的 PDF 相同。然而，它们并不表示相同的分布。前者是随机向量 ***X*** 的联合 PDF，而后者是随机变量 *X*₁ 的 PDF。如图 13 所示，边际分布的 PDFs 是联合 PDF 在由坐标轴 (*x*₁, *f***ₓ**(***x***)) 和 (*x*₂, *f***ₓ**(***x***)) 形成的平面上的投影。

请记住，多项分布可以用于建模一个 *k* 面的骰子。当 *k*=2 时，骰子变成了硬币。现在 *X*₁ 可以表示在 *n* 次掷硬币中的正面总数。类似地，*X*₂ 表示反面总数。从方程 4，我们得到：

![](../Images/b953fb14b1a9e4dcfd45f5f3d50698c7.png)

由于 *x*₁+*x*₂=*n*，*p*₁+*p*₂=1，我们可以从上述方程中消去 *p*₂ 和 *x*₂：

![](../Images/5e5d0657e2e31d4029fb7e20a2c80681.png)

现在随机向量 ***X*** 由单一随机变量 *X*₁ 决定，这意味着上式右侧也是随机变量 *X*₁ 的 PDF。因此，*X*₁ 的 PDF 可以写成：

![](../Images/aa417c378753f5d0f2a9cfc60e55dbfa.png)

这是 binomial 分布的 PDF。binomial 分布是 multinomial 分布的特例，当随机向量 ***X*** 只有一个元素时（即 multinomial 分布的边际分布）。因此 *X*₁ 具有参数 *n* 和 *p*₁ 的 binomial 分布。类似地，*X*₂ 具有参数 *n* 和 *p*₂ 的 binomial 分布。

![](../Images/b144aa46a282d81687a6c19d7e83b391.png)

由于 beta 分布和 binomial 分布分别是 Dirichlet 和 multinomial 分布的特例，它们仍然是共轭分布。实际上，beta 分布是 binomial 分布的共轭先验，如图 14 所示。

![](../Images/384afa084972c4929b7e63b3d2a52e46.png)

图 14（作者提供的图片）

假设我们有一枚硬币，其正面朝上的概率为未知的 *p*。令随机变量 *P* 表示未知的概率 *p*，随机变量 *X* 表示 *n* 次掷硬币中正面的总数。假设 *P* 的概率分布是 Beta(*a*, *b*)（这是我们的先验分布）。现在如果我们掷硬币 *n* 次，观察到 *X*=*k*，则 *P* 的后验分布是 Beta(*a*+*k*, *b*+*n*-*k*)。

**聚合性质**

令随机向量 ***X*** 具有以下 Dirichlet 分布：

![](../Images/c01df7da5e542888cdddacc80ba8bef7.png)

我们从***X***中移除随机变量 *Xᵢ* 和 *X_j*，并将 *Xᵢ*+*X_j* 插入到任意位置，得到的结果随机向量称为 ***X***’。可以证明，***X***’ 具有以下 Dirichlet 分布：

![](../Images/0a3af6832911bcbe7cfdff6286447d5a.png)

因此，为了创建新 Dirichlet 分布中参数的向量，首先，我们移除 *Xᵢ* 和 *X_j* 对应的参数 (*αᵢ* 和 *α_j*)，然后在 *Xᵢ* +*X_j* 被插入到 ***X*** 的相同位置时，插入 *αᵢ*+*α_j*（*αᵢ*+*α_j* 和 *Xᵢ* +*X_j* 在它们对应的向量中的索引是相同的）。聚合性质的证明见附录。

我们来看一个例子。设 ***X*** ~ Dir([1 5 3]ᵀ)。利用聚合性质，我们有：

![](../Images/a56d7908b6b8b0358b19e536a634fd13.png)

列表 11 显示了所有这些分布的联合 PDF。该图如图 15 所示。在此图中，每个聚合随机向量 [*Xᵢ X_j*+*X_k*]ᵀ 具有 1 维单纯形。这里，我们假设该单纯形沿着经过 *Xᵢ* 的三角形的高度。

[PRE15]

![](../Images/adb1aa908a90f794e99ae6689e6859a4.png)

图 15

**边际分布**

现在，利用聚合性质，当 ***X*** 具有超过 2 个元素时，我们可以找到 Dirichlet 分布的边际分布。令 ***X*** 具有 Dirichlet 分布：

![](../Images/f69f4d5ce6c4530e1e7a31a50f93f631.png)

我们可以对除 *X*₁ 外的 ***X*** 中的所有元素重复应用聚合性质，得到：

![](../Images/2954ed5d02b7373ba26b1dc35541c2a1.png)

我们可以将前面的方程写成

![](../Images/a808ec15deceb36b937be9b498a6a63e.png)

其中

![](../Images/e10286164e5d097a6083200b8eccf504.png)

更一般地，我们可以为每个元素***X***写出相同的方程：

![](../Images/4474d195428a34352a6319382657a0d0.png)

因此，根据方程13，每个 *Xᵢ* 的边际分布是以下贝塔分布：

![](../Images/8cbd5254a569bfcbc4a32139b3ca89b1.png)

在这篇文章中，我们回顾了狄利克雷分布。我们展示了它是多项分布的共轭先验，并且由于这一重要特性，它可以用来推断多项分布的参数。我们还展示了如何在 Python 中对其进行建模以及如何可视化其联合 PDF。最后，我们看到贝塔分布和狄利克雷分布之间的联系，并展示了狄利克雷分布是贝塔分布在更高维度上的推广。

我希望你喜欢阅读这篇文章。如果你有任何问题或建议，请告诉我。本文中的所有代码清单可以从 GitHub 上以 Jupyter Notebook 形式下载，网址为：

[https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb](https://github.com/reza-bagheri/probability_distributions/blob/main/dirichlet_distribution.ipynb)

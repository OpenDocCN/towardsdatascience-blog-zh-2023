- en: Pearson, Spearman and Kendall Correlation Coefficients, by Hand
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/pearson-spearman-and-kendall-correlation-coefficients-by-hand-d2e1676ca73f](https://towardsdatascience.com/pearson-spearman-and-kendall-correlation-coefficients-by-hand-d2e1676ca73f)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Learn how to compute the Pearson, Spearman, and Kendall correlation coefficients
    by hand to evaluate the relationship between two variables
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://antoinesoetewey.medium.com/?source=post_page-----d2e1676ca73f--------------------------------)[![Antoine
    Soetewey](../Images/51d7837d18ff15a62cac2343a485e35d.png)](https://antoinesoetewey.medium.com/?source=post_page-----d2e1676ca73f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----d2e1676ca73f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----d2e1676ca73f--------------------------------)
    [Antoine Soetewey](https://antoinesoetewey.medium.com/?source=post_page-----d2e1676ca73f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----d2e1676ca73f--------------------------------)
    ·15 min read·Sep 5, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/84af2666955f203411e8972ba8d5e235.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [S O C I A L . C U T](https://unsplash.com/@socialcut?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In statistics, a correlation is used to evaluate the relationship between two
    variables.
  prefs: []
  type: TYPE_NORMAL
- en: In a previous post, we showed how to [compute a correlation and perform a correlation
    test in R](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/).
    In this post, we illustrate how to compute the Pearson, Spearman, and Kendall
    correlation coefficients by hand and under two different scenarios (i.e., with
    and without ties).
  prefs: []
  type: TYPE_NORMAL
- en: Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To illustrate the methods with and without ties, we consider two different datasets,
    one with ties and another without ties.
  prefs: []
  type: TYPE_NORMAL
- en: With ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For the illustrations of the scenarios with ties, suppose we have the following
    sample of size 5:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d2c80572dfc1f0b580dbc83eff69a83e.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d5298938dc35a6744edf7c25c3d7104e.png)'
  prefs: []
  type: TYPE_IMG
- en: Plot by author
  prefs: []
  type: TYPE_NORMAL
- en: As we can see, there are some ties since there are two identical observations
    in the variable x.
  prefs: []
  type: TYPE_NORMAL
- en: Without ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For the scenarios which require no ties, we will consider the following sample
    of size 3:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ac36ba95313cef34b71b5c4f730f4289.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a0aef842482018bdd9637f754745879d.png)'
  prefs: []
  type: TYPE_IMG
- en: Plot by author
  prefs: []
  type: TYPE_NORMAL
- en: Correlation coefficients by hand
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The three most common correlation methods are:[1](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fn1)
  prefs: []
  type: TYPE_NORMAL
- en: Pearson, used for two [quantitative continuous](https://statsandr.com/blog/variable-types-and-examples/#continuous)
    variables which have a linear relationship
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Spearman, used for two quantitative variables if the link is partially linear,
    or for one [qualitative ordinal](https://statsandr.com/blog/variable-types-and-examples/#ordinal)
    variable and one quantitative variable
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kendall, often used for two qualitative ordinal variables
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Each method is presented in the next sections.
  prefs: []
  type: TYPE_NORMAL
- en: Note that the aim of this post is to illustrate how to compute the three correlation
    coefficients by hand and under two different scenarios; we are not interested
    in verifying the underlying assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: Pearson
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Luckily, the procedure for computing the Pearson correlation coefficient is
    the same whether there are ties or not so we do not distinguish the two scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: With and without ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Pearson correlation coefficient, denoted r in the case of a sample, can
    be computed as follows[2](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fn2)
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/86157a90f90273d37293e46524652cf8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where:'
  prefs: []
  type: TYPE_NORMAL
- en: n is the sample size
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: xi and yi are the observations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ¯x¯ and ¯y¯ are the sample [means](https://statsandr.com/blog/descriptive-statistics-by-hand/#mean)
    of x and y
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: sx and sy are the sample [standard deviations](https://statsandr.com/blog/descriptive-statistics-by-hand/#standard-deviation)
    of x and y
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We show how to compute it step by step.
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1.**'
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, before computing the correlation coefficient we first need to
    compute the mean and the standard deviation for each of the two variables.
  prefs: []
  type: TYPE_NORMAL
- en: 'The mean of x is computed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a911f2b19de95f11626380d2b533b460.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The standard deviation of x is computed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7ed7ee0c58acb64a2937bc20d4314650.png)'
  prefs: []
  type: TYPE_IMG
- en: The formulas can be used analogously for the variable y.
  prefs: []
  type: TYPE_NORMAL
- en: 'We start by computing the means of the two variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5153cf526a1a944f1b5c103c843454d8.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 2.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'We now need to compute the standard deviation of each variable. To ease the
    computations, it is best to use a table, starting with the observations:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/31d7bce40b2640e0f843dd22876fd1e1.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: To compute the standard deviations, we need the sum of the squared differences
    between each observation and its mean, that is,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/525e8d6ab31a2ea584948bc81d6debf5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We start by creating two new columns in the table, denoted `x-xbar` and `y-ybar`,
    corresponding to:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a3b9572c2a3e53225569022aa9943e98.png)![](../Images/1c1bbd7583399f8bbf38308f17a02ef4.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We take the square of these two new columns, denoted `(x-xbar)^2` and `(y-ybar)^2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4244a30e011fcc84e7c16f854a2804df.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We then sum these two columns, which gives:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/925a4453a3b6ae762e71906717d91a5f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The standard deviations are thus:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3325e0d70174cf29cc83cabc1b59eacb.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 3.**'
  prefs: []
  type: TYPE_NORMAL
- en: We now need
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6b78e77c2afc46b5bd73c5ecb56d544d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'so we add a new column in the table, corresponding to xiyi and denoted `x*y`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/539b9e6d9790459edae711ca919f0ad4.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4.**'
  prefs: []
  type: TYPE_NORMAL
- en: We take the sum of that last column, which gives
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9735ee96221ce3e35cd0aa2ad44d39cd.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 5.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, the Pearson correlation coefficient can be computed by plugging values
    found above in the initial formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/93588b1ad3e6795701cff1c1d794cf23.png)'
  prefs: []
  type: TYPE_IMG
- en: Note that there are other formulas to compute the Pearson correlation coefficient.
    For instance,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b1723e880fa30c4148203ec9382f1d55.png)'
  prefs: []
  type: TYPE_IMG
- en: All formulas will of course give the exact same results.
  prefs: []
  type: TYPE_NORMAL
- en: For your information, squaring the Pearson correlation coefficient r gives the
    coefficient of determination R2 in the context of a simple [linear regression](https://statsandr.com/blog/multiple-linear-regression-made-simple/).
  prefs: []
  type: TYPE_NORMAL
- en: Spearman
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We now present the Spearman correlation coefficient, also referred as Spearman’s
    rank correlation coefficient. This coefficient is actually the same than Pearson
    coefficient, except that the computations are based on the *ranked values* rather
    than on the raw observations.
  prefs: []
  type: TYPE_NORMAL
- en: 'Again, we present how to compute it by hand step by step, but this time we
    distinguish two scenarios:'
  prefs: []
  type: TYPE_NORMAL
- en: if there are ties
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: if there are no ties
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: With ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Spearman correlation coefficient (with ties), denoted rs, is defined as
    follows
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0cc8ec45de60327d4ae2c97d527e6171.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/22ec119e58e4f1e4a792a9869999d7ed.png)'
  prefs: []
  type: TYPE_IMG
- en: Here is how to compute it by hand.
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1.**'
  prefs: []
  type: TYPE_NORMAL
- en: As mentioned before, the Spearman coefficient is based on the ranks. So we first
    need to add the ranks of the observations (from lowest to highest), separately
    for each of the two variables.
  prefs: []
  type: TYPE_NORMAL
- en: 'For y, we see that:'
  prefs: []
  type: TYPE_NORMAL
- en: -3 is the smallest value, so we assign it the rank 1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: -1 is the second smallest value, so we assign it the rank 2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: then comes 0, so we assign it the rank 3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: then comes 1, so we assign it the rank 4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: finally, 2 is the largest value, so we assign it the rank 5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The same goes for x, except that here we have two observations with the value
    5 (so there will be ties in the ranks). In this case, we take the mean rank:'
  prefs: []
  type: TYPE_NORMAL
- en: -1 is the smallest value, so we assign it the rank 1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2 is the second smallest value, so we assign it the rank 2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: then comes 3, so we assign it the rank 3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: finally, the two largest values belongs to rank 4 and 5, so we assign both of
    them the rank 4.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We include the ranks in the table, denoted `Rx` and `Ry`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/131b135ad66ebff27f322142d5435ce3.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'From there, it is similar than the Pearson coefficient except that we work
    on the ranks and not on the initial observations anymore. To avoid any confusion
    in the remaining steps, we remove the initial observations from the table and
    we keep only the ranks:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/835eece1d58a008adc698a6d393860a4.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We start with the means of the ranks:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d34a4309845978a588f8eff2753ba628.png)'
  prefs: []
  type: TYPE_IMG
- en: 'For the standard deviations, we use the table as we did for the Pearson coefficient:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7f4907c2f23e2aacaf98fd4310ef7067.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We sum the last two columns, which gives:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dfc5d9d748970900c17d32418a95a34f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The standard deviations are thus:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/63e6785a3614211b18e1f5292dd78d85.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 3.**'
  prefs: []
  type: TYPE_NORMAL
- en: We now need
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0345b5b6321648f961d67fb57035c141.png)'
  prefs: []
  type: TYPE_IMG
- en: 'so we add a new column in the table, corresponding to RxiRyi and denoted `Rx*Ry`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/108d391acc91a1eac4238e6273edc099.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4.**'
  prefs: []
  type: TYPE_NORMAL
- en: We take the sum of that last column, which gives
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/678f9842fdcee14e2338375d9eadc27a.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 5.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, the Spearman correlation coefficient can be computed by plugging all
    values in the initial formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8efc239ba4f3de113aefb268fbec7671.png)'
  prefs: []
  type: TYPE_IMG
- en: Without ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When all initial values are different within each variable, meaning that all
    ranks are distinct integers, there are no ties. In that specific case, the Spearman
    coefficient can be computed with the following shortened formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4df23307487229e8f5a91d405be9f6d1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'For example, suppose the sample without ties introduced at the beginning of
    the post:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/82c8736bc105724f1456bcee0efc8058.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'All observations within each variable are different, so all ranks are distinct
    integers and there are no ties:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/67851558560f1cc2be1fe2a0fd92c6d6.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'We only need to compute the difference between the two ranks of each row, denoted
    `Rx-Ry`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/976c3cd2c067e024e73e75b37f233fff.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'Take the square of these differences, denoted `(Rx-Ry)^2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fe16f41fa9d5ae1452ee320769449f30.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: And then take the sum of that last column, which gives
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6499b47fd82c18c3db8aae74682b089a.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Step 3.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, we can fill in the initial formula to find the Spearman coefficient:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e104647b02e19f38c8aaf6e0da320185.png)'
  prefs: []
  type: TYPE_IMG
- en: Kendall
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Kendall coefficient correlation, also known as Kendall’s τ coefficient, is similar
    to the Spearman coefficient, except that it is often preferred for small samples
    and when many rank ties.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here also we distinguish between two scenarios:'
  prefs: []
  type: TYPE_NORMAL
- en: if there are no ties
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: if there are ties
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Unlike Spearman coefficient, we first illustrate the scenario when there are
    no ties, and then when there are ties.
  prefs: []
  type: TYPE_NORMAL
- en: Without ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When there are no ties, the Kendall coefficient, denoted τa, is defined as follows
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dde98312b103d9e2569fca101945ef38.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where:'
  prefs: []
  type: TYPE_NORMAL
- en: C is the number of concordant pairs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: D is the number of discordant pairs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This coefficient, also referred as Kendall tau-a, does not make any adjustment
    for ties.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s see what are concordant and discordant pairs using the data without ties
    (the same data than for Spearman correlation without ties):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3be51aa253e10f29fae180239814439c.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'We start by computing the ranks for each variable (`Rx` and `Ry`), as we did
    for the Spearman coefficient:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/547e07d302856710edee96d694d5680d.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2.**'
  prefs: []
  type: TYPE_NORMAL
- en: We then arbitrarily choose a reference variable among the two, `Rx` or `Ry`.
    Suppose we take `Rx` as the reference variable here.
  prefs: []
  type: TYPE_NORMAL
- en: 'We sort the dataset by this reference variable:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f6990052928c882e481a638e475c85c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'From now, we only look at the ranks of the second variable (the one which is
    *not* the reference level, here `Ry`), so to avoid any confusion in the remaining
    steps we keep only the `Ry` column:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0de67a40c82edcaf6b1e4919380a65d2.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 3.**'
  prefs: []
  type: TYPE_NORMAL
- en: We now take each row of `Ry` one by one and check whether the rows below it
    in the table are smaller or larger.
  prefs: []
  type: TYPE_NORMAL
- en: 'In our table, the first row of `Ry` is 1\. We see that the value just below
    it is 3, which is larger than 1\. Since 3 is larger than 1, this is called a concordant
    pair. We write it in the table:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/67ab1add806702ae38de43c2e41ef8e0.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'The next row, 2, is also larger than 1, so it is also a concordant pair. We
    also write it in the table:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/067b89348c3006370a3f2a63fa3b15e8.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We start again with the second row of `Ry`, which is 3\. Again, we look at
    the row below it and check whether it is larger or smaller. Here, the row below
    it is 2, which is smaller than 3, so we have a discordant pair. We add this information
    into the table:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3fde63cd67d3632751b96fc221a98829.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'We now compute the total number of concordant and discordant pairs. There are:'
  prefs: []
  type: TYPE_NORMAL
- en: 2 concordant pairs so C = 2, and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 1 discordant pair so D = 1.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Step 5.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, we plug the values we have just found in the initial formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0cb87194912adc15bff1f09908c3228e.png)'
  prefs: []
  type: TYPE_IMG
- en: Alternatively, we can also use the following formulas
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c8b5029b224a9b3ee95a673e7502ad7c.png)'
  prefs: []
  type: TYPE_IMG
- en: where n is still the sample size, and which both give the exact same results.
  prefs: []
  type: TYPE_NORMAL
- en: With ties
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I must admit that the process with ties is slightly more complex than without
    ties.
  prefs: []
  type: TYPE_NORMAL
- en: The Kendall tau-b coefficient, which makes adjustments for ties, is defined
    as follows
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dfbb99b411b719938b16dc02522a5162.png)'
  prefs: []
  type: TYPE_IMG
- en: 'where:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/06247bddfd1cf00a69d97a57d2d66058.png)'
  prefs: []
  type: TYPE_IMG
- en: Note that here, the letter C in C2n denotes “combination” and not “concordant”.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s illustrate that scenario and the formula with the dataset used for the
    Pearson correlation and the Spearman correlation with ties, that is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/89c888d8573e5bbde5f7d6222f483fa2.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Similarly to with no ties, the process with ties is based on the ranks so we
    start by adding the ranks for each variable, denoted as usual as `Rx` and `Ry`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/87818fded6cc76b4cf124e6234dbd182.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2.**'
  prefs: []
  type: TYPE_NORMAL
- en: One of the two variables (x or y) must be selected as the reference variable.
    This time, we do not choose it arbitrarily, but we choose the one which does not
    have any ties. In our case, variable x has ties, while variable y does not have
    any ties. So y will be our reference variable.
  prefs: []
  type: TYPE_NORMAL
- en: 'We then:'
  prefs: []
  type: TYPE_NORMAL
- en: order the dataset by the reference variable, here `Ry`, and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'we keep only the necessary columns to avoid any confusion in the remaining
    steps:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/3b0b64a6f143e3d2ee703ea52457972f.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 3.**'
  prefs: []
  type: TYPE_NORMAL
- en: We check whether it is a concordant or discordant pair the same way we did without
    ties, but this time we do not count ties.
  prefs: []
  type: TYPE_NORMAL
- en: 'The first row in column `Rx` is 1\. We compare all rows below it in the table
    with that value. All rows below 1 in the table are larger, so we write that they
    are concordant pairs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/58bff8306e35e7812832d45c6aecd63f.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: We repeat the same process for each row.
  prefs: []
  type: TYPE_NORMAL
- en: 'For instance, for the second row of the column `Rx`, we have the value 2\.
    Again, all rows below in the table are larger so we write that they are concordant
    pairs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/00364da30cfad8d6e90d2b5ae0723fe2.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'For the third row of the column `Rx`, we have the value 4.5\. The row just
    below in the table (= 3) is smaller than 4, so we write D for discordant pair:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ebc7b4b9c466db59a2dcdf1bb9e16d1e.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, as you can see, the last row is also 4.5\. Therefore, since it is equal
    to the value we are comparing to, it is neither a concordant nor a discordant
    pair, so we write “T” in the table for “ties”:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6ef02570567eec725fb048846b873ee8.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'Last, the fourth row in the column `Rx` is 3, which we compare to 4.5 to see
    that 4.5 is larger so it is a concordant pair:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/249321d23dbf627b71139f5be88f5ea0.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 4.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'We then sum the number of concordant and discordant pairs:'
  prefs: []
  type: TYPE_NORMAL
- en: C = 8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: D = 1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Step 5.**'
  prefs: []
  type: TYPE_NORMAL
- en: We now have all the information required to compute the numerator of τb, but
    we still need to find
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/90ce3b54ba254b6887b4c289895b6de3.png)'
  prefs: []
  type: TYPE_IMG
- en: to compute the denominator.
  prefs: []
  type: TYPE_NORMAL
- en: As mentioned above, C2n is the total number of possible pairs, thus corresponding
    to the number of combinations of two values. This number of pairs can be found
    with the formula of the [combination](https://statsandr.com/blog/the-9-concepts-and-formulas-in-probability-that-every-data-scientist-should-know/#combination),
    that is,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4bd696bfa291966af5ef6a4cfecc0655.png)'
  prefs: []
  type: TYPE_IMG
- en: where n is the sample size.
  prefs: []
  type: TYPE_NORMAL
- en: In our case, we have a sample of size 5, so we have:[3](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fn3)
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3a8e0d2a2c3fb3da01dc20fa7ff46f7b.png)'
  prefs: []
  type: TYPE_IMG
- en: Furthermore, nx and ny are the number of possible pairs **with a tie** among
    the x and y variables, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: 'When looking at `Ry` and `Rx` from the table above:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5128e1e8304affee07e8d40c477c5858.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We see that there are:'
  prefs: []
  type: TYPE_NORMAL
- en: 2 identical values for the variable x
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 0 identical value for the variable y
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This means that the number of possible **pairs** with a tie is equal to:[4](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fn4)
  prefs: []
  type: TYPE_NORMAL
- en: 1 for the variable x (the only possible pair with a tie is the pair {4.5, 4.5})
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 0 for the variable y (since all ranks are distinct, there exists no pair with
    a tie)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0f746fd950ea72ba1cefad780f39329d.png)'
  prefs: []
  type: TYPE_IMG
- en: And we now have all the necessary information to compute τb!
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 6.**'
  prefs: []
  type: TYPE_NORMAL
- en: By plugging the values found above in the initial formula, we have
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bddf0d1d00bc55b520a77b0c90d3ce70.png)'
  prefs: []
  type: TYPE_IMG
- en: Verification in R
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For the sake of completeness, we verify our results with the help of R for each
    coefficient and scenario.
  prefs: []
  type: TYPE_NORMAL
- en: '**Pearson:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '**Spearman with ties:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '**Spearman without ties:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '**Kendall without ties:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '**Kendall with ties:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: We indeed find the same results by hand than with R (any discrepancies is due
    to rounding)!
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Remember that a correlation coefficient (no matter whether it is Pearson, Spearman,
    or Kendall) ranges from -1 to 1, with 0 being no correlation and the closer to
    1 in absolute terms, the stronger the correlation.
  prefs: []
  type: TYPE_NORMAL
- en: Broadly speaking, a positive correlation means that high values of one variable
    are associated with high values of the other variable (and vice versa). A negative
    correlation means that high values of one variable are associated with low values
    of the other variable.
  prefs: []
  type: TYPE_NORMAL
- en: Last but not least, remember that the conclusions drawn from a correlation coefficient
    computed within a sample cannot be generalized to the population without a proper
    statistical test, that is, a [correlation test](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/#correlation-test).
  prefs: []
  type: TYPE_NORMAL
- en: Thanks for reading.
  prefs: []
  type: TYPE_NORMAL
- en: I hope this article helped you to compute the Pearson, Spearman and Kendall
    correlation coefficients by hand (with and without ties).
  prefs: []
  type: TYPE_NORMAL
- en: As always, if you have a question or a suggestion related to the topic covered
    in this article, please add it as a comment so other readers can benefit from
    the discussion.
  prefs: []
  type: TYPE_NORMAL
- en: For your information, the Pearson correlation coefficient is considered as a
    parametric procedure, whereas the Spearman and Kendall correlation coefficients
    are considered as non-parametric procedures.[↩︎](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fnref1)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Here, we suppose that we have a sample and not a population. In the case where
    the observations you have represent the entire population, the correlation coefficient
    is denoted ρ and the formula differs slightly. See a recap of the [difference
    between a sample and a population](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)
    if needed.[↩︎](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fnref2)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remember that the factorial of n, denoted n!, is n! = n×(n−1)×⋯×1\. So for instance,
    5! = 5×4×3×2×1=120.[↩︎](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fnref3)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you have many identical values and want to count the number of possible pairs
    thanks to a formula rather than by counting them manually, you can again use the
    formula of the [combination](https://statsandr.com/blog/the-9-concepts-and-formulas-in-probability-that-every-data-scientist-should-know/#combination),
    that is, C2n = n! / x!(n−x)! where n is the number of identical values in a given
    group of ties. Bear in mind that the number of combinations must be summed up
    for all group of ties. In our case, we have only one group of ties with 2 values,
    so nx = C22 = 2! / 2!(2−2)! = 1.[↩︎](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/#fnref4)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Related articles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Correlation coefficient and correlation test in R](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Descriptive statistics in R](https://statsandr.com/blog/descriptive-statistics-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What is survival analysis? Examples by hand and in R](https://statsandr.com/blog/what-is-survival-analysis/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[One-sample Wilcoxon test in R](https://statsandr.com/blog/one-sample-wilcoxon-test-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Hypothesis test by hand](https://statsandr.com/blog/hypothesis-test-by-hand/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Originally published at* [*https://statsandr.com*](https://statsandr.com/blog/pearson-spearman-kendall-correlation-by-hand/)
    *on September 5, 2023.*'
  prefs: []
  type: TYPE_NORMAL

# Excel中的互动仪表盘

> 原文：[https://towardsdatascience.com/interactive-dashboards-in-excel-4f92e2ee6494](https://towardsdatascience.com/interactive-dashboards-in-excel-4f92e2ee6494)

## 使用先锋的数据分析软件

[](https://medium.com/@teosiyang?source=post_page-----4f92e2ee6494--------------------------------)[![Jake Teo](../Images/9687f43822fab69befb750a8ec58516d.png)](https://medium.com/@teosiyang?source=post_page-----4f92e2ee6494--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4f92e2ee6494--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4f92e2ee6494--------------------------------) [Jake Teo](https://medium.com/@teosiyang?source=post_page-----4f92e2ee6494--------------------------------)

·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4f92e2ee6494--------------------------------) ·阅读时长8分钟·2023年10月5日

--

这篇文章与我通常写的以开发为中心的文章有所不同。然而，最近我有幸与一个家庭合作，提高他们的数字素养，我们决定讨论的一个话题是Excel。

我曾作为全职数据分析师工作了好几年。近年来，这个职位的定义有所模糊，因为许多不同的角色都需要处理、获取见解并展示数据。即使今天作为一个DevSecOps工程师，我仍然需要做到这一点，以确保我管理的所有系统都能有效且高效地运行。

在我看来，Excel是“非技术”领域中最先驱且最广泛使用的数据工程与分析软件。这里学到的数据分析与可视化技能可以轻松转移到任何领域和任何软件，只要我们建立了坚实的基础。

![](../Images/21ef4aec10be24745a0dbbe131b1a182.png)

图片来自 [Unsplash](https://unsplash.com)，作者 [Lukas Blazek](https://unsplash.com/@goumbik)

> 本教程是使用Mac Excel v16.77.1创建的。与早期或晚期版本可能会有一些功能和外观上的小差异。

# 结果

这次练习的结果是制作一个与下方相同的互动仪表盘。很酷，对吧？

![](../Images/74d9d4c575873b502c43c84405bc4d0d.png)

在本篇文章结束时你将学到的内容。（图片来源：作者）

# 超市数据集

首先，[下载](https://public.tableau.com/app/learn/sample-data?qt-overview_resources=1#qt-overview_resources) Tableau网站上的美国超市数据集。这是一个虚构的公司，数据包括他们的产品、销售和利润，供我们使用。

文件的格式是`.xls`。我们需要将其转换为最新的`.xlsx`格式，以便某些功能能够正常工作。要做到这一点：

1.  打开`sample_-_superstore.xls`电子表格，你会看到三个标签页，*Orders*、*Returns* 和 *People*。现在复制*Orders*工作表的所有内容。我们不需要其他的。

1.  创建一个全新的空白 Excel 电子表格，并将*订单*内容粘贴到其中。保存它。默认情况下，它应该是`xlsx`格式，除非你使用的是非常旧的 Excel 版本。

# 1) 数据透视表

接下来，我们将创建2个数据透视表来计算总利润和总销售额。这是一种方便的工具，用于在数据字段之间进行分析和计算。**数据透视表及其其他透视变体是使仪表板中各部分能够互相交互的必要条件。**

![](../Images/da1fa44ee68a8cfa5e736e4de8b95080.png)

创建数据透视表（作者提供的图片）

为此，点击*插入 > 数据透视表 > 确定*以接受默认值。这将创建一个包含数据透视表的新工作表。

![](../Images/49eaa518f6d3f60551fa56e2c66390e2.png)

使用数据透视表计算总和（作者提供的图片）

在新工作表中，右侧会弹出一个窗口来定制数据透视表的计算方式。我们只需要计算利润的总和，因此我们将`利润`字段拖到`值`区域。它会自动假设计算总和。

现在重复完全相同的步骤，使用`销售`字段来获取销售总和。

# 2) 数据透视图（折线图）

现在是时候创建显示利润和销售月度趋势的折线图数据透视图了。转到*插入 > 数据透视图*，在*订单*工作表中。

![](../Images/024c044abec6bf0318908b9c9ff7ba73.png)

创建数据透视图（作者提供的图片）

类似于数据透视表，我们选择所需的字段。将`销售`字段拖到值区域，将`订单日期`字段拖到轴区域。你可能会看到年份和季度字段自动添加，因为 Excel 识别`订单日期`为日期格式。移除这些字段，然后应该显示出按月销售额的柱状图，如下所示。

![](../Images/a160a75b0f091f5a4a8fd136f5e4bd30.png)

数据透视图（作者提供的图片）

现在让我们将其转换为折线图。点击图表，然后转到设计 > 更改图表类型 > 折线 > 选择折线图。

![](../Images/4fb8033e62ef8dbab194b2c6065556c9.png)

将柱状图更改为折线图（作者提供的图片）

现在将此数据透视图工作表标记为“月度销售”。

![](../Images/f7bfbc2ecc06ddd77e77da19980b8c9c.png)

为工作表命名（作者提供的图片）

现在重复完全相同的步骤来获取按月利润的折线图。

# 3) 数据透视图（柱状图）

现在让我们使用数据透视图为每个产品细分市场创建两个柱状图，一个显示利润，另一个显示销售额。轴字段应为`细分市场`，值字段应为`利润`。

![](../Images/3019b9d4c1a8d85ba0817eb9fac88560.png)

创建按细分市场的利润（作者提供的图片）

我们希望柱状图水平显示，所以我们来更改图表类型。

![](../Images/5704d655094d2976af72fc15c5f97bcc.png)

更改为水平柱状图（作者提供的图片）

最后，将新工作表标记为*按细分市场利润*，以保持整洁。

现在重复相同的步骤，获取按细分市场的销售柱状图。

# 4) 地图

没有“透视图”这一术语。一个替代方案是首先创建一个行使用`States`字段和使用`Profit`值的透视表，然后将数据链接到地图。

在那个工作表中，选择一个空白单元格，然后在*插入 > 地图 > 填充地图*中创建一个空白地图。

![](../Images/76f25a04dcde46e07f46496e50af0d1c.png)

添加一个空白地图可视化（作者图片）

选择地图后，转到图表设计 > 选择数据 > 图表数据范围 > 选择包含美国州名及其对应利润的两个列单元格。地图可视化将自动识别州名并相应填充地图。

![](../Images/c80ddceee28d838709dc17fdaff5a841.png)

为地图填充数据点（作者图片）

现在，将此工作表重命名为“地图”。

# 5) 集成到仪表板

现在是将所有内容整合到一个仪表板中的时候了。

1.  创建一个名为*仪表板*的新工作表。

1.  对于包含透视表的两个工作表，将**两个**标题和每个工作表的总值剪切并粘贴到新的*仪表板*工作表中。

1.  对于包含透视图表和地图的5个工作表，将它们从每个工作表剪切并粘贴到新的*仪表板*工作表中。

![](../Images/1f29a4c47be113934f21796d45e6b71d.png)

将所有透视表和图表整合到一个工作表中（作者图片）

# 6) 切片器

切片器是过滤我们在仪表板中刚创建的图表和数值的对象。这是互动的关键。主要有两个关键组件：

1.  为透视表创建切片器以过滤特定字段

1.  将切片器连接到其他透视表

选择一个透视表或图表。在透视表（图表）分析 > 插入切片器 > 选中`Region`、`Year`和`Ship Mode`字段。

![](../Images/333b8d49da8a38600cbeff75b4616bd8.png)

创建切片器（作者图片）

现在，选择一个切片器，点击报表连接。在这里，检查所有列出的透视表。注意，你所有的透视图表和地图也通过透视表连接，所以这将把它们连接在一起。

![](../Images/ab0663a8d0dfbb1df606fee091a8fdc2.png)

将切片器连接到其他透视表（作者图片）

切片器的一个旁注是，它们有时会动态修改单元格宽度。为了解决这个问题，选择利润和销售总和的透视表 > 选项 > 取消选中“更新时自动调整列宽”。

![](../Images/e62649ec251dc66a0db6fd912e01182c.png)

防止切片时单元格宽度动态变化（作者图片）

就是这样！你已经拥有了一个互动仪表板！尝试点击切片器的过滤器，查看所有图表和数值如何一起变化。

# 7) 格式化

这一部分较长，重点关注仪表板的美观性和可读性。然而，如果我们希望它吸引观众的注意力，这是一项最重要的技能。

现在让我们使地图颜色更直观，因为有些州的利润数字是负数。

1.  双击图表，右侧会出现“格式化数据系列”面板。点击“系列选项”图标标签。

1.  对于渐变样式，选择发散型（3 种颜色）

1.  对于最小值，将颜色更改为红色

1.  对于中点，将其更改为数字，值为 0，颜色为白色

![](../Images/2f2f1a7c6bd173f0867e920e22d62c33.png)

设置地图的热力图（作者提供的图片）

现在我们转到利润和销售总和部分。我们不需要标题，但由于无法移除数据透视表标题，因此用破折号 `-` 替换它。然后增加字体大小，并将数字格式转换为货币格式，不带小数点。

![](../Images/06db7f6257467ae314f5f434b48597a2.png)

格式化销售和利润的总和（作者提供的图片）

标题以垂直文本的形式添加在侧边。可以通过右键单击单元格 > 格式单元格 > 对齐选项卡 > 拖动文本对齐方式或输入角度来实现垂直显示。然后将文本颜色更改为绿色。

对销售总额重复这些步骤，但使用蓝色。

![](../Images/ccf431225306b9dc79f60a13537dbeda.png)

垂直文本对齐（作者提供的图片）

对于月度利润的折线图，我们只需要一个简单的趋势线，没有标题、坐标轴和图例（即 **spark-line**）。点击每个组件并将其删除。通过选择外部图表区域并选择 *无边框* 来移除图表边框，如下所示。我们还希望更改线条颜色，可以通过类似的方法，但这次选择图表线条并更改线条颜色。

![](../Images/d86c2346e645e9c3bbb8a79330eb83d1.png)

移除图表边框（作者提供的图片）

对于月度销售图表，我们进行相同的清理，但保留 x 轴标签。通过移除坐标轴线并旋转标签来格式化坐标轴。

![](../Images/1de53e17437646551aa2bf59a2727b3e.png)

格式化 x 轴（作者提供的图片）

最后的可视化是柱状图。我们按照惯例清理图表，移除不必要的图表组件。然后，通过修改间距宽度来增加柱子的宽度。

![](../Images/d2b482b57b8ce14cdb5ac20f27141cc5.png)

增加柱子的宽度（作者提供的图片）

接下来，在每个柱子内添加数据标签。之后还可以修改数字格式和字体大小。与折线图一样，移除边框，并更改柱子的颜色。

![](../Images/266a134e60a2b7f800895265792ff881.png)

为每个柱子添加数据标签（作者提供的图片）

我们差不多完成了！现在调整每个图表的大小和标题。目前唯一不雅的地方是网格线。

![](../Images/76d1f53c62ea814fceab642897f5b95e.png)

几乎完成的仪表板（作者提供的图片）

可以通过查看 > 取消选中网格线轻松移除。

![](../Images/96aa9c15d59b520d33362d1e387642fe.png)

移除网格线（作者提供的图片）

# 总结

这是一篇包含很多步骤的长帖。然而，我们只需掌握几个主要概念，便可以轻松在 Excel 中开发自己的交互式仪表板。

1.  **仪表板**由切片器、数据透视表、数据透视图或其他可视化如地图等组成，全部位于一个工作表中。

1.  所有可视化必须连接到**数据透视表**，以便切片器正常工作。

1.  **切片器**通过连接到数据透视表并一次性过滤所有值，提供互动功能。

![](../Images/327c5b3dae25450c4d3629330336a36d.png)

Excel 仪表板的组成部分（图片由作者提供）

# 链接

+   超市数据集来自 Tableau: [https://public.tableau.com/app/learn/sample-data](https://public.tableau.com/app/learn/sample-data)

- en: RANK() vs DENSE_RANK() vs ROW_NUMBER() in SQL
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: SQL ä¸­çš„ RANK() ä¸ DENSE_RANK() å’Œ ROW_NUMBER()
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/rank-vs-dense-rank-vs-row-number-sql-1b6c09097b21](https://towardsdatascience.com/rank-vs-dense-rank-vs-row-number-sql-1b6c09097b21)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/rank-vs-dense-rank-vs-row-number-sql-1b6c09097b21](https://towardsdatascience.com/rank-vs-dense-rank-vs-row-number-sql-1b6c09097b21)
- en: Understanding the difference between these window functions in SQL
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç†è§£ SQL ä¸­è¿™äº›çª—å£å‡½æ•°ä¹‹é—´çš„åŒºåˆ«
- en: '[](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)[![Giorgos
    Myrianthous](../Images/ff4b116e4fb9a095ce45eb064fde5af3.png)](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)
    [Giorgos Myrianthous](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)[![Giorgos
    Myrianthous](../Images/ff4b116e4fb9a095ce45eb064fde5af3.png)](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)
    [Giorgos Myrianthous](https://gmyrianthous.medium.com/?source=post_page-----1b6c09097b21--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)
    Â·6 min readÂ·Mar 6, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1b6c09097b21--------------------------------)
    Â·6 åˆ†é’Ÿé˜…è¯»Â·2023å¹´3æœˆ6æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/14a0fd288583774a244801d6caf38161.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/14a0fd288583774a244801d6caf38161.png)'
- en: Photo by [Nik](https://unsplash.com/@helloimnik?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/UNCQklgSUd4?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”± [Nik](https://unsplash.com/@helloimnik?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/photos/UNCQklgSUd4?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
- en: In the world of SQL, a window function is a powerful construct that allows users
    to segment and manipulate data in precise ways. By grouping data based on specific
    columns and sorting criteria, window functions enable advanced computations within
    partitions.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ SQL çš„ä¸–ç•Œé‡Œï¼Œçª—å£å‡½æ•°æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ„é€ ï¼Œå…è®¸ç”¨æˆ·ä»¥ç²¾ç¡®çš„æ–¹å¼å¯¹æ•°æ®è¿›è¡Œåˆ†æ®µå’Œæ“ä½œã€‚é€šè¿‡æ ¹æ®ç‰¹å®šåˆ—å’Œæ’åºæ ‡å‡†å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œçª—å£å‡½æ•°ä½¿å¾—åœ¨åˆ†åŒºå†…è¿›è¡Œé«˜çº§è®¡ç®—æˆä¸ºå¯èƒ½ã€‚
- en: 'In this comprehensive tutorial, we will explore three of the most frequently
    used window functions: `ROW_NUMBER()`, `DENSE_RANK()`, and `RANK()`. Whether youâ€™re
    a seasoned SQL veteran or just getting started, this guide will equip you with
    the knowledge and practical examples you need to master these essential tools.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡å…¨é¢çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸‰ç§æœ€å¸¸ç”¨çš„çª—å£å‡½æ•°ï¼š`ROW_NUMBER()`ã€`DENSE_RANK()` å’Œ `RANK()`ã€‚æ— è®ºä½ æ˜¯ç»éªŒä¸°å¯Œçš„
    SQL ä¸“å®¶è¿˜æ˜¯åˆšåˆšå…¥é—¨ï¼Œæœ¬æŒ‡å—å°†æä¾›ä½ æŒæ¡è¿™äº›å…³é”®å·¥å…·æ‰€éœ€çš„çŸ¥è¯†å’Œå®é™…ç¤ºä¾‹ã€‚
- en: All code snippets included have been tested on a MySQL database, and these functions
    should run for pretty much any SQL flavour with minimal or no modifications required.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€æœ‰åŒ…å«çš„ä»£ç ç‰‡æ®µå‡å·²åœ¨ MySQL æ•°æ®åº“ä¸Šæµ‹è¯•ï¼Œè¿™äº›å‡½æ•°åœ¨å‡ ä¹ä»»ä½• SQL æ–¹è¨€ä¸­éƒ½åº”è¿è¡Œï¼Œåªéœ€æœ€å°æˆ–æ— éœ€ä¿®æ”¹ã€‚
- en: '[**Subscribe to Data Pipeline**](https://thedatapipeline.substack.com/welcome)**,
    a newsletter dedicated to Data Engineering**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[**è®¢é˜… Data Pipeline**](https://thedatapipeline.substack.com/welcome)**ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ•°æ®å·¥ç¨‹çš„æ–°é—»é€šè®¯**'
- en: First, letâ€™s create an example table that we will be referencing throughout
    the tutorial in order to demonstrate a few different concepts.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¤ºä¾‹è¡¨æ ¼ï¼Œåœ¨æ•´ä¸ªæ•™ç¨‹ä¸­å°†å‚è€ƒè¿™ä¸ªè¡¨æ ¼ï¼Œä»¥æ¼”ç¤ºå‡ ä¸ªä¸åŒçš„æ¦‚å¿µã€‚
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'And hereâ€™s how our sample table looks like:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ä»¬çš„ç¤ºä¾‹è¡¨æ ¼çš„æ ·å­ï¼š
- en: '[PRE1]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: What is a window function?
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯çª—å£å‡½æ•°ï¼Ÿ
- en: A window function is used in SQL to perform calculations over a group of rows
    and returns one value per row. Note the difference from an aggregate function
    that is used to return just a single value for each group. Window functions are
    usually used to compute cumulative sums, rankings as well as moving averages.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: çª—å£å‡½æ•°ç”¨äº SQL ä¸­ï¼Œå¯¹ä¸€ç»„è¡Œæ‰§è¡Œè®¡ç®—ï¼Œå¹¶ä¸ºæ¯ä¸€è¡Œè¿”å›ä¸€ä¸ªå€¼ã€‚æ³¨æ„ä¸èšåˆå‡½æ•°çš„åŒºåˆ«ï¼Œåè€…ç”¨äºè¿”å›æ¯ç»„çš„å•ä¸ªå€¼ã€‚çª—å£å‡½æ•°é€šå¸¸ç”¨äºè®¡ç®—ç´¯è®¡æ€»å’Œã€æ’åä»¥åŠç§»åŠ¨å¹³å‡å€¼ã€‚
- en: A valid syntax for window functions should include
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: çª—å£å‡½æ•°çš„æœ‰æ•ˆè¯­æ³•åº”åŒ…æ‹¬
- en: the `**OVER**` **clause** is specified after the function and is used to reference
    the window
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`**OVER**` **å­å¥**åœ¨å‡½æ•°ä¹‹åæŒ‡å®šï¼Œç”¨äºå¼•ç”¨çª—å£'
- en: and the **window specification** that specifies the way the rows should be grouped
    (this specification can include `PARTITION BY` and/or `ORDER BY` clauses)
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å’Œ**çª—å£è§„èŒƒ**ï¼ŒæŒ‡å®šäº†è¡Œåº”å¦‚ä½•åˆ†ç»„ï¼ˆè¯¥è§„èŒƒå¯ä»¥åŒ…æ‹¬`PARTITION BY`å’Œ/æˆ–`ORDER BY`å­å¥ï¼‰
- en: The RANK() window function
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RANK()çª—å£å‡½æ•°
- en: The `RANK()` function returns the rank for each row within the specified group
    or partition(s). In case more than one rows have the same value within the partition,
    then all of them will be assigned the same ranking. In this case, a gap will be
    created in the rankings given that subsequent rows will be assigned the number
    that corresponds to their actual position in the rank (and not the next available
    rank).
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '`RANK()`å‡½æ•°è¿”å›æŒ‡å®šç»„æˆ–åˆ†åŒºå†…æ¯è¡Œçš„æ’åã€‚å¦‚æœåœ¨åˆ†åŒºå†…æœ‰å¤šè¡Œå…·æœ‰ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ‰€æœ‰è¿™äº›è¡Œå°†è¢«åˆ†é…ç›¸åŒçš„æ’åã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ’åä¸­ä¼šå‡ºç°é—´éš™ï¼Œå› ä¸ºéšåçš„è¡Œå°†è¢«åˆ†é…ä¸å…¶å®é™…æ’åç›¸å¯¹åº”çš„ç¼–å·ï¼ˆè€Œä¸æ˜¯ä¸‹ä¸€ä¸ªå¯ç”¨çš„æ’åï¼‰ã€‚'
- en: 'Now letâ€™s consider we would like to create a ranking for the records in `employees`
    such that employees serving in the same position are ranked based on their earnings.
    This can be achieved using the following query:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬è€ƒè™‘åˆ›å»ºä¸€ä¸ª`employees`è®°å½•çš„æ’åï¼Œä½¿å¾—åœ¨ç›¸åŒèŒä½ä¸Šçš„å‘˜å·¥æ ¹æ®æ”¶å…¥è¿›è¡Œæ’åã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æŸ¥è¯¢å®ç°ï¼š
- en: '[PRE2]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note the gap created in the rankings for `Senior Associate` position. Two employees
    were assigned the second rank which means the record following these two records
    will be assigned a rank of `4` (and not `3`).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„`Senior Associate`èŒä½çš„æ’åå‡ºç°äº†é—´éš™ã€‚ä¸¤åå‘˜å·¥è¢«åˆ†é…äº†ç¬¬äºŒåï¼Œè¿™æ„å‘³ç€ç´§éšè¿™ä¸¤åè®°å½•çš„è®°å½•å°†è¢«åˆ†é…ä¸º`4`ï¼ˆè€Œä¸æ˜¯`3`ï¼‰ã€‚
- en: The DENSE_RANK() window function
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: DENSE_RANK()çª—å£å‡½æ•°
- en: 'The `DENSE_RANK()` function returns the rank for each row within the specified
    group or partition(s). In contrast to `RANK()`, the `DENSE_RANK()` will have no
    gaps:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '`DENSE_RANK()`å‡½æ•°è¿”å›æŒ‡å®šç»„æˆ–åˆ†åŒºå†…æ¯è¡Œçš„æ’åã€‚ä¸`RANK()`ä¸åŒï¼Œ`DENSE_RANK()`ä¸ä¼šå‡ºç°é—´éš™ï¼š'
- en: '[PRE3]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note how the 4th Senior Associate will now get a rank equal to 3, given that
    two other emloyees are sharing the second rank and no gaps should be created by
    `DENSE_RANK` window function.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ç¬¬4åSenior Associateç°åœ¨ä¼šè·å¾—3åæ’åï¼Œå› ä¸ºå…¶ä»–ä¸¤åå‘˜å·¥å…±äº«ç¬¬äºŒåæ’åï¼Œå¹¶ä¸”`DENSE_RANK`çª—å£å‡½æ•°ä¸ä¼šåˆ›å»ºé—´éš™ã€‚
- en: The ROW_NUMBER() window function
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ROW_NUMBER()çª—å£å‡½æ•°
- en: Finally, the `ROW_NUMBER` window function will assign a number to every row
    starting from index `1` for the first row within each partition.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œ`ROW_NUMBER`çª—å£å‡½æ•°ä¼šä¸ºæ¯ä¸ªåˆ†åŒºå†…çš„æ¯ä¸€è¡Œåˆ†é…ä¸€ä¸ªä»ç´¢å¼•`1`å¼€å§‹çš„ç¼–å·ã€‚
- en: '[PRE4]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Final Thoughts
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æœ€ç»ˆæ€è€ƒ
- en: In conclusion, window functions are a powerful feature of SQL that allow for
    complex calculations to be performed over a specific subset of rows in a result
    set. They can be used to calculate running totals, rolling averages, and other
    metrics that require a reference to neighboring rows.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ä¹‹ï¼Œçª—å£å‡½æ•°æ˜¯SQLçš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œå…è®¸åœ¨ç»“æœé›†çš„ç‰¹å®šå­é›†ä¸Šæ‰§è¡Œå¤æ‚çš„è®¡ç®—ã€‚å®ƒä»¬å¯ä»¥ç”¨æ¥è®¡ç®—ç´¯è®¡æ€»æ•°ã€æ»šåŠ¨å¹³å‡å€¼å’Œå…¶ä»–éœ€è¦å‚è€ƒé‚»è¿‘è¡Œçš„æŒ‡æ ‡ã€‚
- en: In todayâ€™s article we discussed about the difference between `RANK()`, `DENSE_RANK()`
    and `ROW_NUMBER()` functions. By understanding the differences between these types
    of window functions, you can choose the most appropriate one for your specific
    use case and optimize the performance of your SQL queries.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†`RANK()`ã€`DENSE_RANK()`å’Œ`ROW_NUMBER()`å‡½æ•°ä¹‹é—´çš„åŒºåˆ«ã€‚é€šè¿‡ç†è§£è¿™äº›çª—å£å‡½æ•°ä¹‹é—´çš„å·®å¼‚ï¼Œä½ å¯ä»¥é€‰æ‹©æœ€é€‚åˆä½ ç‰¹å®šç”¨ä¾‹çš„å‡½æ•°ï¼Œå¹¶ä¼˜åŒ–ä½ çš„SQLæŸ¥è¯¢æ€§èƒ½ã€‚
- en: ğŸ‘‰ [**Subscribe to Data Pipeline**](https://thedatapipeline.substack.com/welcome)**,
    a newsletter dedicated to Data Engineering**
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ‘‰ [**è®¢é˜…æ•°æ®ç®¡é“**](https://thedatapipeline.substack.com/welcome)**ï¼Œä¸€ä»½ä¸“æ³¨äºæ•°æ®å·¥ç¨‹çš„æ–°é—»é€šè®¯**
- en: ğŸ‘‡**Related articles you may also like** ğŸ‘‡
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ‘‡**ç›¸å…³çš„æ–‡ç« ä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢** ğŸ‘‡
- en: '[](/dbt-55b35c974533?source=post_page-----1b6c09097b21--------------------------------)
    [## What is dbt (data build tool)'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/dbt-55b35c974533?source=post_page-----1b6c09097b21--------------------------------)
    [## ä»€ä¹ˆæ˜¯dbtï¼ˆæ•°æ®æ„å»ºå·¥å…·ï¼‰'
- en: A gentle introduction to dbt that is taking over the data world
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¯¹æ­£åœ¨ä¸»å¯¼æ•°æ®é¢†åŸŸçš„dbtçš„æ¸©å’Œä»‹ç»
- en: 'towardsdatascience.com](/dbt-55b35c974533?source=post_page-----1b6c09097b21--------------------------------)
    [](/etl-vs-elt-68e221d78719?source=post_page-----1b6c09097b21--------------------------------)
    [## ETL vs ELT: Whatâ€™s the Difference?'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/dbt-55b35c974533?source=post_page-----1b6c09097b21--------------------------------)
    [](/etl-vs-elt-68e221d78719?source=post_page-----1b6c09097b21--------------------------------)
    [## ETLä¸ELTï¼šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
- en: A comparison between ETL and ELT in the context of Data Engineering
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®å·¥ç¨‹èƒŒæ™¯ä¸‹ETLä¸ELTçš„æ¯”è¾ƒ
- en: towardsdatascience.com](/etl-vs-elt-68e221d78719?source=post_page-----1b6c09097b21--------------------------------)
    [](/cte-sql-945e4b461de3?source=post_page-----1b6c09097b21--------------------------------)
    [## What are CTEs in SQL
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/etl-vs-elt-68e221d78719?source=post_page-----1b6c09097b21--------------------------------)
    [](/cte-sql-945e4b461de3?source=post_page-----1b6c09097b21--------------------------------)
    [## ä»€ä¹ˆæ˜¯ SQL ä¸­çš„ CTE
- en: Understanding Common Table Expression (CTE) in SQL
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç†è§£ SQL ä¸­çš„å…¬å…±è¡¨è¡¨è¾¾å¼ï¼ˆCTEï¼‰
- en: towardsdatascience.com](/cte-sql-945e4b461de3?source=post_page-----1b6c09097b21--------------------------------)
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/cte-sql-945e4b461de3?source=post_page-----1b6c09097b21--------------------------------)

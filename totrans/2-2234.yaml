- en: 'Unraveling the Design Pattern of Physics-Informed Neural Networks: Series 01'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527](https://towardsdatascience.com/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Optimizing the residual point distribution to boost PINN training efficiency
    and accuracy
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://shuaiguo.medium.com/?source=post_page-----8190df459527--------------------------------)[![Shuai
    Guo](../Images/d673c066f8006079be5bf92757e73a59.png)](https://shuaiguo.medium.com/?source=post_page-----8190df459527--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8190df459527--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8190df459527--------------------------------)
    [Shuai Guo](https://shuaiguo.medium.com/?source=post_page-----8190df459527--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8190df459527--------------------------------)
    ¬∑9 min read¬∑May 15, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3a1599878662cd266da87887603e2fac.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Sebastian Yepes](https://unsplash.com/de/@sebasluna?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: In recent years, Physics-Informed Neural Networks (PINNs) have emerged as a
    remarkable approach that combines the power of neural networks with insights from
    fundamental physical laws. As I immersed myself in this field, I often feel overwhelmed
    by the vast number of research papers and various techniques they proposed. Navigating
    through this sea of information became a challenging task, especially when I wanted
    to find the most effective solutions for my specific problems.
  prefs: []
  type: TYPE_NORMAL
- en: 'My personal journey and experiences have sparked the idea of starting this
    blog series: my idea is that, in each blog post, I will focus on one or several
    research papers and distill their contributions into easily understandable insights.
    My hope is that this blog series could serve as a structured map that PINN practitioners
    can rely on, to identify the most suitable techniques for specific challenges
    at hand, stay updated with the latest advancements, and navigate the world of
    PINNs more confidently.'
  prefs: []
  type: TYPE_NORMAL
- en: 'So, how should this distillation process look like? Personally, I find the
    concept of *design patterns* to be a very nice framework:'
  prefs: []
  type: TYPE_NORMAL
- en: Design pattern refers to **reusable solutions** to **commonly occuring problems**
    that have been tested and proven to be effective. Design patterns provide a template
    for solving these problems, which can be adapted to different situations as needed.
    They serve as best practices, capturing the collective knowledge and experience
    of experts in the field.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Therefore, this blog series will go beyond traditional paper reviews. It will
    serve as an organized catalog, encompassing:'
  prefs: []
  type: TYPE_NORMAL
- en: the **problem**, the specific problem the proposed strategy is trying to address;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the **solution**, the key components of the proposed strategy, how it is implemented,
    and why it might work;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the **benchmark**, what physical problems are evaluated, and what‚Äôs the associated
    performance;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the **strengths & weaknesses**, under which conditions the proposed strategy
    can be effective, while also highlighting its potential limitations;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the **alternatives**, other approaches proposed to address a similar problem,
    thus providing a broader perspective on potential solutions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I hope this approach resonates with you, as it truly reflects my passion for
    organizing knowledge and making it accessible. Without further ado, let‚Äôs embark
    on this exciting journey together by exploring the first PINN paper, where we
    will focus on creating better residual points for PINN training.
  prefs: []
  type: TYPE_NORMAL
- en: 'As this series continues to expand, the collection of PINN design patterns
    grows even richer*üôå* Here‚Äôs a sneak peek at what awaits you:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 02: Dynamic solution interval expansion](/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-02-2156516f2791)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 03: training PINN with gradient boosting](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-03-fe365ef480d9)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 04: gradient-enhanced PINN learning](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-04-c778f4829dde)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 05: automated hyperparameter tuning](/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-05-67a35a984b23)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 06: Causal PINN training](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-06-bcb3557199e2)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PINN design pattern 07: Active learning with PINN](/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-07-4ecb543b616a)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**1\. Paper at a glance:**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Title**: A comprehensive study of non-adaptive and residual-based adaptive
    sampling for physics-informed neural networks'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Authors**: C. Wu, M. Zhu, Q. Tan, Y. Kartha, L. Lu'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Institutes**: University of Pennsylvania, University of Southern California,
    Georgia Institute of Technology'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Link**: [arXiv](https://arxiv.org/abs/2207.10289)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2\. Design pattern
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 2.1 Problem
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Physics-Informed Neural Networks (PINNs) offer a distinct advantage over conventional
    neural networks by explicitly integrating known governing ordinary or partial
    differential equations (ODEs/PDEs) of physical processes. The enforcement of these
    governing equations in PINNs relies on a set of points known as residual points.
    These points are strategically selected within the simulation domain, and the
    corresponding network outputs are substituted into the governing equations to
    evaluate the residuals. The residuals indicate the extent to which the network
    outputs align with the underlying physical processes, thereby serving as a crucial
    physical loss term that guides the neural network training process.
  prefs: []
  type: TYPE_NORMAL
- en: It is evident that the distribution of these residual points plays a pivotal
    role in influencing the accuracy and efficiency of PINNs during training. However,
    the prevailing approach often involves simple uniform sampling, which leaves ample
    room for improvement.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/989311699ca9130e738cc405f29e22c1.png)'
  prefs: []
  type: TYPE_IMG
- en: Illustration of PINN. The part encircled by the dashed line, i.e., the distribution
    of residual points, is the main problem tackled by the paper. (Image by this blog
    author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Consequently, a pressing question arises: How can we optimize the distribution
    of residual points to enhance the accuracy and training efficiency of PINNs?'
  prefs: []
  type: TYPE_NORMAL
- en: 2.2 Solution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Promising ways of distributing the residual points are by adopting the **adaptive
    strategy** and the **refinement strategy:**
  prefs: []
  type: TYPE_NORMAL
- en: The adaptive strategy means that after every certain number of training iterations,
    a new batch of residual points can be generated to replace the previous residual
    points;
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The refinement strategy means that extra residual points can be added to the
    existing ones, thus ‚Äúrefining‚Äù the residual points.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Based on those two foundational strategies, the paper proposed two novel sampling
    methods: *Residual-based Adaptive Distribution* (RAD) and *Residual-based Adaptive
    Refinement with Distribution* (RAR-D):'
  prefs: []
  type: TYPE_NORMAL
- en: '1\. RAD: **R**esidual-based **A**daptive **D**istribution'
  prefs: []
  type: TYPE_NORMAL
- en: 'The key idea is to draw new residual samples based on a customized probability
    density function over the spatial domain ***x***.The probability density function
    *P*(***x***) is designed such that it‚Äôs proportional to the PDE residual Œµ(***x***)
    at ***x***:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4a1cde7a6af58541b6a7c4dfb92153e0.png)'
  prefs: []
  type: TYPE_IMG
- en: Custom probability density function for generating residual points. (Adopted
    from the original paper)
  prefs: []
  type: TYPE_NORMAL
- en: Here, *k* and *c* are two hyperparameters, and the expectation term in the denominator
    can be approximated by e.g., Monte Carlo integration.
  prefs: []
  type: TYPE_NORMAL
- en: 'In total, there are three hyperparameters for RAD approach: *k*, *c*, and the
    period of resampling *N*. Although the optimal hyperparameter values are problem-dependent,
    the suggested default values are 1, 1, and 2000.'
  prefs: []
  type: TYPE_NORMAL
- en: '2\. RAR-D: **R**esidual-based **A**daptive **R**efinement with **D**istribution'
  prefs: []
  type: TYPE_NORMAL
- en: 'Essentially, RAR-D adds the element of refinement on top of the proposed RAD
    approach: after certain training iterations, instead of replacing entirely the
    old residual points with new ones, RAR-D keeps the old residual points and draws
    new residual points according to the custom probability density function displayed
    above.'
  prefs: []
  type: TYPE_NORMAL
- en: For RAR-D, the suggested default values for *k* and *c* are 2 and 0, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: 2.3 Why the solution might work
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The key lies in the designed sampling probability density function: this density
    function tends to place more points in regions where the PDE residuals are large
    and fewer points in regions where the residuals are small. This strategic distribution
    of points enables a more detailed analysis of the PDE in regions where the residuals
    are higher, potentially leading to enhanced accuracy in PINN predictions. Additionally,
    the optimized distribution allows for more efficient use of computational resources,
    thus reducing the total number of points required for accurate resolution of the
    governing PDE.'
  prefs: []
  type: TYPE_NORMAL
- en: 2.4 Benchmark
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The paper benchmarked the performance of two proposed methods in comparison
    with eight other sampling strategies. They assessed these approaches in terms
    of addressing both forward and inverse problems within various physical equations:'
  prefs: []
  type: TYPE_NORMAL
- en: '1D diffusion equation: this type of equation describes heat conduction, molecular
    diffusion, and other similar physical processes. The equation describes how the
    density of a substance changes over time as it spreads out or diffuses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/86af37c0c61aa69afe612d7a811cf07f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Burgers‚Äô equation: this equation combines non-linear convection with diffusion/viscosity.
    It‚Äôs used in various areas of applied mathematics, including fluid mechanics,
    traffic flow, gas dynamics, and even to model shock waves in some instances.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/034caa9f20a7f5a4a6019736c8cfad0d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Allen-Cahn equation: this equation is widely used to describe the process of
    phase separation, a crucial phenomenon in materials science. It models the evolution
    of a binary (two-phase) system towards a minimal energy configuration.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/555545e3a41e6b5c448916d0e969712a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Wave equation: this equation is a second-order linear partial differential
    equation that describes waves ‚Äî like sound waves, light waves, or water waves
    ‚Äî as they move through a medium. It‚Äôs fundamental to the fields of acoustics and
    electromagnetics.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/f2e2731784e82f8db4b97e18cd9bc8b0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Diffusion-reaction equation (inverse problem, calibrating reaction rate *k*(*x*)):
    this equation is a combination of the diffusion equation and a reaction system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/87478cc388efe92fdd62c6b3ea085b00.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Korteweg-de Vries equation (inverse problem, calibrating Œª‚ÇÅ and Œª‚ÇÇ): this equation
    describes the propagation of certain types of waves, like shallow water waves.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/fc2762f384a7b5260b7100b55cd1d764.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The comparison studies yielded that:'
  prefs: []
  type: TYPE_NORMAL
- en: RAD strategy consistently yielded the best performance, making it a strong default
    strategy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If computational cost is a concern, RAR-D could serve as a robust alternative,
    as it offers sufficient accuracy and is less computationally demanding than RAD.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Both RAD & RAR-D show particular effectiveness when dealing with complex PDEs.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The advantage of RAD & RAR-D becomes less pronounced when the simulated PDEs
    have smooth solutions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 2.5 Strength and Weakness
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: üëç**Strengths**
  prefs: []
  type: TYPE_NORMAL
- en: Dynamically improves the distribution of residual points based on the PDE residuals
    during training.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Leads to an increase in PINN accuracy.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Achieves comparable accuracy to existing methods with fewer residual points.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: üëé**Weaknesses**
  prefs: []
  type: TYPE_NORMAL
- en: Can be more computationally expensive than other non-adaptive uniform sampling
    methods. However, this is the price to pay for a higher accuracy.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For PDEs with smooth solutions, e.g., diffusion equation, diffusion-reaction
    equation, etc., some simple uniform sampling methods may produce sufficiently
    low errors, making the proposed solution potentially less suitable in those cases.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduced two new hyperparameters *k* and *c* that need to be tuned as their
    optimal values are problem-dependent.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2.6 Alternatives
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Other approaches have been proposed prior to the current paper:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/23c8b6de4fba25a841362746ec5bca3f.png)'
  prefs: []
  type: TYPE_IMG
- en: A total of 10 sampling approaches were investigated in the paper. The two newly
    proposed approaches are highlighted in red. (Image by this blog author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Among those methods, two of them heavily influenced the approaches proposed
    in the current paper:'
  prefs: []
  type: TYPE_NORMAL
- en: Residual-based adaptive refinement ([Lu et al.](https://arxiv.org/abs/1907.04502)),
    which is a special case of the proposed RAR-D with a large value of *k.*
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Importance sampling ([Nabian et al.](https://arxiv.org/abs/2104.12325)), which
    is a special case of RAD by setting *k*=1 and *c*=0.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 3 Potential Future Improvements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Future improvements could be made in the following directions:'
  prefs: []
  type: TYPE_NORMAL
- en: Further optimize the probability density function for residual points generation,
    possibly with *meta-learning* techniques.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Leverage more sophisticated *active learning* or *reinforcement learning* techniques
    to refine the sampling strategy.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 4 Takeaways
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this blog, we looked at promising solutions to the problem of optimizing
    residual point distribution in PINNs. This topic is highly relevant as it directly
    impacts the accuracy and efficiency of the PINNs. The takeaways from the design
    pattern proposed in the paper are summarized here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Problem]: How to distribute the residual points for evaluating physical loss?'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Solution]: **1**. **Adaptive sampling**, where more samples are drawn in the
    region of high PDE residuals. 2\. **Refinement sampling**, where new residual
    points are added on top of the existing points.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Potential benefits]: 1\. Improved accuracy. 2\. Fewer residual points are
    required.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here is the PINN design pattern card I have prepared:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dc4d1a467f6725b4a8e318a0619653a7.png)'
  prefs: []
  type: TYPE_IMG
- en: PINN design pattern proposed in the paper. (Image by this blog author)
  prefs: []
  type: TYPE_NORMAL
- en: 'I hope you found this blog usefulüòÉIf you want to learn more about PINN design
    patterns, feel free to check out other posts in this series:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PINN design pattern 02: Dynamic solution interval expansion](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-02-2156516f2791)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PINN design pattern 03: PINN training with gradient boost](/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-03-fe365ef480d9)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PINN design pattern 04: gradient-enhanced PINN learning](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-04-c778f4829dde)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PINN design pattern 05: Hyperparameter tuning for PINN](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-05-67a35a984b23)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PINN design pattern 06: Causal PINN training](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-06-bcb3557199e2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PINN design pattern 07: Active learning with PINN](/unraveling-the-design-pattern-of-physics-informed-neural-networks-part-07-4ecb543b616a)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reference
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[1] Wu et al., A comprehensive study of non-adaptive and residual-based adaptive
    sampling for physics-informed neural networks, [arXiv](https://arxiv.org/abs/2207.10289),
    2022.'
  prefs: []
  type: TYPE_NORMAL

["```py\nrm(list = ls())\nlibrary(data.table) # Fast data frames\nlibrary(fastDummies) # Create dummy variables\nlibrary(fixest) # Fixed-effects regression\nlibrary(kableExtra) # Make nice tables\nlibrary(bacondecomp) # Goodman-Bacon Decomposition\nlibrary(did) # Difference-in-differences package by Callaway & Sant'Anna\nsource('sim_data.R') # Import data simulation functions and utilities\n\ndata <- sim_data() # Simulate the dataset\n\n# EDA and Analysis --------------------------------------------------------\nselect_cols <- c('unit', 'period', 'cohort_period','treat','hrs_listened')\n\nkable(head(data[, ..select_cols]), 'simple')\n```", "```py\nformula <- as.formula('hrs_listened ~ treat')\ncanonical_did <- feols(formula,\n                       data = data, panel.id = \"unit\",\n                       fixef = c(\"unit\", \"period\"), cluster = \"unit\")\nsummary(canonical_did) \n```", "```py\n # Goodman-Bacon Decomposition\nbacon_decomp <- bacon(formula, data, id_var=\"unit\", time_var='period', quietly = F)\n```", "```py\n# Drop periods that have no untreated units\ndata <- data[period < 3]\n```", "```py\n# Create dummy variables\ndata <- data %>% \n  dummy_cols(select_columns = c(\"cohort_period\", \"period\"))\n\ninteract_covs <- 'cohort_period_2:period_2'\n\n# Regression\nformula <- as.formula(paste0('hrs_listened ~ ',interact_covs))\nmodel <- feols(formula,\n               data = data, panel.id = \"unit\",\n               fixef = c(\"unit\", \"period\"), cluster = \"unit\")\nsummary(model) \n```", "```py\n# did package\nout <- att_gt(yname = \"hrs_listened\",\n              gname = \"cohort_period\",\n              idname = \"unit\",\n              tname = \"period\",\n              xformla = ~1,\n              data = data,\n              est_method = \"reg\",\n              control_group = 'notyettreated'\n)\nout\n```", "```py\nggdid(out) # graph the results\n```"]
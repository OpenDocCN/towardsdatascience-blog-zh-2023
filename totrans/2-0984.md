# 现代数据科学家的Git：你不能忽视的9个Git概念

> 原文：[https://towardsdatascience.com/git-for-the-modern-data-scientist-9-git-concepts-you-cant-ignore-b4eaf7a154c2](https://towardsdatascience.com/git-for-the-modern-data-scientist-9-git-concepts-you-cant-ignore-b4eaf7a154c2)

## 通过引人注目的视觉效果进行讲解

[](https://ibexorigin.medium.com/?source=post_page-----b4eaf7a154c2--------------------------------)[![Bex T.](../Images/516496f32596e8ad56bf07f178a643c6.png)](https://ibexorigin.medium.com/?source=post_page-----b4eaf7a154c2--------------------------------)[](https://towardsdatascience.com/?source=post_page-----b4eaf7a154c2--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----b4eaf7a154c2--------------------------------) [Bex T.](https://ibexorigin.medium.com/?source=post_page-----b4eaf7a154c2--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----b4eaf7a154c2--------------------------------) ·12分钟阅读·2023年5月6日

--

![](../Images/2df9ea9d0ee942c7ecabd1db26dc4e5b.png)

图片由我与Midjourney提供

## 介绍

大多数数据科学家在使用Git时感觉像是水中鱼。有些软件工程师只谈论Git的事情，而数据科学家则每次都说“啊？”（我希望能加上声音效果）。

今天就到此为止！因为Git是协作的基本工具，我将详细讲解数据科学家必须如数家珍的*九个*最关键的Git概念。

我可以保证，下次有人谈论Git或版本控制时，你不会再假装理解。

让我们开始吧！

## 第1000次……

你可能已经听过几百次了，但我还是谨慎起见再说一次：

> *Git是开发ML和AI系统中最关键的工具之一。*

![](../Images/a10be2945aa15fe0a62bf6092f20d94c.png)

图片由我提供

如果你对机器学习或数据科学项目的理解是通过创意命名的文件如“notebook1”、“notebook2”、“notebook_final”和“notebook_final_final”来完成模型，那么就不要考虑Git了。

然而，如果你打算部署他人可以使用的模型，Git是一个相对较小的代价。

Git允许你跟踪代码和数据的更改，与他人协作，并维护项目历史。使用Git，你可以轻松恢复到工作中的先前版本，比较不同版本，并合并多个贡献者的更改。

此外，Git轻松与其他流行的MLOps工具如DVC集成，使其成为数据科学家的必备工具。

## 0\. 仓库

基本上，仓库就是这个：

![](../Images/40e71e09eeda643d5aa7d044e1a35baa.png)

图片由我提供

这是你计算机上的一个文件夹。它可以没有文件、三个文件或一百个。将该文件夹转换为Git仓库所需的唯一操作是在其中调用`git init`。

![](../Images/c71a68c959f3b9ad8091f8da8fe17e6d.png)

图片由我提供。初始化Git仓库。

机器学习仓库通常有用于存储数据、模型的文件夹，以及用于加载、清理和转换数据的代码文件夹，以及用于选择、训练和保存模型以进行部署的文件夹。

还会有其他杂项文件，如用于Git内部和元数据的`.git`文件夹。

所有这些构成了一个单一的仓库，Git通常足以跟踪它们（数据和模型除外。有关内容，请参阅[这篇文章](/how-to-version-gigabyte-sized-datasets-just-like-code-with-dvc-in-python-5197662e85bd)）。

## 1\. 跟踪，未跟踪

当你在目录中初始化Git时，默认情况下，你创建的任何现有或新文件/目录将不会被Git跟踪。

![](../Images/dec5dd4ba088601d4058ff11eb6438b8.png)

图片由我提供。展示`git status`命令

这意味着你对这些文件所做的任何未来更改也将不会被跟踪。因此，你需要通过运行`git add path/to/file.py`将这些文件纳入Git的监督。

![](../Images/a9dce75b32a5b81b858d9aa4d0d9f3ab.png)

图片由我提供。跟踪Git中的文件和目录。

在对文件调用`git add`后，它们将被Git监视。

如果你希望添加仓库中的所有文件（尽管这非常不可能），你可以调用`git add .`。

还有一些情况下你绝不希望文件被Git跟踪。这时你需要创建一个`.gitignore`文件。

正如名字所示，添加到`.gitignore`中的文件将不会被Git跟踪或索引，只要它们在那儿。对于数据项目，你应该将大型数据文件如CSV、parquet、图片、视频或音频添加到`.gitignore`中。Git在处理这些内容时历史上表现不佳。

它像高手一样处理其余部分。

附注：你可以在终端中用`touch .gitignore`创建`.gitignore`文件，并用`echo "filename" >> .gitignore`在新行中添加文件/文件夹。

## 2\. 提交

Git提交是一件珍贵的事情。版本控制的整个理念都基于此。

当你在Git仓库中调用`git commit`时，你会在特定时间点对每个Git跟踪的文件进行快照。可以把它当作一个包含你项目不同时间段内容（版本）的时间胶囊。

![](../Images/192dacfa032109e1ee8a56728f2a1b63.png)

图片由我提供。进行第一次提交。

你所做的所有提交将形成你的Git历史或Git树，如下所示。

![](../Images/96448ca3496eaaacf2cef6adaf434a4b.png)

图片由我提供。一个小型Git树。

一个好的Git树组织了你仓库的线性进展。通过将你的代码更改分解为离散的、明确定义的提交，你几乎可以像书一样绘制出仓库的进展。

然后，你可以通过提交浏览这本Git书的各个页面。

就像一个作家在书中的每一页上都投入大量精力一样，你也应该细心对待你的提交。

你不应该为了提交而提交。把它们视为历史的小片段，并知道未来的你和其他开发人员应该欣赏它们，而不是厌恶。

> 传统建议：一个好的提交有一个描述所做更改的信息性消息。

在典型的机器学习项目中，常见的提交场景包括：

+   实现新功能：编写代码以添加新的功能，比如新的函数、类、类方法、训练新模型、新的数据清理操作等。

+   修复 bug：记录对现有函数、方法和类的 bug 修复

+   提升性能：编写代码来优化现有功能，比如优化代码块

+   更新文档和依赖项

+   机器学习实验：在一个项目中，你将运行数十个实验以选择和调整最佳模型。[每个模型运行都应该作为提交进行跟踪](https://pub.towardsai.net/how-to-track-ml-experiments-with-dvc-inside-vscode-to-boost-your-productivity-a654ace60bab)。

## 3\. 暂存区

说到提交，我们已经超前了。在关闭提交封装之前，你必须确保其中的内容是正确的。

这涉及到告诉 Git 你具体想提交哪些文件的哪些更改。有时候，新的更改可能来自多个文件，而你可能只想提交其中的一部分，留下其余部分以便未来提交。

这是我们揭开幕布，展示暂存区的地方（带点俏皮话）：

![](../Images/994e52a84ed86c4d6053af88d4ce004c.png)

由我提供的图像。在将更改添加到 train.py 后，暂存区发生了变化。

这个想法是，你必须有某种方式在按下提交按钮之前，双重检查、编辑或撤销你想添加到 Git 历史记录中的更改。

将新更改添加到暂存区（或者**Git 索引**，如某些人所说）可以实现这一点。该区域保存了你希望包含在下一个提交中的更改。

假设你修改了`clean.py`和`train.py`。如果你使用`git add train.py`将`train.py`中的更改添加到暂存区，下一个提交将仅包含该更改。

修改过的`clean.py`将保持原样（未提交）。

![](../Images/994e52a84ed86c4d6053af88d4ce004c.png)

由我提供的图像。上面的图像为了清晰展示而重新显示。

所以，这里有一个简单的工作流程：

1.  使用 Git 跟踪新文件（仅需做一次）

1.  使用`git add changed_file.extension`将跟踪的文件中的更改添加到暂存区

1.  使用`git commit -m "Commit message"`将暂存区的更改提交到历史记录中。

## 4\. 哈希和标签

除了消息，所有 Git 提交都有哈希，这样你可以更容易地指向它们。

![](../Images/20e9a5aab08ad9c4b35f1922b755c02d.png)

由我提供的图像。三个示例提交，具有 7 位字符的哈希值。

哈希是一个具有 40 个十六进制字符的字符串，给每个提交分配唯一的 ID，例如 `1a3b5c7d9e2f4g6h8i0j1k2l3m4n5o6p7q8r9s0t`。

它们使在提交（你代码库的不同版本）之间切换变得更加容易，使用 `git checkout HASH`。切换时不必写完整的哈希值。只需要哈希值的前几个字符，这些字符足以使其唯一。

你可以使用 `git log` 列出你所做的所有提交及其哈希值（这会显示提交的作者和消息）。

为了只列出哈希和消息而不使屏幕混乱，你可以使用 `git log --oneline`。

![](../Images/e4923bc74c22e8a38a50967861bfa77d.png)

图片由我提供。用于逐行列出你的 Git 日志的命令。

如果哈希值让你感到困惑，还有 **Git 标签**。Git 标签是你可以为一些重要的提交（或任何提交）起的友好昵称，以便更容易记住和引用它们。

![](../Images/b8c14686cdf46b56ba779e1042d92725.png)

图片由我提供。四个提交，其中两个被标记。

你可以使用命令“git tag”将标签分配给特定的提交，这些提交很重要，例如包含关键功能或重要代码库发布的提交（例如，`v1.0.0`）。此外，你还可以给代表你最佳模型的提交打标签，例如“`random_forest_best`”。

将标签视为在人类可读的里程碑，这些里程碑在所有提交哈希中脱颖而出。

> 为了澄清，命令 `git tag ‘tag_name’` 只会给最后一个提交添加标签。如果你想为特定提交添加标签，你需要在命令末尾指定提交哈希，在标签名称之后。

## 5\. 分支

提交后，分支是 Git 的核心。99% 的时间里，你都将在 Git 分支中工作。

默认情况下，当你在文件夹中初始化 Git 时，你所在的分支将被命名为 `main` 或 `master`。

![](../Images/65888cbb303d3432c38b2fa97e01ed64.png)

图片由我提供。主分支。

你可以将其他分支视为你代码库的替代现实。

通过创建 Git 分支，你可以测试和实验新功能、想法和修复，而不用担心会弄乱你的代码库。

例如，你可以在一个新的分支中测试用于分类任务的新算法，而不会干扰主代码库：

![](../Images/36e11b813e20d5213d12cd9816ef4da0.png)

图片由我提供。创建新的 SGD 分支。

Git 分支非常便宜。当你调用 `git branch new_branch_name` 时，Git 会创建主分支的伪副本，而不会重复任何文件。

创建新分支并尝试新想法后，如果结果看起来不太理想，你可以选择删除该分支。另一方面，如果你对新分支中的更改感到满意，你可以将其合并到主分支。

## 6\. HEAD

一个 Git 仓库可以有多个分支和数百个提交。因此，你可能会提出一个很好的问题：“Git 如何知道你在哪个分支或提交上？”。

Git 使用一个叫做**HEAD**的特殊指针，这就是答案。

![](../Images/da3321270729d5ad3e8dae70bad26d06.png)

图片由我提供。HEAD 的切换。

基本上，HEAD 就是你。无论你在哪里，HEAD 都会在 Git 中跟随你。99% 的时候，HEAD 会指向**当前分支中的最新提交**。

如果你进行新的提交，HEAD 将会移动到那个提交。如果你切换到一个新分支或旧分支，HEAD 将会切换到该分支中的最新提交。

HEAD 的一个用例是比较不同提交之间的变化。例如，调用`git diff HEAD~1`将会比较最新提交与紧接在它之前的提交。

这也意味着 Git 中的`HEAD~n`语法指的是*HEAD*所在位置*之前*的第*n*个提交。

![](../Images/853d1f7a1beea603b6a4ecb0903a9342.png)

图片由我提供。HEAD~n 语法。

你也可能进入到令人讨厌的**分离的 HEAD 状态**。这并不意味着 Git 已经丢失了对你的追踪，不知道该指向哪里。

当你使用命令`git checkout HASH`来检出特定提交时，会发生分离的 HEAD 状态，而不是使用**git checkout branch_name**。这会迫使 HEAD 不再指向分支的末端，而是指向提交历史中的某个特定提交。

![](../Images/27628f19f5d4ab78faa08482df1e9192.png)

图片由我提供。分离的 HEAD 状态。

在分离的 HEAD 状态下，你所做的任何更改或提交都会被孤立或孤立，不会成为你 Git 历史的一部分。原因是 HEAD 是分支的头部。它非常喜欢附着在分支的末端或头部，而不是它的腹部或腿部。

因此，如果你想在分离的 HEAD 状态下进行更改，你应该调用`git switch -c new_branch`来在当前提交处创建一个新分支。这将使你脱离分离状态，并移动 HEAD。

理解 HEAD 对于帮助你导航任何复杂的 Git 树会大有裨益。

## 7\. 合并

那么，创建新分支后会发生什么？

如果你的实验没有成功，你会用`git branch -d branch_name`丢弃它吗？还是会进行传说中的 Git 合并？

基本上，Git 合并是一个盛大的聚会，其中两个甚至更多的分支汇聚在一起，创建一个更粗的分支。

![](../Images/3e9757742580ca948f5ef32a97ab2963.png)

图片由我提供。两个分支的合并。

当你合并分支时，Git 会将每个分支中的代码合并到一个统一的代码库中。

如果分支中存在重叠的更改，即两个分支都修改了`train.py`中的第 5 到 10 行，Git 会引发合并冲突。

合并冲突听起来就像它的名字那样糟糕。要解决冲突，你必须决定要保留哪个分支的更改。

解决合并冲突而不发火并且不让耳朵冒烟是一项随着时间推移而培养的稀有技能。所以，我不会多谈这个问题，会推荐你查看[这篇优秀的文章](https://www.atlassian.com/git/tutorials/using-branches/merge-conflicts)来自 Atlassian。

## 8\. 储藏

我在编码时往往会搞砸很多。一个想法闪现；我尝试一下，结果发现它毫无用处。

起初，我会愚蠢地将混乱的代码抹去，但后来会后悔。尽管这个想法毫无用处，但这并不意味着我不能在未来使用某些代码块。

然后，我发现了 Git 暂存区，它们很快成为了我最喜欢的 Git 特性之一。

当你调用`git stash`时，Git 会自动将暂存的或隐藏的更改（包括已暂存和未暂存的更改）放入工作目录。文件会恢复到刚刚提交的状态。

![](../Images/c43a098c1f87953f22451d579be63107.png)

图片由我提供。暂存区发生了什么？

在你暂存了更改之后，你可以像往常一样继续你的工作。当你想再次检索这些更改时（无论在何处），你可以使用`git stash apply`或`git stash pop`命令。这些命令将把之前保存到暂存区的更改恢复到工作目录中。

> 请注意，`git stash`命令只保存对跟踪文件的更改，而不包括未跟踪的文件。为了暂存跟踪和未跟踪的文件，你需要使用`-u`标志与`git stash`命令一起使用。被忽略的文件不会包含在暂存区中。

## 9\. GitHub

所以，我们来到了一个古老的问题——Git和GitHub之间有什么区别？

这就像是在问汉堡和芝士汉堡之间的区别。

Git 是一个版本控制系统，用于跟踪仓库。另一方面，GitHub 是一个基于网络的平台，用于在线存储由 Git 控制的仓库。

当仓库在线并且开放合作时，Git 的优势真正显现出来。如果一个仓库仅存在于你的本地机器上，其他人无法与你一起进行工作。

因此，可以将 GitHub 看作是你本地仓库的远程镜像，其他人可以克隆、分叉并建议拉取请求。

如果这些术语对你来说还很陌生，请关注我的下一篇文章，我将解释 N（我现在不知道有多少个）GitHub 概念，立即澄清这些困惑。

## 包装

就这样！我希望这篇文章为你提供了关于这9个 Git 概念的极大清晰度。特别是，我发现 HEAD 的概念对很多人来说是个真正的*难题* :)

确保阅读官方 Git 文档以获得更多（尽管非常无聊）信息。

感谢阅读！

喜欢这篇文章以及它那奇特的写作风格？想象一下，你可以访问更多类似的文章，都是由一个才华横溢、迷人且机智的作者（顺便说一下，就是我 :)）撰写的。

只需 4.99 美元的会员，你将不仅能访问我的故事，还能获得 Medium 上最优秀和最聪明头脑的知识宝库。如果你使用[我的推荐链接](https://ibexorigin.medium.com/membership)，你将获得我**超新星的感激**以及一个虚拟的击掌，以感谢你对我工作的支持。

[](https://ibexorigin.medium.com/membership?source=post_page-----b4eaf7a154c2--------------------------------) [## 使用我的推荐链接加入 Medium — Bex T.

### 获得对我所有⚡高级⚡内容和整个Medium平台的无限制访问。通过购买我的…

[ibexorigin.medium.com](https://ibexorigin.medium.com/membership?source=post_page-----b4eaf7a154c2--------------------------------) 支持我的工作！[](../Images/a01b5e4fb641db5f35b8172a4388e821.png)

图片由我制作。通过Midjourney。

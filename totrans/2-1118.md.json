["```py\nimport requests\n\nENDPOINT = \"https://dummyjson.com/\"\ndef make_api_call(resource):\n    ENDPOINT = \"https://dummyjson.com/\"\n    response = requests.get(f\"{ENDPOINT}{resource}\") # making a request to the correct endpoint\n    if response.status_code == 200:\n        return response.json()\n    else:\n        raise Exception(response.text)\n\nprint(make_api_call(\"carts\"))\n```", "```py\n {\n  \"carts\": [\n    {\n      \"id\": 1,\n      \"products\": [\n        {\n          \"id\": 59,\n          \"title\": \"Spring and summershoes\",\n          \"price\": 20,\n          \"quantity\": 3,\n          \"total\": 60,\n          \"discountPercentage\": 8.71,\n          \"discountedPrice\": 55\n        },\n        {...}\n        // more products\n      ],\n      \"total\": 2328,\n      \"discountedTotal\": 1941,\n      \"userId\": 97,\n      \"totalProducts\": 5,\n      \"totalQuantity\": 10\n    },\n    {...},\n    {...},\n    {...}\n    // 20 items\n  ],\n  \"total\": 20,\n  \"skip\": 0,\n  \"limit\": 20\n}\n```", "```py\n{\n  \"users\": [\n    {\n      \"id\": 1,\n      \"firstName\": \"Terry\",\n      \"lastName\": \"Medhurst\",\n      \"maidenName\": \"Smitham\",\n      \"age\": 50,\n      \"gender\": \"male\",\n      \"email\": \"atuny0@sohu.com\",\n      \"phone\": \"+63 791 675 8914\",\n      \"username\": \"atuny0\",\n      \"password\": \"9uQFF1Lh\",\n      \"birthDate\": \"2000-12-25\",\n      \"image\": \"https://robohash.org/hicveldicta.png?size=50x50&set=set1\",\n      \"bloodGroup\": \"Aâˆ’\",\n      \"height\": 189,\n      \"weight\": 75.4,\n      \"eyeColor\": \"Green\",\n      \"hair\": {\n        \"color\": \"Black\",\n        \"type\": \"Strands\"\n      },\n      \"domain\": \"slashdot.org\",\n      \"ip\": \"117.29.86.254\",\n      \"address\": {\n        \"address\": \"1745 T Street Southeast\",\n        \"city\": \"Washington\",\n        \"coordinates\": {\n          \"lat\": 38.867033,\n          \"lng\": -76.979235\n        },\n        \"postalCode\": \"20020\",\n        \"state\": \"DC\"\n      },\n      \"macAddress\": \"13:69:BA:56:A3:74\",\n      \"university\": \"Capitol University\",\n      \"bank\": {\n        \"cardExpire\": \"06/22\",\n        \"cardNumber\": \"50380955204220685\",\n        \"cardType\": \"maestro\",\n        \"currency\": \"Peso\",\n        \"iban\": \"NO17 0695 2754 967\"\n      },\n      \"company\": {\n        \"address\": {\n          \"address\": \"629 Debbie Drive\",\n          \"city\": \"Nashville\",\n          \"coordinates\": {\n            \"lat\": 36.208114,\n            \"lng\": -86.58621199999999\n          },\n          \"postalCode\": \"37076\",\n          \"state\": \"TN\"\n        },\n        \"department\": \"Marketing\",\n        \"name\": \"Blanda-O'Keefe\",\n        \"title\": \"Help Desk Operator\"\n      },\n      \"ein\": \"20-9487066\",\n      \"ssn\": \"661-64-2976\",\n      \"userAgent\": \"Mozilla/5.0 ...\"\n    },\n    {...},\n    {...}\n    // 30 items\n  ],\n  \"total\": 100,\n  \"skip\": 0,\n  \"limit\": 30\n}\n```", "```py\ndef make_api_call(resource):\n    ENDPOINT = \"https://dummyjson.com/\"\n    results_picked = 0\n    total_results = 100 #We don't know yet, but we need to initialize\n    all_data = []\n    while results_picked < total_results:\n        response = requests.get(f\"{ENDPOINT}{resource}\", params = {\"skip\" : results_picked})\n        if response.status_code == 200:\n            data = response.json()\n            rows = data.get(resource)\n            all_data += rows #concatening the two lists\n            total_results = data.get(\"total\")\n            results_picked += len(rows) #to skip them in the next call\n        else:\n            raise Exception(response.text)\n    return all_data\n\nusers_data = make_api_call(\"users\")\nprint(len(users_data))\n```", "```py\nimport json    \n\ndef download_json(data, resource_name):\n    file_path = f\"{resource_name}.json\"\n    with open(file_path, \"w\") as file:\n        file.write(\"\\n\".join([json.dumps(row) for row in data]))\n\ndownload_json(carts_data, \"carts\")\ndownload_json(users_data, \"users\")\n```", "```py\n{\"id\": 1, \"products\": [{\"id\": 59, \"title\": \"Spring and summershoes\", \"price\": 20, \"quantity\": 3, \"total\": 60, \"discountPercentage\": 8.71, \"discountedPrice\": 55}, {\"id\": 88, \"title\": \"TC Reusable Silicone Magic Washing Gloves\", \"price\": 29, \"quantity\": 2, \"total\": 58, \"discountPercentage\": 3.19, \"discountedPrice\": 56}, {\"id\": 18, \"title\": \"Oil Free Moisturizer 100ml\", \"price\": 40, \"quantity\": 2, \"total\": 80, \"discountPercentage\": 13.1, \"discountedPrice\": 70}, {\"id\": 95, \"title\": \"Wholesale cargo lashing Belt\", \"price\": 930, \"quantity\": 1, \"total\": 930, \"discountPercentage\": 17.67, \"discountedPrice\": 766}, {\"id\": 39, \"title\": \"Women Sweaters Wool\", \"price\": 600, \"quantity\": 2, \"total\": 1200, \"discountPercentage\": 17.2, \"discountedPrice\": 994}], \"total\": 2328, \"discountedTotal\": 1941, \"userId\": 97, \"totalProducts\": 5, \"totalQuantity\": 10}\n// other carts\n{\"id\": 20, \"products\": [{\"id\": 66, \"title\": \"Steel Analog Couple Watches\", \"price\": 35, \"quantity\": 3, \"total\": 105, \"discountPercentage\": 3.23, \"discountedPrice\": 102}, {\"id\": 59, \"title\": \"Spring and summershoes\", \"price\": 20, \"quantity\": 1, \"total\": 20, \"discountPercentage\": 8.71, \"discountedPrice\": 18}, {\"id\": 29, \"title\": \"Handcraft Chinese style\", \"price\": 60, \"quantity\": 1, \"total\": 60, \"discountPercentage\": 15.34, \"discountedPrice\": 51}, {\"id\": 32, \"title\": \"Sofa for Coffe Cafe\", \"price\": 50, \"quantity\": 1, \"total\": 50, \"discountPercentage\": 15.59, \"discountedPrice\": 42}, {\"id\": 46, \"title\": \"women's shoes\", \"price\": 40, \"quantity\": 2, \"total\": 80, \"discountPercentage\": 16.96, \"discountedPrice\": 66}], \"total\": 315, \"discountedTotal\": 279, \"userId\": 75, \"totalProducts\": 5, \"totalQuantity\": 8}\n```", "```py\nexport GOOGLE_APPLICATION_CREDENTIALS=service-account.json\n```", "```py\ndef load_file(resource, client):\n    table_id = f\"data-analysis-347920.medium.dummy_{resource}\"\n\n    job_config = bigquery.LoadJobConfig(\n        source_format=bigquery.SourceFormat.NEWLINE_DELIMITED_JSON, \n        autodetect=True,\n        write_disposition=\"write_truncate\"\n    )\n\n    with open(f\"{resource}.json\", \"rb\") as source_file:\n        job = client.load_table_from_file(source_file, table_id, job_config=job_config)\n\n        job.result()  # Waits for the job to complete.\n\n        table = client.get_table(table_id)  # Make an API request.\n        print(\n            \"Loaded {} rows and {} columns to {}\".format(\n                table.num_rows, len(table.schema), table_id\n            )\n        )\n\nclient = bigquery.Client()\nload_file(\"carts\", client)\nload_file(\"users\", client)\n```", "```py\nLoaded 20 rows and 7 columns to data-analysis-347920.medium.dummy_carts\nLoaded 100 rows and 27 columns to data-analysis-347920.medium.dummy_users\n```", "```py\nSELECT \n  u.id AS user_id,\n  u.firstName AS user_first_name, \n  u.lastName AS user_last_name,\n  SUM(total) AS total_spent\nFROM `data-analysis-347920.medium.dummy_users` u\nLEFT JOIN  `data-analysis-347920.medium.dummy_carts` c\nON u.id= c.userId\nGROUP BY u.id,user_first_name,user_last_name\nORDER BY total_spent DESC\n```", "```py\nquery= \"\"\"\nSELECT \n  u.id AS user_id,\n  u.firstName AS user_first_name, \n  u.lastName AS user_last_name,\n  SUM(total) AS total_spent\nFROM `data-analysis-347920.medium.dummy_users` u\nLEFT JOIN  `data-analysis-347920.medium.dummy_carts` c\nON u.id= c.userId\nGROUP BY u.id,user_first_name,user_last_name\n\"\"\"\n\nquery_config= bigquery.QueryJobConfig(\n    destination = \"data-analysis-347920.medium.dummy_best_spenders\", \n    write_disposition= \"write_truncate\"\n    )\nclient.query(query, job_config= query_config)\n```"]
- en: Schedule a Python script to run automatically on a Windows Desktop/Azure VM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/schedule-a-python-script-to-run-automatically-on-a-windows-desktop-azure-vm-8b4f469f969f](https://towardsdatascience.com/schedule-a-python-script-to-run-automatically-on-a-windows-desktop-azure-vm-8b4f469f969f)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Automatically refresh your data using Task Scheduler
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://mg-subha.medium.com/?source=post_page-----8b4f469f969f--------------------------------)[![Subha
    Ganapathi](../Images/d346759d5990b79aae7ef2c3a5ab7cf3.png)](https://mg-subha.medium.com/?source=post_page-----8b4f469f969f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8b4f469f969f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8b4f469f969f--------------------------------)
    [Subha Ganapathi](https://mg-subha.medium.com/?source=post_page-----8b4f469f969f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8b4f469f969f--------------------------------)
    ·4 min read·Feb 20, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7c335d2a83cccaedcd33c874a8944c62.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Ales Nesetril](https://unsplash.com/de/@alesnesetril?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/s/photos/tech?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: '**Overview**'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s assume that you have a couple of Python Scripts that you have developed
    on the Anaconda environment on a Windows Desktop/Azure VM. Let’s say that you
    would like to execute these scripts on a schedule. Here, we discuss a way to automate
    the script run. Since you are using the Anaconda environment, you may have installed
    all the python package dependencies in Anaconda.
  prefs: []
  type: TYPE_NORMAL
- en: '**The Process**'
  prefs: []
  type: TYPE_NORMAL
- en: Below is a schematic showing the process involved in the automation. As you
    can see below, we will be using Windows Task Scheduler for this.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b9c9d3bf9cce5708ce55404e304880ae.png)'
  prefs: []
  type: TYPE_IMG
- en: Schematic showing the overall process (by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Let’s go through the steps -
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1 — Writing a Batch Script**'
  prefs: []
  type: TYPE_NORMAL
- en: The batch script does two things —
  prefs: []
  type: TYPE_NORMAL
- en: It activates the Anaconda Environment
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once it activates the environment, it executes the python script in that environment.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Before we start writing the batch script, let’s identify the Anaconda Environment
    we plan to use —
  prefs: []
  type: TYPE_NORMAL
- en: From the ‘Start’ Menu, open ‘Anaconda Prompt’ and type the following command
    —
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: This command will list all the Anaconda environments available on your machine.
    Make a note of the name of the Anaconda environment you would like to use.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let’s proceed with the batch script.
  prefs: []
  type: TYPE_NORMAL
- en: To activate the Anaconda environment, the following can be added to the batch
    script -
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The above is assuming that your Anaconda installation resides in ‘C:\ProgramData\Anaconda3’;
    and that ‘base’ is the Anaconda environment you would like to use.
  prefs: []
  type: TYPE_NORMAL
- en: To execute the python script, the following can be added to the batch script
    -
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The above is assuming that the python script resides at C:\Users\Myscripts\Automation
    and has a name of ‘Script_Name.py’.
  prefs: []
  type: TYPE_NORMAL
- en: Putting it all together, the batch script would look like the below -
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: You can use any text editor (e.g. Notepad or Notepad++) to create this file.
    Save it with a .bat extension (e.g. ‘mybatchfile.bat’).
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 2 — Scheduling the Execution of the script in an automated fashion**'
  prefs: []
  type: TYPE_NORMAL
- en: Launch ‘Windows Task Scheduler’ from the Start Menu.
  prefs: []
  type: TYPE_NORMAL
- en: Click on ‘Create Task’ -
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4ab88c0f94933fdcb240fd6fb222c622.png)'
  prefs: []
  type: TYPE_IMG
- en: Give a name for the task that indicates the function of the script. Ensure that
    you select ‘Run whether the user is logged on or not’ in case you would like the
    script to run even if the user is not logged in. Also, select ‘Run with highest
    privileges to ensure that there are no permission/privilege issues affecting the
    script execution.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9adfa355ee69b507fbd0c452a963a6c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, click on the ‘Triggers’ tab and click on ‘New’.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9fcaea9e66c786445d4bc2912112a0f8.png)'
  prefs: []
  type: TYPE_IMG
- en: Select the frequency of the schedule and/or any random delay that you wish to
    add.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8862cc5c5e9d993bd2a846dec3e29f59.png)'
  prefs: []
  type: TYPE_IMG
- en: Next, go to the ‘Actions’ tab and click on ‘New’.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f725e88c7b3758dd9943c9b174c97e5a.png)'
  prefs: []
  type: TYPE_IMG
- en: Select the Action ‘Start a program’. Then, provide the location of the batch
    file that you created (in Step 1) in the ‘Program/script’ text box. Click on ‘OK’.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8f688f2978dcc1c6b475c76da13b4c86.png)'
  prefs: []
  type: TYPE_IMG
- en: Do take a look at the ‘Conditions’ and the ‘Settings’ tabs if you would like
    to further control the automation runs.
  prefs: []
  type: TYPE_NORMAL
- en: Concluding Remarks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You might wonder why we cannot use Task Scheduler directly to run the Python
    script. Since we have all our package dependencies installed using Anaconda, why
    not just use that rather than installing all packages again to run the script
    via Task Scheduler? This is why we use the batch script to activate the Anaconda
    environment and then run the Python script there. Happy Learning!
  prefs: []
  type: TYPE_NORMAL

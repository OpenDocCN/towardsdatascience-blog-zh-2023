# 识别城市区域的热点

> 原文：[https://towardsdatascience.com/identifying-topical-hot-spots-in-urban-areas-3c47cde5ae10](https://towardsdatascience.com/identifying-topical-hot-spots-in-urban-areas-3c47cde5ae10)

![](../Images/76d9a53bc4caa856f34174d3080e2287.png)

布达佩斯的时髦热点。

## 一个通用框架，使用OpenStreetMap和DBSCAN空间聚类来捕捉最受热捧的城市区域

[](https://medium.com/@janosovm?source=post_page-----3c47cde5ae10--------------------------------)[![米兰·亚诺索夫](../Images/77b62460041f66ec4585a81baef81a03.png)](https://medium.com/@janosovm?source=post_page-----3c47cde5ae10--------------------------------)[](https://towardsdatascience.com/?source=post_page-----3c47cde5ae10--------------------------------)[![数据科学前沿](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----3c47cde5ae10--------------------------------) [米兰·亚诺索夫](https://medium.com/@janosovm?source=post_page-----3c47cde5ae10--------------------------------)

·发表于[数据科学前沿](https://towardsdatascience.com/?source=post_page-----3c47cde5ae10--------------------------------) ·9分钟阅读·2023年10月16日

--

在这篇文章中，我展示了一种快速且易于使用的方法，能够基于从[OpenStreeetMap](https://help.openstreetmap.org/questions/64731/place-type-categories)（[OSM](https://help.openstreetmap.org/questions/64731/place-type-categories)）收集的兴趣点（POI）来识别特定兴趣的热点，使用了sklearn的[DBSCAN](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html)算法。首先，我将收集一些我在ChatGPT上找到的属于几个类别的POI的原始数据，并假设这些数据具有所谓的时髦生活方式的特征（例如，咖啡馆、酒吧、市场、瑜伽馆）；将这些数据转换为便捷的GeoDataFrame后，我进行地理空间聚类，最后，根据不同城市功能在每个聚类中的混合程度来评估结果。

尽管我所称之为“时髦”的主题和与之相关的POI类别在某种程度上是随意的，但它们可以很容易地被其他主题和类别替代——自动热点检测方法保持不变。这种易于采用的方法的优势包括从识别支持创新规划的本地[创新中心](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=5_ep83MAAAAJ&citation_for_view=5_ep83MAAAAJ%3AWF5omc3nYNoC)到检测支持城市规划倡议的城市次中心、评估企业的不同市场机会、分析房地产投资机会或捕捉旅游热点。

*所有图像均由作者创建。*

# 1\. 从 OSM 获取数据

首先，我获取目标城市的行政多边形。由于布达佩斯是我的家乡，为了方便（现场）验证，我使用了它。然而，由于我仅使用了[OSM](https://www.openstreetmap.org/copyright)的全球数据库，这些步骤可以很容易地应用于OSM覆盖的世界其他任何地方。特别是，我使用OSMNx包以非常简单的方式获取行政边界。

[PRE0]

这个代码块的结果：

![](../Images/5ea27afb37eba9ffa020c9dbac1156d0.png)

布达佩斯的行政边界。

现在，使用OverPass API下载在布达佩斯行政边界的边界框内的POI。在amenity_mapping列表中，我编制了一个与嬉皮士生活方式相关的POI类别列表。我还必须在此说明，这是一种模糊的、非专业的分类方法，使用这里介绍的方法，任何人都可以相应地更新类别列表。此外，还可以结合其他包含更精细多层次分类的POI数据源，以便更准确地描述给定主题。换句话说，这个列表可以根据你的需要进行任何方式的修改——从更好地覆盖嬉皮士相关内容到将这个练习重新调整到任何其他主题分类（例如，食品广场、购物区、旅游热点等）。

注意：由于[OverPass](https://wiki.openstreetmap.org/wiki/Overpass_API)下载器返回的是边界框内的所有结果，在这个代码块的末尾，我使用GeoPandas的叠加功能过滤掉那些在行政边界之外的POI。

[PRE1]

这个代码块的结果是每个下载的POI类别的频率分布：

![](../Images/279062c78c8eb9d46c53c79953bacf3b.png)

每个下载的POI类别的频率分布。

# 2\. 可视化POI数据

现在，可视化所有2101个POI：

[PRE2]

这个代码单元的结果：

![](../Images/08cfed1dd592d8f4779b7db5efdad9e0.png)

布达佩斯所有下载的POI按其类别标记。

这个图表相当难以解释——除了市中心非常拥挤之外，所以我们使用一个交互式可视化工具，[Folium](https://python-visualization.github.io/folium/latest/)。

[PRE3]

该地图的默认视图（你可以通过调整zoom_start=12参数轻松更改）：

![](../Images/fb0d32088a2e35d86d2ca9d99ba0daf9.png)

布达佩斯所有下载的POI按其类别标记——交互版本，第一次缩放设置。

然后，可以更改缩放参数并重新绘制地图，或使用鼠标简单地放大：

![](../Images/1caf04520f02ba12216267a719bc9f52.png)

布达佩斯所有下载的POI按其类别标记——交互版本，第二次缩放设置。

或者完全缩小：

![](../Images/e24905932348dca4c56bd7ce3782f963.png)

布达佩斯所有下载的POI按其类别标记——交互版本，第三次缩放设置。

# 3\. 空间聚类

现在我已经手头有了所有必要的 POI，我使用 DBSCAN 算法，首先编写一个函数来处理 POI 并进行簇分析。我只会微调 [DBSCAN](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html) 的 *eps* 参数，它本质上量化了簇的特征大小，即要分组在一起的 POI 之间的距离。此外，我将几何图形转换为本地 CRS（EPSG:23700）以使用国际单位制。更多关于 CRS 转换的信息 [在这里](https://medium.com/@janosovm/the-world-map-with-many-faces-map-projections-f58a210ff2f7)。

[PRE4]

该单元格的结果：

![](../Images/867884af64d3c5e2ddea54a14c885c2e.png)

在 POI GeoDataFrame 中预览，每个 POI 按其簇 ID 标记。

总共有 1237 个簇——如果我们只是看舒适的 hipster 热点，这似乎有点太多了。让我们查看它们的大小分布，然后选择一个大小阈值——将一个只有两个 POI 的簇称为热点可能不太靠谱。

[PRE5]

该单元格的结果：

![](../Images/a9078ece6822d23013faeb74208bbcab.png)

簇大小分布。

根据直方图中的差距，让我们保留至少有 10 个兴趣点（POI）的簇！目前，这是一个足够简单的工作假设。然而，这也可以通过更复杂的方式来处理，例如，通过考虑不同类型的 POI 或覆盖的地理区域。

[PRE6]

这个片段显示有 15 个簇满足过滤条件。

一旦我们有了 15 个真实的 hipster 簇，将它们放在地图上：

[PRE7]

![](../Images/c9a26ba3cd2d7d99d33672ef83d4986f.png)

Hipster POI 簇 — 第一级缩放。

![](../Images/02603dd889752b75678b56839b385bb8.png)

Hipster POI 簇 — 第二级缩放。

![](../Images/f541367574cdae487ea894a71008656f.png)

Hipster POI 簇 — 第三级缩放。

# 4\. 比较簇

每个簇都算作一个别致的 hipster 簇——然而，它们都必须以某种方式独特，对吧？让我们通过比较它们所提供的 POI 类别组合来看看它们有多独特。

首先，追求多样性，并通过计算每个簇中 POI 类别的熵来衡量它们的多样性/变化性。

[PRE8]

该单元格的结果：

![](../Images/f814840d74c75523797b50804f148ecc.png)

每个簇基于其 POI 配置文件的多样性（熵）。

以及对该表的快速相关性分析：

[PRE9]

![](../Images/bb152c9e9b3dfa05a35ba1d3b7380ddc.png)

簇特征之间的相关性。

在计算聚类ID、聚类大小和聚类熵之间的相关性后，发现大小和熵之间有显著的相关性；然而，这远未解释所有的多样性。显然，确实有些热点比其他热点更具多样性——而其他热点则相对更专业。它们专注于什么？我将通过比较每个聚类的POI档案与每个POI类型在聚类中的总体分布，并挑选出与平均水平相比最典型的三个POI类别来回答这个问题。

[PRE10]

该代码块的结果：

![](../Images/3a606acd8d683c239559f4383ece1a29.png)

每个聚类的独特设施指纹。

顶级类别描述已经显示出一些趋势。例如，聚类17显然是用于饮酒的，而19也混合了音乐，可能还有派对。聚类91包含书店、画廊和咖啡馆，显然是白天放松的地方，而聚类120，则有音乐和画廊，可以是任何酒吧巡游的绝佳热身。从分布中，我们也可以看到，跳进酒吧总是合适的（或者，根据使用情况，我们应该根据类别频率考虑进一步的规范化）！

# 结论

作为本地居民，我可以确认这些聚类非常合理，并且尽管方法简单，但很好地代表了期望的城市功能组合。当然，这只是一个快速的试点，可以通过多种方式进行丰富和改进，例如：

+   依赖于更详细的POI分类和选择

+   在进行聚类时考虑POI类别（语义聚类）

+   通过社交媒体评论和评分等方式丰富POI信息

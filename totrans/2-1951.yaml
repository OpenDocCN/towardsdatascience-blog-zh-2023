- en: 'SynthDiD 101: A Beginner’s Guide to Synthetic Difference-in-Differences'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/synthdid-101-a-beginners-guide-to-synthetic-difference-in-differences-84fed9b730ae](https://towardsdatascience.com/synthdid-101-a-beginners-guide-to-synthetic-difference-in-differences-84fed9b730ae)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: On the method’s advantages and disadvantages, demonstrated with the synthdid
    package in R
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@nalagoz13?source=post_page-----84fed9b730ae--------------------------------)[![Nazlı
    Alagöz](../Images/7275df914f7e3e492861ffe20df10b8f.png)](https://medium.com/@nalagoz13?source=post_page-----84fed9b730ae--------------------------------)[](https://towardsdatascience.com/?source=post_page-----84fed9b730ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----84fed9b730ae--------------------------------)
    [Nazlı Alagöz](https://medium.com/@nalagoz13?source=post_page-----84fed9b730ae--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----84fed9b730ae--------------------------------)
    ·8 min read·Apr 26, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/65c032916a89960487dbf785de9e47b3.png)'
  prefs: []
  type: TYPE_IMG
- en: Title image generated by author using [Nightcafe](https://creator.nightcafe.studio/)
  prefs: []
  type: TYPE_NORMAL
- en: In this blog post, I give a quick introduction to the Synthetic Difference-in-Differences
    (SynthDiD) method and discuss its relation to the traditional Difference-in-Differences
    (DiD) and Synthetic Control Method (SCM). SynthDiD is a generalized version of
    SCM and DiD that combines the strengths of both methods. It enables causal inference
    with large panels, even with a short pretreatment period. I discuss advantages
    and disadvantages of this method while demonstrating the approach using the [synthdi](https://synth-inference.github.io/synthdid/index.html)d
    package in R. I provide bullet points for a quick introduction.
  prefs: []
  type: TYPE_NORMAL
- en: Synthetic Control Method vs. Synthetic Difference-in-Differences
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The synthetic control method and the synthetic difference-in-differences method
    are closely related, but differ in how they estimate causal effects. Thesynthetic
    control method is a statistical technique that creates a "synthetic" control group
    by combining multiple control units that are similar to the treatment unit in
    all relevant characteristics. The synthetic control group is constructed to match
    the pre-treatment outcomes of the treated unit as closely as possible. The treatment
    effect is then estimated by comparing the post-treatment outcomes of the treated
    unit to those of the synthetic control group.
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, synthetic DiD combines the synthetic control method with
    the difference-in-differences approach [1]. In this method, a synthetic control
    group is constructed using the same approach as in the synthetic control method.
    However, the treatment effect is estimated by comparing the change in outcomes
    between the treated unit and the synthetic control group before and after the
    treatment is introduced. This approach allows for a more robust estimation of
    the treatment effect by accounting for pre-existing differences between the treatment
    and control groups.
  prefs: []
  type: TYPE_NORMAL
- en: In summary, while both methods use a synthetic control group, the synthetic
    control method estimates treatment effects by comparing the post-treatment outcomes
    of the treated unit to those of the synthetic control group, while synthetic DiD
    estimates treatment effects by comparing the change in outcomes between the treated
    unit and the synthetic control group before and after the treatment is introduced.
  prefs: []
  type: TYPE_NORMAL
- en: 'Synthetic DiD in bulletpoints:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: SynthDiD is a generalized version of SCM and DiD.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It borrows strengths from the DiD method as well as the synthetic control method
    [2][3].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It constructs a counterfactual for the treated group by optimally weighting
    the control group units to minimize the difference between the treated and control
    groups in the pretreatment period as in SCM.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Then, the treatment effect is estimated by comparing the outcome changes in
    the treated unit and synthetic control group pre- and post-intervention as in
    DiD.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SynthDiD accounts for unit-level changes in outcome as in DiD [4].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It facilitates inference in extensive panels, even when the pretreatment phase
    is brief, which sets it apart from the synthetic control method (SCM necessitates
    a lengthy pretreatment period).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Same as in SCM, the units become the “variables” and we represent the outcome
    as a weighted average of the units (i.e., synthetic control).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Suppose that we are a company that sells plant-based food products, such as
    soy milk or soy yogurt, and we operate in multiple countries. Some countries implement
    new legislation that prohibits us from marketing our plant-based products as ‘milk’
    or ‘yogurt’ because it is claimed that only animal products can be marketed as
    ‘milk’ or ‘yogurt’ (thanks to one of my former students for the inspiration for
    this example :). Thus, due to this new regulation in some countries, we have to
    market soy milk as soy drink instead of soy milk, etc. We want to know the impact
    of this legislation on our revenue as this might help guide our lobbying efforts
    and marketing activities in different countries.
  prefs: []
  type: TYPE_NORMAL
- en: I simulated a balanced panel dataset that shows the revenue of our company in
    30 different countries for 30 periods. Three of the countries implement this legislation
    in period 20\. In the figure below, you can see a snapshot of the data. `treat`
    is a dummy variable indicating whether a country has implemented the legislation
    in a given period. `revenue`is the revenue in millions of EUR. You can find the
    simulation and estimation code in [this Gist](https://gist.github.com/nazlialagoz/f061e10e156581e15661b87157803f44).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/8373d266a5728912c81600d646729ff8.png)'
  prefs: []
  type: TYPE_IMG
- en: Snapshot of the data, image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we convert our panel data into a matrix required by the `synthdid` package.
    Given the outcome, treatment and control units and pretreatment periods, a synthetic
    control is created and treatment effect is estimated with `synthdid_estimate`
    function. To make inference, we also need to calculate the standard errors. I
    use `jacknife` method as I have more than one treated units. `placebo` method
    is the only option if you have one treatment unit. Given the standard errors,
    I also calculate the 95% confidence interval for the treatment effect. I will
    report these in the figure below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Let’s also plot the results with some additional info on the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: In the image below, the estimation results are displayed. Observe how the treated
    countries and the synthetic control exhibit fairly parallel trends on average
    (it might not look like a perfect parallel trends but that is not necessary for
    the sake of this example). The average for treated countries is more variable,
    primarily due to the presence of only three such countries, resulting in less
    smooth trends. Transparent gray lines represent different control countries. Following
    the treatment in period 20, a decline in revenue is observed in the treated countries,
    estimated to be 0.51 million EUR as indicated in the graph. This means that the
    new regulation has a negative impact on our company’s revenues and necessary actions
    should be taken to prevent further declines.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2caa5a8c683c8f21d827788416bd282c.png)'
  prefs: []
  type: TYPE_IMG
- en: Results, image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s plot the weights use to estimate the synthetic control.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: In the image below, you can observe how each country is weighted to construct
    the synthetic control. The treatment effects differ based on the untreated country
    selected as the control unit.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5e196d146be82baf4dd94b80346392ba.png)'
  prefs: []
  type: TYPE_IMG
- en: Country weights, image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we understand more about SynthDiD let’s talk about pros and cons of
    this method. There are some advantages and disadvantages to SynthDiD like every
    method. Here are some pros and cons to keep in mind when getting started with
    this method.
  prefs: []
  type: TYPE_NORMAL
- en: 'Advantages of SynthDiD method:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The synthetic control method is usually used for a few treated and control units
    and needs long, balanced data before treatment. SynthDiD, on the other hand, works
    well even with a short data period before treatment, unlike the synthetic control
    method [4].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This method is being preferred especially because it doesn’t have a strict parallel
    trends assumption (PTA) requirement like DiD.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SynthDiD guarantees a suitable quantity of control units, considers possible
    pre-intervention patterns, and may accommodate a degree of endogenous treatment
    timing [4].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Disadvantages of SynthDiD method:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Can be computationally expensive (even with only one treated group/block).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Requires a balanced panel (i.e., you can only use units observed for all time
    periods) and that the treatment timing is identical for all treated units.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Requires enough pre-treatment periods for good estimation, so, if you don’t
    have enough pre-treatment period might be better to use just the regular DiD.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Computing and comparing the average treatment effects for subgroups is tricky.
    One option is to split the sample into subgroups and compute the average treatment
    effects for each subgroup.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementing SynthDiD where the treatment timing varies might be tricky. In
    the case of staggered treatment timing, as one solution, one can estimate the
    average treatment effect for each treatment cohort and then aggregate cohort-specific
    average treatment effects to an overall average treatment effects.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here are also some other points that you might want to know when getting started.
  prefs: []
  type: TYPE_NORMAL
- en: 'Things to note:'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: SynthDiD employs regularized ridge regression (L2) while ensuring that the resulting
    weights have a sum of one.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the process of pretreatment matching, SynthDiD tries to determine the average
    treatment effect across the entire sample. This approach might cause individual
    time period estimates to be less precise. Nonetheless, the overall average yields
    an unbiased evaluation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The standard errors for the treatment effects are estimated with jacknife or
    if a cohort has only one treated unit with placebo method.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The estimator is considered consistent and asymptotically normal, given that
    the combination of the number of control units and pretreatment periods is sufficiently
    large relative to the combination of the number of treated units and posttreatment
    periods.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In practice, pre-treatment variables play a minor role in Synthetic DiD, as
    lagged outcomes hold more predictive power, making the treatment of these variables
    less critical.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this blog post, I introduce the SynthDiD method and discuss its relationship
    with traditional DiD and SCM. SynthDiD combines the strengths of both SCM and
    DiD, allowing for causal inference with large panels even when the pretreatment
    period is short. I demonstrate the method using the synthdid package in R. Although
    it has several advantages, such as not requiring a strict parallel trends assumption,
    it also has drawbacks, like being computationally expensive and requiring a balanced
    panel. Overall, SynthDiD is a valuable tool for researchers interested in estimating
    causal effects using observational data, providing an alternative to traditional
    DiD and SCM methods.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] D. Arkhangelsky, S. Athey, D.A. Hirshberg, G.W. Imbens, and S. Wager, [Synthetic
    Difference in Differences](https://www-aeaweb-org.tilburguniversity.idm.oclc.org/articles?id=10.1257%2Faer.20190159)
    (2021), *American Economic Review.*'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] A. Abadie, A. Diamond, J. Hainmueller, [Synthetic Control Methods for Comparative
    Case Studies: Estimating the Effect of California’s Tobacco Control Program](https://www.tandfonline.com/doi/abs/10.1198/jasa.2009.ap08746)
    (2010), *Journal of the American Statistical Association*.'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] A. Abadie, [Using Synthetic Controls: Feasibility, Data Requirements, and
    Methodological Aspects](https://www.aeaweb.org/articles?id=10.1257%2Fjel.20191450)
    (2021), *Journal of Economic Perspectives*.'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] Berman, R., & Israeli, A., [The value of descriptive analytics: Evidence
    from online retailers](https://pubsonline.informs.org/doi/abs/10.1287/mksc.2022.1352?casa_token=cpJvJ14f3W8AAAAA%3AQGoH8r1D3_MYDjZDApVXh2wmlQJnreZaVpA6TNuJpCWbssV_Kxqll3nX4JolW_nsJ5fyMtU0Fd8v)
    (2022), *Marketing Science.*'
  prefs: []
  type: TYPE_NORMAL
- en: Helpful Links
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[Causal inference for brave and true, synthetic difference-in-differences.](https://matheusfacure.github.io/python-causality-handbook/25-Synthetic-Diff-in-Diff.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Matteo Courthhoud, Understanding Synthetic Control Methods.](https://matteocourthoud.github.io/post/synth/)'
  prefs: []
  type: TYPE_NORMAL
- en: Thank you for reading!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*If you liked the post and would like to see more of my articles consider*
    [*following me*](https://medium.com/@nalagoz13)*.*'
  prefs: []
  type: TYPE_NORMAL
- en: '***Disclaimer****: I write to learn so it might be that you spot an error in
    the article or code. If you do so, please let me know.*'
  prefs: []
  type: TYPE_NORMAL

- en: Visualize Data Ranges with Matplotlib
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/visualize-data-ranges-with-matplotlib-df815363a619](https://towardsdatascience.com/visualize-data-ranges-with-matplotlib-df815363a619)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Benchmarking NOAA’s Hurricane Outlooks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@lee_vaughan?source=post_page-----df815363a619--------------------------------)[![Lee
    Vaughan](../Images/9f6b90bb76102f438ab0b9a4a62ffa3f.png)](https://medium.com/@lee_vaughan?source=post_page-----df815363a619--------------------------------)[](https://towardsdatascience.com/?source=post_page-----df815363a619--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----df815363a619--------------------------------)
    [Lee Vaughan](https://medium.com/@lee_vaughan?source=post_page-----df815363a619--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----df815363a619--------------------------------)
    ·10 min read·Sep 26, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/60a1588871d13a5194b7b0c3e648a15e.png)'
  prefs: []
  type: TYPE_IMG
- en: Hurricane from Space by Leonardo AI DreamShaper_v7 model
  prefs: []
  type: TYPE_NORMAL
- en: Plotting *discrete* data is straightforward; representing *ranges* of data is
    more involved. Fortunately, Python’s matplotlib library has a built-in function,
    `fill_between()`, that lets you easily visualize data ranges. In this *Quick Success
    Data Science* project, we'll use it to benchmark the National Oceanic and Atmospheric
    Administration’s annual hurricane outlook.
  prefs: []
  type: TYPE_NORMAL
- en: The Dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Every May, NOAA releases its “Atlantic Hurricane Outlook” report for the June-November
    hurricane season. These outlooks include predicted ranges for named storms, hurricanes,
    and major hurricanes (defined as Category 3 and higher). You can find an example
    report for 2021 [here](https://www.cpc.ncep.noaa.gov/products/outlooks/hurricane2021/May/hurricane.shtml)
    [1]. NOAA/National Weather Service data is provided by the US government as [open
    data](https://psl.noaa.gov/disclaimer/), free to use for any purpose.
  prefs: []
  type: TYPE_NORMAL
- en: In order to benchmark the accuracy of these forecasts, we’ll use the annual
    hurricane season summaries provided by Wikipedia. These summaries provide the
    *actual* number of storms and hurricanes for each year. You can find the 2021
    season entry [here](https://en.wikipedia.org/wiki/2021_Atlantic_hurricane_season)
    [2]. Wikipedia pages are provided under a [*CC BY-SA 4.0*](https://creativecommons.org/licenses/by-sa/4.0/)
    license.
  prefs: []
  type: TYPE_NORMAL
- en: Wikipedia also includes lists for [*La Niña*](https://en.wikipedia.org/wiki/La_Ni%C3%B1a)
    and [*El Niño*](https://en.wikipedia.org/wiki/El_Ni%C3%B1o)events [3][4]. These
    represent weather patterns that occur in the Pacific Ocean every few years. During
    La Niña years, the water in the eastern Pacific is colder than normal, cooling
    the air above it. The opposite occurs in El Niño years.
  prefs: []
  type: TYPE_NORMAL
- en: The La Niña pattern favors stronger hurricane activity in the Atlantic basin
    while El Niño [suppresses hurricane development](https://www.climate.gov/news-features/blogs/enso/impacts-el-ni%C3%B1o-and-la-ni%C3%B1a-hurricane-season)
    [5]. To check this, we’ll also color-code our plot for these events.
  prefs: []
  type: TYPE_NORMAL
- en: For convenience, I’ve already compiled all this information for the years 2001–2022
    and stored it as a CSV file in this [Gist](https://gist.github.com/rlvaugh/54cb45ad5ffe54f4383dd4515e20b526).
  prefs: []
  type: TYPE_NORMAL
- en: NOAA issues an *updated* hurricane forecast every *August*, so you need to take
    care when selecting data and referencing predictions. We’ll be using the *May*
    outlooks.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Installing Libraries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We’ll use pandas for data handling and matplotlib for plotting. Install them
    with either:'
  prefs: []
  type: TYPE_NORMAL
- en: '`conda install matplotlib pandas`'
  prefs: []
  type: TYPE_NORMAL
- en: or
  prefs: []
  type: TYPE_NORMAL
- en: '`pip install matplotlib pandas`'
  prefs: []
  type: TYPE_NORMAL
- en: The Code
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The following code was written in JupyterLab and is described by cell.
  prefs: []
  type: TYPE_NORMAL
- en: Importing Modules
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Besides performing data analysis and plotting, we’re going to make a custom
    marker to represent a hurricane. To do this, we’ll need to import NumPy, Python’s
    numerical analysis package, and a matplotlib module known as `mpath`used for working
    with polylines.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Loading the Dataset
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The CSV file contains low and high values for both predicted hurricanes (H)
    and major hurricanes (MH). It also includes the actual number of hurricanes and
    major hurricanes, and whether or not the season fell in a La Niña or El Niño event.
    A transitional year is labeled as a “Weak Event.”
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/b0d8a734a8061233d5897bac77d2be35.png)'
  prefs: []
  type: TYPE_IMG
- en: Defining a Function to Draw a Hurricane Marker
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: While we *could* use a simple circle to post the actual number of hurricanes
    on our scatter plot, wouldn’t a classic hurricane icon look so much better?
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, matplotlib doesn’t come with a hurricane marker. However, code
    to draw a hurricane marker was provided in a Stack Overflow answer which I’ve
    reproduced below (Stack Overflow content is [*cc-wiki*](https://creativecommons.org/licenses/by-sa/3.0/)
    licensed) [6].
  prefs: []
  type: TYPE_NORMAL
- en: This function uses matplotlib’s `mpath` module, which returns a `[<class 'matplotlib.path.Path'>](https://matplotlib.org/stable/api/path_api.html)`
    object representing a series of line and curve segments. How this code works isn't
    important for this project, but if you want to see a detailed explanation, visit
    the Stack Overflow link at the start of the snippet.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Plotting Actual Hurricanes vs. Predicted Hurricanes
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The code below uses the matplotlib `[fill_between()](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.fill_between.html)`
    method to capture NOAA's predicted number of hurricanes for each year. It requires
    the DataFrame column name for the `x` argument, a minimum value for `y1`, and
    a maximum value for `y2`. Adding a `label` argument ensures that the range shading
    will be referenced in the legend.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/8619499067380b129ac9ee4766a2ab8d.png)'
  prefs: []
  type: TYPE_IMG
- en: The range plot (by author)
  prefs: []
  type: TYPE_NORMAL
- en: This simple yet elegant plot is filled with useful information. For instance,
    over the last 22 years, the actual number of hurricanes has landed within the
    predicted ranges *11 times*. This is the same accuracy as flipping a coin. Lately,
    NOAA has started using wider ranges which increases accuracy but decreases precision.
  prefs: []
  type: TYPE_NORMAL
- en: Changing the Fill Style
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I really like the previous fill style for the predicted range, but there *are*
    alternatives. In this example, we pass a `step` argument to the `fill_between()`
    method. Now, instead of a continuous polygon, we get discrete vertical bars.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/525395ada9c8fe328af93b5d50a2c329.png)'
  prefs: []
  type: TYPE_IMG
- en: The range plot using the “step” argument (by author)
  prefs: []
  type: TYPE_NORMAL
- en: Adding El Niño and La Niña Events
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To evaluate the impact of El Niño and La Niña events on the number and intensity
    of hurricanes, let’s make use of the “Event” column of the DataFrame.
  prefs: []
  type: TYPE_NORMAL
- en: First, we need to make a dictionary that maps the event to a color. Since La
    Niña represents a cooling event, we’ll use blue. El Niño warming events will be
    red, and weak events will be nondescript grey.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll add a separate custom legend for the events just beneath the figure title.
    Note the use of `$\u25CF$` to draw circles. This is a symbol from the handy [STIX
    font collection](http://mirrors.ibiblio.org/CTAN/fonts/stix/doc/stix.pdf).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/4bab1ad3f20e4ce4d5e7b6f601e9303d.png)'
  prefs: []
  type: TYPE_IMG
- en: Range plot with markers colored by weather event (by author)
  prefs: []
  type: TYPE_NORMAL
- en: These results appear to support the theory that El Niño events suppress hurricane
    formation in the Atlantic, at least versus La Niña events. To see if they also
    impact hurricane *intensity*, let’s plot the major hurricane data.
  prefs: []
  type: TYPE_NORMAL
- en: Plotting Major Hurricanes
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Major hurricanes are defined as those rated Category 3 or higher. The following
    code updates the plot for these values.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/3d0bb9463f7ea6c1cdfe5fb1dee1d852.png)'
  prefs: []
  type: TYPE_IMG
- en: Range plot with major hurricanes color-coded by weather event (by author)
  prefs: []
  type: TYPE_NORMAL
- en: With the exception of 2004, which some sources classify as a [weak event](https://ggweather.com/enso/oni.htm),
    this chart supports the idea that hurricane formation is suppressed during El
    Niño events [7]. Forecast accuracy is also slightly better for major hurricanes,
    with 13 of 22 falling within the predicted range.
  prefs: []
  type: TYPE_NORMAL
- en: Drawing Ranges Using Vertical Lines
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Another way to plot ranges is to use matplotlib’s `vlines()` method to draw
    vertical lines. This is an attractive alternative to the `fill_between()` method,
    though it's more labor-intensive and doesn't automatically include the range in
    the legend.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e820bb901e653c141f0afaed8ba096c3.png)'
  prefs: []
  type: TYPE_IMG
- en: Range plot with ranges expressed as vertical lines (by author)
  prefs: []
  type: TYPE_NORMAL
- en: Evaluating the Atlantic Multidecadal Oscillation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We’ve now covered the `fill_between()` method, but since we’ve got all this
    data at hand, let’s take a moment to examine an interesting theory on hurricane
    formation involving the *Atlantic Multidecadal Oscillation (AMO) [8].*
  prefs: []
  type: TYPE_NORMAL
- en: The AMO is a feature defined by decades-long variability in North Atlantic Sea
    surface temperatures. Little is known about the AMO; it may represent a persistent
    periodic climate driver or just a transient feature [9].
  prefs: []
  type: TYPE_NORMAL
- en: The *AMO index* is calculated by subtracting the *global* mean sea surface temperature
    (SST) anomalies from the *North Atlantic* SST anomalies [9]. When the AMO index
    is high, sea surface temperatures are warmer than usual, potentially contributing
    to increased hurricane activity and intensity.
  prefs: []
  type: TYPE_NORMAL
- en: Because this is a long-wavelength phenomenon, we’ll need a database that counts
    hurricanes back to 1920 or so. I’ve already recorded Wikipedia’s hurricane list
    for this timeframe and stored it at this [Gist](https://gist.github.com/rlvaugh/c26313470c49ec67acf23628339151f7).
  prefs: []
  type: TYPE_NORMAL
- en: It should be noted that storm counts before the use of airplanes (in the mid-1940s)
    and satellite data (in the mid-1960s) are less reliable. For example, count estimates
    between 1886 and 1910 are believed to have an undercount bias of zero to four
    storms per year [10].
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In the following plot, the AMO index boundaries are taken from [Wikipedia](https://en.wikipedia.org/wiki/Atlantic_multidecadal_oscillation)
    and [NOAA](https://www.aoml.noaa.gov/ocd/ocdweb/ESR_GOMIEA/amo.html#:~:text=The%20Atlantic%20Multidecadal%20Oscillation%20%28AMO%29%20is%20a%20climate,%28Enfield%20et%20al.%2C%202001%3B%20McCabe%20et%20al.%2C%202004%29.)
    [8][11].
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/0e7169a68ade12c0e4fa4f1b727d1142.png)'
  prefs: []
  type: TYPE_IMG
- en: Major hurricanes per year including regression line and AMO index high periods
    (by author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s the same data presented as a bar chart:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1e3be1b25826ac8c1b243a22658d8deb.png)'
  prefs: []
  type: TYPE_IMG
- en: Bar chart of major hurricanes with AMO index high periods (by author)
  prefs: []
  type: TYPE_NORMAL
- en: And here’s the scatterplot for *all* Atlantic hurricanes over this time period.
    The AMO effect is less obvious for the frequency of storms.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8596d93dc945c1cbc5044f31f5a0fca8.png)'
  prefs: []
  type: TYPE_IMG
- en: Total hurricanes per year including regression line and AMO index high periods
    (by author)
  prefs: []
  type: TYPE_NORMAL
- en: Although scientists recognize the apparent relationship between the AMO index
    and the number of major hurricanes, there’s not enough data at present to draw
    firm conclusions. As you might expect, the most popular explanation for the increase
    in major hurricanes in the most recent AMO high is anthropogenic climate change.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The matplotlib `fill_between()` method is a handy way to display a *range* of
    values on a plot. In this project, we used it to show NOAA’s annual hurricane
    forecasts versus the actual outcomes. In addition, we used matplotlib’s `mpath`
    module to draw a custom marker to represent hurricanes. The result was an attractive
    and easy-to-parse infographic.
  prefs: []
  type: TYPE_NORMAL
- en: We also added El Niño, La Niña, and AMO events to our plots. The results supported
    established observations that El Niño seems to suppress Atlantic hurricanes, and
    high AMO index events seem to promote them.
  prefs: []
  type: TYPE_NORMAL
- en: Citations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Climate Prediction Center Internet Team, 2001, “NOAA 2021 Atlantic Hurricane
    Season Outlook,” [Climate Prediction Center — Atlantic Hurricane Outlook (noaa.gov)](https://www.cpc.ncep.noaa.gov/products/outlooks/hurricane2021/May/hurricane.shtml)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wikipedia contributors, “2021 Atlantic hurricane season,” *Wikipedia, The Free
    Encyclopedia,* [https://en.wikipedia.org/w/index.php?title=2021_Atlantic_hurricane_season&oldid=1175731221](https://en.wikipedia.org/w/index.php?title=2021_Atlantic_hurricane_season&oldid=1175731221)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wikipedia contributors, “El Niño,” *Wikipedia, The Free Encyclopedia,* [https://en.wikipedia.org/w/index.php?title=El_Ni%C3%B1o&oldid=1174548902](https://en.wikipedia.org/w/index.php?title=El_Ni%C3%B1o&oldid=1174548902)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wikipedia contributors, “La Niña,” *Wikipedia, The Free Encyclopedia,* [https://en.wikipedia.org/w/index.php?title=La_Ni%C3%B1a&oldid=1174382856](https://en.wikipedia.org/w/index.php?title=La_Ni%C3%B1a&oldid=1174382856)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Bell, Gerry, 2014, “Impacts of El Niño and La Niña on the hurricane season,”
    *NOAA Climate.gov*, [Impacts of El Niño and La Niña on the hurricane season |
    NOAA Climate.gov](https://www.climate.gov/news-features/blogs/enso/impacts-el-ni%C3%B1o-and-la-ni%C3%B1a-hurricane-season).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ImportanceOfBeingErnest, “Custom Markers using matplotlib,” *Stack Overflow,*
    June 24, 2017, [Custom markers using Python (matplotlib) — Stack Overflow](https://stackoverflow.com/questions/44726675/custom-markers-using-python-matplotlib)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Null, Jan, 2023, “El Niño and La Niña Years and Intensities,” *Golden Gate Weather
    Services*, [El Niño and La Niña Years and Intensities (ggweather.com)](https://ggweather.com/enso/oni.htm)
    (accessed September, 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wikipedia contributors, “Atlantic multidecadal oscillation,” *Wikipedia, The
    Free Encyclopedia,* [https://en.wikipedia.org/w/index.php?title=Atlantic_multidecadal_oscillation&oldid=1175329341](https://en.wikipedia.org/w/index.php?title=Atlantic_multidecadal_oscillation&oldid=1175329341)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Knudsen, M., Seidenkrantz, MS., Jacobsen, B. *et al.,* “Tracking the Atlantic
    Multidecadal Oscillation through the last 8,000 years,” *Nat Commun* **2**, 178
    (2011). [https://doi.org/10.1038/ncomms1186](https://doi.org/10.1038/ncomms1186).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wikipedia contributors, “List of Atlantic hurricane records,” *Wikipedia, The
    Free Encyclopedia,* [https://en.wikipedia.org/w/index.php?title=List_of_Atlantic_hurricane_records&oldid=1168214070](https://en.wikipedia.org/w/index.php?title=List_of_Atlantic_hurricane_records&oldid=1168214070)
    (accessed September 19, 2023).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: NOAA, 2017, “Atlantic Multidecadal Oscillation Low-Frequency Climate Mode,”
    *Atlantic Oceanographic and Meteorological Laboratory*, [Gulf of Mexico ESR (noaa.gov)](https://www.aoml.noaa.gov/ocd/ocdweb/ESR_GOMIEA/amo.html#:~:text=The%20Atlantic%20Multidecadal%20Oscillation%20%28AMO%29%20is%20a%20climate,%28Enfield%20et%20al.%2C%202001%3B%20McCabe%20et%20al.%2C%202004%29.).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Thanks!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thanks for reading. My goal is to help you hone your Python skills and have
    fun doing it. Follow me for more *Quick Success Data Science* projects in the
    future.
  prefs: []
  type: TYPE_NORMAL

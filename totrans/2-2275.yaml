- en: Using Plotly Express Sunburst Charts to Explore Geological Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/using-plotly-express-sunburst-charts-to-explore-geological-data-841f179d08c8](https://towardsdatascience.com/using-plotly-express-sunburst-charts-to-explore-geological-data-841f179d08c8)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: An Easy and Quick Way to Understand Your Geological Hierarchical Data with Python
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://andymcdonaldgeo.medium.com/?source=post_page-----841f179d08c8--------------------------------)[![Andy
    McDonald](../Images/df11d647be032aeb3d31852affb33a64.png)](https://andymcdonaldgeo.medium.com/?source=post_page-----841f179d08c8--------------------------------)[](https://towardsdatascience.com/?source=post_page-----841f179d08c8--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----841f179d08c8--------------------------------)
    [Andy McDonald](https://andymcdonaldgeo.medium.com/?source=post_page-----841f179d08c8--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----841f179d08c8--------------------------------)
    ·5 min read·Jul 27, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3a7f4d2495782d9227f74ea42e4cf4c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Geological hierarchy represented on an interactive Plotly Express Sunburst chart.
    Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Data visualisation plays a vital role in the geoscience and data science domains.
    It can allow us to gain deeper insights into the subsurface, understanding geological
    structures and hierarchical relationships. The subsurface is often subdivided
    into different categories ranging from the most extensive scope of geological
    time, such as Eras, Periods and Epochs, all the way down to lithological differences,
    such as sandstone, limestone and shale.
  prefs: []
  type: TYPE_NORMAL
- en: When working with geological hierarchical data, the data can be visualised in
    several ways. This includes conventional [geological timescale](https://en.wikipedia.org/wiki/Geologic_time_scale)
    charts and tables to interactive sunburst charts.
  prefs: []
  type: TYPE_NORMAL
- en: Sunburst charts can be used to present data in a unique way and are a great
    way to visualise hierarchical data such as geological hierarchical data. They
    do so by using multi-level concentric doughnut charts, which, depending on the
    tool used, can be fully interactive and help with drilling down from the highest
    to the lowest level.
  prefs: []
  type: TYPE_NORMAL
- en: To demonstrate these charts, we will use [Plotly Express](https://plotly.com/),
    a high-level data visualisation Python library, to take some data from a well
    on the Norwegian Continental Shelf and visualise the geological hierarchy, along
    with the lithological make-up of each formation. We will also see how to prepare
    the data from a well before creating the chart.
  prefs: []
  type: TYPE_NORMAL
- en: Importing Libraries and Loading Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To begin, we will need two libraries: [pandas](https://pandas.pydata.org/)
    for loading and manipulating our data and [plotly_express](https://plotly.com/python/plotly-express/)
    for creating our visualisation.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Next, we will load our data from a CSV file. Details of the data used can be
    found at the bottom of the article.
  prefs: []
  type: TYPE_NORMAL
- en: If you have a LAS file instead, you can quickly [load the LAS file](https://andymcdonaldgeo.medium.com/loading-and-displaying-well-log-data-b9568efd1d8)
    using the [LASIO](https://lasio.readthedocs.io/en/latest/) library and then convert
    the data to a [pandas](https://pandas.pydata.org/) dataframe.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Cleaning and Preparing the Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that we have the data loaded, we need to do a little cleaning.
  prefs: []
  type: TYPE_NORMAL
- en: First, we will drop any rows with missing information for the Formation column
    to simplify things. Be aware that doing this could skew the counts of lithologies
    and formations later on, and any missing data should be thoroughly checked and
    understood.
  prefs: []
  type: TYPE_NORMAL
- en: An alternative to dropping that data is to replace the missing data with a placeholder
    value, such as ‘unknown’.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: When we view the first five rows of the dataframe, we get the following.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/273b982b905da7259c39a0cb0775f0ec.png)'
  prefs: []
  type: TYPE_IMG
- en: First 5 rows of the data for 15/9–15 after dropping rows containing missing
    values. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: The next step is to structure the data hierarchically to plot it correctly on
    the sunburst plot.
  prefs: []
  type: TYPE_NORMAL
- en: To do this, we need to carry out the following
  prefs: []
  type: TYPE_NORMAL
- en: 'Group the data in the following order: Group, Formation, and Lith'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Count the occurrences for each unique combination of Group, Formation and Lith
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: When we view the header of the new `grouped_data` dataframe, we get the following
    overview of lithologies per geological formation, which is then associated with
    the Group.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a0a9927f284a2520c2618c850ee6b97b.png)'
  prefs: []
  type: TYPE_IMG
- en: Dataframe of the first five rows after grouping and counting lithologies per
    geological formation. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Creating the Sunburst Chart with Plotly Express
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that we have the data in the right format, we can finally create the Sunburst
    plot with Plotly Express.
  prefs: []
  type: TYPE_NORMAL
- en: All we have to do is call upon `px.sunburst` and pass in some parameters.
  prefs: []
  type: TYPE_NORMAL
- en: First, we pass in the grouped dataframe, and then for the `path` parameter,
    we specify the columns from that dataframe in the order we want the rings to be
    displayed. In our case, we will go from Group to Formation to Lithology.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we set the `values` parameter to the count column. This will allow us
    to control the slice size for each lithology. The greater the amount of that lithology,
    the wider the slice will be.
  prefs: []
  type: TYPE_NORMAL
- en: Then, we set the `width` and `height` of our figure, along with the `title`.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we want the colour of the lithologies to be distinct; however, we could
    equally set this to any other column in the dataframe or a custom colour scale.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: When we run the above code, we get the following figure, which provides an excellent
    overview of each geological group and formation and the distribution and contribution
    of the different lithologies.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3a7f4d2495782d9227f74ea42e4cf4c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Sunburst chart showing different geological groups, formations and lithologies
    associated with the formations. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: One of the great things about using [Plotly](https://plotly.com/) is that it
    is interactive by default. We do not need to add extra Python code to make the
    plots interactive like with matplotlib.
  prefs: []
  type: TYPE_NORMAL
- en: In the example below, we can drill down our data to specific formations and
    understand their lithological makeup.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e8c0aaebf37274e71bbb56cb065bef1d.png)'
  prefs: []
  type: TYPE_IMG
- en: Animated sunburst chart showing different geological groups, formations and
    lithologies associated with the formations. Image by the author.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sunburst charts created with Plotly are a great way to display geological information.
    They create an excellent visualisation and allow you to interactively drill down
    through the data to understand the composition of each layer within the geological
    hierarchy.
  prefs: []
  type: TYPE_NORMAL
- en: With some pre-processing, it is easy to take existing geological information
    from a well and convert it into a format suitable for plotting. Additionally,
    when working with interactive figures, you have a much better sense of your data
    compared to studying static figures. Plus, they are more fun to play around with.
  prefs: []
  type: TYPE_NORMAL
- en: Dataset Used Within this Tutorial
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Training dataset used as part of a Machine Learning competition run by Xeek
    and FORCE 2020 *(Bormann et al., 2020)*. This dataset is licensed under Creative
    Commons Attribution 4.0 International.
  prefs: []
  type: TYPE_NORMAL
- en: 'The full dataset can be accessed at the following link: [https://doi.org/10.5281/zenodo.4351155](https://doi.org/10.5281/zenodo.4351155).'
  prefs: []
  type: TYPE_NORMAL
- en: '*Thanks for reading. Before you go, you should definitely subscribe to my content
    and get my articles in your inbox.* [***You can do that here!***](https://andymcdonaldgeo.medium.com/subscribe)'
  prefs: []
  type: TYPE_NORMAL
- en: '*Secondly, you can get the full Medium experience and support thousands of
    other writers and me by signing up for a membership. It only costs you $5 a month,
    and you have full access to all of the fantastic Medium articles, as well as the
    chance to make money with your writing.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*If you sign up using* [***my link***](https://andymcdonaldgeo.medium.com/membership)***,***
    *you will support me directly with a portion of your fee, and it won’t cost you
    more. If you do so, thank you so much for your support.*'
  prefs: []
  type: TYPE_NORMAL

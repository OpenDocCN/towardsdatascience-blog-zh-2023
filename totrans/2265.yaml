- en: Using DeepFace for Face Recognition
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/using-deepface-for-face-recognition-5f8d1e43f2a6](https://towardsdatascience.com/using-deepface-for-face-recognition-5f8d1e43f2a6)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Learn how to perform face recognition without needing to train your own model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://weimenglee.medium.com/?source=post_page-----5f8d1e43f2a6--------------------------------)[![Wei-Meng
    Lee](../Images/10fc13e8a6858502d6a7b89fcaad7a10.png)](https://weimenglee.medium.com/?source=post_page-----5f8d1e43f2a6--------------------------------)[](https://towardsdatascience.com/?source=post_page-----5f8d1e43f2a6--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----5f8d1e43f2a6--------------------------------)
    [Wei-Meng Lee](https://weimenglee.medium.com/?source=post_page-----5f8d1e43f2a6--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----5f8d1e43f2a6--------------------------------)
    ·10 min read·Apr 18, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/be2885cc45ece3179a64488ba98914e9.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [fran innocenti](https://unsplash.com/es/@frani?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 'In my previous article on Face Detection, I discussed how you can make use
    of OpenCV to detect faces in your webcam:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/face-detection-using-python-the-precursor-to-face-recognition-316ded4d116f?source=post_page-----5f8d1e43f2a6--------------------------------)
    [## Face Detection using Python — the Precursor to Face Recognition'
  prefs: []
  type: TYPE_NORMAL
- en: Have fun with Python by using your webcam to detect your face
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/face-detection-using-python-the-precursor-to-face-recognition-316ded4d116f?source=post_page-----5f8d1e43f2a6--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Detecting faces is the first step that you usually perform, followed by *face
    recognition*.
  prefs: []
  type: TYPE_NORMAL
- en: Face recognition is the process in which you match a human face from a digital
    image or a video frame against a database of faces.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: There are several deep learning models that you can use to perform face recognition,
    but all these requires you to have some knowledge of neural networks and you also
    need to train them using your own dataset. For people who wanted to perform face
    recognition but do not want to go into the details of how neural network works,
    there is an API that really simplifies face recognition — **DeepFace**.
  prefs: []
  type: TYPE_NORMAL
- en: What is DeepFace?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'DeepFace is a lightweight face recognition and facial attribute analysis (age,
    gender, emotion and race) framework (API) for python. It is essentially a wrapper
    for state-of-the-art models trained to recognize faces. It can use the following
    pre-trained models:'
  prefs: []
  type: TYPE_NORMAL
- en: VGG-Face (default)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Google FaceNet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OpenFace
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Facebook DeepFace
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DeepID
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ArcFace
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dlib
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SFace
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In short, DeepFace allows you to use pre-trained models to recognize your own
    set of faces, without requiring you to create your own model and train it.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, I will walk you through some of the cool features of DeepFace
    and how you can incorporate face recognition in your own project.
  prefs: []
  type: TYPE_NORMAL
- en: Ethical Considerations for Face Detection/Recognition
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While the ability to recognize faces is definitely cool, it certainly has a
    lot of ethical implications. There are several concerns that you need to take
    note before you get too ahead of yourself when implementing facial recognition
    into your projects. Concerns such as **privacy** (face detection can be used to
    track people’s movements without their consent), **bias** (face recognition can
    be biased towards individual of different race, gender, or age), and **misuse**
    (faces captured may be used for other illegal uses or malicious purposes). So
    while this article focuses on the technical capability for face recognition, you
    should consider carefully the moral and ethical implications before you implement
    it in your work.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some low-risk projects where face recognition can be implemented:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Attendance tracking** — you can use face recognition in schools or workplace
    to take attendance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Personalization** — using face recognition to personalize services. A good
    example is for entertainment services such as recommending specific TV shows based
    on a user’s watching history.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Security** — use of face recognition to unlock non-critical systems, such
    as smartphones and computers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'However, using face recognition in certain applications has severe moral implications.
    Here are some examples:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Law enforcement** — while face recognition can be useful for law enforcement,
    there are some serious concerns about its inaccuracies and biases.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Surveillance** — face recognition technologies have been used in some countries
    for monitoring and tracking its citizens, particularly dissidents. Some companies
    also uses face recognition to monitor employees’ productivity, which is a direct
    infringement of their privacies.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here are some articles that you can read to learn more about the legal and
    moral concerns of face recognition:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Facial Recognition in the United States: Privacy Concerns and Legal Developments
    —** [https://www.asisonline.org/security-management-magazine/monthly-issues/security-technology/archive/2021/december/facial-recognition-in-the-us-privacy-concerns-and-legal-developments/](https://www.asisonline.org/security-management-magazine/monthly-issues/security-technology/archive/2021/december/facial-recognition-in-the-us-privacy-concerns-and-legal-developments/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Privacy and security issues associated with facial recognition software**
    — [https://www.techrepublic.com/article/privacy-and-security-issues-associated-with-facial-recognition-software/](https://www.techrepublic.com/article/privacy-and-security-issues-associated-with-facial-recognition-software/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**10 reasons to be concerned about facial recognition technology** — [https://www.privacycompliancehub.com/gdpr-resources/10-reasons-to-be-concerned-about-facial-recognition-technology/](https://www.privacycompliancehub.com/gdpr-resources/10-reasons-to-be-concerned-about-facial-recognition-technology/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing DeepFace
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Installing DeepFace is relatively easy — if you have a Mac. For Windows, it
    requires a bit of work.
  prefs: []
  type: TYPE_NORMAL
- en: I will walk you through the steps for installing DeepFace on both macOS and
    windows.
  prefs: []
  type: TYPE_NORMAL
- en: For macOS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For macOS, simply run the following commands in Jupyter Notebook to install
    `cmake`, `dlib`, and then `deepface`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Once this is done, you are ready to use DeepFace.
  prefs: []
  type: TYPE_NORMAL
- en: For Windows
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For Windows, you need to perform a number of steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Download **CMake** from [https://cmake.org/download/](https://cmake.org/download/)
    and run the installer.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Make sure to add path environment variable to its bin eg: **C:/ProgramFiles/cmake/bin**
    *during the installation process*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Download **Visual Studio Build Tools** from [https://visualstudio.microsoft.com/visual-cpp-build-tools/](https://visualstudio.microsoft.com/visual-cpp-build-tools/)
    and run the installer.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Check the **C++ built tools** and click **Install**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/7fed3bab74e62ce8945b32b3f0a7f08a.png)'
  prefs: []
  type: TYPE_IMG
- en: All images by author
  prefs: []
  type: TYPE_NORMAL
- en: The above step will take a bit of time. Go for your break now.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Finally, run the following commands in Jupyter Notebook:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Once this is done, you are ready to use DeepFace.
  prefs: []
  type: TYPE_NORMAL
- en: Using DeepFace
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To use DeepFace, import it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: I am using Jupyter Notebook for this article.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Preparing the Images
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'I am going to download and prepare a few images so that I can test it with
    DeepFace. First, download the following image of *Keanu Reeves* and save it to
    the same directory as your Jupyter Notebook:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4bea67c63bd32d8b2684fc7d8e0ad0eb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://en.wikipedia.org/wiki/Keanu_Reeves#/media/File:Keanu_Reeves_(crop_and_levels)_(cropped).jpg](https://en.wikipedia.org/wiki/Keanu_Reeves#/media/File:Keanu_Reeves_(crop_and_levels)_(cropped).jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, create a variable named `image1` and assign it the filename of the image:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Likewise, do it for the following images:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bb2ab03a7dff6fa8953bb95e05f3464d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://en.wikipedia.org/wiki/Keanu_Reeves#/media/File:Reuni%C3%A3o_com_o_ator_norte-americano_Keanu_Reeves_(46806576944)_(cropped).jpg](https://en.wikipedia.org/wiki/Keanu_Reeves#/media/File:Reuni%C3%A3o_com_o_ator_norte-americano_Keanu_Reeves_(46806576944)_(cropped).jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/70cb3f7a20e21d4873ea70cbe62acdec.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://en.wikipedia.org/wiki/Jet_Li#/media/File:Jet_Li_2009_(cropped).jpg](https://en.wikipedia.org/wiki/Jet_Li#/media/File:Jet_Li_2009_(cropped).jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/42879c1a3a0e5ecbad03c8d7a9504dfe.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://en.wikipedia.org/wiki/Denzel_Washington#/media/File:Denzel_Washington_2018.jpg](https://en.wikipedia.org/wiki/Denzel_Washington#/media/File:Denzel_Washington_2018.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/39d704e656f238346f465b4731dc3739.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: [https://en.wikipedia.org/wiki/Smile#/media/File:Smiling_girl.jpg](https://en.wikipedia.org/wiki/Smile#/media/File:Smiling_girl.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Comparing Faces
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s now use DeepFace to compare two images to see if they contain the faces
    of the same person. For this, you use the `verify()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The first time you run DeepFace, it will download the weights of the pre-trained
    model (by default it uses the VGG-Face model) to your computer:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/05b3ff9012fdd3dfae7b0309db9b849a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the weights have been downloaded, DeepFace will return a result that looks
    like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: The value of the `verified` key indicates if the two faces are the same. The
    value of the `distance` key is the distance between the two face vectors (the
    smaller the value the more similar are the two faces). The value of the `threshold`
    key sets the threshold in which the `distance` value will be interpreted — a value
    of less than 0.4 will cause `True` to be set for the `verified` key. The `facial_areas`
    key contains the positions of the faces in the two images.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s try to compare another two images — `image1` and `image3`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'Not surprisingly, DeepFace detected that the two faces are different:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Embeddings
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Embeddings are multi-dimensional vectors representing the facial images. DeepFace
    allows you to find the embeddings using the `represent()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'The embeddings for `image1` is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Depending on which pre-trained model you used for DeepFace, the size of the
    value of the`embedding` key varies. For VGG-Face, the the facial image is represented
    as a 2622-dimension vector. What is more fun is the value of the `facial_area`
    key, which contains the location of the face in the image.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following code snippet displays the image of Keanu Reeves (`image1`) and
    the rectangle drawn around the area that detected his face:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/5a8d8ce77fc32311737e9efac3a8e3c1.png)'
  prefs: []
  type: TYPE_IMG
- en: Finding a Face from a Folder of Faces
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Perhaps the most exciting feature of DeepFace is its ability for you to take
    an image and compare it with a set of images located in a folder. DeepFace will
    then tell you which of the images are most identical to the one you have supplied.
    This is essentially *face recognition*.
  prefs: []
  type: TYPE_NORMAL
- en: 'To see how powerful this feature is, I created a new folder named **Faces**
    in the same folder as my Jupyter Notebook and populated it with some images of
    *Jet Li* and *Keanu Reeves*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c98a6819b4a04b5011e7540444a418f6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'I then call the `find()` function and pass it `image1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: If the `*find()*` function discovers that an image in the Faces folder does
    not contain any face, it will raise an exception. To prevent this from happening,
    set the `enforce_detection` parameter to `False`.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The `find()` function returns a list of Pandas DataFrames, so you need to use
    the 0 index to retrieve the first DataFrame:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/533d94258bf84e9683b5285c859c35b6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The dataframe contains a list of image filenames that most closely resembles
    the image that you are searching. In this example, the top match is **KeanuReeves_3.jpg**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/86d263f61d7a2c2b7d1ee05eec2baf22.png)'
  prefs: []
  type: TYPE_IMG
- en: The dataframe is sorted based on VGG-Face_cosine (the smaller the value, the
    closer the match).
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Note that when you call the `find()` function for the first time, a representations
    file named **representations_vgg_face.pkl** is created and stored in the **Faces**
    folder. If you were to add new images to the **Faces** folder, remember to delete
    the **representations_vgg_face.pkl** file.
  prefs: []
  type: TYPE_NORMAL
- en: With the `find()` function, you can essentially perform face recognition without
    training any model — just create a folder containing the faces you want to recognize
    (each individual should have as many images as possible) and voila, you have a
    face recognition model!
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing Faces
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Besides comparing faces and finding a face from a folder of faces, DeepFace
    also allows you to analyze the various features of a face, such as age, gender,
    emotion, and race:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'The above statement analyzes the image of *Denzel Washington* (`image4`) and
    it quite accurately predicted that the face in the image is:'
  prefs: []
  type: TYPE_NORMAL
- en: feeling sad
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a black man
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here’s the result returned by the `analyze()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'Let’s try analyzing another image, this time with the image of a smiling girl
    (`image5`):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'The result is pretty accurate:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Changing Pre-trained Models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'If you want to change the underlying pre-trained model used by DeepFace, you
    can specify the model you want to use using the `model_name` parameter in the
    `verify()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: The weights for the selected model will now be downloaded onto your computer.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The same goes for the `represent()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'And the `find()` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '**If you like reading my articles and that it helped your career/study, please
    consider signing up as a Medium member. It is $5 a month, and it gives you unlimited
    access to all the articles (including mine) on Medium. If you sign up using the
    following link, I will earn a small commission (at no additional cost to you).
    Your support means that I will be able to devote more time on writing articles
    like this.**'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://weimenglee.medium.com/membership?source=post_page-----5f8d1e43f2a6--------------------------------)
    [## Join Medium with my referral link - Wei-Meng Lee'
  prefs: []
  type: TYPE_NORMAL
- en: Read every story from Wei-Meng Lee (and thousands of other writers on Medium).
    Your membership fee directly supports…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: weimenglee.medium.com](https://weimenglee.medium.com/membership?source=post_page-----5f8d1e43f2a6--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Using DeepFace makes it very easy for you to perform face recognition — there
    is no need for explicit training, and all you need to do is to put the images
    of faces into a specific folder and DeepFace will do the hard work of recognizing
    a specific face. The downside of DeepFace is that it takes a bit of time to return
    a result. If you want to use DeepFace for realtime face recognition, it might
    not be the best choice. However, there are still a lot of applications that you
    can build using DeepFace. If you are using DeepFace for your current projects,
    be sure to share with us how you are using DeepFace, or how you intend to use
    it.
  prefs: []
  type: TYPE_NORMAL

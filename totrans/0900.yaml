- en: Fine-Tuned LLMs for Sentiment Prediction — How to Analyze and Evaluate
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/fine-tuned-llms-for-sentiment-prediction-how-to-analyze-and-evaluate-1c31b4f06835](https://towardsdatascience.com/fine-tuned-llms-for-sentiment-prediction-how-to-analyze-and-evaluate-1c31b4f06835)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Evaluation of models on Hugging Face for sentiment prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://pranay-dave9.medium.com/?source=post_page-----1c31b4f06835--------------------------------)[![Pranay
    Dave](../Images/accecc418ea23d26862761bf470fcf04.png)](https://pranay-dave9.medium.com/?source=post_page-----1c31b4f06835--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1c31b4f06835--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1c31b4f06835--------------------------------)
    [Pranay Dave](https://pranay-dave9.medium.com/?source=post_page-----1c31b4f06835--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1c31b4f06835--------------------------------)
    ·10 min read·Aug 9, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/984be0b6638392acc2e46f468ea1b7f1.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Oleksandr Baiev](https://unsplash.com/@bayevs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/PQhq3qLebmc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Sentiment analysis is an area that has witnessed a remarkable transformation
    in the era of large language models (LLMs). As the LLMs can understand the context
    of the text, they are proving to be a very powerful way to analyze sentiments.
    The number of LLMs that are available for sentiment analysis on Hugging Face is
    impressive. The last time I checked, when writing this story, the number of models
    on Hugging Face for the sentiment task was [3017](https://huggingface.co/models?sort=trending&search=sentiment)!
    This is a considerable number. Gone are the days when sentiment analysis was done
    with a handful of techniques such as traditional machine learning with TFIDF features,
    counting positive and negative words, or with libraries such as VADER.
  prefs: []
  type: TYPE_NORMAL
- en: Though the huge number of models available is exciting, it can also be overwhelming.
    So this article will help you navigate the LLM jungle for sentiment analysis.
    I will take top models and show you how to analyze and evaluate them. This can
    help you better understand which model suits your sentiment analysis needs.
  prefs: []
  type: TYPE_NORMAL
- en: Why do you need to analyze and evaluate the models with your data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sentiment analysis is a very important business KPI. Many enterprises take important
    decisions such as product promotion or discontinuation based on sentiment analysis
    of customer reviews.
  prefs: []
  type: TYPE_NORMAL
- en: 'Most of the fine-tuned models on Hugging Face already provide analysis and
    evaluation. So you may ask why you need to analyze and make your own evaluation.
    There are multiple reasons:'
  prefs: []
  type: TYPE_NORMAL
- en: The evaluation provided by model developers is based on their data, which may
    not reflect your business.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Not all models may be suitable to your business use case, even if all are called
    sentiment analysis models.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The strategic importance of sentiment analysis demands analyzing and evaluating
    based on your specific business data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Approach
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The approach which I will take in this story is shown here. I will first select
    a few candidate models followed by establishing an evaluation criterion. All models
    will be used to predict sentiment against a common dataset. The output will be
    analyzed and compared with the evaluation criterion.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e7525aa771bacad4e40dc30e4d6735ac.png)'
  prefs: []
  type: TYPE_IMG
- en: Approach (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Please note that the evaluation here is purely from a sentiment analysis point
    of view, and not a technical performance point of view.
  prefs: []
  type: TYPE_NORMAL
- en: Candidate models for analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I will take the models as shown in the table below for analysis. The reason
    for this choice is that these models are the top downloaded models as of the date
    of writing this story, as well as all are using different base models. The type
    of sentiment predicted is also different. Analyzing these models will help us
    get a complete picture of how sentiment is predicted using fine-tuned LLMs.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0e0caabcc1687822e3a985e5a687a407.png)'
  prefs: []
  type: TYPE_IMG
- en: Candidate models (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: You may observe that the models are a mix of general text analysis as well as
    tweet analysis.
  prefs: []
  type: TYPE_NORMAL
- en: You can apply the approach described here to various other models of your interest.
  prefs: []
  type: TYPE_NORMAL
- en: Data for analyzing the model output
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In order to analyze the models, let us take a data set from Amazon food reviews.
    A sample data is shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e7cb61fdf9c9f8453a543a3563a8ed9b.png)'
  prefs: []
  type: TYPE_IMG
- en: Example of a customer review (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The reason why I have chosen a dataset on customer reviews is that it has authentic
    customer reviews. It also has long and complex reviews, as compared to alternatives
    dataset such as tweets. Analyzing customer reviews is more important in enterprises
    compared to analyzing tweets. Also, the number of characters in tweets is restricted,
    while customer reviews can have very long text.
  prefs: []
  type: TYPE_NORMAL
- en: Evaluation approach — comparing with the ground truth
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In addition to analyzing the models, it would be also useful to evaluate them
    by comparing results with the ground truth. The actual review data has a rating
    given by customers on a scale of 1 to 5\. One can represent the ground truth using
    the following visual, which is a histogram based on the actual rating given by
    the customer.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a257130212bae40aa6b51b7fe68f7717.png)'
  prefs: []
  type: TYPE_IMG
- en: Ground truth (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The actual data has a rating on a scale of 1 to 5 but does not have the sentiment
    negative, neutral, or positive. However we can make the assumption that a rating
    of 1 and 2 is negative sentiment, a rating of 3 is neutral sentiment, and a rating
    of 4 and 5 is a positive sentiment.
  prefs: []
  type: TYPE_NORMAL
- en: So our ground truth table would look like this.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1d180ed5f874dcfe72d420345ce4a2b3.png)'
  prefs: []
  type: TYPE_IMG
- en: Ground truth data (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Now let us see how various models perform against the actual data. Here is the
    sentiment analysis using various models.
  prefs: []
  type: TYPE_NORMAL
- en: Fine-tuned LLM for sentiment predicted as a RATING
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The [nlptown/bert-base-multilingual-uncased-sentiment](https://huggingface.co/nlptown/bert-base-multilingual-uncased-sentiment)
    is one of the most downloaded models. It is a model based on BERT base (Bidirectional
    Encoder Representations from Transformers). It is fine-tuned to predict the sentiment
    of the review as a number of stars (between 1 and 5). It works on uncased text
    and expects a maximum token length of 512\. It can be used in six languages —
    English, Dutch, German, French, Italian, and Spanish.
  prefs: []
  type: TYPE_NORMAL
- en: The sentiment analysis is shown here.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1261151306e9067b62971f045835bdbe.png)'
  prefs: []
  type: TYPE_IMG
- en: bert-base-multilingual-uncased-sentiment analysis (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: As the data is customer review data, sentiment analysis using a star-rating
    approach is great. We can compare it with the actual customer rating as shown
    below. You can observe that the predicted rating is in line with the actual rating.
    The model is doing a good job of predicting the sentiment.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/29fc2832a03178a844a574918ebcffb0.png)'
  prefs: []
  type: TYPE_IMG
- en: bert-base-multilingual-uncased-sentiment predicted vs actual rating (image by
    author)
  prefs: []
  type: TYPE_NORMAL
- en: Comparing with the ground truth gives us a mean absolute error percentage of
    8.43%
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/58ef4e591d7aa9d193c43bfca40b20a4.png)'
  prefs: []
  type: TYPE_IMG
- en: nlptown/bert-base-multilingual-uncased-sentiment evaluation (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Now let us move to the next fine-tuned large language model.
  prefs: []
  type: TYPE_NORMAL
- en: Fine-tuned LLM for sentiment predicted as NEGATIVE, NEUTRAL, POSITIVE
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Here we will analyze the [cardiffnlp/twitter-roberta-base-sentiment-latest](https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment-latest)
    model. The base model, RoBERTA (A Robustly Optimized BERT Pretraining Approach)
    is a variant of BERT and was introduced by Facebook. The cardiffnlp/twitter-roberta-base-sentiment-latest
    model is fine-tuned on social media tweets to predict sentiment as negative, neutral,
    or positive. The sentiment prediction results are shown here.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/df4dfa2431dded183a4d0e391a387354.png)'
  prefs: []
  type: TYPE_IMG
- en: cardiffnlp/twitter-roberta-base-sentiment analysis (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Comparing with the ground truth gives us a mean absolute error percentage of
    1.86%
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e9b5545ac8bc61b8e4c7d2f6395ed1d4.png)'
  prefs: []
  type: TYPE_IMG
- en: cardiffnlp/twitter-roberta-base-sentiment evaluation (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The result is really great, especially given the fact that the model is fine-tuned
    on tweets and not on actual customer reviews.
  prefs: []
  type: TYPE_NORMAL
- en: Now let us move to the next model.
  prefs: []
  type: TYPE_NORMAL
- en: Fine-tuned LLM for sentiment predicted as an EMOTION
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sentiment can be expressed in various forms, and one such way is emotions. The
    [bhadresh-savani/distilbert-base-uncased-emotion](https://huggingface.co/bhadresh-savani/distilbert-base-uncased-emotion)
    model predicts six types of emotions — sadness, joy, love, anger, fear, and surprise.
    It is fine-tuned on distilbert which is a smaller and faster variant of BERT.
    It was designed by the researchers to have a smaller memory footprint. The sentiment
    analysis results are shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a7493ad1344ac94be38f6172ac2a635c.png)'
  prefs: []
  type: TYPE_IMG
- en: bhadresh-savani/distilbert-base-uncased-emotion analysis (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The analysis is interesting, as emotions are a nice way to analyze customer
    reviews. However, linking emotion to sentiment is not straightforward. Here is
    a visual which will help you understand the link between emotion and sentiment.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/17d7393697b4144ab817b4bc86705729.png)'
  prefs: []
  type: TYPE_IMG
- en: Emotion vs sentiment (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: 'You will observe that in the 5-star actual rating, there are all types of emotions:
    joy, anger, fear, love, sadness, and surprise. Here is an example that has emotion
    as fear, but has a 5-star rating.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/434330c7f1febfbb24995c3671752291.png)'
  prefs: []
  type: TYPE_IMG
- en: fear emotion, but has a 5-star rating (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The review shows that the customer was nervous and fearing about changing food
    for the dog. However, the product which was bought was good and help overcome
    the fear, as well as solved the problem.
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing emotions can also help understand the reasons why customers purchase.
    However, it is difficult to compare with the ground truth.
  prefs: []
  type: TYPE_NORMAL
- en: So, the final evaluation table looks as follows
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e7c223c9c0e7f5adc4df8b3429a7b91e.png)'
  prefs: []
  type: TYPE_IMG
- en: all evaluations (image by author)
  prefs: []
  type: TYPE_NORMAL
- en: You can take the approach described here for various other fine-tuned LLMs for
    sentiment analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sentiment analysis is very important for many enterprises, as it helps better
    understand customer and product performance. Fine-tuned LLMs provide a cutting-edge
    approach to analyzing LLMs. As the number of fine-tuned models is ever-increasing,
    it is useful to understand the various types of models and how to evaluate them.
  prefs: []
  type: TYPE_NORMAL
- en: In this story, you saw three types of sentiment prediction — rating prediction,
    negative/neutral/positive sentiment prediction, and emotion prediction. They can
    all be used for various business use cases to better understand customer sentiment.
    You saw how to analyze them as well as evaluate the results.
  prefs: []
  type: TYPE_NORMAL
- en: 'As there are lots of fine-tuned large-language models available, you might
    not want to waste effort in trying out models randomly. So here are some guidelines
    on how to select models you can experiment with:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Business use-case requirement**: Understanding your requirement for sentiment
    analysis is the main starting point that can put you in the right direction. Sentiment
    analysis for business use cases can differ based on various industries. For example,
    a use-case in banking may need sentiment analysis as positive, neutral, or negative.
    However, an e-commerce retailer would need sentiment based on a rating scale of
    1 to 5\. Understanding the requirement can help you correctly determine the scope
    of models which you need to experiment with.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Type of your data**: There are various types of data that require sentiment
    analysis. For example, customer reviews and tweets are obvious, however, there
    are many different types of data that require sentiment analysis such as emails,
    quality inspection notes, user-submitted content, survey response, employee feedback,
    healthcare feedback, etc. It is important to analyze what data the large-language
    model is fine-tuned on. Generally, it is better to select a model which is fine-tuned
    that has the same type as your data. Analyzing sentiment on a data type that is
    different from what was used in fine-tuning can work as an exception. For example,
    you can do sentiment analysis on customer reviews using a model which was fine-tuned
    on tweets. However, sentiment analysis on employee feedback using a model fine-tuned
    on tweets might not give good results. So try to select a model which was fine-tuned
    on data which is related to your data.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Base model and training parameters**: You should carefully observe the base
    model as well as the training parameters used. This can determine the restrictions
    which you might need to apply such as the maximum length of tokens or case of
    your text. For example, if the base-model maximum length is 512, and if your text
    has more tokens, the fine-tuned model would not give correct results. So try to
    understand the base model and training parameters to determine all restrictions
    which you might need to apply. Analyzing the restrictions can help you decide
    if the model is suitable for your needs or not.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Multi-lingualism:** As generative AI becomes of strategic importance to enterprises,
    most of the projects are global. This implies that the sentiment analysis project
    would be global in nature and should take into account different languages. This
    means that the model which you select should be multi-lingual or you should select
    multiple models based on different languages for which sentiment analysis is required.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Evaluation criterion**: Even though fine-tuned models are available and read-to-use,
    you should still set up some evaluation criteria. The evaluation would either
    depend on some ground-truth information you might have or could also be a human
    evaluation. The evaluation criterion needs to be objective, for example, mean
    absolute error between model output and ground truth, as I have used in this story.
    You saw that a model which analyses emotion is not useful for evaluation if the
    ground truth is rating. Setting up the evaluation criterion can also help you
    decide on which models to experiment with.'
  prefs: []
  type: TYPE_NORMAL
- en: Technical Implementation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Here is a Python code snippet that uses the fine-tuned model to predict sentiment
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Dataset citation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The dataset is available [here](https://www.kaggle.com/datasets/snap/amazon-fine-food-reviews)
    with license CC0 Public domain. [**Both commercial and non-commercial use of it
    is permitted**](https://www.ibm.com/community/terms-of-use/download/)**.**
  prefs: []
  type: TYPE_NORMAL
- en: Subscribe and Join Medium
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Please [**subscribe**](https://pranay-dave9.medium.com/subscribe) to stay informed
    whenever I release a new story.
  prefs: []
  type: TYPE_NORMAL
- en: If you are not yet a member, you can join medium with[**referral link**](https://pranay-dave9.medium.com/membership).
  prefs: []
  type: TYPE_NORMAL
- en: You may also like
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You may also like the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/gpt-vs-bert-which-is-better-2f1cf92af21a?source=post_page-----1c31b4f06835--------------------------------)
    [## GPT vs BERT: Which is Better?'
  prefs: []
  type: TYPE_NORMAL
- en: 'Comparing two large-language models: Approach and example'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/gpt-vs-bert-which-is-better-2f1cf92af21a?source=post_page-----1c31b4f06835--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Additional Resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Website
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can visit my website to make analytics with zero coding. [**https://experiencedatascience.com**](https://experiencedatascience.com/)
  prefs: []
  type: TYPE_NORMAL
- en: Youtube channel
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Please visit my YouTube channel to learn data science and AI use cases using
    demos
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.youtube.com/c/DataScienceDemonstrated?source=post_page-----1c31b4f06835--------------------------------)
    [## Data Science Demonstrated'
  prefs: []
  type: TYPE_NORMAL
- en: Learn data science through demos. Whatever profession you are in , sit back
    , relax and enjoy the videos. My name is…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.youtube.com](https://www.youtube.com/c/DataScienceDemonstrated?source=post_page-----1c31b4f06835--------------------------------)
  prefs: []
  type: TYPE_NORMAL

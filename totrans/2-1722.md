# Python æ•°æ®å·¥ç¨‹å¸ˆ

> åŸæ–‡ï¼š[https://towardsdatascience.com/python-for-data-engineers-f3d5db59b6dd](https://towardsdatascience.com/python-for-data-engineers-f3d5db59b6dd)

## åˆå­¦è€…çš„é«˜çº§ETLæŠ€å·§

[](https://mshakhomirov.medium.com/?source=post_page-----f3d5db59b6dd--------------------------------)[![ğŸ’¡Mike Shakhomirov](../Images/bc6895c7face3244d488feb97ba0f68e.png)](https://mshakhomirov.medium.com/?source=post_page-----f3d5db59b6dd--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f3d5db59b6dd--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f3d5db59b6dd--------------------------------) [ğŸ’¡Mike Shakhomirov](https://mshakhomirov.medium.com/?source=post_page-----f3d5db59b6dd--------------------------------)

Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f3d5db59b6dd--------------------------------) Â·é˜…è¯»æ—¶é—´17åˆ†é’ŸÂ·2023å¹´10æœˆ21æ—¥

--

![](../Images/9c664876939298ade749c4c53cb490c8.png)

å›¾ç‰‡ç”± [Boitumelo](https://unsplash.com/@writecodenow?utm_source=medium&utm_medium=referral) æä¾›ï¼Œæ¥è‡ª [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

åœ¨è¿™ä¸ªæ•…äº‹ä¸­ï¼Œæˆ‘å°†è®²è¿°Pythonä¸­çš„é«˜çº§æ•°æ®å·¥ç¨‹æŠ€æœ¯ã€‚æ¯«æ— ç–‘é—®ï¼ŒPythonæ˜¯æœ€å—æ¬¢è¿çš„æ•°æ®ç¼–ç¨‹è¯­è¨€ã€‚åœ¨æˆ‘è¿‘åäºŒå¹´çš„æ•°æ®å·¥ç¨‹èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œæˆ‘é‡åˆ°è¿‡å„ç§ä»£ç é—®é¢˜ã€‚è¿™ä¸ªæ•…äº‹ç®€è¦æ€»ç»“äº†æˆ‘å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜å¹¶å­¦ä¼šå†™å‡ºæ›´å¥½çš„ä»£ç ã€‚æˆ‘å°†å±•ç¤ºä¸€äº›ä½¿æˆ‘ä»¬çš„ETLæ›´å¿«å¹¶æœ‰åŠ©äºæé«˜ä»£ç æ€§èƒ½çš„æŠ€æœ¯ã€‚

## åˆ—è¡¨æ¨å¯¼å¼

æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨éå†ä¸€ä¸ªè¡¨çš„åˆ—è¡¨ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šè¿™æ ·åšï¼š

[PRE0]

ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ã€‚å®ƒä»¬ä¸ä»…æ›´å¿«ï¼Œè¿˜å‡å°‘äº†ä»£ç ï¼Œä½¿å…¶æ›´ç®€æ´ï¼š

[PRE1]

ä¾‹å¦‚ï¼Œå¾ªç¯å¤„ç†ä¸€ä¸ªè¶…å¤§çš„æ–‡ä»¶ä»¥è½¬æ¢ï¼ˆETLï¼‰æ¯ä¸€è¡Œï¼Œä»æœªå¦‚æ­¤ç®€å•ï¼š

[PRE2]

åˆ—è¡¨æ¨å¯¼å¼å¯¹äºETLå¤„ç†å¤§æ•°æ®æ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€è¦è½¬æ¢ä¸ºæ¢è¡Œç¬¦åˆ†éš”æ ¼å¼çš„æ•°æ®æ–‡ä»¶ã€‚åœ¨ä½ çš„Pythonç¯å¢ƒä¸­å°è¯•è¿è¡Œè¿™ä¸ªç¤ºä¾‹ï¼š

[PRE3]

è¾“å‡ºå°†æ˜¯**æ¢è¡Œç¬¦åˆ†éš”çš„JSON**ã€‚è¿™æ˜¯BigQueryæ•°æ®ä»“åº“ä¸­çš„ä¸€ç§æ ‡å‡†æ ¼å¼ï¼Œå‡†å¤‡å¥½åŠ è½½åˆ°è¡¨ä¸­äº†ï¼š

[PRE4]

## ç”Ÿæˆå™¨

å¦‚æœæˆ‘ä»¬å¤„ç†çš„æ˜¯**é€è¡Œå­˜å‚¨**çš„CSVå’ŒDATæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ–‡ä»¶å¯¹è±¡å·²ç»æ˜¯ä¸€ä¸ª**ç”Ÿæˆå™¨**ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼æ¥å¤„ç†æ•°æ®ï¼Œ**ä¸ä¼šæ¶ˆè€—å¤ªå¤šå†…å­˜**ï¼š

[PRE5]

åœ¨æˆ‘ä»¬å®é™…å°†è®°å½•æ’å…¥æ•°æ®ä»“åº“è¡¨ä¹‹å‰éªŒè¯è®°å½•ï¼Œå¯¹äºæ‰¹é‡æ•°æ®å¤„ç†ç®¡é“å¯èƒ½æ˜¯æœ‰ç”¨çš„ã€‚

> æˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨å°†æ•°æ®æ–‡ä»¶åŠ è½½åˆ°æ•°æ®ä»“åº“ä¹‹å‰éªŒè¯å®ƒä»¬ã€‚å¦‚æœä¸€ä¸ªè®°å½•å¤±è´¥ï¼Œé‚£ä¹ˆæ•´ä¸ªæ‰¹æ¬¡éƒ½ä¼šå¤±è´¥ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºæ¥è¿‘å®æ—¶çš„åˆ†æç®¡é“ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§éå¸¸ç»æµé«˜æ•ˆçš„æ–¹å¼æ¥å¤„ç†æ•°æ®ï¼Œç›¸æ¯”äºæµæ•°æ®ç®¡é“è®¾è®¡æ¨¡å¼ã€‚æˆ‘ä¹‹å‰åœ¨è¿™é‡Œå†™è¿‡ï¼š

[](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----f3d5db59b6dd--------------------------------) [## æ•°æ®ç®¡é“è®¾è®¡æ¨¡å¼

### é€‰æ‹©åˆé€‚çš„æ¶æ„å’Œç¤ºä¾‹

[towardsdatascience.com](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----f3d5db59b6dd--------------------------------)

æˆ–è€…ï¼Œåœ¨å¤„ç†å¤§æ•°æ®æ—¶ï¼Œå¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶ä¸æ˜¯æ¢è¡Œç¬¦åˆ†éš”çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`yield`ã€‚è¿™å§‹ç»ˆæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ä»¥å†…å­˜é«˜æ•ˆçš„æ–¹å¼å¤„ç†æ•°æ®æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š

[PRE6]

è¿™å°†è¯»å–ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶å¹¶ä»¥19å­—èŠ‚ä¸ºå—è¿›è¡Œå¤„ç†ã€‚è¾“å‡ºå°†æ˜¯ï¼š

[PRE7]

è¿™åªæ˜¯å¤„ç†**äºŒè¿›åˆ¶**æ•°æ®çš„ä¸€ä¸ªç¤ºä¾‹ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå°†æ–‡ä»¶å†…å®¹åˆ†å‰²æˆæ®µä½¿ç”¨**åˆ†éš”ç¬¦**ï¼ˆå³æ¢è¡Œç¬¦`'\nâ€™`æˆ–`'}{'`ï¼‰å¯èƒ½ä¼šæ›´å®¹æ˜“ï¼Œè¿™å–å†³äºæˆ‘ä»¬çš„æ•°æ®ç»“æ„ã€‚

å‡è®¾æ–‡æœ¬æ•°æ®æ¥è‡ªæŸä¸ª**å¤–éƒ¨**ä½ç½®ï¼Œå³**äº‘å­˜å‚¨**ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶å¤„ç†ä¸º**æµ**ã€‚æˆ‘ä»¬ä¸å¸Œæœ›åŠ è½½æ•´ä¸ªæ•°æ®æ–‡ä»¶å¹¶è¿è¡Œ`split('\n')`é€è¡Œå¤„ç†ï¼Œè¿™ä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`re.finditer`ï¼Œå®ƒåƒ**ç”Ÿæˆå™¨**ä¸€æ ·ï¼Œä»¥å—çš„æ–¹å¼è¯»å–æ•°æ®æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿è¡Œæ‰€éœ€çš„ETLè€Œ**ä¸ä¼š**æ¶ˆè€—å¤ªå¤šå†…å­˜ã€‚

[PRE8]

è¾“å‡ºï¼š

[PRE9]

## Python **æ•°æ®éªŒè¯å±æ€§**

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨**Pythonå±æ€§** [2]æ¥éªŒè¯æ•°æ®è®°å½•ã€‚å¦‚æœè®°å½•ä¸æ˜¯æˆ‘ä»¬å®šä¹‰çš„ç±»çš„å®ä¾‹ï¼Œåˆ™å¿…é¡»æŠ›å‡ºå¼‚å¸¸ã€‚

> æˆ‘ä»¬å¯ä»¥å°†æ•°æ®å­˜å‚¨ä¸ºæ•°æ®ç±»çš„å¯¹è±¡ã€‚

å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª**æµæ•°æ®ç®¡é“**ï¼Œæˆ‘ä»¬æƒ³è¦éªŒè¯è®°å½•ä¸­çš„ä¸€äº›å­—æ®µã€‚

> ç®€å•æ¥è¯´â€”â€”å®ƒä»¬å¿…é¡»åŒ¹é…ç°æœ‰çš„è¡¨æ ¼æ¨¡å¼ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonå±æ€§æ¥å®ç°ã€‚è¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚

[PRE10]

å¦‚æœæˆ‘ä»¬é€‰æ‹©æ‰“ç ´è§„åˆ™å¹¶åˆ†é…ä¸€äº›ä¸ç¬¦åˆæˆ‘ä»¬æ ‡å‡†çš„å€¼ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•è°ƒç”¨`ConnectionDataRecord('', 1)`ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸º`Pydantic`çš„åº“ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬ç”¨ä¸ç¬¦åˆè¦æ±‚çš„å¯¹è±¡è°ƒç”¨è¯¥å‡½æ•°ï¼Œå®ƒå°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

[PRE11]

## è£…é¥°å™¨

è£…é¥°å™¨çš„è®¾è®¡ç›®çš„æ˜¯ä½¿æˆ‘ä»¬çš„ä»£ç çœ‹èµ·æ¥æ›´ç®€æ´ï¼Œå¹¶ä¸ºå…¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼ˆè£…é¥°å™¨ï¼‰ï¼Œå¹¶åœ¨è¿™ä¸ªåŒ…è£…å™¨å†…éƒ¨è¿›è¡Œä¸€äº›æ•°æ®è½¬æ¢ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šä¸åŒçš„ETLå‡½æ•°æ¥å¤„ç†æ•°æ®ï¼Œä½†æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå°†ç»“æœä¸Šä¼ åˆ°æ•°æ®æ¹–çš„å‡½æ•°ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•åšåˆ°çš„ï¼š

> å¦‚æœä¸€äº›ä»£ç é€»è¾‘é‡å¤ï¼Œä½¿ç”¨**è£…é¥°å™¨**æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚

è¿™æœ‰åŠ©äºæ›´å®¹æ˜“ç»´æŠ¤ä»£ç åº“ï¼Œå¹¶èŠ‚çœäº†æˆ‘ä»¬åœ¨éœ€è¦æ›´æ”¹é‡å¤é€»è¾‘æ—¶çš„å¾ˆå¤šæ—¶é—´ã€‚

[PRE12]

è£…é¥°å™¨å› å…¶æœ‰æ•ˆæ€§è¢«å¹¿æ³›ä½¿ç”¨ã€‚è€ƒè™‘è¿™ä¸ªAirflow DAGç¤ºä¾‹ï¼š

[PRE13]

## ä¸APIçš„å·¥ä½œ

ä½œä¸ºæ•°æ®å·¥ç¨‹å¸ˆï¼Œä½ ä¼šç»å¸¸æ‰§è¡ŒHTTPè¯·æ±‚ï¼Œè°ƒç”¨å„ç§APIç«¯ç‚¹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªGETè¯·æ±‚çš„ç¤ºä¾‹ã€‚

[PRE14]

å®ƒä»**å…è´¹**çš„**NASAå°è¡Œæ˜ŸAPI**ä¸­æå–ä¸€äº›æ•°æ®ï¼Œå¹¶è¿”å›æ‰€æœ‰åœ¨è¯¥æ—¥æœŸæ¥è¿‘åœ°çƒçš„å°è¡Œæ˜Ÿã€‚åªéœ€åœ¨ä¸Šé¢çš„URLè·¯å¾„ä¸­æ›¿æ¢ä½ çš„APIå¯†é’¥æˆ–ä½¿ç”¨æˆ‘åˆ›å»ºçš„å¯†é’¥ã€‚**requests**åº“å¤„ç†æ‰€æœ‰äº‹æƒ…ï¼Œä½†è¿˜æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚

> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼šè¯å¹¶ä»¥**æµ**çš„å½¢å¼å¤„ç†æ¥è‡ªæˆ‘ä»¬APIç«¯ç‚¹çš„æ•°æ®ã€‚

è¿™å°†ç¡®ä¿æˆ‘ä»¬ä¸ä¼šé‡åˆ°ä»»ä½•å†…å­˜é—®é¢˜ï¼Œå¹¶ä»¥æµå¼æ–¹å¼å¤„ç†æˆ‘ä»¬çš„GETè¯·æ±‚[3]ï¼š

[PRE15]

ç†è§£HTTPè¯·æ±‚çš„å·¥ä½œåŸç†åœ¨æ•°æ®å·¥ç¨‹ä¸­è‡³å…³é‡è¦ã€‚

> æˆ‘æ¯å¤©å¤„ç†å„ç§APIè¯·æ±‚ï¼Œä¸å¿…ä¾èµ–å…¶ä»–æ¡†æ¶æˆ–åº“ã€‚

ä¾‹å¦‚ï¼Œå°±åœ¨å‡ å‘¨å‰ï¼Œæˆ‘åœ¨**Dataformè¿ç§»é¡¹ç›®**ä¸Šå·¥ä½œï¼Œæ„è¯†åˆ°ç°æœ‰çš„Googleåº“ï¼ˆ`from google.cloud import dataform_v1beta1`ï¼‰æ— æ³•åˆ›å»ºè°ƒåº¦ã€‚è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨Dataform API [4]ï¼Œè¿™å°±åƒå‘ç‰¹å®šç«¯ç‚¹å‘å‡ºPOSTè¯·æ±‚ä¸€æ ·ç®€å•ï¼š

[PRE16]

è¿™ä¸ªè¯·æ±‚çš„æ ¸å¿ƒåœ¨äºæˆ‘ä»¬å°†`workflow_config`ä½œä¸º**json**å‘é€ï¼Œå¹¶ä½¿ç”¨æ¥è‡ªGoogleæ–‡æ¡£[4]çš„çŸ¥è¯†åœ¨è·¯å¾„å‚æ•°ä¸­æ·»åŠ `workflowConfigId`ã€‚

> è¿™å°†åˆ›å»ºä¸€ä¸ªå¿…è¦çš„è°ƒåº¦ï¼Œä»¥åœ¨BigQueryçš„Dataformä¸­è¿è¡Œæˆ‘ä»¬çš„æ•°æ®è½¬æ¢è„šæœ¬ã€‚

ç±»ä¼¼åœ°ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨GETè¯·æ±‚ä¸­æ‰€åšçš„é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Python **ç”Ÿæˆå™¨**å°†æ•°æ®æµå…¥æˆ‘ä»¬çš„POST APIç«¯ç‚¹ï¼š

[PRE17]

æ€è·¯å¾ˆæ¸…æ¥šã€‚æˆ‘ä»¬å¯ä»¥ä»¥èŠ‚çœå†…å­˜çš„æ–¹å¼å¤„ç†å’Œå‘é€æ•°æ®ã€‚

## å¤„ç†APIé€Ÿç‡é™åˆ¶

æ‰€æœ‰APIéƒ½æœ‰é€Ÿç‡é™åˆ¶ï¼Œæˆ‘ä»¬åœ¨æå–æ•°æ®æ—¶è¦è®°ä½è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨æ¥å¤„ç†å®ƒã€‚ç®€å•çš„è£…é¥°å¯ä»¥åƒè¿™æ ·å®ç°ï¼š

[PRE18]

ä½¿ç”¨è¿™ä¸ªè£…é¥°å™¨ï¼Œæˆ‘ä»¬çš„å‡½æ•°åœ¨15åˆ†é’Ÿå†…ä¸ä¼šå‘èµ·è¶…è¿‡10æ¬¡APIè°ƒç”¨ã€‚

å¤„ç†è¿™ç§æƒ…å†µçš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨`time.sleep()`ï¼Œä½†Pythoné€Ÿç‡é™åˆ¶å…è®¸æˆ‘ä»¬ä»¥è¿™ç§ä¼˜é›…çš„æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ã€‚

## Pythonä¸­çš„Asyncå’Œ`await`

ä»¥**å¼‚æ­¥**æ–¹å¼æ‰§è¡ŒETLæ˜¯å¦ä¸€ä¸ªæå…¶æœ‰ç”¨çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`asyncio`åº“æ¥åŒæ—¶è¿è¡Œä»»åŠ¡ã€‚è®©æˆ‘ä»¬è€ƒè™‘è¿™ä¸ªç®€å•çš„åŒæ­¥ç¤ºä¾‹ï¼Œå…¶ä¸­æˆ‘ä»¬åœ¨`for`å¾ªç¯ä¸­å¤„ç†è¡¨ï¼š

[PRE19]

è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ç­‰å¾…æ¯ä¸ªè¡¨å®Œæˆ`pull_data()`ä»»åŠ¡ï¼Œä½†ä½¿ç”¨`Async`ï¼Œæˆ‘ä»¬å¯ä»¥å¹¶è¡Œå¤„ç†å®ƒä»¬ã€‚

è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š

[PRE20]

å®ƒå°†åŒæ—¶ä»æŠ¥å‘ŠAPIä¸­æå–æ•°æ®ï¼Œå¹¶æ˜¾è‘—æé«˜æˆ‘ä»¬çš„ETLæ€§èƒ½ã€‚

> å®ƒå¸®åŠ©ç®¡ç†ETLä»»åŠ¡ï¼ŒåŒæ—¶ç³»ç»Ÿèµ„æºä»¥æœ€ä½³æ–¹å¼åˆ†é…ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶è¿è¡Œä¸¤ä¸ªETLä½œä¸šï¼Œä½†æˆ‘ä»¬å¯ä»¥å®šä¹‰æ‰§è¡Œé¡ºåºï¼š

[PRE21]

## ä½¿ç”¨Mapå’ŒFilter

æ˜ å°„å’Œè¿‡æ»¤æ¯”åˆ—è¡¨æ¨å¯¼å¼çš„é€Ÿåº¦æ›´å¿«ã€‚

æˆ‘ä»¬å¯ä»¥é€è¡Œè½¬æ¢æ•°æ®ï¼Œå°†`map`å‡½æ•°åº”ç”¨äºæ•°æ®é›†ä¸­çš„é¡¹ç›®ï¼Œå°†å…¶å¤„ç†ä¸º`iterable`ï¼š

[PRE22]

æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨`filter`æ¥æå–ç¬¦åˆç‰¹å®šæ¡ä»¶çš„å¯¹è±¡ï¼Œå³

[PRE23]

## ä½¿ç”¨ Pandas å¤„ç†å¤§å‹æ•°æ®é›†

åæ¥çš„ Pandas åº“ç‰ˆæœ¬æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå¯ä»¥åƒè¿™æ ·ä½¿ç”¨ï¼š

[PRE24]

> å®ƒå°†ä»¥æ‰¹å¤„ç†æ¨¡å¼å¤„ç†æ•°æ®ï¼Œå‡è®¾æˆ‘ä»¬ä¸éœ€è¦ä¸€æ¬¡æ€§å°†æ•´ä¸ªæ•°æ®é›†åŠ è½½åˆ°æ•°æ®æ¡†ä¸­ã€‚

å®ƒæœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œä» OLAP æŠ¥å‘Šåˆ°æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ç®¡é“ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦åˆ›å»ºä¸€ä¸ªæ¨èæ¨¡å‹è®­ç»ƒä»»åŠ¡ï¼Œå¹¶éœ€è¦åƒè¿™æ ·å‡†å¤‡æ•°æ®é›†ï¼š

[PRE25]

è¿™æ ·ï¼ŒPandas å°†ç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå§‹ç»ˆæœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å¤„ç†æ•°æ®ã€‚

## ä½¿ç”¨ joblib è¿›è¡Œç®¡é“å¤„ç†å’Œå¹¶è¡Œè®¡ç®—

`joblib.dump()`å’Œ`joblib.load()`æ–¹æ³•å…è®¸æˆ‘ä»¬é«˜æ•ˆåœ°ç®¡é“å¤§å‹æ•°æ®é›†è½¬æ¢ã€‚`joblib`å°†å­˜å‚¨å’Œåºåˆ—åŒ–å¤§æ•°æ®ï¼Œå¤„ç†ä»»æ„ Python å¯¹è±¡ï¼Œå¦‚`numpy`æ•°ç»„ã€‚

> ä½ è®¤ä¸º`scikit-learn`ç”¨ä»€ä¹ˆæ¥ä¿å­˜å’ŒåŠ è½½æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Ÿæ­£ç¡®çš„ç­”æ¡ˆæ˜¯ - `joblib`ã€‚

é¦–å…ˆï¼Œä¸ºä»€ä¹ˆè¦ä¿å­˜æ¨¡å‹ï¼Ÿâ€”â€”ç®€å•æ¥è¯´ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨ç®¡é“åé¢éœ€è¦å®ƒï¼Œå³ä½¿ç”¨æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ç­‰ã€‚

> æˆ‘ä»¬ä¸å¸Œæœ›é‡æ–°è®­ç»ƒæˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„ä»»åŠ¡ã€‚

å¦ä¸€ä¸ªåŸå› æ˜¯æˆ‘ä»¬å¯èƒ½å¸Œæœ›ä¿å­˜ç›¸åŒæ¨¡å‹çš„ä¸åŒç‰ˆæœ¬ï¼Œä»¥ä¾¿æŸ¥çœ‹å“ªä¸ªç‰ˆæœ¬è¡¨ç°æ›´å¥½ã€‚`joblib`æœ‰åŠ©äºå®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œ[5]ï¼š

[PRE26]

è¿™äº›å‡½æ•°æ˜ç¡®è¿æ¥äº†æˆ‘ä»¬åœ¨ç£ç›˜ä¸Šä¿å­˜çš„æ–‡ä»¶å’ŒåŸå§‹ Python å¯¹è±¡çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å› æ­¤ï¼Œé™¤äº†æ–‡ä»¶åï¼Œ`joblib`è¿˜æ¥å—æ–‡ä»¶å¯¹è±¡ï¼š

[PRE27]

**AWS S3 æ¨¡å‹è½¬å‚¨/åŠ è½½ç¤ºä¾‹ï¼š**

[PRE28]

## ä½¿ç”¨ joblib è¿›è¡Œå¹¶è¡Œè®¡ç®—

è¿™éå¸¸é«˜æ•ˆï¼Œå› ä¸ºå®ƒä¾èµ–äºå¤šè¿›ç¨‹ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨å¤šä¸ª Python å·¥ä½œè€…åœ¨æ‰€æœ‰ CPU æ ¸å¿ƒä¸Šæˆ–è·¨å¤šå°æœºå™¨å¹¶å‘æ‰§è¡Œä»»åŠ¡ã€‚è€ƒè™‘è¿™ä¸ªä¾‹å­ï¼š

[PRE29]

> æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ‰€æœ‰ CPU æ ¸å¿ƒæ¥é‡Šæ”¾ç¡¬ä»¶çš„å…¨éƒ¨æ½œåŠ›ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‘Šè¯‰`Parallel`ä½¿ç”¨æ‰€æœ‰æ ¸å¿ƒï¼ˆ-1ï¼‰ï¼Œè®¡ç®—é€Ÿåº¦**æé«˜äº† 5 å€ï¼š**

[PRE30]

## å•å…ƒæµ‹è¯• ETL ç®¡é“

åœ¨æˆ‘æ•´ä¸ªæ•°æ®å·¥ç¨‹å¸ˆèŒä¸šç”Ÿæ¶¯ä¸­ï¼Œæˆ‘å­¦åˆ°çš„æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½å¿…é¡»è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚è¿™ä¸ä»…åŒ…æ‹¬**SQL**ï¼Œè¿˜åŒ…æ‹¬**ETL ä½œä¸š**å’Œä¸æˆ‘ä»¬æ•°æ®ç®¡é“ä¸­ä½¿ç”¨çš„å…¶ä»–æœåŠ¡çš„**é›†æˆ**ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`unittest` Python åº“æ¥æµ‹è¯•æˆ‘ä»¬çš„ä»£ç ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŠ©æ‰‹æ¨¡å—ï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯ç´ æ•°ï¼š

[PRE31]

> æˆ‘ä»¬å¦‚ä½•æµ‹è¯•è¿™ä¸ªå‡½æ•°å†…éƒ¨çš„é€»è¾‘ï¼Ÿ

`unittest`ä½¿è¿™ä¸€åˆ‡å˜å¾—éå¸¸ç®€å•ï¼š

[PRE32]

ç°åœ¨å¦‚æœæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œè¿™ä¸ªï¼Œæˆ‘ä»¬å°†æµ‹è¯•é€»è¾‘ï¼š

[PRE33]

è¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸º13æ˜¯ä¸€ä¸ªç´ æ•°ã€‚è®©æˆ‘ä»¬è¿›ä¸€æ­¥æµ‹è¯•ä¸€ä¸‹ã€‚æˆ‘ä»¬çŸ¥é“4ä¸æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›é’ˆå¯¹è¿™ä¸ªç‰¹å®šå‡½æ•°çš„å•å…ƒæµ‹è¯•åœ¨æ–­è¨€ä¸º False æ—¶è¿”å›é€šè¿‡ï¼š

[PRE34]

[PRE35]

å¾ˆç®€å•ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´é«˜çº§çš„ç¤ºä¾‹ã€‚

> è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª ETL æœåŠ¡ï¼Œä»æŸä¸ª API ä¸­æå–æ•°æ®ï¼Œè¿™éœ€è¦å¾ˆå¤šæ—¶é—´ã€‚ç„¶åæˆ‘ä»¬çš„æœåŠ¡å°†è½¬æ¢è¿™ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬å¸Œæœ›æµ‹è¯•è¿™ä¸ª ETL è½¬æ¢é€»è¾‘æ˜¯å¦æŒç»­å­˜åœ¨ã€‚
> 
> æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`unittest`åº“ä¸­çš„ mock å’Œ patch æ–¹æ³•ã€‚è€ƒè™‘è¿™ä¸ªåº”ç”¨ç¨‹åºæ–‡ä»¶`asteroids.py`

[PRE36]

å¦‚æœæˆ‘ä»¬è¿è¡Œ app.pyï¼Œè¾“å‡ºå°†ä¼šæ˜¯åˆ—å‡ºåœ¨ç‰¹å®šæ—¥æœŸæ¥è¿‘åœ°çƒçš„å°è¡Œæ˜Ÿï¼š

[PRE37]

ä» API ä¸­æå–æ•°æ®å¯èƒ½éœ€è¦å¾ˆå¤šæ—¶é—´ï¼Œä½†æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•è¿è¡Œå¾—æ›´å¿«ã€‚æˆ‘ä»¬å¯ä»¥**æ¨¡æ‹Ÿ**ä¸€äº›å‡çš„ API å“åº”åˆ°æˆ‘ä»¬çš„`get_data()`å‡½æ•°ä¸­ï¼Œç„¶åä½¿ç”¨å®ƒæ¥æµ‹è¯• `save_data()`å‡½æ•°ä¸­çš„ ETL é€»è¾‘ï¼š

[PRE38]

è¾“å‡ºå°†æ˜¯ï¼š

[PRE39]

åœ¨æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬æ›¿æ¢äº†ï¼ˆä½¿ç”¨`mock`ï¼‰`asteroids.get_data`å‡½æ•°è¿”å›çš„å€¼ï¼Œå¹¶æœŸæœ›å®ƒä»¬è¢«è½¬æ¢ä¸ºï¼ˆETLï¼‰`['asteroid_1', 'asteroid_2']`ï¼Œè€Œæˆ‘ä»¬çš„ ETL å‡½æ•°æœªèƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚å•å…ƒæµ‹è¯•å¤±è´¥äº†ã€‚

> å•å…ƒæµ‹è¯•æ˜¯éå¸¸å¼ºå¤§çš„ã€‚

å®ƒå¸®åŠ©æˆ‘ä»¬å¤„ç†åœ¨ ETL ç®¡é“ä¸­éƒ¨ç½²æ–°åŠŸèƒ½æ—¶çš„äººä¸ºé”™è¯¯ã€‚æ›´å¤šé«˜çº§ç¤ºä¾‹å¯ä»¥åœ¨æˆ‘ä¹‹å‰çš„æ•…äº‹ä¸­æ‰¾åˆ°ã€‚æˆ‘åœ¨ CI/CD ç®¡é“ä¸­éå¸¸é¢‘ç¹åœ°ä½¿ç”¨å®ƒ [6]ï¼š

[](/test-data-pipelines-the-fun-and-easy-way-d0f974a93a59?source=post_page-----f3d5db59b6dd--------------------------------) [## ä»¥æœ‰è¶£å’Œç®€å•çš„æ–¹å¼æµ‹è¯•æ•°æ®ç®¡é“

### åˆå­¦è€…æŒ‡å—ï¼šä¸ºä»€ä¹ˆå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•å¯¹ä½ çš„æ•°æ®å¹³å°å¦‚æ­¤é‡è¦

[towardsdatascience.com](/test-data-pipelines-the-fun-and-easy-way-d0f974a93a59?source=post_page-----f3d5db59b6dd--------------------------------)

## ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

æˆ‘ç»å¸¸ä½¿ç”¨æ— æœåŠ¡å™¨éƒ¨ç½² ETL å¾®æœåŠ¡ã€‚è¿™æ˜¯ä¸€ç§éå¸¸æ•´æ´ä¸”å…·æœ‰æˆæœ¬æ•ˆç›Šçš„å·¥å…·ã€‚æˆ‘éƒ¨ç½² Lambdas å’Œ Cloud Functionsï¼Œä¸å¸Œæœ›å®ƒä»¬å› å†…å­˜è¿‡å¤šè€Œè¢«è¿‡åº¦é…ç½®ã€‚

æˆ‘ä¹‹å‰åœ¨è¿™é‡Œå†™è¿‡ï¼š

[## åˆå­¦è€…çš„åŸºç¡€è®¾æ–½å³ä»£ç ](https://levelup.gitconnected.com/infrastructure-as-code-for-beginners-a4e36c805316?source=post_page-----f3d5db59b6dd--------------------------------)

### ä½¿ç”¨è¿™äº›æ¨¡æ¿åƒä¸“ä¸šäººå£«ä¸€æ ·éƒ¨ç½²æ•°æ®ç®¡é“

[levelup.gitconnected.com](https://levelup.gitconnected.com/infrastructure-as-code-for-beginners-a4e36c805316?source=post_page-----f3d5db59b6dd--------------------------------)

> ç¡®å®ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ç»™æˆ‘ä»¬çš„ Lambda é…ç½® 3Gb çš„å†…å­˜å¹¶æ”¯ä»˜æ›´å¤šè´¹ç”¨ï¼Œè€Œæ•°æ®å¯ä»¥åœ¨ 256Mb çš„å†…å­˜ä¸­å¤„ç†ï¼Ÿ

æœ‰å¤šç§æ–¹æ³•å¯ä»¥ç›‘æ§æˆ‘ä»¬çš„ ETL åº”ç”¨ç¨‹åºå†…å­˜ä½¿ç”¨æƒ…å†µã€‚å…¶ä¸­ä¸€ç§æœ€å—æ¬¢è¿çš„æ–¹æ³•æ˜¯`tracemalloc` [7]åº“ã€‚

å®ƒå¯ä»¥è·Ÿè¸ª Python å†…å­˜å—ï¼Œå¹¶ä»¥ï¼ˆ<current>, <peak memory>ï¼‰å­—èŠ‚æ ¼å¼è¿”å›ç»“æœã€‚è€ƒè™‘è¿™ä¸ªä¾‹å­ï¼Œä»å°è¡Œæ˜Ÿ API ä¸­æå–æ•°æ®åˆ°ä¸€ä¸ªå¤§å—ä¸­å¹¶ä¿å­˜åˆ°ç£ç›˜ï¼š

[PRE40]

è¾“å‡ºå°†æ˜¯ï¼š

[PRE41]

> **æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å³°å€¼ä½¿ç”¨é‡çº¦ä¸º 540Kbã€‚**

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€šè¿‡ä½¿ç”¨`stream`æ¥è¿›è¡Œç®€å•çš„ä¼˜åŒ–ï¼š

[PRE42]

[PRE43]

**æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å³°å€¼å†…å­˜ä½¿ç”¨é‡å‡å°‘äº†ä¸€åŠã€‚**

## ä½¿ç”¨ SDK

ä½œä¸ºæ•°æ®å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä¸äº‘æœåŠ¡æä¾›å•†é¢‘ç¹åˆä½œã€‚ç®€è€Œè¨€ä¹‹ï¼ŒSDK æ˜¯ä¸€ç»„æœåŠ¡åº“ï¼Œå…è®¸ä»¥ç¼–ç¨‹æ–¹å¼è®¿é—®äº‘æœåŠ¡ã€‚æˆ‘ä»¬å¸Œæœ›å­¦ä¹ å¹¶æŒæ¡å¸‚åœºé¢†å¯¼è€…å¦‚ Amazonã€Azure æˆ– Google çš„ä¸€ä¸¤ä¸ª SDKã€‚

æˆ‘ç»å¸¸ä»¥ç¼–ç¨‹æ–¹å¼è®¿é—®çš„æœåŠ¡ä¹‹ä¸€æ˜¯ Cloud Storageã€‚å®é™…ä¸Šï¼Œåœ¨æ•°æ®å·¥ç¨‹ä¸­ï¼Œå‡ ä¹æ¯ä¸ªæ•°æ®ç®¡é“éƒ½ä¾èµ–äºäº‘ä¸­çš„æ•°æ®å­˜å‚¨ï¼Œå³ Google Cloud Storage æˆ– AWS S3ã€‚

æœ€å¸¸è§çš„æ•°æ®ç®¡é“è®¾è®¡æ˜¯å›´ç»•æ•°æ®å­˜å‚¨æ¡¶åˆ›å»ºçš„ã€‚æˆ‘åœ¨ä¹‹å‰çš„æ•…äº‹ä¸­æè¿°äº†è¿™ä¸€æ¨¡å¼ [9]ã€‚

[](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----f3d5db59b6dd--------------------------------) [## æ•°æ®ç®¡é“è®¾è®¡æ¨¡å¼

### é€‰æ‹©åˆé€‚çš„æ¶æ„åŠç¤ºä¾‹

[towardsdatascience.com](/data-pipeline-design-patterns-100afa4b93e3?source=post_page-----f3d5db59b6dd--------------------------------)

åœ¨äº‘å­˜å‚¨ä¸­åˆ›å»ºçš„å¯¹è±¡å¯ä»¥è§¦å‘å…¶ä»– ETL æœåŠ¡ã€‚è¿™åœ¨ä½¿ç”¨è¿™äº›äº‹ä»¶ç¼–æ’æ•°æ®ç®¡é“æ—¶å˜å¾—éå¸¸æœ‰ç”¨ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨ç”¨ä½œæ•°æ®å¹³å°çš„æ•°æ®æ¹–çš„äº‘å­˜å‚¨ä¸­è¯»å–å’Œå†™å…¥æ•°æ®ã€‚

![](../Images/851620512cf55064bfb03114e16ea2ab.png)

å…¸å‹çš„æ•°æ®ç®¡é“ã€‚ä½œè€…æä¾›çš„å›¾åƒ

åœ¨è¿™ä¸ªå›¾ç¤ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é¦–å…ˆå°†æ•°æ®æå–å¹¶ä¿å­˜åˆ°æ•°æ®æ¹–å­˜å‚¨æ¡¶ä¸­ã€‚ç„¶åï¼Œå®ƒå°†è§¦å‘æ•°æ®ä»“åº“çš„æ•°æ®æ‘„å–ï¼Œå¹¶å°†æ•°æ®åŠ è½½åˆ°æˆ‘ä»¬çš„è¡¨ä¸­ï¼Œä»¥ä¾¿ä½¿ç”¨å•†ä¸šæ™ºèƒ½ï¼ˆBIï¼‰å·¥å…·è¿›è¡Œ OLAP åˆ†æã€‚

ä¸‹é¢çš„ä»£ç ç‰‡æ®µè§£é‡Šäº†å¦‚ä½•ä½¿ç”¨ AWS SDK ä»¥æµçš„å½¢å¼ä¿å­˜æ•°æ®ã€‚

[PRE44]

åœ¨ä½ çš„å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥ä» NASA API æå–å°è¡Œæ˜Ÿæ•°æ®ï¼š

[PRE45]

## ç»“è®º

è¿™ä¸ªæ•…äº‹æ€»ç»“äº†æˆ‘åœ¨ ETL æœåŠ¡ä¸­å‡ ä¹æ¯å¤©ä½¿ç”¨çš„ Python ä»£ç æŠ€æœ¯ã€‚æˆ‘å¸Œæœ›ä½ ä¹Ÿèƒ½å‘ç°å®ƒæœ‰ç”¨ã€‚å®ƒæœ‰åŠ©äºä¿æŒä»£ç çš„æ•´æ´ï¼Œå¹¶é«˜æ•ˆåœ°æ‰§è¡Œæ•°æ®ç®¡é“è½¬æ¢ã€‚æ— æœåŠ¡å™¨åº”ç”¨æ¨¡å‹æ˜¯ä¸€ä¸ªéå¸¸å…·æœ‰æˆæœ¬æ•ˆç›Šçš„æ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­éƒ¨ç½²å‡ ä¹ä¸èŠ±è´¹ä»»ä½•è´¹ç”¨çš„ ETL å¾®æœåŠ¡ã€‚æˆ‘ä»¬åªéœ€è¦ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œå¹¶ä»¥åŸå­æ–¹å¼éƒ¨ç½²å®ƒä»¬ï¼Œä»¥ä¾¿å®ƒä»¬è¿è¡Œå¾—æ›´å¿«ã€‚å®ƒå‡ ä¹å¯ä»¥å¤„ç†æˆ‘ä»¬æ•°æ®å¹³å°ä¸­çš„ä»»ä½•ç±»å‹çš„æ•°æ®ç®¡é“ã€‚åœ¨æˆ‘ä¹‹å‰çš„æ•…äº‹ä¸­å¯ä»¥æ‰¾åˆ°è¿™äº›æ¶æ„ç±»å‹å’Œè®¾è®¡æ¨¡å¼çš„è‰¯å¥½æ€»ç»“ã€‚

[](/data-platform-architecture-types-f255ac6e0b7?source=post_page-----f3d5db59b6dd--------------------------------) [## æ•°æ®å¹³å°æ¶æ„ç±»å‹

### å®ƒåœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ»¡è¶³ä½ çš„ä¸šåŠ¡éœ€æ±‚ï¼Ÿé€‰æ‹©çš„å›°å¢ƒã€‚

[towardsdatascience.com](/data-platform-architecture-types-f255ac6e0b7?source=post_page-----f3d5db59b6dd--------------------------------)

ç†è§£åŸºæœ¬çš„ HTTP æ–¹æ³•åœ¨æ•°æ®å·¥ç¨‹ä¸­è‡³å…³é‡è¦ï¼Œå®ƒæœ‰åŠ©äºä¸ºæˆ‘ä»¬çš„æ•°æ®ç®¡é“åˆ›å»ºç¨³å¥çš„ API äº¤äº’ã€‚ä½¿ç”¨`joblib`å¯¹æˆ‘ä»¬çš„å‡½æ•°å’Œæ¨¡å‹è¿›è¡Œç®¡é“åŒ–å¯ä»¥ç¼–å†™å¿«é€Ÿé«˜æ•ˆçš„ä»£ç ã€‚é€šè¿‡æµçš„æ–¹å¼ä» API æ‹‰å–æ•°æ®ï¼Œå¹¶ä»¥å†…å­˜é«˜æ•ˆçš„æ–¹å¼è¿è¡Œ ETL ä»»åŠ¡ï¼Œå¯ä»¥é˜²æ­¢èµ„æºè¿‡åº¦åˆ†é…ï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬çš„æ•°æ®æœåŠ¡ä¸ä¼šè€—å°½å†…å­˜ã€‚å¯ä»¥ä½¿ç”¨ CI/CD å·¥å…·æŒç»­è¿è¡Œå•å…ƒæµ‹è¯•ï¼Œè¿™æœ‰åŠ©äºåœ¨æˆ‘ä»¬çš„ä»£ç æ›´æ”¹è¾¾åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼ŒåŠæ—©å‘ç°é”™è¯¯å’Œäººä¸ºå¤±è¯¯ã€‚å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚

## æ¨èé˜…è¯»ï¼š

[1] [https://stackoverflow.com/questions/519633/lazy-method-for-reading-big-file-in-python](https://stackoverflow.com/questions/519633/lazy-method-for-reading-big-file-in-python)

[2] [https://docs.python.org/3/library/functions.html#property](https://docs.python.org/3/library/functions.html#property)

[3] [https://stackoverflow.com/questions/60343944/how-does-requests-stream-true-option-streams-data-one-block-at-a-time](https://stackoverflow.com/questions/60343944/how-does-requests-stream-true-option-streams-data-one-block-at-a-time)

[4] [https://cloud.google.com/dataform/reference/rest/v1beta1/projects.locations.repositories.workflowConfigs/create](https://cloud.google.com/dataform/reference/rest/v1beta1/projects.locations.repositories.workflowConfigs/create)

[5] [https://joblib.readthedocs.io/en/stable/persistence.html#persistence](https://joblib.readthedocs.io/en/stable/persistence.html#persistence)

[6] [https://medium.com/towards-data-science/test-data-pipelines-the-fun-and-easy-way-d0f974a93a59](https://medium.com/towards-data-science/test-data-pipelines-the-fun-and-easy-way-d0f974a93a59)

[7] [https://docs.python.org/3/library/tracemalloc.html](https://docs.python.org/3/library/tracemalloc.html)

[8] [https://levelup.gitconnected.com/infrastructure-as-code-for-beginners-a4e36c805316](https://levelup.gitconnected.com/infrastructure-as-code-for-beginners-a4e36c805316)

[9] [https://medium.com/towards-data-science/data-pipeline-design-patterns-100afa4b93e3](https://medium.com/towards-data-science/data-pipeline-design-patterns-100afa4b93e3)

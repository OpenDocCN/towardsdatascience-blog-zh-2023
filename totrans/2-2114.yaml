- en: 'TimesNet: The Latest Advance in Time Series Forecasting'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: TimesNetï¼šæ—¶é—´åºåˆ—é¢„æµ‹çš„æœ€æ–°è¿›å±•
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/timesnet-the-latest-advance-in-time-series-forecasting-745b69068c9c](https://towardsdatascience.com/timesnet-the-latest-advance-in-time-series-forecasting-745b69068c9c)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/timesnet-the-latest-advance-in-time-series-forecasting-745b69068c9c](https://towardsdatascience.com/timesnet-the-latest-advance-in-time-series-forecasting-745b69068c9c)
- en: Understand the TimesNet architecture and apply it on a forecasting task with
    Python
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: äº†è§£TimesNetæ¶æ„ï¼Œå¹¶ä½¿ç”¨Pythonåº”ç”¨äºé¢„æµ‹ä»»åŠ¡
- en: '[](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)[![Marco
    Peixeiro](../Images/7cf0a81d87281d35ff47f51e3026a3e9.png)](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)
    [Marco Peixeiro](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)[![Marco
    Peixeiro](../Images/7cf0a81d87281d35ff47f51e3026a3e9.png)](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)
    [Marco Peixeiro](https://medium.com/@marcopeixeiro?source=post_page-----745b69068c9c--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)
    Â·10 min readÂ·Oct 10, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page-----745b69068c9c--------------------------------)
    Â·10åˆ†é’Ÿé˜…è¯»Â·2023å¹´10æœˆ10æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/9a499aed5a781591ea06eef5f3cb4222.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9a499aed5a781591ea06eef5f3cb4222.png)'
- en: Photo by [Rachel Hisko](https://unsplash.com/@rachelhisko?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±[Rachel Hisko](https://unsplash.com/@rachelhisko?utm_source=medium&utm_medium=referral)æä¾›ï¼Œæ¥æºäº[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: In previous articles, we have explored the latest advances in state-of-the-art
    forecasting techniques, starting with [N-BEATS](https://medium.com/towards-data-science/the-easiest-way-to-forecast-time-series-using-n-beats-d778fcc2ba60)
    released in 2020, [N-HiTS](https://medium.com/towards-data-science/all-about-n-hits-the-latest-breakthrough-in-time-series-forecasting-a8ddcb27b0d5)
    in 2022, and [PatchTST](https://medium.com/towards-data-science/patchtst-a-breakthrough-in-time-series-forecasting-e02d48869ccc)
    in March 2023\. Recall that N-BEATS and N-HiTS rely on the multilayer perceptron
    architecture, while PatchTST leverages the Transformer architecture.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†æœ€æ–°çš„æœ€å…ˆè¿›é¢„æµ‹æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯2020å¹´å‘å¸ƒçš„[N-BEATS](https://medium.com/towards-data-science/the-easiest-way-to-forecast-time-series-using-n-beats-d778fcc2ba60)ã€2022å¹´çš„[N-HiTS](https://medium.com/towards-data-science/all-about-n-hits-the-latest-breakthrough-in-time-series-forecasting-a8ddcb27b0d5)ä»¥åŠ2023å¹´3æœˆçš„[PatchTST](https://medium.com/towards-data-science/patchtst-a-breakthrough-in-time-series-forecasting-e02d48869ccc)ã€‚è¯·æ³¨æ„ï¼ŒN-BEATSå’ŒN-HiTSä¾èµ–äºå¤šå±‚æ„ŸçŸ¥æœºæ¶æ„ï¼Œè€ŒPatchTSTåˆ™åˆ©ç”¨äº†Transformeræ¶æ„ã€‚
- en: 'As of April 2023, a new model was published in the literature, and it achieves
    state-of-the-art results across multiple tasks in time series analysis, like forecasting,
    imputation, classification and anomaly detection: **TimesNet**.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æˆªè‡³2023å¹´4æœˆï¼Œæ–‡çŒ®ä¸­å‘å¸ƒäº†ä¸€ç§æ–°æ¨¡å‹ï¼Œå®ƒåœ¨æ—¶é—´åºåˆ—åˆ†æçš„å¤šä¸ªä»»åŠ¡ä¸­å®ç°äº†æœ€å…ˆè¿›çš„ç»“æœï¼Œå¦‚é¢„æµ‹ã€å¡«è¡¥ã€åˆ†ç±»å’Œå¼‚å¸¸æ£€æµ‹ï¼š**TimesNet**ã€‚
- en: 'TimesNet was proposed by Wu, Hu, Liu et al in their paper: [TimesNet: Temporal
    2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf).'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: TimesNetç”±å´ã€èƒ¡ã€åˆ˜ç­‰äººåœ¨ä»–ä»¬çš„è®ºæ–‡ä¸­æå‡ºï¼š[TimesNetï¼šæ—¶é—´åºåˆ—åˆ†æçš„æ—¶é—´2D-å˜å¼‚å»ºæ¨¡](https://browse.arxiv.org/pdf/2210.02186.pdf)ã€‚
- en: Unlike previous models, it uses a CNN-based architecture to achieve state-of-the-art
    results across different tasks, making it a great candidate for a foundation model
    for time series analysis.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ä¹‹å‰çš„æ¨¡å‹ä¸åŒï¼Œå®ƒä½¿ç”¨åŸºäºCNNçš„æ¶æ„ï¼Œåœ¨ä¸åŒä»»åŠ¡ä¸­å®ç°äº†æœ€å…ˆè¿›çš„ç»“æœï¼Œä½¿å…¶æˆä¸ºæ—¶é—´åºåˆ—åˆ†æçš„åŸºç¡€æ¨¡å‹çš„ä¼˜ç§€å€™é€‰è€…ã€‚
- en: In this article, we explore the architecture and inner workings of TimesNet.
    Then, we apply the model in a forecasting task, alongside N-BEATS and N-HiTS to
    complete our own little experiment.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†TimesNetçš„æ¶æ„å’Œå†…éƒ¨å·¥ä½œåŸç†ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†æ¨¡å‹åº”ç”¨äºé¢„æµ‹ä»»åŠ¡ï¼Œå¹¶ä¸N-BEATSå’ŒN-HiTSä¸€èµ·å®Œæˆæˆ‘ä»¬çš„å°å®éªŒã€‚
- en: As always, for more details, refer to the [original paper](https://browse.arxiv.org/pdf/2210.02186.pdf).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€å¦‚æ—¢å¾€ï¼Œæ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…[åŸå§‹è®ºæ–‡](https://browse.arxiv.org/pdf/2210.02186.pdf)ã€‚
- en: '**Learn the latest time series analysis techniques with my** [**free time series
    cheat sheet**](https://www.datasciencewithmarco.com/pl/2147608294) **in Python!
    Get the implementation of statistical and deep learning techniques, all in Python
    and TensorFlow!**'
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**ä½¿ç”¨æˆ‘çš„** [**å…è´¹æ—¶é—´åºåˆ—å¤‡å¿˜å•**](https://www.datasciencewithmarco.com/pl/2147608294)
    **åœ¨Pythonä¸­å­¦ä¹ æœ€æ–°çš„æ—¶é—´åºåˆ—åˆ†ææŠ€æœ¯ï¼è·å–ç»Ÿè®¡å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å®ç°ï¼Œå…¨éƒ¨åœ¨Pythonå’ŒTensorFlowä¸­ï¼**'
- en: Letâ€™s get started!
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¼€å§‹å§ï¼
- en: Explore TimesNet
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¢ç´¢TimesNet
- en: The motivation behind TimesNet comes from the realization that many real-life
    time series exhibit *mutli-periodicity*. This means that variations occur at different
    periods.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: TimesNetçš„åŠ¨æœºæ¥è‡ªäºæ„è¯†åˆ°è®¸å¤šç°å®ç”Ÿæ´»ä¸­çš„æ—¶é—´åºåˆ—å±•ç¤ºäº†*å¤šå‘¨æœŸæ€§*ã€‚è¿™æ„å‘³ç€åœ¨ä¸åŒçš„å‘¨æœŸä¸­ä¼šå‘ç”Ÿå˜åŒ–ã€‚
- en: For example, temperature outside has both a daily and a yearly period. Usually,
    it is hotter during the day than at night, and hotter during summer than in winter.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå¤–éƒ¨æ¸©åº¦æ—¢æœ‰æ—¥å‘¨æœŸä¹Ÿæœ‰å¹´å‘¨æœŸã€‚é€šå¸¸ï¼Œç™½å¤©æ¯”å¤œæ™šçƒ­ï¼Œå¤å¤©æ¯”å†¬å¤©çƒ­ã€‚
- en: Now, those multiple periods overlap and interact with each other, making it
    difficult to separate and model individually.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè¿™äº›å¤šä¸ªå‘¨æœŸç›¸äº’é‡å å¹¶ç›¸äº’ä½œç”¨ï¼Œä½¿å¾—å•ç‹¬åˆ†ç¦»å’Œå»ºæ¨¡å˜å¾—å›°éš¾ã€‚
- en: So, the authors of TimesNet propose to reshape the series in a 2D space to model
    *intraperiod-variation* and *interperiod-variation*.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼ŒTimesNetçš„ä½œè€…å»ºè®®å°†åºåˆ—é‡å¡‘ä¸ºäºŒç»´ç©ºé—´ï¼Œä»¥å»ºæ¨¡*å‘¨æœŸå†…å˜åŒ–*å’Œ*å‘¨æœŸé—´å˜åŒ–*ã€‚
- en: Going back to our weather example, intraperiod-variation would be how the temperature
    varies within a day, and interperiod-variation would be how the temperature varies
    from day to day, or from year to year.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: å›åˆ°æˆ‘ä»¬çš„å¤©æ°”ç¤ºä¾‹ï¼Œå‘¨æœŸå†…å˜åŒ–å°†æ˜¯æ¸©åº¦åœ¨ä¸€å¤©å†…çš„å˜åŒ–ï¼Œè€Œå‘¨æœŸé—´å˜åŒ–å°†æ˜¯æ¸©åº¦ä»ä¸€å¤©åˆ°å¦ä¸€æ—¥ï¼Œæˆ–ä»ä¸€å¹´åˆ°å¦ä¸€å¹´çš„å˜åŒ–ã€‚
- en: With all that in mind, letâ€™s dive into the modelâ€™s architecture.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: ç‰¢è®°è¿™äº›ï¼Œè®©æˆ‘ä»¬æ·±å…¥æ¢è®¨æ¨¡å‹çš„æ¶æ„ã€‚
- en: The architecture of TimesNet
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: TimesNetçš„æ¶æ„
- en: Letâ€™s take a look at the architecture of TimesNet.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹TimesNetçš„æ¶æ„ã€‚
- en: '![](../Images/fddcabd04aad86837a21d001fb1f9e41.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fddcabd04aad86837a21d001fb1f9e41.png)'
- en: 'Architecture of TimesNet. Image by Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou,
    Jianmin Wang and Mingsheng Long from [TimesNet: Temporal 2D-Variation Modeling
    For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 'TimesNetçš„æ¶æ„ã€‚å›¾åƒç”±Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wangå’ŒMingsheng
    Longæä¾›ï¼Œæ¥è‡ª[TimesNet: Temporal 2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
- en: From the figure above, we can see that TimesNet is a stack of multiple *TimesBlock*
    with residual connections.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ä¸Šé¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°TimesNetæ˜¯ç”±å¤šä¸ª*TimesBlock*å †å è€Œæˆï¼Œå¹¶å…·æœ‰æ®‹å·®è¿æ¥ã€‚
- en: In each TimesBlock, we can see that the series first goes through a fast Fourier
    transform (FTT) to find the different periods in the data. Then, it is reshaped
    as a 2D vector and sent to an Inception block where it learns and predicts a 2D
    representation of the series. Then, this deep representation must be reshaped
    back to a 1-dimensional vector using *adaptive aggregation*.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¯ä¸ªTimesBlockä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åºåˆ—é¦–å…ˆç»è¿‡å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFTTï¼‰ä»¥æ‰¾åˆ°æ•°æ®ä¸­çš„ä¸åŒå‘¨æœŸã€‚ç„¶åï¼Œå°†å…¶é‡å¡‘ä¸ºäºŒç»´å‘é‡å¹¶å‘é€åˆ°Inceptionå—ï¼Œåœ¨é‚£é‡Œå®ƒå­¦ä¹ å’Œé¢„æµ‹åºåˆ—çš„äºŒç»´è¡¨ç¤ºã€‚ç„¶åï¼Œè¿™ç§æ·±åº¦è¡¨ç¤ºå¿…é¡»é€šè¿‡*è‡ªé€‚åº”èšåˆ*é‡æ–°å˜å½¢å›ä¸€ç»´å‘é‡ã€‚
- en: There is a lot to understand here, so letâ€™s cover each step in more detail.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæœ‰å¾ˆå¤šå†…å®¹éœ€è¦äº†è§£ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°ä»‹ç»æ¯ä¸ªæ­¥éª¤ã€‚
- en: Capture multi-periodicity
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ•æ‰å¤šå‘¨æœŸæ€§
- en: To capture the variations across multiple periods in time series, the authors
    suggest to transform the 1-dimensional series into a 2-dimensional space to simultaneously
    model intraperiod and interperiod variations.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ•æ‰æ—¶é—´åºåˆ—ä¸­å¤šä¸ªå‘¨æœŸçš„å˜åŒ–ï¼Œä½œè€…å»ºè®®å°†ä¸€ç»´åºåˆ—è½¬æ¢ä¸ºäºŒç»´ç©ºé—´ï¼Œä»¥åŒæ—¶å»ºæ¨¡å‘¨æœŸå†…å˜åŒ–å’Œå‘¨æœŸé—´å˜åŒ–ã€‚
- en: '![](../Images/0eaa094828efbb858b774d945b1e3cda.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0eaa094828efbb858b774d945b1e3cda.png)'
- en: 'Architecture of TimesNet. Image by Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou,
    Jianmin Wang and Mingsheng Long from [TimesNet: Temporal 2D-Variation Modeling
    For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 'TimesNetçš„æ¶æ„ã€‚å›¾åƒç”±Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wangå’ŒMingsheng
    Longæä¾›ï¼Œæ¥è‡ª[TimesNet: Temporal 2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
- en: In the figure above, we can see the how the model represents the variations
    in a 2D space. Inside the red rectangles, we can see the intraperiod-variation,
    which is how the data changes inside a period. Then, the blue rectangle contains
    the interperiod-variation, which is how the data changes from period to period.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸Šé¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å‹å¦‚ä½•åœ¨äºŒç»´ç©ºé—´ä¸­è¡¨ç¤ºå˜åŒ–ã€‚åœ¨çº¢è‰²çŸ©å½¢å†…ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‘¨æœŸå†…å˜åŒ–ï¼Œå³æ•°æ®åœ¨ä¸€ä¸ªå‘¨æœŸå†…çš„å˜åŒ–ã€‚ç„¶åï¼Œè“è‰²çŸ©å½¢åŒ…å«å‘¨æœŸé—´å˜åŒ–ï¼Œå³æ•°æ®ä»ä¸€ä¸ªå‘¨æœŸåˆ°å¦ä¸€ä¸ªå‘¨æœŸçš„å˜åŒ–ã€‚
- en: To better understand that, suppose that we have daily data with a weekly period.
    The interperiod-variation is how the data changes from Monday, to Tuesday, to
    Wednesday, and so on.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰å¸¦æœ‰å‘¨å‘¨æœŸçš„æ—¥æ•°æ®ã€‚å‘¨æœŸé—´å˜åŒ–æŒ‡çš„æ˜¯æ•°æ®ä»å‘¨ä¸€åˆ°å‘¨äºŒï¼Œå†åˆ°å‘¨ä¸‰ç­‰çš„å˜åŒ–æƒ…å†µã€‚
- en: Then, the interperiod-variation would be how the data varies from Monday in
    week 1, to Monday in week 2, and from Tuesday in week 1, to Tuesday in week 2\.
    In other words, it is the variation of data in the same *phase* at different periods.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œå‘¨æœŸé—´å˜åŒ–æŒ‡çš„æ˜¯æ•°æ®å¦‚ä½•ä»ç¬¬1å‘¨çš„å‘¨ä¸€å˜åŒ–åˆ°ç¬¬2å‘¨çš„å‘¨ä¸€ï¼Œä»ç¬¬1å‘¨çš„å‘¨äºŒå˜åŒ–åˆ°ç¬¬2å‘¨çš„å‘¨äºŒã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯åŒä¸€*ç›¸ä½*åœ¨ä¸åŒå‘¨æœŸä¸­çš„æ•°æ®å˜åŒ–ã€‚
- en: Those variations are then represented in a 2D space, where the interperiod-variation
    is vertical, and the intraperiod-variation is horizontal. This allows the model
    to learn a better representation of the variation in the data.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›å˜åŒ–éšåè¢«è¡¨ç¤ºåœ¨2Dç©ºé—´ä¸­ï¼Œå…¶ä¸­å‘¨æœŸé—´å˜åŒ–æ˜¯å‚ç›´çš„ï¼Œè€Œå‘¨æœŸå†…å˜åŒ–æ˜¯æ°´å¹³çš„ã€‚è¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ æ•°æ®å˜åŒ–çš„è¡¨ç¤ºã€‚
- en: Whereas a 1-dimensional vector shows variations between adjacent points, this
    2D representation shows variations between adjacent points and adjacent periods,
    giving a more complete picture of what is happening.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶ä¸€ç»´å‘é‡æ˜¾ç¤ºç›¸é‚»ç‚¹ä¹‹é—´çš„å˜åŒ–ï¼Œä½†è¿™ç§2Dè¡¨ç¤ºæ³•æ˜¾ç¤ºäº†ç›¸é‚»ç‚¹å’Œç›¸é‚»å‘¨æœŸä¹‹é—´çš„å˜åŒ–ï¼Œæä¾›äº†æ›´å®Œæ•´çš„æƒ…å†µã€‚
- en: 'Yet, one question remains: how do we find the periods in our series?'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œä»æœ‰ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°åºåˆ—ä¸­çš„å‘¨æœŸï¼Ÿ
- en: Identify the significant periods in your data
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç¡®å®šæ•°æ®ä¸­çš„æ˜¾è‘—å‘¨æœŸ
- en: To identify the multiple periods in time series, the model applied the Fast
    Fourier Transform (FTT).
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†è¯†åˆ«æ—¶é—´åºåˆ—ä¸­çš„å¤šä¸ªå‘¨æœŸï¼Œæ¨¡å‹åº”ç”¨äº†å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFTTï¼‰ã€‚
- en: This is a mathematical operation that transforms a signal into a function of
    frequency and amplitude.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ç§æ•°å­¦æ“ä½œï¼Œå°†ä¿¡å·è½¬æ¢ä¸ºé¢‘ç‡å’Œå¹…åº¦çš„å‡½æ•°ã€‚
- en: '![](../Images/01998c92d2637704def7ba8389662d71.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/01998c92d2637704def7ba8389662d71.png)'
- en: 'How the model applies FTT to find the top *k* significant periods in time series.
    Image by Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang and Mingsheng
    Long from [TimesNet: Temporal 2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 'æ¨¡å‹å¦‚ä½•åº”ç”¨FTTä»¥æ‰¾åˆ°æ—¶é—´åºåˆ—ä¸­çš„å‰*k*ä¸ªæ˜¾è‘—å‘¨æœŸã€‚å›¾ç‰‡ç”±Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin
    Wangå’ŒMingsheng Longæä¾›ï¼Œæ¥è‡ª[TimesNet: Temporal 2D-Variation Modeling For General
    Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
- en: In the figure above, the authors illustrate how FTT is applied. Once we have
    the frequency and amplitude of each period, the ones with the largest amplitudes
    are considered to be the most relevant.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šå›¾ä¸­ï¼Œä½œè€…å±•ç¤ºäº†FTTçš„åº”ç”¨æ–¹å¼ã€‚ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°äº†æ¯ä¸ªå‘¨æœŸçš„é¢‘ç‡å’Œå¹…åº¦ï¼Œå¹…åº¦æœ€å¤§çš„å‘¨æœŸè¢«è®¤ä¸ºæ˜¯æœ€ç›¸å…³çš„ã€‚
- en: For example, here is the result of performing FTT on the [Etth1 dataset](https://github.com/zhouhaoyi/ETDataset/blob/main/ETT-small/ETTh1.csv).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè¿™æ˜¯å¯¹[Etth1æ•°æ®é›†](https://github.com/zhouhaoyi/ETDataset/blob/main/ETT-small/ETTh1.csv)åº”ç”¨FTTçš„ç»“æœã€‚
- en: '![](../Images/8c6261f834ae9c8a3167775f64b93cd5.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8c6261f834ae9c8a3167775f64b93cd5.png)'
- en: Result of applying FTT on the Etth1 dataset. We can see that the daily and yearly
    periods are the most significant. Image by the author.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹Etth1æ•°æ®é›†åº”ç”¨FTTçš„ç»“æœã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ—¥å‘¨æœŸå’Œå¹´å‘¨æœŸæ˜¯æœ€æ˜¾è‘—çš„ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: In the figure above, the Fast Fourier Transform allows us to quickly identify
    a daily and yearly period in our data, since we see higher peaks of amplitude
    at those periods.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šå›¾ä¸­çš„å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ä½¿æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿè¯†åˆ«æ•°æ®ä¸­çš„æ—¥å‘¨æœŸå’Œå¹´å‘¨æœŸï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿™äº›å‘¨æœŸä¸Šçœ‹åˆ°æ›´é«˜çš„å¹…åº¦å³°å€¼ã€‚
- en: Once FTT is applied, the user can set a parameter *k* to select the top-*k*
    most important periods, which are the ones with the largest amplitude.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦åº”ç”¨FTTï¼Œç”¨æˆ·å¯ä»¥è®¾ç½®å‚æ•°*k*ä»¥é€‰æ‹©å‰-*k*ä¸ªæœ€é‡è¦çš„å‘¨æœŸï¼Œè¿™äº›å‘¨æœŸæ˜¯å¹…åº¦æœ€å¤§çš„ã€‚
- en: TimesNet then creates 2D vectors for each period, and those are sent to a 2D
    kernel to capture the temporal variations.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: TimesNetéšåä¸ºæ¯ä¸ªå‘¨æœŸåˆ›å»º2Då‘é‡ï¼Œå¹¶å°†å…¶å‘é€åˆ°2Då·ç§¯æ ¸ï¼Œä»¥æ•æ‰æ—¶é—´å˜åŒ–ã€‚
- en: Inside the TimesBlock
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åœ¨TimesBlockå†…éƒ¨
- en: Once the series has gone through the Fourier transform and 2D tensors were created
    for the top-*k* periods, the data is sent to the Inception block, as shown in
    the figure below.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦åºåˆ—ç»è¿‡å‚…é‡Œå¶å˜æ¢ï¼Œå¹¶ä¸ºå‰-*k*å‘¨æœŸåˆ›å»ºäº†2Då¼ é‡ï¼Œæ•°æ®å°†è¢«å‘é€åˆ°ä¸‹å›¾æ‰€ç¤ºçš„Inceptionæ¨¡å—ã€‚
- en: '![](../Images/fddcabd04aad86837a21d001fb1f9e41.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fddcabd04aad86837a21d001fb1f9e41.png)'
- en: 'Architecture of TimesNet. Image by Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou,
    Jianmin Wang and Mingsheng Long from [TimesNet: Temporal 2D-Variation Modeling
    For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 'TimesNetçš„æ¶æ„ã€‚å›¾ç‰‡ç”±Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wangå’ŒMingsheng
    Longæä¾›ï¼Œæ¥è‡ª[TimesNet: Temporal 2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
- en: Of course, note that all of the steps that we explored are carried out inside
    the TimesBlock.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œè¯·æ³¨æ„æˆ‘ä»¬æ¢ç´¢çš„æ‰€æœ‰æ­¥éª¤éƒ½æ˜¯åœ¨ TimesBlock å†…éƒ¨è¿›è¡Œçš„ã€‚
- en: Now, the 2D representation of the data is sent to the **Inception** block.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæ•°æ®çš„ 2D è¡¨ç¤ºè¢«é€å…¥**Inception**å—ã€‚
- en: The Inception module is the building block of the computer vision model [GoogLeNet](https://openaccess.thecvf.com/content_cvpr_2015/papers/Szegedy_Going_Deeper_With_2015_CVPR_paper.pdf),
    published in 2015.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Inception æ¨¡å—æ˜¯è®¡ç®—æœºè§†è§‰æ¨¡å‹[GoogLeNet](https://openaccess.thecvf.com/content_cvpr_2015/papers/Szegedy_Going_Deeper_With_2015_CVPR_paper.pdf)çš„æ„å»ºå—ï¼Œè¯¥æ¨¡å‹äº2015å¹´å‘å¸ƒã€‚
- en: The main idea of the Inception module is to have an efficient representation
    of the data by keeping it sparse. That way, we can technically increase the size
    of a neural network, while keeping it computationally efficient.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Inception æ¨¡å—çš„ä¸»è¦æ€æƒ³æ˜¯é€šè¿‡ä¿æŒæ•°æ®ç¨€ç–æ¥å®ç°é«˜æ•ˆè¡¨ç¤ºã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŠ€æœ¯ä¸Šå¢åŠ ç¥ç»ç½‘ç»œçš„å¤§å°ï¼ŒåŒæ—¶ä¿æŒè®¡ç®—æ•ˆç‡ã€‚
- en: This is achieved by performing various convolutions and pooling operations,
    and then concatenating everything. In the context of TimesNet, this is how the
    Inception module looks like.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯é€šè¿‡æ‰§è¡Œå„ç§å·ç§¯å’Œæ± åŒ–æ“ä½œå®ç°çš„ï¼Œç„¶åå°†æ‰€æœ‰å†…å®¹è¿æ¥åœ¨ä¸€èµ·ã€‚åœ¨ TimesNet çš„èƒŒæ™¯ä¸‹ï¼Œè¿™å°±æ˜¯ Inception æ¨¡å—çš„æ ·å­ã€‚
- en: '![](../Images/a4a7627cc60f293116401161f2e0beb8.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a4a7627cc60f293116401161f2e0beb8.png)'
- en: The Inception module in TimesNet. Image by the author.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: TimesNet ä¸­çš„ Inception æ¨¡å—ã€‚å›¾åƒç”±ä½œè€…æä¾›ã€‚
- en: You might wonder why the authors chose a vision model to treat time series data.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ä¸ºä»€ä¹ˆä½œè€…é€‰æ‹©äº†ä¸€ä¸ªè§†è§‰æ¨¡å‹æ¥å¤„ç†æ—¶é—´åºåˆ—æ•°æ®ã€‚
- en: A simple answer to that is that vision models are particularly good at parsing
    2D data, like images.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹è¿™ä¸ªé—®é¢˜çš„ç®€å•å›ç­”æ˜¯è§†è§‰æ¨¡å‹åœ¨è§£æ 2D æ•°æ®ï¼ˆå¦‚å›¾åƒï¼‰æ–¹é¢ç‰¹åˆ«æ“…é•¿ã€‚
- en: The other benefit is that the vision backbone can be changed inside TimesNet.
    While the authors use the Inception block, it can be changed to other vision model
    backbones, and so TimesNet can also benefit from the advances in computer vision.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥åœ¨ TimesNet å†…éƒ¨æ›´æ¢è§†è§‰éª¨å¹²ã€‚è™½ç„¶ä½œè€…ä½¿ç”¨äº† Inception å—ï¼Œä½†å¯ä»¥æ›´æ¢ä¸ºå…¶ä»–è§†è§‰æ¨¡å‹éª¨å¹²ï¼Œå› æ­¤ TimesNet ä¹Ÿå¯ä»¥ä»è®¡ç®—æœºè§†è§‰çš„è¿›å±•ä¸­å—ç›Šã€‚
- en: Now, one element that separates the Inception module in TimesNet from the inception
    module in GoogLeNet is the use of **adaptive aggregation**.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œå°† Inception æ¨¡å—ä» TimesNet ä¸ GoogLeNet ä¸­çš„ Inception æ¨¡å—åŒºåˆ†å¼€æ¥çš„ä¸€ä¸ªå…ƒç´ æ˜¯ä½¿ç”¨äº†**è‡ªé€‚åº”èšåˆ**ã€‚
- en: Adaptive aggregation
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‡ªé€‚åº”èšåˆ
- en: To perform aggregation, the 2D representation must be reshaped to 1D vectors
    first.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: è¦è¿›è¡Œèšåˆï¼Œå¿…é¡»å…ˆå°† 2D è¡¨ç¤ºé‡å¡‘ä¸º 1D å‘é‡ã€‚
- en: Then, adaptive aggregation is used, because different periods had different
    amplitudes, which indicates how important they are.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œä½¿ç”¨è‡ªé€‚åº”èšåˆï¼Œå› ä¸ºä¸åŒå‘¨æœŸçš„å¹…åº¦ä¸åŒï¼Œè¿™è¡¨æ˜å®ƒä»¬çš„é‡è¦æ€§ã€‚
- en: This is why the output of the FTT is also sent to a softmax layer, so that the
    aggregation is done using the relative important of each period.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ FTT çš„è¾“å‡ºä¹Ÿä¼šè¢«é€åˆ° softmax å±‚ï¼Œä»¥ä¾¿æ ¹æ®æ¯ä¸ªå‘¨æœŸçš„ç›¸å¯¹é‡è¦æ€§è¿›è¡Œèšåˆã€‚
- en: The aggregated data is the output of a single TimesBlock. Then, multiple TimesBlock
    are stacked with residual connections to create the TimesNet model.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: èšåˆæ•°æ®æ˜¯å•ä¸ª TimesBlock çš„è¾“å‡ºã€‚ç„¶åï¼Œå¤šä¸ª TimesBlock é€šè¿‡æ®‹å·®è¿æ¥å †å åœ¨ä¸€èµ·ï¼Œåˆ›å»º TimesNet æ¨¡å‹ã€‚
- en: Now that we understand how the TimesNet model works, letâ€™s test it on a forecasting
    task, alongside N-BEATS and N-HITS.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬äº†è§£äº† TimesNet æ¨¡å‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬åœ¨é¢„æµ‹ä»»åŠ¡ä¸­æµ‹è¯•å®ƒï¼Œå¹¶ä¸ N-BEATS å’Œ N-HITS è¿›è¡Œæ¯”è¾ƒã€‚
- en: Forecast with TimesNet
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ TimesNet è¿›è¡Œé¢„æµ‹
- en: Letâ€™s now apply the TimesNet model on a forecasting task, and compare its performance
    against N-BEATS and N-HiTS.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨é¢„æµ‹ä»»åŠ¡ä¸­åº”ç”¨ TimesNet æ¨¡å‹ï¼Œå¹¶ä¸ N-BEATS å’Œ N-HiTS çš„è¡¨ç°è¿›è¡Œæ¯”è¾ƒã€‚
- en: For this little experiment, we use the [Etth1 dataset](https://github.com/zhouhaoyi/ETDataset)
    released under the Creative Commons Attribution license.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºè¿™ä¸ªå°å®éªŒï¼Œæˆ‘ä»¬ä½¿ç”¨äº†[Etth1 æ•°æ®é›†](https://github.com/zhouhaoyi/ETDataset)ï¼Œè¯¥æ•°æ®é›†åœ¨åˆ›ä½œå…±ç”¨æˆæƒä¸‹å‘å¸ƒã€‚
- en: This is a popular benchmark for time series forecasting widely used in literature.
    It tracks the hourly oil temperature of an electricity transformer which reflects
    the condition of the equipment.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªåœ¨æ–‡çŒ®ä¸­å¹¿æ³›ä½¿ç”¨çš„æ—¶é—´åºåˆ—é¢„æµ‹çš„æµè¡ŒåŸºå‡†ã€‚å®ƒè·Ÿè¸ªç”µåŠ›å˜å‹å™¨çš„æ¯å°æ—¶æ²¹æ¸©ï¼Œåæ˜ äº†è®¾å¤‡çš„çŠ¶å†µã€‚
- en: You can access the dataset and the code on [GitHub](https://github.com/marcopeix/time-series-analysis).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥åœ¨[GitHub](https://github.com/marcopeix/time-series-analysis)ä¸Šè®¿é—®æ•°æ®é›†å’Œä»£ç ã€‚
- en: Import libraries and read the data
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯¼å…¥åº“å¹¶è¯»å–æ•°æ®
- en: We start off by importing the required libraries. Here, we use the implementation
    available in [NeuralForecast](https://nixtla.github.io/neuralforecast/) by Nixtla.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é¦–å…ˆå¯¼å…¥æ‰€éœ€çš„åº“ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Nixtla æä¾›çš„[NeuralForecast](https://nixtla.github.io/neuralforecast/)çš„å®ç°ã€‚
- en: '[PRE0]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Then, we can read our CSV file.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–æˆ‘ä»¬çš„ CSV æ–‡ä»¶ã€‚
- en: '[PRE1]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/485be680afc497d5d08c797437f1d4f4.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/485be680afc497d5d08c797437f1d4f4.png)'
- en: First five rows of the Etth1 dataset. Note that the dataset has already the
    format expected by neuralforecast. Image by the author.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Etth1æ•°æ®é›†çš„å‰äº”è¡Œã€‚æ³¨æ„æ•°æ®é›†å·²ç»å…·æœ‰neuralforecastæœŸæœ›çš„æ ¼å¼ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: 'In the figure above, note that the dataset already has the format expected
    by NeuralForecast. Basically, the package requires three columns:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸Šå›¾ä¸­ï¼Œè¯·æ³¨æ„æ•°æ®é›†å·²ç»å…·æœ‰NeuralForecastæœŸæœ›çš„æ ¼å¼ã€‚åŸºæœ¬ä¸Šï¼Œè¯¥åŒ…éœ€è¦ä¸‰åˆ—ï¼š
- en: a date column labelled as *ds*
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªæ ‡è®°ä¸º*ds*çš„æ—¥æœŸåˆ—
- en: an id column to label your series, labelled as *unique_id*
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªæ ‡è®°ä¸º*unique_id*çš„IDåˆ—æ¥æ ‡è®°ä½ çš„ç³»åˆ—
- en: a value column labelled as *y*
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªæ ‡è®°ä¸º*y*çš„å€¼åˆ—
- en: Then, we can plot our series.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶æˆ‘ä»¬çš„ç³»åˆ—ã€‚
- en: '[PRE2]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/da948d2b72d002b8f6c679986b30a4e3.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/da948d2b72d002b8f6c679986b30a4e3.png)'
- en: Visualizing the hourly oil temperature in the Etth1 dataset. Image by the author.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–Etth1æ•°æ®é›†ä¸­çš„æ¯å°æ—¶æ²¹æ¸©ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: Now, we can move on to forecasting.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›è¡Œé¢„æµ‹ã€‚
- en: Forecast
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹
- en: For our experiment, we use a forecasting horizon of 96 hours, which is a common
    horizon for long-term forecasting in the literature.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºæˆ‘ä»¬çš„å®éªŒï¼Œæˆ‘ä»¬ä½¿ç”¨96å°æ—¶çš„é¢„æµ‹èŒƒå›´ï¼Œè¿™æ˜¯æ–‡çŒ®ä¸­é•¿æœŸé¢„æµ‹çš„å¸¸è§èŒƒå›´ã€‚
- en: We also reserve two windows of 96 time steps to evaluate our models.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜ä¿ç•™ä¸¤ä¸ª96æ—¶é—´æ­¥çš„çª—å£æ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚
- en: First, we define a list of models that we want to use to carry out the forecasting
    task. Again, we will use N-BEATS, N-HiTS, and TimesNet.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¦ç”¨æ¥è¿›è¡Œé¢„æµ‹ä»»åŠ¡çš„æ¨¡å‹åˆ—è¡¨ã€‚å†æ¬¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨N-BEATSã€N-HiTSå’ŒTimesNetã€‚
- en: We will keep the default parameters for all models, and limit the maximum number
    of epochs to 50\. Note that by default, TimesNet will select the top 5 most important
    periods in our data.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä¿æŒæ‰€æœ‰æ¨¡å‹çš„é»˜è®¤å‚æ•°ï¼Œå¹¶å°†æœ€å¤§è®­ç»ƒè½®æ¬¡é™åˆ¶ä¸º50ã€‚è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒTimesNetå°†é€‰æ‹©æ•°æ®ä¸­æœ€é‡è¦çš„å‰5ä¸ªå‘¨æœŸã€‚
- en: '[PRE3]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Once this is done, we can instantiate the *NeuralForecasts* object with the
    list of our models and the frequency of our data, which is hourly.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬çš„æ¨¡å‹åˆ—è¡¨å’Œæ•°æ®çš„é¢‘ç‡ï¼ˆå³æ¯å°æ—¶ï¼‰æ¥å®ä¾‹åŒ–*NeuralForecasts*å¯¹è±¡ã€‚
- en: '[PRE4]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Then, we run cross-validation so that we have the predictions and the actual
    values of our dataset. That way, we can evaluate the performance of each model.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬è¿›è¡Œäº¤å‰éªŒè¯ï¼Œä»¥è·å¾—é¢„æµ‹å’Œæ•°æ®é›†çš„å®é™…å€¼ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è¯„ä¼°æ¯ä¸ªæ¨¡å‹çš„æ€§èƒ½ã€‚
- en: Again, we use two windows of 96 time steps for the evaluation.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: å†æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ª96æ—¶é—´æ­¥çš„çª—å£è¿›è¡Œè¯„ä¼°ã€‚
- en: '[PRE5]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/3eb99dd01226ce7a1505c8f248f2109d.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3eb99dd01226ce7a1505c8f248f2109d.png)'
- en: First five rows of the predictions DataFrame. Image by the author.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹DataFrameçš„å‰äº”è¡Œã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: Once the models are trained and predictions are done, we get the *DataFrame*
    above. We can see the actual values, as well as the predictions coming from each
    model that we specified earlier.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æ¨¡å‹è®­ç»ƒå®Œæˆå¹¶è¿›è¡Œé¢„æµ‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸Šè¿°*DataFrame*ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®é™…å€¼ä»¥åŠä¹‹å‰æŒ‡å®šçš„æ¯ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚
- en: We can also easily visualize the predictions against the actual values.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¹Ÿå¯ä»¥è½»æ¾åœ°å°†é¢„æµ‹ä¸å®é™…å€¼è¿›è¡Œå¯è§†åŒ–ã€‚
- en: '[PRE6]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/bd875864d12fcffe264c54dfc50b1822.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bd875864d12fcffe264c54dfc50b1822.png)'
- en: Visualizing the predictions of each model on the test set. Here, all models
    fail to predict the decrease observed in the test set. Image by the author.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–æ¯ä¸ªæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„é¢„æµ‹ã€‚è¿™é‡Œï¼Œæ‰€æœ‰æ¨¡å‹éƒ½æœªèƒ½é¢„æµ‹åˆ°æµ‹è¯•é›†ä¸­è§‚å¯Ÿåˆ°çš„ä¸‹é™ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: In the figure above, it seems that all models fail to predict the decrease in
    oil temperature observed in the test set. Also, N-BEATS and N-HiTS have captured
    some cyclical pattern that is not observed in the predictions of TimesNet.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸Šå›¾ä¸­ï¼Œæ‰€æœ‰æ¨¡å‹ä¼¼ä¹éƒ½æœªèƒ½é¢„æµ‹åˆ°æµ‹è¯•é›†ä¸­è§‚å¯Ÿåˆ°çš„æ²¹æ¸©ä¸‹é™ã€‚æ­¤å¤–ï¼ŒN-BEATSå’ŒN-HiTSæ•æ‰åˆ°äº†ä¸€äº›åœ¨TimesNetçš„é¢„æµ‹ä¸­æœªè§‚å¯Ÿåˆ°çš„å‘¨æœŸæ€§æ¨¡å¼ã€‚
- en: Still, we need to evaluate the models by calculating the MSE and MAE to determine
    which model is best.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ç„¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è®¡ç®—MSEå’ŒMAEæ¥è¯„ä¼°æ¨¡å‹ï¼Œä»¥ç¡®å®šå“ªä¸ªæ¨¡å‹æœ€å¥½ã€‚
- en: Evaluation
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¯„ä¼°
- en: Now, we simply compute the MAE and MSE to find out which model performed best.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è®¡ç®—MAEå’ŒMSEï¼Œä»¥æ‰¾å‡ºå“ªä¸ªæ¨¡å‹è¡¨ç°æœ€ä½³ã€‚
- en: '[PRE7]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/fc278927215ef99d54ee81093117097f.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fc278927215ef99d54ee81093117097f.png)'
- en: Peformance metrics of each model forthe long-term forecasting task on the Etth1
    dataset. Image by the author.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªæ¨¡å‹åœ¨Etth1æ•°æ®é›†ä¸Šçš„é•¿æœŸé¢„æµ‹ä»»åŠ¡çš„æ€§èƒ½æŒ‡æ ‡ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚
- en: From the figure above, we can see the N-HiTS achives the lowest MAE, while N-BEATS
    achieves the lowest MSE.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒN-HiTSè¾¾åˆ°äº†æœ€ä½çš„MAEï¼Œè€ŒN-BEATSè¾¾åˆ°äº†æœ€ä½çš„MSEã€‚
- en: However, there is a difference of 0.002 in MAE, and a difference of 0.00025
    in MSE. Since the difference in MSE is so small, especially considering the error
    is squared, I would argue that N-HiTS is the champion model for this task.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸è¿‡ï¼ŒMAEçš„å·®å¼‚ä¸º0.002ï¼ŒMSEçš„å·®å¼‚ä¸º0.00025ã€‚ç”±äºMSEçš„å·®å¼‚éå¸¸å°ï¼Œç‰¹åˆ«æ˜¯è€ƒè™‘åˆ°è¯¯å·®æ˜¯å¹³æ–¹çš„ï¼Œæˆ‘è®¤ä¸ºN-HiTSæ˜¯è¿™ä¸ªä»»åŠ¡çš„å† å†›æ¨¡å‹ã€‚
- en: So, it turns out that TimesNet did not achieve the best performance. However,
    keep in mind that we just conducted a simple experiment with no hyperparameter
    optimization, on one dataset only, and on two windows of 96 time steps.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œäº‹å®è¯æ˜TimesNetå¹¶æœªè¾¾åˆ°æœ€ä½³æ€§èƒ½ã€‚ä¸è¿‡ï¼Œè¯·è®°ä½ï¼Œæˆ‘ä»¬åªæ˜¯è¿›è¡Œäº†ä¸€ä¸ªç®€å•çš„å®éªŒï¼Œæ²¡æœ‰è¿›è¡Œè¶…å‚æ•°ä¼˜åŒ–ï¼Œåªåœ¨ä¸€ä¸ªæ•°æ®é›†ä¸Šï¼Œä¸”ä»…åœ¨ä¸¤ä¸ª96æ—¶é—´æ­¥é•¿çš„çª—å£ä¸Šè¿›è¡Œã€‚
- en: This is really meant to show you how to work with TimesNet and NeuralForecast,
    so that you can have another tool in your toolbox to solve your next forecasting
    problem.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™çœŸçš„æ—¨åœ¨å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨TimesNetå’ŒNeuralForecastï¼Œä»¥ä¾¿ä½ å¯ä»¥åœ¨è§£å†³ä¸‹ä¸€ä¸ªé¢„æµ‹é—®é¢˜æ—¶æœ‰æ›´å¤šå·¥å…·å¯ç”¨ã€‚
- en: Conclusion
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: TimesNet is a CNN-based model that leverages the Inception module to achieve
    state-of-the-art performances on many time series analysis tasks, such as forecasting,
    classification, imputation and anomaly detection.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: TimesNetæ˜¯ä¸€ä¸ªåŸºäºCNNçš„æ¨¡å‹ï¼Œåˆ©ç”¨Inceptionæ¨¡å—åœ¨è®¸å¤šæ—¶é—´åºåˆ—åˆ†æä»»åŠ¡ä¸Šå®ç°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ï¼Œå¦‚é¢„æµ‹ã€åˆ†ç±»ã€å¡«è¡¥å’Œå¼‚å¸¸æ£€æµ‹ã€‚
- en: As always, each forecasting problem requires a unique approach and a specific
    model, so make sure to test out TimesNet as well as other models.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€å¦‚æ—¢å¾€ï¼Œæ¯ä¸ªé¢„æµ‹é—®é¢˜éƒ½éœ€è¦ç‹¬ç‰¹çš„æ–¹æ³•å’Œç‰¹å®šçš„æ¨¡å‹ï¼Œå› æ­¤è¯·ç¡®ä¿æµ‹è¯•TimesNetä»¥åŠå…¶ä»–æ¨¡å‹ã€‚
- en: Thanks for reading! I hope that you enjoyed it and that you learned something
    new!
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢é˜…è¯»ï¼å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼Œå¹¶å­¦åˆ°äº†æ–°çš„ä¸œè¥¿ï¼
- en: Looking to master time series forecasting? The check out my course [Applied
    Time Series Forecasting in Python](https://www.datasciencewithmarco.com/offers/zTAs2hi6/checkout?coupon_code=ATSFP10).
    This is the only course that uses Python to implement statistical, deep learning
    and state-of-the-art models in 16 guided hands-on projects.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³æŒæ¡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Ÿé‚£å°±çœ‹çœ‹æˆ‘çš„è¯¾ç¨‹[Pythonä¸­çš„åº”ç”¨æ—¶é—´åºåˆ—é¢„æµ‹](https://www.datasciencewithmarco.com/offers/zTAs2hi6/checkout?coupon_code=ATSFP10)ã€‚è¿™æ˜¯å”¯ä¸€ä¸€ä¸ªé€šè¿‡16ä¸ªæŒ‡å¯¼æ€§åŠ¨æ‰‹é¡¹ç›®ä½¿ç”¨Pythonå®ç°ç»Ÿè®¡ã€æ·±åº¦å­¦ä¹ å’Œæœ€å…ˆè¿›æ¨¡å‹çš„è¯¾ç¨‹ã€‚
- en: Cheers ğŸ»
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: å¹²æ¯ ğŸ»
- en: Support me
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ”¯æŒæˆ‘
- en: Enjoying my work? Show your support with [Buy me a coffee](http://buymeacoffee.com/dswm),
    a simple way for you to encourage me, and I get to enjoy a cup of coffee! If you
    feel like it, just click the button below ğŸ‘‡
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: å–œæ¬¢æˆ‘çš„å·¥ä½œå—ï¼Ÿé€šè¿‡[ç»™æˆ‘ä¹°æ¯å’–å•¡](http://buymeacoffee.com/dswm)æ¥æ”¯æŒæˆ‘ï¼Œè¿™æ˜¯é¼“åŠ±æˆ‘çš„ä¸€ç§ç®€å•æ–¹å¼ï¼Œæˆ‘ä¹Ÿèƒ½äº«å—ä¸€æ¯å’–å•¡ï¼å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œåªéœ€ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®
    ğŸ‘‡
- en: '[![](../Images/0b01a9e378012cb5701b0525dcf23def.png)](https://www.buymeacoffee.com/dswm)'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '[![](../Images/0b01a9e378012cb5701b0525dcf23def.png)](https://www.buymeacoffee.com/dswm)'
- en: References
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å‚è€ƒæ–‡çŒ®
- en: 'Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang and Mingsheng Long â€”
    [TimesNet: Temporal 2D-Variation Modeling For General Time Series Analysis](https://browse.arxiv.org/pdf/2210.02186.pdf)'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang å’Œ Mingsheng Long â€” [TimesNetï¼šç”¨äºä¸€èˆ¬æ—¶é—´åºåˆ—åˆ†æçš„æ—¶åºäºŒç»´å˜åŒ–å»ºæ¨¡](https://browse.arxiv.org/pdf/2210.02186.pdf)
- en: Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott Reed,
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott Reed,
- en: Dragomir Anguelov, Dumitru Erhan, Vincent Vanhoucke, Andrew Rabinovich â€” [Going
    Deeper With Convolutions](https://openaccess.thecvf.com/content_cvpr_2015/papers/Szegedy_Going_Deeper_With_2015_CVPR_paper.pdf)
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: Dragomir Anguelov, Dumitru Erhan, Vincent Vanhoucke, Andrew Rabinovich â€” [æ·±å…¥å·ç§¯ç½‘ç»œ](https://openaccess.thecvf.com/content_cvpr_2015/papers/Szegedy_Going_Deeper_With_2015_CVPR_paper.pdf)

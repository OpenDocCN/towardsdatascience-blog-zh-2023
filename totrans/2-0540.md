# 完整实现一个用于图像识别的迷你 VGG 网络

> 原文：[https://towardsdatascience.com/complete-implementation-of-a-mini-vgg-network-for-image-recognition-849299480356](https://towardsdatascience.com/complete-implementation-of-a-mini-vgg-network-for-image-recognition-849299480356)

![](../Images/4e4dcec20a06722d2ced502b9d033988.png)

照片由 [Guillaume de Germain](https://unsplash.com/@guillaumedegermain?utm_source=medium&utm_medium=referral) 提供，来源于 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

## 用于更高效图像识别的深度卷积神经网络

[](https://rashida00.medium.com/?source=post_page-----849299480356--------------------------------)[![Rashida Nasrin Sucky](../Images/42bd057e8eca255907c43c29a498f2ca.png)](https://rashida00.medium.com/?source=post_page-----849299480356--------------------------------)[](https://towardsdatascience.com/?source=post_page-----849299480356--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----849299480356--------------------------------) [Rashida Nasrin Sucky](https://rashida00.medium.com/?source=post_page-----849299480356--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----849299480356--------------------------------) ·7 分钟阅读·2023 年 2 月 27 日

--

VGG 网络是最流行的图像识别技术之一的基础。它值得学习，因为它打开了许多新的领域。要理解 VGGNet，你需要了解卷积神经网络（CNN）。如果你不熟悉 CNN 架构，请先阅读本教程：

[](/convolutional-neural-network-good-understanding-of-the-layers-and-an-image-classification-example-a280bc02c13e?source=post_page-----849299480356--------------------------------) [## 卷积神经网络：对层的良好理解及图像分类示例

### 内容丰富

towardsdatascience.com](/convolutional-neural-network-good-understanding-of-the-layers-and-an-image-classification-example-a280bc02c13e?source=post_page-----849299480356--------------------------------)

在本文中，我们将只关注 VGGNet 的实现部分。因此，我们将在这里快速进行。

## 关于 VGG 网络

VGGNet 是一种可以更成功地提取特征的卷积神经网络（CNN）。在 VGGNet 中，我们堆叠了多个卷积层。VGGNet 可以是浅层的，也可以是深层的。在浅层 VGGNet 中，通常仅添加两组四个卷积层，如我们将很快看到的那样。而在深层 VGGNet 中，可以添加超过四个卷积层。两个常用的深层 VGGNet 是 VGG16，它总共使用 16 层，以及 VGG19，它总共使用 19 层。我们可以添加一个批量归一化层，也可以不添加。但在本教程中我将使用它。

你可以通过这个链接阅读更多关于架构的信息：

[](https://viso.ai/deep-learning/vgg-very-deep-convolutional-networks/?source=post_page-----849299480356--------------------------------) [## VGG非常深的卷积网络 (VGGNet) - 你需要知道的 - viso.ai

### 我们使用cookie来提升您的浏览体验、提供个性化广告或内容，并分析我们的流量。通过…

viso.ai](https://viso.ai/deep-learning/vgg-very-deep-convolutional-networks/?source=post_page-----849299480356--------------------------------)

> **今天我们将研究mini VGGNet。因此，它会更简单、更容易运行，但对于许多用例仍然很强大。**

miniVGGNet的一个重要特点是**它使用所有的3x3滤波器**。这就是它能够如此出色地泛化的原因。让我们开始在Keras和TensorFlow中构建一个mini VGGNet。

> 我使用了Google Colaboratory笔记本，并启用了GPU。否则，训练速度非常慢。

## Mini VGG网络开发、训练和评估

现在开始工作吧。我们将对其进行一些实验，以展示如何使用它。

这些是必要的导入：

[PRE0]

这些导入文件真不少！

我们将使用**cifar-10数据集**，这是一个在TensorFlow库中提供的公共数据集。

我使用了两个不同的网络作为实验。第一个是流行的。我之所以说流行，是因为我在[Kaggle](https://www.kaggle.com/code/akshat4112/minivggnet-from-scratch-on-cifar-10-with-bn)和其他一些教程中找到了这个[架构]。

[PRE1]

让我们加载并准备我们的cifar-10数据集。

[PRE2]

cifar-10数据集有10个标签。这些是cifar-10数据集中的标签：

[PRE3]

使用LabelBinarizer将标签二值化：

[PRE4]

在这里编译模型。评估指标是“准确率”，我们将运行10个周期。

[PRE5]

结果如下：

[PRE6]

经过10个周期后，训练数据的准确率为79.46%，验证数据的准确率为78.98%。

考虑到这一点，我想对这个网络做一些更改，看看结果如何。让我们重新定义上面的网络。我在整个网络中使用了64个滤波器，密集层中有256个神经元，最后一个dropout层中有40%的dropout。

这是新的mini VGG网络：

[PRE7]

我们将使用相同的优化参数和运行模型。但这里我使用了20个周期。

[PRE8]

结果如下：

[PRE9]

如果你注意到，经过10个周期后，准确率略高于之前的网络，经过20个周期后准确率非常好。训练数据的准确率为88.45%，验证数据的准确率为81.99%。

在同一图表中展示训练和验证准确率以及训练和验证损失：

[PRE10]

![](../Images/1df32aefed9f91e696dd6346ac85b28f.png)

作者提供的图片

训练损失平稳下降，验证损失也有一些波动地下降。

## 结论

请随意进行实验。根据项目尝试不同的参数，看看效果如何。我们稍后将研究一个深度网络。

随时在 [Twitter](https://twitter.com/rashida048) 上关注我，并点赞我的 [Facebook](https://www.facebook.com/rashida.smith.161) 页面。

## 更多阅读

[OpenCV Python 中的简单边缘检测方法](https://towardsdatascience.com/easy-method-of-edge-detection-in-opencv-python-db26972deb2d?source=post_page-----849299480356--------------------------------) [## OpenCV Python 中的简单边缘检测方法

### 高效使用 Canny 边缘检测

[如何使用 OpenCV 进行阈值分割](https://towardsdatascience.com/how-to-perform-image-segmentation-with-thresholding-using-opencv-b2a78abb07ac?source=post_page-----849299480356--------------------------------) [## 如何使用 OpenCV 进行阈值分割

### 简单的、Otsu 和自适应阈值实现示例

[如何定义自定义层、激活函数和损失函数](https://towardsdatascience.com/how-to-define-custom-layer-activation-function-and-loss-function-in-tensorflow-bdd7e78eb67?source=post_page-----849299480356--------------------------------) [## 如何定义自定义层、激活函数和损失函数

### 逐步讲解和完整代码示例

[如何定义自定义层、激活函数和损失函数](https://towardsdatascience.com/how-to-define-custom-layer-activation-function-and-loss-function-in-tensorflow-bdd7e78eb67?source=post_page-----849299480356--------------------------------) [## 逐步教程：在 TensorFlow 中开发多输出模型

### 包含完整代码

[在 TensorFlow 中使用顺序 API 和函数 API 进行回归](https://towardsdatascience.com/a-step-by-step-tutorial-to-develop-a-multi-output-model-in-tensorflow-ec9f13e5979c?source=post_page-----849299480356--------------------------------) [## TensorFlow 中使用顺序 API 和函数 API 进行回归

### 展示几种不同类型的模型结构

[回归模型的 TensorFlow 实现](https://towardsdatascience.com/regression-in-tensorflow-using-both-sequential-and-function-apis-314e74b537ca?source=post_page-----849299480356--------------------------------)

- en: Leveraging analytic functions in SQL for faster data extraction
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆ©ç”¨SQLä¸­çš„åˆ†æå‡½æ•°åŠ é€Ÿæ•°æ®æå–
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/sql-window-functions-939ed24c9752](https://towardsdatascience.com/sql-window-functions-939ed24c9752)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/sql-window-functions-939ed24c9752](https://towardsdatascience.com/sql-window-functions-939ed24c9752)
- en: Analytic functions provide an incredibly powerful and yet easy to implement
    way to process and analyze data. This post will show you how to incorporate analytic
    functions in your SQL statements.
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åˆ†æå‡½æ•°æä¾›äº†ä¸€ç§æå…¶å¼ºå¤§ä¸”æ˜“äºå®ç°çš„æ•°æ®å¤„ç†å’Œåˆ†ææ–¹å¼ã€‚æœ¬æ–‡å°†å±•ç¤ºå¦‚ä½•åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨åˆ†æå‡½æ•°ã€‚
- en: '[](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)[![GÃ¼nter
    RÃ¶hrich](../Images/31a1d0dc835c7ad31197f8c387023d10.png)](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)[](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)
    [GÃ¼nter RÃ¶hrich](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)[![GÃ¼nter
    RÃ¶hrich](../Images/31a1d0dc835c7ad31197f8c387023d10.png)](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)[](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)
    [GÃ¼nter RÃ¶hrich](https://guenterroehrich.medium.com/?source=post_page-----939ed24c9752--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)
    Â·8 min readÂ·Jul 18, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒåœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----939ed24c9752--------------------------------)
    Â·8åˆ†é’Ÿé˜…è¯»Â·2023å¹´7æœˆ18æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: As an analytics professional, you will likely find yourself in a scenario where
    youâ€™re required to query data for your analysis. Quite often, data is obtained
    from a SQL database and then imported through a programming language like Python
    using powerful frameworks such as Pandas or NumPy. This is a perfectly fine pipeline
    to work with data, however, the heavy lifting is mainly done by your local machine.
    With small datasets, this is not an issue, but when it comes to larger datasets,
    one might encounter issues achieving the heavy processing solely in the PCâ€™s local
    memory.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºä¸€ååˆ†æå¸ˆï¼Œä½ å¾ˆå¯èƒ½ä¼šé‡åˆ°éœ€è¦æŸ¥è¯¢æ•°æ®ä»¥è¿›è¡Œåˆ†æçš„æƒ…æ™¯ã€‚æ•°æ®é€šå¸¸æ¥è‡ªSQLæ•°æ®åº“ï¼Œç„¶åé€šè¿‡åƒPythonè¿™æ ·çš„ç¼–ç¨‹è¯­è¨€å’ŒPandasæˆ–NumPyç­‰å¼ºå¤§æ¡†æ¶å¯¼å…¥ã€‚è¿™æ˜¯ä¸€ç§å¤„ç†æ•°æ®çš„å®Œå…¨æœ‰æ•ˆçš„ç®¡é“ï¼Œä½†é‡çš„è®¡ç®—ä¸»è¦ä¾èµ–äºä½ çš„æœ¬åœ°æœºå™¨ã€‚å¯¹äºå°æ•°æ®é›†ï¼Œè¿™ä¸æ˜¯é—®é¢˜ï¼Œä½†å¯¹äºè¾ƒå¤§çš„æ•°æ®é›†ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»…ä¾é PCæœ¬åœ°å†…å­˜å¤„ç†å¤§é‡æ•°æ®çš„å›°éš¾ã€‚
- en: '*You may think that this is not a common problem. Therefore, let me give an
    everyday example to prove this assumption wrong:*'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '*ä½ å¯èƒ½è®¤ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªå¸¸è§çš„é—®é¢˜ã€‚å› æ­¤ï¼Œè®©æˆ‘ç»™å‡ºä¸€ä¸ªæ—¥å¸¸çš„ä¾‹å­æ¥è¯æ˜è¿™ä¸ªå‡è®¾æ˜¯é”™è¯¯çš„ï¼š*'
- en: Imagine you worked in a manufacturing company and you were interested in collecting
    machine sensor data. This data is often collected frequently and might also be
    quite noisy. To better understand whatâ€™s going on with your machine, smoothing,
    and pre-processing the densely collected data (e.g. measurements could be collected
    several times per second) quickly results in immense dataset sizes! Letâ€™s assume
    we have 150 sensors placed alongside a machine, and each one of them is reading
    4 measurements per second. One single day would then produce
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨ä¸€å®¶åˆ¶é€ å…¬å¸å·¥ä½œï¼Œå¹¶ä¸”å¯¹æ”¶é›†æœºå™¨ä¼ æ„Ÿå™¨æ•°æ®æ„Ÿå…´è¶£ã€‚è¿™äº›æ•°æ®é€šå¸¸è¢«é¢‘ç¹æ”¶é›†ï¼Œè€Œä¸”å¯èƒ½éå¸¸å˜ˆæ‚ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£ä½ çš„æœºå™¨çŠ¶æ€ï¼Œå¯¹å¯†é›†æ”¶é›†çš„æ•°æ®è¿›è¡Œå¹³æ»‘å’Œé¢„å¤„ç†ï¼ˆä¾‹å¦‚ï¼Œæµ‹é‡å¯èƒ½æ¯ç§’æ”¶é›†å‡ æ¬¡ï¼‰å¾ˆå¿«å°±ä¼šäº§ç”Ÿåºå¤§çš„æ•°æ®é›†ï¼å‡è®¾æˆ‘ä»¬åœ¨ä¸€å°æœºå™¨æ—è¾¹æ”¾ç½®äº†150ä¸ªä¼ æ„Ÿå™¨ï¼Œæ¯ä¸ªä¼ æ„Ÿå™¨æ¯ç§’è¯»å–4æ¬¡æ•°æ®ã€‚é‚£ä¹ˆä¸€å¤©çš„æ•°æ®å°†ä¼šäº§ç”Ÿ
- en: 4Ã—60Ã—60Ã—24x150 â‰ˆ 52m records (Readings x Seconds x Minutes x Hours x Sensors)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 4Ã—60Ã—60Ã—24x150 â‰ˆ 52ç™¾ä¸‡æ¡è®°å½•ï¼ˆè¯»å–æ¬¡æ•° Ã— ç§’ Ã— åˆ†é’Ÿ Ã— å°æ—¶ Ã— ä¼ æ„Ÿå™¨ï¼‰
- en: data points. Usually, as a rule of thumb, we look at at least one week of data
    (but we might also increase readings or even the number of sensors)â€¦ you see where
    this is going.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®ç‚¹ã€‚é€šå¸¸ï¼Œä½œä¸ºç»éªŒæ³•åˆ™ï¼Œæˆ‘ä»¬ä¼šæŸ¥çœ‹è‡³å°‘ä¸€å‘¨çš„æ•°æ®ï¼ˆä½†æˆ‘ä»¬ä¹Ÿå¯èƒ½å¢åŠ è¯»å–æ¬¡æ•°æˆ–ä¼ æ„Ÿå™¨æ•°é‡ï¼‰â€¦â€¦ä½ èƒ½ç†è§£è¿™ç‚¹ã€‚
- en: For this reason, you might be better off shifting your computationally expensive
    aggregations to the source database. In particular, analytic or window functions
    areÂ straightforwardÂ inÂ itsÂ syntax, yet a powerful tool to read, transform, and
    extract data on a more aggregated level.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œä½ å¯èƒ½æ›´å¥½åœ°å°†è®¡ç®—æˆæœ¬é«˜çš„èšåˆæ“ä½œè½¬ç§»åˆ°æºæ•°æ®åº“ä¸­ã€‚ç‰¹åˆ«æ˜¯ï¼Œåˆ†ææˆ–çª—å£å‡½æ•°çš„è¯­æ³•ç›´æ¥æ˜äº†ï¼Œå´æ˜¯è¯»å–ã€è½¬æ¢å’Œæå–æ•°æ®çš„å¼ºå¤§å·¥å…·ï¼Œé€‚ç”¨äºæ›´é«˜å±‚æ¬¡çš„èšåˆã€‚
- en: '**The key take away**:'
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**å…³é”®è¦ç‚¹**ï¼š'
- en: ''
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Whenever you see the need for a rolling / moving windowÂ orÂ calculationsÂ within
    aÂ logicalÂ partitionÂ (e.g.Â continously ranking, lowest ro highest value,Â withinÂ aÂ certainÂ groupÂ ofÂ sensors),
    it is certainly worthwhile considering the application of window functions in
    a SQL query directly, rather than achieving similar functionality with more expensive
    functions implemented in Pandas.
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ¯å½“ä½ çœ‹åˆ°éœ€è¦æ»šåŠ¨/ç§»åŠ¨çª—å£æˆ–åœ¨é€»è¾‘åˆ†åŒºå†…è¿›è¡Œè®¡ç®—ï¼ˆä¾‹å¦‚ï¼ŒæŒç»­æ’åï¼Œä»æœ€ä½åˆ°æœ€é«˜å€¼ï¼Œåœ¨æŸäº›ä¼ æ„Ÿå™¨ç»„å†…ï¼‰ï¼Œç›´æ¥åœ¨ SQL æŸ¥è¯¢ä¸­åº”ç”¨çª—å£å‡½æ•°é€šå¸¸æ˜¯å€¼å¾—è€ƒè™‘çš„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨
    Pandas ä¸­å®ç°çš„æ›´æ˜‚è´µçš„å‡½æ•°æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚
- en: How is this brief article structured?
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¿™ç¯‡ç®€çŸ­çš„æ–‡ç« æ˜¯å¦‚ä½•ç»“æ„åŒ–çš„ï¼Ÿ
- en: A [short introductory](#c6e6) example and theory how window functions work
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª [ç®€çŸ­çš„ä»‹ç»](#c6e6) ä¾‹å­å’Œçª—å£å‡½æ•°å¦‚ä½•å·¥ä½œçš„ç†è®º
- en: A [quick guide to install some SQL demo data](#819b) as well as a ready-to-go
    database on your computer (this is easy!). We will use the famous **New York Taxi**
    data
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª [å¿«é€ŸæŒ‡å—æ¥å®‰è£…ä¸€äº› SQL æ¼”ç¤ºæ•°æ®](#819b) ä»¥åŠä¸€ä¸ªå¯ä»¥åœ¨ç”µè„‘ä¸Šç›´æ¥ä½¿ç”¨çš„æ•°æ®åº“ï¼ˆè¿™å¾ˆç®€å•ï¼ï¼‰ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è‘—åçš„ **çº½çº¦å‡ºç§Ÿè½¦**
    æ•°æ®ã€‚
- en: '[Examples](#f9cd) to get yourself familiar to the functions'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[ç¤ºä¾‹](#f9cd) è®©ä½ ç†Ÿæ‚‰è¿™äº›å‡½æ•°'
- en: '![](../Images/07f82d39dbfab5144ca87e8f110b152d.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/07f82d39dbfab5144ca87e8f110b152d.png)'
- en: A bunch of windows by [Julio CÃ©sar Bosch](https://unsplash.com/@jcbossch?utm_source=medium&utm_medium=referral)
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€äº›çª—å£å‡½æ•°çš„ [Julio CÃ©sar Bosch](https://unsplash.com/@jcbossch?utm_source=medium&utm_medium=referral)
- en: Intro
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»‹ç»
- en: '**Why do you need window functions?**'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä¸ºä»€ä¹ˆä½ éœ€è¦çª—å£å‡½æ•°ï¼Ÿ**'
- en: With all the buzz around the more attractive domains of data science, we often
    oversee the fact that most of a data scientistâ€™s time is spent on obtaining, processing,
    and cleaning data. Whenever you see the need for computationally expensive running
    sums or a moving average, you should consider shifting those transformations to
    the database.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ•°æ®ç§‘å­¦æ›´å…·å¸å¼•åŠ›çš„é¢†åŸŸå¼•èµ·çš„è½°åŠ¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸å¿½è§†äº†æ•°æ®ç§‘å­¦å®¶å¤§éƒ¨åˆ†æ—¶é—´èŠ±è´¹åœ¨è·å–ã€å¤„ç†å’Œæ¸…æ´—æ•°æ®ä¸Šã€‚æ¯å½“ä½ çœ‹åˆ°éœ€è¦è®¡ç®—æˆæœ¬é«˜çš„è¿è¡Œæ€»å’Œæˆ–ç§»åŠ¨å¹³å‡æ—¶ï¼Œä½ åº”è¯¥è€ƒè™‘å°†è¿™äº›è½¬æ¢æ“ä½œè½¬ç§»åˆ°æ•°æ®åº“ä¸­ã€‚
- en: This type of **functions is performed on a series of rows that do contextually
    belong together**. Typically, we think of sums, averages, min or max calculations
    when it comes to such transactions.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§ **å‡½æ•°æ˜¯å¯¹ä¸€ç³»åˆ—è¯­å¢ƒä¸Šç›¸å…³çš„è¡Œè¿›è¡Œæ“ä½œ**ã€‚é€šå¸¸ï¼Œå½“æ¶‰åŠæ­¤ç±»äº‹åŠ¡æ—¶ï¼Œæˆ‘ä»¬ä¼šè€ƒè™‘æ€»å’Œã€å¹³å‡å€¼ã€æœ€å°å€¼æˆ–æœ€å¤§å€¼è®¡ç®—ã€‚
- en: '**How are window functions structured in general?**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**çª—å£å‡½æ•°ä¸€èˆ¬æ˜¯å¦‚ä½•ç»“æ„çš„ï¼Ÿ**'
- en: 'To begin with the structure of a query that uses a window function, letâ€™s have
    a look at a SQL statement that uses a rolling sum â€” Just have a look at the code
    block, there is *no need yet to fully understand* the concept, just consider the
    code as a simple demonstration for now:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œäº†è§£ä½¿ç”¨çª—å£å‡½æ•°çš„æŸ¥è¯¢ç»“æ„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä½¿ç”¨æ»šåŠ¨æ€»å’Œçš„ SQL è¯­å¥â€”â€”åªéœ€æŸ¥çœ‹ä»£ç å—ï¼Œä¸éœ€è¦å®Œå…¨ç†è§£æ¦‚å¿µï¼Œæš‚æ—¶æŠŠä»£ç å½“ä½œç®€å•æ¼”ç¤ºï¼š
- en: '[PRE0]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'First, we specify the type of analysis we would like to perform. In general
    there **are three types of functions** to use:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œçš„åˆ†æç±»å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ**æœ‰ä¸‰ç§ç±»å‹çš„å‡½æ•°** å¯ä¾›ä½¿ç”¨ï¼š
- en: '**Aggregate functions**, such as min(), max(), count() or avg() â€” this is what
    was shown in the first example above'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**èšåˆå‡½æ•°**ï¼Œå¦‚ min()ã€max()ã€count() æˆ– avg()â€”â€”è¿™åœ¨ä¸Šé¢çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­å±•ç¤ºè¿‡'
- en: '**Numbering functions**, such as rank() or row_number()'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç¼–å·å‡½æ•°**ï¼Œå¦‚ rank() æˆ– row_number()'
- en: '**Navigation functions** such as lead(), lag() [to return the proceeding or
    preceding value)'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å¯¼èˆªå‡½æ•°** å¦‚ lead()ã€lag() [è¿”å›åç»­æˆ–å‰å€¼]'
- en: 2\. In a next step, we start thinking of **logical partitions**. As an example,
    we could select a user ID as a partitioning example, hence we look into blocks
    of users and perform further operations on each of the user subsets. Partitions
    are required to pass to the function!
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹è€ƒè™‘ **é€»è¾‘åˆ†åŒº**ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç”¨æˆ· ID ä½œä¸ºåˆ†åŒºç¤ºä¾‹ï¼Œå› æ­¤æˆ‘ä»¬æŸ¥çœ‹ç”¨æˆ·å—ï¼Œå¹¶å¯¹æ¯ä¸ªç”¨æˆ·å­é›†æ‰§è¡Œè¿›ä¸€æ­¥æ“ä½œã€‚å¿…é¡»å°†åˆ†åŒºä¼ é€’ç»™å‡½æ•°ï¼
- en: 3\. Similar to a group by statement, we should also consider an ordering argument
    in an analytic function. Ordering is applied on the selected sub block, as defined
    before. Ordering is optional and may be omitted.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. ç±»ä¼¼äº group by è¯­å¥ï¼Œæˆ‘ä»¬è¿˜åº”åœ¨åˆ†æå‡½æ•°ä¸­è€ƒè™‘æ’åºå‚æ•°ã€‚æ’åºåº”ç”¨äºä¹‹å‰å®šä¹‰çš„é€‰å®šå­å—ã€‚æ’åºæ˜¯å¯é€‰çš„ï¼Œå¯ä»¥çœç•¥ã€‚
- en: '4\. Lastly, the core element of an analytic (or window) function: the window
    frame clause. This clause specifies the rolling time window we would like to look
    into.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 4. æœ€åï¼Œåˆ†æï¼ˆæˆ–çª—å£ï¼‰å‡½æ•°çš„æ ¸å¿ƒå…ƒç´ ï¼šçª—å£æ¡†æ¶å­å¥ã€‚è¿™ä¸ªå­å¥æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›æŸ¥çœ‹çš„æ»šåŠ¨æ—¶é—´çª—å£ã€‚
- en: To get into more theory, follow the link belowâ€Šâ€”â€ŠPlease note that window functions
    may behave slightly differently between different SQL databases, however, their
    general structure is pretty much identical.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: è¦æ·±å…¥äº†è§£æ›´å¤šç†è®ºï¼Œè¯·è®¿é—®ä¸‹é¢çš„é“¾æ¥â€Šâ€”â€Šè¯·æ³¨æ„ï¼Œçª—å£å‡½æ•°åœ¨ä¸åŒçš„ SQL æ•°æ®åº“ä¸­å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†å®ƒä»¬çš„ä¸€èˆ¬ç»“æ„åŸºæœ¬ç›¸åŒã€‚
- en: '[](https://www.sqlite.org/windowfunctions.html?source=post_page-----939ed24c9752--------------------------------)
    [## Window Functions'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '[## çª—å£å‡½æ•°'
- en: A window function is an SQL function where the input values are taken from a
    "window" of one or more rows in theâ€¦
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: çª—å£å‡½æ•°æ˜¯ SQL å‡½æ•°ï¼Œå…¶ä¸­è¾“å…¥å€¼æ¥è‡ªä¸€ä¸ªæˆ–å¤šä¸ªè¡Œçš„â€œçª—å£â€ä¸­çš„...
- en: www.sqlite.org](https://www.sqlite.org/windowfunctions.html?source=post_page-----939ed24c9752--------------------------------)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.sqlite.org](https://www.sqlite.org/windowfunctions.html?source=post_page-----939ed24c9752--------------------------------)'
- en: Quick Installation Guide
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¿«é€Ÿå®‰è£…æŒ‡å—
- en: 'To illustrate how window functions work, Iâ€™ll provide some examples using one
    subset of the the famous New York taxis datasets. In general you will need the
    following tools to work your way through the examples yourself:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†è¯´æ˜çª—å£å‡½æ•°å¦‚ä½•å·¥ä½œï¼Œæˆ‘å°†æä¾›ä¸€äº›ä½¿ç”¨è‘—åçš„çº½çº¦å‡ºç§Ÿè½¦æ•°æ®é›†çš„å­é›†çš„ç¤ºä¾‹ã€‚é€šå¸¸ï¼Œä½ éœ€è¦ä»¥ä¸‹å·¥å…·æ¥è‡ªå·±å®Œæˆè¿™äº›ç¤ºä¾‹ï¼š
- en: Python installed (used for extraction, requires sqlite3 and pandas libraries)
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å·²å®‰è£… Pythonï¼ˆç”¨äºæå–ï¼Œéœ€ sqlite3 å’Œ pandas åº“ï¼‰
- en: A tool to write queries and look at data (When it comes to SQL, [DBeaver](https://dbeaver.io/)
    is an incredibly powerful tool to query data, yet it is easy to work with and
    open source
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ç§ç¼–å†™æŸ¥è¯¢å’ŒæŸ¥çœ‹æ•°æ®çš„å·¥å…·ï¼ˆè°ˆåˆ° SQLï¼Œ[DBeaver](https://dbeaver.io/) æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ•°æ®æŸ¥è¯¢å·¥å…·ï¼Œä½†æ˜“äºä½¿ç”¨ä¸”å¼€æºã€‚
- en: And thatâ€™s it!
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™æ ·ï¼
- en: 'If you would like to replicate the steps shown, simply follow the link below
    and get your download:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³å¤åˆ¶æ‰€å±•ç¤ºçš„æ­¥éª¤ï¼Œåªéœ€è®¿é—®ä¸‹é¢çš„é“¾æ¥å¹¶ä¸‹è½½å³å¯ï¼š
- en: '[## TLC Trip Record Data'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '[## TLC è¡Œç¨‹è®°å½•æ•°æ®'
- en: Yellow and green taxi trip records include fields capturing pick-up and drop-off
    dates/times, pick-up and drop-offâ€¦
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: é»„ç»¿å‡ºç§Ÿè½¦çš„è¡Œç¨‹è®°å½•åŒ…æ‹¬æ•æ‰æ¥é€æ—¥æœŸ/æ—¶é—´çš„å­—æ®µã€æ¥é€...
- en: www.nyc.gov](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page?source=post_page-----939ed24c9752--------------------------------)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.nyc.gov](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page?source=post_page-----939ed24c9752--------------------------------)'
- en: '*Legal side note:* [***There are no restrictions on using the data, given the
    intended purpose of use is lawful***](https://opendata.cityofnewyork.us/faq/)
    *as outlined in the terms of use. More license details and the dataset citation
    are added at the* [***end of the article***](#55c1)*.*'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ³•å¾‹è¯´æ˜ï¼š* [***åªè¦ä½¿ç”¨ç›®çš„åˆæ³•***](https://opendata.cityofnewyork.us/faq/) *ï¼Œæ•°æ®ä½¿ç”¨æ²¡æœ‰é™åˆ¶*ï¼Œå¦‚ä½¿ç”¨æ¡æ¬¾ä¸­æ‰€è¿°ã€‚æ›´å¤šè®¸å¯è¯è¯¦ç»†ä¿¡æ¯å’Œæ•°æ®é›†å¼•ç”¨è¯·è§*
    [***æ–‡ç« ç»“å°¾***](#55c1)*ã€‚'
- en: 'After the download succeeded I suggest transforming the parquet file to a sqlite3
    database. Using Python and the Pandas as well as sqlite3 packages, this is achieved
    in no time â€” just copy paste the code in a script and youâ€™re all set:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹è½½æˆåŠŸåï¼Œæˆ‘å»ºè®®å°† parquet æ–‡ä»¶è½¬æ¢ä¸º sqlite3 æ•°æ®åº“ã€‚ä½¿ç”¨ Python ä»¥åŠ Pandas å’Œ sqlite3 åŒ…ï¼Œè¿™å¾ˆå¿«å°±èƒ½å®ç°â€”â€”åªéœ€å°†ä»£ç å¤åˆ¶ç²˜è´´åˆ°è„šæœ¬ä¸­ï¼Œä½ å°±å‡†å¤‡å¥½äº†ï¼š
- en: '[PRE1]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Done! We can now work in a very trivial SQL database that is stored on our hard
    drive.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæˆäº†ï¼æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„éå¸¸ç®€å•çš„ SQL æ•°æ®åº“ä¸­å·¥ä½œäº†ã€‚
- en: Examples
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¤ºä¾‹
- en: Letâ€™s start with the simple task of obtaining the sum and average of fares over
    the whole data. For this we can use the arguments SUM and AVG and omit the grouping
    criteria in the braces following the over statement. As we are only aggregating
    over the whole dataset, there is no need to use a window function yet.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»è·å–æ•´ä¸ªæ•°æ®çš„è´¹ç”¨æ€»å’Œå’Œå¹³å‡å€¼è¿™ä¸€ç®€å•ä»»åŠ¡å¼€å§‹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SUM å’Œ AVG å‚æ•°ï¼Œå¹¶åœ¨ over è¯­å¥åçš„æ‹¬å·ä¸­çœç•¥åˆ†ç»„æ ‡å‡†ã€‚ç”±äºæˆ‘ä»¬åªæ˜¯å¯¹æ•´ä¸ªæ•°æ®é›†è¿›è¡Œèšåˆï¼Œå› æ­¤å°šæ— éœ€ä½¿ç”¨çª—å£å‡½æ•°ã€‚
- en: '[PRE2]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/06436db2bdcf52ed992317bb26256d77.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/06436db2bdcf52ed992317bb26256d77.png)'
- en: 'Assuming we would like to know the sum and average fares for every individual
    Vendor (*VendorID*) for every day of the month â€” this task becomes slightly more
    challenging:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬æƒ³äº†è§£æ¯ä¸€å¤©æ¯ä¸ªä¾›åº”å•†ï¼ˆ*VendorID*ï¼‰çš„æ€»è´¹ç”¨å’Œå¹³å‡è´¹ç”¨â€”â€”è¿™ä¸ªä»»åŠ¡ä¼šå˜å¾—ç¨å¾®æœ‰äº›æŒ‘æˆ˜ï¼š
- en: '[PRE3]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](../Images/549e85fece5f8d334761342f1f4ede5a.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/549e85fece5f8d334761342f1f4ede5a.png)'
- en: As we can see, in order to achieve a grouping effect we need the group by key
    word that allows us to aggregate according to *VendorId* and *dropdate*. Although
    group by is very powerful, it **does not allow us to further break down the individual
    rows as an trailing sum or moving average** â€” and this is where the window function
    comes in handy.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä¸ºäº†å®ç°åˆ†ç»„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ†ç»„å…³é”®å­—ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ ¹æ®*VendorId*å’Œ*dropdate*è¿›è¡Œæ±‡æ€»ã€‚è™½ç„¶åˆ†ç»„éå¸¸å¼ºå¤§ï¼Œä½†å®ƒ**ä¸èƒ½è¿›ä¸€æ­¥å°†å•ç‹¬è¡Œæ‹†åˆ†ä¸ºæ‹–å°¾æ€»å’Œæˆ–ç§»åŠ¨å¹³å‡å€¼**â€”â€”è¿™æ—¶çª—å£å‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ã€‚
- en: Assume now, we would like to calculate the rolling sum and mean values for the
    *fare_amount*, broken down by the *VendorID*s and related trips on every day.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³è®¡ç®—*fare_amount*çš„æ»šåŠ¨æ€»å’Œå’Œå‡å€¼ï¼Œå¹¶æŒ‰*VendorID*å’Œç›¸å…³çš„æ¯æ—¥è¡Œç¨‹è¿›è¡Œåˆ†ç±»ã€‚
- en: Our window operates within our dedicated â€œpartitionsâ€. We define a partition
    to be a whole day, hence, we expect to see rolling sum and means for each day
    and vendor (or equivalently, within each partition).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„çª—å£æ“ä½œåœ¨æˆ‘ä»¬æŒ‡å®šçš„â€œåˆ†åŒºâ€å†…ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåˆ†åŒºä¸ºæ•´å¤©ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æœŸæœ›çœ‹åˆ°æ¯ä¸€å¤©å’Œæ¯ä¸ªä¾›åº”å•†çš„æ»šåŠ¨æ€»å’Œå’Œå‡å€¼ï¼ˆæˆ–ç­‰æ•ˆåœ°ï¼Œåœ¨æ¯ä¸ªåˆ†åŒºå†…ï¼‰ã€‚
- en: '[PRE4]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/eac4044ad950a0b8b8737d8c29746276.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/eac4044ad950a0b8b8737d8c29746276.png)'
- en: Every partition (dropdate + VendorID) shows the fare amount per row as well
    as a rolling sum
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªåˆ†åŒºï¼ˆdropdate + VendorIDï¼‰æ˜¾ç¤ºæ¯è¡Œçš„ç¥¨ä»·ä»¥åŠæ»šåŠ¨æ€»å’Œã€‚
- en: Note the following, we used â€œ*unbounded preceding*â€ as frame clause. This means
    we look at all preceding values WITHIN OUR PARTITION â€” and again, our partition
    is defined as *Date* + *VendorID.*
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†â€œ*unbounded preceding*â€ä½œä¸ºæ¡†æ¶å­å¥ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬æŸ¥çœ‹åœ¨æˆ‘ä»¬åˆ†åŒºå†…çš„æ‰€æœ‰å‰ç½®å€¼â€”â€”å†è¯´ä¸€æ¬¡ï¼Œæˆ‘ä»¬çš„åˆ†åŒºå®šä¹‰ä¸º*Date*
    + *VendorID*ã€‚
- en: If we only want to look at a rolling sum/mean that considers the **previous
    as well as the current fare** (again under the partition of *Date*+*VendorID*)
    we need to adjust the frame clause to *only 1 preceding row and the current row*.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬åªæƒ³æŸ¥çœ‹ä¸€ä¸ªæ»šåŠ¨æ€»å’Œ/å‡å€¼ï¼Œè¯¥å‡å€¼è€ƒè™‘åˆ°**ä¹‹å‰å’Œå½“å‰çš„ç¥¨ä»·**ï¼ˆå†æ¬¡åœ¨*Date*+*VendorID*çš„åˆ†åŒºå†…ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¡†æ¶å­å¥è°ƒæ•´ä¸º*ä»…1è¡Œä¹‹å‰å’Œå½“å‰è¡Œ*ã€‚
- en: '[PRE5]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/ff00522d98c3c7c3e385011179813d0d.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ff00522d98c3c7c3e385011179813d0d.png)'
- en: â€œ1 Precedingâ€ results in a moving sum/mean that only looks at the current and
    previous trip fare_amount â€” again, this is always within partition
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: â€œ1 Precedingâ€ç»“æœæ˜¯ä¸€ä¸ªç§»åŠ¨æ€»å’Œ/å‡å€¼ï¼Œä»…æŸ¥çœ‹å½“å‰å’Œä¹‹å‰çš„è¡Œç¨‹ç¥¨ä»·â€”â€”å†è¯´ä¸€æ¬¡ï¼Œè¿™å§‹ç»ˆåœ¨åˆ†åŒºå†…ã€‚
- en: In the last example we will combine all the previous steps to show how we can
    elegantly query simple aggregated data and use this data to perform the rank()
    statement â€” which is an analytic numbering function.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ€åä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆæ‰€æœ‰ä¹‹å‰çš„æ­¥éª¤ï¼Œå±•ç¤ºå¦‚ä½•ä¼˜é›…åœ°æŸ¥è¯¢ç®€å•çš„æ±‡æ€»æ•°æ®ï¼Œå¹¶ä½¿ç”¨è¿™äº›æ•°æ®æ‰§è¡Œrank()è¯­å¥â€”â€”è¿™æ˜¯ä¸€ç§åˆ†æç¼–å·å‡½æ•°ã€‚
- en: 'We would like rank the days by the highest total amount of fares collected,
    for each of the vendors. We will therefore break this into two steps:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¸Œæœ›æŒ‰æ¯ä¸ªä¾›åº”å•†æ”¶å–çš„æ€»ç¥¨ä»·çš„æœ€é«˜å€¼å¯¹å¤©æ•°è¿›è¡Œæ’åã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†è¿™åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š
- en: Aggregate the fares by day and vendor through a simple â€œ*group by*â€
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é€šè¿‡ç®€å•çš„â€œ*group by*â€æŒ‰å¤©å’Œä¾›åº”å•†æ±‡æ€»ç¥¨ä»·
- en: Use an analytics function to rank the days within the partition of â€œ*VendorID*â€
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨åˆ†æå‡½æ•°å¯¹â€œ*VendorID*â€åˆ†åŒºå†…çš„å¤©æ•°è¿›è¡Œæ’å
- en: '[PRE6]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/36e5e85ac50aae1644d0bf97f7dc1e0f.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/36e5e85ac50aae1644d0bf97f7dc1e0f.png)'
- en: Starting with *VendorID=1*, the best day in January was 26th, which ranks first
    (highest revenue)
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ä»*VendorID=1*å¼€å§‹ï¼Œ1æœˆä»½æœ€å¥½çš„æ—¥å­æ˜¯26å·ï¼Œå®ƒæ’åç¬¬ä¸€ï¼ˆæ”¶å…¥æœ€é«˜ï¼‰ã€‚
- en: Conclusion
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: By now I believe you got the gist behind how analytics function work and how
    flexible they are to achieve rather complex query results.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»æŒæ¡äº†åˆ†æå‡½æ•°çš„å·¥ä½œåŸç†ä»¥åŠå®ƒä»¬å¦‚ä½•çµæ´»åœ°å®ç°ç›¸å½“å¤æ‚çš„æŸ¥è¯¢ç»“æœã€‚
- en: While data is nowadays often transformed on a local machine or cloud instance,
    modifying the data before actually importing it to subsequent software is often
    the better choice â€” that said, SQL is an incredibly powerful language to do so!
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶æ•°æ®ç°åœ¨é€šå¸¸åœ¨æœ¬åœ°æœºå™¨æˆ–äº‘å®ä¾‹ä¸Šè½¬æ¢ï¼Œä½†åœ¨å®é™…å¯¼å…¥åˆ°åç»­è½¯ä»¶ä¹‹å‰ä¿®æ”¹æ•°æ®é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼ŒSQLæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„è¯­è¨€æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼
- en: '**If you found this post helpful, I would appreciate a â€œfollowâ€ ğŸ«€, until then:**'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæˆ‘ä¼šå¾ˆæ„Ÿæ¿€ä½ çš„â€œå…³æ³¨â€ğŸ«€ï¼Œç›´åˆ°é‚£æ—¶ï¼š**'
- en: '*{Take care of yourself, and if you can, someone else too}*'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '*{ç…§é¡¾å¥½è‡ªå·±ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œä¹Ÿç…§é¡¾å¥½åˆ«äºº}*'
- en: '*â€” borrowed from Stephen Dubner*'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '*â€”â€” å€Ÿç”¨è‡ªæ–¯è’‚èŠ¬Â·æœå¸ƒçº³*'
- en: '**Dataset citation** and terms of use:'
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**æ•°æ®é›†å¼•ç”¨**å’Œä½¿ç”¨æ¡æ¬¾ï¼š'
- en: New York City Taxi and Limousine Commission (TLC) Trip Record Data was accessed
    on July 13 from [https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page)
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: çº½çº¦å¸‚å‡ºç§Ÿè½¦å’Œè±ªåè½¿è½¦å§”å‘˜ä¼šï¼ˆTLCï¼‰çš„è¡Œç¨‹è®°å½•æ•°æ®äº7æœˆ13æ—¥ä»[https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page)è®¿é—®ã€‚
- en: 'The full terms of use can be found here:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæ•´çš„ä½¿ç”¨æ¡æ¬¾å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š
- en: '[](https://www.nyc.gov/home/terms-of-use.page?source=post_page-----939ed24c9752--------------------------------)
    [## Terms of Use'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://www.nyc.gov/home/terms-of-use.page?source=post_page-----939ed24c9752--------------------------------)
    [## ä½¿ç”¨æ¡æ¬¾'
- en: Welcome to New York City's Official Website. PLEASE READ THE FOLLOWING TERMS
    OF USE ("TERMS") CAREFULLY BEFORE USINGâ€¦
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ¬¢è¿è®¿é—®çº½çº¦å¸‚å®˜æ–¹ç½‘ç«™ã€‚åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œè¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹ä½¿ç”¨æ¡æ¬¾ï¼ˆâ€œæ¡æ¬¾â€ï¼‰â€¦
- en: www.nyc.gov](https://www.nyc.gov/home/terms-of-use.page?source=post_page-----939ed24c9752--------------------------------)
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: www.nyc.gov](https://www.nyc.gov/home/terms-of-use.page?source=post_page-----939ed24c9752--------------------------------)

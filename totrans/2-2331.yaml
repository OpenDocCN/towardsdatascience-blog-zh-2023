- en: What is a Time Series Unit Root?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/what-is-a-time-series-unit-root-dba24fa099f4](https://towardsdatascience.com/what-is-a-time-series-unit-root-dba24fa099f4)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Answering one of the most important question in time series analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@egorhowell?source=post_page-----dba24fa099f4--------------------------------)[![Egor
    Howell](../Images/1f796e828f1625440467d01dcc3e40cd.png)](https://medium.com/@egorhowell?source=post_page-----dba24fa099f4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----dba24fa099f4--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----dba24fa099f4--------------------------------)
    [Egor Howell](https://medium.com/@egorhowell?source=post_page-----dba24fa099f4--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----dba24fa099f4--------------------------------)
    ·7 min read·Oct 11, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c59558f7b3568c61d07e2091c6e32d09.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Icons8 Team](https://unsplash.com/@icons8?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The [**unit root**](https://en.wikipedia.org/wiki/Unit_root) appears all the
    ‘time’ in time series and forecasting literature (pardon the pun).
  prefs: []
  type: TYPE_NORMAL
- en: '[Wikipedia](https://en.wikipedia.org/wiki/Unit_root) defines a unit root as:'
  prefs: []
  type: TYPE_NORMAL
- en: “In probability theory and statistics, a **unit root** is a feature of some
    stochastic processes (such as random walks) that can cause problems in statistical
    inference involving time series models. A linear stochastic process has a unit
    root if 1 is a root of the process’s characteristic equation. Such a process is
    non-stationary but does not always have a trend.”
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Yeah, doesn’t make much sense to me either ...
  prefs: []
  type: TYPE_NORMAL
- en: However, the above statement is overcomplicating it, and the unit root in reality
    is not an overly hard concept to get your head around.
  prefs: []
  type: TYPE_NORMAL
- en: What is Stationarity?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Overview
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To understand unit roots, we must first gain a clear understanding of [**stationarity**](https://www.youtube.com/watch?v=621MSxpYv60&t=4s).
    I have covered this topic in a previous blog and YouTube video, but we will quickly
    recap over the key points.
  prefs: []
  type: TYPE_NORMAL
- en: '[](/time-series-stationarity-simply-explained-125269968154?source=post_page-----dba24fa099f4--------------------------------)
    [## Time-Series Stationarity Simply Explained'
  prefs: []
  type: TYPE_NORMAL
- en: A simple and intuitive explanation for the need of stationarity in time-series
    modelling.
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/time-series-stationarity-simply-explained-125269968154?source=post_page-----dba24fa099f4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: 'A stationary time series is one with the following properties:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Constant mean through time*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Constant variance (auto covariance) through time*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Statistical properties do not change and are consistent*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In other words, the time series is not trending up or down in the long term,
    nor are its fluctuations increasing or decreasing through time.
  prefs: []
  type: TYPE_NORMAL
- en: Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Below is an example in Python of a non-stationary time series where the mean
    and variance are constantly increasing:'
  prefs: []
  type: TYPE_NORMAL
- en: The data [sourced was from Kaggle](https://www.kaggle.com/datasets/ashfakyeafi/air-passenger-data-for-time-series-analysis)
    with a CC0 license.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Code GitHub Gist by author.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3af53709f3c5cce46b20cce879d99ab0.png)'
  prefs: []
  type: TYPE_IMG
- en: Plot generated by author in Python.
  prefs: []
  type: TYPE_NORMAL
- en: The time series is made stationary through the differencing (stabilise the mean)
    and the logarithm (stabilise the variance) transform.
  prefs: []
  type: TYPE_NORMAL
- en: 'See blog or video above for more information on these transformations:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Code GitHub Gist by author.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/70b503ce51f567e8704297c74fd01bf6.png)'
  prefs: []
  type: TYPE_IMG
- en: Plot generated by author in Python.
  prefs: []
  type: TYPE_NORMAL
- en: Notice how the mean and variance are roughly constant and don’t change throughout
    the plot.
  prefs: []
  type: TYPE_NORMAL
- en: Why do we need it?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The requirement for stationarity comes from how we build forecasting models.
    Most models, such [**ARIMA**](https://medium.com/towards-data-science/how-to-forecast-with-arima-96b3d4db111a),
    require the data to come from the same distribution so it can fit parameters to
    the underlying distribution.
  prefs: []
  type: TYPE_NORMAL
- en: If the time series is stationary, it has consistent statistical properties.
    This means the [**joint distribution**](https://medium.com/towards-artificial-intelligence/conditional-probability-and-bayes-theorem-simply-explained-788a6361f333)
    between data points doesn’t change, therefore they can be seen as belonging to
    the same distribution. Thus, allowing us to fit forecasting models.
  prefs: []
  type: TYPE_NORMAL
- en: Weakly vs Strongly Stationary
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The final concept I want to discuss is the difference between *weakly* and *strongly*
    stationary. This is not super important, but very useful to build context around
    the idea of stationarity.
  prefs: []
  type: TYPE_NORMAL
- en: '***Weakly:*** *A time series is weakly stationary if the mean and variance
    are constant.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***Strongly****: A time series is strongly stationary if the joint distribution
    of the data points is invariant over time. In other words, they belong to the
    same distribution.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'At first, this concept may seem confusing but let me give you an example. If
    our time series has a constant mean and variance and is generated from a [**normal
    distribution**](https://en.wikipedia.org/wiki/Normal_distribution), then it is
    both weakly and strongly stationary. This is because the normal distribution is
    a function of two parameters: the mean and variance.'
  prefs: []
  type: TYPE_NORMAL
- en: However, there are instances where the mean and variances are constant but the
    data points can all belong to different distributions. The first data point may
    be a [**Poisson distribution**](/predicting-the-unpredictable-an-introduction-to-the-poisson-distribution-5afd4d70b1d7),
    the second may be an [**Exponential distribution**](/exponential-distribution-simply-explained-349d05b1bdb8),
    etc. In this case, it is weakly stationary but not strongly stationary.
  prefs: []
  type: TYPE_NORMAL
- en: See [here](https://en.wikipedia.org/wiki/Stationary_process) if you want to
    learn more about weak vs strong stationarity
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Unit Root Explained
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Stationarity — Unit Root Link
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: How does stationarity link to unit-roots? Well, if our time series *contains
    a unit root then it is not stationary.*
  prefs: []
  type: TYPE_NORMAL
- en: Most stationarity statistical tests are unit root tests, as they are looking
    for a unit root to determine if the time series is stationary with a given level
    of confidence. Test include the [**augmented dickey-fuller**](https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test)
    test and the [**Phillips–Perron test**](https://en.wikipedia.org/wiki/Phillips%E2%80%93Perron_test)**.**
  prefs: []
  type: TYPE_NORMAL
- en: A Simple Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The best way to demonstrate the unit root is through the simple AR(1) model,
    [**an autoregressive model**](https://medium.com/towards-data-science/how-to-forecast-time-series-using-autoregression-1d45db71683)
    with 1 lag:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2609b58934045184f7cc9589d40b8287.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1). Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Where:'
  prefs: []
  type: TYPE_NORMAL
- en: '***y****: is the time series at different time steps* ***t.***'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***φ****: is the coefficient for the first lag term.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***ε*:** *is some stochastic noise of identically distributed random variables
    with mean* ***0*** *and constant variance* ***σ²****.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The above equation can be re-written by expressing the AR(1) model as a MA(∞)
    ([**Moving Average**](/how-to-forecast-with-moving-average-models-6f3c9cbba60d#:~:text=This%20is%20where%20you%20forecast,%2Daverage%20(MA)%20model.))
    process through recursion:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/882c2bb25dc4bdf045b8cbc0c88d4f25.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1) recursion substitution. Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Carrying on this substitution we get:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cbac7a8654eaef59f2109d14e374575f.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1) as MA(∞). Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'The above equation can then be simplified to:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2459de4753839ea5f6266a8fbb3253ab.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1) as MA(∞) simplified. Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: Now, for the AR(1) equation, it has a unit root when |***φ| = 1.***
  prefs: []
  type: TYPE_NORMAL
- en: For models with more lags, the unit root becomes harder to define and relies
    on the [**characteristic equation**](https://en.wikipedia.org/wiki/Characteristic_equation_%28calculus%29)(remember
    we saw this quoted in the Wikipedia definition!)**.** Don’t, worry too much about
    this as it’s out of the scope of this article, and is not required to grasp the
    intuition behind the unit root.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'So, the equation in the presence of a unit root becomes:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a44b981c96f6727f8104cbab72cdb84d.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1) with unit root. Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some of you may realise this as the famous [**random walk**](https://en.wikipedia.org/wiki/Random_walk).
    The above equation can be re-written in recursive form as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1692ab658e4830ed1101de3c3e2ceab3.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1) with unit root re-written. Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, the mean (expected value) of the above equation is simply:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bfecb225827ba5b81a7bb66e9e4c3513.png)'
  prefs: []
  type: TYPE_IMG
- en: Expected value of time series. Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: This is because ***ε*** is from the standard normal distribution which has a
    mean of **0** and variance of **σ².** Therefore, the expected value of ***y_t***
    is then just ***y_0***. This is good because the mean is constant and we meet
    that specific requirement of stationarity.
  prefs: []
  type: TYPE_NORMAL
- en: '*What about the variance?*'
  prefs: []
  type: TYPE_NORMAL
- en: 'Well, from the above equation, the value of ***y_0*** has no variance, but
    ***ε*** has a variance of ***σ²*.** Therefore, the variance is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1955dff99eeabe58e10cf707fe081bd6.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: See [here](https://rinterested.github.io/statistics/time_series_var_cov.html#:~:text=AUTOREGRESSIVE%20ORDER%20ONE%20(AR%20(1,%5BXt%E2%88%921%5D.)
    for a comprehensive proof of the above formula.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: We can see that the variance depends on ***t. Var(y_1)*** is ***σ², Var(y_2)***
    is ***2σ²*** etc. So, the variance is getting larger through time.
  prefs: []
  type: TYPE_NORMAL
- en: The variance is increasing through time, so the time series by definition is
    not stationary!
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Therefore, we conclude that the presence of a unit root in our time series renders
    it non-stationary.
  prefs: []
  type: TYPE_NORMAL
- en: An Intuitive Explanation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Consider the AR(1) equation again:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2609b58934045184f7cc9589d40b8287.png)'
  prefs: []
  type: TYPE_IMG
- en: AR(1). Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: What ***φ*** is telling us is how much the value of today depends on the previous
    value, plus some random noise from the standard normal distribution. If ***φ <
    1,*** then the time series will naturally *revert* to the origin if our starting
    point is ***0, y_0 = 0***. Multiplying by a number less than ***1*** will make
    it smaller and eventually converge to ***0***. As it will always *revert* then
    it’s predictable and its variance won’t change over time.
  prefs: []
  type: TYPE_NORMAL
- en: In the unit root case, |***φ| = 1***, then the time series won’t revert to the
    origin. If we have a good run of positive values, the time series will simply
    stay there as the next forecast is equal to the last value.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, let’s say we have two different AR(1) models:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/964209d88ab3c8325bc2b482c53a3f9c.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: '*Equation 1* hasn’t got a unit root but *equation 2* does. Let’s say both models
    start from ***y_0 = 0\.*** Now, after some time we reach ***y_5 = 5*** for both
    models. But, what will happen next?'
  prefs: []
  type: TYPE_NORMAL
- en: As the error ***ε*** has a mean of ***0***, *equation 1* will slowly trend back
    to the origin, so ***y_6 = 4***, ***y_7 = 3.2,*** etc. However, *equation 2* will
    simply stay at that level ***y_6 = 5***, ***y_7 = 5*** etc.
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, the presence of the unit root makes the time series unpredictable
    in the long run and affected by ‘shocks’ to the system. This is why we deem it
    to be non-stationary.
  prefs: []
  type: TYPE_NORMAL
- en: Summary & Further Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The unit root is a fundamental concept for time series analysis and is arguably
    the backbone of stationarity, which is the most fundamental requirement when building
    many forecasting models. A time series has a unit root if any of its solutions
    from the characteristic equation is 1\. This leads to a changing variance through
    time, that breaks one of the requirements for stationarity. Therefore, most stationarity
    statistical tests all look for a unit root to decide if the time series is stationary.
    It is important to note that we don’t need to remember all the maths around the
    unit root, but rather understand the key concepts and why it leads to non-stationary
    time series!
  prefs: []
  type: TYPE_NORMAL
- en: References & Further Reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Great video on unit roots*](https://www.youtube.com/watch?v=ugOvehrTRRw&t=667s)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Wikipedia article has some great insight*](https://en.wikipedia.org/wiki/Unit_root)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Quora thread on unit roots*](https://www.quora.com/What-is-unit-root-in-a-time-series)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Another Thing!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have a free newsletter, [**Dishing the Data**](https://dishingthedata.substack.com/),
    where I share weekly tips for becoming a better Data Scientist. There is no “fluff”
    or “clickbait,” just pure actionable insights from a practicing Data Scientist.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://newsletter.egorhowell.com/?source=post_page-----dba24fa099f4--------------------------------)
    [## Dishing The Data | Egor Howell | Substack'
  prefs: []
  type: TYPE_NORMAL
- en: How To Become A Better Data Scientist. Click to read Dishing The Data, by Egor
    Howell, a Substack publication with…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: newsletter.egorhowell.com](https://newsletter.egorhowell.com/?source=post_page-----dba24fa099f4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Connect With Me!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**YouTube**](https://www.youtube.com/@egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**LinkedIn**](https://www.linkedin.com/in/egor-howell-092a721b3/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Twitter**](https://twitter.com/EgorHowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**GitHub**](https://github.com/egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

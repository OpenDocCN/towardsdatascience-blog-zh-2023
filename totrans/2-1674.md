# 预测高急诊室使用率

> 原文：[https://towardsdatascience.com/predicting-high-emergency-room-visit-rates-5fff6a8950f4](https://towardsdatascience.com/predicting-high-emergency-room-visit-rates-5fff6a8950f4)

## 使用Python分析健康的社会决定因素（SDOH）

[](https://meaganburkhart.medium.com/?source=post_page-----5fff6a8950f4--------------------------------)[![Meagan Burkhart](../Images/d977e25bd5f9bd6e83f92511adaef3f1.png)](https://meaganburkhart.medium.com/?source=post_page-----5fff6a8950f4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----5fff6a8950f4--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----5fff6a8950f4--------------------------------) [Meagan Burkhart](https://meaganburkhart.medium.com/?source=post_page-----5fff6a8950f4--------------------------------)

·发布于[数据科学前沿](https://towardsdatascience.com/?source=post_page-----5fff6a8950f4--------------------------------) ·10分钟阅读·2023年5月23日

--

![](../Images/8243a7071de7f2d759a8422c5f9c8dec.png)

照片由[国家癌症研究所](https://unsplash.com/@nci?utm_source=medium&utm_medium=referral)拍摄，[来自Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

本项目的目标是利用来自[AHRQ](https://www.ahrq.gov/sdoh/data-analytics/sdoh-data.html)的按县划分的社会决定因素（SDoH）数据，查找特定变量与县急诊就诊率之间的关系。**最终**，我希望开发一个与高急诊率相关的顶级特征的预测模型。我决定查看2019年和2020年的数据（2018年数据不可用）。该数据集经过[AHRQ](https://www.hrsa.gov/)的明确许可使用。

这个逐步教程介绍了我加载、清理、分析和建模数据的过程。

# 加载数据

第一步是加载两个数据文件并检查其形状。

![](../Images/0221870504bac18d6454721b7b230469.png)

作者的代码

由于两个数据框的列数不同，我将导入数据字典并提取相同的列。

我根据列名（内连接）合并了数据字典，以获取最终的公共列列表。一旦获得列，我选择了每个数据框中这些列的子集，并将它们与轴=0进行连接，以垂直添加它们。我的df_final包含了2019年和2020年数据中的公共列。

[PRE0]

# 关于数据

该数据有674列，因此我们需要尝试缩小需要查看的特征。让我们从我感兴趣的变量——急诊访问率开始。

数据集包括每1,000名男性医疗保险（双重和非双重）受益人的急诊科访问次数。然而，数据提供了单独的男性和女性比率，因此我将创建一个加权平均的整体急诊率。

为此，我将比率分别乘以男性的百分比和女性的百分比，然后将这些值相加。

**男性ED比率**：597.1129158207091

**女性ED比率**：639.9023742580443

[PRE1]

# 数据清理

![](../Images/f8944cb315306f080c995b6ce8d58806.png)

查看数据框后，我们可以看到一些县的数据缺失。为了解决这个问题，我删除了某些列，并用均值插补了其他列。

对于这个项目，我们将删除ED比率计算中缺失值的行，因为这意味着他们没有相关的急诊访问数据。

然后，我们将找到数据集的80百分位数，作为‘高ED比率’的截断点。这将成为我未来预测的结果变量。整体ED比率将用于相关性和探索性数据分析。

[PRE2]

为了处理一些缺失数据，我开始时删除了任何缺失值超过10%的列。然后，我得到了剩余列中有缺失值的列表，如下所示。

[PRE3]

我们先用均值对所有浮点型列进行简单插补。首先，我们需要将训练集和测试集分开：

[PRE4]

接下来，我们将选择所有浮点型列，以便我们可以运行每个特征与目标特征之间的相关性分析。根据相关性，我们将设定阈值，并保留那些与ED比率显著正相关或负相关的列。

[PRE5]

我制作了一个最终的列列表，如下所示：

[PRE6]

我们最终得到了140列。在打印列的列表后，我意识到我仍然需要进一步清理 -

我们要确保不包括任何包含ED的变量，因此我们会通过以下代码过滤掉所有这些列，以及我们计算出的女性比率和男性比率。

[PRE7]

这使我们剩下了140列。我们将数据集缩小到112列。但现在我查看列的列表时，看到我们还应排除任何包含_IP（住院）、_PA（急性后期）和_EM（E&M）的列。我们也不关心每月的最低和最高温度，因此我会删除这些列。

[PRE8]

基于对输出的另一轮仔细检查，我发现有些特征测量的是非常相似的事物（即整体估计百分比与年龄X-Y）。如果整体值存在，就删除那些指定年龄范围的列。此外，PQI在所有不同的人群子集中的重复，因此我们将采用加权平均来找出整体比率，就像我们之前用ED比率一样。

[PRE9]

我还从数据字典中提取了所有列的完整标签，并审查了它们，以确保所有列在我对医疗分析的背景知识下都是实用的。

![](../Images/003e39e2679b1ecb204e040d7e450c4a.png)

最终结果得到78个可以使用的列。接下来，我想快速可视化这些变量与EDrate之间的关系，于是写了一个小循环来创建散点图：

[PRE10]

![](../Images/f31cd17bc3f0f6d8438d67813a0e09fb.png)

本分析的下一部分涉及开发几个预测模型。在这个项目中，我使用了逻辑回归、支持向量机、随机森林分类器和XGBoost分类器。我们首先测试的是逻辑回归和SVM，因此需要对数据进行缩放。

我选择了MinMaxScaler来尝试减少异常值的影响。

[PRE11]

# 逻辑回归

如果你对分类问题不熟悉，可以查看[逻辑回归介绍](/introduction-to-logistic-regression-66248243c148)这篇文章，由[Ayush Pant](https://medium.com/u/49005e363e74?source=post_page-----5fff6a8950f4--------------------------------)撰写。对于这次逻辑回归，我决定设置class_weight=’balanced’，因为这是一个不平衡的分类问题：

[PRE12]

下方的混淆矩阵显示了TP、TN、FP和FN。我们还打印了分类报告。

[PRE13]

![](../Images/369f68985f2c3777855b05fa7e2cfb18.png)![](../Images/7ee4a6d7c24c59ca72eb24798381a3bc.png)

# 支持向量机

我尝试的下一个模型是支持向量机。如果这是一个你不熟悉的话题，我推荐查看[Ajay Yadav](https://medium.com/u/1c3ce86ec41f?source=post_page-----5fff6a8950f4--------------------------------)的文章[支持向量机(SVM)](/support-vector-machines-svm-c9ef22815589)

在我的项目中，我对类别权重进行了调整，以观察哪些设置能在模型结果方面取得平衡。

[PRE14]

![](../Images/b14fe9ea72a7f676c4aab23cc0bc9c9f.png)

接下来要测试的模型是随机森林分类器和XGBoost。由于基于树的模型不需要缩放，我将使用原始的X数据来进行这两项测试。

# 随机森林分类器

在你开始运行随机森林分类器之前，可能需要阅读一篇背景文章，例如[Tony Yiu](https://medium.com/u/840a3210fbe7?source=post_page-----5fff6a8950f4--------------------------------)的文章[理解随机森林](/understanding-random-forest-58381e0602d2)。一旦你对概念有了良好的理解，可以尝试运行下面的简单示例代码：

[PRE15]

![](../Images/21ae5a5c5f5a9b7d9943d034b01cc142.png)

到目前为止，我们的随机森林分类报告如下：

![](../Images/12db649076115ff468d68faa36630970.png)

凭借94%的准确率，这个模型表现得相当不错，但我对假阴性率感到担忧。让我们看看XGBoost是否能做得更好。

# XGBoost

对XGBoost不熟悉？查看[George Seif](https://medium.com/u/e2af5c8737ec?source=post_page-----5fff6a8950f4--------------------------------)的文章——[XGBoost初学者指南](/a-beginners-guide-to-xgboost-87f5d4c30ed7)，在运行下面的代码之前熟悉一下提升树。

[PRE16]

![](../Images/c82de126de34c5799607a8cfea008a6f.png)![](../Images/b63b6290861e2a62cfb67283b587d3ef.png)

看起来随机森林分类器是明显的赢家，具有更高的准确性、精确度、召回率和 f1。

让我们来看看一些特征重要性值：

[PRE17]

![](../Images/5d0c766837c24798234959bef0055c59.png)

[PRE18]

![](../Images/a619cfe28113a5bbc08ab2dfe0599ad3.png)

# 主要发现

1.  **最重要的特征是黑人女性的比例**

— 这表明少数群体在急性医疗方面面临更大的困难，任何歧视或健康不平等问题应立即解决。

2. **残疾退伍军人的比例也是一个重要特征**

— 这表明残疾和退伍军人身份导致了急诊科的高使用率，需要解决潜在的风险因素

3. **SHAP 值显示 PQI 和过去 12 个月领取食物券/SNAP 的家庭比例有显著影响**

— 这间接地将社会经济地位与健康不良结果联系起来，表明如果医疗提供者能够在这一领域提供帮助，患者可能不会那么频繁地去急诊科。

# 推荐和未来方向

基于这些发现，医疗保健领域的数据专业人员可能考虑开发预测模型，以隔离与健康不良结果相关的社会决定因素特征。

希望目标医疗程序可以解决诸如由于种族、残疾或社会经济地位而产生的歧视等社会决定健康需求。通过为高风险个体或高风险区域提供更密集的护理和支持，医疗保健分析师可以致力于在非急性（非急诊）环境中更好地治疗这些患者。

这可以通过社区健康设施、家庭护理机构以及与健康保险公司合作的其他伙伴来实现。

# 结论

在这篇文章中，我介绍了一个与社会决定健康相关的公共数据集。通过分析2019年和2020年的数据，我得出了几个预测模型。该模型的目标是根据社会决定健康因素预测一个县是否会有高急诊科使用率。我的分析中最好的模型是随机森林分类器。我们回顾了驱动模型的核心特征，并解释了对医疗保健分析师的影响。

— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —

查看 [我的 GitHub](https://github.com/meagvo/SDOHproject/tree/master/SDOHproject) 上的整个笔记本

如果你是 Medium 的新用户，喜欢这样的故事，可以在[这里](https://medium.com/@meagvo/membership)注册。

*互联网引用：* 社会决定健康数据库。内容最后审查于2022年11月。医疗保健研究与质量局，罗克维尔，MD。[https://www.ahrq.gov/sdoh/data-analytics/sdoh-data.html](https://www.ahrq.gov/sdoh/data-analytics/sdoh-data.html)

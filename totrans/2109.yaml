- en: Time Series Forecasting with Facebook’s Prophet in 10 Minutes — Part 1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/time-series-forecasting-with-facebooks-prophet-in-10-minutes-958bd1caff3f](https://towardsdatascience.com/time-series-forecasting-with-facebooks-prophet-in-10-minutes-958bd1caff3f)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Build a working model with 6 lines of code
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://guillaume-weingertner.medium.com/?source=post_page-----958bd1caff3f--------------------------------)[![Guillaume
    Weingertner](../Images/fbfb34af986a7788394b6033c6954d57.png)](https://guillaume-weingertner.medium.com/?source=post_page-----958bd1caff3f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----958bd1caff3f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----958bd1caff3f--------------------------------)
    [Guillaume Weingertner](https://guillaume-weingertner.medium.com/?source=post_page-----958bd1caff3f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----958bd1caff3f--------------------------------)
    ·6 min read·Mar 23, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5229e96a7d81abdd74c0b1b14ccefc02.png)'
  prefs: []
  type: TYPE_IMG
- en: Prophet’s output — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '#1 Motivation'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The added value a time series forecasting model can bring to the decision making
    process in a business is undeniable. I recently built one which had such an impact
    that I thought I’d share the approach here.
  prefs: []
  type: TYPE_NORMAL
- en: 'When trying to make predictions about the future values of a target variable,
    there are 2 main categories of forecasting models:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Traditional Time Series Models** and **Machine Learning Models**.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a3d728784e3205eecb95c58c4347ae43.png)'
  prefs: []
  type: TYPE_IMG
- en: Time Series Models — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: With **univariate time series models**, the idea is to make predictions of future
    values based solely on trends and seasonality of past data of the target variable
    (the one we try to forecast) and nothing else. Multivariate models are an extension
    of that, where the input can be multiple time series.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With **(supervised) machine learning models**, the idea is to use other explanatory
    variables and model their relationship with the target variable to make predictions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In this article, you guessed it, we will focus on the traditional approach,
    and we will try to answer a simple question: **can we use the past values of a
    series to forecast the future ones QUICKLY?** This question arises in countless
    areas: the stock market movements, the sales of a company, the emission of CO2
    into the atmosphere, …'
  prefs: []
  type: TYPE_NORMAL
- en: The thing is, quite often, to answer business questions, you are not after the
    very best model with an accuracy which would win Machine Learning challenges,
    but just after a good enough estimate which allows for a data driven decision.
  prefs: []
  type: TYPE_NORMAL
- en: This is where **Facebook’s Prophet** comes in. It is an off the shelf algorithm,
    easy to set up and giving decent results with very little effort.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s see how to use it out of the box and get results in a matter of minutes.
  prefs: []
  type: TYPE_NORMAL
- en: '#2 The Business Problem'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For this quick tutorial, we will use a generated dataset representing the sales
    of a made-up company — The ABC Company (as you can probably tell, originality
    is not my strongest suit).
  prefs: []
  type: TYPE_NORMAL
- en: '*Quick disclaimer: this dataset is fictitious and is only used to illustrate
    the use of Prophet through an example that is well suited for Time Series Forecasting.*'
  prefs: []
  type: TYPE_NORMAL
- en: First, let’s import the necessary libraries to load and plot the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This is what our data frame looks like: the daily sales of the fictitious ABC
    Company:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/de97b228a3b3e4adbe5894282be4db4c.png)'
  prefs: []
  type: TYPE_IMG
- en: Made up dataset — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'We can plot it to highlight two things of interest:'
  prefs: []
  type: TYPE_NORMAL
- en: a clear uptrend year over year — the sales are growing over time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a seasonality within the year — the company sells more in the first half of
    the year than in the second
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/1824b56423b1b87c31cb34a244625b0f.png)'
  prefs: []
  type: TYPE_IMG
- en: Sales over time of the well known ABC Company — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Now, the goal of this entire little operation is to make predictions about future
    sales — from January 2023 onwards.
  prefs: []
  type: TYPE_NORMAL
- en: Because we are using *Prophet*, a univariate time series model, we only use
    the past sales figures (seasonality and trend) to predict the future sales figures.
  prefs: []
  type: TYPE_NORMAL
- en: Note that you could add additional time series as inputs to the model, essentially
    making *Prophet* a multivariate model.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s see how this works.
  prefs: []
  type: TYPE_NORMAL
- en: '#3 Setting up the Model'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you’ve never used *Prophet* before you will need to install it using pip
    or conda and import it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Now let’s actually build the model and make predictions.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you played around with Machine Learning models before, the next steps should
    look familiar:'
  prefs: []
  type: TYPE_NORMAL
- en: Rename the columns to be called ‘ds’ and ‘y’. This is essential for *Prophet*
    to work
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a *Prophet* instance and train / fit the model on past data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use the model to make predictions on future data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'And this is what the forecast looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7bac3d1f8dc9b0a0bbef79b7c130ea96.png)'
  prefs: []
  type: TYPE_IMG
- en: Result of this first Prophet model out of the box — yhat is the prediction —
    Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Facebook’s *Prophet* is an *additive regression model,* where the final prediction
    (yhat) is the sum of all the components (trend and seasonalities) modeled separately.
  prefs: []
  type: TYPE_NORMAL
- en: '***yhat(t) = g(t) + s(t) + h(t) + e(t)***, where'
  prefs: []
  type: TYPE_NORMAL
- en: '*g(t)* = growth over time (trend)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*s(t)* = seasonalities (weekly, yearly, …)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*h(t)* = holidays (not yet modeled in our use case)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*e(t)* = white noise error term (not yet present in our use case)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It took **a grand total of 6 lines of code** to build a first working model.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two graphs which are interesting to look at to get a clearer picture
    of the results:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The first plot is the actual forecast over time:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/c3db85e5332805d40c9dbad661578243.png)'
  prefs: []
  type: TYPE_IMG
- en: Prophet’s output — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'You can probably tell that there are 3 different elements on this graph:'
  prefs: []
  type: TYPE_NORMAL
- en: the black dots represent our actual past data points
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: the blue line is the model which was fit through the data points and extrapolated
    into the future (on the last 60 days of the graph)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: the light blue space is the uncertainty interval
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The second plot which is interesting to look at is the breakdown of the components
    of the model. This illustrates the trend and seasonalities models we mentioned
    just before.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/889aadb8f71330daf662912955da7584.png)'
  prefs: []
  type: TYPE_IMG
- en: Prophet’s components — Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'For now, in this very basic model, we only have 3 components:'
  prefs: []
  type: TYPE_NORMAL
- en: The **trend** which is growing over time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **weekly seasonality** which shows fewer sales on weekends
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **yearly seasonality** which clearly shows two periods of different sales
    volumes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We’ll see in *part 2* that we can add more features to improve the performance
    of the model.
  prefs: []
  type: TYPE_NORMAL
- en: '**Note that a forecast, by nature, is uncertain but building this model can
    help identifying trends or planning for potential scenarios which unquestionably
    provide added value in the decision-making process.**'
  prefs: []
  type: TYPE_NORMAL
- en: '#4 What’s next?'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Of course this is not a satisfying outcome (yet) as the quality of the forecast
    is unknown and it would be hard to make any sort of decisions based solely on
    what this basic “black box” model spat out.
  prefs: []
  type: TYPE_NORMAL
- en: 'However this is a great starting point. The next steps will consist of:'
  prefs: []
  type: TYPE_NORMAL
- en: Assessing the model’s performance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understanding the black box and the relevant hyper-parameters
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fine tune the model’s hyper-parameters to increase its performance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Stay tuned for part 2!**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Useful Resources**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[1] Official Prophet documentation: [https://facebook.github.io/prophet/](https://facebook.github.io/prophet/)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Advanced Forecasting with Python: With State-of-the-Art-Models Including
    LSTMs, Facebook’s Prophet, and Amazon’s DeepAR by Joos Korstanje'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] Practical Time Series Analysis: Prediction with Statistics and Machine
    Learning by Aileen Nielsen'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] A useful website explaining Time Series Forecasting and give a quick look
    at Prophet’s equation: [https://otexts.com/fpp3/prophet.html](https://otexts.com/fpp3/prophet.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '*Thanks for reading all the way to the end of the article.'
  prefs: []
  type: TYPE_NORMAL
- en: Follow for more!
  prefs: []
  type: TYPE_NORMAL
- en: Feel free to leave a message below, or reach out to me through* [*LinkedIn*](https://www.linkedin.com/in/guillaume-weingertner-a4a27972/)
    *if you have any questions / remarks!*
  prefs: []
  type: TYPE_NORMAL

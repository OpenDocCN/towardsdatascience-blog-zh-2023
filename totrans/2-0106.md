# 5 个函数是管理数据所需的全部工具

> 原文：[https://towardsdatascience.com/5-functions-is-all-you-need-to-manage-your-data-with-dplyr-1630825c47b0](https://towardsdatascience.com/5-functions-is-all-you-need-to-manage-your-data-with-dplyr-1630825c47b0)

## 如何高效地使你的数据准备就绪

[](https://sonery.medium.com/?source=post_page-----1630825c47b0--------------------------------)[![Soner Yıldırım](../Images/c589572e9d1ee176cd4f5a0008173f1b.png)](https://sonery.medium.com/?source=post_page-----1630825c47b0--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1630825c47b0--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1630825c47b0--------------------------------) [Soner Yıldırım](https://sonery.medium.com/?source=post_page-----1630825c47b0--------------------------------)

·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1630825c47b0--------------------------------) ·8分钟阅读·2023年3月10日

--

![](../Images/37b7af736531d661d732e23977fce5dd.png)

照片由 [Kelly Sikkema](https://unsplash.com/@kellysikkema?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 提供，来源于 [Unsplash](https://unsplash.com/photos/-1_RZL8BGBM?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

那些处理过真实数据的任务的人知道，大部分的工作都集中在数据整理上。

我所说的数据整理包括将数据准备好以供其他利益相关者或下游过程使用的操作。

无论你是数据分析师、数据科学家，还是数据工程师，你都需要在日常工作中执行以下一种或多种操作：

+   过滤（例如，给我德克萨斯州的销售数据）

+   排序（例如，我想查看上周的前10名畅销产品）

+   更新（例如，更改这些产品的类别）

+   总结（例如，我想查看每个类别的平均收入）

数据分析和操作工具存在于数据科学生态系统中，以提供高效的操作方式，从而在生态系统中保持其存在。

在这篇文章中，我们将学习如何使用数据科学中主要工具之一：dplyr 来处理这些任务。

这是一个针对R编程语言的包，被描述为“数据操作的语法”。

我们可以单独安装 dplyr，也可以使用 [tidyverse](https://www.tidyverse.org/)，这是一个用于数据科学的R包集合。我更喜欢后者，因为它允许我使用 tidyverse 中其他包的一些函数（例如 read_csv 来自 readr）。

让我们从导入库和读取数据集开始。我们将使用我准备的模拟数据的样本数据集。你可以从我的 [datasets](https://github.com/SonerYldrm/datasets) 仓库下载它。

[PRE0]

结果对象是一个 tibble，类似于 DataFrame 或表格。

所有数据处理挑战都可以归结为使用以下 5 个函数中的一个或多个：

+   select

+   mutate

+   filter

+   arrange

+   summarise

# **1\. 选择**

select 函数可用于选择列。它允许我们通过保留或删除列来进行选择，依据列的名称和类型。

让我们通过几个示例来了解 select 的工作方式。以下示例展示了如何选择特定的列。

[PRE1]

我们也可以通过排除（删除）一个或多个列来进行选择，方法是使用“！”：

[PRE2]

如果我们选择多个连续的列，使用“:”定义范围会更方便。

[PRE3]

我们还可以使用列索引，因此以下操作与上述操作相同：

[PRE4]

我们还可以根据列的数据类型选择列。例如，以下示例选择了数值列。

[PRE5]

通过使用相同的谓词函数（即 where），我们可以选择非数字列，如下所示：

[PRE6]

# 2\. mutate

mutate 函数顾名思义，通过更新现有列或创建新列来修改 tibble。

例如，我们可以将价格值增加 10%：

[PRE7]

我们还可以创建新列：

[PRE8]

多次更新可以在一次操作中完成。在做一个示例演示这种情况之前，我们先提到两个非常有用的功能：

+   我们可以使用“%>%”运算符将不同类型的操作组合在一起，以创建管道并解决涉及多个步骤的复杂任务。

+   新列会立即可用，因此我们可以在同一个 mutate 函数中使用它们。

这里是一个示例，展示了上述两个功能：

[PRE9]

在上述示例中，我们首先从 sales 中选择价格和成本列，并从价格列创建 price_updated 列，然后使用这个新列创建 profit_updated 列。

# 3\. 筛选

filter 函数允许我们根据条件或条件集筛选观察值（即行）。

以下示例筛选出价格超过 1000 的行。

[PRE10]

让我们使用一个更复杂的筛选条件：

[PRE11]

如果我们有一个包含多个值的条件，可以使用“%in%”运算符。

[PRE12]

# 4\. 排序

arrange 函数根据列中的值对行进行排序。它类似于 SQL 的 order by 和 Pandas 的 sort_values 函数。

[PRE13]

默认情况下，排序是按升序进行的。我们可以通过在列名之前添加“ -”来将其更改为降序。

[PRE14]

要按多个列排序，我们可以用逗号分隔列名。以下示例按商店名称排序，然后按 last_week_sales（降序）排序。

[PRE15]

# 5\. 总结

它将组汇总为一行。结合 group_by 函数，我们可以使用它来计算组的聚合值。这一操作类似于 SQL 的 group by 和 Pandas 的 groupby 函数。

[PRE16]

有几个聚合函数可以从数据中提取见解并进行深入分析。

这是来自官方文档的列表：

+   中心: `[mean()](https://rdrr.io/r/base/mean.html)`、`[median()](https://rdrr.io/r/stats/median.html)`

+   分布: `[sd()](https://rdrr.io/r/stats/sd.html)`、`[IQR()](https://rdrr.io/r/stats/IQR.html)`、`[mad()](https://rdrr.io/r/stats/mad.html)`

+   范围: `[min()](https://rdrr.io/r/base/Extremes.html)`、`[max()](https://rdrr.io/r/base/Extremes.html)`，

+   位置: `[first()](https://dplyr.tidyverse.org/reference/nth.html)`、`[last()](https://dplyr.tidyverse.org/reference/nth.html)`、`[nth()](https://dplyr.tidyverse.org/reference/nth.html)`，

+   计数: `[n()](https://dplyr.tidyverse.org/reference/context.html)`、`[n_distinct()](https://dplyr.tidyverse.org/reference/n_distinct.html)`

+   逻辑: `[any()](https://rdrr.io/r/base/any.html)`、`[all()](https://rdrr.io/r/base/all.html)`

本文中涵盖的函数可以帮助你完成几乎所有的数据处理和分析工作。将它们一起使用在管道中提供了更大的灵活性。

*你可以成为* [*Medium会员*](https://sonery.medium.com/membership) *来解锁我写作的全部内容，以及Medium的其他内容。如果你已经是会员，请不要忘记* [*订阅*](https://sonery.medium.com/subscribe) *，这样你会在我发布新文章时收到电子邮件。*

感谢你的阅读。请告诉我你的反馈意见。

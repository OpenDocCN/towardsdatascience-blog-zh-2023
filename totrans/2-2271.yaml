- en: Using Machine Learning to Create Custom Color Palettes
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æœºå™¨å­¦ä¹ åˆ›å»ºè‡ªå®šä¹‰è‰²å½©è°ƒè‰²æ¿
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/using-machine-learning-to-create-custom-color-palettes-acb4eeaa06aa](https://towardsdatascience.com/using-machine-learning-to-create-custom-color-palettes-acb4eeaa06aa)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/using-machine-learning-to-create-custom-color-palettes-acb4eeaa06aa](https://towardsdatascience.com/using-machine-learning-to-create-custom-color-palettes-acb4eeaa06aa)
- en: Behind the scenes look at Streamlitâ€™s app of the month
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ·±å…¥äº†è§£Streamlitçš„æœ¬æœˆåº”ç”¨
- en: '[](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)[![Siavash
    Yasini](../Images/55220a8a9397ba51dcc381828735f4a2.png)](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)[](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)
    [Siavash Yasini](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)[![Siavash
    Yasini](../Images/55220a8a9397ba51dcc381828735f4a2.png)](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)[](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)
    [Siavash Yasini](https://medium.com/@siavashyasini?source=post_page-----acb4eeaa06aa--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)
    Â·12 min readÂ·Feb 16, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨åœ¨[Towards Data Science](https://towardsdatascience.com/?source=post_page-----acb4eeaa06aa--------------------------------)
    Â·12åˆ†é’Ÿé˜…è¯»Â·2023å¹´2æœˆ16æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/1f09de41ab54258a22eed6764d2b2464.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1f09de41ab54258a22eed6764d2b2464.png)'
- en: Photo by [Ricardo Gomez Angel](https://unsplash.com/@rgaleriacom?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ç…§ç‰‡ç”±[Ricardo Gomez Angel](https://unsplash.com/@rgaleriacom?utm_source=medium&utm_medium=referral)æä¾›ï¼Œ[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: '**Intro**'
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**ä»‹ç»**'
- en: We all love getting our hands on a new dataset, exploring it, and learning from
    it. But raw numbers by themselves are not great storytellers. Our primal brains
    are wired for lines, shapes, and colors. Thatâ€™s why numbers need to be visualized
    to tell a good story.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éƒ½å–œæ¬¢æ¥è§¦æ–°çš„æ•°æ®é›†ã€æ¢ç´¢å®ƒï¼Œå¹¶ä»ä¸­å­¦ä¹ ã€‚ä½†åŸå§‹æ•°å­—æœ¬èº«å¹¶ä¸æ˜¯ä¼˜ç§€çš„è®²è¿°è€…ã€‚æˆ‘ä»¬åŸå§‹çš„å¤§è„‘å¤©ç”Ÿå¯¹çº¿æ¡ã€å½¢çŠ¶å’Œé¢œè‰²æ•æ„Ÿã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ•°å­—éœ€è¦è¢«å¯è§†åŒ–æ‰èƒ½è®²è¿°ä¸€ä¸ªå¥½çš„æ•…äº‹ã€‚
- en: The color palette of your data visualization can make or break your data story
    though. While coming up with the perfect set of colors for your data visualization
    can be an exacting and time-consuming task, you donâ€™t have to do it all on your
    own. Instead of starting from scratch, you can get inspiration from the greatest
    painters and artists in history.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®å¯è§†åŒ–çš„è‰²å½©è°ƒè‰²æ¿å¯èƒ½ä¼šå†³å®šä½ çš„æ•°æ®æ•…äº‹çš„æˆè´¥ã€‚è™½ç„¶ä¸ºä½ çš„æ•°æ®å¯è§†åŒ–æ‰¾åˆ°å®Œç¾çš„é¢œè‰²ç»„åˆå¯èƒ½æ˜¯ä¸€ä¸ªä¸¥æ ¼ä¸”è€—æ—¶çš„ä»»åŠ¡ï¼Œä½†ä½ ä¸å¿…å®Œå…¨ç‹¬è‡ªå®Œæˆã€‚ä½ å¯ä»¥ä»å†å²ä¸Šæœ€ä¼Ÿå¤§çš„ç”»å®¶å’Œè‰ºæœ¯å®¶é‚£é‡Œè·å¾—çµæ„Ÿã€‚
- en: '![](../Images/d50d19ef7363c358c55970608f26affd.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d50d19ef7363c358c55970608f26affd.png)'
- en: Image by Author
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Creating a color palette from scratch typically falls within the domain of expertise
    of visualization engineers and designers who use color theory to put together
    harmonious palettes suitable for various visualization purposes (e.g. *monochromatic*
    palettes for sequential or gradient plots, or *complimentary* palettes for categorical
    charts). Visualization packages like `[matplotlib](https://matplotlib.org/)` or
    `[plotly](https://plotly.com)` already come with an amazing collection of such
    color palettes.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ä»é›¶å¼€å§‹åˆ›å»ºè‰²å½©è°ƒè‰²æ¿é€šå¸¸æ˜¯å¯è§†åŒ–å·¥ç¨‹å¸ˆå’Œè®¾è®¡å¸ˆçš„ä¸“ä¸šé¢†åŸŸï¼Œä»–ä»¬ä½¿ç”¨è‰²å½©ç†è®ºæ¥ç»„åˆé€‚åˆå„ç§å¯è§†åŒ–ç›®çš„çš„å’Œè°è°ƒè‰²æ¿ï¼ˆä¾‹å¦‚ï¼Œ*å•è‰²*è°ƒè‰²æ¿ç”¨äºé¡ºåºæˆ–æ¸å˜å›¾ï¼Œæˆ–*äº’è¡¥*è°ƒè‰²æ¿ç”¨äºåˆ†ç±»å›¾è¡¨ï¼‰ã€‚åƒ`[matplotlib](https://matplotlib.org/)`æˆ–`[plotly](https://plotly.com)`è¿™æ ·çš„å¯è§†åŒ–åŒ…å·²ç»æä¾›äº†ä»¤äººæƒŠå¹çš„è°ƒè‰²æ¿é›†åˆã€‚
- en: While data analysts and data scientists can get by using pre-made color palettes,
    there are situations where we may want to put together our own custom palette.
    An example scenario is when you want to make a visualization that is aligned with
    your companyâ€™s color theme. For example, you may want to create a bar chart that
    has a theme matching your favorite companyâ€™s logo. It would be really nice to
    have an app that does this for you automatically, right?
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶æ•°æ®åˆ†æå¸ˆå’Œæ•°æ®ç§‘å­¦å®¶å¯ä»¥ä½¿ç”¨é¢„åˆ¶çš„é¢œè‰²è°ƒè‰²æ¿ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦è‡ªå·±åˆ›å»ºè‡ªå®šä¹‰è°ƒè‰²æ¿ã€‚ä¾‹å¦‚ï¼Œå½“ä½ æƒ³åˆ¶ä½œä¸€ä¸ªä¸å…¬å¸é¢œè‰²ä¸»é¢˜ä¸€è‡´çš„å¯è§†åŒ–æ—¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³åˆ›å»ºä¸€ä¸ªä¸å–œæ¬¢çš„å…¬å¸çš„
    logo ä¸»é¢˜åŒ¹é…çš„æŸ±çŠ¶å›¾ã€‚æœ‰ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨ä¸ºä½ å®Œæˆè¿™é¡¹å·¥ä½œçš„åº”ç”¨ç¨‹åºä¼šéå¸¸å¥½ï¼Œå¯¹å§ï¼Ÿ
- en: '![](../Images/b101e9b82ec488901cd97df3978afca1.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b101e9b82ec488901cd97df3978afca1.png)'
- en: Image by Author
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: '![](../Images/262ffc426620d97852cb8bd71881c38b.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/262ffc426620d97852cb8bd71881c38b.png)'
- en: Image by Author
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: I spend way too much time trying to come up with the perfect set of colors for
    my visualizations, so I decided to make the process a bit easier for myself.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘èŠ±è´¹äº†å¤ªå¤šæ—¶é—´è¯•å›¾ä¸ºæˆ‘çš„å¯è§†åŒ–æ‰¾å‡ºå®Œç¾çš„é¢œè‰²ç»„åˆï¼Œå› æ­¤æˆ‘å†³å®šè®©è¿™ä¸ªè¿‡ç¨‹å¯¹æˆ‘è‡ªå·±æ¥è¯´æ›´ç®€å•ä¸€äº›ã€‚
- en: 'I built a web app using [Streamlit](https://www.linkedin.com/company/streamlit/)
    ğŸˆ that can infer color palettes from any input image: paintings, movie posters,
    rock album covers, Christmas family photos, you name it! While the app may not
    give you the perfect color palette right out of the box, it will at least give
    you a great starting point.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä½¿ç”¨[Streamlit](https://www.linkedin.com/company/streamlit/) ğŸˆæ„å»ºäº†ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä»ä»»ä½•è¾“å…¥å›¾åƒä¸­æ¨æ–­é¢œè‰²è°ƒè‰²æ¿ï¼šæ— è®ºæ˜¯ç”»ä½œã€ç”µå½±æµ·æŠ¥ã€æ‘‡æ»šä¸“è¾‘å°é¢ï¼Œè¿˜æ˜¯åœ£è¯å®¶åº­ç…§ç‰‡ï¼Œåº”æœ‰å°½æœ‰ï¼è™½ç„¶åº”ç”¨ç¨‹åºå¯èƒ½ä¸ä¼šç«‹å³æä¾›å®Œç¾çš„é¢œè‰²è°ƒè‰²æ¿ï¼Œä½†è‡³å°‘ä¼šç»™ä½ ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚
- en: So letâ€™s see how I built this app.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘æ˜¯å¦‚ä½•æ„å»ºè¿™ä¸ªåº”ç”¨ç¨‹åºçš„ã€‚
- en: Building a Color Palette Inference App
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ„å»ºé¢œè‰²è°ƒè‰²æ¿æ¨æ–­åº”ç”¨ç¨‹åº
- en: '![](../Images/9fa1dc289439f16bba94504a7ba93a7a.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9fa1dc289439f16bba94504a7ba93a7a.png)'
- en: Image by Author
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: In order to create a color palette inference tool we need a few components.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†åˆ›å»ºä¸€ä¸ªé¢œè‰²è°ƒè‰²æ¿æ¨æ–­å·¥å…·ï¼Œæˆ‘ä»¬éœ€è¦å‡ ä¸ªç»„ä»¶ã€‚
- en: 'In this post, Iâ€™ll teach you:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ•™ä½ ï¼š
- en: How to construct an image-loading component
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚ä½•æ„å»ºä¸€ä¸ªå›¾åƒåŠ è½½ç»„ä»¶
- en: How to build an image enhancement component with sliders
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚ä½•æ„å»ºä¸€ä¸ªå¸¦æ»‘å—çš„å›¾åƒå¢å¼ºç»„ä»¶
- en: How to cluster pixels and use group averages to make a palette
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚ä½•å¯¹åƒç´ è¿›è¡Œèšç±»å¹¶ä½¿ç”¨ç»„å¹³å‡å€¼æ¥åˆ¶ä½œè°ƒè‰²æ¿
- en: How to use the color picker widget to display and modify the palette
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚ä½•ä½¿ç”¨é¢œè‰²é€‰æ‹©å™¨å°éƒ¨ä»¶æ¥æ˜¾ç¤ºå’Œä¿®æ”¹è°ƒè‰²æ¿
- en: Want to try the app firsthand? You can check it out [here](https://sophisticated-palette.streamlit.app/)
    and see the source code [here](https://github.com/syasini/sophisticated_palette).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³è¦äº²è‡ªè¯•ç”¨è¿™ä¸ªåº”ç”¨ç¨‹åºå—ï¼Ÿä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://sophisticated-palette.streamlit.app/)æŸ¥çœ‹å®ƒï¼Œå¹¶åœ¨[è¿™é‡Œ](https://github.com/syasini/sophisticated_palette)æŸ¥çœ‹æºä»£ç ã€‚
- en: 1\. How to construct an image-loading component
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1\. å¦‚ä½•æ„å»ºä¸€ä¸ªå›¾åƒåŠ è½½ç»„ä»¶
- en: 'The first element we need for our app is a way to input the image we want to
    convert to a color palette. There are three ways we can do this:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºéœ€è¦çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¾“å…¥æˆ‘ä»¬æƒ³è¦è½¬æ¢ä¸ºé¢œè‰²è°ƒè‰²æ¿çš„å›¾åƒçš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ï¼š
- en: Load from the pre-existing gallery of images or artworks.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»ç°æœ‰çš„å›¾åƒæˆ–è‰ºæœ¯å“åº“ä¸­åŠ è½½ã€‚
- en: Upload a new image file into the app using `st.file_uploader()`.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`st.file_uploader()`å°†æ–°çš„å›¾åƒæ–‡ä»¶ä¸Šä¼ åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚
- en: Download a new image into the app from a URL.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä» URL ä¸‹è½½ä¸€å¼ æ–°å›¾åƒåˆ°åº”ç”¨ç¨‹åºä¸­ã€‚
- en: We can construct three different tabs using`st.tabs()` that allow us to switch
    between these three input modes seamlessly.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`st.tabs()`æ„å»ºä¸‰ä¸ªä¸åŒçš„é€‰é¡¹å¡ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ— ç¼åˆ‡æ¢è¿™ä¸‰ç§è¾“å…¥æ¨¡å¼ã€‚
- en: '![](../Images/ef24ea3236c1e77a27219776a2ab50ff.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ef24ea3236c1e77a27219776a2ab50ff.png)'
- en: Image input sources constructed using `st.tabs()`.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`st.tabs()`æ„å»ºçš„å›¾åƒè¾“å…¥æºã€‚
- en: Because of the way Streamlit runs the app (top-to-bottom), the input modes that
    come later will get higher priority and will overwrite the output of the previous
    loader. For example, since you ordered the input modes as Gallery â†’ File Uploader
    â†’ Image URL, if you save the image into a variable `img`, anything loaded by the
    gallery will be overwritten by the file uploader and URL downloader outputs.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äº Streamlit è¿è¡Œåº”ç”¨ç¨‹åºçš„æ–¹å¼æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œåæ¥çš„è¾“å…¥æ¨¡å¼ä¼šè·å¾—æ›´é«˜çš„ä¼˜å…ˆçº§å¹¶è¦†ç›–ä¹‹å‰åŠ è½½å™¨çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼Œç”±äºä½ å°†è¾“å…¥æ¨¡å¼æŒ‰ Gallery
    â†’ File Uploader â†’ Image URL çš„é¡ºåºæ’åˆ—ï¼Œå¦‚æœä½ å°†å›¾åƒä¿å­˜åˆ°å˜é‡`img`ä¸­ï¼Œåˆ™ç”»å»ŠåŠ è½½çš„ä»»ä½•å†…å®¹éƒ½ä¼šè¢«æ–‡ä»¶ä¸Šä¼ å™¨å’Œ URL ä¸‹è½½å™¨çš„è¾“å‡ºè¦†ç›–ã€‚
- en: You can add pop-up warnings for the user when they load an image with a loader
    lower in the hierarchy and an image is already loaded with a loader higher in
    the hierarchy.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç”¨æˆ·ä½¿ç”¨å±‚çº§è¾ƒä½çš„åŠ è½½å™¨åŠ è½½å›¾åƒæ—¶ï¼Œä½ å¯ä»¥ä¸ºç”¨æˆ·æ·»åŠ å¼¹å‡ºè­¦å‘Šï¼Œå¦‚æœå±‚çº§è¾ƒé«˜çš„åŠ è½½å™¨å·²ç»åŠ è½½äº†å›¾åƒã€‚
- en: 'This is what the code will look like:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ä»£ç çš„æ ·å­ï¼š
- en: '[PRE0]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: So if youâ€™re trying to load a pre-existing image from the gallery, but there
    is an existing link in the URL downloader, youâ€™re going to have to remove that
    first. It may not be the most elegant solution, but it works!
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œå¦‚æœä½ å°è¯•ä»ç”»å»ŠåŠ è½½ä¸€ä¸ªé¢„å…ˆå­˜åœ¨çš„å›¾åƒï¼Œä½†åœ¨ URL ä¸‹è½½å™¨ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªé“¾æ¥ï¼Œä½ å°†éœ€è¦å…ˆåˆ é™¤é‚£ä¸ªé“¾æ¥ã€‚è¿™å¯èƒ½ä¸æ˜¯æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å®ƒæœ‰æ•ˆï¼
- en: Now, on to the implementation of each piece of the loading methods.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œç»§ç»­å®ç°æ¯ä¸€éƒ¨åˆ†çš„åŠ è½½æ–¹æ³•ã€‚
- en: '**Gallery View**'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**ç”»å»Šè§†å›¾**'
- en: For the gallery view, we can simply save some images in a public repository
    and load those directly in the app (Iâ€™m using GitHub here, but you can also use
    AWS S3 or Google Cloud Storage). The `st.selectbox` contains the names of the
    artworks I have saved, so the user can load them simply by selecting them from
    the dropdown menu. Here is what the implementation looks like.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºç”»å»Šè§†å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†ä¸€äº›å›¾åƒä¿å­˜åœ¨å…¬å…±å­˜å‚¨åº“ä¸­ï¼Œå¹¶ç›´æ¥åœ¨åº”ç”¨ç¨‹åºä¸­åŠ è½½è¿™äº›å›¾åƒï¼ˆæˆ‘åœ¨è¿™é‡Œä½¿ç”¨ GitHubï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ AWS S3 æˆ–
    Google Cloud Storageï¼‰ã€‚`st.selectbox` åŒ…å«æˆ‘ä¿å­˜çš„è‰ºæœ¯å“åç§°ï¼Œå› æ­¤ç”¨æˆ·å¯ä»¥é€šè¿‡ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ¥åŠ è½½å®ƒä»¬ã€‚å®ç°ä»£ç å¦‚ä¸‹ã€‚
- en: '[PRE2]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '`gallery_dict` is a dictionary that has a file name and image file path as
    key-value pairs, and `PIL.Image.open()` is used to load those files. The results
    are saved in a variable named `img`.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '`gallery_dict` æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«æ–‡ä»¶åå’Œå›¾åƒæ–‡ä»¶è·¯å¾„ä½œä¸ºé”®å€¼å¯¹ï¼Œ`PIL.Image.open()` ç”¨äºåŠ è½½è¿™äº›æ–‡ä»¶ã€‚ç»“æœä¿å­˜åœ¨ä¸€ä¸ªåä¸º
    `img` çš„å˜é‡ä¸­ã€‚'
- en: '**File Uploader**'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ–‡ä»¶ä¸Šä¼ å™¨**'
- en: Implementing the file uploader is very easy because there is already a Streamlit
    widget for it. Itâ€™s called (can you guess?) `st.file_uploader()`!
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: å®ç°æ–‡ä»¶ä¸Šä¼ å™¨éå¸¸ç®€å•ï¼Œå› ä¸ºå·²ç»æœ‰ä¸€ä¸ª Streamlit å°éƒ¨ä»¶ã€‚å®ƒå«åšï¼ˆä½ èƒ½çŒœåˆ°å—ï¼Ÿï¼‰`st.file_uploader()`ï¼
- en: 'Here is what the implementation looks like:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: å®ç°ä»£ç å¦‚ä¸‹ï¼š
- en: '[PRE3]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This widget allows you to upload a file that you can consequently pass to `PIL.Image.open()`
    to load. This step may break if the file is not actually an image file, or has
    a format inconsistent with what `PIL.Image` expects. To prevent this from becoming
    an issue we can put the loading part into a `try/except` block.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªå°éƒ¨ä»¶å…è®¸ä½ ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä½ å¯ä»¥å°†å…¶ä¼ é€’ç»™ `PIL.Image.open()` æ¥åŠ è½½ã€‚å¦‚æœæ–‡ä»¶å®é™…ä¸Šä¸æ˜¯å›¾åƒæ–‡ä»¶ï¼Œæˆ–è€…æ ¼å¼ä¸ `PIL.Image`
    æœŸæœ›çš„ä¸ä¸€è‡´ï¼Œè¿™ä¸€æ­¥å¯èƒ½ä¼šå¤±è´¥ã€‚ä¸ºäº†é˜²æ­¢è¿™ä¸ªé—®é¢˜å‘ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†åŠ è½½éƒ¨åˆ†æ”¾å…¥ä¸€ä¸ª `try/except` å—ä¸­ã€‚
- en: âš ï¸ Here Iâ€™m using this block as a catch-all to avoid all sorts of unexpected
    errors when loading a file. However, it is normally not recommended to use `except`
    without actually specifying the `Exception` type you are trying to bypass, especially
    because deadly errors you are not aware of will pass through the block silently,
    making it difficult for you to debug your code.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: âš ï¸ æˆ‘åœ¨è¿™é‡Œä½¿ç”¨è¿™ä¸ªä»£ç å—ä½œä¸ºä¸‡ç”¨å—ï¼Œä»¥é¿å…åœ¨åŠ è½½æ–‡ä»¶æ—¶å‡ºç°å„ç§æ„å¤–é”™è¯¯ã€‚ç„¶è€Œï¼Œé€šå¸¸ä¸æ¨èåœ¨æ²¡æœ‰å®é™…æŒ‡å®šè¦ç»•è¿‡çš„`Exception`ç±»å‹çš„æƒ…å†µä¸‹ä½¿ç”¨`except`ï¼Œå°¤å…¶æ˜¯å› ä¸ºä½ å¯èƒ½ä¸çŸ¥é“çš„è‡´å‘½é”™è¯¯ä¼šé»˜é»˜åœ°é€šè¿‡è¿™ä¸ªä»£ç å—ï¼Œä½¿å¾—è°ƒè¯•ä»£ç å˜å¾—å›°éš¾ã€‚
- en: '**URL Downloader**'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**URL ä¸‹è½½å™¨**'
- en: Letâ€™s face it! While uploading files is a great way for users to load their
    custom images they want to infer the color palettes from, itâ€™s not the easiest
    way. The user will have to find the image (if they donâ€™t have it already), download
    it locally, then upload it to the app. Sounds easy, but annoying in practice.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: è¯´å®è¯ï¼è™½ç„¶ä¸Šä¼ æ–‡ä»¶æ˜¯ç”¨æˆ·åŠ è½½ä»–ä»¬å¸Œæœ›æ¨æ–­é¢œè‰²è°ƒè‰²æ¿çš„è‡ªå®šä¹‰å›¾åƒçš„å¥½æ–¹æ³•ï¼Œä½†è¿™ä¸æ˜¯æœ€ç®€å•çš„æ–¹æ³•ã€‚ç”¨æˆ·éœ€è¦æ‰¾åˆ°å›¾åƒï¼ˆå¦‚æœä»–ä»¬è¿˜æ²¡æœ‰çš„è¯ï¼‰ï¼Œåœ¨æœ¬åœ°ä¸‹è½½ï¼Œç„¶åä¸Šä¼ åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚å¬èµ·æ¥ç®€å•ï¼Œä½†åœ¨å®é™…æ“ä½œä¸­å´å¾ˆéº»çƒ¦ã€‚
- en: In order to remove this barrier, we can add a URL downloader to the app so the
    user can simply copy the image link (e.g. from google search results) and simply
    paste it into the app. In order to accomplish this, we need the `requests` module,
    which gets us the contents of the URL, and the `io.BytesIO` function which makes
    the contents comprehendible by `PIL.Image.open()`. The implementation is simple
    and quite similar to what we did for the file uploader.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ¶ˆé™¤è¿™ä¸ªéšœç¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¸€ä¸ª URL ä¸‹è½½å™¨ï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥ç®€å•åœ°å¤åˆ¶å›¾åƒé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œä» Google æœç´¢ç»“æœä¸­ï¼‰ï¼Œç„¶åç›´æ¥ç²˜è´´åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦
    `requests` æ¨¡å—ï¼Œå®ƒè·å– URL çš„å†…å®¹ï¼Œä»¥åŠ `io.BytesIO` å‡½æ•°ï¼Œå®ƒä½¿å¾—å†…å®¹èƒ½å¤Ÿè¢« `PIL.Image.open()` ç†è§£ã€‚å®ç°èµ·æ¥ç®€å•ä¸”ä¸æ–‡ä»¶ä¸Šä¼ å™¨çš„å®ç°ç±»ä¼¼ã€‚
- en: '[PRE4]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 2\. How to build an image enhancement component with sliders
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2\. å¦‚ä½•ä½¿ç”¨æ»‘å—æ„å»ºå›¾åƒå¢å¼ºç»„ä»¶
- en: Now that we have the image uploaded, we are ready to infer the color palette,
    right? Not exactly.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»ä¸Šä¼ äº†å›¾åƒï¼Œæˆ‘ä»¬å‡†å¤‡æ¨æ–­é¢œè‰²è°ƒè‰²æ¿ï¼Œå¯¹å—ï¼Ÿå…¶å®ä¸å®Œå…¨æ˜¯ã€‚
- en: The original image you load into the app may not be optimized for color inference.
    The colors may be too dull, and you may not have enough brightness or contrast
    across the canvas. Thatâ€™s why you need to do some image adjustments first.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ åŠ è½½åˆ°åº”ç”¨ç¨‹åºä¸­çš„åŸå§‹å›¾åƒå¯èƒ½æœªç»è¿‡é¢œè‰²æ¨æ–­çš„ä¼˜åŒ–ã€‚é¢œè‰²å¯èƒ½è¿‡äºæš—æ·¡ï¼Œç”»å¸ƒä¸Šçš„äº®åº¦æˆ–å¯¹æ¯”åº¦å¯èƒ½ä¸è¶³ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ éœ€è¦é¦–å…ˆè¿›è¡Œä¸€äº›å›¾åƒè°ƒæ•´ã€‚
- en: '![](../Images/5817b6a837e8ae6e175989ec428582ed.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5817b6a837e8ae6e175989ec428582ed.png)'
- en: 'In order to apply enhancements to the image, we can use `PIL.ImageEnhance`
    . The API is very simple. For example, if you want to enhance the color of the
    image (loaded into `img` ) by a factor of 2.5, you can run:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å°†å¢å¼ºåŠŸèƒ½åº”ç”¨äºå›¾åƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `PIL.ImageEnhance`ã€‚API éå¸¸ç®€å•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å°†å›¾åƒï¼ˆåŠ è½½åˆ° `img` ä¸­ï¼‰çš„é¢œè‰²å¢å¼ºå› å­è®¾ç½®ä¸º
    2.5ï¼Œä½ å¯ä»¥è¿è¡Œï¼š
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Simply replacing `Color` with `Shapness`, `Contrast`, or `Brightness` will adjust
    these image attributes respectively. We could create four different sliders that
    assign values to each of these attributes, and then write separate blocks of code
    and apply the enhancements to the image in turn. But we are good programmers,
    and we try to keep our codes beautiful and DRY (Donâ€™t Repeat Yourself) as much
    as possible. So letâ€™s approach this a bit more pragmatically.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: åªéœ€å°† `Color` æ›¿æ¢ä¸º `Shapness`ã€`Contrast` æˆ– `Brightness`ï¼Œå³å¯åˆ†åˆ«è°ƒæ•´è¿™äº›å›¾åƒå±æ€§ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºå››ä¸ªä¸åŒçš„æ»‘å—ï¼Œå°†æ¯ä¸ªå±æ€§çš„å€¼åˆ†é…ç»™è¿™äº›æ»‘å—ï¼Œç„¶åç¼–å†™å•ç‹¬çš„ä»£ç å—ï¼Œä¾æ¬¡å°†å¢å¼ºåº”ç”¨äºå›¾åƒã€‚ä½†æˆ‘ä»¬æ˜¯ä¼˜ç§€çš„ç¨‹åºå‘˜ï¼Œæˆ‘ä»¬å°½é‡ä¿æŒä»£ç ä¼˜é›…å’Œ
    DRYï¼ˆDonâ€™t Repeat Yourselfï¼‰ã€‚æ‰€ä»¥è®©æˆ‘ä»¬ä»¥æ›´å®ç”¨çš„æ–¹å¼æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚
- en: We can define a dictionary that contains all the enhancements we want to apply
    as keys, with values indicating the ranges and step sizes of the sliders we want
    to assign to them in the app.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬å¸Œæœ›åº”ç”¨çš„æ‰€æœ‰å¢å¼ºåŠŸèƒ½ä½œä¸ºé”®ï¼Œå€¼è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºä¸­åˆ†é…ç»™è¿™äº›å¢å¼ºåŠŸèƒ½çš„æ»‘å—èŒƒå›´å’Œæ­¥é•¿ã€‚
- en: '[PRE6]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Using this approach, if we want to change the enhancement type or the range
    of values, we only need to change the original dictionary.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ›´æ”¹å¢å¼ºç±»å‹æˆ–å€¼èŒƒå›´ï¼Œæˆ‘ä»¬åªéœ€æ›´æ”¹åŸå§‹å­—å…¸ã€‚
- en: Now that we have the sliders on the sidebar, the only thing left is to apply
    the values to the image using `ImageEnhance`.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨ä¾§è¾¹æ ä¸Šæ”¾ç½®äº†æ»‘å—ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä½¿ç”¨ `ImageEnhance` å°†è¿™äº›å€¼åº”ç”¨äºå›¾åƒã€‚
- en: '[PRE7]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '**Show the Image**'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ˜¾ç¤ºå›¾åƒ**'
- en: 'Now that we have the image loaded, the only thing left is to show it on the
    app using `st.image()`:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»åŠ è½½äº†å›¾åƒï¼Œå‰©ä¸‹çš„å°±æ˜¯ä½¿ç”¨ `st.image()` å°†å…¶æ˜¾ç¤ºåœ¨åº”ç”¨ç¨‹åºä¸­ï¼š
- en: '[PRE8]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: and *VoilÃ *!
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: å’Œ *ç§*ï¼
- en: 3\. How to cluster pixels and use group averages to make a palette
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3\. å¦‚ä½•èšç±»åƒç´ å¹¶ä½¿ç”¨ç»„å¹³å‡å€¼åˆ¶ä½œè°ƒè‰²æ¿
- en: Finally, onto the fun stuff! Using machine learning to infer the color palette.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œè¿›å…¥æœ‰è¶£çš„éƒ¨åˆ†ï¼ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨æ–­è‰²å½©è°ƒè‰²æ¿ã€‚
- en: 'The idea here is very simple. An image is a collection of pixels that each
    have three values assigned to them: R, G, B. These values basically tell you how
    much red, green, and blue each pixel contains. To infer the color palette, the
    actual location of the pixel on the canvas is virtually irrelevant. What matters
    is where itâ€™s located within the (R, G, B) coordinate space. So before we proceed
    letâ€™s decompose the image into this new coordinate system and get rid of the actual
    location of the pixel on the image.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œçš„æƒ³æ³•éå¸¸ç®€å•ã€‚ä¸€å¹…å›¾åƒæ˜¯åƒç´ çš„é›†åˆï¼Œæ¯ä¸ªåƒç´ éƒ½æœ‰ä¸‰ä¸ªå€¼ï¼šRã€Gã€Bã€‚è¿™äº›å€¼åŸºæœ¬ä¸Šå‘Šè¯‰ä½ æ¯ä¸ªåƒç´ åŒ…å«å¤šå°‘çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ã€‚ä¸ºäº†æ¨æ–­è‰²å½©è°ƒè‰²æ¿ï¼Œåƒç´ åœ¨ç”»å¸ƒä¸Šçš„å®é™…ä½ç½®åŸºæœ¬ä¸Šæ˜¯æ— å…³ç´§è¦çš„ã€‚é‡è¦çš„æ˜¯å®ƒåœ¨
    (R, G, B) åæ ‡ç©ºé—´ä¸­çš„ä½ç½®ã€‚å› æ­¤ï¼Œåœ¨ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å°†å›¾åƒåˆ†è§£åˆ°è¿™ä¸ªæ–°çš„åæ ‡ç³»ç»Ÿä¸­ï¼Œå¹¶æ‘†è„±åƒç´ åœ¨å›¾åƒä¸Šçš„å®é™…ä½ç½®ã€‚
- en: '[PRE9]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'If we look at the pixels in the RGB coordinates, we can then group the ones
    that are close together and use the average values of the pixels to represent
    each group â€” essentially a single color in our palette. For example, if we want
    to construct a 5-color palette from the enhanced image of Mona Lisa, we need to
    first look at the distribution of the pixels in the RGB space (here itâ€™s projected
    into 2D using the PCA algorithm):'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æŸ¥çœ‹ RGB åæ ‡ä¸­çš„åƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç›¸äº’æ¥è¿‘çš„åƒç´ åˆ†ç»„ï¼Œå¹¶ä½¿ç”¨åƒç´ çš„å¹³å‡å€¼æ¥è¡¨ç¤ºæ¯ä¸ªç»„â€”â€”å®é™…ä¸Šæ˜¯æˆ‘ä»¬è°ƒè‰²æ¿ä¸­çš„ä¸€ç§é¢œè‰²ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä»è’™å¨œä¸½èçš„å¢å¼ºå›¾åƒä¸­æ„å»ºä¸€ä¸ª
    5 è‰²è°ƒè‰²æ¿ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæŸ¥çœ‹ RGB ç©ºé—´ä¸­åƒç´ çš„åˆ†å¸ƒï¼ˆè¿™é‡Œé€šè¿‡ PCA ç®—æ³•æŠ•å½±åˆ°äºŒç»´ï¼‰ï¼š
- en: '![](../Images/aaf50c2e6a36baff6e418262156e77bc.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/aaf50c2e6a36baff6e418262156e77bc.png)'
- en: 2-dimensional PCA decomposition of original pixels colors from (R, G, B) space
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: åŸå§‹åƒç´ é¢œè‰²åœ¨ (R, G, B) ç©ºé—´ä¸­çš„äºŒç»´ PCA åˆ†è§£
- en: '![](../Images/79b2d0844aea6616e93aa70a23ce6a38.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/79b2d0844aea6616e93aa70a23ce6a38.png)'
- en: Then we select 5 distinct clusters and assign the average value of each cluster
    to a slot in our palette.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬é€‰æ‹© 5 ä¸ªä¸åŒçš„ç°‡ï¼Œå¹¶å°†æ¯ä¸ªç°‡çš„å¹³å‡å€¼åˆ†é…ç»™è°ƒè‰²æ¿ä¸­çš„ä¸€ä¸ªæ§½ã€‚
- en: original sampled pixels assigned to 5 different clusters using K-means algorithm
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ K-means ç®—æ³•å°†åŸå§‹é‡‡æ ·åƒç´ åˆ†é…åˆ° 5 ä¸ªä¸åŒçš„ç°‡
- en: Obviously, we donâ€™t need to do this by hand. There is a handy machine learning
    algorithm called K-means clustering that can do this for us in one fell swoop.
    The only parameter we need to provide is the number of clusters, a.k.a. our palette
    size. This is what the implementation looks like using `sklearn.cluster.KMeans`.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å®Œæˆè¿™ä¸ªå·¥ä½œã€‚æœ‰ä¸€ç§æ–¹ä¾¿çš„æœºå™¨å­¦ä¹ ç®—æ³•å«åš K-means èšç±»ï¼Œå®ƒå¯ä»¥ä¸€ä¸¾å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚æˆ‘ä»¬å”¯ä¸€éœ€è¦æä¾›çš„å‚æ•°æ˜¯èšç±»çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è°ƒè‰²æ¿å¤§å°ã€‚è¿™æ˜¯ä½¿ç”¨
    `sklearn.cluster.KMeans` å®ç°çš„æ ·å­ã€‚
- en: '[PRE10]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: And thatâ€™s it! We now have our color palette, and we just need to return it
    to the user on the app.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™æ ·ï¼æˆ‘ä»¬ç°åœ¨æœ‰äº†æˆ‘ä»¬çš„è°ƒè‰²æ¿ï¼Œåªéœ€è¦å°†å…¶è¿”å›ç»™åº”ç”¨ä¸­çš„ç”¨æˆ·ã€‚
- en: â„¹ï¸ Although here we used the popular R, G, B decomposition of the pixels, itâ€™s
    important to note that itâ€™s not the only way to decompose colors. We could have
    done the clustering of pixels in HSV (Hue, Saturation, Value) space which would
    have distributed the pixels differently and led to a different color palette.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: â„¹ï¸ å°½ç®¡æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†æµè¡Œçš„ Rã€Gã€B åƒç´ åˆ†è§£ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸æ˜¯åˆ†è§£é¢œè‰²çš„å”¯ä¸€æ–¹æ³•ã€‚æˆ‘ä»¬æœ¬å¯ä»¥åœ¨ HSVï¼ˆè‰²è°ƒã€é¥±å’Œåº¦ã€æ˜åº¦ï¼‰ç©ºé—´ä¸­è¿›è¡Œåƒç´ èšç±»ï¼Œè¿™å°†ä»¥ä¸åŒçš„æ–¹å¼åˆ†å¸ƒåƒç´ ï¼Œä»è€Œå¾—åˆ°ä¸åŒçš„è°ƒè‰²æ¿ã€‚
- en: 4\. How to use the color picker widget
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4\. å¦‚ä½•ä½¿ç”¨è‰²å½©é€‰æ‹©å™¨æ§ä»¶
- en: Somehow, I feel like the subconscious reason I decided to build this app was
    to use Streamlitâ€™s amazing `st.color_picker()` widget! The nice thing bout this
    widget is that you can both show the palette colors inferred from the image, and
    also change them if you want. This is perfect because as I mentioned earlier,
    the colors you get back from the app may not be 100% perfect for your particular
    use case, but only a good starting point. So you may want to change them a little
    and do a bit of touch-up before actually using it for your visualization.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸çŸ¥ä¸ºä½•ï¼Œæˆ‘æ„Ÿè§‰æˆ‘å†³å®šæ„å»ºè¿™ä¸ªåº”ç”¨çš„æ½œæ„è¯†åŸå› æ˜¯ä¸ºäº†ä½¿ç”¨ Streamlit çš„ç¥å¥‡ `st.color_picker()` æ§ä»¶ï¼è¿™ä¸ªæ§ä»¶çš„å¥½å¤„åœ¨äºï¼Œä½ å¯ä»¥åŒæ—¶å±•ç¤ºä»å›¾åƒä¸­æ¨æ–­å‡ºçš„è°ƒè‰²æ¿é¢œè‰²ï¼Œå¹¶ä¸”å¦‚æœæ„¿æ„çš„è¯ï¼Œè¿˜å¯ä»¥æ›´æ”¹å®ƒä»¬ã€‚è¿™éå¸¸å®Œç¾ï¼Œå› ä¸ºæ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œä»åº”ç”¨ä¸­å¾—åˆ°çš„é¢œè‰²å¯èƒ½å¹¶ä¸æ˜¯é’ˆå¯¹ä½ ç‰¹å®šç”¨ä¾‹çš„
    100% å®Œç¾ï¼Œè€Œåªæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æ‰€ä»¥ä½ å¯èƒ½éœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹ï¼Œåœ¨å®é™…ç”¨äºä½ çš„å¯è§†åŒ–ä¹‹å‰åšä¸€äº›ä¿®é¥°ã€‚
- en: We donâ€™t want the palette to take up half the page on our app, so letâ€™s put
    them each in a separate column.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¸å¸Œæœ›è°ƒè‰²æ¿åœ¨åº”ç”¨ç¨‹åºä¸­å æ®é¡µé¢çš„ä¸€åŠï¼Œå› æ­¤è®©æˆ‘ä»¬æŠŠå®ƒä»¬åˆ†åˆ«æ”¾åœ¨ä¸åŒçš„åˆ—ä¸­ã€‚
- en: '[PRE11]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Beautiful!
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: ç¾æäº†ï¼
- en: One last piece to finish things up, would be to provide the user with a practical
    end product they can use in their day-to-day work. If a data analyst or data scientist
    is using this app to infer a color palette, most likely they are going to use
    it in `matplotlib` or `plotly` to apply the palette to their visualization. Why
    not provide them with a code snippet that takes care of this, so they donâ€™t have
    to copy-paste every single hex-code from the color palette into their coding environment.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åä¸€ä»¶è¦åšçš„äº‹æƒ…æ˜¯ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªå¯ä»¥åœ¨æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨çš„å®ç”¨äº§å“ã€‚å¦‚æœæ•°æ®åˆ†æå¸ˆæˆ–æ•°æ®ç§‘å­¦å®¶ä½¿ç”¨è¿™ä¸ªåº”ç”¨æ¥æ¨æ–­ä¸€ä¸ªè‰²å½©è°ƒè‰²æ¿ï¼Œä»–ä»¬å¾ˆå¯èƒ½ä¼šåœ¨ `matplotlib`
    æˆ– `plotly` ä¸­ä½¿ç”¨è¿™ä¸ªè°ƒè‰²æ¿æ¥åº”ç”¨äºä»–ä»¬çš„å¯è§†åŒ–ä¸­ã€‚ä¸ºä»€ä¹ˆä¸æä¾›ä¸€ä¸ªä»£ç ç‰‡æ®µæ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ ·ä»–ä»¬å°±ä¸å¿…å°†æ¯ä¸€ä¸ªåå…­è¿›åˆ¶é¢œè‰²ä»£ç ä»è°ƒè‰²æ¿ä¸­å¤åˆ¶ç²˜è´´åˆ°ä»–ä»¬çš„ç¼–ç ç¯å¢ƒä¸­ã€‚
- en: '![](../Images/a5da3376d560c68a39cdbae2260d0f7b.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a5da3376d560c68a39cdbae2260d0f7b.png)'
- en: Image by Author
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: Thanks to Streamlitâ€™s `st.code()` widget, the whole code block can be copied
    with a single click!
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢ Streamlit çš„ `st.code()` æ§ä»¶ï¼Œå¯ä»¥ä¸€é”®å¤åˆ¶æ•´ä¸ªä»£ç å—ï¼
- en: Wrapping up
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ€»ç»“
- en: There you go! Now you have a fully functional palette inference app that can
    help you figure out what colors Leonardo Da Vinci used to put that smile on Mona
    Lisaâ€™s face!
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™æ ·ï¼ç°åœ¨ä½ æœ‰äº†ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„è°ƒè‰²æ¿æ¨æ–­åº”ç”¨ï¼Œå¯ä»¥å¸®åŠ©ä½ å¼„æ¸…æ¥šåˆ—å¥¥çº³å¤šÂ·è¾¾Â·èŠ¬å¥‡æ˜¯ç”¨ä»€ä¹ˆé¢œè‰²è®©è’™å¨œä¸½èçš„è„¸ä¸Šå¸¦ä¸Šå¾®ç¬‘çš„ï¼
- en: In this post, we covered a lot of Streamlitâ€™s functionalities, especially widgets
    like `st.image`, `st.tabs`, `st.file_uploader`, `st.color_picker`. But there is
    also a lot more that we didnâ€™t cover here for the sake of brevity, so feel free
    to jump to the [source code](https://github.com/syasini/sophisticated_palette)
    repo and check out all the details yourself. You can see that I have relied heavily
    on `st.session_state` to keep things consistent across multiple runs of the app.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¾ˆå¤š Streamlit çš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯åƒ `st.image`ã€`st.tabs`ã€`st.file_uploader` å’Œ
    `st.color_picker` è¿™æ ·çš„æ§ä»¶ã€‚ä¸è¿‡ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬æ²¡æœ‰æ¶µç›–æ‰€æœ‰å†…å®¹ï¼Œæ‰€ä»¥è¯·éšæ—¶è·³è½¬åˆ° [æºä»£ç ](https://github.com/syasini/sophisticated_palette)
    ä»“åº“ï¼Œè‡ªå·±æŸ¥çœ‹æ‰€æœ‰ç»†èŠ‚ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘åœ¨å¤šä¸ªåº”ç”¨è¿è¡Œé—´ä¿æŒä¸€è‡´æ€§æ—¶ï¼Œä¾èµ–äº†å¤§é‡çš„ `st.session_state`ã€‚
- en: We learned how to
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å­¦ä¼šäº†
- en: Construct an image loading component (load pre-existing, upload, or URL download).
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ„å»ºä¸€ä¸ªå›¾åƒåŠ è½½ç»„ä»¶ï¼ˆåŠ è½½ç°æœ‰å›¾åƒã€ä¸Šä¼ æˆ– URL ä¸‹è½½ï¼‰ã€‚
- en: Build an image enhancement component with sliders.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ„å»ºä¸€ä¸ªå¸¦æ»‘å—çš„å›¾åƒå¢å¼ºç»„ä»¶ã€‚
- en: Cluster pixels together using K-means and use group averages to construct a
    palette.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨K-meanså°†åƒç´ èšç±»ï¼Œå¹¶ä½¿ç”¨ç»„å¹³å‡å€¼æ¥æ„å»ºè°ƒè‰²æ¿ã€‚
- en: Return the palette to end-user using the color-picker widget.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨é¢œè‰²é€‰æ‹©å™¨å°éƒ¨ä»¶å°†è°ƒè‰²æ¿è¿”å›ç»™æœ€ç»ˆç”¨æˆ·ã€‚
- en: I had a lot of fun walking you through all these steps, and I really hope you
    enjoyed reading/skimming through the article and hopefully learned a thing or
    two.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¾ˆé«˜å…´èƒ½å¸¦ä½ èµ°è¿‡æ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œå¸Œæœ›ä½ å–œæ¬¢é˜…è¯»/æµè§ˆè¿™ç¯‡æ–‡ç« ï¼Œå¹¶å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚
- en: You can check out the app firsthand, [here](https://sophisticated-palette.streamlit.app/).
    I would love to hear your thoughts, questions, comments, and feedback! Get in
    touch with me on [LinkedIn](https://www.linkedin.com/in/siavash-yasini/) or through
    my [website](https://www.siavashyasini.com/).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥äº²è‡ªæŸ¥çœ‹è¿™ä¸ªåº”ç”¨ï¼Œ[è¿™é‡Œ](https://sophisticated-palette.streamlit.app/)ã€‚æˆ‘å¾ˆæƒ³å¬å¬ä½ çš„æƒ³æ³•ã€é—®é¢˜ã€è¯„è®ºå’Œåé¦ˆï¼é€šè¿‡[LinkedIn](https://www.linkedin.com/in/siavash-yasini/)æˆ–æˆ‘çš„[ç½‘ç«™](https://www.siavashyasini.com/)ä¸æˆ‘è”ç³»ã€‚
- en: '*This article was written in collaboration with* [*Ksenia Anske*](https://www.linkedin.com/in/kseniaanske/)
    *and team* [*Streamlit*](https://streamlit.io/) *at* [*Snowflake*](https://www.snowflake.com/en/)*.
    See the final version of this article published on Streamlitâ€™s blog* [*here*](https://blog.streamlit.io/create-a-color-palette-from-any-image/)*.*'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '*è¿™ç¯‡æ–‡ç« ä¸* [*Ksenia Anske*](https://www.linkedin.com/in/kseniaanske/) *åŠå›¢é˜Ÿ* [*Streamlit*](https://streamlit.io/)
    *åœ¨* [*Snowflake*](https://www.snowflake.com/en/) *çš„åˆä½œä¸‹ç¼–å†™ã€‚è¯·æŸ¥çœ‹è¿™ç¯‡æ–‡ç« åœ¨Streamlitåšå®¢ä¸Šå‘å¸ƒçš„æœ€ç»ˆç‰ˆæœ¬*
    [*è¿™é‡Œ*](https://blog.streamlit.io/create-a-color-palette-from-any-image/)*ã€‚*'
- en: '*All images, unless otherwise noted, are by the author.*'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å›¾ç‰‡å‡ç”±ä½œè€…æä¾›ã€‚*'

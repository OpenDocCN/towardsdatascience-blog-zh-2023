- en: 'Setting up Python Projects: Part V'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è®¾ç½®Pythoné¡¹ç›®ï¼šç¬¬Véƒ¨åˆ†
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/setting-up-python-projects-part-v-206df3c1e3d3](https://towardsdatascience.com/setting-up-python-projects-part-v-206df3c1e3d3)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/setting-up-python-projects-part-v-206df3c1e3d3](https://towardsdatascience.com/setting-up-python-projects-part-v-206df3c1e3d3)
- en: 'Mastering the Art of Python Project Setup: A Step-by-Step Guide'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æŒæ¡Pythoné¡¹ç›®è®¾ç½®çš„è‰ºæœ¯ï¼šé€æ­¥æŒ‡å—
- en: '[](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)[![Johannes
    Schmidt](../Images/e0cacf7ff37f339a9bf8bd33c7c83a4d.png)](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)
    [Johannes Schmidt](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)[![Johannes
    Schmidt](../Images/e0cacf7ff37f339a9bf8bd33c7c83a4d.png)](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)[](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)
    [Johannes Schmidt](https://johschmidt42.medium.com/?source=post_page-----206df3c1e3d3--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)
    Â·20 min readÂ·Jan 14, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page-----206df3c1e3d3--------------------------------)
    Â·é˜…è¯»æ—¶é—´20åˆ†é’ŸÂ·2023å¹´1æœˆ14æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/c80bbfc10240ac4b4126a69759a6a36e.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c80bbfc10240ac4b4126a69759a6a36e.png)'
- en: Photo by [Zoya Loonohod](https://unsplash.com/@loonohod?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ç…§ç‰‡ç”±[Zoya Loonohod](https://unsplash.com/@loonohod?utm_source=medium&utm_medium=referral)æ‹æ‘„ï¼Œæ¥è‡ª[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Whether youâ€™re a seasoned developer or just getting started with ğŸ **Python**,
    itâ€™s important to know how to build robust and maintainable projects. This tutorial
    will guide you through the process of setting up a Python project using some of
    the most popular and effective tools in the industry. You will learn how to use
    [GitHub](https://github.com/) and [GitHub Actions](https://github.com/features/actions)
    for version control and continuous integration, as well as other tools for testing,
    documentation, packaging and distribution. The tutorial is inspired by resources
    such as [Hypermodern Python](https://medium.com/@cjolowicz/hypermodern-python-d44485d9d769)
    and [Best Practices for a new Python project](https://mitelman.engineering/blog/python-best-practice/automating-python-best-practices-for-a-new-project/).
    However, this is not the only way to do things and you might have different preferences
    or opinions. The tutorial is intended to be beginner-friendly but also cover some
    advanced topics. In each section, you will automate some tasks and add badges
    to your project to show your progress and achievements.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºä½ æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…è¿˜æ˜¯åˆšåˆšå¼€å§‹æ¥è§¦ğŸ **Python**ï¼Œäº†è§£å¦‚ä½•æ„å»ºç¨³å¥ä¸”æ˜“äºç»´æŠ¤çš„é¡¹ç›®éƒ½å¾ˆé‡è¦ã€‚æœ¬æ•™ç¨‹å°†æŒ‡å¯¼ä½ ä½¿ç”¨ä¸€äº›è¡Œä¸šå†…æœ€æµè¡Œä¸”æœ‰æ•ˆçš„å·¥å…·æ¥è®¾ç½®Pythoné¡¹ç›®ã€‚ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨[GitHub](https://github.com/)å’Œ[GitHub
    Actions](https://github.com/features/actions)è¿›è¡Œç‰ˆæœ¬æ§åˆ¶å’ŒæŒç»­é›†æˆï¼Œä»¥åŠå…¶ä»–å·¥å…·è¿›è¡Œæµ‹è¯•ã€æ–‡æ¡£ç¼–å†™ã€æ‰“åŒ…å’Œåˆ†å‘ã€‚æœ¬æ•™ç¨‹çš„çµæ„Ÿæ¥æºäº[Hypermodern
    Python](https://medium.com/@cjolowicz/hypermodern-python-d44485d9d769)å’Œ[æ–°Pythoné¡¹ç›®çš„æœ€ä½³å®è·µ](https://mitelman.engineering/blog/python-best-practice/automating-python-best-practices-for-a-new-project/)ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸æ˜¯å”¯ä¸€çš„æ–¹æ³•ï¼Œä½ å¯èƒ½æœ‰ä¸åŒçš„åå¥½æˆ–è§‚ç‚¹ã€‚æ•™ç¨‹æ—¨åœ¨å¯¹åˆå­¦è€…å‹å¥½ï¼ŒåŒæ—¶æ¶µç›–ä¸€äº›é«˜çº§ä¸»é¢˜ã€‚åœ¨æ¯ä¸ªéƒ¨åˆ†ï¼Œä½ å°†è‡ªåŠ¨åŒ–ä¸€äº›ä»»åŠ¡ï¼Œå¹¶ä¸ºä½ çš„é¡¹ç›®æ·»åŠ å¾½ç« ï¼Œä»¥å±•ç¤ºä½ çš„è¿›å±•å’Œæˆå°±ã€‚
- en: The repository for this series can be found at [github.com/johschmidt42/python-project-johannes](https://github.com/johschmidt42/python-project-johannes)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥ç³»åˆ—çš„ä»£ç åº“å¯ä»¥åœ¨[github.com/johschmidt42/python-project-johannes](https://github.com/johschmidt42/python-project-johannes)æ‰¾åˆ°
- en: 'This part was inspired by this blog post:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸€éƒ¨åˆ†çš„çµæ„Ÿæ¥è‡ªäºè¿™ç¯‡åšå®¢æ–‡ç« ï¼š
- en: '[**Semantic release with Python, Poetry & GitHub Actions ğŸš€**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[**Pythonã€Poetryä¸GitHub Actionsçš„è¯­ä¹‰åŒ–å‘å¸ƒ ğŸš€**'
- en: '*Iâ€™m planning to add a few features to Dr. Sven thanks to some interest from
    my colleagues. Before doing so, I needed toâ€¦*](https://mestrak.com/blog/semantic-release-with-python-poetry-github-actions-20nn)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '*ç”±äºæˆ‘çš„åŒäº‹ä»¬çš„å…´è¶£ï¼Œæˆ‘è®¡åˆ’å‘Dr. Svenæ·»åŠ ä¸€äº›åŠŸèƒ½ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘éœ€è¦â€¦*](https://mestrak.com/blog/semantic-release-with-python-poetry-github-actions-20nn)'
- en: Requirements
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è¦æ±‚
- en: '**OS**: Linux, Unix, macOS, Windows (WSL2 with e.g. Ubuntu 20.04 LTS)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ“ä½œç³»ç»Ÿ**: Linuxã€Unixã€macOSã€Windowsï¼ˆWSL2ï¼Œä¾‹å¦‚Ubuntu 20.04 LTSï¼‰'
- en: '**Tools**: python3.10, bash, git, tree'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å·¥å…·**ï¼špython3.10, bash, git, tree'
- en: '**Version Control System (VCS) Host**: [GitHub](https://github.com/)'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆVCSï¼‰ä¸»æœº**ï¼š [GitHub](https://github.com/)'
- en: '**Continuous Integration (CI) Tool**: [GitHub Actions](https://github.com/features/actions)'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æŒç»­é›†æˆï¼ˆCIï¼‰å·¥å…·**ï¼š [GitHub Actions](https://github.com/features/actions)'
- en: 'It is expected that you are familiar with the versioning control system (VCS)
    [git](https://git-scm.com/). If not, hereâ€™s a refresher for you: [Introduction
    to Git](https://realpython.com/python-git-github-intro/)'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„è®¡ä½ å¯¹ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆVCSï¼‰[git](https://git-scm.com/)æœ‰æ‰€äº†è§£ã€‚å¦‚æœä¸äº†è§£ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå¤ä¹ ï¼š [Git ä»‹ç»](https://realpython.com/python-git-github-intro/)
- en: Commits will be based on [best practices for git commits](https://deepsource.io/blog/git-best-practices/)
    & [Conventional commits](https://www.conventionalcommits.org/en/v1.0.0/). There
    is the [conventional commit plugin](https://plugins.jetbrains.com/plugin/13389-conventional-commit)
    for PyCharm or a [VSCode Extension](https://github.com/vivaxy/vscode-conventional-commits)
    that help you to write commits in this format.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: æäº¤å°†åŸºäº [æœ€ä½³ git æäº¤å®è·µ](https://deepsource.io/blog/git-best-practices/) å’Œ [ä¼ ç»Ÿæäº¤](https://www.conventionalcommits.org/en/v1.0.0/)ã€‚ä½ å¯ä»¥ä½¿ç”¨
    [PyCharm çš„ä¼ ç»Ÿæäº¤æ’ä»¶](https://plugins.jetbrains.com/plugin/13389-conventional-commit)
    æˆ– [VSCode æ‰©å±•](https://github.com/vivaxy/vscode-conventional-commits) æ¥å¸®åŠ©ä½ ä»¥è¿™ç§æ ¼å¼ç¼–å†™æäº¤ã€‚
- en: Overview
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¦‚è¿°
- en: '[Part I (GitHub, IDE)](https://johschmidt42.medium.com/setting-up-python-projects-part-i-408603868c08)'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ç¬¬ä¸€éƒ¨åˆ†ï¼ˆGitHubï¼ŒIDEï¼‰](https://johschmidt42.medium.com/setting-up-python-projects-part-i-408603868c08)'
- en: Part II (Formatting, Linting, CI)
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¬¬äºŒéƒ¨åˆ†ï¼ˆæ ¼å¼åŒ–ï¼ŒLintingï¼ŒCIï¼‰
- en: Part III (Testing, CI)
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¬¬ä¸‰éƒ¨åˆ†ï¼ˆæµ‹è¯•ï¼ŒCIï¼‰
- en: '[Part IV (Documentation, CI/CD)](https://johschmidt42.medium.com/setting-up-python-projects-part-iv-82059eba4ca4)'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ç¬¬å››éƒ¨åˆ†ï¼ˆæ–‡æ¡£ï¼ŒCI/CDï¼‰](https://johschmidt42.medium.com/setting-up-python-projects-part-iv-82059eba4ca4)'
- en: '**Part V (Versioning & Releases, CI/CD)**'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç¬¬äº”éƒ¨åˆ†ï¼ˆç‰ˆæœ¬æ§åˆ¶ä¸å‘å¸ƒï¼ŒCI/CDï¼‰**'
- en: '[Part VI (Containerisation, Docker, CI/CD)](https://johschmidt42.medium.com/setting-up-python-projects-part-vi-cbdbf28eff53)'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ç¬¬å…­éƒ¨åˆ†ï¼ˆå®¹å™¨åŒ–ï¼ŒDockerï¼ŒCI/CDï¼‰](https://johschmidt42.medium.com/setting-up-python-projects-part-vi-cbdbf28eff53)'
- en: Structure
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç»“æ„
- en: Git Branching Strategy (*GitHub flow*)
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Git åˆ†æ”¯ç­–ç•¥ (*GitHub æµç¨‹*)
- en: What is a release? (*zip, tar.gz*)
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯å‘å¸ƒï¼Ÿ (*zip, tar.gz*)
- en: Semantic Versioning (*v0.1.0*)
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ (*v0.1.0*)
- en: Create a release manually (*git tag, GitHub*)
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ‰‹åŠ¨åˆ›å»ºå‘å¸ƒ (*git tag, GitHub*)
- en: Create a release automatically (*conventional commits, semantic releases*)
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åˆ›å»ºå‘å¸ƒ (*ä¼ ç»Ÿæäº¤ï¼Œè¯­ä¹‰å‘å¸ƒ*)
- en: CI/CD (*release.yml*)
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CI/CD (*release.yml*)
- en: Create a Personal Access Token (PAT)
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ›å»ºä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPATï¼‰
- en: GitHub Actions Flow (*Orchestrating workflows*)
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: GitHub Actions æµç¨‹ (*ç¼–æ’å·¥ä½œæµ*)
- en: Badge (*Release*)
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¾½ç«  (*å‘å¸ƒ*)
- en: Bonus (*Enforce conventional commits*)
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¥–åŠ± (*å¼ºåˆ¶æ‰§è¡Œä¼ ç»Ÿæäº¤*)
- en: Releasing software is an important step in the software development process
    as it makes new features and bugfixes available to users. One key aspect of releasing
    software is versioning, which helps to track and communicate the changes made
    in each release. Semantic versioning is a widely used standard for versioning
    software, which uses a version number in the format of Major.Minor.Patch (e.g.
    1.2.3) to indicate the level of changes made in a release.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: å‘å¸ƒè½¯ä»¶æ˜¯è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„é‡è¦æ­¥éª¤ï¼Œå› ä¸ºå®ƒä½¿æ–°åŠŸèƒ½å’Œä¿®å¤ç¨‹åºå¯ä¾›ç”¨æˆ·ä½¿ç”¨ã€‚å‘å¸ƒè½¯ä»¶çš„ä¸€ä¸ªå…³é”®æ–¹é¢æ˜¯ç‰ˆæœ¬æ§åˆ¶ï¼Œå®ƒæœ‰åŠ©äºè·Ÿè¸ªå’Œä¼ è¾¾æ¯ä¸ªå‘å¸ƒä¸­çš„å˜åŒ–ã€‚è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„è½¯ä»¶ç‰ˆæœ¬æ§åˆ¶æ ‡å‡†ï¼Œå®ƒä½¿ç”¨æ ¼å¼ä¸º
    Major.Minor.Patchï¼ˆä¾‹å¦‚ 1.2.3ï¼‰çš„ç‰ˆæœ¬å·æ¥æŒ‡ç¤ºå‘å¸ƒä¸­æ‰€åšæ›´æ”¹çš„çº§åˆ«ã€‚
- en: Conventional commits is a specification for adding human and machine readable
    meaning to commit messages. Itâ€™s a way to format commit messages in a consistent
    manner, which make it easy to determine the type of change made. Conventional
    commits are commonly used in conjunction with semantic versioning, as the commit
    messages can be used to automatically determine the version number of a release.
    Together, semantic versioning and conventional commits provide a clear and consistent
    way to track and communicate the changes made in each release of a software project.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ä¼ ç»Ÿæäº¤æ˜¯ä¸€ç§ä¸ºæäº¤æ¶ˆæ¯æ·»åŠ äººç±»å’Œæœºå™¨å¯è¯»æ„ä¹‰çš„è§„èŒƒã€‚å®ƒæ˜¯ä¸€ç§ä»¥ä¸€è‡´çš„æ–¹å¼æ ¼å¼åŒ–æäº¤æ¶ˆæ¯çš„æ–¹æ³•ï¼Œè¿™ä½¿å¾—ç¡®å®šæ‰€åšæ›´æ”¹çš„ç±»å‹å˜å¾—ç®€å•ã€‚ä¼ ç»Ÿæäº¤é€šå¸¸ä¸è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ç»“åˆä½¿ç”¨ï¼Œå› ä¸ºæäº¤æ¶ˆæ¯å¯ä»¥ç”¨æ¥è‡ªåŠ¨ç¡®å®šå‘å¸ƒçš„ç‰ˆæœ¬å·ã€‚è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶å’Œä¼ ç»Ÿæäº¤ä¸€èµ·æä¾›äº†ä¸€ç§æ¸…æ™°ä¸”ä¸€è‡´çš„æ–¹æ³•æ¥è·Ÿè¸ªå’Œä¼ è¾¾æ¯ä¸ªè½¯ä»¶é¡¹ç›®å‘å¸ƒä¸­çš„æ›´æ”¹ã€‚
- en: Git Branching Strategy
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Git åˆ†æ”¯ç­–ç•¥
- en: There are many different branching strategies out there for git. Many people
    gravitate towards [GitFlow](http://datasift.github.io/gitflow/IntroducingGitFlow.html)
    (or variants), [Three Flow](https://www.nomachetejuggling.com/2017/04/09/a-different-branching-strategy/),
    or [Trunk based Flows](https://trunkbaseddevelopment.com/). Some do strategies
    in between these, such as this [one](https://brightinventions.pl/blog/how-do-we-use-git/).
    Iâ€™m using the very simple [GitHub flow](https://guides.github.com/introduction/flow/)
    branching strategy, where all bug fixes and features have their own separate branch,
    and when complete, each branch is merged to main and deployed. Simple, nice and
    easy.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: git æœ‰è®¸å¤šä¸åŒçš„åˆ†æ”¯ç­–ç•¥ã€‚å¾ˆå¤šäººå€¾å‘äºä½¿ç”¨[GitFlow](http://datasift.github.io/gitflow/IntroducingGitFlow.html)ï¼ˆæˆ–å˜ç§ï¼‰ã€[Three
    Flow](https://www.nomachetejuggling.com/2017/04/09/a-different-branching-strategy/)æˆ–[Trunk
    based Flows](https://trunkbaseddevelopment.com/)ã€‚ä¸€äº›äººä½¿ç”¨è¿™äº›ç­–ç•¥ä¸­çš„æ··åˆç­–ç•¥ï¼Œä¾‹å¦‚è¿™ä¸ª[ç­–ç•¥](https://brightinventions.pl/blog/how-do-we-use-git/)ã€‚æˆ‘ä½¿ç”¨éå¸¸ç®€å•çš„[GitHub
    flow](https://guides.github.com/introduction/flow/)åˆ†æ”¯ç­–ç•¥ï¼Œå…¶ä¸­æ‰€æœ‰çš„ bug ä¿®å¤å’ŒåŠŸèƒ½éƒ½æœ‰å„è‡ªçš„ç‹¬ç«‹åˆ†æ”¯ï¼Œå®Œæˆåï¼Œæ¯ä¸ªåˆ†æ”¯éƒ½ä¼šåˆå¹¶åˆ°ä¸»åˆ†æ”¯å¹¶è¿›è¡Œéƒ¨ç½²ã€‚ç®€å•ã€å¥½ç”¨ä¸”æ˜“äºæ“ä½œã€‚
- en: '![](../Images/9ac6ed499d8cab343bc75482579e1bed.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9ac6ed499d8cab343bc75482579e1bed.png)'
- en: GitHub Flow branching strategy
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: GitHub Flow åˆ†æ”¯ç­–ç•¥
- en: Whatever your strategy might be, in the end you merge a pull request and (probably)
    create a release.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºä½ çš„ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Œæœ€ç»ˆä½ éƒ½ä¼šåˆå¹¶ä¸€ä¸ªæ‹‰å–è¯·æ±‚ï¼Œå¹¶ï¼ˆå¯èƒ½ï¼‰åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒã€‚
- en: What is a release?
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯ç‰ˆæœ¬å‘å¸ƒï¼Ÿ
- en: In short, a release is packing up code of a version (e.g. zip) and pushing it
    to production (whatever this might be for you).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ç®€è€Œè¨€ä¹‹ï¼Œå‘å¸ƒå°±æ˜¯å°†ä¸€ä¸ªç‰ˆæœ¬çš„ä»£ç æ‰“åŒ…ï¼ˆä¾‹å¦‚å‹ç¼©æ–‡ä»¶ï¼‰ï¼Œå¹¶æ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒï¼ˆè¿™å¯¹ä½ æ¥è¯´å¯èƒ½æ˜¯ä»»ä½•ä¸œè¥¿ï¼‰ã€‚
- en: Release management can be messy. Therefore there needs to be a concise way that
    you follow (and others), that defines what a release means and what changes between
    one release and the next. If you donâ€™t track the changes between the releases,
    then you probably wonâ€™t understand what has been changed in each release and you
    canâ€™t identify any problems that might have been introduced with new code. Without
    a changelog, it can be difficult to understand how the software has evolved over
    time. It can also make it difficult to roll back changes if necessary.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ç‰ˆæœ¬ç®¡ç†å¯èƒ½ä¼šå¾ˆæ··ä¹±ã€‚å› æ­¤ï¼Œéœ€è¦æœ‰ä¸€ä¸ªç®€æ˜çš„æ–¹æ³•ï¼ˆä»¥åŠå…¶ä»–äººä¹Ÿè·Ÿéšçš„æ–¹æ³•ï¼‰ï¼Œå®šä¹‰ä»€ä¹ˆæ˜¯ç‰ˆæœ¬å‘å¸ƒï¼Œä»¥åŠä¸€ä¸ªç‰ˆæœ¬ä¸ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å˜åŒ–ã€‚å¦‚æœä½ ä¸è·Ÿè¸ªç‰ˆæœ¬ä¹‹é—´çš„å˜åŒ–ï¼Œä½ å¯èƒ½ä¸ä¼šç†è§£æ¯ä¸ªç‰ˆæœ¬ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Œä¹Ÿæ— æ³•è¯†åˆ«æ–°ä»£ç ä¸­å¯èƒ½å¼•å…¥çš„ä»»ä½•é—®é¢˜ã€‚æ²¡æœ‰å˜æ›´æ—¥å¿—ï¼Œå¾ˆéš¾ç†è§£è½¯ä»¶å¦‚ä½•éšç€æ—¶é—´çš„æ¨ç§»è€Œå‘å±•ã€‚å®ƒä¹Ÿå¯èƒ½ä½¿å›æ»šæ›´æ”¹å˜å¾—å›°éš¾ï¼ˆå¦‚æœå¿…è¦çš„è¯ï¼‰ã€‚
- en: Semantic Versioning
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
- en: '[Semantic Versioning](https://semver.org/) is just a number schema and standard
    practice in the industry for software development. It indicates the level of changes
    between this version and the previous one. There are three parts to a semantic
    version number, such as **1.8.42**, that follow the pattern of :'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶](https://semver.org/)åªæ˜¯ä¸€ä¸ªç¼–å·æ–¹æ¡ˆå’Œä¸šç•Œçš„æ ‡å‡†å®è·µã€‚å®ƒæŒ‡ç¤ºäº†è¯¥ç‰ˆæœ¬ä¸å‰ä¸€ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å˜æ›´ç¨‹åº¦ã€‚ä¸€ä¸ªè¯­ä¹‰ç‰ˆæœ¬å·æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¾‹å¦‚**1.8.42**ï¼Œéµå¾ªä»¥ä¸‹æ¨¡å¼ï¼š'
- en: '*MAJOR.MINOR.PATCH*'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MAJOR.MINOR.PATCH*'
- en: Each one of them means a different degree of change. A PATCH release indicates
    bug fixes or trivial changes (e.g. from 1.0.0 to 1.0.1). A MINOR release indicates
    adding/removing functionality or backwards compatible changes of functionality
    (e.g. from 1.0.0 to 1.1.0). A MAJOR release indicates adding/removing functionality
    and potentially backwards in-compatible changes such as breaking changes (e.g.
    from 1.0.0 to 2.0.0).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªéƒ¨åˆ†ä»£è¡¨äº†ä¸åŒç¨‹åº¦çš„å˜åŒ–ã€‚PATCH ç‰ˆæœ¬å‘å¸ƒè¡¨ç¤ºé”™è¯¯ä¿®å¤æˆ–å¾®å°æ›´æ”¹ï¼ˆä¾‹å¦‚ä» 1.0.0 åˆ° 1.0.1ï¼‰ã€‚MINOR ç‰ˆæœ¬å‘å¸ƒè¡¨ç¤ºæ·»åŠ /åˆ é™¤åŠŸèƒ½æˆ–å‘åå…¼å®¹çš„åŠŸèƒ½æ›´æ”¹ï¼ˆä¾‹å¦‚ä»
    1.0.0 åˆ° 1.1.0ï¼‰ã€‚MAJOR ç‰ˆæœ¬å‘å¸ƒè¡¨ç¤ºæ·»åŠ /åˆ é™¤åŠŸèƒ½ä»¥åŠå¯èƒ½çš„å‘åä¸å…¼å®¹çš„æ›´æ”¹ï¼Œä¾‹å¦‚ç ´åæ€§æ›´æ”¹ï¼ˆä¾‹å¦‚ä» 1.0.0 åˆ° 2.0.0ï¼‰ã€‚
- en: I recommend a [talk](https://www.youtube.com/watch?v=4wPjo5C-v8Y) of Mike Miles,
    if you want a visual introduction into releases with semantic versioning. Itâ€™s
    a summary of what releases are and how semantic versioning with [git tags](https://git-scm.com/book/en/v2/Git-Basics-Tagging)
    allows us to create releases.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ¨è[è¿ˆå…‹Â·è¿ˆå°”æ–¯](https://www.youtube.com/watch?v=4wPjo5C-v8Y)çš„ä¸€ä¸ªè®²åº§ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªå…³äºè¯­ä¹‰ç‰ˆæœ¬å‘å¸ƒçš„è§†è§‰ä»‹ç»ã€‚å®ƒæ€»ç»“äº†ä»€ä¹ˆæ˜¯å‘å¸ƒï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨[git
    æ ‡ç­¾](https://git-scm.com/book/en/v2/Git-Basics-Tagging)æ¥åˆ›å»ºç‰ˆæœ¬å‘å¸ƒã€‚
- en: 'About **git tags**: There are lightweight and annotated tags in git. A *lightweight*
    tag is just a pointer to a specific commit whereas an *annotated* tag is a full
    object in git.'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: å…³äº**git æ ‡ç­¾**ï¼šgit ä¸­æœ‰è½»é‡çº§æ ‡ç­¾å’Œæ³¨é‡Šæ ‡ç­¾ã€‚ä¸€ä¸ª*è½»é‡çº§*æ ‡ç­¾åªæ˜¯æŒ‡å‘ç‰¹å®šæäº¤çš„æŒ‡é’ˆï¼Œè€Œ*æ³¨é‡Š*æ ‡ç­¾åˆ™æ˜¯ git ä¸­çš„ä¸€ä¸ªå®Œæ•´å¯¹è±¡ã€‚
- en: Create a release manually
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ‰‹åŠ¨åˆ›å»ºç‰ˆæœ¬å‘å¸ƒ
- en: Letâ€™s create a release manually first and then automate it.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å…ˆæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒï¼Œç„¶åå†è¿›è¡Œè‡ªåŠ¨åŒ–å¤„ç†ã€‚
- en: If you remember, our example_appâ€™s `__init__.py` file contains the version
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ è®°å¾—ï¼Œæˆ‘ä»¬çš„ example_app çš„ `__init__.py` æ–‡ä»¶åŒ…å«äº†ç‰ˆæœ¬ä¿¡æ¯ã€‚
- en: '[PRE0]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: as well as the `pyproject.toml` file
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥åŠ `pyproject.toml` æ–‡ä»¶
- en: '[PRE1]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'So the first thing we must do is to create an annotated git tag `v0.1.0` and
    add it to the latest commit in main:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå¿…é¡»åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªæ³¨é‡Šçš„ git æ ‡ç­¾ `v0.1.0` å¹¶å°†å…¶æ·»åŠ åˆ°ä¸»åˆ†æ”¯çš„æœ€æ–°æäº¤ä¸­ï¼š
- en: '[PRE2]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Please note that if no commit hash is specified at the end of the command, then
    git will use the current commit you are on.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼Œå¦‚æœåœ¨å‘½ä»¤æœ«å°¾æ²¡æœ‰æŒ‡å®šæäº¤å“ˆå¸Œï¼Œåˆ™ git ä¼šä½¿ç”¨ä½ å½“å‰æ‰€åœ¨çš„æäº¤ã€‚
- en: 'We can get a list of tags with:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–æ ‡ç­¾åˆ—è¡¨ï¼š
- en: '[PRE3]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'and if we want delete it again:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æƒ³è¦å†æ¬¡åˆ é™¤å®ƒï¼š
- en: '[PRE4]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'and get more information about the tag with:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–æœ‰å…³è¯¥æ ‡ç­¾çš„æ›´å¤šä¿¡æ¯ï¼š
- en: '[PRE5]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We can push the newly created tag to origin with
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†æ–°åˆ›å»ºçš„æ ‡ç­¾æ¨é€åˆ° originï¼š
- en: '[PRE6]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'so that this git tag is now available on GitHub:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿å¾—è¿™ä¸ª git æ ‡ç­¾ç°åœ¨å¯ä»¥åœ¨ GitHub ä¸Šä½¿ç”¨ï¼š
- en: '![](../Images/b8daad7af39ff3448a87465c2b3a98b9.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b8daad7af39ff3448a87465c2b3a98b9.png)'
- en: 'Letâ€™s manually create a new release in GitHub with this git tag:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ‰‹åŠ¨åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬å‘å¸ƒï¼Œå¹¶ä½¿ç”¨è¿™ä¸ª git æ ‡ç­¾ï¼š
- en: '![](../Images/a3bb26a8179a416567385bbe324da5f9.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a3bb26a8179a416567385bbe324da5f9.png)'
- en: We click on `Create a new release` , select our existing tag (that is already
    bound to a commit) and then generate release notes automatically by clicking on
    the `Generate release notes` button before we finally publish the release with
    the `Publish release` button.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ç‚¹å‡» `Create a new release`ï¼Œé€‰æ‹©æˆ‘ä»¬ç°æœ‰çš„æ ‡ç­¾ï¼ˆå·²ç»ç»‘å®šåˆ°æäº¤ï¼‰ï¼Œç„¶åé€šè¿‡ç‚¹å‡» `Generate release notes`
    æŒ‰é’®è‡ªåŠ¨ç”Ÿæˆå‘å¸ƒè¯´æ˜ï¼Œæœ€åç”¨ `Publish release` æŒ‰é’®å‘å¸ƒè¯¥ç‰ˆæœ¬ã€‚
- en: '![](../Images/b49c9e26d316c7dab46743f61fb54f6c.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b49c9e26d316c7dab46743f61fb54f6c.png)'
- en: 'GitHub will automatically create a `tar` and a `zip` (assets) for the source
    code, but will not build the application! The result will look like this:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: GitHub å°†è‡ªåŠ¨ä¸ºæºä»£ç åˆ›å»º `tar` å’Œ `zip`ï¼ˆèµ„äº§ï¼‰ï¼Œä½†ä¸ä¼šæ„å»ºåº”ç”¨ç¨‹åºï¼ç»“æœå°†å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '![](../Images/cdb1cd2658a5eac059aefc07ca7c1579.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/cdb1cd2658a5eac059aefc07ca7c1579.png)'
- en: 'To summarise, the steps for a release are:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ç»“ä¸€ä¸‹ï¼Œå‘å¸ƒçš„æ­¥éª¤æ˜¯ï¼š
- en: create a new branch from your default branch (e.g. feature or fix branch)
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»ä½ çš„é»˜è®¤åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ï¼ˆä¾‹å¦‚åŠŸèƒ½æˆ–ä¿®å¤åˆ†æ”¯ï¼‰
- en: make changes and increase the version (e.g. *pyproject.toml* and *__init__.py*)
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿›è¡Œæ›´æ”¹å¹¶å¢åŠ ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ *pyproject.toml* å’Œ *__init__.py*ï¼‰
- en: commit the feature/bug fix to the default branch (probably through a Pull Request)
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†åŠŸèƒ½/é”™è¯¯ä¿®å¤æäº¤åˆ°é»˜è®¤åˆ†æ”¯ï¼ˆå¯èƒ½é€šè¿‡ Pull Requestï¼‰
- en: add an *annotated* git tag (semantic version) to the commit
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ·»åŠ ä¸€ä¸ª *æ³¨é‡Šçš„* git æ ‡ç­¾ï¼ˆè¯­ä¹‰ç‰ˆæœ¬ï¼‰åˆ°æäº¤ä¸­
- en: publish the release on GitHub with some additional information
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨ GitHub ä¸Šå‘å¸ƒç‰ˆæœ¬ï¼Œå¹¶é™„åŠ ä¸€äº›é¢å¤–ä¿¡æ¯
- en: Create a release automatically
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åˆ›å»ºå‘å¸ƒ
- en: As programmers, we donâ€™t like to repeat ourselves. So there are plenty of tools
    that make these steps super easy for us. Here, I will introduce [Semantic Releases](https://python-semantic-release.readthedocs.io/en/latest/),
    a tool specifically for Python Projects.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»¬ä¸å–œæ¬¢é‡å¤è‡ªå·±ã€‚å› æ­¤ï¼Œæœ‰å¾ˆå¤šå·¥å…·å¯ä»¥è®©è¿™äº›æ­¥éª¤å˜å¾—éå¸¸ç®€å•ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†ä»‹ç»[Semantic Releases](https://python-semantic-release.readthedocs.io/en/latest/)ï¼Œä¸€ä¸ªä¸“é—¨ä¸º
    Python é¡¹ç›®è®¾è®¡çš„å·¥å…·ã€‚
- en: Itâ€™s a tool which automatically sets a version number in your repo, tags the
    code with the version number and creates a release! And this is all done using
    the contents of **Conventional Commit** style messages.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åœ¨ä½ çš„ä»“åº“ä¸­è®¾ç½®ç‰ˆæœ¬å·ã€ç”¨ç‰ˆæœ¬å·æ ‡è®°ä»£ç å¹¶åˆ›å»ºå‘å¸ƒçš„å·¥å…·ï¼è¿™ä¸€åˆ‡éƒ½æ˜¯åŸºäº **çº¦å®šå¼æäº¤** é£æ ¼æ¶ˆæ¯çš„å†…å®¹å®Œæˆçš„ã€‚
- en: Conventional Commits
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: çº¦å®šå¼æäº¤
- en: What is the connection between semantic versioning and [conventional-commits](https://www.conventionalcommits.org/en/v1.0.0/)?
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶å’Œ [conventional-commits](https://www.conventionalcommits.org/en/v1.0.0/)
    ä¹‹é—´æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ
- en: Certain commit types can be used to automatically determine a semantic version
    bump!
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: æŸäº›æäº¤ç±»å‹å¯ä»¥ç”¨äºè‡ªåŠ¨ç¡®å®šè¯­ä¹‰ç‰ˆæœ¬çš„æå‡ï¼
- en: A `fix` commit is a PATCH.
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª `fix` æäº¤æ˜¯ PATCHã€‚
- en: A `feat` commit is a MINOR.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª `feat` æäº¤æ˜¯ MINORã€‚
- en: A commit with `BREAKING CHANGE` or `!` is a MAJOR.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå¸¦æœ‰ `BREAKING CHANGE` æˆ– `!` çš„æäº¤æ˜¯ MAJORã€‚
- en: Other types, e.g. `build`, `chore`, `ci`, `docs`, `style`, `refactor`, `perf`,
    `test` generally donâ€™t increase the version.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–ç±»å‹çš„æäº¤ï¼Œä¾‹å¦‚ `build`ã€`chore`ã€`ci`ã€`docs`ã€`style`ã€`refactor`ã€`perf`ã€`test` é€šå¸¸ä¸ä¼šå¢åŠ ç‰ˆæœ¬ã€‚
- en: Check out the bonus section at the end to find out how to enforce conventional
    commits in your project!
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: æŸ¥çœ‹æœ€åçš„é™„åŠ éƒ¨åˆ†ï¼Œäº†è§£å¦‚ä½•åœ¨ä½ çš„é¡¹ç›®ä¸­å¼ºåˆ¶æ‰§è¡Œçº¦å®šå¼æäº¤ï¼
- en: Automatic semantic releases (locally)
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨è¯­ä¹‰ç‰ˆæœ¬å‘å¸ƒï¼ˆæœ¬åœ°ï¼‰
- en: 'We can add the library with:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ·»åŠ åº“ï¼š
- en: '[PRE7]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Letâ€™s go through the configuration settings that allow us to automatically
    generate change-logs and releases. In the `pyproject.toml`, we can add *semantic_release*
    as a tool:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ·±å…¥é…ç½®è®¾ç½®ï¼Œä»¥ä¾¿è‡ªåŠ¨ç”Ÿæˆå˜æ›´æ—¥å¿—å’Œå‘å¸ƒã€‚åœ¨ `pyproject.toml` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°† *semantic_release* ä½œä¸ºå·¥å…·æ·»åŠ ï¼š
- en: '[PRE8]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '`branch`: specifies the branch that the release should be based on, in this
    case the "main" branch.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`branch`ï¼šæŒ‡å®šå‘å¸ƒåº”åŸºäºçš„åˆ†æ”¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ "main" åˆ†æ”¯ã€‚'
- en: '`version_variable`: specifies the file path and variable name of the version
    number in the source code. In this case, the version number is stored in the `__version__`
    variable in the file `src/example_app/__init__.py`.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version_variable`ï¼šæŒ‡å®šæºä»£ç ä¸­ç‰ˆæœ¬å·çš„æ–‡ä»¶è·¯å¾„å’Œå˜é‡åç§°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å·å­˜å‚¨åœ¨æ–‡ä»¶ `src/example_app/__init__.py`
    ä¸­çš„ `__version__` å˜é‡ä¸­ã€‚'
- en: '`version_toml`: specifies the file path and variable name of the version number
    in the `pyproject.toml` file. In this case, the version number is stored in the
    `tool.poetry.version` variable of the `pyproject.toml` file'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version_toml`ï¼šæŒ‡å®š`pyproject.toml`æ–‡ä»¶ä¸­ç‰ˆæœ¬å·çš„æ–‡ä»¶è·¯å¾„å’Œå˜é‡åç§°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å·å­˜å‚¨åœ¨ `pyproject.toml`
    æ–‡ä»¶çš„ `tool.poetry.version` å˜é‡ä¸­ã€‚'
- en: '`version_source`: Specifies the source of the version number. In this case,
    the version number is obtained from the tag (instead of commit)'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version_source`ï¼šæŒ‡å®šç‰ˆæœ¬å·çš„æ¥æºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å·æ¥è‡ªæ ‡ç­¾ï¼ˆè€Œä¸æ˜¯æäº¤ï¼‰ã€‚'
- en: '`commit_version_number`: This parameter is required when `version_source =
    "tag"`. It specifies whether the version number should be committed to the repository
    or not. In this case, it is set to true, which means that version number will
    be committed.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`commit_version_number`ï¼šå½“`version_source = "tag"`æ—¶ï¼Œæ­¤å‚æ•°æ˜¯å¿…éœ€çš„ã€‚å®ƒæŒ‡å®šæ˜¯å¦å°†ç‰ˆæœ¬å·æäº¤åˆ°ä»“åº“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè®¾ç½®ä¸º
    trueï¼Œè¿™æ„å‘³ç€ç‰ˆæœ¬å·å°†è¢«æäº¤ã€‚'
- en: '`tag_commit`: Specifies whether a new tag should be created for the release
    commit. In this case, it is set to true, which means that a new tag will be created.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tag_commit`ï¼šæŒ‡å®šæ˜¯å¦ä¸ºå‘å¸ƒæäº¤åˆ›å»ºæ–°çš„æ ‡ç­¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè®¾ç½®ä¸º trueï¼Œè¿™æ„å‘³ç€å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æ ‡ç­¾ã€‚'
- en: '`upload_to_pypi`: Specifies whether the package should be uploaded to the PyPI
    package repository. In this case, it is set to false, which means that the package
    will not be uploaded to PyPI.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`upload_to_pypi`ï¼šæŒ‡å®šæ˜¯å¦å°†è½¯ä»¶åŒ…ä¸Šä¼ åˆ° PyPI åŒ…ä»“åº“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè®¾ç½®ä¸º falseï¼Œè¿™æ„å‘³ç€è½¯ä»¶åŒ…ä¸ä¼šä¸Šä¼ åˆ° PyPIã€‚'
- en: '`upload_to_release`: Specifies whether the package should be uploaded to the
    GitHub release page. In this case, it is set to false, which means that the package
    will not be uploaded to GitHub releases.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`upload_to_release`ï¼šæŒ‡å®šæ˜¯å¦å°†è½¯ä»¶åŒ…ä¸Šä¼ åˆ° GitHub å‘å¸ƒé¡µé¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè®¾ç½®ä¸º falseï¼Œè¿™æ„å‘³ç€è½¯ä»¶åŒ…ä¸ä¼šä¸Šä¼ åˆ°
    GitHub å‘å¸ƒé¡µé¢ã€‚'
- en: '`hvcs`: Specifies the hosting version control system of the project. In this
    case, it is set to "github", which means that the project is hosted on GitHub.
    "gitlab" is also supported.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hvcs`ï¼šæŒ‡å®šé¡¹ç›®çš„æ‰˜ç®¡ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè®¾ç½®ä¸º "github"ï¼Œè¿™æ„å‘³ç€é¡¹ç›®æ‰˜ç®¡åœ¨ GitHub ä¸Šã€‚"gitlab" ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚'
- en: 'We can update the files where we have defined the version of the project/module.
    For this we use the variable `version_variable` for normal files and `version_toml`
    for *.toml* files. The `version_source` defines the source of truth for the version.
    Because the version in these two files is tightly coupled with the git annotated
    tags, for example we create a git tag with every release automatically (flag `tag_commit`
    is set to true), we can use the source `tag` instead of the default value `commit`
    that looks for the last version in the commit messages. To be able to update the
    files and commit the changes, we [need to set the](https://github.com/relekang/python-semantic-release/issues/104)
    `[commit_version_number](https://github.com/relekang/python-semantic-release/issues/104)`
    [flag to true](https://github.com/relekang/python-semantic-release/issues/104).
    Because we donâ€™t want to upload anything to the Python index [PyPi](https://pypi.org/),
    the flag `upload_to_pypi` is set to false. And for now we donâ€™t want to upload
    anything to our releases. The `hvcs` is set to `github` (default), other values
    can be: `gitlab`.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥æ›´æ–°å®šä¹‰é¡¹ç›®/æ¨¡å—ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨å˜é‡`version_variable`ç”¨äºæ™®é€šæ–‡ä»¶ï¼Œ`version_toml`ç”¨äº*.toml*
    æ–‡ä»¶ã€‚`version_source`å®šä¹‰äº†ç‰ˆæœ¬çš„çœŸå®æ€§æ¥æºã€‚ç”±äºè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„ç‰ˆæœ¬ä¸ git æ³¨é‡Šæ ‡ç­¾ç´§å¯†è€¦åˆï¼Œä¾‹å¦‚æˆ‘ä»¬æ¯æ¬¡å‘å¸ƒæ—¶è‡ªåŠ¨åˆ›å»º git æ ‡ç­¾ï¼ˆæ ‡å¿—`tag_commit`è®¾ç½®ä¸º
    trueï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æº`tag`ï¼Œè€Œä¸æ˜¯é»˜è®¤å€¼`commit`ï¼Œåè€…åœ¨æäº¤ä¿¡æ¯ä¸­æŸ¥æ‰¾æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚ä¸ºäº†èƒ½å¤Ÿæ›´æ–°æ–‡ä»¶å¹¶æäº¤æ›´æ”¹ï¼Œæˆ‘ä»¬[éœ€è¦è®¾ç½®](https://github.com/relekang/python-semantic-release/issues/104)
    `[commit_version_number](https://github.com/relekang/python-semantic-release/issues/104)`
    [æ ‡å¿—ä¸º true](https://github.com/relekang/python-semantic-release/issues/104)ã€‚å› ä¸ºæˆ‘ä»¬ä¸æƒ³å°†ä»»ä½•ä¸œè¥¿ä¸Šä¼ åˆ°
    Python ç´¢å¼• [PyPi](https://pypi.org/)ï¼Œæ‰€ä»¥æ ‡å¿—`upload_to_pypi`è®¾ç½®ä¸º falseã€‚ç°åœ¨æˆ‘ä»¬ä¹Ÿä¸æƒ³å°†ä»»ä½•ä¸œè¥¿ä¸Šä¼ åˆ°æˆ‘ä»¬çš„å‘å¸ƒé¡µé¢ã€‚`hvcs`è®¾ç½®ä¸º`github`ï¼ˆé»˜è®¤ï¼‰ï¼Œå…¶ä»–å€¼å¯ä»¥æ˜¯ï¼š`gitlab`ã€‚
- en: 'We can test this locally by running a few commands, that I will add directly
    to our Makefile:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œå‡ ä¸ªå‘½ä»¤åœ¨æœ¬åœ°æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œæˆ‘å°†ç›´æ¥å°†è¿™äº›å‘½ä»¤æ·»åŠ åˆ°æˆ‘ä»¬çš„ Makefile ä¸­ï¼š
- en: '[PRE9]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'With the command *current-version* we get the version from the last git tag
    in the git tree:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨å‘½ä»¤*current-version*æˆ‘ä»¬å¯ä»¥ä» git æ ‘ä¸­çš„æœ€åä¸€ä¸ª git æ ‡ç­¾è·å–ç‰ˆæœ¬ï¼š
- en: '[PRE10]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'If we add a few commits in conventional commit style, e.g. `feat: new cool
    feature` or `fix: nasty bug`, then the command **next-version** will compute the
    version bump for that:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 'å¦‚æœæˆ‘ä»¬ä»¥ä¼ ç»Ÿæäº¤é£æ ¼æ·»åŠ ä¸€äº›æäº¤ï¼Œä¾‹å¦‚ `feat: new cool feature` æˆ– `fix: nasty bug`ï¼Œé‚£ä¹ˆå‘½ä»¤ **next-version**
    å°†è®¡ç®—ç‰ˆæœ¬å·çš„å¢é‡ï¼š'
- en: '[PRE11]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Right now, we donâ€™t have a CHANGELOG file in our project, so that when we run:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¸­æ²¡æœ‰ CHANGELOG æ–‡ä»¶ï¼Œå› æ­¤å½“æˆ‘ä»¬è¿è¡Œï¼š
- en: '[PRE12]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'the output will be empty. But based on the commits we can create the upcoming
    changelog with:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºå°†æ˜¯ç©ºçš„ã€‚ä½†æ ¹æ®æäº¤è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åˆ›å»ºå³å°†å‘å¸ƒçš„å˜æ›´æ—¥å¿—ï¼š
- en: '[PRE13]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'If we push new commits (directly to main or through a PR) we could now publish
    a new release with:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æ¨é€æ–°çš„æäº¤ï¼ˆç›´æ¥åˆ°ä¸»åˆ†æ”¯æˆ–é€šè¿‡ PRï¼‰ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼š
- en: '[PRE14]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The publish command will do a sequence of things:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: å‘å¸ƒå‘½ä»¤å°†æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œï¼š
- en: Update or create the changelog file.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ›´æ–°æˆ–åˆ›å»ºå˜æ›´æ—¥å¿—æ–‡ä»¶ã€‚
- en: Run [semantic-release version](https://python-semantic-release.readthedocs.io/en/latest/index.html#cmd-version).
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¿è¡Œ [semantic-release version](https://python-semantic-release.readthedocs.io/en/latest/index.html#cmd-version)ã€‚
- en: Push changes to git.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†æ›´æ”¹æ¨é€åˆ° gitã€‚
- en: Run [build_command](https://python-semantic-release.readthedocs.io/en/latest/configuration.html#config-build-command)
    and upload the distribution file to your repository.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¿è¡Œ [build_command](https://python-semantic-release.readthedocs.io/en/latest/configuration.html#config-build-command)
    å¹¶å°†åˆ†å‘æ–‡ä»¶ä¸Šä¼ åˆ°ä½ çš„ä»“åº“ã€‚
- en: Run [semantic-release changelog](https://python-semantic-release.readthedocs.io/en/latest/index.html#cmd-changelog)
    and post to your vcs provider.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¿è¡Œ [semantic-release changelog](https://python-semantic-release.readthedocs.io/en/latest/index.html#cmd-changelog)
    å¹¶å‘å¸ƒåˆ°ä½ çš„ VCS æä¾›è€…ã€‚
- en: Attach the files created by [build_command](https://python-semantic-release.readthedocs.io/en/latest/configuration.html#config-build-command)
    to GitHub releases.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†ç”± [build_command](https://python-semantic-release.readthedocs.io/en/latest/configuration.html#config-build-command)
    åˆ›å»ºçš„æ–‡ä»¶é™„åŠ åˆ° GitHub å‘å¸ƒä¸­ã€‚
- en: Every step can be of course configured or deactivated!
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸€æ­¥å½“ç„¶éƒ½å¯ä»¥é…ç½®æˆ–ç¦ç”¨ï¼
- en: CI/CD
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CI/CD
- en: Letâ€™s build a CI pipeline with GitHub Actions that runs the publish command
    of semantic-release with every commit to the main branch.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨ GitHub Actions æ„å»ºä¸€ä¸ª CI æµæ°´çº¿ï¼Œæ¯æ¬¡æäº¤åˆ°ä¸»åˆ†æ”¯æ—¶è¿è¡Œ semantic-release çš„å‘å¸ƒå‘½ä»¤ã€‚
- en: 'While the overall structure remains the same as in *lint.yml*, *test.yml* or
    *pages.yml*, there are a few changes that need to be mentioned. In the step `Checkout
    repository`, we add a new token that is used to checkout the branch. That is because
    the default value `GITHUB_TOKEN` does not have the required permissions to operate
    on protected branches. Therefore, we must use a secret (**GH_TOKEN**) that contains
    a [Personal Access Token](https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line)
    with permissions. I will show later how the Personal Access Token can be generated.
    We also define `fetch-depth: 0` to fetch all history for all branches and tags.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 'è™½ç„¶æ•´ä½“ç»“æ„ä¸ *lint.yml*ã€*test.yml* æˆ– *pages.yml* ç›¸åŒï¼Œä½†æœ‰ä¸€äº›å˜åŒ–éœ€è¦è¯´æ˜ã€‚åœ¨æ­¥éª¤ `Checkout repository`
    ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ tokenï¼Œç”¨äºæ£€å‡ºåˆ†æ”¯ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤å€¼ `GITHUB_TOKEN` æ²¡æœ‰æ“ä½œå—ä¿æŠ¤åˆ†æ”¯æ‰€éœ€çš„æƒé™ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€ä¸ªåŒ…å« [ä¸ªäººè®¿é—®ä»¤ç‰Œ](https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line)
    æƒé™çš„ç§˜å¯† (**GH_TOKEN**) ã€‚ç¨åæˆ‘ä¼šå±•ç¤ºå¦‚ä½•ç”Ÿæˆä¸ªäººè®¿é—®ä»¤ç‰Œã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº† `fetch-depth: 0` ä»¥æå–æ‰€æœ‰åˆ†æ”¯å’Œæ ‡ç­¾çš„å…¨éƒ¨å†å²è®°å½•ã€‚'
- en: '[PRE15]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'We install only the dependencies that are required for the semantic-release
    tool with:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»…å®‰è£… semantic-release å·¥å…·æ‰€éœ€çš„ä¾èµ–é¡¹ï¼š
- en: '[PRE16]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'In the last step, we change some git configurations and run the publish command
    of semantic-release:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬æ›´æ”¹ä¸€äº› git é…ç½®å¹¶è¿è¡Œ semantic-release çš„å‘å¸ƒå‘½ä»¤ï¼š
- en: '[PRE17]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: By changing the git config, the user that commits will be â€œgithub-actionsâ€.
    We run the publish command with DEBUG logs (stdout) and set the `commit_author`
    to â€œgithub-actionsâ€ explicitly. Alternatively to this command, we could use the
    GitHub action from semantic-release directly, but the set up steps of running
    the publish command are [very few](https://github.com/relekang/python-semantic-release/blob/master/action.sh)
    and the action uses a docker container that needs to be pulled every time. Because
    of that I prefer to make a simple run step instead.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡æ›´æ”¹ git é…ç½®ï¼Œæäº¤çš„ç”¨æˆ·å°†ä¼šæ˜¯â€œgithub-actionsâ€ã€‚æˆ‘ä»¬ä»¥ DEBUG æ—¥å¿—ï¼ˆstdoutï¼‰è¿è¡Œå‘å¸ƒå‘½ä»¤ï¼Œå¹¶æ˜¾å¼å°† `commit_author`
    è®¾ç½®ä¸ºâ€œgithub-actionsâ€ã€‚é™¤äº†è¿™ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨ semantic-release çš„ GitHub actionï¼Œä½†è®¾ç½®æ­¥éª¤ [éå¸¸å°‘](https://github.com/relekang/python-semantic-release/blob/master/action.sh)ï¼Œä¸”è¯¥
    action æ¯æ¬¡éƒ½éœ€è¦æ‹‰å– docker å®¹å™¨ã€‚å› æ­¤ï¼Œæˆ‘æ›´å€¾å‘äºé‡‡ç”¨ç®€å•çš„è¿è¡Œæ­¥éª¤ã€‚
- en: Because the publish command will make a commit, you might be worried that we
    could end up in an endless loop of workflows being triggered. But do not worry,
    the resulting commit will not trigger another GitHub Actions Workflow run. This
    is due to [limitations set by GitHub](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#using-the-github_token-in-a-workflow).
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºå‘å¸ƒå‘½ä»¤ä¼šç”Ÿæˆæäº¤ï¼Œæ‚¨å¯èƒ½ä¼šæ‹…å¿ƒæˆ‘ä»¬ä¼šé™·å…¥è§¦å‘å·¥ä½œæµçš„æ— é™å¾ªç¯ã€‚ä½†è¯·æ”¾å¿ƒï¼Œç”Ÿæˆçš„æäº¤ä¸ä¼šè§¦å‘å¦ä¸€ä¸ª GitHub Actions å·¥ä½œæµè¿è¡Œã€‚è¿™æ˜¯ç”±äº
    [GitHub è®¾å®šçš„é™åˆ¶](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#using-the-github_token-in-a-workflow)ã€‚
- en: Create a Personal Access Token (PAT)
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆ›å»ºä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPATï¼‰
- en: Personal access token are an alternative to using passwords for authentication
    to GitHub Enterprise Server when using the [GitHub API](https://docs.github.com/en/enterprise-server@3.4/rest/overview/other-authentication-methods#via-oauth-and-personal-access-tokens)
    or the [command line](https://docs.github.com/en/enterprise-server@3.4/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line).
    Personal access tokens are intended to access GitHub resources on behalf of yourself.
    To access resources on behalf of an organization, or for long-lived integrations,
    you should use a GitHub App. For more information, see â€œ[About apps](https://docs.github.com/en/enterprise-server@3.4/developers/apps/getting-started-with-apps/about-apps).â€
  id: totrans-142
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸ªäººè®¿é—®ä»¤ç‰Œæ˜¯ä½¿ç”¨å¯†ç è¿›è¡Œ GitHub Enterprise Server èº«ä»½éªŒè¯çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå½“ä½¿ç”¨ [GitHub API](https://docs.github.com/en/enterprise-server@3.4/rest/overview/other-authentication-methods#via-oauth-and-personal-access-tokens)
    æˆ– [å‘½ä»¤è¡Œ](https://docs.github.com/en/enterprise-server@3.4/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line)
    æ—¶ã€‚ä¸ªäººè®¿é—®ä»¤ç‰Œæ—¨åœ¨ä»£è¡¨æ‚¨è®¿é—® GitHub èµ„æºã€‚è¦ä»£è¡¨ç»„ç»‡è®¿é—®èµ„æºæˆ–ç”¨äºé•¿æœŸé›†æˆï¼Œæ‚¨åº”è¯¥ä½¿ç”¨ GitHub åº”ç”¨ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§â€œ[å…³äºåº”ç”¨](https://docs.github.com/en/enterprise-server@3.4/developers/apps/getting-started-with-apps/about-apps)â€ã€‚
- en: 'In other words: We can create an **P**ersonal **A**ccess **T**oken and have
    GitHub actions store and use that **secret** to perform certain operations on
    our behalf. Keep in mind, if the PAT is compromised, it could be used to perform
    malicious actions on your GitHub repositories. It is therefore recommended to
    use GitHub OAuth Apps & GitHub Apps in organisations. For the purposes of this
    tutorial, we will be using a PAT to allow the GitHub actions pipeline to operate
    on our behalf.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: æ¢å¥è¯è¯´ï¼šæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª **P**ersonal **A**ccess **T**okenï¼Œå¹¶è®© GitHub Actions å­˜å‚¨å¹¶ä½¿ç”¨è¯¥ **secret**
    ä»£è¡¨æˆ‘ä»¬æ‰§è¡ŒæŸäº›æ“ä½œã€‚è¯·è®°ä½ï¼Œå¦‚æœ PAT è¢«æ³„éœ²ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºå¯¹æ‚¨çš„ GitHub ä»“åº“æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼Œå»ºè®®åœ¨ç»„ç»‡ä¸­ä½¿ç”¨ GitHub OAuth åº”ç”¨å’Œ
    GitHub åº”ç”¨ã€‚ä¸ºäº†æœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PAT å…è®¸ GitHub Actions æµæ°´çº¿ä»£è¡¨æˆ‘ä»¬æ“ä½œã€‚
- en: 'We can create a new access token by navigating to the `Settings` section of
    your GitHub user and following the instructions summarised in [Creating a Personal
    Access Token](https://docs.github.com/en/enterprise-server@3.4/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token).
    This will give us a window that will look like this:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¼èˆªåˆ° GitHub ç”¨æˆ·çš„ `Settings` éƒ¨åˆ†å¹¶æŒ‰ç…§ [åˆ›å»ºä¸ªäººè®¿é—®ä»¤ç‰Œ](https://docs.github.com/en/enterprise-server@3.4/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token)
    ä¸­æ€»ç»“çš„è¯´æ˜æ¥åˆ›å»ºæ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å°†ç»™æˆ‘ä»¬ä¸€ä¸ªçœ‹èµ·æ¥åƒè¿™æ ·çš„çª—å£ï¼š
- en: '![](../Images/ebb37e91c7cf7a89d51bca5eedaadd3a.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ebb37e91c7cf7a89d51bca5eedaadd3a.png)'
- en: Personal Access Token of an admin account with push access to the repos.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: å…·æœ‰æ¨é€è®¿é—®æƒé™çš„ç®¡ç†å‘˜å¸æˆ·çš„ä¸ªäººè®¿é—®ä»¤ç‰Œã€‚
- en: By selecting the scopes, we define what permissions the token will have. For
    our use case, we need **push access** to the repositories which why the new PAT
    `GH_TOKEN` should have the `repo` permissions scope. That scope would authorise
    pushes to protected branches, given you don't have *Include administrators* set
    in the protected branch's settings.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡é€‰æ‹©ä½œç”¨åŸŸï¼Œæˆ‘ä»¬å®šä¹‰ä»¤ç‰Œå°†å…·æœ‰çš„æƒé™ã€‚å¯¹äºæˆ‘ä»¬çš„ç”¨ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦ **push access** æƒé™ï¼Œå› æ­¤æ–°çš„ PAT `GH_TOKEN` åº”è¯¥å…·æœ‰
    `repo` æƒé™ä½œç”¨åŸŸã€‚è¯¥ä½œç”¨åŸŸå°†æˆæƒå¯¹å—ä¿æŠ¤åˆ†æ”¯çš„æ¨é€ï¼Œå‰ææ˜¯æ‚¨æ²¡æœ‰åœ¨å—ä¿æŠ¤åˆ†æ”¯çš„è®¾ç½®ä¸­å¯ç”¨ *åŒ…æ‹¬ç®¡ç†å‘˜*ã€‚
- en: 'Going back to the repository overview, in the **Settings** menu, we can either
    add an environment setting or a repository setting under the **Secrets** section:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: å›åˆ°ä»£ç åº“æ¦‚è§ˆï¼Œåœ¨ **è®¾ç½®** èœå•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ **å¯†é’¥** éƒ¨åˆ†æ·»åŠ ç¯å¢ƒè®¾ç½®æˆ–åº“è®¾ç½®ï¼š
- en: '![](../Images/456cd350112cf1c5a3e7c5a198412418.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/456cd350112cf1c5a3e7c5a198412418.png)'
- en: Repository secrets are specific to a single repository (and all environments
    used in there), while environment secrets are specific to an environment. The
    GitHub runner can be configured to run in a specific environment which allows
    it to access the environmentâ€™s secrets. This makes sense when thinking of different
    stages (e.g. DEV vs PROD) but for this tutorial Iâ€™m fine with a **repository secret**.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: ä»“åº“å¯†é’¥ç‰¹å®šäºå•ä¸ªä»“åº“ï¼ˆåŠå…¶ä¸­ä½¿ç”¨çš„æ‰€æœ‰ç¯å¢ƒï¼‰ï¼Œè€Œç¯å¢ƒå¯†é’¥ç‰¹å®šäºç¯å¢ƒã€‚GitHubè¿è¡Œå™¨å¯ä»¥é…ç½®ä¸ºåœ¨ç‰¹å®šç¯å¢ƒä¸­è¿è¡Œï¼Œè¿™å…è®¸å®ƒè®¿é—®è¯¥ç¯å¢ƒçš„å¯†é’¥ã€‚è¿™åœ¨è€ƒè™‘ä¸åŒé˜¶æ®µï¼ˆä¾‹å¦‚DEVä¸PRODï¼‰æ—¶æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å¯¹**ä»“åº“å¯†é’¥**æ„Ÿåˆ°æ»¡æ„ã€‚
- en: GitHub Actions Flow
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: GitHub Actions æµç¨‹
- en: Now that we a have a few pipelines (linting, testing, releasing, documentation),
    we should think about the flow of actions with a commit to main! There are a few
    things we should be aware of, some of them specific to GitHub.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†å‡ ä¸ªç®¡é“ï¼ˆlintingã€testingã€releasingã€documentationï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘ä¸»åˆ†æ”¯æäº¤çš„åŠ¨ä½œæµç¨‹ï¼æœ‰ä¸€äº›æˆ‘ä»¬éœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼Œå…¶ä¸­ä¸€äº›æ˜¯ç‰¹å®šäºGitHubçš„ã€‚
- en: Ideally, we want that a commit to main creates a push event that trigger the
    Testing and the Linting workflow. If these are successful, we run the release
    workflow which is responsible to detect if there should be a version bump based
    on conventional commits. If so, the release workflow will directly push to main,
    bumping the versions, adding a git tag and create a release. A published release
    should then, for example, update the documentation by running the documentation
    workflow.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸»åˆ†æ”¯çš„æäº¤åˆ›å»ºä¸€ä¸ªæ¨é€äº‹ä»¶ï¼Œä»è€Œè§¦å‘æµ‹è¯•å’Œlintingå·¥ä½œæµã€‚å¦‚æœè¿™äº›å·¥ä½œæµæˆåŠŸï¼Œæˆ‘ä»¬å°†è¿è¡Œå‘å¸ƒå·¥ä½œæµï¼Œè¯¥å·¥ä½œæµè´Ÿè´£åŸºäºä¼ ç»Ÿæäº¤æ£€æµ‹æ˜¯å¦éœ€è¦ç‰ˆæœ¬æå‡ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œå‘å¸ƒå·¥ä½œæµå°†ç›´æ¥æ¨é€åˆ°ä¸»åˆ†æ”¯ï¼Œæå‡ç‰ˆæœ¬ï¼Œæ·»åŠ gitæ ‡ç­¾å¹¶åˆ›å»ºå‘å¸ƒã€‚å‘å¸ƒçš„ç‰ˆæœ¬åº”å½“ä¾‹å¦‚é€šè¿‡è¿è¡Œæ–‡æ¡£å·¥ä½œæµæ¥æ›´æ–°æ–‡æ¡£ã€‚
- en: '![](../Images/d4523a1b24aa2afa5655c7adc014ffbf.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d4523a1b24aa2afa5655c7adc014ffbf.png)'
- en: Expected flow of actions
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æœŸçš„åŠ¨ä½œæµç¨‹
- en: Problems & considerations
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é—®é¢˜ä¸è€ƒè™‘
- en: If you read the last paragraph carefully or looked at the FlowChart above, you
    might have noticed that there are two commits to main. One initial (i.e. from
    a PR) and a second one for the release. Because our *lint.yml* and *test.yml*
    react on push events on the main branch, they would run twice! We should avoid
    running it twice to save resources. To achieve this, we can add the `[skip ci]`
    string to our version commit message. A custom commit message can be defined in
    the *pyproject.toml* file for the tool *semantic_release*.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä»”ç»†é˜…è¯»ä¸Šä¸€æ®µæˆ–æŸ¥çœ‹ä¸Šé¢çš„æµç¨‹å›¾ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°æœ‰ä¸¤ä¸ªä¸»åˆ†æ”¯çš„æäº¤ã€‚ä¸€ä¸ªæ˜¯åˆå§‹çš„ï¼ˆå³æ¥è‡ªPRï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨äºå‘å¸ƒçš„ã€‚ç”±äºæˆ‘ä»¬çš„*lint.yml*å’Œ*test.yml*åœ¨ä¸»åˆ†æ”¯çš„æ¨é€äº‹ä»¶ä¸‹ä¼šè§¦å‘ï¼Œå› æ­¤å®ƒä»¬ä¼šè¿è¡Œä¸¤æ¬¡ï¼ä¸ºäº†èŠ‚çœèµ„æºï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä¸¤æ¬¡è¿è¡Œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‰ˆæœ¬æäº¤æ¶ˆæ¯ä¸­æ·»åŠ `[skip
    ci]`å­—ç¬¦ä¸²ã€‚å¯ä»¥åœ¨*pyproject.toml*æ–‡ä»¶ä¸­ä¸ºå·¥å…·*semantic_release*å®šä¹‰è‡ªå®šä¹‰æäº¤æ¶ˆæ¯ã€‚
- en: '[PRE18]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '2\. The workflow *pages.yml* currently runs on a push event to main. Updating
    the documentation could be something that we only want to do if there is a new
    release (We might be referencing the version in the documentation). We can change
    the trigger in the *pages.yml* file accordingly:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. å·¥ä½œæµ*pages.yml*å½“å‰åœ¨æ¨é€åˆ°ä¸»åˆ†æ”¯æ—¶è¿è¡Œã€‚æ›´æ–°æ–‡æ¡£å¯èƒ½åªæ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨æœ‰æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶åšçš„äº‹æƒ…ï¼ˆæˆ‘ä»¬å¯èƒ½ä¼šåœ¨æ–‡æ¡£ä¸­å¼•ç”¨ç‰ˆæœ¬ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ç›¸åº”åœ°æ›´æ”¹*pages.yml*æ–‡ä»¶ä¸­çš„è§¦å‘å™¨ï¼š
- en: '[PRE19]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Building the documentation will now require a **published release**.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæ„å»ºæ–‡æ¡£å°†éœ€è¦**å·²å‘å¸ƒçš„ç‰ˆæœ¬**ã€‚
- en: '3\. The Release workflow should depend on the success of the Linting & Testing
    workflow. Currently we donâ€™t have defined dependencies in our workflow files.
    We could have these workflows depend on the completion of defined workflow runs
    in a specific branch with the `[workflow_run](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflow_run)`
    event. However, if we specify multiple `workflows` for the `workflow_run` event:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. å‘å¸ƒå·¥ä½œæµåº”è¯¥ä¾èµ–äºlintingå’Œtestingå·¥ä½œæµçš„æˆåŠŸã€‚ç›®å‰ï¼Œæˆ‘ä»¬åœ¨å·¥ä½œæµæ–‡ä»¶ä¸­æ²¡æœ‰å®šä¹‰ä¾èµ–å…³ç³»ã€‚æˆ‘ä»¬å¯ä»¥è®©è¿™äº›å·¥ä½œæµä¾èµ–äºç‰¹å®šåˆ†æ”¯ä¸Šå®šä¹‰çš„å·¥ä½œæµè¿è¡Œçš„å®Œæˆï¼Œä½¿ç”¨`[workflow_run](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflow_run)`äº‹ä»¶ã€‚ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä¸º`workflow_run`äº‹ä»¶æŒ‡å®šå¤šä¸ª`workflows`ï¼š
- en: '[PRE20]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: only one of the workflows needs to completed! This is not what we want. We expect
    that all **workflows** must be completed (and successful). Only then the release
    workflow should run. This is in contrast to what we get when we define dependencies
    between **jobs** in a single workflow. Read more about this inconsistency and
    shortcoming [here](https://github.com/community/community/discussions/16059).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: ä»…ä¸€ä¸ªå·¥ä½œæµéœ€è¦å®Œæˆï¼è¿™ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚æˆ‘ä»¬æœŸæœ›æ‰€æœ‰**å·¥ä½œæµ**éƒ½å¿…é¡»å®Œæˆï¼ˆå¹¶æˆåŠŸï¼‰ã€‚åªæœ‰åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘å¸ƒå·¥ä½œæµæ‰åº”è¿è¡Œã€‚è¿™ä¸åœ¨å•ä¸ªå·¥ä½œæµä¸­å®šä¹‰**ä½œä¸š**ä¹‹é—´çš„ä¾èµ–å…³ç³»æ—¶å¾—åˆ°çš„ç»“æœç›¸åã€‚æ›´å¤šå…³äºè¿™ç§ä¸ä¸€è‡´å’Œä¸è¶³çš„å†…å®¹ï¼Œè¯·é˜…è¯»[è¿™é‡Œ](https://github.com/community/community/discussions/16059)ã€‚
- en: 'As an alternative, we could use a sequential execution of pipelines:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµæ°´çº¿çš„é¡ºåºæ‰§è¡Œï¼š
- en: '![](../Images/88bfe140d76fef3bfe6c8622c2cd4e07.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/88bfe140d76fef3bfe6c8622c2cd4e07.png)'
- en: The big downside with this idea is that it **a)** does not allow parallel execution
    and **b)** we wonâ€™t be able to see the dependency graph in GitHub.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æƒ³æ³•çš„ä¸€ä¸ªå¤§ç¼ºç‚¹æ˜¯å®ƒ **a)** ä¸å…è®¸å¹¶è¡Œæ‰§è¡Œå’Œ **b)** æˆ‘ä»¬å°†æ— æ³•åœ¨ GitHub ä¸­æŸ¥çœ‹ä¾èµ–å›¾ã€‚
- en: Solution
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è§£å†³æ–¹æ¡ˆ
- en: Currently, the only way I see to deal with the above mentioned problems is to
    orchestrate the workflows in an orchestrator workflow.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œæˆ‘è®¤ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜çš„å”¯ä¸€æ–¹æ³•æ˜¯å°†å·¥ä½œæµåœ¨ä¸€ä¸ªåè°ƒå™¨å·¥ä½œæµä¸­è¿›è¡Œåè°ƒã€‚
- en: '![](../Images/591405e03e0593cd5fde44296b4d6f2b.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/591405e03e0593cd5fde44296b4d6f2b.png)'
- en: 'Letâ€™s create this workflow file:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åˆ›å»ºè¿™ä¸ªå·¥ä½œæµæ–‡ä»¶ï¼š
- en: The orchestrator is triggered when we push to the branch `main` .
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬æ¨é€åˆ° `main` åˆ†æ”¯æ—¶ï¼Œåè°ƒå™¨è¢«è§¦å‘ã€‚
- en: '![](../Images/958201b9b29998674fbb7a9c2a87526c.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/958201b9b29998674fbb7a9c2a87526c.png)'
- en: 'Only if both workflows: Testing & Linting are successful, the release workflow
    is called. This is defined in with the `needs` keyword. If we want to have more
    granular control over job executions (workflows), consider using the `if` keyword
    as well. But be aware of the *confusing* behaviour as explained in this [article](https://samanpavel.medium.com/github-actions-conditional-job-execution-e6aa363d2867).'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: åªæœ‰åœ¨ä¸¤ä¸ªå·¥ä½œæµï¼šTesting å’Œ Linting éƒ½æˆåŠŸæ—¶ï¼Œæ‰ä¼šè°ƒç”¨å‘å¸ƒå·¥ä½œæµã€‚è¿™åœ¨ `needs` å…³é”®å­—ä¸­å®šä¹‰ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›å¯¹ä½œä¸šæ‰§è¡Œï¼ˆå·¥ä½œæµï¼‰æœ‰æ›´ç»†è‡´çš„æ§åˆ¶ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨
    `if` å…³é”®å­—ã€‚ä½†è¦æ³¨æ„ï¼Œå¦‚ [è¿™ç¯‡æ–‡ç« ](https://samanpavel.medium.com/github-actions-conditional-job-execution-e6aa363d2867)
    æ‰€è¿°çš„*ä»¤äººå›°æƒ‘*è¡Œä¸ºã€‚
- en: 'To make our workflows `lint.yml` , `test.yml` & `release.yml` callable by another
    workflow, we need to update the triggers:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ä½¿æˆ‘ä»¬çš„å·¥ä½œæµ `lint.yml`ã€`test.yml` å’Œ `release.yml` å¯ä»¥è¢«å¦ä¸€ä¸ªå·¥ä½œæµè°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°è§¦å‘å™¨ï¼š
- en: '[PRE21]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Now the new workflow (Release) should only run if the workflows for quality
    checking, in this case the linting and testing, succeed.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæ–°å·¥ä½œæµï¼ˆReleaseï¼‰åº”è¯¥ä»…åœ¨è´¨é‡æ£€æŸ¥å·¥ä½œæµæˆåŠŸçš„æƒ…å†µä¸‹è¿è¡Œï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯ linting å’Œ testingã€‚
- en: Badge
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¾½ç« 
- en: To create a badge, this time, I will use the platform [shields.io](https://shields.io/).
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: è¦åˆ›å»ºå¾½ç« ï¼Œè¿™æ¬¡æˆ‘å°†ä½¿ç”¨å¹³å° [shields.io](https://shields.io/)ã€‚
- en: Itâ€™s a website that generates badges for projects, which display information
    such as version, build status, and code coverage. It offers a wide range of templates
    and allows customization of appearance and creation of custom badges. The badges
    are updated automatically, providing real-time information about the project.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªä¸ºé¡¹ç›®ç”Ÿæˆå¾½ç« çš„ç½‘ç«™ï¼Œå¾½ç« æ˜¾ç¤ºè¯¸å¦‚ç‰ˆæœ¬ã€æ„å»ºçŠ¶æ€å’Œä»£ç è¦†ç›–ç‡ç­‰ä¿¡æ¯ã€‚å®ƒæä¾›äº†å¹¿æ³›çš„æ¨¡æ¿ï¼Œå¹¶å…è®¸å®šåˆ¶å¤–è§‚å’Œåˆ›å»ºè‡ªå®šä¹‰å¾½ç« ã€‚å¾½ç« ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œæä¾›é¡¹ç›®çš„å®æ—¶ä¿¡æ¯ã€‚
- en: 'For a release badge, I selected `GitHub release (latest SemVer)` :'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºå‘å¸ƒå¾½ç« ï¼Œæˆ‘é€‰æ‹©äº† `GitHub release (latest SemVer)`ï¼š
- en: '![](../Images/530966bfab9ec5c4435c88aaebcce731.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/530966bfab9ec5c4435c88aaebcce731.png)'
- en: The badge markdown can be copied and added to the *README.md:*
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: å¾½ç« çš„ Markdown å¯ä»¥å¤åˆ¶å¹¶æ·»åŠ åˆ° *README.md* ä¸­ï¼š
- en: 'Our landing page of the GitHub now looks like this â¤ (Iâ€™ve cleaned up a little
    and provided a description):'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„ GitHub ç™»å½•é¡µé¢ç°åœ¨çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ â¤ï¼ˆæˆ‘ç¨å¾®æ•´ç†äº†ä¸€ä¸‹ï¼Œå¹¶æä¾›äº†æè¿°ï¼‰ï¼š
- en: '![](../Images/03ce33d4b73c88fa3a45a80fa85f104d.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/03ce33d4b73c88fa3a45a80fa85f104d.png)'
- en: Congratulations! You have completed the main part of this tutorial! You have
    learned the essential steps for managing **software releases**. We began by manually
    creating a release, and then leveraged the power of **Conventional Commits** to
    automate our release process through a **CI pipeline**, which handles versioning
    on our behalf. To finalize, we added a **badge** in our README.md file, providing
    a clear and concise display of the latest version of our project for our users.
    With these techniques in hand, youâ€™ll be able to efficiently and effectively manage
    your software releases.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: æ­å–œï¼ä½ å·²ç»å®Œæˆäº†æœ¬æ•™ç¨‹çš„ä¸»è¦éƒ¨åˆ†ï¼ä½ å·²ç»å­¦ä¹ äº†ç®¡ç† **è½¯ä»¶å‘å¸ƒ** çš„åŸºæœ¬æ­¥éª¤ã€‚æˆ‘ä»¬é¦–å…ˆæ‰‹åŠ¨åˆ›å»ºäº†ä¸€ä¸ªå‘å¸ƒï¼Œç„¶ååˆ©ç”¨ **Conventional
    Commits** çš„åŠ›é‡ï¼Œé€šè¿‡ **CI pipeline** è‡ªåŠ¨åŒ–æˆ‘ä»¬çš„å‘å¸ƒè¿‡ç¨‹ï¼Œå¤„ç†ç‰ˆæœ¬æ§åˆ¶ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨ README.md æ–‡ä»¶ä¸­æ·»åŠ äº† **å¾½ç« **ï¼Œä¸ºç”¨æˆ·æä¾›äº†é¡¹ç›®æœ€æ–°ç‰ˆæœ¬çš„æ¸…æ™°è€Œç®€æ´çš„æ˜¾ç¤ºã€‚æŒæ¡äº†è¿™äº›æŠ€å·§ï¼Œä½ å°†èƒ½å¤Ÿé«˜æ•ˆè€Œæœ‰æ•ˆåœ°ç®¡ç†ä½ çš„è½¯ä»¶å‘å¸ƒã€‚
- en: 'The next part will be the last part, which covers: **Containerisation**!'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€éƒ¨åˆ†å°†æ˜¯æœ€åä¸€éƒ¨åˆ†ï¼Œæ¶µç›–ï¼š**å®¹å™¨åŒ–**ï¼
- en: '[](https://johschmidt42.medium.com/membership?source=post_page-----206df3c1e3d3--------------------------------)
    [## Join Medium with my referral link - Johannes Schmidt'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://johschmidt42.medium.com/membership?source=post_page-----206df3c1e3d3--------------------------------)
    [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium - Johannes Schmidt'
- en: Read every story from Johannes Schmidt (and thousands of other writers on Medium).
    Your membership fee directlyâ€¦
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: é˜…è¯» Johannes Schmidt çš„æ¯ä¸€ç¯‡æ•…äº‹ï¼ˆä»¥åŠ Medium ä¸Šå…¶ä»–æ•°åƒåä½œè€…çš„æ•…äº‹ï¼‰ã€‚æ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥â€¦
- en: johschmidt42.medium.com](https://johschmidt42.medium.com/membership?source=post_page-----206df3c1e3d3--------------------------------)
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '[johschmidt42.medium.com](https://johschmidt42.medium.com/membership?source=post_page-----206df3c1e3d3--------------------------------)'
- en: Bonus
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¥–åŠ±
- en: Ensure Conventional Commits
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç¡®ä¿ä½¿ç”¨è§„èŒƒæäº¤
- en: 'We have seen that commits in a defined format can help us with versioning.
    In a collaborative project, we probably want to enforce this format for all commits
    to the default branch. Two popular tools can help developers follow the conventional
    commits format:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼ŒæŒ‰ç…§å®šä¹‰æ ¼å¼çš„æäº¤å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚åœ¨ä¸€ä¸ªåä½œé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›å¯¹æ‰€æœ‰æäº¤åˆ°é»˜è®¤åˆ†æ”¯çš„æäº¤å¼ºåˆ¶æ‰§è¡Œè¿™ç§æ ¼å¼ã€‚ä¸¤ä¸ªæµè¡Œçš„å·¥å…·å¯ä»¥å¸®åŠ©å¼€å‘è€…éµå¾ªè§„èŒƒæäº¤æ ¼å¼ï¼š
- en: '[commitizen](https://github.com/commitizen/cz-cli)'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[commitizen](https://github.com/commitizen/cz-cli)'
- en: '[commitlint](https://github.com/conventional-changelog/commitlint)'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[commitlint](https://github.com/conventional-changelog/commitlint)'
- en: However, some developers feel that these tools are a little restrictive and
    and avoid using them*. So itâ€™s probably a bad idea to just hope that there will
    always be conventional commits. Therefore, it makes sense to enforce rules, such
    as the conventional commit format, on the server side!
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œä¸€äº›å¼€å‘è€…è§‰å¾—è¿™äº›å·¥å…·æœ‰ç‚¹é™åˆ¶æ€§ï¼Œå› æ­¤é¿å…ä½¿ç”¨å®ƒä»¬*ã€‚æ‰€ä»¥ä»…ä»…å¸Œæœ›æ€»æ˜¯æœ‰è§„èŒƒæäº¤å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚å› æ­¤ï¼Œåœ¨æœåŠ¡å™¨ç«¯å¼ºåˆ¶æ‰§è¡Œè§„åˆ™ï¼Œå¦‚è§„èŒƒæäº¤æ ¼å¼ï¼Œæ‰æ˜¯æ˜æ™ºçš„ï¼
- en: '**The same applies to* [*pre-commit*](https://pre-commit.com/) *hooks, which
    is why I excluded them in this series.*'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '**åŒæ ·é€‚ç”¨äº* [*pre-commit*](https://pre-commit.com/) *é’©å­ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨è¿™ä¸€ç³»åˆ—ä¸­æ’é™¤å®ƒä»¬çš„åŸå› ã€‚*'
- en: 'Unfortunately, it is currently not possible (May 2023) to block commits based
    on rules on GitHub as the [feature for this is still open](https://github.com/github/roadmap/issues/476).
    But we can try to get as close as possible via **branch protection rules** and
    a **CI workflow**. So here are the things that we require for such a strategy
    in our repo:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸å¹¸çš„æ˜¯ï¼Œç›®å‰ï¼ˆ2023 å¹´ 5 æœˆï¼‰åœ¨ GitHub ä¸ŠåŸºäºè§„åˆ™é˜»æ­¢æäº¤ä»ç„¶ä¸å¯è¡Œï¼Œå› ä¸º [è¯¥åŠŸèƒ½ä»åœ¨å¼€å‘ä¸­](https://github.com/github/roadmap/issues/476)ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡**åˆ†æ”¯ä¿æŠ¤è§„åˆ™**å’Œ**CI
    å·¥ä½œæµ**å°½å¯èƒ½æ¥è¿‘è¿™ä¸ªç›®æ ‡ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨ä»“åº“ä¸­éœ€è¦çš„ç­–ç•¥ï¼š
- en: Commits to the protected default branch (e.g. main) should be restricted to
    **pull request** (PR) commits.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯¹å—ä¿æŠ¤çš„é»˜è®¤åˆ†æ”¯ï¼ˆä¾‹å¦‚ mainï¼‰çš„æäº¤åº”è¯¥é™åˆ¶ä¸º**æ‹‰å–è¯·æ±‚**ï¼ˆPRï¼‰æäº¤ã€‚
- en: Only [squashed commits](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/configuring-commit-squashing-for-pull-requests)
    should be allowed*
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åªæœ‰ [å‹ç¼©æäº¤](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/configuring-commit-squashing-for-pull-requests)
    åº”è¯¥è¢«å…è®¸*ã€‚
- en: The **default commit message** presented when merging a pull request with squash
    should be the **pull request** **title**
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå¹¶æ‹‰å–è¯·æ±‚æ—¶å±•ç¤ºçš„**é»˜è®¤æäº¤ä¿¡æ¯**åº”è¯¥æ˜¯**æ‹‰å–è¯·æ±‚** **æ ‡é¢˜**ã€‚
- en: If the only way to commit to the **protected** default branch (e.g. main) is
    via a pull request ([squashed commites](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/configuring-commit-squashing-for-pull-requests)
    only), we can use a GitHub Action, such as [amannn/action-semantic-pull-request](https://github.com/amannn/action-semantic-pull-request),
    that ensures that the pull requestâ€™s title matches the [Conventional Commits spec](https://www.conventionalcommits.org/).
    So when we `squash and merge` the PR branch (assuming all required pipelines succeed),
    the suggested commit message is the PR title which was previously checked the
    by GitHub action run.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœå¯¹**å—ä¿æŠ¤**çš„é»˜è®¤åˆ†æ”¯ï¼ˆä¾‹å¦‚ mainï¼‰çš„å”¯ä¸€æäº¤æ–¹å¼æ˜¯é€šè¿‡æ‹‰å–è¯·æ±‚ï¼ˆ[å‹ç¼©æäº¤](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/configuring-commit-squashing-for-pull-requests)
    ä»…é™ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ GitHub Actionï¼Œå¦‚ [amannn/action-semantic-pull-request](https://github.com/amannn/action-semantic-pull-request)ï¼Œç¡®ä¿æ‹‰å–è¯·æ±‚çš„æ ‡é¢˜ç¬¦åˆ
    [è§„èŒƒæäº¤è§„èŒƒ](https://www.conventionalcommits.org/)ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬ `squash and merge` PR åˆ†æ”¯ï¼ˆå‡è®¾æ‰€æœ‰å¿…éœ€çš„æµæ°´çº¿æˆåŠŸï¼‰æ—¶ï¼Œå»ºè®®çš„æäº¤ä¿¡æ¯å°±æ˜¯
    PR æ ‡é¢˜ï¼Œè¯¥æ ‡é¢˜ä¹‹å‰ç”± GitHub action è¿è¡Œæ£€æŸ¥è¿‡ã€‚
- en: '**The squash and merge strategy is a popular method for merging code changes
    from a feature branch into the main branch, which involves condensing multiple
    commits in a feature branch into a single commit. This creates a linear and consistent
    git history, where each commit represents a specific change. However, this method
    does have its downsides, as it discards granular commit history, which can be
    valuable for understanding the development process. While it is possible to use
    rebase merging to retain this information, it can introduce complexity to the
    workflow. In this sense, the squash and merge strategy is favoured for its simplicity.*'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**Squash and merge ç­–ç•¥æ˜¯ä¸€ç§æµè¡Œçš„ä»£ç åˆå¹¶æ–¹æ³•ï¼Œå®ƒå°†åŠŸèƒ½åˆ†æ”¯ä¸­çš„å¤šä¸ªæäº¤åˆå¹¶ä¸ºä¸€ä¸ªæäº¤ã€‚è¿™ç§æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªçº¿æ€§çš„ã€ä¸€è‡´çš„ git
    å†å²è®°å½•ï¼Œå…¶ä¸­æ¯ä¸ªæäº¤ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„æ›´æ”¹ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæœ‰å…¶ç¼ºç‚¹ï¼Œå› ä¸ºå®ƒä¸¢å¼ƒäº†è¯¦ç»†çš„æäº¤å†å²è®°å½•ï¼Œè¿™å¯¹äºç†è§£å¼€å‘è¿‡ç¨‹æ˜¯æœ‰ä»·å€¼çš„ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨ rebase
    åˆå¹¶æ¥ä¿ç•™è¿™äº›ä¿¡æ¯ï¼Œä½†è¿™å¯èƒ½ä¼šç»™å·¥ä½œæµå¸¦æ¥å¤æ‚æ€§ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œsquash and merge ç­–ç•¥å› å…¶ç®€å•æ€§è€Œå—åˆ°é’çã€‚*'
- en: Workflow
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å·¥ä½œæµ
- en: 'Letâ€™s create the GitHub Actions workflow for this strategy:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸ºè¿™ä¸ªç­–ç•¥åˆ›å»º GitHub Actions å·¥ä½œæµï¼š
- en: The **trigger event** `pull_request_target` is explained [here](https://github.com/amannn/action-semantic-pull-request#event-triggers).
    I use the suggested types `opened` , `edited` , `synchronize` . The `GITHUB_TOKEN`
    is passed as `env` to the action. So, whenever the title is changed in a PR, the
    pipeline is triggered. It only succeeds if the PRâ€™s title is in the conventional
    commit format.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '**è§¦å‘äº‹ä»¶** `pull_request_target` çš„è§£é‡Šè§ [è¿™é‡Œ](https://github.com/amannn/action-semantic-pull-request#event-triggers)ã€‚æˆ‘ä½¿ç”¨äº†å»ºè®®çš„ç±»å‹
    `opened` ã€`edited` ã€`synchronize` ã€‚`GITHUB_TOKEN` è¢«ä½œä¸º `env` ä¼ é€’ç»™ actionã€‚å› æ­¤ï¼Œæ¯å½“ PR
    çš„æ ‡é¢˜å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç®¡é“å°±ä¼šè§¦å‘ã€‚åªæœ‰å½“ PR çš„æ ‡é¢˜ç¬¦åˆçº¦å®šçš„æäº¤æ ¼å¼æ—¶ï¼Œç®¡é“æ‰ä¼šæˆåŠŸã€‚'
- en: Please note that
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„
- en: you need to have this configuration in the main branch for the action to run
    at all (e.g. it wonâ€™t run within a PR that adds the action initially). Also if
    you change the configuration in a PR, the changes will not be reflected for the
    current PR â€” only subsequent ones after the changes are in the main branch.
  id: totrans-210
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦åœ¨ä¸»åˆ†æ”¯ä¸­æ‹¥æœ‰æ­¤é…ç½®ï¼Œä»¥ä¾¿ action èƒ½å¤Ÿè¿è¡Œï¼ˆä¾‹å¦‚ï¼Œå®ƒä¸ä¼šåœ¨åˆæ¬¡æ·»åŠ  action çš„ PR ä¸­è¿è¡Œï¼‰ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ åœ¨ PR ä¸­æ›´æ”¹é…ç½®ï¼Œå½“å‰
    PR ä¸­çš„æ›´æ”¹å°†ä¸ä¼šè¢«åæ˜  â€”â€” åªæœ‰åœ¨æ›´æ”¹è¢«åˆå¹¶åˆ°ä¸»åˆ†æ”¯åï¼Œéšåçš„ PR æ‰ä¼šåæ˜ è¿™äº›æ›´æ”¹ã€‚
- en: So we must have this workflow in our default branch `main` first, only then
    we can see it in action.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬å¿…é¡»é¦–å…ˆåœ¨é»˜è®¤åˆ†æ”¯ `main` ä¸­æ‹¥æœ‰è¿™ä¸ªå·¥ä½œæµï¼Œåªæœ‰è¿™æ ·æˆ‘ä»¬æ‰èƒ½çœ‹åˆ°å®ƒçš„å®é™…æ•ˆæœã€‚
- en: Branch protection rules
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åˆ†æ”¯ä¿æŠ¤è§„åˆ™
- en: 'Next, in the *Settings* section of the GitHub repository we can create a **branch
    protection rule** for the *main* branch:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œåœ¨ GitHub ä»“åº“çš„ *è®¾ç½®* éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º *main* åˆ†æ”¯åˆ›å»ºä¸€ä¸ª **åˆ†æ”¯ä¿æŠ¤è§„åˆ™**ï¼š
- en: '![](../Images/e0aa5515ece7b094d0198da1bbe2a40d.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e0aa5515ece7b094d0198da1bbe2a40d.png)'
- en: Branch Protection Rule for the main branch â€” Image by author
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸»è¦åˆ†æ”¯çš„åˆ†æ”¯ä¿æŠ¤è§„åˆ™ â€” ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Now a commit requires a PR with passing status checks (required workflow) before
    merging*.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä¸€ä¸ªæäº¤éœ€è¦ä¸€ä¸ªé€šè¿‡çŠ¶æ€æ£€æŸ¥ï¼ˆå¿…éœ€å·¥ä½œæµï¼‰çš„ PR æ‰èƒ½åˆå¹¶*ã€‚
- en: A [required workflow](https://docs.github.com/en/actions/using-workflows/required-workflows)
    is triggered by pull request events and appears as a required status check, which
    blocks the ability to merge the pull request until the required workflow succeeds.
  id: totrans-217
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª [å¿…éœ€çš„å·¥ä½œæµ](https://docs.github.com/en/actions/using-workflows/required-workflows)
    ç”±æ‹‰å–è¯·æ±‚äº‹ä»¶è§¦å‘ï¼Œå¹¶ä½œä¸ºå¿…éœ€çš„çŠ¶æ€æ£€æŸ¥å‡ºç°ï¼Œè¿™ä¼šé˜»æ­¢åˆå¹¶æ‹‰å–è¯·æ±‚ï¼Œç›´åˆ°å¿…éœ€çš„å·¥ä½œæµæˆåŠŸã€‚
- en: '![](../Images/5ca948e901b844e9bae4e91b52018506.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5ca948e901b844e9bae4e91b52018506.png)'
- en: Required workflows â€” Image by author
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€éœ€å·¥ä½œæµ â€” ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Organization owners have the ability to enforce specific workflows within their
    organisation, such as requiring a status check on pull requests. Unfortunately,
    this feature is only available for organisations and cannot be activated for individual
    accounts, therefore it is not possible to block merging.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: ç»„ç»‡æ‰€æœ‰è€…æœ‰èƒ½åŠ›åœ¨å…¶ç»„ç»‡å†…å¼ºåˆ¶æ‰§è¡Œç‰¹å®šçš„å·¥ä½œæµï¼Œä¾‹å¦‚è¦æ±‚å¯¹æ‹‰å–è¯·æ±‚è¿›è¡ŒçŠ¶æ€æ£€æŸ¥ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªåŠŸèƒ½ä»…å¯¹ç»„ç»‡å¯ç”¨ï¼Œä¸ªäººè´¦æˆ·æ— æ³•æ¿€æ´»ï¼Œå› æ­¤æ— æ³•é˜»æ­¢åˆå¹¶ã€‚
- en: '**Please note that the rules wonâ€™t be enforced on a private repository until
    it is* [*moved to a GitHub Team or Enterprise organization account*](https://github.com/move_work/new)*!*'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: '**è¯·æ³¨æ„ï¼Œè§„åˆ™ä¸ä¼šåœ¨ç§æœ‰ä»“åº“ä¸­ç”Ÿæ•ˆï¼Œç›´åˆ°å®ƒè¢«* [*è¿ç§»åˆ° GitHub Team æˆ– Enterprise ç»„ç»‡è´¦æˆ·*](https://github.com/move_work/new)*ï¼*'
- en: Squash & merge strategy
  id: totrans-222
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Squash & merge ç­–ç•¥
- en: 'Finally, we can configure the PR options to use the PRâ€™s title as the default
    commit message when we select the squash and merge button:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é…ç½® PR é€‰é¡¹ï¼Œä»¥ä¾¿åœ¨é€‰æ‹© squash and merge æŒ‰é’®æ—¶ä½¿ç”¨ PR çš„æ ‡é¢˜ä½œä¸ºé»˜è®¤æäº¤æ¶ˆæ¯ï¼š
- en: '![](../Images/3017b59691e8c5f4d4327784972535c0.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3017b59691e8c5f4d4327784972535c0.png)'
- en: Default commit message when squash and merge â€” Image by author
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: é»˜è®¤çš„æäº¤æ¶ˆæ¯åœ¨â€œå‹ç¼©å’Œåˆå¹¶â€æ—¶ â€” å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: 'This way, we see a window like this:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ ·ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„çª—å£ï¼š
- en: '![](../Images/fe2a3f501d7814b92691932795f1f9a9.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fe2a3f501d7814b92691932795f1f9a9.png)'
- en: Sqash & merge dialog in a PR â€” Image by author
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ PR ä¸­çš„â€œå‹ç¼©å’Œåˆå¹¶â€å¯¹è¯æ¡† â€” å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: '*Be aware that a developer might alter the titleâ€™s name during the merge, which
    would bypass the strategy!*'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '*è¯·æ³¨æ„ï¼Œå¼€å‘è€…å¯èƒ½ä¼šåœ¨åˆå¹¶è¿‡ç¨‹ä¸­æ›´æ”¹æ ‡é¢˜åç§°ï¼Œè¿™å°†ç»•è¿‡ç­–ç•¥ï¼*'
- en: Even though we canâ€™t completely ensure conventional commits on GitHub yet, we
    should try to get as close as we can.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: å°½ç®¡æˆ‘ä»¬è¿˜ä¸èƒ½å®Œå…¨ç¡®ä¿åœ¨ GitHub ä¸Šä½¿ç”¨ä¼ ç»Ÿçš„æäº¤æ–¹å¼ï¼Œä½†æˆ‘ä»¬åº”å°½é‡åšåˆ°å°½å¯èƒ½æ¥è¿‘ã€‚

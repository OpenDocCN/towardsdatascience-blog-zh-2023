- en: Simple way to Deploy ML Models as Flask APIs on Amazon ECS
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åœ¨ Amazon ECS ä¸Šå°†æœºå™¨å­¦ä¹ æ¨¡å‹ä½œä¸º Flask API éƒ¨ç½²çš„ç®€å•æ–¹æ³•
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/simple-way-to-deploy-ml-models-as-flask-apis-on-amazon-ecs-7be11f9dc4d9](https://towardsdatascience.com/simple-way-to-deploy-ml-models-as-flask-apis-on-amazon-ecs-7be11f9dc4d9)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/simple-way-to-deploy-ml-models-as-flask-apis-on-amazon-ecs-7be11f9dc4d9](https://towardsdatascience.com/simple-way-to-deploy-ml-models-as-flask-apis-on-amazon-ecs-7be11f9dc4d9)
- en: Deploy Flask APIs on Amazon ECS in 4 minutes
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åœ¨ 4 åˆ†é’Ÿå†…å°† Flask API éƒ¨ç½²åˆ° Amazon ECS
- en: '[](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)[![Nikola
    Kuzmic](../Images/b6be2a8e377bc450ced5260a79a1f4bb.png)](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)[](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)
    [Nikola Kuzmic](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)[![Nikola
    Kuzmic](../Images/b6be2a8e377bc450ced5260a79a1f4bb.png)](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)[](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)
    [Nikola Kuzmic](https://medium.com/@nikola.kuzmic945?source=post_page-----7be11f9dc4d9--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)
    Â·6 min readÂ·Mar 10, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----7be11f9dc4d9--------------------------------)
    Â·6 åˆ†é’Ÿé˜…è¯»Â·2023å¹´3æœˆ10æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/e65f1c65818c31933d75bdf5d19ede50.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e65f1c65818c31933d75bdf5d19ede50.png)'
- en: Photo by [Arjan van den Berg](https://unsplash.com/@arjan71?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”± [Arjan van den Berg](https://unsplash.com/@arjan71?utm_source=medium&utm_medium=referral)
    æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: In this post weâ€™ll cover how to deploy a linear regression XGBoost model which
    predicts a developerâ€™s salary based on their years of experience.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•éƒ¨ç½²ä¸€ä¸ªçº¿æ€§å›å½’ XGBoost æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æ ¹æ®å¼€å‘è€…çš„å·¥ä½œç»éªŒå¹´é™æ¥é¢„æµ‹ä»–ä»¬çš„è–ªèµ„ã€‚
- en: ğŸ‘‰ Game Plan
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ğŸ‘‰ æ¸¸æˆè®¡åˆ’
- en: Train an XGBoost model
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è®­ç»ƒä¸€ä¸ª XGBoost æ¨¡å‹
- en: Build a simple Flask API to serve model predictions
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ„å»ºä¸€ä¸ªç®€å•çš„ Flask API æ¥æä¾›æ¨¡å‹é¢„æµ‹
- en: Build a Docker Image for the Flask API
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸º Flask API æ„å»º Docker é•œåƒ
- en: Deploy the Docker Container on Amazon ECS
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨ Amazon ECS ä¸Šéƒ¨ç½² Docker å®¹å™¨
- en: 'Entire Source Code Github Repo: [link](https://github.com/kuzmicni/flask-on-ecs/tree/simple)ğŸ§‘â€ğŸ’»'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæ•´æºä»£ç  GitHub ä»“åº“ï¼š[link](https://github.com/kuzmicni/flask-on-ecs/tree/simple)ğŸ§‘â€ğŸ’»
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Why we need APIs to deploy ML models
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ API æ¥éƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹
- en: If you are reading this post, likely you have reached the stage in your Data
    Science project where you want to make your awesome ML models available for everyone
    on the internet. People refer to this step as deploying them to production.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ­£åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œè¯´æ˜ä½ å·²ç»åˆ°äº†æ•°æ®ç§‘å­¦é¡¹ç›®çš„é˜¶æ®µï¼Œå¸Œæœ›å°†ä½ å‡ºè‰²çš„æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨äº’è”ç½‘ä¸Šæä¾›ç»™æ‰€æœ‰äººã€‚äººä»¬ç§°è¿™ä¸€æ­¥éª¤ä¸ºå°†æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚
- en: Here we wonâ€™t make things too complex and examine what a proper production-grade
    deployment should look like, rather weâ€™re simply going to leverage the default
    Flask development server to demonstrate the process end-to-end what it takes to
    take the trained/pickled XGBoost ML model, dockerize it, and deploy it as a real-time
    API on Amazon ECS.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ä¼šä½¿äº‹æƒ…å˜å¾—è¿‡äºå¤æ‚ï¼Œä¹Ÿä¸ä¼šè¯¦ç»†å®¡æŸ¥ç”Ÿäº§çº§éƒ¨ç½²çš„æ ·å­ï¼Œè€Œæ˜¯ç®€å•åœ°åˆ©ç”¨é»˜è®¤çš„ Flask å¼€å‘æœåŠ¡å™¨æ¼”ç¤ºä»è®­ç»ƒ/ä¿å­˜çš„ XGBoost æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œåˆ°
    Docker åŒ–ï¼Œå†åˆ°å°†å…¶ä½œä¸ºå®æ—¶ API éƒ¨ç½²åˆ° Amazon ECS çš„å…¨è¿‡ç¨‹ã€‚
- en: 'ğŸ‘‰ Step 1: Train an XGBoost model'
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ğŸ‘‰ æ­¥éª¤ 1ï¼šè®­ç»ƒä¸€ä¸ª XGBoost æ¨¡å‹
- en: Train an XGBoost model to predict the developer salary based on their years
    of experience and save the model as a pickle file.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒä¸€ä¸ª XGBoost æ¨¡å‹ä»¥é¢„æµ‹å¼€å‘è€…çš„è–ªèµ„ï¼ŒåŸºäºä»–ä»¬çš„å·¥ä½œç»éªŒå¹´é™ï¼Œå¹¶å°†æ¨¡å‹ä¿å­˜ä¸º pickle æ–‡ä»¶ã€‚
- en: 'To run it inside VS Code, letâ€™s create a separate Python 3.8 environment:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†åœ¨ VS Code å†…è¿è¡Œï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ Python 3.8 ç¯å¢ƒï¼š
- en: '[PRE1]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Then Restart VS Code and in Jupyter Notebook -> Select â€˜**py38demo**â€™ as the
    Kernel.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åé‡å¯ VS Codeï¼Œå¹¶åœ¨ Jupyter Notebook ä¸­ -> é€‰æ‹©â€˜**py38demo**â€™ä½œä¸ºå†…æ ¸ã€‚
- en: 'Train & pickle the XGBoost model:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå¹¶ pickle XGBoost æ¨¡å‹ï¼š
- en: '![](../Images/2723cb7fac45c5d3298592071ff9c2e7.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2723cb7fac45c5d3298592071ff9c2e7.png)'
- en: Time to create an API which can serve these recommendations!
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä»¥æä¾›è¿™äº›æ¨èçš„ API çš„æ—¶å€™äº†ï¼
- en: 'ğŸ‘‰ Step 2: Flask API'
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ğŸ‘‰ æ­¥éª¤ 2ï¼šFlask API
- en: Our API will load the XGBoost model, accept POST requests, and produce a response.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„ API å°†åŠ è½½ XGBoost æ¨¡å‹ï¼Œæ¥å— POST è¯·æ±‚ï¼Œå¹¶ç”Ÿæˆå“åº”ã€‚
- en: 'Letâ€™s first run our API locally. Then in a separate terminal we can test it
    by sending a payload POST request to see what a developer with 2.5 years of experience
    would make:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆè®©æˆ‘ä»¬åœ¨æœ¬åœ°è¿è¡Œ APIã€‚ç„¶ååœ¨ä¸€ä¸ªå•ç‹¬çš„ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘é€è´Ÿè½½ POST è¯·æ±‚æ¥æµ‹è¯•ï¼Œä»¥æŸ¥çœ‹ä¸€ä¸ªæ‹¥æœ‰ 2.5 å¹´ç»éªŒçš„å¼€å‘è€…ä¼šåšä»€ä¹ˆï¼š
- en: '[PRE2]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/25839f9865edaa4a0c8f48fc538e5b5e.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/25839f9865edaa4a0c8f48fc538e5b5e.png)'
- en: $260k after 2.5 years, and $750k after 12.5 years. Not bad! ğŸ¤‘
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 2.5 å¹´å $260kï¼Œ12.5 å¹´å $750kã€‚ä¸é”™ï¼ğŸ¤‘
- en: 'ğŸ‘‰ Step 3: Docker Image'
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ğŸ‘‰ æ­¥éª¤ 3ï¼šDocker é•œåƒ
- en: To run our application inside the Docker Container, we need a â€œblueprintâ€ with
    instructions on what environment to use, which local files to copy, and how to
    run the application. All of this is referred to as a Docker Image and by convention
    it is specified in a **Dockerfile**
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: è¦åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œè“å›¾â€ï¼Œè¯¥è“å›¾åŒ…å«æœ‰å…³ä½¿ç”¨ä»€ä¹ˆç¯å¢ƒã€è¦å¤åˆ¶å“ªäº›æœ¬åœ°æ–‡ä»¶ä»¥åŠå¦‚ä½•è¿è¡Œåº”ç”¨ç¨‹åºçš„æŒ‡ä»¤ã€‚æ‰€æœ‰è¿™äº›éƒ½è¢«ç§°ä¸º
    Docker é•œåƒï¼Œé€šå¸¸åœ¨ **Dockerfile** ä¸­æŒ‡å®šã€‚
- en: We can now run our API inside the Docker container and test locally as well.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œæˆ‘ä»¬çš„ API å¹¶è¿›è¡Œæœ¬åœ°æµ‹è¯•ã€‚
- en: 'Note: since I am building the image on a Mac, I need to specify'
  id: totrans-36
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼šç”±äºæˆ‘åœ¨ Mac ä¸Šæ„å»ºé•œåƒï¼Œæˆ‘éœ€è¦æŒ‡å®š
- en: ''
  id: totrans-37
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '- - platform linux/amd64'
  id: totrans-38
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '- - platform linux/amd64'
- en: ''
  id: totrans-39
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: for it to be compatible with the ECS Fargate Linux environment.
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½¿å…¶ä¸ ECS Fargate Linux ç¯å¢ƒå…¼å®¹ã€‚
- en: Hereâ€™s how we build & run the image.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ä»¬å¦‚ä½•æ„å»ºå’Œè¿è¡Œé•œåƒçš„æ­¥éª¤ã€‚
- en: 'Note: we bind our host (i.e. laptopâ€™s) port 80 to docker containerâ€™s port 80:'
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼šæˆ‘ä»¬å°†ä¸»æœºï¼ˆå³ç¬”è®°æœ¬ç”µè„‘ï¼‰çš„ç«¯å£ 80 ç»‘å®šåˆ° Docker å®¹å™¨çš„ç«¯å£ 80ï¼š
- en: '[PRE3]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Letâ€™s test our API which is now running inside the Docker Container! ğŸ“¦
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ç°åœ¨åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œçš„ APIï¼ğŸ“¦
- en: '[PRE4]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/713eeda0fea59338e8683225bd070861.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/713eeda0fea59338e8683225bd070861.png)'
- en: Time to deploy this on AWS! ğŸš€
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¯æ—¶å€™åœ¨ AWS ä¸Šéƒ¨ç½²äº†ï¼ğŸš€
- en: 'ğŸ‘‰ Step 4: Run the container on Amazon ECS'
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ğŸ‘‰ æ­¥éª¤ 4ï¼šåœ¨ Amazon ECS ä¸Šè¿è¡Œå®¹å™¨
- en: This section may look overwhelming at first, but actually itâ€™s quite simple
    if we break the process into 6 simple steps.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªéƒ¨åˆ†å¯èƒ½ä¸€å¼€å§‹çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†å®é™…ä¸Šå¦‚æœæˆ‘ä»¬å°†è¿‡ç¨‹åˆ†è§£æˆ 6 ä¸ªç®€å•æ­¥éª¤ï¼Œå°±ä¼šå˜å¾—å¾ˆç®€å•ã€‚
- en: '![](../Images/d1fd7ac870f7b51f76e2bb1fbde293c0.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d1fd7ac870f7b51f76e2bb1fbde293c0.png)'
- en: 'Chrome Logo: [1], Flask Logo: [2]'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Chrome å¾½æ ‡ï¼š[1]ï¼ŒFlask å¾½æ ‡ï¼š[2]
- en: '**i) Push the Docker image to ECR**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**i) å°† Docker é•œåƒæ¨é€åˆ° ECR**'
- en: Letâ€™s create an ECR repo called **demo** where we can push the Docker image.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º **demo** çš„ ECR ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥å°† Docker é•œåƒæ¨é€åˆ°å…¶ä¸­ã€‚
- en: '![](../Images/052bc48fc29df4f521e507c1ce4522c1.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/052bc48fc29df4f521e507c1ce4522c1.png)'
- en: 'Then we can use the Push Commands provided by ECR:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ECR æä¾›çš„æ¨é€å‘½ä»¤ï¼š
- en: '[PRE5]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Assumption: you have configured AWS CLI on your local machine and setup an
    IAM user with the right permission to interact with the ECR. You can find more
    info at this [link](https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html).'
  id: totrans-57
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å‡è®¾ï¼šæ‚¨å·²åœ¨æœ¬åœ°æœºå™¨ä¸Šé…ç½®äº† AWS CLIï¼Œå¹¶è®¾ç½®äº†å…·æœ‰ä¸ ECR äº¤äº’æ‰€éœ€æƒé™çš„ IAM ç”¨æˆ·ã€‚æ‚¨å¯ä»¥åœ¨æ­¤ [é“¾æ¥](https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html)
    ä¸­æ‰¾åˆ°æ›´å¤šä¿¡æ¯ã€‚
- en: After running the above 3 commands, we can see our image is there on ECR! ğŸ‰
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: è¿è¡Œä¸Šè¿° 3 ä¸ªå‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„é•œåƒå·²ç»åœ¨ ECR ä¸Šäº†ï¼ğŸ‰
- en: '![](../Images/ef09ad855af44d36c11bf523fc372e78.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ef09ad855af44d36c11bf523fc372e78.png)'
- en: '**Copy & Paste the Image URI** somewhere as weâ€™ll need it in the next couple
    of steps.'
  id: totrans-60
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**å¤åˆ¶å¹¶ç²˜è´´é•œåƒ URI** åˆ°æŸä¸ªåœ°æ–¹ï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæ­¥éª¤ä¸­éœ€è¦å®ƒã€‚'
- en: '**ii) Create an IAM Execution Role**'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '**ii) åˆ›å»º IAM æ‰§è¡Œè§’è‰²**'
- en: 'We need to create an Execution Role so that our ECS task which will run the
    container has the access to pull images from the ECR. Weâ€™ll name it: **simpleRole**'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ‰§è¡Œè§’è‰²ï¼Œä»¥ä¾¿è¿è¡Œå®¹å™¨çš„ ECS ä»»åŠ¡å¯ä»¥è®¿é—®ä» ECR æ‹‰å–é•œåƒã€‚æˆ‘ä»¬å°†å…¶å‘½åä¸ºï¼š**simpleRole**
- en: '![](../Images/baa3344183dc1d1c70b2124b4fd2f84e.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/baa3344183dc1d1c70b2124b4fd2f84e.png)'
- en: '**iii) Create a Security Group**'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '**iii) åˆ›å»ºå®‰å…¨ç»„**'
- en: 'Security Group is needed to allow anyone on the internet to send requests to
    our application. In the real world you may want to constrain this to a specific
    set of IPs but here weâ€™ll open it for everyone and call it:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: éœ€è¦å®‰å…¨ç»„ä»¥å…è®¸äº’è”ç½‘ä¸Šçš„ä»»ä½•äººå‘æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå‘é€è¯·æ±‚ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†å…¶é™åˆ¶ä¸ºç‰¹å®šçš„ IP é›†åˆï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬å°†å…¶å¯¹æ‰€æœ‰äººå¼€æ”¾ï¼Œå¹¶å‘½åä¸ºï¼š
- en: '**simpleSG**'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**simpleSG**'
- en: '![](../Images/b03a4f6fdaa10334799b8dd0fc1e057b.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b03a4f6fdaa10334799b8dd0fc1e057b.png)'
- en: '**iv) Create an ECS Cluster**'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**iv) åˆ›å»º ECS é›†ç¾¤**'
- en: 'This step is straightforward and only takes couple seconds. Weâ€™ll call it:
    **flaskCluster**'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ­¥éª¤å¾ˆç®€å•ï¼Œåªéœ€å‡ ç§’é’Ÿã€‚æˆ‘ä»¬å°†å…¶å‘½åä¸ºï¼š**flaskCluster**
- en: '![](../Images/7e86f7cfaede8933a5bacb1fb73dbbc1.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7e86f7cfaede8933a5bacb1fb73dbbc1.png)'
- en: while our cluster is being provisioned, letâ€™s create a Task Definition.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä»¬çš„é›†ç¾¤è¢«é…ç½®æ—¶ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä»»åŠ¡å®šä¹‰ã€‚
- en: '**v) Create a Task Definition**'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**v) åˆ›å»ºä»»åŠ¡å®šä¹‰**'
- en: 'Task Definition, as the name implies is a set of instructions related to which
    image to run, port to open, and how much virtual CPU and memory we want to allocate.
    Weâ€™ll call it: **demoTask**'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: ä»»åŠ¡å®šä¹‰ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸€ç»„ä¸è¿è¡Œå“ªä¸ªé•œåƒã€å¼€æ”¾å“ªä¸ªç«¯å£ä»¥åŠåˆ†é…å¤šå°‘è™šæ‹Ÿ CPU å’Œå†…å­˜ç›¸å…³çš„æŒ‡ä»¤ã€‚æˆ‘ä»¬å°†å…¶ç§°ä¸ºï¼š**demoTask**
- en: '![](../Images/713bffc8c5e6f1cd4fdd219169bb96af.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/713bffc8c5e6f1cd4fdd219169bb96af.png)'
- en: '**vi) Run the Task**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**vi) è¿è¡Œä»»åŠ¡**'
- en: Letâ€™s run our **demoTask** on our **flaskCluster,** with the **simpleSG** we
    created in ***step iii)***.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„**flaskCluster**ä¸Šè¿è¡Œ**demoTask**ï¼Œä½¿ç”¨æˆ‘ä»¬åœ¨***æ­¥éª¤ iii)*** ä¸­åˆ›å»ºçš„**simpleSG**ã€‚
- en: '![](../Images/f46cd2d6ea10f104037ae766e2a28ad7.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f46cd2d6ea10f104037ae766e2a28ad7.png)'
- en: Time to test out the deployed API from the **Public IP** address! ğŸ¥
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å¯ä»¥é€šè¿‡**å…¬å…± IP**åœ°å€æµ‹è¯•å·²éƒ¨ç½²çš„ API äº†ï¼ ğŸ¥
- en: '[PRE6]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/e6b6a8e4fe5ebf0fa9d349352a483afc.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e6b6a8e4fe5ebf0fa9d349352a483afc.png)'
- en: Itâ€™s working! ğŸ¥³
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: å®ƒæ­£åœ¨è¿è¡Œï¼ ğŸ¥³
- en: As you can see we are able to get the salary predictions by sending POST requests
    to the **Public IP** provided by ECS. ğŸ”¥
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘ ECS æä¾›çš„**å…¬å…± IP**å‘é€ POST è¯·æ±‚æ¥è·å–è–ªèµ„é¢„æµ‹ã€‚ ğŸ”¥
- en: Final Words
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æœ€å
- en: This was just a simple demonstration of how we can dockerize our XGBoost models
    and deploy them on Amazon ECS for real-time inference. However, we used the default
    development server provided by Flask and instead should use a production-grade
    application server like Gunicorn which weâ€™ll cover in the next post.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•å°† XGBoost æ¨¡å‹ Docker åŒ–å¹¶åœ¨ Amazon ECS ä¸Šè¿›è¡Œå®æ—¶æ¨ç†ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Flask
    æä¾›çš„é»˜è®¤å¼€å‘æœåŠ¡å™¨ï¼Œå®é™…ä¸Šåº”è¯¥ä½¿ç”¨åƒ Gunicorn è¿™æ ·çš„ç”Ÿäº§çº§åº”ç”¨æœåŠ¡å™¨ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬ä¼šä»‹ç»å®ƒã€‚
- en: Thanks for reading and I hope you found this useful for getting started with
    Flask, Docker and Amazon ECS!
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: æ„Ÿè°¢é˜…è¯»ï¼Œå¸Œæœ›ä½ è§‰å¾—è¿™äº›å†…å®¹å¯¹å¼€å§‹ä½¿ç”¨ Flaskã€Docker å’Œ Amazon ECS æœ‰å¸®åŠ©ï¼
- en: Want more useful articles on ML Engineering?
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æƒ³è¦æ›´å¤šå…³äº ML å·¥ç¨‹çš„æœ‰ç”¨æ–‡ç« ï¼Ÿ
- en: '[*Subscribe for free*](https://medium.com/@nikola.kuzmic945/subscribe) *to
    get notified when I publish a new story.*'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '[*å…è´¹è®¢é˜…*](https://medium.com/@nikola.kuzmic945/subscribe) *ä»¥ä¾¿åœ¨æˆ‘å‘å¸ƒæ–°æ•…äº‹æ—¶æ”¶åˆ°é€šçŸ¥ã€‚*'
- en: '*Become a Medium member to read more stories from me and thousands of other
    writers. You can support me by using my* [*referral link*](https://medium.com/@nikola.kuzmic945/membership)
    *when you sign up. Iâ€™ll receive a commission at no extra cost to you.*'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '*æˆä¸º Medium ä¼šå‘˜ï¼Œé˜…è¯»æ›´å¤šæ¥è‡ªæˆ‘å’Œå…¶ä»–æ•°åƒåä½œè€…çš„æ•…äº‹ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨æˆ‘çš„* [*æ¨èé“¾æ¥*](https://medium.com/@nikola.kuzmic945/membership)
    *æ¥æ”¯æŒæˆ‘ã€‚å½“ä½ æ³¨å†Œæ—¶ï¼Œæˆ‘å°†è·å¾—ä½£é‡‘ï¼Œè€Œä½ æ— éœ€é¢å¤–æ”¯ä»˜è´¹ç”¨ã€‚*'
- en: '**References**'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**å‚è€ƒèµ„æ–™**'
- en: '[1] Chrome Logo: [Link](https://logos-world.net/chrome-logo/)'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '[1] Chrome æ ‡å¿—ï¼š[é“¾æ¥](https://logos-world.net/chrome-logo/)'
- en: '[2] Flask Logo: [Link](https://flask.palletsprojects.com/en/2.2.x/)'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '[2] Flask æ ‡å¿—ï¼š[é“¾æ¥](https://flask.palletsprojects.com/en/2.2.x/)'

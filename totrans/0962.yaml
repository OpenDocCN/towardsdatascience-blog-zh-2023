- en: Generative AI on Research Papers Using Nougat Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/generative-ai-on-research-papers-using-nougat-model-38aa37a354f6](https://towardsdatascience.com/generative-ai-on-research-papers-using-nougat-model-38aa37a354f6)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Doing cool things with Data!
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://priya-dwivedi.medium.com/?source=post_page-----38aa37a354f6--------------------------------)[![Priya
    Dwivedi](../Images/73087cb699750466312cc4752e2044d4.png)](https://priya-dwivedi.medium.com/?source=post_page-----38aa37a354f6--------------------------------)[](https://towardsdatascience.com/?source=post_page-----38aa37a354f6--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----38aa37a354f6--------------------------------)
    [Priya Dwivedi](https://priya-dwivedi.medium.com/?source=post_page-----38aa37a354f6--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----38aa37a354f6--------------------------------)
    ·9 min read·Sep 20, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/286ebca3250788f30b4f28ba9521ee43.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Dan Dimmock](https://unsplash.com/@dandimmock?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/3mt71MKGjQ0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Recent advances in large language models (LLMs) like GPT-4 have shown impressive
    capabilities in generating coherent text. However, parsing and understanding research
    papers accurately remains an extremely challenging task for AI. Research papers
    contain complex formatting, math equations, tables, figures, and domain-specific
    language. The density of information is very high and important semantics are
    encoded in the formatting.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, I will demonstrate how a new model called [Nougat](https://facebookresearch.github.io/nougat/)
    from Meta can help parse research papers accurately. We then combine it with an
    LLM pipeline that extracts and summarizes all the tables in the paper.
  prefs: []
  type: TYPE_NORMAL
- en: The potential here is immense. There is a lot of data/information locked up
    in research papers and books that have not been parsed correctly. Accurate parsing
    enables their use in many different applications including LLM retraining.
  prefs: []
  type: TYPE_NORMAL
- en: I made a Youtube video explaining the code and my experiments in more detail.
    Check it out [here](https://youtu.be/rYxaijVlc-A).
  prefs: []
  type: TYPE_NORMAL
- en: Nougat Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nougat is a visual transformer model developed by researchers at Meta AI that
    can convert images of document pages into structured text [1]. It takes a rasterized
    image of a document page as input and outputs text in a lightweight markup language.
  prefs: []
  type: TYPE_NORMAL
- en: The key advantage of Nougat is that it relies solely on the document image and
    does not need any OCR text. This allows it to recover semantic structure like
    math equations properly. It is trained on millions of academic papers from arXiv
    and PubMed to learn the patterns of research paper formatting and language.
  prefs: []
  type: TYPE_NORMAL
- en: The figure below from [1] shows how math equations written in PDF are reproduced
    in Latex and rendered correctly.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b798654ff35b41252906bef0aa8850f6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: Fig5 from Nougat Paper — [https://arxiv.org/pdf/2308.13418.pdf](https://arxiv.org/pdf/2308.13418.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: Nougat uses a visual transformer encoder-decoder architecture. The encoder uses
    a Swin Transformer to encode the document image into latent embeddings. The Swin
    Transformer processes the image in a hierarchical fashion using shifted windows.
    The decoder then generates the output text tokens autoregressively using self-attention
    over the encoder outputs.
  prefs: []
  type: TYPE_NORMAL
- en: Nougat is trained end-to-end on page image and text pairs using stochastic gradient
    descent. Data augmentation like erosions, dilations, and elastic transforms are
    used to improve robustness. A special anti-repetition regularization is also used
    during training to reduce text repetitions.
  prefs: []
  type: TYPE_NORMAL
- en: The authors report metrics like edit distance, BLEU, METEOR, and F1-score on
    a test set of academic papers. Nougat achieves high accuracy, especially for plain
    text. The errors are mostly in math expressions because of ambiguity in LaTeX
    commands. As shown below, Nougat outperforms prior approaches like GROBID and
    PDF OCR by a significant margin.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c352652b5748afe1deb43e6d6d0fab22.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Source: Table 1 Nougat Paper — [https://arxiv.org/pdf/2308.13418.pdf](https://arxiv.org/pdf/2308.13418.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: Running and Evaluating the output from the Nougat Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The installation instructions and the steps to run the Nougat Model are shared
    in the Colab Notebook [here](https://colab.research.google.com/drive/1oC7jK8UMEYRDAEPevn5VQweadjN4WyeW?usp=sharing).
  prefs: []
  type: TYPE_NORMAL
- en: The Nougat small model runs easily on a free Colab T4 GPU and has very impressive
    results.
  prefs: []
  type: TYPE_NORMAL
- en: The main steps to running the model are installing the package `nougat-ocr.`
    And then we use the subprocess to run a command line CLI to pass the downloaded
    PDF to Nougat and get its outputs.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: In my Colab Notebook, I ran Nougat on the [DOLA paper](https://arxiv.org/pdf/2309.03883.pdf).
    Nougat impressively captures the math equations in Latex.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: I also found tables were captured well in Latex. Table 1 is converted accurately
    to Latex below!
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Generative LLM to summarize Latex Tables
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are many examples of LLMs summarizing text including research papers.
    But almost always, the data in tables and math equations is neither parsed correctly
    nor included in the summary. I now test, how well models like GPT3.5 do on Latex
    tables.
  prefs: []
  type: TYPE_NORMAL
- en: 'I have used Langchain to write a chain pipeline here that does the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Identifies all tables in the research paper
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Reads the Latex and understands the table
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creates an output dictionary summarizing each table
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The full source code is included in the Colab Notebook [here](https://colab.research.google.com/drive/1oC7jK8UMEYRDAEPevn5VQweadjN4WyeW?usp=sharing).
    As shown in the code snippet below, our prompt to LLM is to identify all tables,
    summarize them, and share the results in a structured format.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: I wasn’t very sure how the LLM would do, so I have to say I was stunned by the
    quality of the response. There are 6 tables in the paper and all of them were
    identified correctly. Then each was summarized well.
  prefs: []
  type: TYPE_NORMAL
- en: The response from LLM to the above prompt is below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Reading through these examples, my observations were:'
  prefs: []
  type: TYPE_NORMAL
- en: Each table was identified. The model accurately understands the rows and columns
    of the table
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The summary captures the conclusion from the table
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The summary suggests the model used information from the paper to understand
    the table. For Table 3, the model accurately understood that the table compares
    DOLA with random layer selection vs. premature layer selection, even though the
    table itself doesn’t mention it
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I would have loved to see more numbers and stats in the summary of the table
    but the model did not output them. As a side note, I also tested Claude2 from
    Anthropic.AI and it was able to summarize the table with a mention of the key
    statistical conclusions, presenting a superior response
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: My code also covers an example of the above pipeline now searching for all math
    equations and explaining them. Impressive first results, there too.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this article, I demonstrated how the Nougat model can parse complex research
    papers directly from images. Nougat overcomes a key challenge — understanding
    the semantics encoded in the formatting of papers.
  prefs: []
  type: TYPE_NORMAL
- en: I showed an end-to-end pipeline to parse a paper with Nougat, extract tables,
    and summarize them using LLMs. Nougat extracted the text, math, tables, and formatting
    with high accuracy. The downstream LLM successfully summarized an extracted table,
    focusing on key comparisons.
  prefs: []
  type: TYPE_NORMAL
- en: Nougat helps overcome the limitations of PDF text and current best solutions
    like pyPDF and GROBID. We can now understand the information in papers much better.
    Overall this demonstrates how generative AI models are making strides in unlocking
    all the knowledge trapped in unstructured formats.
  prefs: []
  type: TYPE_NORMAL
- en: I run my own Machine learning consulting, helping clients with Generative AI
    applications. Email me at priya@deeplearninganalytics.org if you are interested
    in collaborating together.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[1] Blecher, Lukas, et al. “Nougat: Neural Optical Understanding for Academic
    Documents.” arXiv preprint arXiv:2308.13418 (2023).'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Langchain Source Documentation — [https://python.langchain.com/docs/get_started/introduction](https://python.langchain.com/docs/get_started/introduction)'
  prefs: []
  type: TYPE_NORMAL

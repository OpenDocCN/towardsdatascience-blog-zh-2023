- en: Unlocking the Power of Interaction Terms in Linear Regression
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/unlocking-the-power-of-interaction-terms-in-linear-regression-ba30c2cf158f](https://towardsdatascience.com/unlocking-the-power-of-interaction-terms-in-linear-regression-ba30c2cf158f)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/1c7aefbf227b4b508956c79868b67f00.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Denys Nevozhai](https://unsplash.com/@dnevozhai?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/7nrsVjvALnA?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: Learn how to make your linear models more flexible by including interaction
    terms
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://eryk-lewinson.medium.com/?source=post_page-----ba30c2cf158f--------------------------------)[![Eryk
    Lewinson](../Images/56e09e19c0bbfecc582da58761d15078.png)](https://eryk-lewinson.medium.com/?source=post_page-----ba30c2cf158f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----ba30c2cf158f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----ba30c2cf158f--------------------------------)
    [Eryk Lewinson](https://eryk-lewinson.medium.com/?source=post_page-----ba30c2cf158f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----ba30c2cf158f--------------------------------)
    ·10 min read·May 18, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: Linear regression is a powerful statistical tool used to model the relationship
    between a dependent variable and one or more independent variables (features).
    An important, and often forgotten, concept in regression analysis is that of *interaction
    terms*. In short, interaction terms enable us to examine whether the relationship
    between the target and the independent variable changes depending on the value
    of another independent variable.
  prefs: []
  type: TYPE_NORMAL
- en: Interaction terms are a crucial component of regression analysis, and understanding
    how they work can help practitioners better train models and interpret their data.
    Despite their importance, interaction terms can be difficult to understand.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, we will provide an intuitive explanation of interaction terms
    in the context of linear regression.
  prefs: []
  type: TYPE_NORMAL
- en: What are interaction terms in regression models?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First, let’s consider the simpler case, that is, a linear model without interaction
    terms. Such a model assumes that the effect of each feature or predictor on the
    dependent variable (target) is independent of other predictors in the model.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following equation describes such a model specification with two features:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5523e19afd7da0c30211a1fc8cda9a0c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In order to make the explanation easier to understand, let’s use an example.
    Imagine we are interested in modeling the price of real estate properties (*y*)
    using two features: their size (*X1*) and a boolean flag indicating whether the
    apartment is located in the city center (*X2*). *β0* is the intercept, *β1* and
    *β2* are coefficients of the linear model and *ε* is the error term (unexplained
    by the model).'
  prefs: []
  type: TYPE_NORMAL
- en: 'After gathering data and estimating a linear regression model, we obtain the
    following coefficients:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/00279ac3895deb806fcbf7305edab20f.png)'
  prefs: []
  type: TYPE_IMG
- en: Knowing the estimated coefficients and that *X2* is a boolean feature, we can
    write out the two possible scenarios depending on the value of *X2*.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d31cb6fd7dda24d8d6f9b3d6d7ed17de.png)'
  prefs: []
  type: TYPE_IMG
- en: How to interpret those? While this might not make a lot of sense in the context
    of real estate, we can say that a 0 square meter apartment in the city center
    costs 310 (the value of the intercept) and each square meter of additional space
    increases the price by 20\. In the other case, the only difference is that the
    intercept is smaller by 10 units. The following plot illustrates the two best
    fit lines.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7c316c8389bdbb6b88ac71db64287395.png)'
  prefs: []
  type: TYPE_IMG
- en: '*Regression lines for properties in the city center and outside of it*'
  prefs: []
  type: TYPE_NORMAL
- en: As we can see, the lines are parallel and they have the same slope — the coefficient
    by *X1*, which is the same in both scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: Interaction terms represent joint effects
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At this point you might argue that an additional square meter in an apartment
    in the city center costs more than an additional square meter in an apartment
    on the outskirts. In other words, there might be a joint effect of these two features
    on the price of real estate.
  prefs: []
  type: TYPE_NORMAL
- en: So we believe that not only the intercept should be different between the two
    scenarios, but also the slope of the lines. How to do that? That is exactly when
    the interaction terms come into play. They make the model’s specification more
    flexible and allow us to account for such patterns.
  prefs: []
  type: TYPE_NORMAL
- en: 'An interaction term is effectively a multiplication of the two features that
    we believe have a joint effect on the target. The following equation presents
    the model’s new specification:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1a67f7da9d8ddc841bb9f8df2b0797dc.png)'
  prefs: []
  type: TYPE_IMG
- en: Again, let’s assume we have estimated our model and we know the coefficients.
    For simplicity, we have kept the same values as in the previous example. Bear
    in mind that in a real-life scenario, they would most likely differ.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/151995befee910494d321bb07f618b09.png)'
  prefs: []
  type: TYPE_IMG
- en: Once we write out the two scenarios for *X2* (city center or not), we can immediately
    see that the slope (coefficient by *X1*) of the two lines is different. As we
    hypothesized, an additional square meter of space in the city center is now more
    expensive than in the suburbs.
  prefs: []
  type: TYPE_NORMAL
- en: Interpreting the coefficients with interaction terms
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Adding interaction terms to a model changes the interpretation of all the coefficients.
    Without an interaction term, we interpret the coefficients as the unique effect
    of a predictor on the dependent variable.
  prefs: []
  type: TYPE_NORMAL
- en: So in our case, we could say that *β1* was the unique effect of the size of
    an apartment on its price. However, with an interaction term the effect of the
    apartment’s size is different for different values of *X2*. In other words, the
    unique effect of apartment size on its price is no longer limited to *β1*.
  prefs: []
  type: TYPE_NORMAL
- en: To better understand what each coefficient represents, let’s have one more look
    at the raw specification of a linear model with interaction terms. Just as a reminder,
    *X2* is a boolean feature indicating whether a particular apartment is in the
    city center or not.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1a67f7da9d8ddc841bb9f8df2b0797dc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we can interpret each of the coefficients in the following way:'
  prefs: []
  type: TYPE_NORMAL
- en: '*β0* — the intercept for the apartments outside of the city center (or whichever
    group that had a 0 value for the boolean feature *X2*),'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*β1* — the slope (effect of price) for apartments outside of the city center,'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*β2* — the difference in the intercept between the two groups,'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*β3* — the difference in slopes between apartments in the city center and outside
    of it.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For example, let’s assume that we are testing a hypothesis that there is an
    equal impact of the size of an apartment on its price, regardless of whether the
    apartment is in the city center or not. Then, we would estimate the linear regression
    with the interaction term and check whether *β3* is significantly different from
    0.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some additional notes on the interaction terms:'
  prefs: []
  type: TYPE_NORMAL
- en: We have presented two-way interaction terms, however, higher-order interactions
    (for example, of 3 features) are also possible.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In our example, we showed an interaction of a numerical feature (size of the
    apartment) with a boolean one (is the apartment in the city center or not). However,
    we can create interaction terms of two numerical features as well. For example,
    we might create an interaction term of the size of the apartment with the number
    of rooms. Please refer to the sources mentioned in the *References* section for
    more details on that topic.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It might be the case that the interaction term is statistically significant,
    but the main effects are not. Then we should follow the hierarchical principle
    stating that if we include an interaction term in the model, we should also include
    the main effects, even if their impacts are not statistically significant.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hands-on example in Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After all the theoretical introduction, let’s see how to add interaction terms
    to a linear regression model in Python. As always, we start by importing the required
    libraries.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'In our example, we will estimate linear models using the `statsmodels` library.
    For the dataset, we will use the `mtcars` dataset. I am quite sure that if you
    have ever worked with R, you will be already familiar with this dataset. First,
    we load the dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Executing the snippet prints a comprehensive description of the dataset. We
    only show the relevant parts — an overall description and the definition of the
    columns:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, we extract the actual dataset from the loaded object:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/b7763b4d528cca8aeb1996d2173044f4.png)'
  prefs: []
  type: TYPE_IMG
- en: '*A preview of the* mtcars *dataset*'
  prefs: []
  type: TYPE_NORMAL
- en: 'For our example, let’s assume that we want to investigate the relationship
    between the miles per gallon (`mpg`) and two features: weight (`wt`, continuous)
    and type of transmission (`am`, boolean).'
  prefs: []
  type: TYPE_NORMAL
- en: First, we plot the data to get some initial insights.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/21f61d8ab7a4404ca7381c38c3ce97d3.png)'
  prefs: []
  type: TYPE_IMG
- en: '*Scatterplot of miles per gallon vs. vehicle weight, color per transmission
    type*'
  prefs: []
  type: TYPE_NORMAL
- en: Just by eyeballing the plot, we can see that the regression lines for the two
    categories of the `am` variable will be quite different. For comparison’s sake,
    we start off with a model without interaction terms.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The following tables show the results of fitting a linear regression without
    the interaction term.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6dc4600976fc4150faae62f94f69cc72.png)'
  prefs: []
  type: TYPE_IMG
- en: From the summary table, we can see that the coefficient by the `am` feature
    is not statistically significant. Using the interpretation of the coefficients
    we have already learned, we can plot the best fit lines for both classes of the
    `am` feature.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/c3267feda03c8fe73dc4fa83f6e52118.png)'
  prefs: []
  type: TYPE_IMG
- en: '*Best-fit lines for both types of transmission*'
  prefs: []
  type: TYPE_NORMAL
- en: As the coefficient by the `am` feature is basically zero, the lines are almost
    overlapping.
  prefs: []
  type: TYPE_NORMAL
- en: Then, we follow up with a second model, this time with an interaction term between
    the two features. Below we show how to add an interaction term as an additional
    input in the `statsmodels` formula.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: The following summary tables show the results of fitting a linear regression
    with the interaction term.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bab6157275282ffa84c6a15747b689bc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Two conclusions we can quickly draw from the summary table:'
  prefs: []
  type: TYPE_NORMAL
- en: all of the coefficients, including the interaction term, are statistically significant.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: by inspecting the R2 (and its adjusted variant, as we have a different number
    of features in the models), we can state that the model with the interaction term
    results in a better fit.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Similarly to the previous case, let’s plot the best fit lines.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/16143246520d734ff75f00d43b9d7d33.png)'
  prefs: []
  type: TYPE_IMG
- en: '*Best fit lines for both types of transmission, including interaction terms*'
  prefs: []
  type: TYPE_NORMAL
- en: We can immediately see the difference in the fitted lines (both in terms of
    the intercept and the slope) for cars with automatic and manual transmissions.
  prefs: []
  type: TYPE_NORMAL
- en: '*Bonus:* We can also add interaction terms using `scikit-learn`’s `PolynomialFeatures`.
    The transformer offers not only the possibility to add interaction terms of arbitrary
    order, but it also creates polynomial features (for example, squared values of
    the available features). For more information, please refer to the [documentation](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html).'
  prefs: []
  type: TYPE_NORMAL
- en: Wrapping up
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When working with interaction terms in linear regression, there are a few things
    to remember:'
  prefs: []
  type: TYPE_NORMAL
- en: Interaction terms allow us to examine whether the relationship between the target
    and a feature changes depending on the value of another feature.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We add interaction terms as a multiplication of the original features. By adding
    these new variables to the regression model, we can measure the effects of the
    interaction between them and the target. It is crucial to interpret the coefficients
    of the interaction terms carefully in order to understand the direction and the
    strength of the relationship.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By using interaction terms we can make the specification of a linear model more
    flexible (different slopes for different lines), which can result in a better
    fit to the data and better predictive performance.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can find the code used in this post in my [GitHub repo](https://github.com/erykml/medium_articles/blob/master/Statistics/interaction_terms_in_linear_regression.ipynb).
    As always, any constructive feedback is more than welcome. You can reach out to
    me on [Twitter](https://twitter.com/erykml1) or in the comments.
  prefs: []
  type: TYPE_NORMAL
- en: '*Liked the article? Become a Medium member to continue learning by reading
    without limits. If you use* [*this link*](https://eryk-lewinson.medium.com/membership)
    *to become a member, you will support me at no extra cost to you. Thanks in advance
    and see you around!*'
  prefs: []
  type: TYPE_NORMAL
- en: 'You might also be interested in one of the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/a-comprehensive-overview-of-regression-evaluation-metrics-6264af0926db?source=post_page-----ba30c2cf158f--------------------------------)
    [## A Comprehensive Overview of Regression Evaluation Metrics'
  prefs: []
  type: TYPE_NORMAL
- en: An extensive reference into commonly used regression evaluation metrics and
    their practical applications across various…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/a-comprehensive-overview-of-regression-evaluation-metrics-6264af0926db?source=post_page-----ba30c2cf158f--------------------------------)
    [](/interpreting-the-coefficients-of-linear-regression-cc31d4c6f235?source=post_page-----ba30c2cf158f--------------------------------)
    [## Interpreting the coefficients of linear regression
  prefs: []
  type: TYPE_NORMAL
- en: Learn how to correctly interpret the results of linear regression — including
    cases with transformations of variables
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/interpreting-the-coefficients-of-linear-regression-cc31d4c6f235?source=post_page-----ba30c2cf158f--------------------------------)
    [](/one-thing-you-might-not-have-known-about-linear-regression-634446de7559?source=post_page-----ba30c2cf158f--------------------------------)
    [## One thing you might not have known about linear regression
  prefs: []
  type: TYPE_NORMAL
- en: How to train a single model with multiple outputs
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/one-thing-you-might-not-have-known-about-linear-regression-634446de7559?source=post_page-----ba30c2cf158f--------------------------------)
    [](/the-minimalists-guide-to-experiment-tracking-with-dvc-f07e4636bdbb?source=post_page-----ba30c2cf158f--------------------------------)
    [## The Minimalist’s Guide to Experiment Tracking with DVC
  prefs: []
  type: TYPE_NORMAL
- en: The bare minimum guide to get you started with experiment tracking
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/the-minimalists-guide-to-experiment-tracking-with-dvc-f07e4636bdbb?source=post_page-----ba30c2cf158f--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[https://rinterested.github.io/statistics/lm_interactions_output_interpretation.html](https://rinterested.github.io/statistics/lm_interactions_output_interpretation.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://janhove.github.io/analysis/2017/06/26/continuous-interactions](https://janhove.github.io/analysis/2017/06/26/continuous-interactions)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://ademos.people.uic.edu/Chapter13.html](https://ademos.people.uic.edu/Chapter13.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://joelcarlson.github.io/2016/05/10/Exploring-Interactions/](https://joelcarlson.github.io/2016/05/10/Exploring-Interactions/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Henderson and Velleman (1981), Building multiple regression models interactively.
    *Biometrics*, **37**, 391–411.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the `mtcars` dataset in R is part of the base R distribution and is released
    under the GNU General Public License (GPL)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All images, unless noted otherwise, are by the author.
  prefs: []
  type: TYPE_NORMAL
- en: '*Originally published at* [*NVIDIA’s developer blog*](https://developer.nvidia.com/blog/a-comprehensive-guide-to-interaction-terms-in-linear-regression/)
    *on April 26th, 2023*'
  prefs: []
  type: TYPE_NORMAL

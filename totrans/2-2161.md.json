["```py\n# install.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\n```", "```py\ndat <- penguins # rename dataset\nstr(dat) # structure of dataset\n```", "```py\n## tibble [344 × 8] (S3: tbl_df/tbl/data.frame)\n##  $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n##  $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n##  $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n##  $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n##  $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...\n##  $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n##  $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 NA 1 2 1 2 NA NA ...\n##  $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n```", "```py\nsummary(dat)\n```", "```py\n##       species          island    bill_length_mm  bill_depth_mm  \n##  Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  \n##  Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  \n##  Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  \n##                                  Mean   :43.92   Mean   :17.15  \n##                                  3rd Qu.:48.50   3rd Qu.:18.70  \n##                                  Max.   :59.60   Max.   :21.50  \n##                                  NA's   :2       NA's   :2      \n##  flipper_length_mm  body_mass_g       sex           year     \n##  Min.   :172.0     Min.   :2700   female:165   Min.   :2007  \n##  1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  \n##  Median :197.0     Median :4050   NA's  : 11   Median :2008  \n##  Mean   :200.9     Mean   :4202                Mean   :2008  \n##  3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  \n##  Max.   :231.0     Max.   :6300                Max.   :2009  \n##  NA's   :2         NA's   :2\n```", "```py\ntable(dat$species, dat$sex)\n```", "```py\n##            \n##             female male\n##   Adelie        73   73\n##   Chinstrap     34   34\n##   Gentoo        58   61\n```", "```py\n# save model\nmod <- aov(body_mass_g ~ sex * species,\n  data = dat\n)\n```", "```py\n# method 1\nplot(mod, which = 2)\n```", "```py\n# method 2\nlibrary(car)\n```", "```py\nqqPlot(mod$residuals,\n  id = FALSE # remove point identification\n)\n```", "```py\n# histogram\nhist(mod$residuals)\n```", "```py\n# normality test\nshapiro.test(mod$residuals)\n```", "```py\n## \n## \tShapiro-Wilk normality test\n## \n## data:  mod$residuals\n## W = 0.99776, p-value = 0.9367\n```", "```py\nplot(mod, which = 3)\n```", "```py\nleveneTest(mod)\n```", "```py\n## Levene's Test for Homogeneity of Variance (center = median)\n##        Df F value Pr(>F)\n## group   5  1.3908 0.2272\n##       327\n```", "```py\nlibrary(ggplot2)\n```", "```py\n# boxplots by sex\nggplot(dat) +\n  aes(x = sex, y = body_mass_g) +\n  geom_boxplot()\n```", "```py\n# boxplots by species\nggplot(dat) +\n  aes(x = species, y = body_mass_g) +\n  geom_boxplot()\n```", "```py\n# mean by group\naggregate(body_mass_g ~ species + sex,\n  data = dat,\n  FUN = mean\n)\n```", "```py\n##     species    sex body_mass_g\n## 1    Adelie female    3368.836\n## 2 Chinstrap female    3527.206\n## 3    Gentoo female    4679.741\n## 4    Adelie   male    4043.493\n## 5 Chinstrap   male    3938.971\n## 6    Gentoo   male    5484.836\n```", "```py\n# mean and sd by group\nlibrary(dplyr)\n```", "```py\ngroup_by(dat, sex, species) %>%\n  summarise(\n    mean = round(mean(body_mass_g, na.rm = TRUE)),\n    sd = round(sd(body_mass_g, na.rm = TRUE))\n  )\n```", "```py\n## # A tibble: 8 × 4\n## # Groups:   sex [3]\n##   sex    species    mean    sd\n##   <fct>  <fct>     <dbl> <dbl>\n## 1 female Adelie     3369   269\n## 2 female Chinstrap  3527   285\n## 3 female Gentoo     4680   282\n## 4 male   Adelie     4043   347\n## 5 male   Chinstrap  3939   362\n## 6 male   Gentoo     5485   313\n## 7 <NA>   Adelie     3540   477\n## 8 <NA>   Gentoo     4588   338\n```", "```py\n# boxplot by group\nlibrary(ggplot2)\n```", "```py\nggplot(dat) +\n  aes(x = species, y = body_mass_g, fill = sex) +\n  geom_boxplot()\n```", "```py\ndat %>%\n  filter(!is.na(sex)) %>%\n  ggplot() +\n  aes(x = species, y = body_mass_g, fill = sex) +\n  geom_boxplot()\n```", "```py\ndat %>%\n  filter(!is.na(sex)) %>%\n  ggplot() +\n  aes(x = sex, y = body_mass_g, fill = species) +\n  geom_boxplot()\n```", "```py\n# Two-way ANOVA with interaction\n# save model\nmod <- aov(body_mass_g ~ sex * species,\n  data = dat\n)\n```", "```py\n# print results\nsummary(mod)\n```", "```py\n##              Df    Sum Sq  Mean Sq F value   Pr(>F)    \n## sex           1  38878897 38878897 406.145  < 2e-16 ***\n## species       2 143401584 71700792 749.016  < 2e-16 ***\n## sex:species   2   1676557   838278   8.757 0.000197 ***\n## Residuals   327  31302628    95727                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## 11 observations deleted due to missingness\n```", "```py\n# Two-way ANOVA without interaction\naov(body_mass_g ~ sex + species,\n  data = dat\n)\n```", "```py\n# method 2\nmod2 <- lm(body_mass_g ~ sex * species,\n  data = dat\n)\n```", "```py\nAnova(mod2)\n```", "```py\n## Anova Table (Type II tests)\n## \n## Response: body_mass_g\n##                Sum Sq  Df F value    Pr(>F)    \n## sex          37090262   1 387.460 < 2.2e-16 ***\n## species     143401584   2 749.016 < 2.2e-16 ***\n## sex:species   1676557   2   8.757 0.0001973 ***\n## Residuals    31302628 327                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```", "```py\n# method 1\nTukeyHSD(mod,\n  which = \"species\"\n)\n```", "```py\n##   Tukey multiple comparisons of means\n##     95% family-wise confidence level\n## \n## Fit: aov(formula = body_mass_g ~ sex * species, data = dat)\n## \n## $species\n##                        diff       lwr       upr     p adj\n## Chinstrap-Adelie   26.92385  -80.0258  133.8735 0.8241288\n## Gentoo-Adelie    1377.65816 1287.6926 1467.6237 0.0000000\n## Gentoo-Chinstrap 1350.73431 1239.9964 1461.4722 0.0000000\n```", "```py\n# method 2\nlibrary(multcomp)\n```", "```py\nsummary(glht(\n  aov(body_mass_g ~ sex + species,\n    data = dat\n  ),\n  linfct = mcp(species = \"Tukey\")\n))\n```", "```py\n## \n## \t Simultaneous Tests for General Linear Hypotheses\n## \n## Multiple Comparisons of Means: Tukey Contrasts\n## \n## \n## Fit: aov(formula = body_mass_g ~ sex + species, data = dat)\n## \n## Linear Hypotheses:\n##                         Estimate Std. Error t value Pr(>|t|)    \n## Chinstrap - Adelie == 0    26.92      46.48   0.579     0.83    \n## Gentoo - Adelie == 0     1377.86      39.10  35.236   <1e-05 ***\n## Gentoo - Chinstrap == 0  1350.93      48.13  28.067   <1e-05 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## (Adjusted p values reported -- single-step method)\n```", "```py\n# method 3\npairwise.t.test(dat$body_mass_g, dat$species,\n  p.adjust.method = \"BH\"\n)\n```", "```py\n## \n## \tPairwise comparisons using t tests with pooled SD \n## \n## data:  dat$body_mass_g and dat$species \n## \n##           Adelie Chinstrap\n## Chinstrap 0.63   -        \n## Gentoo    <2e-16 <2e-16   \n## \n## P value adjustment method: BH\n```", "```py\n# all combinations of sex and species\nTukeyHSD(mod,\n  which = \"sex:species\"\n)\n```", "```py\n##   Tukey multiple comparisons of means\n##     95% family-wise confidence level\n## \n## Fit: aov(formula = body_mass_g ~ sex * species, data = dat)\n## \n## $`sex:species`\n##                                      diff       lwr       upr     p adj\n## male:Adelie-female:Adelie        674.6575  527.8486  821.4664 0.0000000\n## female:Chinstrap-female:Adelie   158.3703  -25.7874  342.5279 0.1376213\n## male:Chinstrap-female:Adelie     570.1350  385.9773  754.2926 0.0000000\n## female:Gentoo-female:Adelie     1310.9058 1154.8934 1466.9181 0.0000000\n## male:Gentoo-female:Adelie       2116.0004 1962.1408 2269.8601 0.0000000\n## female:Chinstrap-male:Adelie    -516.2873 -700.4449 -332.1296 0.0000000\n## male:Chinstrap-male:Adelie      -104.5226 -288.6802   79.6351 0.5812048\n## female:Gentoo-male:Adelie        636.2482  480.2359  792.2606 0.0000000\n## male:Gentoo-male:Adelie         1441.3429 1287.4832 1595.2026 0.0000000\n## male:Chinstrap-female:Chinstrap  411.7647  196.6479  626.8815 0.0000012\n## female:Gentoo-female:Chinstrap  1152.5355  960.9603 1344.1107 0.0000000\n## male:Gentoo-female:Chinstrap    1957.6302 1767.8040 2147.4564 0.0000000\n## female:Gentoo-male:Chinstrap     740.7708  549.1956  932.3460 0.0000000\n## male:Gentoo-male:Chinstrap      1545.8655 1356.0392 1735.6917 0.0000000\n## male:Gentoo-female:Gentoo        805.0947  642.4300  967.7594 0.0000000\n```", "```py\nlibrary(agricolae)\n```", "```py\nHSD.test(mod,\n  trt = c(\"sex\", \"species\"),\n  console = TRUE # print results\n)\n```", "```py\n## \n## Study: mod ~ c(\"sex\", \"species\")\n## \n## HSD Test for body_mass_g \n## \n## Mean Square Error:  95726.69 \n## \n## sex:species,  means\n## \n##                  body_mass_g      std  r  Min  Max\n## female:Adelie       3368.836 269.3801 73 2850 3900\n## female:Chinstrap    3527.206 285.3339 34 2700 4150\n## female:Gentoo       4679.741 281.5783 58 3950 5200\n## male:Adelie         4043.493 346.8116 73 3325 4775\n## male:Chinstrap      3938.971 362.1376 34 3250 4800\n## male:Gentoo         5484.836 313.1586 61 4750 6300\n## \n## Alpha: 0.05 ; DF Error: 327 \n## Critical Value of Studentized Range: 4.054126 \n## \n## Groups according to probability of means differences and alpha level( 0.05 )\n## \n## Treatments with the same letter are not significantly different.\n## \n##                  body_mass_g groups\n## male:Gentoo         5484.836      a\n## female:Gentoo       4679.741      b\n## male:Adelie         4043.493      c\n## male:Chinstrap      3938.971      c\n## female:Chinstrap    3527.206      d\n## female:Adelie       3368.836      d\n```", "```py\n# set axis margins so labels do not get cut off\npar(mar = c(4.1, 13.5, 4.1, 2.1))\n```", "```py\n# create confidence interval for each comparison\nplot(TukeyHSD(mod, which = \"sex:species\"),\n  las = 2 # rotate x-axis ticks\n)\n```", "```py\n# method 1\nlibrary(effects)\n```", "```py\nplot(allEffects(mod))\n```", "```py\n# method 2\nlibrary(ggpubr)\n```", "```py\nggline(subset(dat, !is.na(sex)), # remove NA level for sex\n  x = \"species\",\n  y = \"body_mass_g\",\n  color = \"sex\",\n  add = c(\"mean_se\") # add mean and standard error\n) +\n  labs(y = \"Mean of body mass (g)\")\n```", "```py\nlibrary(Rmisc)\n```", "```py\n# compute mean and standard error of the mean by subgroup\nsummary_stat <- summarySE(dat,\n  measurevar = \"body_mass_g\",\n  groupvars = c(\"species\", \"sex\")\n)# plot mean and standard error of the mean\nggplot(\n  subset(summary_stat, !is.na(sex)), # remove NA level for sex\n  aes(x = species, y = body_mass_g, colour = sex)\n) +\n  geom_errorbar(aes(ymin = body_mass_g - se, ymax = body_mass_g + se), # add error bars\n    width = 0.1 # width of error bars\n  ) +\n  geom_point() +\n  labs(y = \"Mean of body mass (g)\")\n```", "```py\nwith(\n  dat,\n  interaction.plot(species, sex, body_mass_g)\n)\n```", "```py\n# plot mean and standard error of the mean as barplots\nggplot(\n  subset(summary_stat, !is.na(sex)), # remove NA level for sex\n  aes(x = species, y = body_mass_g, fill = sex)\n) +\n  geom_bar(position = position_dodge(), stat = \"identity\") +\n  geom_errorbar(aes(ymin = body_mass_g - se, ymax = body_mass_g + se), # add error bars\n    width = 0.25, # width of error bars\n    position = position_dodge(.9)\n  ) +\n  labs(y = \"Mean of body mass (g)\")\n```"]
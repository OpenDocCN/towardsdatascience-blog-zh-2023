# 《机器学习插图：分类的评估指标》

> 原文：[https://towardsdatascience.com/machine-learning-illustrated-classification-evaluation-metrics-dfc33b373c43](https://towardsdatascience.com/machine-learning-illustrated-classification-evaluation-metrics-dfc33b373c43)

## 一个全面（且丰富多彩）的指南，介绍你需要了解的关于评估分类模型的一切

[](https://medium.com/@shreya.rao?source=post_page-----dfc33b373c43--------------------------------)[![Shreya Rao](../Images/03f13be6f5f67783d32f0798f09a4f86.png)](https://medium.com/@shreya.rao?source=post_page-----dfc33b373c43--------------------------------)[](https://towardsdatascience.com/?source=post_page-----dfc33b373c43--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----dfc33b373c43--------------------------------) [Shreya Rao](https://medium.com/@shreya.rao?source=post_page-----dfc33b373c43--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----dfc33b373c43--------------------------------) ·12 分钟阅读·2023年4月20日

--

我在学习过程中意识到自己是一个非常视觉化的学习者，我喜欢使用颜色和有趣的插图来学习新概念，特别是那些通常像这样解释的科学概念：

![](../Images/3e5178e7df4a16c4cbf60390074b5bcc.png)

从我之前的文章中，通过大量可爱的评论和消息（感谢所有的支持！），我发现有很多人对这种情感产生了共鸣。因此，我决定开始一个新的系列，我将尝试用插图来讲解机器学习和计算机科学的概念，希望能使学习变得有趣。所以，请系好安全带，享受这段旅程吧！

让我们通过探索机器学习中的一个基本问题来开始这个系列：**我们如何评估分类模型的性能**？

在之前的文章中，如 [决策树分类](https://medium.com/towards-artificial-intelligence/decision-tree-classification-explain-it-to-me-like-im-10-59a53c0b338f) 和 [逻辑回归](https://medium.com/towards-data-science/back-to-basics-part-tres-logistic-regression-e309de76bd66)，我们讨论了如何构建分类模型。然而，量化这些模型的表现至关重要，这就提出了一个问题：我们应该使用什么指标来做到这一点？

为了说明这个概念，让我们构建一个**贷款还款分类模型**。

我们的目标是预测一个人是否可能还清贷款，基于他们的信用评分。虽然年龄、薪水、贷款金额、贷款类型、职业和信用历史等其他变量也可能影响这样的分类器，但为了简便起见，我们只考虑信用评分作为我们模型的主要决定因素。

根据[逻辑回归](https://medium.com/towards-data-science/back-to-basics-part-tres-logistic-regression-e309de76bd66)文章中列出的步骤，我们构建了一个分类器，该分类器根据信用评分预测某人是否会还款。

![](../Images/ed28a0b38f1d241ca277fa3865d2fe78.png)

从中我们可以看到，信用评分越低，越可能该人不会还款，反之亦然。

目前，该模型的输出是一个人会还款的**概率**。然而，如果我们想将贷款分类为*会还款*或*不会还款*，我们需要找到将这些概率转换为分类的方法。

一种方法是设定0.5作为阈值，将低于该阈值的人分类为*不会还款*，高于该阈值的人分类为*会还款*。

![](../Images/de1572c26b231957cede19ce6b788bd6.png)

从中我们推断出，这个模型会将信用评分低于600的人分类为*不会还款*（粉色），高于600的人分类为*会还款*（蓝色）。

![](../Images/4770ed8570d10571800ae847f908c6ec.png)

使用0.5作为分界线，我们将一个信用评分为420的人分类为…

![](../Images/a023359f3f9f5f9fa5ea3e03f75a051e.png)

…*不会还款*。而这个信用评分为700的人则为…

![](../Images/23bef7ee38242f4273bac32a04ea6e78.png)

*…会还款*。

现在为了***测试***我们的模型效果，我们需要远远超过2个人的数据。因此，让我们深入挖掘过去的记录，收集10000人的信用评分以及他们是否还款的信息。

![](../Images/b444ea724520e5dce6bd7935395de26c.png)

> 注意：在我们的记录中，有9500人还款，只有500人未还款。

然后我们对每个人运行我们的分类器，根据他们的信用评分预测他们是否会还款。

## 混淆矩阵

为了更好地可视化我们的预测与实际情况的比较，我们创建了一个称为混淆矩阵的东西。

![](../Images/30d416e9cdbfd292afc254f1dc8f0b5e.png)

在这个特定的混淆矩阵中，我们将还款的个体视为**正例**标签，将未还款的个体视为**负例**标签。

+   **真阳性（TP）**：实际还款的人，并且被模型***正确地***分类为*会还款*

+   **假阴性（FP）**：实际还款的人，但被模型***错误地***分类为*不会还款*

+   **真阴性（TN）**：实际上未还款的人，并且被模型***正确地***分类为*不会还款*

+   **假阳性（FP）**：实际上未还款的人，但被模型***错误地***分类为*会还款*

现在假设，我们将10000人的信息输入到我们的模型中。我们得到的混淆矩阵如下：

![](../Images/29dbb8156c5439564198fafbe34a931d.png)

从中我们可以推导出——

+   在9500名还款的人中——9000人被正确分类（TP），500人被错误分类（FN）

+   在500名没有还款的人中——200人（TN）被正确分类，300人（FP）被错误分类。

## 准确率

直观上，我们首先要问自己的是：**我们的模型有多准确？**

![](../Images/8e39c5c68699c535163b20623cad996a.png)

在我们的案例中，准确率是：

![](../Images/cd8bbf988c24d216c6a1876089306896.png)

92%的准确率确实令人印象深刻，但需要注意的是，准确率通常是评估模型性能的一个简化指标。

如果我们更仔细地查看混淆矩阵，我们可以看到，虽然许多还款的个体被正确分类，但在500名未还款的个体中，只有200人被模型正确标记，其余300人被错误分类。

那么，让我们深入探讨一些其他常用的指标，以评估我们模型的表现。

## 精准度

我们可以问的另一个问题是：**被预测为*会还款*的个体中，实际还款的百分比是多少**？

![](../Images/d8d9475cccf3d6943afe61447496a4a7.png)

计算精准度时，我们可以将真正例数除以预测为正例的总数（即，分类为*会还款*的个体）。

![](../Images/dcbe14cb2928f07efca5126e4c634a0b.png)

因此，当我们的分类器预测一个人*会还款*时，我们的分类器在96.8%的情况下是正确的。

## 敏感性（也叫召回率）

接下来，我们可以问自己：**我们模型正确识别的实际还款个体的百分比是多少**？

![](../Images/46172305710ec90061414dc22ef100c0.png)

计算敏感性时，我们可以取真正例数，并将其除以实际还款的总人数。

![](../Images/5cbafb4937027fdcbb82636f48629e9c.png)

分类器正确标记了94.7%实际还款的人，而其余的则错误标记为*不会还款*。

*注意：精准度和敏感性公式中的术语有时可能会令人困惑。一个简单的记忆法是记住两个公式都使用TP（真正例），但分母不同。精准度的分母是（TP + FP），而敏感性的分母是（TP + FN）。*

*为了记住这个区别，可以将FP中的“P”与精准度中的“P”联系起来：*

![](../Images/937833611ff903d0ed8507cb3dbbee95.png)

*这就剩下FN，我们在敏感性的分母中找到它：*

![](../Images/727de77c429d136b800f3d8a3947201e.png)

## F1 Score

另一个结合了敏感性和精准度的有用指标是F1分数，它计算了精准度和敏感性的调和平均值。

![](../Images/f7fa1e663f7d6e69639c6ad9f1599b8c.png)

在我们的案例中，F1分数是：

![](../Images/b558556c3e09dec686dae4d75984eee0.png)

> 通常，F1分数提供了对模型性能更全面的评估。因此，F1分数通常比准确率在实际中更有用。

## **特异性**

另一个需要考虑的关键问题是特异性，它提出了这样一个问题：**未偿还贷款的个体中有多少百分比被正确识别为*不会偿还***？

![](../Images/989870a85d98621c22579406acd29712.png)

要计算特异性，我们将真正负例除以未偿还贷款的个体总数。

![](../Images/f53ce590c057ee023d5ff559967015eb.png)

我们可以看到，我们的分类器仅正确识别了40%的未偿还贷款的个体。

特异性与其他评估指标之间的明显差异强调了选择适当指标评估模型性能的重要性。考虑所有评估指标并进行适当解释是至关重要的，因为每个指标可能提供对模型有效性的不同视角。

> 注意：我经常发现结合各种指标或根据问题制定自己的指标是有帮助的

在我们的场景中，准确识别不会偿还贷款的个体更为关键，因为向这些个体提供贷款可能会带来相较于拒绝那些会偿还的个体更高的成本。因此，我们需要考虑改善性能的方法。

实现这一点的一种方法是**调整分类的阈值**。

虽然这样做可能看起来违反直觉，但对我们来说，重要的是正确识别那些不会偿还贷款的个体。因此，错误标记实际上会偿还贷款的人对我们来说并不是那么重要。

通过调整阈值，我们可以让模型对负类（不会偿还的人）更敏感，代价是对正类（会偿还的人）的敏感度下降。这可能会增加假阴性（将偿还的人分类为*不会偿还*），但可能减少假阳性（未能正确识别未偿还的人）。

直到现在，我们使用了0.5的阈值，但让我们尝试调整一下，看看我们的模型是否能表现得更好。

让我们从将阈值设置为0开始。

![](../Images/3bf59be592368a83977f96ebfd7c6f8e.png)

这意味着每个人都会被分类为*将偿还*（由蓝色表示）*：*

![](../Images/9c81e3645f5594a12a64e392bbfd86f9.png)

这将导致以下混淆矩阵：

![](../Images/47e9201e1431b029ed4185f8c46e7446.png)

每个人都被分类为*将偿还*

…准确率为：

![](../Images/8d76d4486b3f46136473dfcea4e88559.png)

…敏感性和精确度：

![](../Images/1f7742b1c6283bcedd027e882af15ba3.png)

…以及特异性：

![](../Images/c5ed1376b43a05d55d504b7687a1e08d.png)

当阈值=0时，我们的分类器无法正确分类任何没有偿还贷款的个人，即使准确性和敏感度看起来可能令人印象深刻，它也是无效的。

让我们尝试0.1的阈值：

![](../Images/e814234954301ddec65e1058ed7e90db.png)

因此，任何信用分数低于420的人将被分类为*不会偿还*。这将导致如下的混淆矩阵和指标：

![](../Images/7f69d13f7e99fdfd41c5ad290fbd3c11.png)![](../Images/2b098f950c0c25bcd237cf09216cb153.png)

我们再次看到，除了特异性外，所有指标都非常出色。

接下来，让我们去到另一个极端，将阈值设置为0.9：

![](../Images/3a9c8890155630285fd6bf61e99b8209.png)

因此，任何信用分数低于760的个人都将被标记为*不会偿还*。这将导致如下的混淆矩阵和指标：

![](../Images/187f1986a07b8059a5720978f27cdda1.png)![](../Images/9ac5dc8d336443c991f2a54886a1946f.png)

在这里，我们看到指标几乎是翻转的。特异性和精准度很好，但准确性和敏感度很差。

你明白了。我们可以为更多的阈值（0.004, 0.3, 0.6, 0.875…）进行类似操作。但是这样会导致大量的混淆矩阵和指标，从而造成很多混淆。*这绝对是有意为之。*

![](../Images/529b0720b99251e39a534191dca2b7b2.png)

## ROC曲线

这就是接收者操作特征（ROC）曲线的作用，用以消除这种混淆。

**ROC曲线总结并允许我们可视化分类器在所有可能阈值下的表现**。

曲线的y轴是**真正例率**，即敏感度。x轴是**假正例率**，即1-特异性。

![](../Images/27204dad4436b333d3ab4920d01cbf29.png)

> *假阳性率告诉我们那些没有偿还却被错误分类为* 将要偿还 *(FP)的人的比例。*

所以当阈值=0时，从之前我们看到的混淆矩阵和指标是：

![](../Images/95296a4e3cef47809c77112a7067c46d.png)

我们知道`真正例率 = 敏感度 = 1` 和 `假正例率 = 1 — 特异性 = 1 — 0 = 1。`

现在让我们将这些信息绘制在ROC曲线上：

![](../Images/c3ef24c3bf5f88b4006d4a04eb521f84.png)

这条虚线蓝色线显示了真正例率=假正例率的位置：

![](../Images/9029ba017ea0c59ba5c2799a5dd70f9f.png)

这条线上的任何点都意味着正确分类为偿还的人的比例与错误分类为未偿还的人的比例相同。

关键在于我们希望我们的阈值点尽可能远离左侧的线，并且我们不希望有任何点低于这条线。

现在当阈值=0.1时：

![](../Images/9475dcbfad7e9a03cd8c0964d892e4f5.png)

在ROC曲线上绘制这个阈值：

![](../Images/68c6836511dad7f44d885ecf4e1c2ec1.png)

由于新点 (0.84, 0.989) 位于蓝色虚线的左侧，我们知道偿还的正确分类人群比例大于未偿还的错误分类人群比例。

换句话说，新阈值比蓝色虚线上的第一个阈值更好。

现在让我们将阈值提高到0.2。我们计算该阈值的真正例率和假阳性率，并绘制图表：

![](../Images/66675b3868dd0bd4ce8a2f59886c0c77.png)

新点 (0.75, 0.98) 更远离蓝色虚线，显示新阈值比之前的更好。

现在我们继续使用其他几个阈值（=0.35, 0.5, 0.65, 0.7, 0.8, 1）重复相同的过程，直到阈值=1。

![](../Images/14e9614576f107f4cf0643ccd8c0a930.png)

在阈值=1时，我们处于点 (0, 0)，其中真正例率 = 假负例率 = 0，因为分类器将所有点分类为*不会还款*。

现在无需排序所有混乱的矩阵和指标，我可以看到：

![](../Images/ccdfa1f8a6d1d4d55c30147dda3b38cc.png)

因为在紫色点处，当TPR = 0.8且FPR = 0，

![](../Images/8f5c80b0ae3d95bbdb0dd58a703d5ab0.png)

换句话说，这个阈值没有产生假阳性。而在蓝色点处，尽管80%还款的人被正确分类，但未还款的人的正确分类率只有80%（相比于之前阈值的100%）。

现在如果我们连接所有这些点……

![](../Images/e216586da142a83faccc432382930370.png)

…我们最终得到ROC曲线。

## AUC

现在假设我们想比较我们构建的两个不同的分类器。例如，第一个分类器是我们迄今为止看到的逻辑回归分类器，它产生了这个ROC曲线：

![](../Images/d12036c4f587bce57968c85b86473764.png)

我们决定建立另一个决策树分类器，结果得到了这个ROC曲线：

![](../Images/5924cf719379910fd65a10d887f99779.png)

比较两个分类器的一种方法是计算它们各自曲线下的面积或AUC。

![](../Images/931cb5587b60b3838124588494d03bb3.png)

由于逻辑回归曲线的AUC值更大，我们得出结论它是一个更好的分类器。

总结一下，我们讨论了评估分类模型的常用指标。然而，选择指标是主观的，取决于对问题和业务需求的理解。使用这些指标的组合或创建更适合特定模型需求的新指标也可能是有用的。

向StatQuest致以巨大的感谢，我最喜欢的统计学和机器学习资源。欢迎在[LinkedIn](https://www.linkedin.com/in/shreyarao24)上与我联系，或发邮件至*shreya.statistics@gmail.com*。

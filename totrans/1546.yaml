- en: Multinomial Logistic Regression in R
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/multinomial-logistic-regression-in-r-428d9bb7dc70](https://towardsdatascience.com/multinomial-logistic-regression-in-r-428d9bb7dc70)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Statistics in R Series
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://mdsohel-mahmood.medium.com/?source=post_page-----428d9bb7dc70--------------------------------)[![Md
    Sohel Mahmood](../Images/7819fed767baf023a725a47050c08f7b.png)](https://mdsohel-mahmood.medium.com/?source=post_page-----428d9bb7dc70--------------------------------)[](https://towardsdatascience.com/?source=post_page-----428d9bb7dc70--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----428d9bb7dc70--------------------------------)
    [Md Sohel Mahmood](https://mdsohel-mahmood.medium.com/?source=post_page-----428d9bb7dc70--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----428d9bb7dc70--------------------------------)
    ·6 min read·Jan 29, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4b92b97f4d508c05364527387fd1e0bd.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Edge2Edge Media](https://unsplash.com/@edge2edgemedia?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/photos/uKlneQRwaxY?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  prefs: []
  type: TYPE_NORMAL
- en: '**Introduction**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Well, if you have covered my previous articles about “Statistics in R Series”,
    you may have a good understanding of logistic regression implementation in R and
    also a fundamental understanding of the different types of logistic regression
    models. We have come a long way in the regression world and have covered binary,
    proportional odd (PO), generalized as well as partial proportional odd (PPO) models.
    In this article, I am going to discuss multinomial logistic regression which is
    application specific and may be vital in understanding logistic regression models
    having multiple unordered response variables. An example of the type of regression
    that could occur is the affiliation of people to political parties, for instance,
    republicans, democrats, independents, etc.
  prefs: []
  type: TYPE_NORMAL
- en: '**Brief refresher**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Let’s first do a recap on what we have covered so far. At first, we covered
    binary logistic regression, which doesn’t have ordered responses. Here, we have
    only two categories e.g. healthy or not healthy. Then we deep-dived into the ordinal
    logistic regression model having multiple ordered responses. Here, we made more
    ordered categories of health status and fed that into the ordinal model. One fundamental
    assumption of this model is the coefficient is independent of the categories and
    they don’t vary across the responses. For example, if we had four categories of
    health status and ordered as 1,2,3,4\. We assumed that the coefficients of each
    and every independent variable remain the same across all these four categories.
    This is called the proportional odd (PO) assumption.
  prefs: []
  type: TYPE_NORMAL
- en: Later we entered into the generalized logistic model and allowed all the coefficients
    to vary across the categories. For example, the coefficient of a specific independent
    variable will be different when we consider health status change from 1 to 2 from
    the coefficient value when we consider health status change from 2 to 3.
  prefs: []
  type: TYPE_NORMAL
- en: There is another type of model that was discussed previously which is the partial
    proportional odd (PPO) model. In this type of model, only those variables which
    violate the proportional odd assumption are allowed to vary across the categories.
    For example, if we have health status as the response variable and education years,
    marital status, and family income as predictors and if we find out that only education
    status violates the PO assumption, we can propose a PPO model for that instead
    of a generalized ordinal regression model. I know this may sound a little complicated
    but if you go through my previous articles on “Statistics in R Series”, I hope
    things will become a lot more understandable. For now, the following table shows
    whatever we have covered in terms of model definition and execution.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8f9e1f54afdfc6343b3f9550100b6068.png)'
  prefs: []
  type: TYPE_IMG
- en: What is multinomial regression?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In simple terms, a multinomial regression model estimates the likelihood of
    an individual falling into a specific category in relation to a baseline category
    using a logit or log odds approach. It works like an extension to the binomial
    distribution when the nominal response variable has more than 2 outcomes. In multinomial
    regression, we need to define a reference category and the model will determine
    several binomial distribution parameters with respect to the reference category.
  prefs: []
  type: TYPE_NORMAL
- en: In our example, we will set a specific health status as the baseline category
    and perform multinomial logistic regression with reference to that. In brief,
    multinomial regression is like the execution of several binary regression models
    in one shot.
  prefs: []
  type: TYPE_NORMAL
- en: '**Dataset**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The [adult dataset from the UCI repository](https://archive.ics.uci.edu/ml/datasets/adult)
    will again be used for the implementation of multinomial logistic regression.
    A quick look at the dataset is below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2cfd35028c97cea40f1df9dcfbacd968.png)'
  prefs: []
  type: TYPE_IMG
- en: Adult dataset from [UCI repository](https://archive.ics.uci.edu/ml/datasets/adult)
  prefs: []
  type: TYPE_NORMAL
- en: 'Education: numeric and continuous'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Marital status: binary (0 for unmarried and 1 for married)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Gender: binary (0 for female and 1 for male)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Family income: binary (0 for average or less than average and 1 for more than
    average)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Health status: ordinal (1 for poor, 2 for average, 3 for good and 4 for excellent)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here, although the health status is ordinal, we really don’t need to have that
    since we will be performing multiple binary logistic regression.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation in R**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: To implement multinomial logistic regression, I will use vglm() command from
    VGAM package. The code snippet is below.
  prefs: []
  type: TYPE_NORMAL
- en: As mentioned earlier, we need to define a reference category. here, I have defined
    health status at level = 1 as the reference category.
  prefs: []
  type: TYPE_NORMAL
- en: '**Interpretation of result**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/d9ea6eb6bf81a219bb8797dc2cbc96ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Model summary
  prefs: []
  type: TYPE_NORMAL
- en: Alright. We have the summary of the model that we defined above. It is one predictor
    model with multiple outcome categories. The predictor is education in years (continuous)
    and the outcome is categorial which is actually ordinal in nature but we don’t
    need similar ordinal responses. We can simply assign numeric values to the categories.
  prefs: []
  type: TYPE_NORMAL
- en: The summary is similar to binary logistic regression but we have multiple binary
    regression models all of which are compared with the reference category. Let’s
    refer to the coefficient block above.
  prefs: []
  type: TYPE_NORMAL
- en: The first model with intercept1 and educ1 compares category 2 with the reference
    category 1 (defined is the model definition). The second model with intercept2
    and educ2 compares category 3 with the reference category 1\. The third model
    with intercept3 and educ3 compares category 4 with the reference category 1\.
    Since there are four categories, only three binary comparisons are possible.
  prefs: []
  type: TYPE_NORMAL
- en: 'model1:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/902ddfa90cb1c4dac5e703380e7f671a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'model2:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1ffe499a83809e51c16934216d161aa4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'model3:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/332333c92603a9ddf76c5ba018e7829a.png)'
  prefs: []
  type: TYPE_IMG
- en: The same binary logistic interpretation can be applied here. For example in
    model1, we can say that for every unit increase in the educ variable, the logit
    or log odds of being in category 2 compared to category 1 increases by 0.08969
    and the same goes for the remaining two models. The slope is positive in all cases
    because the log odds of having a better health status increase with the increase
    in education. This is pretty obvious but we have quantified this fact with the
    given dataset.
  prefs: []
  type: TYPE_NORMAL
- en: R also ran a hypothesis test on each predictor. The null hypothesis states that
    the predictor is not a significant variable in predicting log odds. The associated
    p-value for educ1 is 0.00853 which is < 0.01\. Therefore, we can reject the null
    hypothesis and come to the conclusion that educ1 plays a significant role in determining
    the log odds of category 2 with respect to category 1 which is the reference category.
  prefs: []
  type: TYPE_NORMAL
- en: We can also determine the odd ratios in R as below.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0c4827519038f33867b9d488edecc8ed.png)'
  prefs: []
  type: TYPE_IMG
- en: Odd ratio
  prefs: []
  type: TYPE_NORMAL
- en: This is basically the exponent value for the coefficients. This tells us that
    for every unit increase in educ, the odds of being in category 2 increase by a
    factor of 1.09350 in comparison with category 1\. To put it another way, the odds
    of being in category 2 increase by 9.35% with every one unit increase in educ.
  prefs: []
  type: TYPE_NORMAL
- en: The percentages become significant for other models. The odds of being in category
    3 increase by 25.23% with every one unit increase in educ and the odds of being
    in category 4 increase by 35.82% with every one unit increase in educ with respect
    to the reference category of 1.
  prefs: []
  type: TYPE_NORMAL
- en: '**Conclusion**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In this article, I have discussed the need for a multinomial logistic regression
    model and executed it in R. This type of regression is similar to binary regression
    except we have multiple binary comparisons done. When we have an unordered category
    like political party affiliation, we can perform multinomial logistic regression.
  prefs: []
  type: TYPE_NORMAL
- en: '**Acknowledgement for Dataset**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[Dua, D. and Graff, C. (2019). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml].
    Irvine, CA: University of California, School of Information and Computer Science
    (CC BY 4.0)](https://archive.ics.uci.edu/ml/datasets/adult)'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://mdsohel-mahmood.medium.com/membership?source=post_page-----428d9bb7dc70--------------------------------)
    [## Join Medium with my referral link - Md Sohel Mahmood'
  prefs: []
  type: TYPE_NORMAL
- en: Read every story from Md Sohel Mahmood (and thousands of other writers on Medium).
    Your membership fee directly…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: mdsohel-mahmood.medium.com](https://mdsohel-mahmood.medium.com/membership?source=post_page-----428d9bb7dc70--------------------------------)
    [](https://mdsohel-mahmood.medium.com/subscribe?source=post_page-----428d9bb7dc70--------------------------------)
    [## Get an email whenever Md Sohel Mahmood publishes.
  prefs: []
  type: TYPE_NORMAL
- en: Get an email whenever Md Sohel Mahmood publishes. By signing up, you will create
    a Medium account if you don't already…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: mdsohel-mahmood.medium.com](https://mdsohel-mahmood.medium.com/subscribe?source=post_page-----428d9bb7dc70--------------------------------)
  prefs: []
  type: TYPE_NORMAL

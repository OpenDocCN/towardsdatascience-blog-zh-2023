# Scikit-Learnä¸­çš„ç®¡é“ï¼šä¸€ç§æ‰“åŒ…è½¬æ¢çš„ç»å¦™æ–¹æ³•

> åŸæ–‡ï¼š[https://towardsdatascience.com/pipelines-in-scikit-learn-an-amazing-way-to-bundle-transformations-9ef0594000ac](https://towardsdatascience.com/pipelines-in-scikit-learn-an-amazing-way-to-bundle-transformations-9ef0594000ac)

## ç®¡é“å¦‚ä½•å¸®åŠ©æ‚¨ç¼–å†™æ›´å¥½çš„æœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦ä»£ç  ğŸ˜

[](https://medium.com/@ebbeberge?source=post_page-----9ef0594000ac--------------------------------)[![Eirik Berge, PhD](../Images/7507374e75980fd0c1056af3cd299eaa.png)](https://medium.com/@ebbeberge?source=post_page-----9ef0594000ac--------------------------------)[](https://towardsdatascience.com/?source=post_page-----9ef0594000ac--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----9ef0594000ac--------------------------------) [Eirik Berge, PhD](https://medium.com/@ebbeberge?source=post_page-----9ef0594000ac--------------------------------)

Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----9ef0594000ac--------------------------------) Â·5åˆ†é’Ÿé˜…è¯»Â·2023å¹´4æœˆ5æ—¥

--

![](../Images/af74d4aa798e6d0abd86bb7284cd5dc3.png)

å›¾ç‰‡æ¥æºï¼š[Rodion Kutsaiev](https://unsplash.com/fr/@frostroomhead?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# æ‚¨çš„æ—…ç¨‹æ¦‚è¿°

1.  [ä»‹ç»](#a6cb)

1.  [æ²¡æœ‰ç®¡é“çš„é—®é¢˜ï¼Ÿ](#8f4f)

1.  [ç®¡é“æ¥æ•‘æ´ï¼](#d657)

1.  [æœ‰ç”¨çš„å±æ€§å’Œå®ç”¨å‡½æ•°](#15c2)

1.  [æ€»ç»“](#c801)

# 1 â€” ä»‹ç»

å¤„ç†æœºå™¨å­¦ä¹ ä»»åŠ¡çš„æœ€å—æ¬¢è¿çš„Pythonåº“ä¹‹ä¸€æ˜¯ [scikit-learn](https://scikit-learn.org/stable/index.html)ã€‚å®ƒäº2010å¹´å‘å¸ƒï¼Œè‡ªé‚£æ—¶èµ·ï¼Œå®ƒå¯¹äºå®ç°æµè¡Œçš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå¦‚ [é€»è¾‘å›å½’](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression)ã€ [éšæœºæ£®æ—](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier) å’Œ [æ”¯æŒå‘é‡æœº](https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVR.html#sklearn.svm.LinearSVR) å·²ç»æˆä¸ºå¿…ä¸å¯å°‘çš„å·¥å…·ã€‚

åœ¨ä½¿ç”¨scikit-learnç¼–å†™ä»£ç æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš **ç®¡é“** çš„åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½å…è®¸æ‚¨å°†æœºå™¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„å‡ ä¸ªæ­¥éª¤æ‰“åŒ…æˆä¸€ä¸ªå•ä¸€çš„ç»„ä»¶ã€‚ç®¡é“çš„ä½¿ç”¨æ˜¯åˆ¤æ–­scikit-learnä»£ç æ˜¯å¦æ˜“äºæ“ä½œçš„*æœ€å…³é”®å› ç´ ä¹‹ä¸€*ã€‚è®¸å¤šäººåœ¨åˆ›å»ºscikit-learnæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶å¿½è§†äº†ç®¡é“ï¼Œè¿™çœŸçš„è®©äººæ²®ä¸§ ğŸ˜

åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæ‚¨å°†å­¦ä¹ åˆ°scikit-learnç®¡é“çš„ä¼˜ç‚¹ã€‚é˜…è¯»å®Œæ¯•åï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿè‡ªä¿¡åœ°å°†ç®¡é“åº”ç”¨åˆ°è‡ªå·±çš„æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ ğŸ‘

# 2 â€” æ²¡æœ‰ç®¡é“çš„é—®é¢˜ï¼Ÿ

ç®¡é“çš„ç›®æ ‡æ˜¯å°†æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­çš„å¤šä¸ªæ­¥éª¤å°è£…æˆä¸€ä¸ª**å¯ç®¡ç†çš„æ•´ä½“**ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä»ä»¥ä¸‹è®¾ç½®ä»£ç å¼€å§‹ï¼š

[PRE0]

å¦‚ä¸Šä»£ç å—ä¸­çš„å¯¼å…¥æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†å¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ï¼Œç„¶åä½¿ç”¨**éšæœºæ£®æ—æ¨¡å‹**è¿›è¡Œåˆ†ç±»ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨ç®¡é“ï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

[PRE1]

ä¸Šé¢çš„ä»£ç å­˜åœ¨ä¸€äº›ä¸¥é‡å’Œè½»å¾®çš„é—®é¢˜ï¼è®©æˆ‘ä»¬æåŠå…¶ä¸­çš„ä¸€äº›ï¼š

+   **æ•°æ®æ³„æ¼ï¼š** å¦‚æœä»”ç»†æŸ¥çœ‹ä¸Šé¢çš„ä»£ç ï¼Œä½ ä¼šå‘ç°å®ƒå®é™…ä¸Šå°†è®­ç»ƒæ•°æ®çš„ä¿¡æ¯æ³„éœ²ç»™äº†æµ‹è¯•æ•°æ®ã€‚å…·ä½“æ¥è¯´ï¼Œå½“`scaler`è½¬æ¢`X_test`æ—¶ï¼Œå®ƒä½¿ç”¨äº†`X_train`çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚å› æ­¤ï¼Œè®­ç»ƒé›†çš„ä¿¡æ¯åœ¨æµ‹è¯•é›†ä¸­è¢«æ­ç¤ºã€‚è¿™å¯èƒ½ä½¿éšæœºæ£®æ—åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®æ€§æœ‰äº›ä¹è§‚ï¼

+   **ä¸­é—´å˜é‡åç§°ï¼š** æˆ‘ä»¬åˆ›å»ºäº†ä¸­é—´å˜é‡åç§°`X_train_scaled`å’Œ`X_test_scaled`ã€‚è¿™ä»…ä»…æ˜¯å› ä¸ºæˆ‘ä»¬å°†ç¼©æ”¾å’Œè®­ç»ƒä½œä¸ºå®Œå…¨ç‹¬ç«‹çš„è¿‡ç¨‹ã€‚

+   **è¾ƒå°‘çš„æ˜¾å¼å‡½æ•°è°ƒç”¨ï¼š** åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå‡ è¡Œæ˜¯ä¸­é—´çš„`.fit()`å’Œ`.transform()`å‡½æ•°è°ƒç”¨ã€‚è¿™ä½¿å¾—ä»£ç å˜å¾—æ··ä¹±ä¸”ä¸æ˜“è¯»ã€‚

+   **è¶…å‚æ•°æœç´¢ï¼š** æˆ‘ä»¬å¸Œæœ›å¯¹`MinMaxScaler`ä¸­çš„`feature_range`å‚æ•°å’Œ`RandomForestClassifier`ä¸­çš„`n_estimators`å‚æ•°è¿›è¡Œè¶…å‚æ•°æœç´¢ã€‚æˆ‘ä»¬éœ€è¦å®Œå…¨åˆ†å¼€è¿›è¡Œè¿™äº›æœç´¢ï¼è¿™ä¸ä»…éº»çƒ¦ï¼Œè€Œä¸”æˆ‘ä»¬ä¼šåˆ†åˆ«è´ªå©ªåœ°ä¼˜åŒ–æ¯ä¸ªå‚æ•°ï¼Œè€Œä¸æ˜¯å¯»æ‰¾ä¸€ä¸ªç»„åˆçš„æœ€ä½³è§£ã€‚è¿™å¯èƒ½ä½¿æˆ‘ä»¬é”™è¿‡æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚

# 3 â€” ç®¡é“æ¥æ‹¯æ•‘ï¼

![](../Images/bef3e9da02e6c480b931e6a8f1b2ceb6.png)

ç…§ç‰‡ç”±[Erlend Ekseth](https://unsplash.com/@er1end?utm_source=medium&utm_medium=referral)æä¾›ï¼Œæ¥è‡ª[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

ä¸è¶³ä¸ºå¥‡çš„æ˜¯ï¼Œç®¡é“å°†æ‹¯æ•‘è¿™ä¸ªé—®é¢˜ã€‚å°†ä¸Šè¿°ä»£ç ä¸ä»¥ä¸‹ä»£ç ç‰‡æ®µè¿›è¡Œæ¯”è¾ƒï¼š

[PRE2]

ä½¿ç”¨ç®¡é“çš„ä»£ç æ›´ç®€æ´ã€æ›´é«˜æ•ˆï¼Œå¹¶é¿å…äº†ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼š

+   **æ•°æ®æ³„æ¼ï¼š** ç®¡é“è‡ªåŠ¨ç¡®ä¿æ²¡æœ‰æ•°æ®æ³„æ¼å‘ç”Ÿï¼

+   **ä¸­é—´å˜é‡åç§°ï¼š** ä½ ä¸å†éœ€è¦åƒ`X_train_scaled`å’Œ`X_test_scaled`è¿™æ ·çš„ä¸­é—´å˜é‡åç§°äº†ï¼

+   **è¾ƒå°‘çš„æ˜¾å¼å‡½æ•°è°ƒç”¨ï¼š** ä½¿ç”¨ç®¡é“ï¼Œä½ åªéœ€è¦ä¸€ä¸ª`.fit()`å‡½æ•°è°ƒç”¨æ¥æ‰§è¡Œæ•´ä¸ªåºåˆ—ã€‚è¿™ä½¿å¾—ä»£ç æ›´æ˜“è¯»ï¼

+   **è¶…å‚æ•°æœç´¢ï¼š** ä¸€æ—¦ä½¿ç”¨äº†ç®¡é“ï¼Œä½ å¯ä»¥å¯¹æ‰€æœ‰ç»„ä»¶åŒæ—¶è¿›è¡Œè¶…å‚æ•°æœç´¢ã€‚æ–¹æ³•`.get_params()`å¯¹è·å–ç®¡é“ä¸­æ‰€æœ‰å˜æ¢å™¨/ä¼°è®¡å™¨çš„å‚æ•°åç§°éå¸¸æœ‰ç”¨ã€‚è¿™ä¸ªåœ¨åšå®¢æ–‡ç« [å°†ç®¡é“é›†æˆåˆ° Scikit-Learn çš„è¶…å‚æ•°æœç´¢ä¸­](/integrate-pipeline-into-scikit-learns-hyperparameter-search-e123c743b6a0)ä¸­æœ‰å¾ˆå¥½çš„è§£é‡Šï¼

# 4 â€” æœ‰ç”¨çš„å±æ€§å’Œå®ç”¨åŠŸèƒ½

åœ¨ scikit-learn ä¸­æ‹Ÿåˆç®¡é“åï¼Œæœ‰ä¸€äº›å±æ€§å¯ä»¥è®©ä½ çš„å·¥ä½œå˜å¾—æ›´è½»æ¾ã€‚æˆ‘æ›¾ç»å¿½è§†è¿™äº›å±æ€§ï¼Œä»˜å‡ºäº†ä»£ä»·ğŸ˜…

ç¬¬ä¸€ä¸ªæ˜¯å±æ€§`named_steps`ï¼š

[PRE3]

æ¯å½“ä½ æœ‰ä¸€ä¸ªå¤åˆå¯¹è±¡ï¼ˆå¦‚ scikit-learn ä¸­çš„ç®¡é“ï¼‰æ—¶ï¼ŒçŸ¥é“å¦‚ä½•è®¿é—®å„ä¸ªç»„ä»¶æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚

å¦ä¸€ä¸ªæœ‰ç”¨çš„å±æ€§æ˜¯`.n_features_in_`ã€‚è¿™å°†æ˜¾ç¤ºä¼ é€’åˆ°ç®¡é“ç¬¬ä¸€ä¸ªéšå¼`.fit()`æ–¹æ³•ä¸­çš„ç‰¹å¾æ•°é‡ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ˜¯`MinMaxScaler`çš„`.fit()`æ–¹æ³•ï¼‰ï¼š

[PRE4]

æœ€åï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨å®ç”¨å‡½æ•°`make_pipeline()`æ¥åˆ›å»º scikit-learn ä¸­çš„ç®¡é“ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ`make_pipeline` ä¼šè‡ªåŠ¨ä¸ºä¸åŒçš„å˜æ¢å™¨/ä¼°è®¡å™¨å‘½åï¼š

[PRE5]

æˆ‘ä¸ªäººæ›´å–œæ¬¢ä½¿ç”¨å®ç”¨å‡½æ•°`make_pipeline`ï¼Œè¿™æ ·æˆ‘å°±ä¸éœ€è¦è‡ªå·±æƒ³å‡ºåç§°ã€‚å¦‚æœæœ‰è®¸å¤šå¼€å‘äººå‘˜åœ¨å¤„ç†ä¸åŒçš„ç®¡é“ï¼Œé‚£ä¹ˆ`make_pipeline` **ç¡®ä¿ä¸€è‡´æ€§**ã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºç®¡é“çš„åµŒå¥—å‚æ•°å’Œç¼“å­˜çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [ç®¡é“ç”¨æˆ·æŒ‡å—](https://scikit-learn.org/stable/modules/compose.html)ã€‚

# 5â€” æ€»ç»“

![](../Images/4a06c775ef80f575c5d7cdfe36d7a151.png)

å›¾ç‰‡ç”± [Spencer Bergen](https://unsplash.com/@spencerbergen?utm_source=medium&utm_medium=referral) æä¾›ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

å¸Œæœ›ä½ ç°åœ¨ç†è§£äº†åœ¨ç¼–å†™ Scikit-Learn æœºå™¨å­¦ä¹ ä»£ç æ—¶å¦‚ä½•ä»¥åŠä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç®¡é“ã€‚å¦‚æœä½ å¯¹æ•°æ®ç§‘å­¦ã€ç¼–ç¨‹æˆ–ä»‹äºä¸¤è€…ä¹‹é—´çš„ä»»ä½•äº‹ç‰©æ„Ÿå…´è¶£ï¼Œå¯ä»¥åœ¨ [LinkedIn](https://www.linkedin.com/in/eirik-berge/) ä¸ŠåŠ æˆ‘å¹¶æ‰“ä¸ªæ‹›å‘¼ âœ‹

**å–œæ¬¢æˆ‘çš„å†™ä½œå—ï¼Ÿ** æŸ¥çœ‹æˆ‘å…¶ä»–çš„ä¸€äº›æ–‡ç« è·å–æ›´å¤š Python å†…å®¹ï¼š

+   [ç”¨ä¼˜ç¾çš„ç±»å‹æç¤ºç°ä»£åŒ–ä½ ç½ªæ¶çš„ Python ä»£ç ](/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1)

+   [åœ¨ Python ä¸­å¯è§†åŒ–ç¼ºå¤±å€¼æå…¶ç®€å•](/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea)

+   [åœ¨ Python ä¸­ä½¿ç”¨ PyOD ä»‹ç»å¼‚å¸¸/ç¦»ç¾¤å€¼æ£€æµ‹ ğŸ”¥](/introducing-anomaly-outlier-detection-in-python-with-pyod-40afcccee9ff)

+   [5 ä¸ªåœ¨ç´§æ€¥æƒ…å†µä¸‹æ‹¯æ•‘ä½ çš„äº†ä¸èµ·çš„ NumPy å‡½æ•°](/5-awesome-numpy-functions-that-can-save-you-in-a-pinch-ba349af5ac47)

+   [5 ä¸ªæå‡ä½  Python è¯å…¸æŠ€èƒ½çš„ä¸“å®¶å»ºè®® ğŸš€](/5-expert-tips-to-skyrocket-your-dictionary-skills-in-python-1cf54b7d920d)

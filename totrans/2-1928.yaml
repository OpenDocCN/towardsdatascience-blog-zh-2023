- en: Streamline dbt Model Development with Notebook-Style Workspace
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/streamline-dbt-model-development-with-notebook-style-workspace-eb156fe6e81](https://towardsdatascience.com/streamline-dbt-model-development-with-notebook-style-workspace-eb156fe6e81)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Interactively Build and Orchestrate Data Models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://khuyentran1476.medium.com/?source=post_page-----eb156fe6e81--------------------------------)[![Khuyen
    Tran](../Images/98aa66025ad29b618e875c75f1c400a5.png)](https://khuyentran1476.medium.com/?source=post_page-----eb156fe6e81--------------------------------)[](https://towardsdatascience.com/?source=post_page-----eb156fe6e81--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----eb156fe6e81--------------------------------)
    [Khuyen Tran](https://khuyentran1476.medium.com/?source=post_page-----eb156fe6e81--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----eb156fe6e81--------------------------------)
    ·7 min read·Jun 5, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fd11a3304be743c99f498095736e978a.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '*Originally published at* [*https://mathdatasimplified.com*](https://mathdatasimplified.com/2023/06/05/dbt-mage-interactively-build-and-orchestrate-data-models/)
    *on June 5, 2023.*'
  prefs: []
  type: TYPE_NORMAL
- en: Motivation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: dbt (data build tool) is a powerful tool for data transformation within the
    data warehouse.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, it does come with some limitations, including the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Lack of Output Preview:** With dbt core, it is not possible to preview the
    output of a model before building it, which can hinder the ability to validate
    and iterate on the data transformation process.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Limitations in Feature Engineering:** Since SQL is dbt’s primary language,
    there are certain limitations when it comes to advanced feature engineering tasks.
    To perform complex feature engineering beyond the capabilities of SQL, additional
    tools or languages such as Python may be required.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Partial ETL Solution:** While dbt excels in data transformation, it does
    not provide a comprehensive end-to-end solution for tasks like data loading, data
    extraction, and orchestration.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To mitigate some of these challenges, dbt Cloud offers features like developing
    data models, previewing outputs, and scheduling dbt jobs through a user-friendly
    web-based UI. However, as the number of projects grows, the cost of utilizing
    dbt Cloud can become substantial.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4b76d92f30a0e5e0369276c6808a37fc.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Mage + dbt Integration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A free alternative to dbt cloud is [Mage](https://www.mage.ai/), an open-source
    data pipeline tool for data transformation and integration tasks.
  prefs: []
  type: TYPE_NORMAL
- en: 'Mage seamlessly complements dbt with a range of benefits, including:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Integrated Web-based IDE:** Mage provides a convenient web-based IDE where
    you can develop and explore data models effortlessly within a single interface.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Language Flexibility:** With Mage, you can combine the strengths of different
    tools and languages alongside dbt for enhanced data processing capabilities.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Visualizing dbt Model Output:** Mage provides a built-in visualization capability,
    allowing users to effortlessly visualize the output generated by dbt models with
    just a few clicks.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Data Extraction and Loading:** In addition to data transformation, Mage offers
    functionalities for data extraction and loading, enabling a more comprehensive
    end-to-end data pipeline solution.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Pipeline Scheduling and Retry Mechanism:** Mage allows you to schedule your
    data pipelines and automatically retry failed components, ensuring the smooth
    and reliable execution of your data integration processes.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let’s dive deeper into each of these features.
  prefs: []
  type: TYPE_NORMAL
- en: 'Feel free to explore and experiment with the source code by cloning this GitHub
    repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/khuyentran1401/dbt-mage?source=post_page-----eb156fe6e81--------------------------------)
    [## GitHub - khuyentran1401/dbt-mage'
  prefs: []
  type: TYPE_NORMAL
- en: You can't perform that action at this time. You signed in with another tab or
    window. You signed out in another tab or…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/khuyentran1401/dbt-mage?source=post_page-----eb156fe6e81--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Setup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Install Mage
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can install Mage using Docker, pip, or conda. This article will use Docker
    to install Mage and initialize the project.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'For example, let’s name our project “dbt_mage,” so the command becomes:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Find other ways to install Mage [here](https://docs.mage.ai/getting-started/setup).
  prefs: []
  type: TYPE_NORMAL
- en: Create a pipeline
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open [http://localhost:6789/](http://localhost:6789/) in your browser to view
    the Mage UI.
  prefs: []
  type: TYPE_NORMAL
- en: Click on “New” and select “Standard (batch)” to create a new batch pipeline.
    Rename it as “dbt_pipeline.”
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aefab4440f8d9a685302053608dfebbf.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Install dependencies
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Since we will use BigQuery as the data warehouse for dbt, we need to install
    `dbt-bigquery` by adding it to the "requirements.txt" file and clicking on "Install
    packages."
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/df8ce2927179b6bddbd000755ee3c758.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Create a dbt project
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To create a dbt project, navigate to the right panel and click on the terminal
    button.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c0a8e128cf7ecb0f434fc148007b30b.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Move to the “dbt” folder under your project and execute the command `dbt init`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: This command adds the “demo” folder to the dbt directory.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5ee41c700d091ea10f38900cab3a2166.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on the “demo” folder and create a new file named “profiles.yml.”
    Specify your BigQuery credentials in this file.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/83a273dd0238768dac9dafc9ae336dcf.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Refer to [this documentation](https://docs.getdbt.com/docs/core/connect-data-platform/profiles.yml)
    for instructions on specifying credentials for other data platform providers.
  prefs: []
  type: TYPE_NORMAL
- en: Now that the setup is complete, we are ready to explore the exciting features
    of Mage!
  prefs: []
  type: TYPE_NORMAL
- en: Integrated Web-based IDE
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mage offers a user-friendly web-based UI that simplifies the creation of dbt
    models. Its unique feature of using allows for interactive code development, similar
    to working in a Jupyter Notebook. Each block functions as an independent executable
    code file.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/20fef85ea8ad1f7869d57db2a7eef7f9.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: To create a new dbt model, click on “DBT model” and provide the name and location.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c5683bce691e9675d7aa79a3dcfe79e6.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Write your query and click “Compile & preview” to preview the query results.
  prefs: []
  type: TYPE_NORMAL
- en: After previewing the result, execute the model by clicking the three-dot icon
    and selecting “Run model.”
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c0343050d83c8140eab807fc8adfb9e.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: You can create additional models within the same editor by clicking “DBT model”
    again.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/faf67e4f7ab97b638ff7d55cee7d8ae3.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Use `{{ ref('model_name') }}` to reference one model within another, just like
    in dbt.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/89da464d979c3ece49db1a6823d6aedd.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Language Flexibility and ETL Functionalities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mage empowers you to combine dbt models with other languages, including Python,
    R, or SQL, for data loading, transformation, and exporting purposes.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fd11a3304be743c99f498095736e978a.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: As an example, let’s create two Python data loaders-one for US data and one
    for India data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8bbb451225e99440e0e89a38c64fb0e9.png)![](../Images/952d01de67a665bf1acd6386968f0b4e.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: We’ll then incorporate a dbt block to join the outputs of these data loaders.
    Set the parent blocks of the `join_tables` block by clicking “Edit parent block”
    and choosing the data loaders blocks.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7724cfc7f26ce3b120f4d8221a4d10fb.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: When a dbt model depends on a non-dbt upstream block, Mage automatically adds
    a source for that block to the “dbt/demo/models/mage_sources.yml” file.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/57e6df96eb3c9eb3494984603a6dcff0.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: You can now utilize the outputs of the Python blocks within the dbt block.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/99aa2fc1b05dd0a5440d5c3117f8a460.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: We can then set a transformer block, named `convert_object_to_int`, as the downstream
    block of `join_tables` to process its output.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6a99edcf881c978e8599769bdb066244.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Visualizing dbt Model Output
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While traditional tools like Tableau can be used for visualization, Mage offers
    a consolidated solution for processing and analyzing the output of a dbt block
    in one place.
  prefs: []
  type: TYPE_NORMAL
- en: To demonstrate this, let’s create another block called `convert_week_to_datetime`,
    which converts the `Week` column to a datetime type.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1053f6a2e1af5caf7334bd206f4cb569.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Click the “Add chart” icon, select “Time series line chart,” and create a time
    series visualization.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8a89286821028fb221cda2e5debf4a3c.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'And you will see the following line chart:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5d0ef1c46b420dd7fcd617e4ece6d7c1.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Pipeline Scheduling and Retry Mechanism
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mage enables you to schedule pipeline runs and incorporates a retry mechanism
    for failed blocks without rerunning the entire pipeline.
  prefs: []
  type: TYPE_NORMAL
- en: To execute a pipeline immediately, click the “Triggers” icon on the left panel,
    and select “Run pipeline now.”
  prefs: []
  type: TYPE_NORMAL
- en: You can monitor the real-time status of all block runs by choosing the newly
    created pipeline trigger and clicking “See block runs.”
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/08b2b8004fbf56fee717563e84bb8f00.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: To schedule a pipeline, click “Create a new trigger,” select “Schedule,” and
    define the desired frequency.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f90954f3e23bf2f828c186d3d0e00185.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Click “Retry incomplete blocks” to retry failed blocks without restarting the
    entire pipeline.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2ad5dac76ee03303a5b9ea6c603575f0.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Drawbacks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'While Mage is a great complement to dbt, it’s important to consider a few drawbacks
    when using Mage:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Increased project complexity:** Integrating both Mage and dbt can introduce
    additional complexity to the structure of your project.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Longer error messages:** Due to Mage’s inclusion of extra code around the
    block code, error messages tend to be lengthier compared to standard error messages.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Learning curve:** While Mage provides an intuitive user experience, getting
    acquainted with this new tool will require some time and effort.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mage is the ideal tool to complement your dbt project if you seek improved efficiency
    and are open to a slight increase in project complexity.
  prefs: []
  type: TYPE_NORMAL
- en: 'I love writing about data science concepts and playing with different data
    science tools. You can stay up-to-date with my latest posts by:'
  prefs: []
  type: TYPE_NORMAL
- en: Subscribing to my newsletter on [Data Science Simplified](https://mathdatasimplified.com/).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Connect with me on [LinkedIn](https://www.linkedin.com/in/khuyen-tran-1401/)
    and [Twitter](https://twitter.com/KhuyenTran16).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

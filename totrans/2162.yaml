- en: Two-Way ANOVA Test, with Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: åŽŸæ–‡ï¼š[https://towardsdatascience.com/two-way-anova-test-with-python-a112e2396d78](https://towardsdatascience.com/two-way-anova-test-with-python-a112e2396d78)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The complete beginnerâ€™s guide to perform two-way ANOVA test (with code!)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://chaodeyu.medium.com/?source=post_page-----a112e2396d78--------------------------------)[![Chao
    De-Yu](../Images/8d6805b4797dcc71fa722bbb3d06a91b.png)](https://chaodeyu.medium.com/?source=post_page-----a112e2396d78--------------------------------)[](https://towardsdatascience.com/?source=post_page-----a112e2396d78--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----a112e2396d78--------------------------------)
    [Chao De-Yu](https://chaodeyu.medium.com/?source=post_page-----a112e2396d78--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----a112e2396d78--------------------------------)
    Â·6 min readÂ·Jan 5, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d896358a9cda32130ebea2395752b3f5.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Sergey Pesterev](https://unsplash.com/@sickle) on [Unsplash](https://unsplash.com)
  prefs: []
  type: TYPE_NORMAL
- en: ANOVA tests are designed to test for any statistically significant differences
    between means of three or more groups. There are two types of ANOVA (analysis
    of variance) that are commonly used, `**one-way ANOVA test**` and `**two-way ANOVA
    test**`. The only difference is the number of independent variables that affect
    the dependent variable.
  prefs: []
  type: TYPE_NORMAL
- en: Two-Way ANOVA
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The two-way ANOVA is an extension of the [one-way ANOVA](/anova-test-with-python-cfbf4013328b)
    that examines the effect of `**two different categorical independent variables
    or two independent factors**` on `**one continuous depedent variable.**`
  prefs: []
  type: TYPE_NORMAL
- en: The two-way ANOVA not only aims to test the main effect of each independent
    factor but also test if the two factors affect each other to influence the dependent
    variable, i.e., if there is any interaction between two independent factors. [2]
  prefs: []
  type: TYPE_NORMAL
- en: ANOVA uses the F test, a groupwise comparison test, for statistical significance.
    It compares the variance in each group's mean under different factors (factor
    A, factor B, interaction between factor A & factor B) to the overall variance
    in the dependent variable. Finally, based on the F-test statistic, a conclusion
    is made.
  prefs: []
  type: TYPE_NORMAL
- en: Sum of Squares (SS)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Inside the Two-Way ANOVA Table:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The total amount of variability comes from four possible sources, namely:'
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Variation **among** the groups **under factor A**, called **treatment**
    (A)
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Variation **among** the groups **under factor B**, called **treatment**
    (B)
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Sum of Squares due to **interaction between factor A and factor B**, called
    **interaction** (AB)
  prefs: []
  type: TYPE_NORMAL
- en: 4\. Variation **within** the groups, called **error** (E)
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0464ca9bc17dbc229a709138ab9ffd83.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 1\. Illustration of SS and d.f. Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Similar to Sum of Squares (SS), d.f. (SSTO) = d.f. (SSA) + d.f. (SSB) + d.f.
    (SSAB) + d.f. (SSE)
  prefs: []
  type: TYPE_NORMAL
- en: SS divided by its d.f. will result in a mean square (MS).
  prefs: []
  type: TYPE_NORMAL
- en: Assumptions for the two-way ANOVA test are the same as those of the one-way
    ANOVA test, which makes all of the normal assumptions of a parametric test i.e.
    sample dataâ€™s randomness and independence, normality, and homogeneity of variance.
    If you want to read more details, can refer back to the [previous article](/anova-test-with-python-cfbf4013328b).
    [3]
  prefs: []
  type: TYPE_NORMAL
- en: The simple outline of the two-way ANOVA test
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A two-way ANOVA has **three sets of hypotheses**:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Set 1:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: Î¼â‚â‚= Î¼â‚â‚‚ = Î¼â‚â‚ƒ = â€¦ = Î¼â‚ð’¸'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: Not all Î¼â‚áµ¢â€™s are equal under factor A, where i = 1, 2, 3, â€¦, c.'
  prefs: []
  type: TYPE_NORMAL
- en: Level of significance = Î±
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8949693039f510b2c26520da4f2be668.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 2\. F-test statistic to test the main effect of factor A. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**Set 2:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: Î¼áµ¦â‚= Î¼áµ¦â‚‚ = Î¼áµ¦â‚ƒ = â€¦ = Î¼áµ¦áµ£'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: Not all Î¼áµ¦áµ¢â€™s are equal under factor B, where i = 1, 2, 3, â€¦, r.'
  prefs: []
  type: TYPE_NORMAL
- en: Level of significance = Î±
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9c9a44665b761db8191ef15cd28b4a1a.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 3\. F-test statistic to test the main effect of factor B. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: '**Set 3:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: The effect of one independent variable does not depend on the effect of
    the other independent variable, i.e., there is no interaction between factor A
    and factor B'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: There is an interaction between factor A and factor B'
  prefs: []
  type: TYPE_NORMAL
- en: Level of significance = Î±
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6628cf156899cc7bbafab67314d5a4a7.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 4\. F-test statistic to test if there is an interaction between two independent
    factors. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: If you perform a two-way ANOVA test **with interaction**, you need to test **all
    3 sets of hypotheses** mentioned above.But if you perform the test **without interaction**,
    you only need to test the **Set 1 and Set 2 hypotheses**.
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, the two-way ANOVA table with interaction is shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b780bfd0cc47e78e4683b3703aa1e034.png)'
  prefs: []
  type: TYPE_IMG
- en: Table 1\. Sample two-way ANOVA table with interaction. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: 'and two-way ANOVA table without interaction is as shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d12049e47b7b57c32691976283904aa4.png)'
  prefs: []
  type: TYPE_IMG
- en: Table 2\. Sample two-way ANOVA table without interaction. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: Balanced Design vs Unbalanced Design
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**A balanced design** is a situation where all **sample sizes for all combinations
    of groups are equal**. In an **unbalanced design**, the **sample sizes for various
    groups are unequal**. In two-way ANOVA, if the sample sizes of groups are too
    different, the normal approach of variance analysis is not adequate. For an unbalanced
    design, the **regression approach** is needed to be used instead. Another way
    is to make extensive efforts to ensure a balanced design.'
  prefs: []
  type: TYPE_NORMAL
- en: A dataset, [students.csv](https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv),
    contains 8239 rows of student particular data. Each row represents a unique student.
    It consists of 16 features related to the student and we will only focus on 3
    features major, gender and salary [1].
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Based on the two factor, major and gender, is there significant difference in
    average annual salary for graduates of different gender and major and also if
    there is any interaction between gender and major at 5% significance level?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Data Processing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: From the dataset given, we need to filter out the students who graduated and
    perform a random sampling. In this case, it randomly sampled 40 students in each
    group i.e. different combinations of (major, and gender) to make it a **balanced
    design**. After that, select the dataset for the three variables of interest,
    the categorical variable `major, gender` and the numeric variable `salary`.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ee845931630fd9862abffcbac2c48a60.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 5\. Data processing to make a balanced design. Image by Author.
  prefs: []
  type: TYPE_NORMAL
- en: Hypothesis Testing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'According to five steps process of hypothesis testing:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Set 1:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: Î¼â‚â‚= Î¼â‚â‚‚ = Î¼â‚â‚ƒ = â€¦ = Î¼â‚â‚†'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: Not all salary means are equal under different major'
  prefs: []
  type: TYPE_NORMAL
- en: 'Set 2:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: Î¼áµ¦â‚= Î¼áµ¦â‚‚'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: Not all salary means are equal under different gender'
  prefs: []
  type: TYPE_NORMAL
- en: 'Set 3:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚€: There is no interaction between major and gender'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hâ‚: There is an interaction between major and gender'
  prefs: []
  type: TYPE_NORMAL
- en: Î± = 0.05
  prefs: []
  type: TYPE_NORMAL
- en: 'According to F test statistics:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ab055345c77545a181cb7c80fd49bfdb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image 6\. ANOVA table with interaction: normal approach of variance analysis.
    Image by Author.'
  prefs: []
  type: TYPE_NORMAL
- en: We could also get the same result using `statsmodels` package which uses the
    regression approach. Since the `statsmodels` use regression approach, it is also
    suitable for unbalanced design i.e. you wonâ€™t need to make extensive efforts to
    ensure a balanced design.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a0a9e60fe2745475c5c4d13a81d392c0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image 7\. ANOVA table with interaction: regression approach. Image by Author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Below shows the interaction plot of major and gender on salary:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c7c994332c0a125e702f8393e6e8556.png)'
  prefs: []
  type: TYPE_IMG
- en: Image 8\. Interaction plot of major and gender on salary. Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For Set 1 & Set 2: Null hypothesis is rejected since F score > F critical or
    p-value is < 0.05\. âˆ´We have enough evidence that not all average salaries are
    the same for graduates of different study subjects or gender, at 5% significance
    level.'
  prefs: []
  type: TYPE_NORMAL
- en: 'For Set 3: Failed to reject the null hypothesis. âˆ´We do not have enough evidence
    that study subjects and gender has interaction, at 5% significance level. Moreover
    from interaction plot [4], it shows that there is no interaction, and both main
    effects, major and gender effects, are significant. For example, the average salaries
    of graduates will be significantly higher for males who graduated in Biology.'
  prefs: []
  type: TYPE_NORMAL
- en: Recommended Reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[](/anova-test-with-python-cfbf4013328b?source=post_page-----a112e2396d78--------------------------------)
    [## ANOVA Test, with Python'
  prefs: []
  type: TYPE_NORMAL
- en: The Complete Beginnerâ€™s Guide to perform ANOVA Test (with code!)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/anova-test-with-python-cfbf4013328b?source=post_page-----a112e2396d78--------------------------------)
    [](/chi-square-test-with-python-d8ba98117626?source=post_page-----a112e2396d78--------------------------------)
    [## Chi-Square Test, with Python
  prefs: []
  type: TYPE_NORMAL
- en: The Complete Beginner Guide to perform Chi-Square Test (with code!)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/chi-square-test-with-python-d8ba98117626?source=post_page-----a112e2396d78--------------------------------)
    [](/mcnemars-test-with-python-e1bab328d15c?source=post_page-----a112e2396d78--------------------------------)
    [## McNemarâ€™s Test, with Python
  prefs: []
  type: TYPE_NORMAL
- en: The Complete Beginnerâ€™s Guide to perform McNemarâ€™s Test (with code!)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/mcnemars-test-with-python-e1bab328d15c?source=post_page-----a112e2396d78--------------------------------)
    [](https://levelup.gitconnected.com/how-to-perform-one-sample-hypothesis-tests-with-python-308eae8789fc?source=post_page-----a112e2396d78--------------------------------)
    [## One-Sample Hypothesis Tests, with Python
  prefs: []
  type: TYPE_NORMAL
- en: The Complete Beginner Guide to perform One-Sample Hypothesis Tests (with code!)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: levelup.gitconnected.com](https://levelup.gitconnected.com/how-to-perform-one-sample-hypothesis-tests-with-python-308eae8789fc?source=post_page-----a112e2396d78--------------------------------)
    [](https://levelup.gitconnected.com/two-sample-hypothesis-tests-with-python-43e1b8c52306?source=post_page-----a112e2396d78--------------------------------)
    [## Two-Sample Hypothesis Tests, with Python
  prefs: []
  type: TYPE_NORMAL
- en: The Complete Beginner Guide to perform Two-Sample Hypothesis Tests (with code!)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: levelup.gitconnected.com](https://levelup.gitconnected.com/two-sample-hypothesis-tests-with-python-43e1b8c52306?source=post_page-----a112e2396d78--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[1] â€œOne-way ANOVA Hypothesis Test â€¢ SOGA â€¢ Department of Earth Sciences.â€
    [Online]. Available: [https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/ANOVA/One-way-ANOVA-Hypothesis-Test/index.html](https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/ANOVA/One-way-ANOVA-Hypothesis-Test/index.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] [Two-way analysis of variance â€” Wikipedia](https://en.wikipedia.org/wiki/Two-way_analysis_of_variance)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] Kiernan, D. (2014). Chapter 6: Two-way Analysis of Variance. Open SUNY
    Textbooks.'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] *Chapter 7 ANOVA with Interaction | STA 265 Notes (Methods of Statistics
    and Data Science)*. (n.d.). Retrieved January 2, 2023, from [http://campus.murraystate.edu/academic/faculty/cmecklin/STA265/_book/anova-with-interaction.html#the-interactive-two-way-anova-model](http://campus.murraystate.edu/academic/faculty/cmecklin/STA265/_book/anova-with-interaction.html#the-interactive-two-way-anova-model)'
  prefs: []
  type: TYPE_NORMAL

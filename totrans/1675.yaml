- en: Predicting Success of a Reward Program at Starbucks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/predicting-success-of-a-reward-program-at-starbucks-b32b77dcf9b8](https://towardsdatascience.com/predicting-success-of-a-reward-program-at-starbucks-b32b77dcf9b8)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Beginners friendly — step by step explanation of a complete project from start
    to finish
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://erdemisbilen.medium.com/?source=post_page-----b32b77dcf9b8--------------------------------)[![Erdem
    Isbilen](../Images/6b6ca6806024725245132894b2958e49.png)](https://erdemisbilen.medium.com/?source=post_page-----b32b77dcf9b8--------------------------------)[](https://towardsdatascience.com/?source=post_page-----b32b77dcf9b8--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----b32b77dcf9b8--------------------------------)
    [Erdem Isbilen](https://erdemisbilen.medium.com/?source=post_page-----b32b77dcf9b8--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----b32b77dcf9b8--------------------------------)
    ·9 min read·Jun 20, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/257d86a537c79400e22c628914ba71c3.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Robert Linder](https://unsplash.com/@rwlinder?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Project Overview
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This project focuses on identifying reward program offers that effectively engage
    Starbucks’ current customers and attract new ones.
  prefs: []
  type: TYPE_NORMAL
- en: Starbucks is a data-driven company that invests in obtaining a complete understanding
    of its customers by utilizing datasets containing customer information, special
    offers, and transaction data.
  prefs: []
  type: TYPE_NORMAL
- en: 'To develop a model capable of determining the success of a reward program,
    I divided the project into **three phases**:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Inspecting and cleaning** the data provided by the Udacity.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating a dataset that **combines all relevant information**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Building and evaluating the performance of **three classification models** **to
    predict the success or failure of a reward program** for a specific person.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Problem Statement
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Making a significant investment in a marketing campaign is a complex decision
    that requires approval from various stakeholders, financial resources, and time.
    Therefore, having a predictive model that can classify whether it is worthwhile
    to launch a particular offer for a specific target group becomes a strategic asset
    for any company.
  prefs: []
  type: TYPE_NORMAL
- en: In order to create this model, we will employ supervised learning techniques
    for binary classification.
  prefs: []
  type: TYPE_NORMAL
- en: '**The outcome of the model will indicate whether the offer is expected to be
    effective or not.**'
  prefs: []
  type: TYPE_NORMAL
- en: '**Dataset Exploration & Wrangling**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Udacity has provided us three datasets in JSON format: **portfolio**, **profile**,
    and **transcript**. Each dataset serves a different purpose and provides valuable
    information for our analysis.'
  prefs: []
  type: TYPE_NORMAL
- en: Portfolio dataset
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This dataset provides information about the active offers available at Starbucks.
  prefs: []
  type: TYPE_NORMAL
- en: '**id (string)** — offer id'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**offer_type (string)** — type of offer ie BOGO, discount, informational'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**difficulty (int)** — minimum required spend to complete an offer'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**reward (int)** — reward given for completing an offer'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**duration (int)** — time for offer to be open, in days'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**channels (list of strings)**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/4c2469dc8124089fe3f9463cb5375ddb.png)'
  prefs: []
  type: TYPE_IMG
- en: Portfolio dataset (original) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: There are ten rows and six columns in the **portfolio** dataset. It is a simple
    dataset with no missing, null or duplicate value.
  prefs: []
  type: TYPE_NORMAL
- en: ‘**channels’, ‘id’, ‘offer_type’** columns are categorical whereas **‘difficulty’,
    ‘duration’, ‘reward’** are integer.
  prefs: []
  type: TYPE_NORMAL
- en: 'See below the modifications I have done on the dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: one-hot encode the ‘**channels’** and **‘offer_type’**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: change the ***‘id’*** with ***‘offer_id’***
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/84d6aa5e1e183234fb6e63caf0310839.png)'
  prefs: []
  type: TYPE_IMG
- en: Portfolio dataset (after data wrangling) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: '**Profile dataset**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The profile dataset contains demographic information about Starbucks customers.
  prefs: []
  type: TYPE_NORMAL
- en: '**age (int)** — age of the customer'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**became_member_on (int)** — date when customer created an app account'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**gender (str)** — gender of the customer (note some entries contain ‘O’ for
    other rather than M or F)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**id (str)** — customer id'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**income (float)** — customer’s income'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/3f847bffc9623af05c3382c319526485.png)'
  prefs: []
  type: TYPE_IMG
- en: Profile dataset (original) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: There are 17000 (number of unique person in the dataset) rows and 5 columns
    in this dataset with 2175 null items (both in ***gender*** and ***income*** columns).
    As age value is also 118 on these rows, I removed all 2175 rows from the dataset.
  prefs: []
  type: TYPE_NORMAL
- en: 'See below the modifications I have done on the dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: removing 2175 rows with missing value (also with age value of 118)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: change ***‘id’*** with ***‘customer_id’***
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***‘become_member_on’*** string to date conversion'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: creating ***‘year_joined’*** and ***‘membership_days’*** columns
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: on-hot encoding ***‘gender’***
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: creating ***‘age_group’*** to categorize the customers as **teenager, young-adult,
    adult, elderly**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: creating ***‘income_range’*** to categorize the customers as **average, above-average,
    high**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: creating ***‘member_type’*** to categorize the customers as **new, regular,
    loyal**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/3b7e4951f1ee40dec6d84b33a5695d47.png)'
  prefs: []
  type: TYPE_IMG
- en: Profile dataset (after data wrangling) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: It is seen that the number of people who joins the program has an increasing
    trend between the years of 2013 and 2017 with 2017 is the best year. %50 of the
    members are between the age of 42 and 66.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4ddff56138a6890a60cd6acd53931ddd.png)'
  prefs: []
  type: TYPE_IMG
- en: Histogram graphs of age, income, year_joined columns — Image by (author) Erdem
    Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: As it can be seen below, male population outnumbers female population in lower
    and average income zone, while female population outnumbers the male population
    in higher income zone.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/887e69b2078406bf5c5fc6c9664d3294.png)'
  prefs: []
  type: TYPE_IMG
- en: Histogram graphs of income shown separately in different gender groups— Image
    by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: When considering the gender, the dataset is a little bit biased, as number of
    male population outnumbers the female population and there is small number of
    people for the other category. Speaking with the exact figures; there are 8484
    males, 6129 females and only 212 others in the dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f58c61918c1df0a8383aa1ea36a2234c.png)'
  prefs: []
  type: TYPE_IMG
- en: Histogram graphs of gender — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: '**Transcript dataset**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The transcript dataset captures customer interactions with the offers.
  prefs: []
  type: TYPE_NORMAL
- en: '**event (str)** — record description (ie transaction, offer received, offer
    viewed, etc.)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**person (str)** — customer id'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**time (int)** — time in hours since start of test. The data begins at time
    t=0'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**value — (dict of strings)** — either an offer id or transaction amount depending
    on the record'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/7b2ca4ebba565a8a928cffa2ecf54130.png)'
  prefs: []
  type: TYPE_IMG
- en: Transcript dataset (original) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: If an event in the transcript dataset corresponds to one of the three possible
    offer statuses (viewed, received, or completed), the value column contains the
    ***id*** of the offer. In addition to offer id, there will be ***reward*** value
    in case the event is in ***‘offer completed’*** status.
  prefs: []
  type: TYPE_NORMAL
- en: However, if the event is **transaction**, the value column will display the
    **transaction amount** only.
  prefs: []
  type: TYPE_NORMAL
- en: 'See below the modifications I have done on the dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: Expanding the ***‘value’*** into***‘offer_id’***, ***‘amount’***, ***‘rewards’***
    new columns.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating ***‘time_in_days’*** by converting time (hours) to days.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Changing ***‘person’*** to ***‘customer_id’***
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Diving the **transcript** dataset into two sub-datasets as **offer_tr** (offer
    data)and **transaction_tr** (transactions data)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/f040fe4b285e5eb4c263ea442e4a3db7.png)'
  prefs: []
  type: TYPE_IMG
- en: offer_tr dataset (after data wrangling) — Image by (author) Erdem Isbilen
  prefs: []
  type: TYPE_NORMAL
- en: Building the Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once the datasets have been cleaned and necessary modifications have been done,
    we need to combine them into a single dataset. We will then create a new column
    called `offer_successful`. This column will indicate whether or not the offer
    was successful for a particular customer. **This will allow us to build models
    that can predict whether or not a certain offer will be successful for a particular
    type of customer.**
  prefs: []
  type: TYPE_NORMAL
- en: A customer must **view** and **complete** an offer **within the allowed time
    frame** in order for the offer to be considered **successful**.
  prefs: []
  type: TYPE_NORMAL
- en: The **complication I faced when developing the model** was not having a specific
    column in datasets stating whether the offer is successful or not for a specific
    customer. So I have developed a support function that calculates the target value
    by considering the data on offers which have been completed and viewed, as well
    as the time range between those events.
  prefs: []
  type: TYPE_NORMAL
- en: The successful and unsuccessful offers numbers are 35136 and the 31365 respectively.
    Means that we have a balanced dataset considering the target. So we do not have
    any limitation (which comes with un balanced datasets) regarding the models we
    can choose.
  prefs: []
  type: TYPE_NORMAL
- en: To create a model that can predict whether or not an offer will be successful,
    we will need to train a model on the final dataset.
  prefs: []
  type: TYPE_NORMAL
- en: As this is a binary classification problem, we will use three different supervised
    learning algorithms.
  prefs: []
  type: TYPE_NORMAL
- en: Logistic Regression
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Random Forest
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Gradient Boosting
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I will start building the models using the default settings of skit learn to
    understand the level of accuracy of the different model
  prefs: []
  type: TYPE_NORMAL
- en: Then, I will use **RandomizedSearchCV** with 12 iterations to optimize the hyperparameters
    of the models as it is less computationally expensive than the **GridSearchCV**.
    **RandomizedSearchCV** works by randomly sampling hyperparameter values from a
    specified distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Each of these models was trained on a training dataset and evaluated on a testing
    dataset to avoid overfitting and to see how the models would perform on unseen
    data.
  prefs: []
  type: TYPE_NORMAL
- en: Metrics and the Results
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I will be using the **confusion matrix** and the below metrics to assess the
    performance of the models.
  prefs: []
  type: TYPE_NORMAL
- en: I will be specifically focusing on the **precision** as the main purpose of
    the study is to define the positive classes as much as possible.
  prefs: []
  type: TYPE_NORMAL
- en: '**Accuracy:** Accuracy is the most common metric used to assess the accuracy
    of a classification model. It is calculated by dividing the number of correct
    predictions by the total number of predictions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Precision:** Precision is a measure of how accurate the model is when it
    predicts a positive class. It is calculated by dividing the number of true positives
    by the number of true positives plus the number of false positives.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Recall:** Recall is a measure of how complete the model is when it predicts
    a positive class. It is calculated by dividing the number of true positives by
    the number of true positives plus the number of false negatives.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**F1 score:** The F1 score is a weighted average of precision and recall. It
    is calculated by dividing 2 * (precision * recall) by (precision + recall).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Initial Accuracy metrics before fine tuning of the hyperparameters:**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/23dd6b832ed3e134c95b1701ac05d1e5.png)'
  prefs: []
  type: TYPE_IMG
- en: Model performances in tabular form — Image by author (Erdem Isbilen)
  prefs: []
  type: TYPE_NORMAL
- en: '**Results after fine tuning of the hyperparameters:**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/4474b05f8ff9b40d19b88fe8e86f8451.png)'
  prefs: []
  type: TYPE_IMG
- en: Model performances in tabular form - Image by author (Erdem Isbilen)
  prefs: []
  type: TYPE_NORMAL
- en: Although all models provide similar performance metrics, **Random Forest** has
    slightly better **accuracy**. It has been seen that fine tuning of the hyperparameters
    very little effect on the model performances. This can happen if the customized
    parameters we have chosen for tuning are worse than the default parameters. So
    we may consider to choose different sets of parameters to fine tune the model.
  prefs: []
  type: TYPE_NORMAL
- en: Justification
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As **random forest** and **gradient boosting** can better handle outliers and
    high dimensional data they perform better than logistic regression in our case.
  prefs: []
  type: TYPE_NORMAL
- en: '**Conclusion**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this project, I analysed the datasets provided by Starbucks and developed
    a model that can predict whether a customer will complete an offer or not.
  prefs: []
  type: TYPE_NORMAL
- en: I conducted an exploratory analysis of each dataset and visualized the data
    to gain a comprehensive understanding. This involved examining various aspects
    of the datasets. Following this, I proceeded with the pre-processing Part, which
    was the most time-consuming and challenging task. The dataset was complex, and
    the included data required the application of wrangling, engineering, and pre-processing
    techniques to obtain the final clean version of the three datasets.
  prefs: []
  type: TYPE_NORMAL
- en: Last step was to develop several binary classification models to make prediction.
    After model building was completed, test data was used to assess the performance
    of the models. It has been concluded that all three models provide similar performance
    results.
  prefs: []
  type: TYPE_NORMAL
- en: '**Improvements**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Although the models provide a good starting point, results with %66 precision
    have room for improvements.
  prefs: []
  type: TYPE_NORMAL
- en: One intriguing improvement for this project is to create multiple supervised
    learning models and combine them into a custom ensemble model. Creating an ensemble
    model by combining multiple supervised learning models offers the advantage of
    error compensation. By leveraging the strengths of different models and compensating
    for their weaknesses, the ensemble model achieves better generalization performance,
    leading to improved accuracy and robustness.
  prefs: []
  type: TYPE_NORMAL
- en: To enhance the accuracy of our reward program predictions, we could consider
    separating the different types of rewards and developing individual models for
    each program. By taking this approach, we can tailor our modelling techniques
    to the specific characteristics and goals of each reward program, ultimately leading
    to more precise predictions and better outcomes. This approach can also help us
    identify any unique trends or patterns within each reward program, leading to
    more effective program design and implementation.
  prefs: []
  type: TYPE_NORMAL
- en: Another way to optimize the effectiveness of our reward program is to identify
    and exclude individuals who buys regardless of the reward programs. By doing so,
    we can focus our resources on those who are more likely to positively impact the
    program’s outcomes, ultimately maximizing the benefits we gain from the program.
  prefs: []
  type: TYPE_NORMAL
- en: '**Reflection**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I found working on this capstone project to be a highly enjoyable experience
    that allowed me to refine my skills in data pre-processing and modelling. The
    data pre-processing step was the most prolonged and daunting task to complete.
    However, the dataset itself was inspiring, and it motivated me to continue working
    diligently.
  prefs: []
  type: TYPE_NORMAL

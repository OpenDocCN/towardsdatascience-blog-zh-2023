# Apache Iceberg è¡¨ä»‹ç»

> åŸæ–‡ï¼š[https://towardsdatascience.com/introduction-to-apache-iceberg-tables-a791f1758009](https://towardsdatascience.com/introduction-to-apache-iceberg-tables-a791f1758009)

## é€‰æ‹© Apache Iceberg ä½œä¸ºæ•°æ®æ¹–çš„å‡ ä¸ªä»¤äººä¿¡æœçš„ç†ç”±

[](https://mshakhomirov.medium.com/?source=post_page-----a791f1758009--------------------------------)[![ğŸ’¡Mike Shakhomirov](../Images/bc6895c7face3244d488feb97ba0f68e.png)](https://mshakhomirov.medium.com/?source=post_page-----a791f1758009--------------------------------)[](https://towardsdatascience.com/?source=post_page-----a791f1758009--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----a791f1758009--------------------------------) [ğŸ’¡Mike Shakhomirov](https://mshakhomirov.medium.com/?source=post_page-----a791f1758009--------------------------------)

Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----a791f1758009--------------------------------) Â·8 åˆ†é’Ÿé˜…è¯»Â·2023å¹´4æœˆ10æ—¥

--

![](../Images/8757d57a9e2fc3aae50cadf617507568.png)

ç”± [Annie Spratt](https://unsplash.com/@anniespratt?utm_source=medium&utm_medium=referral) æä¾›çš„ç…§ç‰‡ï¼Œæ¥æºäº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

**Apache Iceberg**ï¼šè¿™æ˜¯ä»€ä¹ˆï¼ŸApache Icebergâ€”â€”å®ƒæ˜¯æ–°çš„æ•°æ®æ¹–æ–‡ä»¶æ ¼å¼å—ï¼Ÿè¿˜æ˜¯è¡¨æ ¼æ ¼å¼ï¼Ÿå®ƒä¸ºä½•å¦‚æ­¤ä¼˜ç§€ï¼Ÿæ•°æ®æ¹–çš„æ—¶é—´æ—…è¡Œï¼Ÿ

æˆ‘å°†åœ¨è¿™ä¸ªæ•…äº‹ä¸­å°è¯•å›ç­”æ‰€æœ‰è¿™äº›é—®é¢˜ã€‚

> äº‹åŠ¡ä¸€è‡´çš„æ•°æ®æ¹–è¡¨ä»¥åŠæ—¶é—´ç‚¹å¿«ç…§éš”ç¦»æ˜¯æˆ‘ä»¬æ‰€éœ€çš„ä¸€åˆ‡ã€‚

é€‰æ‹©è¡¨æ ¼æ ¼å¼æ˜¯ä»»ä½•è¿½æ±‚æ•°æ®æ¹–æˆ–æ•°æ®ç½‘æ ¼ç­–ç•¥çš„äººéƒ½å¿…é¡»åšå‡ºçš„å…³é”®é€‰æ‹©ã€‚é€‰æ‹©æ•°æ®æ¹–å¹³å°æ—¶éœ€è¦è€ƒè™‘çš„ä¸€äº›é‡è¦åŠŸèƒ½åŒ…æ‹¬**æ¨¡å¼æ¼”å˜æ”¯æŒ**ã€**è¯»å†™æ—¶é—´**ã€**å¯æ‰©å±•æ€§**ï¼ˆæ•°æ®å¤„ç†æ˜¯å¦å¯ä»¥Hadoopåˆ†å‰²ï¼Ÿï¼‰ã€**å‹ç¼©**æ•ˆç‡ä»¥åŠ**æ—¶é—´æ—…è¡Œ**ç­‰ã€‚

æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©æ­£ç¡®çš„æ–‡ä»¶å’Œè¡¨æ ¼æ ¼å¼å°†å†³å®šä½ çš„æ•°æ®å¹³å°çš„é€Ÿåº¦å’Œæˆæœ¬æ•ˆç›Šã€‚

**Iceberg** æ˜¯ä¸€ç§***è¡¨æ ¼æ ¼å¼***ï¼Œå¼•æ“å’Œæ–‡ä»¶æ ¼å¼æ— å…³ã€‚Iceberg é€šå¸¸ä¸æ˜¯åƒ**Apache Hive**è¿™æ ·çš„æ—§æŠ€æœ¯çš„å¼€å‘ã€‚è¿™æ˜¯ä»¶å¥½äº‹ï¼Œå› ä¸ºä»æ—§æŠ€æœ¯ä¸­å¼€å‘å¯èƒ½ä¼šæœ‰å±€é™æ€§ã€‚ä¸€ä¸ªå¥½çš„ä¾‹å­æ˜¯æ¨¡å¼å¦‚ä½•éšæ—¶é—´å˜åŒ–ï¼Œè€ŒIcebergå¯ä»¥åƒé‡å‘½ååˆ—ä¸€æ ·ç®€å•åœ°å¤„ç†è¿™ç§å˜åŒ–ã€‚***å®ƒè¢«è®¾è®¡å¹¶è¯æ˜åœ¨å…¨çƒæœ€è‹›åˆ»çš„å·¥ä½œè´Ÿè½½ä¸­å¤§è§„æ¨¡çš„æ•°æ®æ¹–å¹³å°ä¸Šè¡¨ç°è‰¯å¥½ã€‚***

## è¶Šæ¥è¶Šå¤šçš„æ•°æ®å·¥å…·å¼€å§‹å¼•å…¥å†°å±±è¡¨çš„æ”¯æŒã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ AWS Athenaï¼ˆå¿…é¡»æ˜¯å¼•æ“ 3ï¼‰ä¸­è¿™æ ·åˆ›å»ºä¸€ä¸ª Apache Iceberg è¡¨ï¼š

è°·æ­Œçš„ BigQuery ç°åœ¨ä¹Ÿæ”¯æŒ Iceberg è¡¨ï¼š

## å†°å±±è¡¨å’Œæ•°æ®å¹³å°ç±»å‹

Netflix æœ€åˆåˆ›å»ºäº† Icebergï¼Œæœ€ç»ˆå®ƒå¾—åˆ°äº† Apache è½¯ä»¶åŸºé‡‘ä¼šçš„æ”¯æŒå’Œæèµ ã€‚ç°åœ¨ï¼ŒIceberg ç‹¬ç«‹å¼€å‘ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œå…¨éç›ˆåˆ©çš„å¼€æºé¡¹ç›®ï¼Œä¸“æ³¨äºå¤„ç†å¤æ‚çš„æ•°æ®å¹³å°æ¶æ„ã€‚

å®ƒæ”¯æŒå¤šç§å¤§æ•°æ®æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬ Apache Avroã€Apache Parquet å’Œ Apache ORCã€‚

åœ¨è®¾è®¡æ•°æ®å¹³å°æ—¶ï¼Œå°†æ•°æ®ä¿å­˜åœ¨æ•°æ®æ¹–ä¸­æ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚

> ç›¸æ¯”äºç°ä»£æ•°æ®ä»“åº“è§£å†³æ–¹æ¡ˆï¼Œå®ƒéœ€è¦çš„ç»´æŠ¤è¦å°‘å¾—å¤šã€‚

æ•°æ®æ¹–é€šå¸¸ç”¨äºå­˜å‚¨æ‰€æœ‰ç±»å‹çš„æ•°æ®â€”â€”ç»“æ„åŒ–å’Œéç»“æ„åŒ–â€”â€”æ— è®ºå¤§å°ã€‚æ•°æ®æ¹–ä¼ ç»Ÿä¸Šä¸ Apache Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆHDFSï¼‰è¿æ¥ã€‚ç„¶è€Œï¼Œç»„ç»‡è¶Šæ¥è¶Šå¤šåœ°ä½¿ç”¨å¯¹è±¡å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œå¦‚ Amazon S3ã€Google Cloud Storage æˆ– Microsoft Azure Data Lake Storageã€‚

> ç®€è€Œè¨€ä¹‹ï¼Œæ•°æ®æ¹–é€šè¿‡é›†ä¸­ç®¡ç†æ•°æ®æ¥ç®€åŒ–æ•°æ®ç®¡ç†ã€‚

ä¸æ­¤ç›¸åï¼Œå½“æ¯æ¬¡è®¿é—®éƒ½é€šè¿‡ä¸€ä¸ªå•ä¸€ç³»ç»Ÿï¼ˆæ•°æ®ä»“åº“ï¼‰è¿›è¡Œæ—¶ï¼Œå®ƒç®€åŒ–äº†å¹¶å‘ç®¡ç†å’Œæ›´æ–°ï¼Œä½†é™åˆ¶äº†çµæ´»æ€§å¹¶å¢åŠ äº†æˆæœ¬ã€‚æˆ‘ä¹‹å‰åœ¨è¿™é‡Œå†™è¿‡ï¼š

[](/data-platform-architecture-types-f255ac6e0b7?source=post_page-----a791f1758009--------------------------------) [## æ•°æ®å¹³å°æ¶æ„ç±»å‹

### å®ƒåœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ»¡è¶³äº†æ‚¨çš„ä¸šåŠ¡éœ€æ±‚ï¼Ÿé€‰æ‹©çš„å›°å¢ƒã€‚

towardsdatascience.com](/data-platform-architecture-types-f255ac6e0b7?source=post_page-----a791f1758009--------------------------------)

ä¸€åˆ‡éƒ½å¾ˆæ£’ï¼Œä½†åœ¨æ„å»ºæ•°æ®æ¹–æ•°æ®å¹³å°æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜ä¼šé‡åˆ°å…¶ä»–ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æ²¡æœ‰æ—¶é—´æ—…è¡Œã€æ²¡æœ‰æ¨¡å¼æ¼”å˜æ”¯æŒä»¥åŠæ•°æ®è½¬æ¢å’Œå®šä¹‰çš„å¤æ‚æ€§ã€‚

> å½“æˆ‘ä»¬æ„å»ºæ•°æ®æ¹–æ•°æ®å¹³å°æ—¶ï¼Œå¤–éƒ¨è¡¨é€šå¸¸ä¼šå¸¦æ¥ä¸è¯¥æ¶æ„ç›¸å…³çš„ä¸€æ•´å¥—ç¼ºç‚¹â€¦â€¦ä½† Iceberg æœ‰åŠ©äºè§£å†³è¿™äº›é—®é¢˜ã€‚

**ä¼ ç»Ÿå¤–éƒ¨è¡¨çš„ä¸€äº›å·²çŸ¥é™åˆ¶ï¼š**

+   ä¾‹å¦‚ï¼Œæˆ‘ä»¬**ä¸èƒ½é€šè¿‡ DML è¯­å¥ä¿®æ”¹å®ƒä»¬ï¼Œä¸”æ•°æ®ä¸€è‡´æ€§ä¸èƒ½å¾—åˆ°ä¿è¯**ã€‚è¯è™½å¦‚æ­¤ï¼Œå¦‚æœåœ¨å¤„ç†è¿‡ç¨‹ä¸­åº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°ä¸ä¸€è‡´çš„ç»“æœã€‚

+   ç°ä»£æ•°æ®ä»“åº“ä¸­é€šå¸¸æœ‰**æœ‰é™çš„å¹¶å‘æŸ¥è¯¢æ•°**ï¼Œä¾‹å¦‚ BigQuery ä¸­ä¸º 4ã€‚

+   å¤–éƒ¨è¡¨**ä¸æ”¯æŒé›†ç¾¤**ï¼Œä¹Ÿä¸å…è®¸ä»ä¸­å¯¼å‡ºæ•°æ®ã€‚

+   ä¸å…è®¸ä½¿ç”¨é€šé…ç¬¦å¼•ç”¨è¡¨åã€‚

+   **æ²¡æœ‰æ—¶é—´æ—…è¡ŒåŠŸèƒ½**

æ ¹æ®æˆ‘çš„ç»éªŒï¼Œæ•°æ®ä¸€è‡´æ€§æ˜¯å¤§è§„æ¨¡åˆ†ææ‰€éœ€çš„æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ã€‚Iceberg è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç°åœ¨å¤šä¸ªå¼•æ“ï¼ˆå¦‚ Sparkã€Hiveã€Prestoã€Dremio ç­‰ï¼‰å¯ä»¥åŒæ—¶æ“ä½œåŒä¸€å¼ è¡¨ã€‚

å®ƒè¿˜æä¾›äº†è®¸å¤šå…¶ä»–å‡ºè‰²çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å›æ»šåˆ°å…ˆå‰çš„è¡¨ç‰ˆæœ¬ï¼ˆä»¥æ‚„æ‚„è§£å†³é—®é¢˜ï¼‰ï¼Œä»¥åŠåœ¨å¤„ç†æµ·é‡æ•°æ®æ—¶çš„é«˜çº§æ•°æ®è¿‡æ»¤èƒ½åŠ›ã€‚

## æ•°æ®ä¸€è‡´æ€§å’Œæ”¹è¿›çš„å¤„ç†æ•ˆç‡

ä¸€ä¸ªå¥½çš„ä¾‹å­æ˜¯ï¼Œå½“ ETL è¿‡ç¨‹é€šè¿‡ä»å­˜å‚¨ä¸­æ·»åŠ å’Œåˆ é™¤æ–‡ä»¶æ¥ä¿®æ”¹æ•°æ®é›†æ—¶ï¼Œå¦ä¸€ä¸ªè¯»å–æ•°æ®é›†çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šå¤„ç†æ•°æ®é›†çš„éƒ¨åˆ†æˆ–ä¸ä¸€è‡´çš„è¡¨ç¤ºï¼Œä»è€Œäº§ç”Ÿä¸å‡†ç¡®çš„ç»“æœã€‚

Iceberg é€šå¸¸é€šè¿‡åˆ©ç”¨å¤§é‡æ¸…å•ï¼ˆå…ƒæ•°æ®ï¼‰æ–‡ä»¶æ¥ç¼“è§£è¿™äº›é£é™©ï¼Œä»¥ä¾¿åœ¨æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­è¿›è¡Œå¿«ç…§ã€‚å®ƒå°†æ•è·æ¨¡å¼å¹¶ç»´æŠ¤å¢é‡ï¼ŒåŒ…æ‹¬æ–‡ä»¶ä¿¡æ¯å’Œåˆ†åŒºæ•°æ®ï¼Œä»¥ä¿è¯ä¸€è‡´æ€§å’Œå®Œå…¨éš”ç¦»ã€‚

Iceberg è¿˜ä¼šè‡ªåŠ¨ä»¥å±‚æ¬¡ç»“æ„çš„æ–¹å¼æ’åˆ—å¿«ç…§å…ƒæ•°æ®ï¼Œè¿™ç¡®ä¿äº†å¿«é€Ÿé«˜æ•ˆçš„è¡¨æ ¼ä¿®æ”¹ï¼Œæ— éœ€é‡æ–°å®šä¹‰æ‰€æœ‰æ•°æ®é›†æ–‡ä»¶ï¼Œä»è€Œåœ¨æ•°æ®æ¹–è§„æ¨¡ä¸‹å®ç°æœ€ä½³æ€§èƒ½ã€‚

Iceberg æä¾› SQL å‘½ä»¤ï¼Œå…è®¸ä½ åˆå¹¶æ–°æ•°æ®ï¼ˆMERGEï¼‰ã€æ›´æ”¹æ—§è¡Œå’Œåˆ é™¤ç‰¹å®šè¡Œã€‚

Iceberg å¯ä»¥ç§¯æé‡å»ºæ•°æ®æ–‡ä»¶ä»¥æé«˜è¯»å–æ€§èƒ½ï¼Œæˆ–è€…ä½¿ç”¨åˆ é™¤å¢é‡åŠ å¿«æ›´æ–°é€Ÿåº¦ã€‚

ä¸€ä¸ªå¥½çš„åˆå¹¶ç¤ºä¾‹å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š

[//advanced-sql-techniques-for-beginners-211851a28488?source=post_page-----a791f1758009--------------------------------](//advanced-sql-techniques-for-beginners-211851a28488?source=post_page-----a791f1758009--------------------------------) [## åˆå­¦è€…çš„é«˜çº§ SQL æŠ€å·§

### åœ¨ 1 åˆ° 10 çš„èŒƒå›´å†…ï¼Œä½ çš„æ•°æ®ä»“åº“æŠ€èƒ½æœ‰å¤šå¥½ï¼Ÿ

[towardsdatascience.com](/advanced-sql-techniques-for-beginners-211851a28488?source=post_page-----a791f1758009--------------------------------)

å¦ä¸€ä¸ªå¯ä»¥åº”ç”¨äºä¸Šè¿° AWS Athena è¡¨æ ¼çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š

![](../Images/2ddfd9ebb83759959e340d702256c0e3.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›

## æ—¶é—´æ—…è¡ŒåŠŸèƒ½

ç°ä»£æ•°æ®ä»“åº“å…è®¸ä½ åœ¨æ•°æ®ä¸­è¿›è¡Œæ—¶é—´æ—…è¡Œï¼Œå³æˆ‘ä»¬å¯ä»¥è½¬åˆ°ç‰¹å®šçš„æ—¶é—´æˆ³ä»¥è·å–è¡¨æ ¼ä¸­çš„ç‰¹å®šæ•°æ®çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œåœ¨ Google Cloud BigQuery ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»¥ä¸‹ SQL æ¥å®ç°ï¼š

[PRE0]

> è¿™ä¹Ÿå¯èƒ½æ˜¯æ•°æ®æ¹–å¹³å°çš„ä¸€ä¸ªâ€œä¸é”™çš„é™„åŠ åŠŸèƒ½â€ã€‚

å¦‚æœä½ å›´ç»•æ–‡ä»¶è®¾è®¡æ•°æ®æ¶æ„ï¼Œä¾‹å¦‚ Apache ORC æˆ– Apache Parquetï¼Œä½ å°†å—ç›Šäºå®ç°çš„ç®€ä¾¿ï¼Œä½†ä½ ä¹Ÿä¼šé‡åˆ°ä¸Šè¿°æåˆ°çš„é—®é¢˜ã€‚æ—¶é—´æ—…è¡Œä¸è¢«æ”¯æŒã€‚æ¨¡å¼æ¼”å˜ä¸€ç›´æ˜¯ä¸ªé—®é¢˜ã€‚å½“å­—æ®µéšæ—¶é—´å˜åŒ–æ—¶å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒAVRO æ–‡ä»¶æ ¼å¼æ”¯æŒæ¨¡å¼æ¼”å˜ï¼Œæˆ‘ä¹‹å‰å†™è¿‡å…³äºå¤§æ•°æ®æ–‡ä»¶æ ¼å¼ä¼˜ç¼ºç‚¹çš„æ–‡ç« ï¼š

[//big-data-file-formats-explained-275876dc1fc9?source=post_page-----a791f1758009--------------------------------](//big-data-file-formats-explained-275876dc1fc9?source=post_page-----a791f1758009--------------------------------) [## å¤§æ•°æ®æ–‡ä»¶æ ¼å¼è¯¦è§£

### Parquet ä¸ ORC ä¸ AVRO ä¸ JSONã€‚è¯¥é€‰æ‹©å“ªä¸ªä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬ï¼Ÿ

[towardsdatascience.com](/big-data-file-formats-explained-275876dc1fc9?source=post_page-----a791f1758009--------------------------------)

> Iceberg å°†æ•´ä¸ªå†å²è®°å½•ä¿å­˜åœ¨ Iceberg è¡¨æ ¼æ ¼å¼ä¸­ï¼Œæ²¡æœ‰å­˜å‚¨ç³»ç»Ÿä¾èµ–ã€‚

Iceberg è¡¨æ ¼ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½• Iceberg å¿«ç…§æˆ–å†å²æ—¶é—´ç‚¹æŸ¥è¯¢è¿‡å»çš„çŠ¶æ€ï¼Œä»¥è·å¾—ä¸€è‡´çš„ç»“æœã€è¿›è¡Œæ¯”è¾ƒæˆ–å›æ»šä»¥ä¿®å¤é”™è¯¯ï¼Œå› ä¸ºå†å²çŠ¶æ€æ˜¯ä¸å¯å˜çš„ã€‚

[PRE1]

## æ¨¡å¼æ¼”è¿›æ”¯æŒ

æ•°æ®æ¹–æ–‡ä»¶ä»¥åŠå®ƒä»¬çš„æ¨¡å¼éšç€æ—¶é—´çš„æ¨ç§»å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™å¹¶ä¸æ˜¯ç§˜å¯†ã€‚ç°åœ¨åœ¨ Iceberg è¡¨ä¸­æ·»åŠ ä¸€åˆ—ä¸ä¼šè¿”å›â€œæ— æ•ˆâ€æ•°æ®ã€‚

åˆ—åå’Œé¡ºåºå¯ä»¥æ›´æ”¹ã€‚æœ€æ£’çš„æ˜¯ï¼Œæ¨¡å¼æ›´æ–°ä»ä¸éœ€è¦é‡å»ºä½ çš„è¡¨ã€‚

[PRE2]

Iceberg å…è®¸å°±åœ°ä¿®æ”¹è¡¨ï¼Œå¹¶ç¡®ä¿æ­£ç¡®æ€§ï¼Œå³æ·»åŠ çš„æ–°åˆ—æ°¸è¿œä¸ä¼šä»å…¶ä»–åˆ—ä¸­è¯»å–ç°æœ‰å€¼ã€‚å½“æ•°æ®é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä»…é€šè¿‡ SQL ä¿®æ”¹åˆ†åŒºå¸ƒå±€æˆ–æ›´æ”¹è¡¨æ¨¡å¼ï¼Œå³ä½¿æ˜¯åµŒå¥—ç»“æ„ã€‚

[PRE3]

è¿™å°±æ˜¯ Iceberg æ‰€è°“çš„åˆ†åŒºæ¼”è¿›ã€‚

> å½“ä½ ä¿®æ”¹åˆ†åŒºè§„èŒƒæ—¶ï¼Œä½¿ç”¨æ—©æœŸè§„èŒƒå†™å…¥çš„ç°æœ‰æ•°æ®ä¸ä¼šå—åˆ°å½±å“ã€‚

æ¯ä¸ªåˆ†åŒºç‰ˆæœ¬çš„å…ƒæ•°æ®è¢«å•ç‹¬ä¿å­˜ã€‚Iceberg ä¸éœ€è¦æ˜‚è´µçš„æ“ä½œï¼Œä¾‹å¦‚é‡å†™è¡¨æ•°æ®æˆ–è¿ç§»åˆ°æ–°è¡¨ã€‚

## æ”¹è¿›çš„åˆ†åŒº

åœ¨ Iceberg ä¸­ï¼Œè¿™è¢«ç§°ä¸ºâ€œéšè—åˆ†åŒºâ€ã€‚ä¼ ç»Ÿçš„æ•°æ®æ¹–åˆ†åŒºæ–¹å¼ç§°ä¸ºâ€œHive åˆ†åŒºå¸ƒå±€â€ã€‚

è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªåœ¨ BigQuery ä¸­å…·æœ‰ Hive åˆ†åŒºå¸ƒå±€çš„å¤–éƒ¨è¡¨ï¼š

[PRE4]

åœ¨ Hive ä¸­ï¼Œåˆ†åŒºå¿…é¡»æ˜¯æ˜ç¡®çš„ï¼Œå¹¶ä¸”æ˜¾ç¤ºä¸ºåˆ—ï¼Œå› æ­¤ `**user_transactions**` è¡¨å°†åŒ…å«ä¸€ä¸ª `**dt**` æ—¥æœŸåˆ—ã€‚è¿™æ„å‘³ç€å¯¹æˆ‘ä»¬è¡¨è¿›è¡Œæ“ä½œçš„æ‰€æœ‰ SQL æŸ¥è¯¢éƒ½å¿…é¡»é™¤äº† `**timestamp**` è¿‡æ»¤å™¨å¤–ï¼Œè¿˜è¦æœ‰ `**dt**` è¿‡æ»¤å™¨ã€‚

> Hive éœ€è¦åˆ†åŒºå€¼ã€‚å®ƒä¸äº†è§£äº‹åŠ¡æ—¶é—´æˆ³å’Œæˆ‘ä»¬è¡¨ä¸­çš„ `dt` ä¹‹é—´çš„è”ç³»ã€‚

**ç›¸å**ï¼ŒIceberg é€šè¿‡å–åˆ—å€¼å¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œä¿®æ”¹æ¥ç”Ÿæˆåˆ†åŒºå€¼ã€‚Iceberg è´Ÿè´£å°†äº‹åŠ¡**`timestamp`** è½¬æ¢ä¸º `**dt**` å¹¶ç»´æŠ¤è¿æ¥ã€‚Iceberg å¯èƒ½ä¼šéšè—åˆ†åŒºï¼Œå› ä¸ºå®ƒä¸éœ€è¦ç”¨æˆ·ç»´æŠ¤åˆ†åŒºåˆ—ã€‚

åˆ†åŒºå€¼æ€»æ˜¯è¢«é€‚å½“åœ°åˆ›å»ºå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ç”¨äºåŠ é€ŸæŸ¥è¯¢ã€‚

> `dt` å¯¹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½æ˜¯ä¸å¯è§çš„ï¼ŒæŸ¥è¯¢ä¸å†ä¾èµ–äºæˆ‘ä»¬è¡¨çš„å®é™…ç‰©ç†å¸ƒå±€ã€‚

å®ƒæœ‰åŠ©äºé¿å…åœ¨è½¬æ¢æ•°æ®æ—¶å‡ºç°åˆ†åŒºé”™è¯¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨é”™è¯¯çš„æ—¥æœŸæ ¼å¼ï¼Œå¯¼è‡´ä¸æ­£ç¡®çš„åˆ†åŒºï¼Œè€Œä¸æ˜¯å¤±è´¥ï¼š`**20230101**` ä»£æ›¿ `**2023â€“01â€“01**`ã€‚***è¿™æ˜¯ Hive åˆ†åŒºå¸ƒå±€ä¸­ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥ä¸”æœ€å¸¸è§çš„é—®é¢˜ã€‚*** å¦ä¸€ä¸ª Iceberg æœ‰åŠ©äºè§£å†³çš„é—®é¢˜æ˜¯ï¼Œåœ¨ Hive åˆ†åŒºå¸ƒå±€ä¸­ï¼Œæ‰€æœ‰å·¥ä½œçš„æŸ¥è¯¢éƒ½ä¸è¡¨çš„åˆ†åŒºæ–¹æ¡ˆç›¸å…³ï¼Œå› æ­¤æ›´æ”¹åˆ†åŒºè®¾ç½®å°†ä¼šç ´åæŸ¥è¯¢ã€‚

## ç»“è®º

å…³ç³»å‹æ•°æ®åº“å’Œæ•°æ®ä»“åº“éƒ½æ”¯æŒåŸå­äº‹åŠ¡å’Œæ—¶é—´æ—…è¡Œï¼Œä½†å®ƒä»¬ä»¥å…¶ä¸“æœ‰çš„æ–¹å¼å®ç°ã€‚Iceberg ä½œä¸ºä¸€ä¸ª Apache é¡¹ç›®ï¼Œæ˜¯å®Œå…¨å¼€æºçš„ï¼Œä¸ä¾èµ–äºä»»ä½•ç‰¹å®šçš„å·¥å…·æˆ–æ•°æ®æ¹–å¼•æ“ã€‚

Iceberg æ”¯æŒè¡Œä¸šæ ‡å‡†æ–‡ä»¶æ ¼å¼å¦‚ Parquetã€ORC å’Œ Avroï¼Œå¹¶ä¸”ä¸ Dremioã€Sparkã€Hive å’Œ Presto ç­‰å…³é”®æ•°æ®æ¹–å¼•æ“å…¼å®¹ã€‚å…¶å¹¿æ³›çš„ç¤¾åŒºåˆä½œç”Ÿæˆæ–°æƒ³æ³•ï¼Œå¹¶æä¾›é•¿æœŸçš„å¸®åŠ©ã€‚å®ƒæ‹¥æœ‰å„ç§æ´»è·ƒçš„ç¤¾åŒºï¼Œä¾‹å¦‚å…¬å…± Slack é¢‘é“ï¼Œä»»ä½•äººéƒ½å¯ä»¥è‡ªç”±å‚ä¸ã€‚å®ƒç»è¿‡è®¾è®¡å¹¶è¯æ˜åœ¨å…¨çƒæœ€å¤§å·¥ä½œè´Ÿè½½å’Œç¯å¢ƒä¸­çš„æ•°æ®æ¹–å¹³å°ä¸Šè¡¨ç°å‡ºè‰²ã€‚

ç»„ç»‡ç°åœ¨å¯ä»¥é€šè¿‡åˆ©ç”¨ Iceberg å……åˆ†å‘æŒ¥æ•°æ®æ¹–æ¶æ„çš„æ½œåŠ›å’Œä¼˜åŠ¿ã€‚ä½“éªŒåŸºäºäº‘å­˜å‚¨çš„æ•°æ®å¹³å°çš„æˆæœ¬æ•ˆç›Šï¼ŒåŒæ—¶æ— éœ€ç‰ºç‰²ä¼ ç»Ÿæ•°æ®åº“å’Œæ•°æ®ä»“åº“è§£å†³æ–¹æ¡ˆçš„åŠŸèƒ½å’Œèƒ½åŠ›ã€‚

> å®ƒä½¿æˆ‘ä»¬çš„æ•°æ®æ¹–å¹³å°çœŸæ­£çµæ´»ä¸”å¯é 

**æ€»ç»“ä¸€ä¸‹ï¼ŒIceberg è¡¨æ ¼æ ¼å¼çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š**

+   å¤šä¸ªç‹¬ç«‹ç¨‹åºå¯ä»¥åŒæ—¶ä¸€è‡´åœ°å¤„ç†ç›¸åŒçš„æ•°æ®é›†ã€‚

+   æ”¹è¿›çš„æ•°æ®å¤„ç†å’Œæ•°æ®å¯é æ€§ï¼ˆé’ˆå¯¹éå¸¸å¤§çš„æ•°æ®æ¹–è§„æ¨¡è¡¨æ ¼çš„æ›´æ–°æ›´åŠ é«˜æ•ˆï¼‰ã€‚

+   éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ”¹è¿›çš„æ¨¡å¼å¤„ç†ã€‚

+   ETL ç®¡é“å¤§å¤§ç®€åŒ–ï¼ˆé€šè¿‡å¯¹æ•°æ®æ¹–ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯åœ¨å¤šä¸ªç‹¬ç«‹ç³»ç»Ÿä¹‹é—´ä¼ è¾“æ•°æ®ï¼‰ã€‚

## æ¨èé˜…è¯»ï¼š

1\. [https://cloud.google.com/bigquery/docs/time-travel](https://cloud.google.com/bigquery/docs/time-travel)

2\. [https://www.apache.org/](https://www.apache.org/)

3\. [https://hive.apache.org/](https://hive.apache.org/)

4\. [https://iceberg.apache.org/community/](https://iceberg.apache.org/community/)

5\. [https://cloud.google.com/bigquery/docs/iceberg-tables](https://cloud.google.com/bigquery/docs/iceberg-tables)

6\. [https://medium.com/towards-data-science/data-platform-architecture-types-f255ac6e0b7](https://medium.com/towards-data-science/data-platform-architecture-types-f255ac6e0b7)

7\. [https://medium.com/towards-data-science/big-data-file-formats-explained-275876dc1fc9](https://medium.com/towards-data-science/big-data-file-formats-explained-275876dc1fc9)

8\. [https://iceberg.apache.org/docs/latest/evolution/](https://iceberg.apache.org/docs/latest/evolution/)

9\. [https://iceberg.apache.org/docs/latest/partitioning/#icebergs-hidden-partitioning](https://iceberg.apache.org/docs/latest/partitioning/#icebergs-hidden-partitioning)

10\. [https://cloud.google.com/bigquery/docs/external-data-cloud-storage#sql](https://cloud.google.com/bigquery/docs/external-data-cloud-storage#sql)

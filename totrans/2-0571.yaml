- en: 'Copulas: An Essential Guide & Applications in Time Series Forecasting'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Copulas：时间序列预测中的基本指南与应用
- en: 原文：[https://towardsdatascience.com/copulas-an-essential-guide-applications-in-time-series-forecasting-f5c93dcd6e99](https://towardsdatascience.com/copulas-an-essential-guide-applications-in-time-series-forecasting-f5c93dcd6e99)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/copulas-an-essential-guide-applications-in-time-series-forecasting-f5c93dcd6e99](https://towardsdatascience.com/copulas-an-essential-guide-applications-in-time-series-forecasting-f5c93dcd6e99)
- en: What are copula functions and why do we need them
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 什么是copula函数，我们为什么需要它们
- en: '[](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)[![Nikos
    Kafritsas](../Images/de965cfcd8fbd8e1baf849017d365cbb.png)](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)
    [Nikos Kafritsas](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)[![Nikos
    Kafritsas](../Images/de965cfcd8fbd8e1baf849017d365cbb.png)](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)
    [Nikos Kafritsas](https://medium.com/@nikoskafritsas?source=post_page-----f5c93dcd6e99--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)
    ·14 min read·Mar 6, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于[数据科学前沿](https://towardsdatascience.com/?source=post_page-----f5c93dcd6e99--------------------------------)
    ·阅读时间14分钟·2023年3月6日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/6961adaebffc5f8815c5d29ac5619b81.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6961adaebffc5f8815c5d29ac5619b81.png)'
- en: A 3D Gaussian Copula (Image by Author)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 3D高斯copula（图由作者提供）
- en: Copulas are functions that model the dependency among several distributions.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: Copulas是建模多个分布之间依赖关系的函数。
- en: They are mostly used in financial applications like portfolio risk assessment
    and hedge fund management. They came to prominence in 2008, when it was discovered
    that quantitative scientists had misused copulas in their calculations, [failing
    to predict significant events.](http://samueldwatts.com/wp-content/uploads/2016/08/Watts-Gaussian-Copula_Financial_Crisis.pdf)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 它们主要用于金融应用，如投资组合风险评估和对冲基金管理。它们在2008年声名鹊起，当时发现定量科学家在计算中误用copulas，导致[未能预测重大事件](http://samueldwatts.com/wp-content/uploads/2016/08/Watts-Gaussian-Copula_Financial_Crisis.pdf)。
- en: Nonetheless, copulas are still great mathematical tools. One compelling reason
    for studying copulas is that they find numerous applications in **Time-Series
    Forecasting** models.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，copulas仍然是很棒的数学工具。研究copulas的一个有力理由是它们在**时间序列预测**模型中有着广泛的应用。
- en: In the past few years, many **Deep Learning Forecasting** models started incorporating
    statistical concepts in their architecture. This is good because the community
    is moving from the traditional “*stacking transformer blocks with attention”*
    approach to using *elegant statistical techniques.*
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去几年里，许多**深度学习预测**模型开始将统计学概念融入其架构中。这是件好事，因为社区正在从传统的“*堆叠变换器块与注意力*”方法转向使用*优雅的统计技术*。
- en: 'In this article, we discuss:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们讨论：
- en: Some introductory concepts in statistics.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些统计学的入门概念。
- en: Why copulas are useful.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么copulas有用。
- en: How to create Gaussian copulas in Python.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在Python中创建高斯copulas。
- en: Modern Deep Learning models that use copulas for Time-Series Forecasting.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用copulas进行时间序列预测的现代深度学习模型。
- en: Let’s dive in.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入了解。
- en: I’ve launched [**AI Horizon Forecast**](https://aihorizonforecast.substack.com/)**,**
    a newsletter focusing on time-series and innovative AI research. Subscribe [here](https://aihorizonforecast.substack.com/)
    to broaden your horizons!
  id: totrans-18
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 我推出了[**AI Horizon Forecast**](https://aihorizonforecast.substack.com/)**，**这是一个专注于时间序列和创新AI研究的新闻通讯。订阅[这里](https://aihorizonforecast.substack.com/)以拓宽你的视野！
- en: Introductory concepts — Optional
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入门概念 — 可选
- en: 'If the following terms:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果以下术语：
- en: '[Probability Integral Transform](https://en.wikipedia.org/wiki/Probability_integral_transform)'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[概率积分变换](https://en.wikipedia.org/wiki/Probability_integral_transform)'
- en: '[Inverse sampling](https://en.wikipedia.org/wiki/Inverse_transform_sampling)'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[逆采样](https://en.wikipedia.org/wiki/Inverse_transform_sampling)'
- en: '[Empirical Cumulative Distribution Function](https://en.wikipedia.org/wiki/Empirical_distribution_function)'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[经验累积分布函数](https://en.wikipedia.org/wiki/Empirical_distribution_function)'
- en: are unknown to you, I suggest reading this section too.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 对你来说可能是未知的，我建议你也阅读这一部分。
- en: Copulas are easy to understand, but they may intimidate you at first if you
    are not familiar with the above concepts.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Copulas 很容易理解，但如果你不熟悉上述概念，可能一开始会让你感到困惑。
- en: '**Probability integral transform** Assume we have a continuous random variable
    `X`**.**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**概率积分变换** 假设我们有一个连续随机变量 `X`**。'
- en: 'Then, the **CDF** (*cumulative distribution function*) of `X`, called `F_x`,
    generates a **uniform** random variable `U` . Specifically:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，`X` 的 **CDF** (*累积分布函数*)，称为 `F_x`，生成一个 **均匀** 随机变量 `U`。具体来说：
- en: '![](../Images/0bab32265506302f05fb5737ccd5ab40.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0bab32265506302f05fb5737ccd5ab40.png)'
- en: The technique says we can transform any continuous random variable into a uniform.
    We will later visually demonstrate how all these techniques work.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 该技术表明我们可以将任何连续随机变量转换为均匀分布。稍后我们将通过可视化演示这些技术如何工作。
- en: '**Inverse sampling** Have you ever wondered how distribution generator functions
    like `rnorm()` in R and `np.random.randn()` in Python generate samples?'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**反向采样** 你是否曾经想过像 R 语言中的 `rnorm()` 和 Python 中的 `np.random.randn()` 这样的分布生成函数是如何生成样本的？'
- en: They use sampling techniques, one of which is called *inverse sampling*. There
    are numerous sampling techniques — some are more sophisticated and faster than
    *inverse sampling*.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 他们使用采样技术，其中一种被称为 *反向采样*。有许多采样技术——一些比 *反向采样* 更复杂和更快速。
- en: '*Inverse sampling* is simply the inverse of the *probability integral transform*
    theorem. Given the uniform samples we generated earlier, we can pass them through
    the **inverse cumulative distribution function** of the original rv `X`, symbolized
    as `F(x)^(-1)`, to get back the original `X` distribution. Specifically:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*反向采样* 只是 *概率积分变换* 定理的逆。给定我们之前生成的均匀样本，我们可以通过原始随机变量 `X` 的 **逆累积分布函数**，用符号 `F(x)^(-1)`
    表示，来得到原始 `X` 分布。具体来说：'
- en: '![](../Images/0e6daec2fe7ccb0ef2a6d0e3f52ec59e.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0e6daec2fe7ccb0ef2a6d0e3f52ec59e.png)'
- en: 'Both techniques use the CDF:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 两种技术都使用 CDF：
- en: '**Probability integral transform** uses the **CDF** to convert our samples
    from `[a,b]`->`[0,1]`, (where `[a,b]` is the function’s domain).'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**概率积分变换** 使用 **CDF** 将我们的样本从 `[a,b]`->`[0,1]` 转换，（其中 `[a,b]` 是函数的定义域）。'
- en: '**Inverse sampling** uses the **inverse CDF** to convert back our uniform samples
    to the function’s original samples: `[0,1]`->`[a,b]`.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**反向采样** 使用 **逆 CDF** 将我们的均匀样本转换回函数的原始样本：`[0,1]`->`[a,b]`。'
- en: '**Figure 1** displays with more clarity how both techniques work:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 1** 更清楚地展示了这两种技术的工作原理：'
- en: '![](../Images/36bffce4264c1e774bc4f861a9eb78c7.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/36bffce4264c1e774bc4f861a9eb78c7.png)'
- en: '**Figure 1:** The red line is the **probability integral transform**, and the
    blue line is the i**nverse sampling** (Image by author)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 1：** 红色线是 **概率积分变换**，蓝色线是 *反向采样*（图片由作者提供）'
- en: 'Now, I will demonstrate how these techniques work with a few plots in Python.
    Our plan is the following:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我将通过 Python 中的几个图表演示这些技术是如何工作的。我们的计划如下：
- en: Generate samples from a beta distribution **B**~(10,3).
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 beta 分布 **B**~(10,3) 生成样本。
- en: Use the *probability integral transform* to create uniform samples from the
    beta distribution.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 *概率积分变换* 从 beta 分布创建均匀样本。
- en: Use *inverse sampling* to recreate the original beta samples(10,3) from the
    uniform samples in **step 2**.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 *反向采样* 从 **第 2 步** 的均匀样本中重建原始 beta 样本(10,3)。
- en: '[PRE0]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/a55bf52ef2ac636c754ac9aaaaef3114.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a55bf52ef2ac636c754ac9aaaaef3114.png)'
- en: '**Figure 2:** (Top) The original beta distribution, (Center) The uniform samples
    from the cdf of beta, (Bottom) The transformed beta distribution (Image by author)'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 2：**（顶部）原始 beta 分布，（中间）beta 的 CDF 均匀样本，（底部）变换后的 beta 分布（图片由作者提供）'
- en: Hence, we returned to our original distribution. You can also experiment with
    other continuous variables.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们回到了原始分布。你也可以尝试其他连续变量。
- en: 'Let’s try a gamma distribution. We leave everything as-is, except for switching
    beta with gamma:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试 gamma 分布。我们保持其他不变，只是将 beta 替换为 gamma：
- en: '[PRE1]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/35568a001c89412c32970c748cc01468.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/35568a001c89412c32970c748cc01468.png)'
- en: '**Figure 3:** (Top) The original gamma distribution, (Center) The uniform samples
    from the cdf of gamma, (Bottom) The transformed gamma distribution (Image by author)'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 3：**（顶部）原始 gamma 分布，（中间）gamma 的 CDF 均匀样本，（底部）变换后的 gamma 分布（图片由作者提供）'
- en: '**Notes:**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意事项：**'
- en: If you use more samples, the plots will better approximate the original distributions.
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你使用更多的样本，图形将更好地逼近原始分布。
- en: '*Inverse sampling* does not work with all distributions — e.g. because their
    inverse CDF is not well-defined (such as in bivariate distributions). There, we
    use other sampling methods such as [Metropolis-Hastings Monte Carlo](https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm)
    and so on.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*逆采样*并不适用于所有分布——例如，因为它们的逆CDF未明确定义（如在二元分布中）。在这种情况下，我们使用其他采样方法，如[Metropolis-Hastings
    Monte Carlo](https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm)等。'
- en: 'If you prefer **R**, here is the example using the gamma distribution:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你更喜欢**R**，这是一个使用伽马分布的示例：
- en: '[PRE2]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/4e57b45d1cd28aa3e918d50ca24dd0c4.png)![](../Images/77d06433d921db40c20cac19ed5254b9.png)![](../Images/495a74c0c0833f35939d2c38482a35c0.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4e57b45d1cd28aa3e918d50ca24dd0c4.png)![](../Images/77d06433d921db40c20cac19ed5254b9.png)![](../Images/495a74c0c0833f35939d2c38482a35c0.png)'
- en: '**Figure 4:** (Left) The original gamma distribution, (Center) The uniform
    samples from the cdf of gamma, (Right) The transformed gamma distribution (Image
    by author)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**图4：**（左）原始伽马分布，（中）伽马分布累积分布函数的均匀样本，（右）变换后的伽马分布（图像作者提供）'
- en: Again, we get the same results.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们得到相同的结果。
- en: '**Empirical distribution function**'
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**经验分布函数**'
- en: Usually, the original distribution of our data is unknown.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，我们数据的原始分布是未知的。
- en: Or, we want to build a distribution-agnostic model that does not make assumptions
    about the underlying data.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们想建立一个不依赖于分布的模型，不对基础数据做假设。
- en: In that case, the empirical distribution comes handy. It is a powerful and simple
    method that provides a **non-parametric** estimate of a population’s cumulative
    distribution function (CDF).
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，经验分布显得很有用。它是一种强大且简单的方法，提供了**非参数**的总体累积分布函数（CDF）估计。
- en: 'Thus, we can estimate our data’s CDF regardless of their underlying distribution.
    It is defined as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以估计数据的CDF，而不管其基础分布如何。它定义如下：
- en: 'Let `X_1`, `X_2`, …, `X_n` be a sample of size `n` from a population with CDF
    `F(x)`. Then the **empirical CDF** `F_n(x)` is defined as:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 设`X_1`、`X_2`、…、`X_n`为来自具有CDF `F(x)`的总体的样本，样本大小为`n`。那么**经验CDF** `F_n(x)`定义为：
- en: '![](../Images/04c62b804782dcdd21411af58191a544.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/04c62b804782dcdd21411af58191a544.png)'
- en: 'If that formula confuses you, here’s a more intuitive explanation:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果那个公式让你困惑，这里有一个更直观的解释：
- en: Take `N` samples from an unknown distribution.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从一个未知分布中取`N`个样本。
- en: Sort these samples, and place them on the x-axis.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对这些样本进行排序，并将它们放在x轴上。
- en: Start plotting a ‘step-function’ style line — each time you encounter a datapoint
    on the x-axis, increase the step by `1/N`.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开始绘制一个‘阶梯函数’风格的线——每当你在x轴上遇到一个数据点时，将阶梯增加`1/N`。
- en: For the sake of clarity, that process is documented in **Figure 5:**
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 为了清楚起见，这个过程记录在**图5：**
- en: '![](../Images/0d5e96e76f9c8f891226ea4338233cad.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0d5e96e76f9c8f891226ea4338233cad.png)'
- en: '**Figure 5:** The CDF of a normal distribution (green) and its empirical CDF
    (blue) (Source: [1] )'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**图5：** 正态分布的累积分布函数（绿色）及其经验累积分布函数（蓝色）（来源：[1]）'
- en: The more samples you take, the closer the empirical distribution will resemble
    the true distribution. The [Kolmogorov-Smirnov test](https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test)
    does exactly that.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 你取的样本越多，经验分布就会越接近真实分布。[Kolmogorov-Smirnov检验](https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test)正是这样做的。
- en: Specifically, this test determines the distribution of your unknown data sample
    by constructing and comparing the sample’s *empirical CDF* with the *CDF* you
    hypothesized. If the two CDFs are close, your unknown data sample likely follows
    the hypothesized distribution.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 具体来说，这个测试通过构建和比较样本的*经验CDF*与假设的*CDF*来确定你的未知数据样本的分布。如果两个CDF接近，你的未知数据样本可能符合假设的分布。
- en: 'Next, in this article, we will use the empirical CDFs slightly differently:
    To create copulas from data originating from an unknown population.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，在本文中，我们将略微不同地使用经验CDF：从来自未知总体的数据中创建copulas。
- en: Copulas
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Copulas
- en: Before presenting the maths of copulas, we first discuss why we need them.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在介绍copulas的数学之前，我们首先讨论为什么我们需要它们。
- en: Why do we need copulas?
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 我们为什么需要copulas？
- en: Let’s say we have a collection of random variables. Each random variable reflects
    a different ‘*entity*’ among a collection, e.g.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一组随机变量。每个随机变量在集合中反映了不同的‘*实体*’，例如
- en: The securities of a portfolio.
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个投资组合中的证券。
- en: The sales numbers of a store’s products.
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一家商店产品的销售数字。
- en: The electrical energy consumption patterns of various households.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 各家庭的电能消耗模式。
- en: '**Challenge 1:** What mathematical concept can we use to explain those entities?'
  id: totrans-84
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**挑战 1：** 我们可以用什么数学概念来解释这些实体？'
- en: We can use a **multivariate distribution** — one that optimally describes our
    data.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 **多变量分布** — 一种最优地描述我们数据的分布。
- en: '**Challenge 2:** What if I tell you that these entities are **not** of the
    same distribution?'
  id: totrans-86
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**挑战 2：** 如果我告诉你这些实体 **不是** 相同分布的呢？'
- en: If each entity has a different behavior, we **cannot** assume they follow the
    same distribution.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果每个实体有不同的行为，我们 **不能** 假设它们遵循相同的分布。
- en: 'And most importantly, each entity is likely to influence the others — we **cannot**
    assume they are independent. Take *product cannibalization*, for example: In retail,
    a successful product pulls demand away from similar items in its category.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最重要的是，每个实体可能会影响其他实体 — 我们 **不能** 假设它们是独立的。以 *产品自相残杀* 为例：在零售中，一款成功的产品会从其类别中的类似商品中抢走需求。
- en: Hence, each *entity* may have a different distribution. Plus, we should find
    a way to model their correlation, since independence is seldom feasible in most
    practical scenarios.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，每个 *实体* 可能有不同的分布。此外，我们还应该找到一种方法来建模它们的相关性，因为在大多数实际场景中，独立性通常不可行。
- en: We can solve both of these challenges using **copulas**.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以用 **连结函数** 来解决这两个挑战。
- en: Copulas
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连结函数
- en: 'Let’s say we have a random vector `**z**` **.** You can think of a random vector
    as a collection of random variables:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一个随机向量 `**z**` **。** 你可以把随机向量看作是随机变量的集合：
- en: '![](../Images/664fdec17126ab7f2f266ca7fcf9a9f6.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/664fdec17126ab7f2f266ca7fcf9a9f6.png)'
- en: 'Next, let `F_j` be the marginal CDF of `z_j` for `j ∈ [1,N]`. Using the *probability
    integral transform* from earlier, we have:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，设 `F_j` 为 `z_j` 的边际 CDF，`j ∈ [1,N]`。利用之前的 *概率积分变换*，我们得到：
- en: '![](../Images/bf4008ee75a0d45b58dbf0ce438b3dfb.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bf4008ee75a0d45b58dbf0ce438b3dfb.png)'
- en: 'Then, we define a copula `**C** : [0,1] → [0,1]^N` the joint CDF of `[u_1,
    u_2, … u_N]` :'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '然后，我们定义一个连结函数 `**C** : [0,1] → [0,1]^N` 作为 `[u_1, u_2, … u_N]` 的联合 CDF：'
- en: '![](../Images/9e0830901e6ed37c917f22dfa1524239.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9e0830901e6ed37c917f22dfa1524239.png)'
- en: 'And that’s the definition of the copula. Or, in plain English:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是连结函数的定义。或者，用简单的英语说：
- en: A copula is just a multivariate CDF of multiple random variables with uniform
    marginals U~[0,1]
  id: totrans-99
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 连结函数只是多个随机变量的多变量 CDF，具有均匀边际 U~[0,1]
- en: 'Notice the function’s **domain** and **range** of values: For example, a copula
    with two variables has a domain of [0,1]² and a range of [0,1]. Don’t worry if
    you are confused, I will later explain in detail how to plot a copula.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 注意函数的 **定义域** 和 **值域**：例如，一个有两个变量的连结函数定义域是 [0,1]²，值域是 [0,1]。如果你感到困惑，不用担心，我会稍后详细解释如何绘制连结函数。
- en: 'Let’s write the copula function for more clarity:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更清晰地说明，我们写出连结函数：
- en: '![](../Images/628d53a78c3e9c8beba51ab47be785d8.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/628d53a78c3e9c8beba51ab47be785d8.png)'
- en: Moreover, the biggest advantage of copulas is that any CDF `**F(z)**` can be
    written using a copula function `**C**` and its marginals `F_j` .This is also
    known as ***Sklar’s theorem:***
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，连结函数的最大优势在于任何 CDF `**F(z)**` 都可以用连结函数 `**C**` 及其边际 `F_j` 表示。这也被称为 ***斯克拉尔定理：***
- en: '![](../Images/c88bf19a2118458125b904a34e265bbf.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c88bf19a2118458125b904a34e265bbf.png)'
- en: Hence, **we can express any CDF function using a copula**. Note the second line
    where we used the *probability integral transform.*
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，**我们可以使用连结函数表示任何 CDF 函数**。注意第二行，我们使用了 *概率积分变换*。
- en: Gaussian copulas
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高斯连结函数
- en: '*Sklar’s theorem* is extremely useful. Let’s try to represent a multivariate
    Gaussian distribution. In other words, **we will create a Gaussian Copula.**'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '*斯克拉尔定理* 非常有用。我们尝试表示一个多变量高斯分布。换句话说，**我们将创建一个高斯连结函数**。'
- en: To make things simple, we will create a **bivariate** Gaussian Copula (`N =
    2`)
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简单起见，我们将创建一个 **二元** 高斯连结函数 (`N = 2`)
- en: First, consider a bivariate Gaussian distribution of 2 random variables, `[Z_1,
    Z_2]`**.**
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，考虑一个二元高斯分布 `[Z_1, Z_2]`**。**
- en: '![](../Images/ada024ed7e796b52bf621ec5925969c2.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ada024ed7e796b52bf621ec5925969c2.png)'
- en: 'Then, the Gaussian Copula is expressed as follows:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，高斯连结函数表示如下：
- en: '![](../Images/1a18cd26a78aabed743b2871d4a9c414.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1a18cd26a78aabed743b2871d4a9c414.png)'
- en: '**Gaussian Copula Formula**'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**高斯连结函数公式**'
- en: 'where `Φ`is the CDF of the standard normal distribution, and `Φ_2`is the joint
    CDF of `**[**Z_1, Z_2**]**`parameterized by the correlation factor `**ρ**`. Let’s
    break down the above equations of the Gaussian Copula:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `Φ` 是标准正态分布的 CDF，`Φ_2` 是由相关系数 `**ρ**` 参数化的 `**[**Z_1, Z_2**]**` 的联合 CDF。让我们分解上述高斯连结函数的方程：
- en: '**Line 1:** We start with the generic copula definition.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 1 行：** 我们从通用连结函数定义开始。'
- en: '**Line 2:** We use the inverse sampling trick to convert our uniform marginals
    to Gaussian.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 2 行：** 我们使用逆采样技巧将我们的均匀边际转换为高斯分布。'
- en: '**Line 3:** We re-format our equation to express the Gaussian Copula. **The
    last line is the formal Gaussian Copula formula.**'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 3 行：** 我们重新格式化方程以表示高斯 Copula。**最后一行是正式的高斯 Copula 公式。**'
- en: If you are still confused by the maths, don’t worry. In the next section, we
    will show step-by-step how to plot Gaussian copulas.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你对数学仍感到困惑，请不用担心。在下一节中，我们将逐步展示如何绘制高斯 Copulas。
- en: Gaussian Copulas in Practice
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高斯 Copulas 实践
- en: 'To code and plot a Gaussian Copula we need 3 things:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 要编码和绘制高斯 Copula，我们需要 3 件事：
- en: '`N` continuous variables of any continuous distribution.'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`N` 个连续变量，来自任何连续分布。'
- en: The Gaussian Copula formula.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 高斯 Copula 公式。
- en: To decide how correlated our random variables will be — the correlation factor
    `**ρ**`previously mentioned.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要决定我们的随机变量之间的相关程度 — 就是前面提到的相关因子 `**ρ**`。
- en: To keep our example simple, we will use 2 random variables instead of `N`**.**
    Since these 2 distributions are part of the joint copula CDF, we will refer to
    them as **marginal distributions:**
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保持我们的例子简单，我们将使用 2 个随机变量而不是 `N`**。** 由于这两个分布是联合 Copula CDF 的一部分，我们将它们称为 **边际分布：**
- en: '![](../Images/bba9c36834256cd793eb1e4791926f0b.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bba9c36834256cd793eb1e4791926f0b.png)'
- en: '**Table 1:** The Gaussian Copula formula'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1：** 高斯 Copula 公式'
- en: That is the theoretical background. We have now everything we need to plot our
    copula.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是理论背景。我们现在拥有绘制 Copula 所需的一切。
- en: 'Now, let’s start by plotting the marginals distributions:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们开始绘制边际分布：
- en: '[PRE3]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](../Images/b6c0bc235b7b20bb36c1444f9586b0fe.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b6c0bc235b7b20bb36c1444f9586b0fe.png)'
- en: '**Figure 6:** Jointscatterplot of Z1 and Z2'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 6：** Z1 和 Z2 的联合散点图'
- en: Next, we convert the Gaussian variables to uniform ones, using the *Probability
    integral transform*. Remember, copulas take as input the uniform marginals u1
    and `u2`.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将高斯变量转换为均匀变量，使用 *概率积分变换*。记住，Copulas 以均匀边际 u1 和 `u2` 作为输入。
- en: '[PRE4]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/001912533d3ca681864f1282e28f8cd7.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/001912533d3ca681864f1282e28f8cd7.png)'
- en: '**Figure 7:** Jointscatterplot of u1 and u2 — both are uniform'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 7：** u1 和 u2 的联合散点图 — 两者都是均匀分布'
- en: Having computed the `u1`and `u2`variables**,** we can input them into the Gaussian
    Copula.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 计算出 `u1` 和 `u2` 变量后，我们可以将它们输入到高斯 Copula 中。
- en: The only thing left to configure is the copula’s correlation factor `**ρ**`
    which decides how correlated the two distributions should be. Let’s use `**ρ**=0.8`
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 唯一剩下要配置的是 Copula 的相关因子 `**ρ**`，它决定了两个分布的相关程度。我们使用 `**ρ**=0.8`
- en: The Gaussian Copula plot is displayed in **Figure 8\.** To create the copula,
    we will use the transformations displayed in **Table 1:**
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 高斯 Copula 图显示在 **图 8** 中。为了创建 Copula，我们将使用 **表 1** 中显示的转换：
- en: '[PRE5]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/3b170c0d5329b62553dc67415c9d8234.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3b170c0d5329b62553dc67415c9d8234.png)'
- en: '**Figure 8:** The Gaussian Copula plot from 2 gaussian distributions'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 8：** 来自 2 个高斯分布的高斯 Copula 图'
- en: Experiment with `**ρ**` to observe how the plot changes. Modify mean and variance
    vectors as well.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 试验 `**ρ**` 以观察图形的变化。也可以修改均值和方差向量。
- en: 'Also, notice in **Figure 8** that copulas take inputs and outputs in the [0,1]
    range. Remember earlier how we defined copulas ( `**C** : [0,1] → [0,1]^N` , where
    `N` is the number of marginals — here we have 2)'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '同样，请注意 **图 8** 中，Copulas 的输入和输出都在 [0,1] 范围内。记住之前我们如何定义 Copulas（`**C** : [0,1]
    → [0,1]^N`，其中 `N` 是边际数 — 这里我们有 2 个）'
- en: 'Now, it’s time for the crucial question:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，到了关键问题的时候：
- en: '**Challenge 3:** Why do we need a Gaussian copula instead of a multivariate
    Gaussian PDF? After all, a Gaussian copula is just a multivariate CDF.'
  id: totrans-145
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**挑战 3：** 为什么我们需要高斯 Copula 而不是多变量高斯 PDF？毕竟，高斯 Copula 只是一个多变量 CDF。'
- en: Well, a multivariate Gaussian PDF only requires Gaussian marginals.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 嗯，一个多变量高斯 PDF 只需要高斯边际分布。
- en: With copulas, we can use the *probability integral transform* to convert **any
    continuous distribution** to uniform marginals — **while still preserving** the
    dependency structure.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copulas，我们可以使用 *概率积分变换* 将 **任何连续分布** 转换为均匀边际 — **同时保持** 依赖结构。
- en: In other words, the inputs of copulas can be a mix of any continuous random
    variable.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 换句话说，Copulas 的输入可以是任何连续随机变量的混合。
- en: '**Experiment: Using Beta and Gamma as marginals**'
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**实验：使用 Beta 和 Gamma 作为边际分布**'
- en: Let’s make some plots to demonstrate the above claim.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们做一些图示以演示上述观点。
- en: Instead of using 2 standard normal distributions as inputs, we will use a beta
    and a gamma random variable — and still get a Gaussian Copula.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一个 beta 和一个 gamma 随机变量，而不是使用两个标准正态分布作为输入——并且仍然得到一个高斯 Copula。
- en: In practice, we can use any continuous distribution as input. Also, we can assume
    our copula knows nothing about the underlying data distributions. To achieve this,
    we can use the *empirical CDF*, which computes the CDF of the input data regardless
    of how they are distributed.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们可以使用任何连续分布作为输入。此外，我们可以假设我们的 Copula 对底层数据分布一无所知。为了实现这一点，我们可以使用*经验 CDF*，它计算输入数据的
    CDF，无论数据如何分布。
- en: 'Remember, the input distributions for our copula can represent any random event,
    like a product’s sales. For the sake of clarity, we will use a beta and a gamma
    distribution:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，我们的 Copula 输入分布可以代表任何随机事件，比如产品销售。为了清楚起见，我们将使用一个 beta 和一个 gamma 分布：
- en: '[PRE6]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/90118b4177f84a19f917e3ecc5f603b9.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/90118b4177f84a19f917e3ecc5f603b9.png)'
- en: '**Figure 9:** The Gaussian Copula plot from a beta and a gamma distribution'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 9:** 来自 beta 和 gamma 分布的高斯 Copula 图'
- en: That’s it. We got the same result. You can find a notebook with all plots [here](https://jovian.com/nkafr/copulas-medium).
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样。我们得到了相同的结果。你可以在[这里](https://jovian.com/nkafr/copulas-medium)找到包含所有图表的笔记本。
- en: Note that other types of copulas exist, such as **Archimedean copulas**. Each
    copula type has its pros and cons. For example, Archimedean copulas are better
    at modeling heavy-tailed or skewed distributions.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，还有其他类型的 Copulas，例如**阿基米德 Copulas**。每种 Copula 类型都有其优缺点。例如，阿基米德 Copulas 更擅长建模重尾或偏斜分布。
- en: In this article, we focused on Gaussians Copulas since they are easier to understand
    — and abundant in time-series applications.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我们重点关注了高斯 Copulas，因为它们更容易理解——并且在时间序列应用中非常丰富。
- en: How to Use Copulas as a Data Scientist
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何作为数据科学家使用 Copulas
- en: Unless you are an econometrician or a quantitative data scientist, it is unlikely
    to use copulas. There are some rare use cases in medicine too.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 除非你是计量经济学家或量化数据科学家，否则不太可能使用 Copulas。在医学领域也有一些稀有的应用案例。
- en: However, copulas have resurfaced again. They find numerous applications in **Deep
    Learning** models, especially in Time Series Forecasting.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，Copulas 再次浮现。它们在**深度学习**模型中找到了众多应用，尤其是在时间序列预测中。
- en: 'Let’s view some of them:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看其中的一些：
- en: '*Deep GPVAR: Deep Gaussian-Process Vector-Autoregressive Model*'
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '*深度 GPVAR: 深度高斯过程向量自回归模型*'
- en: An improved and novel version of Amazon’s popular TS Forecasting model [**DeepAR**](https://medium.com/towards-data-science/deepar-mastering-time-series-forecasting-with-deep-learning-bc717771ce85)**.**
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 亚马逊流行的 TS 预测模型[**DeepAR**](https://medium.com/towards-data-science/deepar-mastering-time-series-forecasting-with-deep-learning-bc717771ce85)**的改进版和新颖版本**。
- en: '**Deep GPVAR[2]** uses an LSTM network to parameterize a Gaussian copula. By
    applying a Gaussian copula, *Deep GPVAR* jointlymodels thousands of time series,
    considering their interdependence.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '**深度 GPVAR[2]**使用 LSTM 网络对高斯 Copula 进行参数化。通过应用高斯 Copula，*深度 GPVAR* 共同建模了数千个时间序列，考虑了它们之间的相互依赖性。'
- en: 'Remember the **product cannibalization** we mentioned earlier: Let’s say your
    dataset consists of multiple time series, and each time series represents the
    sales of a product. If a product suddenly goes well, it will likely influence
    the sales of similar products.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 记住我们之前提到的**产品相互侵蚀**：假设你的数据集由多个时间序列组成，每个时间序列表示一个产品的销售。如果一个产品突然畅销，它很可能会影响类似产品的销售。
- en: If you want a model that captures the interdependencies among multiple time
    sequences, then *Deep GPVAR* is an ideal choice.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要一个捕捉多个时间序列间相互依赖的模型，那么*深度 GPVAR* 是一个理想的选择。
- en: 'TACTiS: Transformer-Attentional Copulas for Time Series'
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 'TACTiS: Transformer-注意力 Copulas 用于时间序列'
- en: '**TACTiS[3]**is a novel Transformed-based TS forecasting model that also uses
    copulas.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '**TACTiS[3]**是一个新颖的基于转换的 TS 预测模型，也使用 Copulas。'
- en: The model was published by the ServiceNow team — the team behind the breakthrough
    [***N-BEATS***](https://medium.com/towards-data-science/n-beats-time-series-forecasting-with-neural-basis-expansion-af09ea39f538)
    model.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 该模型由 ServiceNow 团队发布——即突破性的[***N-BEATS***](https://medium.com/towards-data-science/n-beats-time-series-forecasting-with-neural-basis-expansion-af09ea39f538)模型的开发团队。
- en: '*TaCTICS* works by estimating joint distributions of high-dimensional time
    series using a transformer architecture that learns to mimic non-parametric copulas.
    Although *TaCTICS* does not assume that copulas follow a specific distribution
    (that’s why they are non-parametric), the model uses attention to estimate them.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '*TaCTICS* 通过使用 transformer 架构来估计高维时间序列的联合分布，该架构学习模仿非参数化 copulas。虽然 *TaCTICS*
    不假设 copulas 遵循特定的分布（这就是它们是非参数化的原因），但模型使用注意力机制来估计它们。'
- en: Also, the model can handle hundreds of time series, supports forecasting and
    interpolation, handles unaligned and non-uniformly sampled data, and can adapt
    to missing data during training.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，该模型可以处理数百个时间序列，支持预测和插值，处理未对齐和非均匀采样的数据，并能够在训练期间适应缺失数据。
- en: 'CopulaCPTS: Copula Conformal Prediction for Multi-Step Time Series Forecasting'
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CopulaCPTS：用于多步骤时间序列预测的 Copula Conformal 预测
- en: '**CopulaCPTS[4]** is also a revolutionary model that combines copulas with
    a promising method, known as *conformal prediction.*'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '**CopulaCPTS[4]** 也是一个革命性的模型，它结合了 copulas 和一种有前景的方法，称为 *conformal prediction*。'
- en: '*CopulaCPTS* is based on conformal prediction, a distribution-free quantification
    uncertainty method that provides well-calibrated prediction intervals.'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '*CopulaCPTS* 基于 conformal prediction，这是一种无分布的量化不确定性的方法，提供良好校准的预测区间。'
- en: Also, *CopulaCPTS* leverages copulas to capture uncertainty between multiple
    time steps. Thanks to copulas, the model improves upon existing conformal-based
    implementations by enabling predictions to extend to multiple steps.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，*CopulaCPTS* 利用 copulas 捕捉多个时间步之间的不确定性。得益于 copulas，该模型在现有的基于 conformal 的实现上有所改进，使得预测能够扩展到多个步骤。
- en: Closing Remarks
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结束语
- en: Copulas are an essential tool for modeling complex dependencies between variables,
    particularly in the context of high-dimensional data analysis.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: Copulas 是建模变量间复杂依赖关系的重要工具，尤其是在高维数据分析的背景下。
- en: Also, recent advances in Deep Learning have sparked a new interest in them,
    particularly in Time-Series Forecasting.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，深度学习的最新进展引发了对它们的新兴趣，特别是在时间序列预测领域。
- en: 'We saw 3 novel papers that use copulas in their architecture:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到了 3 篇在其架构中使用 copulas 的新颖论文：
- en: '*Deep GPVAR uses an LSTM* to parameterize a Gaussian copula and simulate a
    Gaussian process.'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Deep GPVAR 使用 LSTM* 来参数化高斯 copula 并模拟高斯过程。'
- en: '*TaCTICS* uses attention to formulate non-parametric copulas.'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*TaCTICS* 使用注意力机制来制定非参数化 copulas。'
- en: '*CopulaCPTS* also creates non-parametric copulas empirically from the data.'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*CopulaCPTS* 还从数据中经验性地创建非参数化 copulas。'
- en: '*Deep GPVAR and TaCTICS* are open-source, so feel free to check them out. Also,
    *Deep GPVAR* is part of Amazon’s Forecasting Suite. *TaCTICS* claims SOTA performance
    compared to other Transformer-based forecasting models.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '*Deep GPVAR 和 TaCTICS* 是开源的，所以可以随意查看。此外，*Deep GPVAR* 是亚马逊预测套件的一部分。*TaCTICS*
    相比其他基于 Transformer 的预测模型声称具有 SOTA 性能。'
- en: Needless to say, after reading and understanding this article, you will have
    an easier time comprehending the aforementioned papers.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 不用说，在阅读并理解了本文后，你将更容易理解前述论文。
- en: Overall, the resurgence of copulas highlights the importance of modeling complex
    dependencies between variables in a wide range of applications. Also, their continued
    use in Deep Learning models suggests that copulas will continue to play a crucial
    role for the foreseeable future.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，copulas 的复兴突显了在广泛应用中建模变量间复杂依赖关系的重要性。此外，它们在深度学习模型中的持续使用表明，copulas 在可预见的未来将继续发挥关键作用。
- en: Thank you for reading!
  id: totrans-188
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 感谢阅读！
- en: Follow me on [Linkedin](https://www.linkedin.com/in/nikos-kafritsas-b3699180/)!
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 [Linkedin](https://www.linkedin.com/in/nikos-kafritsas-b3699180/) 上关注我！
- en: Subscribe to my [newsletter](https://aihorizonforecast.substack.com/welcome),
    AI Horizon Forecast!
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅我的 [新闻通讯](https://aihorizonforecast.substack.com/welcome)，AI Horizon Forecast！
- en: '[](https://aihorizonforecast.substack.com/p/autogluon-timeseries-creating-powerful?source=post_page-----f5c93dcd6e99--------------------------------)
    [## AutoGluon-TimeSeries : Creating Powerful Ensemble Forecasts — Complete Tutorial'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '[## AutoGluon-TimeSeries : 创建强大的集成预测 — 完整教程](https://aihorizonforecast.substack.com/p/autogluon-timeseries-creating-powerful?source=post_page-----f5c93dcd6e99--------------------------------)'
- en: Amazon’s framework for time-series forecasting has it all.
  id: totrans-192
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 亚马逊的时间序列预测框架涵盖了所有内容。
- en: aihorizonforecast.substack.com](https://aihorizonforecast.substack.com/p/autogluon-timeseries-creating-powerful?source=post_page-----f5c93dcd6e99--------------------------------)
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '[aihorizonforecast.substack.com](https://aihorizonforecast.substack.com/p/autogluon-timeseries-creating-powerful?source=post_page-----f5c93dcd6e99--------------------------------)'
- en: References
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考资料
- en: '[1] Empirical distribution function, [Wikipedia,](https://en.wikipedia.org/wiki/Empirical_distribution_function)
    Licence: Public Domain'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '[1] 实证分布函数，[维基百科，](https://en.wikipedia.org/wiki/Empirical_distribution_function)
    许可证：公有领域'
- en: '[2] Salinas et al. [*High-Dimensional Multivariate Forecasting with Low-Rank
    Gaussian Copula Processes*](https://arxiv.org/pdf/1910.03002.pdf)'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '[2] Salinas 等人 [*High-Dimensional Multivariate Forecasting with Low-Rank Gaussian
    Copula Processes*](https://arxiv.org/pdf/1910.03002.pdf)'
- en: '[3] Drouin et al. [*TACTiS: Transformer-Attentional Copulas for Time Series*](https://arxiv.org/abs/2202.03528),
    ICML (June 2022)'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '[3] Drouin 等人 [*TACTiS: Transformer-Attentional Copulas for Time Series*](https://arxiv.org/abs/2202.03528)，ICML（2022年6月）'
- en: '[4] Sun et al. [*Copula Conformal Prediction for Multi-Step Time Series Forecasting*](https://arxiv.org/pdf/2212.03281.pdf)'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '[4] Sun 等人 [*Copula Conformal Prediction for Multi-Step Time Series Forecasting*](https://arxiv.org/pdf/2212.03281.pdf)'
- en: '*All images are created by the author, unless stated otherwise*'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '*所有图片均由作者创作，除非另有说明*'

- en: 'Time Series for Climate Change: Forecasting Energy Demand'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/time-series-for-climate-change-forecasting-energy-demand-79f39c24c85e](https://towardsdatascience.com/time-series-for-climate-change-forecasting-energy-demand-79f39c24c85e)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How to use time series analysis and forecasting to tackle climate change
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://vcerq.medium.com/?source=post_page-----79f39c24c85e--------------------------------)[![Vitor
    Cerqueira](../Images/9e52f462c6bc20453d3ea273eb52114b.png)](https://vcerq.medium.com/?source=post_page-----79f39c24c85e--------------------------------)[](https://towardsdatascience.com/?source=post_page-----79f39c24c85e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----79f39c24c85e--------------------------------)
    [Vitor Cerqueira](https://vcerq.medium.com/?source=post_page-----79f39c24c85e--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----79f39c24c85e--------------------------------)
    ·7 min read·May 2, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/16d0449cf09821ab475614128fa6a238.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Matthew Henry](https://unsplash.com/@matthewhenry?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 'This is Part 4 of the series *Time Series for Climate Change.* List of articles:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Part 1: [Forecasting Wind Power](/time-series-for-climate-change-forecasting-wind-power-8ed6d653a255)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 2: [Solar Irradiance Forecasting](/time-series-for-climate-change-solar-irradiance-forecasting-a972dac7418f)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 3: [Forecasting Large Ocean Waves](https://medium.com/towards-data-science/time-series-for-climate-change-forecasting-large-ocean-waves-78484536be36)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: So far, we explored how forecasting is important to integrate clean energy sources
    into the electricity grid.
  prefs: []
  type: TYPE_NORMAL
- en: Forecasting also plays a key role on the demand side of energy systems.
  prefs: []
  type: TYPE_NORMAL
- en: Balancing the demand and supply of energy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Power systems need to ensure the balance between the supply and demand of energy
    at all times. This balance is critical for the reliability of the electricity
    grid. If demand is greater than supply, this leads to power outages. When supply
    exceeds demand, there’s a surplus of energy which often goes to waste.
  prefs: []
  type: TYPE_NORMAL
- en: Power systems use forecasting models to help them predict the demand for energy.
    Accurate demand forecasts contribute to more efficient production and use of energy.
    This has a direct impact on climate because of waste reduction.
  prefs: []
  type: TYPE_NORMAL
- en: 'Analyzing energy consumption is also valuable within households. For example,
    individuals can examine which appliances consume more energy, and use this information
    to avoid higher costs during peak hours. As a bit of trivia: It’s estimated that
    about 8% of residential electricity demand comes from standby power consumption
    [4].'
  prefs: []
  type: TYPE_NORMAL
- en: Forecasting energy demand
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Forecasting energy demand is a difficult problem.
  prefs: []
  type: TYPE_NORMAL
- en: Energy consumption depends on several factors, some of which might not be readily
    available for modeling. Examples include weather and economic conditions that
    affect the use of electronic devices for heating or cooling. Weather is characterized
    by highly variable patterns. These make it difficult to predict the magnitude
    of weather impact on energy demand.
  prefs: []
  type: TYPE_NORMAL
- en: Energy demand data exhibit seasonal patterns at different time scales, including
    daily, monthly, or yearly scales. In winter, for example, energy demand increases
    for heating purposes.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f3d698a814b4a80475e219e8320a1626.png)'
  prefs: []
  type: TYPE_IMG
- en: Distribution of energy demand by month. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Capturing all seasonal effects is important in building accurate energy demand
    forecasting models.
  prefs: []
  type: TYPE_NORMAL
- en: How can you do that?
  prefs: []
  type: TYPE_NORMAL
- en: 'Hands-on: Forecasting Energy Demand'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the rest of this article, we’ll develop an energy demand forecasting model.
    You’ll learn how to:'
  prefs: []
  type: TYPE_NORMAL
- en: analyze multiple seasonal effects using auto-correlation and data visualization;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: do feature extraction from the date and time information to handle multiple
    seasonal effects.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The full code used in this tutorial is available on Github:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://github.com/vcerqueira/tsa4climate/](https://github.com/vcerqueira/tsa4climate/tree/main/content/part_4)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data set
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We’ll use a data set that represents hourly power consumption, in megawatts,
    in Kentucky, USA [1]. The data was collected from 2013 until 2018, leading to
    a total of 45.344 observations.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s what the data looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4a109fa838cb6272c90bd9142e5d8fd4.png)'
  prefs: []
  type: TYPE_IMG
- en: Hourly energy demand time series in Kentucky, USA. The yellow line is the daily
    average demand. Data source in reference [1]. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Visualizing seasonality
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The plot above indicates that they're yearly regular patterns in the series.
  prefs: []
  type: TYPE_NORMAL
- en: 'Another way to visualize seasonality is with a graphic called seasonal plot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a93ea85679a5f984d408db1b8dff0806.png)'
  prefs: []
  type: TYPE_IMG
- en: A seasonal plot of average monthly energy demand by year. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: The seasonal plot makes it easy to see year-on-year monthly patterns. For example,
    energy consumption increases during the winter and summer months and decreases
    in spring and fall. This is probably related to heating (winter) or cooling (summer)
    reasons.
  prefs: []
  type: TYPE_NORMAL
- en: 'The seasonal sub-series plot below is also helpful to analyze the dynamics
    of data within and across months:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3466a6ae3af334060c916c8cd2497bb6.png)'
  prefs: []
  type: TYPE_IMG
- en: A seasonal sub-series plot of average monthly energy demand by year. Image by
    author.
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing seasonality using ACF
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can also use [auto-correlation](https://medium.com/towards-data-science/12-things-you-should-know-about-time-series-975a185f4eb2)
    to analyze seasonality. Seasonal time series will show higher auto-correlation
    in each seasonal lag.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1b7a5283ba539d5bb8eaee8d47be3706.png)'
  prefs: []
  type: TYPE_IMG
- en: Auto-correlation plot. The oscillations indicate daily seasonality. Image by
    author.
  prefs: []
  type: TYPE_NORMAL
- en: The figure above shows the auto-correlation plot up to 48 lags. The auto-correlation
    shows an oscillation pattern that is caused by daily seasonality.
  prefs: []
  type: TYPE_NORMAL
- en: So, besides yearly regular variations, there’s also a noticeable daily seasonality.
    The value observed in a given hour is correlated with the value captured in the
    same hour on the previous day.
  prefs: []
  type: TYPE_NORMAL
- en: Auto-regression
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As a starting point, we’ll develop an auto-regressive model for forecasting
    power consumption. [You can check a previous post for details on this type of
    modeling.](https://medium.com/towards-data-science/machine-learning-for-forecasting-transformations-and-feature-extraction-bbbea9de0ac2)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Dealing with multiple seasonal effects
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Most time series decomposition or forecasting methods are designed to handle
    a single seasonal period.
  prefs: []
  type: TYPE_NORMAL
- en: As data collection became cheap, it enabled the collection of time series at
    a high sampling frequency, such as daily or hourly. High-frequency time series
    provide a larger amount of data, [which is an important factor in training machine
    learning models](https://medium.com/towards-data-science/machine-learning-for-forecasting-size-matters-b5271ec784dc).
    Yet, these also contain complex seasonal patterns that can be tricky to model.
  prefs: []
  type: TYPE_NORMAL
- en: So, how do you handle multiple seasonal effects?
  prefs: []
  type: TYPE_NORMAL
- en: 'We’ll apply two feature extraction processes to do this:'
  prefs: []
  type: TYPE_NORMAL
- en: extracting features based on date and time data;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: using a trigonometric representation based on Fourier terms.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extracting features based on date and time
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A simple way of modeling multiple seasonal patterns is to summarise the date
    and time information at each time step. You can extract the relevant periods,
    such as the hour or day of the year, and use them as explanatory variables.
  prefs: []
  type: TYPE_NORMAL
- en: 'The library sktime provides a handy class to do this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Here’s a sample of the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4e8ebcaee7ed33d2b95830c584cd70ee.png)'
  prefs: []
  type: TYPE_IMG
- en: 'These features can be an effective approach for many time series with complex
    seasonality. But, they can miss the continuity of time. For example, suppose that
    you encode monthly information into integer numbers from 1 (January) to 12 (December):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/21a378490569eeeff76d0fdf7580437f.png)'
  prefs: []
  type: TYPE_IMG
- en: Encoding month information as integers. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: In such a case, the model does not understand that December precedes January.
    Transforming monthly information with one-hot encoding also leads to this problem.
  prefs: []
  type: TYPE_NORMAL
- en: Fourier terms
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fourier terms are periodic and deterministic series based on sine and cosine
    waves. The smoothness of these terms enables the modeling of time continuity.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d7d21a744e29bf3c0ed99b1889ba79e5.png)'
  prefs: []
  type: TYPE_IMG
- en: Encoding month information with Fourier terms. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s a sklearn compatible class for extracting Fourier series:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The main input is the seasonal period (e.g. 12 for monthly time series), the
    date-time information, and the number of terms. The number of terms impacts the
    smoothness of the representation. The optimal number depends on the input data.
  prefs: []
  type: TYPE_NORMAL
- en: Several popular methods use Fourier terms to model complex seasonality. These
    include [Prophet](https://facebook.github.io/prophet/), [TBATS](https://www.sktime.net/en/stable/api_reference/auto_generated/sktime.forecasting.tbats.TBATS.html),
    [greykite](https://linkedin.github.io/greykite/docs/0.1.0/html/pages/model_components/0300_seasonality.html),
    or [time-varying regression](https://orbit-ml.readthedocs.io/en/stable/tutorials/ktr1.html).
  prefs: []
  type: TYPE_NORMAL
- en: 'Fourier terms are included as explanatory features as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'So, auto-regression is coupled with features that summarise the date and time
    data. The feature importance scores below indicate that these provide relevant
    information to the model:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0d60180dc76f5940cf79bca513c97b4f.png)'
  prefs: []
  type: TYPE_IMG
- en: Random Forest importance scores. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Like in the case of forecasting energy production, the energy demand model
    becomes less accurate for longer horizons:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1ea37ad8b94ae0a5f36e7d62a11a243d.png)'
  prefs: []
  type: TYPE_IMG
- en: MASE error by forecasting horizon. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: Key Takeaways
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Energy demand forecasts are relevant to climate change. They enable power systems
    to make informed decisions and integrate clean energy sources into the grid;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Demand time series are affected by multiple factors and have a complex seasonality;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can deal with multiple seasonal patterns by summarising date and time information.
    Fourier terms are a common approach to do this;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Energy demand is difficult to predict in the long term, i.e., more than a few
    hours. Improving long-term forecasts is important for the efficiency of power
    systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thank you for reading, and see you in the next story!
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] Hourly Energy Consumption from PJM in Megawatts (Licence: CC0: Public Domain)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Rolnick, David, et al. “Tackling climate change with machine learning.”
    ACM Computing Surveys (CSUR) 55.2 (2022): 1–96.'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] MacKay, David. *Sustainable Energy-without the hot air*. UIT cambridge,
    2008.'
  prefs: []
  type: TYPE_NORMAL

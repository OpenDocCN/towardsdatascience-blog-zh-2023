- en: Exploring Time-to-Event with Survival Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/exploring-time-to-event-with-survival-analysis-8b0a7a33a7be](https://towardsdatascience.com/exploring-time-to-event-with-survival-analysis-8b0a7a33a7be)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/0881811ed71a9c0e7064a43cf24d95ba.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Edge2Edge Media](https://unsplash.com/@edge2edgemedia?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction of Survival Analysis and its application in Python
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://tanuwidjajaolivia.medium.com/?source=post_page-----8b0a7a33a7be--------------------------------)[![Olivia
    Tanuwidjaja](../Images/52a56de28da9b782b57f1c3928655cfb.png)](https://tanuwidjajaolivia.medium.com/?source=post_page-----8b0a7a33a7be--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8b0a7a33a7be--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8b0a7a33a7be--------------------------------)
    [Olivia Tanuwidjaja](https://tanuwidjajaolivia.medium.com/?source=post_page-----8b0a7a33a7be--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8b0a7a33a7be--------------------------------)
    ·8 min read·Nov 12, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: Survival analysis is a branch of statistics focused on **analyzing the expected
    duration of time until one event occurs**. It has been largely used in the healthcare
    sector, with the main use case being to understand the probability of one’s survival
    in medical trials.
  prefs: []
  type: TYPE_NORMAL
- en: This approach can also be applied to other domains and use cases with the objective
    of looking into the likelihood of a certain event at a given time. In this article,
    we will be looking into Survival Analysis concepts, techniques, and their application
    in Python.
  prefs: []
  type: TYPE_NORMAL
- en: Survival Analysis Concepts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In working on Survival Analysis, it is necessary to define an “event” and the
    “lifeline” or survival duration related to the event.
  prefs: []
  type: TYPE_NORMAL
- en: '**Event**: A thing that happens to the object of study. This needs to be **unambiguous
    and binary**, such as the death of a biological object. In more ambiguous domains
    like machinery failure, a clear definition is needed to identify the event (i.e.
    full failure, or productivity < X%).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Lifeline / Survival duration**: Time until the above event of interest occurs
    (or the end of observations).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With the above definition, we can apply Survival Analysis techniques to problems
    about the **probability of an event at a certain time**. This includes the proportion
    of the population that might experience the event, the estimated time until the
    event occurs, andfactors contributing to the event duration and likelihood.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some sample problem statements are:'
  prefs: []
  type: TYPE_NORMAL
- en: Modeling user conversion to membership/purchase
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Predicting time until machine failure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Likelihood of cancer reoccurrence at a given time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Predicting the time until employee churn
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Survival Function and Hazard Function
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The prediction of the event and survival duration is done by modeling the **survival
    function** of the event.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/3397f4f7b0675e0f05e23eacbb11ffd8.png)'
  prefs: []
  type: TYPE_IMG
- en: Survival function equation (Image by author)
  prefs: []
  type: TYPE_NORMAL
- en: Survival function S(t) shows the **probability of an object’s survival (not
    experiencing the event) after a certain time** (t). This is a non-increasing function,
    meaning the value would decrease as time goes by.
  prefs: []
  type: TYPE_NORMAL
- en: Another key equation in Survival Analysis is the **hazard function**, which
    shows the **probability that an event happens at some time, given survival** **(event
    not yet occurred) up to that time**. The hazard function h(t) shows the probability
    that the event happens **in the next instant**, given that it survived to time
    t.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/179b9eec091ee1796437cc36443019a0.png)'
  prefs: []
  type: TYPE_IMG
- en: Hazard function equation (Image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The hazard function h(t) and the survival function S(t) **can be derived from
    each other.**
  prefs: []
  type: TYPE_NORMAL
- en: Dataset for Survival Analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Since Survival Analysis focuses on the “event” and its “lifeline” or survival
    duration, the dataset needs to be the **observation of individual objects**, containing
    the **event occurrence** (binary of yes/no) and the **duration** of observation.
  prefs: []
  type: TYPE_NORMAL
- en: The data also needs to be factored in for ***censorship***. Censorship happens
    when the survival duration, or **time until the event, is only partially known**
    (i.e. unknown start date or unknown end date or both). The most common type is
    ***right censorship***, which is when **the event hasn’t occurred at the end of
    observation**/analysis time (survival time is greater than the observed duration).
    We’re good to work with Survival Analysis as long as (1) the censored data is
    within an acceptable proportion (< 50%) and (2) the censorship is non-informative
    and random (has no impact on survival).
  prefs: []
  type: TYPE_NORMAL
- en: Survival Analysis Techniques
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are a few techniques that can be used for Survival Analysis, depending
    on the goal of the analysis.
  prefs: []
  type: TYPE_NORMAL
- en: '**Identify the survival times** of members of a group: Kaplan-Meier estimator,
    Weibull model, Accelerated Failure Time model'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Compare the survival times** of two or more groups: The log-rank test'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Describe the effect of variables** on survival: Cox-Proportional Hazards
    model'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Scripts used and analytics exploration on this article can be found in this*
    [*GitHub repository*](https://github.com/oliviatan29/survival-analysis)*.*'
  prefs: []
  type: TYPE_NORMAL
- en: Kaplan-Meier Estimator
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[Kaplan-Meier estimator](https://en.wikipedia.org/wiki/Kaplan%E2%80%93Meier_estimator)
    is a ***non-parametric*** statistic used to **estimate the survival function of
    time-to-event data**. By being non-parametric, it does not rely on the assumption
    of a specific underlying distribution or any other specific assumptions about
    the population parameters. This is helpful when our data cannot be assumed to
    come from a normal distribution, and hence regular regression cannot be used in
    the prediction.'
  prefs: []
  type: TYPE_NORMAL
- en: In this model, the Survival function S(t) is estimated with the below formula.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c154a6078a2f055ecf6023de63882121.png)'
  prefs: []
  type: TYPE_IMG
- en: The Kaplan-Meier estimator (Image by author)
  prefs: []
  type: TYPE_NORMAL
- en: The survival rate at time t is equal to the product of the percentage chance
    of surviving at time t and each prior time.
  prefs: []
  type: TYPE_NORMAL
- en: In Python, this can be done using the `[lifelines](https://lifelines.readthedocs.io/en/latest/)`
    package. With this package, we can plot the survival function of the inputted
    observations and make predictions to check the survival likelihood at any specific
    point in the duration.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/484f6e6944b4f00b46211bca9b41969b.png)'
  prefs: []
  type: TYPE_IMG
- en: Kaplan-Meier survival function visualization (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/05077540831b9013c2b2233200743777.png)![](../Images/de3d05b5d842a500d38bd8b48a0277b7.png)'
  prefs: []
  type: TYPE_IMG
- en: Kaplan-Meier estimator results (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: In some cases, we might also be interested in **comparing the survival function
    between each group in a dataset**, for example, to compare the survival across
    age groups or product categories. One way to do such a comparison is to visualize
    the Kaplan-Meier survival function between the groups.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/df3babe8ee78683eef585b0f20082526.png)'
  prefs: []
  type: TYPE_IMG
- en: Survival function comparison between groups (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: For a more statistically accurate comparison, we can use [**the log-rank test**](https://en.wikipedia.org/wiki/Logrank_test)
    to do statistical testing on the survival similarity between these groups.
  prefs: []
  type: TYPE_NORMAL
- en: We run it with the null hypothesis (H0) that the survival rate between the groups
    is the same.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We check the p-value of the statistical testing to check the likelihood that
    the data would’ve occurred if the null hypothesis were true
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A **low p-value (p ≤ 0.05)** is an indication of a ***statistically significant***
    test result, which means that the **null hypothesis should be rejected**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The log-rank test compares survival probabilities *Si* between
  prefs: []
  type: TYPE_NORMAL
- en: groups at each time *t*.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/a6af019ce6b7b108f148c41f9d65b269.png)'
  prefs: []
  type: TYPE_IMG
- en: Log-rank test results. The p-value result is < 0.05, which means the survival
    rates between these groups are not the same (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: Weibull Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Kaplan-Meier estimator and the log-rank test above are a part of **univariate
    analysis**, which models survival as a function of a **single categorical factor**
    variable. For analyzing multiple variates on survival functions, we can use parametric
    models such as the [Weibull model](https://en.wikipedia.org/wiki/Weibull_distribution).
    It is modeled based on the Weibull distribution’s continuous probability distribution
    assumption.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ee8aea3f1cd008e21378e06858811e42.png)'
  prefs: []
  type: TYPE_IMG
- en: Survival function on Weibull model (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: Below is the application of the Weibull model in Python using the `lifelines`
    library.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/50124773f20503ed0b608d894b9aafcd.png)![](../Images/5fe4684dd6a475e7639ba3a43319c878.png)'
  prefs: []
  type: TYPE_IMG
- en: Weibull model results (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: As shown above, the Weibull model produces a **smooth survival curve** instead
    of a step function. The ρ (rho) value above is **greater than 1**, which indicates
    the hazard rate in this model is **always increasing**.
  prefs: []
  type: TYPE_NORMAL
- en: Cox Proportional Hazards (CoxPH) model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The [Cox Proportional Hazard model](https://en.wikipedia.org/wiki/Proportional_hazards_model)
    is one of the models that can **evaluate the effect of different factors on survival**.
    It operates under the assumption that the covariates have the *same effect* on
    all observations and that there are *no unspecified interactions* among the variables.
  prefs: []
  type: TYPE_NORMAL
- en: The Cox Proportional Hazards (Cox PH) model is a regression model that regresses
    covariates on time to event/duration. Since it is a regression model, you’ll need
    **a list of covariates (categorical variables) related to the observation** to
    be fitted into the model, on top of the events and durations on the other estimators.
    Examples of the covariates for a clinical study include the patient’s age, weight,
    smoking behavior, whether following a diet, whether have certain allergy, etc.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/559e4324e25d20a04e897186283dc5b3.png)'
  prefs: []
  type: TYPE_IMG
- en: CoxPH model results (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: The key variables to be looked into from the CoxPH model results are (1) the
    `exp(coef)` column and (2) the `p` column (p-value).
  prefs: []
  type: TYPE_NORMAL
- en: The `exp(coef)` column shows the hazard ratio of the variable.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `p` (p-value) indicates which covariates have a significant effect on the
    survival duration. Predictors with low p-values (< 0.05) are statistically significant
    predictors for determining the survival duration.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A one-unit increase in [variable X] from its median value means the **hazards
    change by the factor of e[coef(x)]**. In the example screenshot above, with the
    increase of “Rotational speed [rpm]” from its median value, the machine’s hazards
    change by a factor of e[0.0079] = 1.008, which means a 0.8% increase compared
    to the baseline hazards.
  prefs: []
  type: TYPE_NORMAL
- en: Closing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Survival Analysis is a statistics technique to analyze the expected duration
    of time until one event occurs. Though initially used in the medical field, the
    application can also be extended to various use cases, including predictive maintenance
    (predicting equipment failure), customer analytics (predicting time to churn/purchase),
    and loan modeling (predicting default).
  prefs: []
  type: TYPE_NORMAL
- en: Several techniques can be used for Survival Analysis, including the Kaplan-Meier
    estimator and Weibull model to model the survival function of a group, the log-rank
    test to compare the survival times between groups, the CoxPH model and accelerated
    failure time (AFT) to describe the effect of categorical or quantitative variables
    on survival. Each model works on certain underlying assumptions/distributions
    and can be compared using their [Akaike Information Criterion (AIC)](https://en.wikipedia.org/wiki/Akaike_information_criterion)
    or [qq-plot](https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot) to determine the
    most appropriate model for the dataset.
  prefs: []
  type: TYPE_NORMAL
- en: '*Scripts used and analytics exploration on this article can be found in this*
    [*GitHub repository*](https://github.com/oliviatan29/survival-analysis)*.*'
  prefs: []
  type: TYPE_NORMAL

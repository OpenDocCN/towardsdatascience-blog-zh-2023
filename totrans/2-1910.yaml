- en: Stationarity in Time Series — A Comprehensive Guide
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/stationarity-in-time-series-a-comprehensive-guide-8beabe20d68](https://towardsdatascience.com/stationarity-in-time-series-a-comprehensive-guide-8beabe20d68)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How to check if a time series is stationary and what you can do if it is non-stationary
    in Python
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@iamleonie?source=post_page-----8beabe20d68--------------------------------)[![Leonie
    Monigatti](../Images/4044b1685ada53a30160b03dc78f9626.png)](https://medium.com/@iamleonie?source=post_page-----8beabe20d68--------------------------------)[](https://towardsdatascience.com/?source=post_page-----8beabe20d68--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----8beabe20d68--------------------------------)
    [Leonie Monigatti](https://medium.com/@iamleonie?source=post_page-----8beabe20d68--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----8beabe20d68--------------------------------)
    ·8 min read·Apr 11, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/55138648f455b73f978af21736d394cf.png)'
  prefs: []
  type: TYPE_IMG
- en: Stationarity in time series (Image drawn by the author)
  prefs: []
  type: TYPE_NORMAL
- en: The future is easier to model when it is similar to the present [3]. Stationarity
    describes the concept that the statistical features of a time series do not change
    over time. Thus, some time series forecasting models, such as autoregressive models,
    rely on the stationarity of the time series.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this article, you will learn:'
  prefs: []
  type: TYPE_NORMAL
- en: '[what stationarity is](#e15a),'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[why it is important](#afc6),'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[3 ways to check for stationarity](#48f0), and'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[3 techniques you can apply when a time series is non-stationary](#b9bb)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What Is Stationarity?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Stationarity describes the concept that how a time series is changing will
    remain the same in the future [3]. In mathematical terms, a time series is stationary
    when its **statistical properties are independent of time** [3]:'
  prefs: []
  type: TYPE_NORMAL
- en: constant mean,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: constant variance,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: and covariance is independent of time.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This is the definition of **weak-form stationarity**. Another type of stationarity
    is **strict stationarity**. It implies that samples of identical size have identical
    distribution [5]. Since strict stationarity is restrictive and rare, this article
    will only focus on weak-form stationarity.
  prefs: []
  type: TYPE_NORMAL
- en: Why Is Stationarity Important?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Some time series forecasting models (e.g., autoregressive models) require a
    stationary time series because they are easier to model due to their constant
    statistical properties [3]. Thus, you should make your time series stationary
    if it is not (see [What Can You Do When A Time Series Is Not Stationary?](#b9bb)).
  prefs: []
  type: TYPE_NORMAL
- en: How Do You Test For Stationarity?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can test a time series for stationarity in two ways:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Intuitive approach: Visual assessment'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Statistical approach: Unit root test'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For this section, we will recreate a few examples Hyndman and Athanasopoulos
    [3] used to explain the visual assessment of stationarity and extend their usage
    also to explain testing for stationarity with unit root testing. The data is taken
    from the related `fma` R-package [1].
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5f25978eb4c89fc3e3d0e113b08e762c.png)'
  prefs: []
  type: TYPE_IMG
- en: Example time series to showcase testing for stationarity (Image by the author,
    heavily inspired by Hyndman and Athanasopoulos [3])
  prefs: []
  type: TYPE_NORMAL
- en: How to visually assess stationarity
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can visually assess the stationarity of a time series by mentally dividing
    the time series in half and comparing the mean, amplitude, and cycle length from
    the first half to the second half of the time series.
  prefs: []
  type: TYPE_NORMAL
- en: '**constant mean** —The mean value of the first half of the time series should
    be similar to that of the second half.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**constant variance** —The amplitude of the first half of the time series should
    be similar to that of the second half.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**covariance is independent of time** — The cycle length in the first half
    of the time series should be similar to that in the second half. The cycles should
    be independent on time (e.g., not weekly or monthly, etc.).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/4e3508348c061efe58877406f98b7c15.png)'
  prefs: []
  type: TYPE_IMG
- en: How to test for stationarity visually (Image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'For our examples, the assessment result is visualized below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4f50fcf95dd135b4fc3794ce86c50bcd.png)'
  prefs: []
  type: TYPE_IMG
- en: Visual assessment of stationarity on example time series (Image by the author,
    heavily inspired by Hyndman and Athanasopoulos [3])
  prefs: []
  type: TYPE_NORMAL
- en: How to statistically assess stationarity — a detour on unit root tests
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'A **unit root** is a stochastic trend called a “random walk with drift”. Since
    randomness can’t be predicted, that means:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Unit root present: not stationary (unpredictable)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Unit root absent: stationary'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To test for stationarity with a unit root test, you will state your initial
    assumption in the form of two competing hypotheses [6]:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Null hypothesis (H0) —** e.g., the time series is stationary (no unit root
    present)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Alternative hypothesis (H1)** — e.g., the time series is not stationary (unit
    root present)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Then you will assess whether to reject or not to reject the null hypothesis
    based on two approaches:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The p-value approach:**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the p-value > 0.05, fail to reject the null hypothesis.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: If the p-value ≤ 0.05, reject the null hypothesis.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**The critical value approach:**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the test statistic is less extreme than the critical value, fail to reject
    the null hypothesis.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: If the test statistic is more extreme than the critical value, reject the null
    hypothesis.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: The critical value approach should be used when the p-value is close to significant
    (e.g., around 0.05) [8].
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'There are several unit root tests you can use to check for stationarity. This
    article will focus on the most popular ones:'
  prefs: []
  type: TYPE_NORMAL
- en: Augmented Dickey-Fuller test [2]
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kwiatkowski-Phillips-Schmidt-Shin test [4].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to test for stationarity with **Augmented Dickey-Fuller test**
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The hypotheses for the Augmented Dickey-Fuller (ADF) test are [2]:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Null hypothesis (H0):** The time series is **not stationary** because there
    is a unit root (if p-value > 0.05)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Alternative hypothesis (H1):** The time series is **stationary** because
    there is no unit root (if p-value ≤ 0.05)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In Python, we can use the `adfuller` method from the `statsmodels.tsa.stattools`
    library [8].
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The time series is stationary if we can reject the null hypothesis of the ADF
    test:'
  prefs: []
  type: TYPE_NORMAL
- en: If the p-value (`result[1]`) ≤ 0.05
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the test statistic (`result[0]`) is more extreme than the critical value
    (`result[4]["1%"]`, `result[4]["5%"]`, and `result[4]["10%"]`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/19a3885ddb6986d3f7b7e186949ec9b9.png)'
  prefs: []
  type: TYPE_IMG
- en: Test for stationarity with ADF test from stattools Python library (Image by
    the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Below are the results from the ADF test for the sample dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/acdf2404e8745d9d305aa096f87a84d7.png)'
  prefs: []
  type: TYPE_IMG
- en: Unit root (ADF test) assessment of stationarity on example time series (Image
    by the author)
  prefs: []
  type: TYPE_NORMAL
- en: '**How to test for stationarity with Kwiatkowski-Phillips-Schmidt-Shin test**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The hypotheses for the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test are [4]:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Null hypothesis (H0):** The time series is **stationary** because there is
    no unit root (if p-value > 0.05)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Alternative hypothesis (H1):** The time series is **not stationary** because
    there is a unit root (if p-value ≤ 0.05)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The more positive this statistic, the more likely we are to reject the null
    hypothesis (we have a non-stationary time series).
  prefs: []
  type: TYPE_NORMAL
- en: In Python, we can use the `kpss` method from the `statsmodels.tsa.stattools`
    library [9]. We must use the argument `regression = 'ct'` to specify that the
    test's null hypothesis is that the data is trend stationary. [9]
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The time series is stationary if we fail to reject the null hypothesis of the
    KPSS test:'
  prefs: []
  type: TYPE_NORMAL
- en: If the p-value (`result[1]`) > 0.05
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the test statistic (`result[0]`) is less extreme than the critical value
    (`result[3]["1%"]`, `result[3]["2.5%"]`, `result[3]["5%"]`, and `result[3]["10%"]`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/2f4d439f321213200905b953cc81b689.png)'
  prefs: []
  type: TYPE_IMG
- en: Test for stationarity with KPSS test from stattools Python library (Image by
    the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Below are the results from the KPSS test for the sample dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/11a0785eb8297607b081636470b5fae8.png)'
  prefs: []
  type: TYPE_IMG
- en: Unit root (KPSS test) assessment of stationarity on example time series (Image
    by the author)
  prefs: []
  type: TYPE_NORMAL
- en: What Can You Do When A Time Series Is Not Stationary?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can apply different transformations to a non-stationary time series to
    try to make it stationary:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Differencing](#8319)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Detrending by model fitting](#c7cc)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Log transformation](#55d8)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Because there are several stationarity types, we can combine the ADF and KPSS
    tests to determine what transformations to make [7]:'
  prefs: []
  type: TYPE_NORMAL
- en: If the ADF test result is stationary and the KPSS test result is non-stationary,
    the time series is **difference stationary** — Apply differencing to time series
    and check for stationarity again [7].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the ADF test result is non-stationary and the KPSS test result is stationary,
    the time series is **trend stationary** — Detrend time series and check for stationarity
    again [7].
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Differencing
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Differencing calculates the difference between two consecutive observations.
    It stabilizes the mean of a time series and thus reduces the trend [3].
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/deb6fdeb0513f5c6bbda95c0a14d759b.png)'
  prefs: []
  type: TYPE_IMG
- en: Differenced time series (Image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: If you want to expand your knowledge on differencing, you should have a look
    at [fractional differencing](/preserving-memory-in-stationary-time-series-6842f7581800).
  prefs: []
  type: TYPE_NORMAL
- en: Detrending by model fitting
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Another way to remove the trend from a non-stationary time series is to fit
    a simple model (e.g., linear regression) to the data and then to model the residuals
    from that fit.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/3e12f4028e6912cabc23efb757715343.png)'
  prefs: []
  type: TYPE_IMG
- en: Detrend time series by model fitting (Image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Log transformation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Log transformation stabilizes the variance of a time series [8].
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/0ced403f481257930f2479fd754a0cf2.png)'
  prefs: []
  type: TYPE_IMG
- en: Log-transformed time series (Image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see, both the detrending with model fitting as well as the log transform
    alone did not make our example time series stationary. You can also combine different
    techniques to make a time series stationary:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0fd0fd4a8de88747079ae30f841f5ca1.png)'
  prefs: []
  type: TYPE_IMG
- en: Detrend log-transformed time series by model fitting (Image by the author)
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In time series forecasting, a time series, which has **constant statistical
    properties (mean, variance, and covariance)** and thus is independent of time,
    is described as stationary.
  prefs: []
  type: TYPE_NORMAL
- en: Because of the constant statistical characteristics, a stationary time series
    is easier to model than a non-stationary time series. Thus, a lot of time series
    forecasting models **assume stationarity**.
  prefs: []
  type: TYPE_NORMAL
- en: Stationarity can be checked either **by visual assessment or by a statistical
    approach**. The statistical approach checks for a unit root, an indicator of non-stationarity.
    The two most popular unit root tests are ADF and KPSS. Both are available in the
    Python `stattools` library [8,9].
  prefs: []
  type: TYPE_NORMAL
- en: If a time series is non-stationary, you can try to **make it stationary** by
    differencing, log transforming, or removing the trend.
  prefs: []
  type: TYPE_NORMAL
- en: Enjoyed This Story?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Subscribe for free*](https://medium.com/subscribe/@iamleonie) *to get notified
    when I publish a new story.*'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/@iamleonie/subscribe?source=post_page-----8beabe20d68--------------------------------)
    [## Get an email whenever Leonie Monigatti publishes.'
  prefs: []
  type: TYPE_NORMAL
- en: Get an email whenever Leonie Monigatti publishes. By signing up, you will create
    a Medium account if you don’t already…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: medium.com](https://medium.com/@iamleonie/subscribe?source=post_page-----8beabe20d68--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: '*Find me on* [*LinkedIn*](https://www.linkedin.com/in/804250ab/),[*Twitter*](https://twitter.com/helloiamleonie)*,
    and* [*Kaggle*](https://www.kaggle.com/iamleonie)*!*'
  prefs: []
  type: TYPE_NORMAL
- en: Dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: All datasets are taken from the fma R package.
  prefs: []
  type: TYPE_NORMAL
- en: '[1] Hyndman RJ (2023). *fma: Data sets from “Forecasting: methods and applications”
    by Makridakis, Wheelwright & Hyndman (1998)*. R package version 2.5, [http://pkg.robjhyndman.com/fma/](http://pkg.robjhyndman.com/fma/).'
  prefs: []
  type: TYPE_NORMAL
- en: '**License:** [GPL-3](https://cran.r-project.org/web/licenses/GPL-3) ([https://cran.r-project.org/web/packages/fma/index.html](https://cran.r-project.org/web/packages/fma/index.html))'
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[2] Dickey, D. A. and Fuller, W. A. (1979). Distribution of the estimates for
    autoregressive time series with a unit root. *J. Am. Stat. Assoc.* **74**, 427–431.'
  prefs: []
  type: TYPE_NORMAL
- en: '[3] R. J. Hyndman, & G. Athanasopoulos (2021) *Forecasting: principles and
    practice*, 3rd edition, OTexts: Melbourne, Australia. OTexts.com/fpp3 . (Accessed
    on September 26, 2022).'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] Kwiatkowski, D., Phillips, P. C., Schmidt, P., & Shin, Y. (1992). Testing
    the null hypothesis of stationarity against the alternative of a unit root: How
    sure are we that economic time series have a unit root?. Journal of econometrics,
    54(1–3), 159–178.'
  prefs: []
  type: TYPE_NORMAL
- en: '[5] D. C. Montgomery, C. L. Jennings, Murat Kulahci (2015) Introduction to
    Time Series Analysis and Forecasting, 2nd edition, John Wiley & Sons.'
  prefs: []
  type: TYPE_NORMAL
- en: '[6] PennState (2023). [S.3 Hypothesis Testing](https://online.stat.psu.edu/statprogram/reviews/statistical-concepts/hypothesis-testing)
    (Accessed on September 26, 2022).'
  prefs: []
  type: TYPE_NORMAL
- en: '[7] statsmodels (2023). [Stationarity and detrending (ADF/KPSS)](https://www.statsmodels.org/stable/examples/notebooks/generated/stationarity_detrending_adf_kpss.html)
    (Accessed on March 10, 2023).'
  prefs: []
  type: TYPE_NORMAL
- en: '[8] statsmodels (2023). [statsmodels.tsa.stattools.adfuller](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html)
    (Accessed on September 26, 2022).'
  prefs: []
  type: TYPE_NORMAL
- en: '[9] statsmodels (2023). [statsmodels.tsa.stattools.kpss](https://www.statsmodels.org/dev/generated/statsmodels.tsa.stattools.kpss.html)
    (Accessed on September 26, 2022).'
  prefs: []
  type: TYPE_NORMAL

- en: Overviewing the Global Chocolate Trade
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/overviewing-the-global-chocolate-trade-6478adeb8ead](https://towardsdatascience.com/overviewing-the-global-chocolate-trade-6478adeb8ead)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/93d4cc6863b78621420ccfcf677e7a6a.png)'
  prefs: []
  type: TYPE_IMG
- en: The global chocolate trade network.
  prefs: []
  type: TYPE_NORMAL
- en: Using network analytics to explore international trade data by UN Comtrade
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@janosovm?source=post_page-----6478adeb8ead--------------------------------)[![Milan
    Janosov](../Images/77b62460041f66ec4585a81baef81a03.png)](https://medium.com/@janosovm?source=post_page-----6478adeb8ead--------------------------------)[](https://towardsdatascience.com/?source=post_page-----6478adeb8ead--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----6478adeb8ead--------------------------------)
    [Milan Janosov](https://medium.com/@janosovm?source=post_page-----6478adeb8ead--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----6478adeb8ead--------------------------------)
    ·9 min read·Nov 24, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: In this article, I explore the UN Comtrade international trade database by focusing
    on the “Chocolate and other food preparations containing cocoa” trade category.
    While this particular focus gives my article a clear direction on a literal niche
    market, the analytical steps and methodological layers are generic. Thus, building
    on these, one can quickly analyse any sort of international trade relationship
    from energy to weaponry. When incorporating the spatiotemporal dimensions of trade
    and optionally enhancing that by information on, e.g. timely political events,
    international conflicts, and more, one can easily link such events to their macro-economic
    footprint as well. While the implications of international trade data analysis
    are far-reaching, let’s now use network and explorative data science to dive into
    the top exporters and their trading relationships on chocolate.
  prefs: []
  type: TYPE_NORMAL
- en: '*In this article, all images — if not stated in the caption otherwise — were
    created by the author.*'
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Data collection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once I logged into the [Comtrade](https://comtradeplus.un.org/TradeFlow) website,
    I arrived at its TradeFlow interface — a nice online platform where I could easily
    build queries to obtain international trade data of any sort.
  prefs: []
  type: TYPE_NORMAL
- en: 'In that interface, one can freely select the exporting parties, the traded
    goods, the time period, and a few more features characteristic to trade. For this
    article, I picked the group of items marked HS1806 (“Chocolate and other food
    preparations containing cocoa”), using the terminology of the so-called [Harmonized
    System](https://www.flexport.com/data/hs-code/1806-chocolate-and-other-food-preparations-containing-cocoa/).
    Additionally, I focused on only exported goods, between all possible Reporters
    (who export) and Partners (who receive), and a time frame going back to the past
    20 years. Note: one query can cover 12 years top, so I run two queries, each covering
    10 years. Once a query is done, the web-based platform automatically downloads
    the resulting .csv file.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e12ce56318bec8db8bbc72d53c8153d4.png)'
  prefs: []
  type: TYPE_IMG
- en: Screenshot on how to query data from Comtrade — [https://comtradeplus.un.org/TradeFlow](https://comtradeplus.un.org/TradeFlow).
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Explore the data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Once I downloaded the two time periods on two .csv files, I started to explore
    them. The first thing I do is to combine the two files into one Pandas DataFrame,
    and then explore its features:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of this cell:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4ff6b0f4e299180c21b1aa16f622fa45.png)'
  prefs: []
  type: TYPE_IMG
- en: The size and a sample of the trade data.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, it seems that the merged DataFrame has more than 100k records! That is
    quite some data on sweets. Let’s see the features of each record:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of this cell:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/07b820ecddfa67c390a5312f5618f8bb.png)'
  prefs: []
  type: TYPE_IMG
- en: The different features of the trade data.
  prefs: []
  type: TYPE_NORMAL
- en: As this cell shows, there are quite a few — 48, to be exact — columns in this
    spreadsheet. However, to uncover the main patterns behind chocolate trading, I
    will only focus on a few of them.
  prefs: []
  type: TYPE_NORMAL
- en: Namely, on the sending and receiving parties, which countries’ English names
    are stored in the *ReporterDesc* and *PartnerDesc* columns. I also add information
    on the quality and quantity of the traded items — the *PrimaryValue* containing
    the total cash value of the transactions and the *GrossWgt*, the total physical
    mass of the transported sweets. Finally, I also keep some parts of the temporal
    information — in particular, *RefYear*- showing the year the transaction occurred.
  prefs: []
  type: TYPE_NORMAL
- en: Then, I create a cleaned version of the original DataFrame by only keeping the
    selected columns and dropping those records that do not correspond to any actual
    trade.
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: once looking at the missing values, it turns out that there are many
    transactions with a *PrimaryValue* field, but the *GrossWgt* is actually missing.
    This is a data quality issue, so I was careful when following the following filtering
    steps.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of this code block:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d026193813dd842400580582fe7d606a.png)'
  prefs: []
  type: TYPE_IMG
- en: The fraction of missing values for each feature.
  prefs: []
  type: TYPE_NORMAL
- en: So it seems that about half the trading transactions miss the *GrossWgt* information
    — however, they still have a price tag!
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The outputs of this cell:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/278dec0b60e69646eca748f361d3dc7e.png)'
  prefs: []
  type: TYPE_IMG
- en: The cleaned DaatFrame.
  prefs: []
  type: TYPE_NORMAL
- en: The filtering only decreased the size of the data by a few percentages, implying
    that very few countries are missing out on the chocolate export. Seems intuitive!
  prefs: []
  type: TYPE_NORMAL
- en: 'Now create a simple distribution plot to see how each continuous value of these
    look like:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dafd96880af9e131f3718b6eb143e9f9.png)'
  prefs: []
  type: TYPE_IMG
- en: Distribution plots of trade features.
  prefs: []
  type: TYPE_NORMAL
- en: The first two figures show the log-scaled distributions of the cash value and
    gross weight of the traded transactions, each showing a relatively unsurprising
    power-law trend, with many smaller-sized transactions and a few extremely large
    ones.
  prefs: []
  type: TYPE_NORMAL
- en: Then comes the temporal evolution — the number of transactions per year and
    a scatter plot indicating a high correlation between the total weight and price
    of cocoa products — the more is traded, the more it costs.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s take a look at the extremes — which countries have been the top
    suppliers during the past two decades:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The result of this code block is the table of top exporter countries:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9b2672811b37ee579b210b6b84847891.png)'
  prefs: []
  type: TYPE_IMG
- en: Top exporters.
  prefs: []
  type: TYPE_NORMAL
- en: As the trade values are stored in current [dollar value](https://unstats.un.org/wiki/display/comtrade/Calculation+of+dollar+value+in+trade+statistics+-+Current+value+or+constant+dollar+value),
    I summed them up during the 20-year window to come up with this top list. Based
    on global chocolate brands, I was kind of reassured to see Germany, Belgium, and
    Switzerland at the top, while the USA probably made it there due to the sheer
    size of the market.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now flip this around and see who are the biggest customers of cocoa products:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e829880e9a0454e16519a67378528b44.png)'
  prefs: []
  type: TYPE_IMG
- en: Top importers.
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Country rankings
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After seeing the aggregated, 20-year top 10, let’s see how the countries ranking
    evolved and the market changed over time:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of this code block:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/082d90d4ddd66c10dd8aade71ec42c9c.png)'
  prefs: []
  type: TYPE_IMG
- en: Countries’ annual ranking on global cocoa product export (sample).
  prefs: []
  type: TYPE_NORMAL
- en: Now, visualise how this ranking has evolved, and see what positions did the
    overall top ten countries have taken during the past twenty years.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e0c110492c3803ad6ef4555e2b2140ef.png)'
  prefs: []
  type: TYPE_IMG
- en: Annual ranking evolution of top cocoa product exporters.
  prefs: []
  type: TYPE_NORMAL
- en: The graph tells us that the rule of Germany and Belgium has never been questioned.
    The Netherlands closely followed them, but Italy, slowly climbing up since 2022,
    finally took its third place, and since then, it slowly went down to place 5.
  prefs: []
  type: TYPE_NORMAL
- en: To the end of extremes, France seems to have gone through the biggest fall,
    starting at position 3 and now arriving at position 9, while Poland, coming up
    from as low as position 13, made it to the 4th place in 2022!
  prefs: []
  type: TYPE_NORMAL
- en: 4\. The Trade Network
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Trading is a classic example of network behaviour — actors connecting to each
    other via goods, services, and cash transactions. So, the natural next step in
    my explorative analysis is to build up the trade network of countries. For this,
    I am going to rely on the package called [NetworkX](https://networkx.org).
  prefs: []
  type: TYPE_NORMAL
- en: This will be a directed network where each source node is an exporting country,
    while the target nodes are the end stations of each transaction. Additionally,
    each connection is weighted based on the dollar value of the total trade between
    each two countries during the past 20 years combined.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, I create a column Weight that is the normalized log of the *PrimaryValue*.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: This network first results in 245 nodes and 11741 links, so I generate it again
    but filter out each transaction that is smaller than the 1% of the largest one!
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Based on the outputs of this cell, this filtered graph has 51 nodes and 123
    links connecting them! Let’s export it into a Gephi file format and create the
    final visualisation in [Gephi](https://gephi.org) by applying a force layout,
    setting the node sizes to be proportional to the number of significant trading
    partners (degree in the filtered network) and scaling the link width based on
    the total traded value between the connected parties. Additionally, I colour the
    nodes based on their network communities.
  prefs: []
  type: TYPE_NORMAL
- en: 'The final visual:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aa9eb7cd0457dbf7b8dac1d807c4320f.png)'
  prefs: []
  type: TYPE_IMG
- en: The internatoinal trade network of [Chocolate and other food preparations containing
    cocoa](https://www.flexport.com/data/hs-code/1806-chocolate-and-other-food-preparations-containing-cocoa/).
  prefs: []
  type: TYPE_NORMAL
- en: A few more thoughts on the final network, visualised below, with the 30 highest-degree
    nodes labelled. As the colouring indicates, there are five communities — more
    densely interconnected subgraphs of the whole trade network, uncovering some rather
    unexpected, unofficial trade unions, for instance, one centred around the rising
    star of the field, Poland. Germany, France, and Italy seem to have built their
    own trading axis, while the Netherlands falls in the same community as the UAE.
    Interestingly, Belgium appears to be the largest node strongly linked to Asia,
    India, and Australia.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In my opinion, Comtrade is a vibrant source to analyse various aspects and dimensions
    of international trade, including volume-based and temporal statistics and network
    relationships. While this article focuses on the basics and aims to provide a
    starting point for trade data analysis, these data can easily be used to study
    macro-economical phenomena, such as the effect of international conflicts, sanctions,
    new regulations, changes and new trends in different industry domains.
  prefs: []
  type: TYPE_NORMAL

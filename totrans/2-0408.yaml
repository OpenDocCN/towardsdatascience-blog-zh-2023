- en: Introduction to Generalized Linear Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/breaking-down-generalized-linear-models-d9212526e51d](https://towardsdatascience.com/breaking-down-generalized-linear-models-d9212526e51d)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Expand your modelling skills beyond linear regression
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@egorhowell?source=post_page-----d9212526e51d--------------------------------)[![Egor
    Howell](../Images/1f796e828f1625440467d01dcc3e40cd.png)](https://medium.com/@egorhowell?source=post_page-----d9212526e51d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----d9212526e51d--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----d9212526e51d--------------------------------)
    [Egor Howell](https://medium.com/@egorhowell?source=post_page-----d9212526e51d--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----d9212526e51d--------------------------------)
    ·6 min read·Jul 10, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d2ac6a93faf461a938eb43bc346402ef.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Roman Mager](https://unsplash.com/@roman_lazygeek?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**Linear regression**](https://en.wikipedia.org/wiki/Linear_regression) is
    by far the most common algorithm we learn in data science. Every practitioner
    has heard of it and used it. However, for some problems, it is not suitable and
    we need to ‘generalise’ it. This is where [**generalized linear models** (**GLMs**)](https://en.wikipedia.org/wiki/Generalized_linear_model)
    come in and provide greater flexibility to your regression modelling and are an
    invaluable tool for data scientists to know about.'
  prefs: []
  type: TYPE_NORMAL
- en: What Are GLMs?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we said above, GLMs ‘generalise’ ordinary linear regression, but what do
    we *really* mean by that?
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s consider the simpler linear regression model:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9bc2565c51fe65fb1fc459e89800f399.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: Where ***β*** are the coefficients***, x*** is the explanatory variable and
    ***ε*** are the [**normally distributed**](https://en.wikipedia.org/wiki/Normal_distribution)
    errors.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s say we want to model how many claims calls an insurance company gets in
    an hour. Would linear regression be a suitable model for this problem?
  prefs: []
  type: TYPE_NORMAL
- en: No!
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The reasons are:'
  prefs: []
  type: TYPE_NORMAL
- en: Linear regression assumes normally distributed errors, and the normal distribution
    can take on negative values. However, we can’t get negative claim calls.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The second point is that the normal distribution, hence linear regression, is
    continuous. Whereas claims calls are all integer and discrete, we can’t get 1.1
    calls.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore, the linear regression model can’t correctly handle this exact problem.
    However, we can generalise the regression model to a probability distribution
    that meet the requirements specified above. In this case, it would be the [**Poisson
    distribution**](https://medium.com/towards-data-science/predicting-the-unpredictable-an-introduction-to-the-poisson-distribution-5afd4d70b1d7)(more
    on this later).
  prefs: []
  type: TYPE_NORMAL
- en: GLMs then simply provide a framework of how we can link our inputs to the desired
    outputs of the target distribution. They help unify many regression models together
    under one ‘mathematical umbrella.’
  prefs: []
  type: TYPE_NORMAL
- en: Supplemental Video on Poisson Distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Theoretical Framework
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Overview
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The basis of GLMs relies on three key things:'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Linear Predictor*](https://en.wikipedia.org/wiki/Linear_combination) *(Systematic
    Component)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Link Function*](https://www.statisticshowto.com/link-function/#:~:text=A%20link%20function%20in%20a,variable%20in%20a%20linear%20way.)
    *(Random Component)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Exponential Family*](https://en.wikipedia.org/wiki/Exponential_family)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We will now run through what each of these things means.
  prefs: []
  type: TYPE_NORMAL
- en: Linear Predictors
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is the simplest one to understand. A Linear predictor, ***η****,* just
    means we have a linear sum of the inputs (explanatory variables/covariates), ***x***,
    multiplied by their corresponding coefficients, ***β***:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/332750f4d7a3f759e6d1a682c9cd9370.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: Link Function
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The link function, ***g***, is *literally* responsible for ‘linking’ the linear
    predictor to the mean response of our target distribution, ***μ***:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e645722a09a95f38179100bdfaf15533.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: Exponential Family
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Overview**'
  prefs: []
  type: TYPE_NORMAL
- en: A requirement for GLMs is that the target distribution of the output needs to
    be part of the [**exponential family**](https://en.wikipedia.org/wiki/Exponential_family)**.**
    This family of distributions contains many famous distributions that you probably
    heard of such as [**Poisson**](https://medium.com/towards-data-science/predicting-the-unpredictable-an-introduction-to-the-poisson-distribution-5afd4d70b1d7)**,**
    [**Binomial**](https://medium.com/towards-artificial-intelligence/decoding-the-binomial-distribution-a-fundamental-concept-for-data-scientists-81c64c7e4580)**,**
    [**Gamma**](https://medium.com/towards-data-science/gamma-distribution-simply-explained-d95a9de16278)**,**
    and[**Exponential**](https://medium.com/towards-data-science/exponential-distribution-simply-explained-349d05b1bdb8)**.**
  prefs: []
  type: TYPE_NORMAL
- en: In the GLM framework we actually use the [**exponential dispersion model**](https://en.wikipedia.org/wiki/Exponential_dispersion_model),
    which is a further generalisation of the exponential family.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'In order to belong to the exponential family, the probability density ([**PDF**](https://en.wikipedia.org/wiki/Probability_density_function))
    or mass function ([**PMF**](https://en.wikipedia.org/wiki/Probability_mass_function))
    requires to be re-factored and parameterised in the form shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/39f1219ecd33e41c53794321a54a3b2a.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: This form is chosen for statistical convenience, but we don’t need to worry
    too much about why this is the case in this article.
  prefs: []
  type: TYPE_NORMAL
- en: Notice there are two parameters ***θ*,** which is the natural or [**canonical**](https://en.wikipedia.org/wiki/Canonical_form)
    parameter that relates the inputs to the outputs, and ***ϕ*** which is the dispersion
    parameter.
  prefs: []
  type: TYPE_NORMAL
- en: 'Another cool fact is that the distributions in the exponential family all have
    [**conjugate priors**](https://en.wikipedia.org/wiki/Conjugate_prior). This makes
    them useful for [**Bayesian problems**](https://medium.com/towards-artificial-intelligence/conditional-probability-and-bayes-theorem-simply-explained-788a6361f333).
    If you want to learn more about conjugate priors, checkout my article on it here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/bayesian-conjugate-priors-simply-explained-747218be0f70?source=post_page-----d9212526e51d--------------------------------)
    [## Bayesian Conjugate Priors Simply Explained'
  prefs: []
  type: TYPE_NORMAL
- en: A computationally effective way of carrying out Bayesian statistics
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/bayesian-conjugate-priors-simply-explained-747218be0f70?source=post_page-----d9212526e51d--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: '**Canonical link function**'
  prefs: []
  type: TYPE_NORMAL
- en: 'There is something called the canonical link function, which is given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/97dbfd48a2b56caa6be58858268a51ae.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: So, if we can describe ***θ*** in terms of ***μ,*** then we have derived the
    natural link function for our target distribution!
  prefs: []
  type: TYPE_NORMAL
- en: '**Mean and Variance**'
  prefs: []
  type: TYPE_NORMAL
- en: 'It can be mathematically shown that the mean, ***E(Y)***, of the exponential
    family, is given by the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0e23ca680df0ee55dfdf08ebb5fc28e2.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Likewise, the variance, ***Var(Y)***, is given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2eb689a0955d876cd1254e6ea3ca0ac5.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: If you want to see the proof for this derivation, refer to page 29 in the following
    [linked](https://www.utstat.toronto.edu/~brunner/oldclass/2201s11/readings/glmbook.pdf)
    book. In general, the solution to this is taking the derivative of the log-likelihood
    function with respect to **θ.**
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Poisson Regression Example
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Poisson Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The Poisson distribution is a famous discrete probability distribution that
    models the probability of an event happening a specific number of times with a
    known mean rate of occurrence. Checkout my previous post if you want to learn
    more about it here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/predicting-the-unpredictable-an-introduction-to-the-poisson-distribution-5afd4d70b1d7?source=post_page-----d9212526e51d--------------------------------)
    [## Predicting the Unpredictable: An Introduction to the Poisson Distribution'
  prefs: []
  type: TYPE_NORMAL
- en: An overview of one of the most famous probability distributions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/predicting-the-unpredictable-an-introduction-to-the-poisson-distribution-5afd4d70b1d7?source=post_page-----d9212526e51d--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: 'Its PMF is given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/24a6b2df29e5fa5a80d813368a4d0573.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Where:'
  prefs: []
  type: TYPE_NORMAL
- en: '**e**: *Euler’s number (~ 2.73)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**x**: *Number of occurrences (≥ 0)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**λ***: Expected number of occurrences (≥ 0), this is also the mean in the
    GLM notation* ***μ***'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In Exponential Form
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We can write the above Poisson PMF in exponential form by taking the natural
    log of both sides:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4e0758d39db9712db82bbf69f6d6a30d.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, we raise both sides with respect to Euler’s number:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cd120ee938e29d609d8bfc9e6940c71f.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: And voila, the Poisson PMF is now in exponential form!
  prefs: []
  type: TYPE_NORMAL
- en: 'By matching the coefficients with the above equation and the exponential family
    PDF, we find the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ad034afa0c60f07f4bf1c1e8fbac1126.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Therefore, the mean and variance of the Poisson distribution is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8b2a596dd72c5e30c4bcb909bc3f664f.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: This is a known result for the Poisson distribution and we have just derived
    a different way!
  prefs: []
  type: TYPE_NORMAL
- en: Poisson GLM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The canonical link function for the Poisson distribution is then given by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b0623289839126c042cddc41d13145ef.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Therefore, the Poisson regression equation is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0802b1107133c48668af0efe8aa86a8e.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation generated by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: We can verify the output of this equation can only be positive, therefore would
    satisfy the requirement for predicting the number of claim calls an insurance
    company receives problem.
  prefs: []
  type: TYPE_NORMAL
- en: You can then solve for the estimators through [**maximum likelihood estimation**](https://en.wikipedia.org/wiki/Maximum_likelihood_estimation)or
    [**iterated reweighted least squares**](https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares).
  prefs: []
  type: TYPE_NORMAL
- en: Whats The Point?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You may be wondering why I have just taken you through all this arduous maths.
    Well let me quickly summarise the key take-home messages:'
  prefs: []
  type: TYPE_NORMAL
- en: '*It is paramount to check the requirements of your problem and your target
    distribution to avoid non-sensical results.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*GLMs provide a mathematical first-principles approach to how you can link
    your input to your desired output for that specific problem.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary & Further Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The standard linear regression model is powerful but is not suitable for all
    types of problems such as where the output is non-negative. For these specific
    problems, we must use other distributions, like the Poisson, and GLMs provide
    a framework for how we can carry out this process. They do this by deducing a
    link function from first principles which enables you to transform your input
    to your desired target output distribution. GLMs are a powerful modelling tool
    that most data scientists should at least be aware of due to their versatility.
  prefs: []
  type: TYPE_NORMAL
- en: Another Thing!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have a free newsletter, [**Dishing the Data**](https://dishingthedata.substack.com/),
    where I share weekly tips for becoming a better Data Scientist. There is no “fluff”
    or “clickbait,” just pure actionable insights from a practicing Data Scientist.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://newsletter.egorhowell.com/?source=post_page-----d9212526e51d--------------------------------)
    [## Dishing The Data | Egor Howell | Substack'
  prefs: []
  type: TYPE_NORMAL
- en: How To Become A Better Data Scientist. Click to read Dishing The Data, by Egor
    Howell, a Substack publication with…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: newsletter.egorhowell.com](https://newsletter.egorhowell.com/?source=post_page-----d9212526e51d--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Connect With Me!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**YouTube**](https://www.youtube.com/@egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**LinkedIn**](https://www.linkedin.com/in/egor-howell-092a721b3/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Twitter**](https://twitter.com/EgorHowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**GitHub**](https://github.com/egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: References & Further Reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Some further interesting theory and derivations: [https://www.cs.princeton.edu/courses/archive/fall11/cos597C/lectures/exponential-families.pdf](https://www.cs.princeton.edu/courses/archive/fall11/cos597C/lectures/exponential-families.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'And more theory: [https://www.stat.purdue.edu/~dasgupta/expfamily.pdf](https://www.stat.purdue.edu/~dasgupta/expfamily.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The bible on GLMs: [https://www.utstat.toronto.edu/~brunner/oldclass/2201s11/readings/glmbook.pdf](https://www.utstat.toronto.edu/~brunner/oldclass/2201s11/readings/glmbook.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

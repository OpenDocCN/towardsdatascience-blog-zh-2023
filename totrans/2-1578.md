# 最新的DeepMind工作揭示了语言模型的极致提示种子

> 原文：[https://towardsdatascience.com/new-deepmind-work-unveils-supreme-prompt-seeds-for-language-models-e95fb7f4903c](https://towardsdatascience.com/new-deepmind-work-unveils-supreme-prompt-seeds-for-language-models-e95fb7f4903c)

## 如何通过计算优化的提示使语言模型表现出色，以及这如何影响提示工程

[](https://lucianosphere.medium.com/?source=post_page-----e95fb7f4903c--------------------------------)[![LucianoSphere (Luciano Abriata, PhD)](../Images/a8ae3085d094749bbdd1169cca672b86.png)](https://lucianosphere.medium.com/?source=post_page-----e95fb7f4903c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e95fb7f4903c--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e95fb7f4903c--------------------------------) [LucianoSphere (Luciano Abriata, PhD)](https://lucianosphere.medium.com/?source=post_page-----e95fb7f4903c--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e95fb7f4903c--------------------------------) ·阅读时间11分钟·2023年11月8日

--

![](../Images/1fb04d056a98fae3386085e529a642a9.png)

图片由 [Ali Shah Lakhani](https://unsplash.com/@alishahlakhani?utm_source=medium&utm_medium=referral) 提供，来源于 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

随着我们见证人工智能（AI）的稳步进步，每个月完成越来越困难的任务，人们普遍关注未来的劳动市场。如果AI继续自动化许多当前由人类执行的任务，未来的职业会是什么样的呢？有一种观点认为“*编程这些系统将是人类的工作多年*”，或者“*我们将始终需要人类来维护和重新训练AI模型*”，或者“*设计有效的提示以正确引导AI模型是人类的技能*”。本文的重点就是后者，这促使了“提示工程”作为一种“职业”的出现。确实，编写高效提示以使AI模型准确地执行期望的操作，或使其“思考”得足够好以改善其答案，尤其是对问题，是一种技巧。看看这个作为一个例子：

[](/crafting-effective-prompts-for-summarization-using-large-language-models-dbbdf019f664?source=post_page-----e95fb7f4903c--------------------------------) [## 针对大语言模型的有效提示工程

### 提炼出关键点，基于超过2年的经验以及AI开发者自己的教程、实践和示例。

towardsdatascience.com](/crafting-effective-prompts-for-summarization-using-large-language-models-dbbdf019f664?source=post_page-----e95fb7f4903c--------------------------------)

然而，这些人工干预中的任何一种很可能都不会永远保持相关性。特别是在提示工程方面，这些技能看起来很快就不会再那么重要了。继续阅读以了解原因，并在过程中了解DeepMind在最近的预印本中报告的非常有趣的发现，当使用大型语言模型（LLMs）时，你可以立即将这些发现应用于自身利益，我会通过ChatGPT免费版的实践示例来展示给你。

# 提示优化

在深入之前，我们需要了解“提示”的概念。提示是传递给AI模型的指令，用来告诉它们我们希望它们做什么。AI模型响应用户生成的文本输入或提示，以生成其输出——文本、图形、音频等。输入提示的质量和具体性显著影响模型生成的内容和质量。此外，不同的用户可能会有不同的请求或提问方式，并不是所有的方式都能高效地产生预期的答案和正确的信息。

过去，制定有效提示的艺术并不被很好地理解。早在2019年，OpenAI就揭示了在文本输入末尾添加“tl;dr”（通常用于请求总结）可以使模型总结前面的文本。尽管当时这只是一个学术好奇，但随着时间的推移，研究人员和爱好者开始发现特定的措辞可以解锁这些AI模型的增强潜力。正是这一点催生了“提示工程（学）”这一“领域”和“职业”。

提示工程师成为了制定能够引发AI模型期望回应的提示的专家。他们在互联网上分享了他们的“魔法短语”和技巧，从而有效地创造了一个新的专业领域。这些专业人员的需求迅速增长，提示工程师的职位开始出现，突显了这些人在AI领域的重要影响。

提示工程师基本上是为了最佳输出而优化提示。但是，优化是计算机做得非常好的任务；因此，它们很可能会取代人工提示工程师。这可能即将发生：在他们最近的预印本中，DeepMind展示了AI模型可以用来优化自身的输入，从而使得“提示工程”在传统意义上变得有些过时和低效。

# 大型语言模型作为自身提示的优化器

最近DeepMind的论文《[大型语言模型作为优化器](https://arxiv.org/abs/2309.03409)》探讨了如何有效地优化……它们自己的输入提示！

让我们看看这是什么，它如何与训练和优化相关，以及DeepMind的工作究竟发现了什么。哦，我们还可以尝试一些计算机优化的提示。你会感到惊讶。

传统上，在机器学习中，优化过程涉及调整模型的内部参数（“权重”，即描述不同人工神经元如何连接的大量数字）以最小化误差。通常，在训练阶段，模型会接收到大量已知的输入-输出对，并且所有权重都按照传统的数学方式进行优化，以使模型“学习”。然而，一旦模型训练完成，我们仍然可以通过以不同方式提供输入来使用它，这些输入将根据训练过程中计算的权重集以不同的方式传播，因此它们的输出也会不同……有些更好，有些更差。然后，可以优化如何提供输入，在语言模型的特殊情况下，就是优化提示。像任何优化协议一样，我们人类可以通过试错来完成这一过程，但显然计算机比我们更擅长——这只是一个让他们去做的事情！

DeepMind工作的核心思想是使用各种AI模型生成特定任务的提示，然后测试不同提示在实现期望结果方面的有效性。例如，如果任务是解决一个数学问题，用户可以输入一个非常简单的提示，直接提出问题，或者他/她可能会在问题前面加上一句种子句，如“逐步解决这个数学问题。”，或者“我们一步步解决这个问题。”等。在某些情况下，种子句可能有助于改善AI的输出，即使问题本身以完全相同的方式提出。

基于这一思想，DeepMind的工程师尝试了不同的种子提示，然后用完全相同的问题进行测试，并评估答案的质量（正确性）。他们重复了这个过程，将一系列提示应用于多个不同的问题，并最终统计了每个种子句产生的正确答案数量，以比较对每个问题的影响。

从经验来看，我们知道这种策略应该有效于找到如何优化提示。然而，对于我们人类来说，大规模地进行样本测试是不可能的。通过使用计算机架构，DeepMind能够大规模地运行这个过程，并且在不同类型的问题上进行测试。

结果令人惊讶：如果没有使用或使用了不好的种子句，问题只能在约50%的情况下正确解决，而当使用了好的种子句时，正确率可以达到80%。

DeepMind的方法包括使用这些测试中的指标来指导更好提示的创建。他们得出的结论是，通过持续迭代提示并考虑模型的反馈，AI系统可以改进其提示生成过程，对输出产生非常重要的影响。

请注意，这种方法并不涉及更新模型的内部参数，如同训练模型时所做的那样，而是专注于优化输入本身。

# 一些有趣的动手示例

这是一些我自己测试中灵感来自 DeepMind 工作的有趣示例，你也可以立即使用 ChatGPT 免费版尝试（该版本由 DeepMind 预印本中显示为 GPT-3.5-Turbo 的模型提供支持）。

## 示例 1，复制 DeepMind 预印本中展示的一个问题的思路

DeepMind 论文中引起我注意的第一个例子是要求进行线性回归，因为既然这些模型原则上无法进行数学运算，那么我期望它们永远无法工作，无论提供什么提示。

如果你要求 ChatGPT 对非常简单的数据进行线性回归，比如 *x = [1, 2, 3, 4]* 和 *y = [2, 4, 6, 8]*，你会发现它会立即正确地解决。但如果我们用更难的线性回归来挑战它呢？让我们看看。

在这里，我生成了不同 *x* 值的合成数据，这些值在 0 和 12 之间随机分布，并使用方程 *y = 3.5 x — 11.5* 在常规电子表格程序中计算了没有噪声的 *y* 值。然后，我要求程序“找到描述这些数据的线性方程：”并跟上 x 和 y 对。就像这样：

![](../Images/4837401b4c71f4cdf147eb48feec8694.png)

从与 ChatGPT 免费版交互时的截图，进行测试时使用。

这是我得到的答案：

![](../Images/0b7ba18f04a582e1d3063077c8b570cd.png)

从与 ChatGPT 免费版交互时的截图，进行测试时使用。

你清楚地看到答案是错误的，并且它经过了一些我没有要求的编码。更令人困惑的是，这段代码看起来本身是正确的，并且可能会导致正确的解决方案，但文本生成所呈现的“结果”是错误的。

我尝试重新生成问题，得到了另一个不正确的答案，这次没有调用任何代码生成，而是尝试直接处理：

![](../Images/bc28e810687c5b8ad4972a029af8a370.png)

从与 ChatGPT 免费版交互时的截图，进行测试时使用。

现在来看看“魔法”。

如果我们用 DeepMind 报告能显著改善 GPT-3.5-Turbo 答案的以下句子来引导提示会怎么样？（摘自预印本的表 1）：

“*一点算术和逻辑方法将帮助我们快速得到这个问题的解决方案。*”？

我们来试试：

![](../Images/a473821623b89b839b3cf8f2dc2cfba1.png)

从与 ChatGPT 免费版交互时的截图，进行测试时使用。

严格来说，这不算回归，但逻辑是完美的，结果是正确的！

## 示例 2，使用 DeepMind 发现的种子句子在 **GSM8K** 上表现最佳的化学问题

GSM8K是一个由人工问题编写者创建的高质量且语言多样的小学数学单词问题的大型数据集。DeepMind使用这个数据集来评估几个LLM的能力，发现对于GPT-3.5-Turbo，最佳的提示开始方式是：

> 分析给定的信息，将问题分解为可管理的步骤，应用合适的数学运算，并提供一个清晰、准确、简洁的解决方案，如有必要，确保精确四舍五入。考虑所有变量，仔细考虑问题的背景，以便有效地解决问题。

所以，我选择了一个关于化学计量学的问题（在化学中，就是根据给定的试剂量或反之，计算得到的产物量），并要求ChatGPT解决，首先是不带种子句子，然后是带上种子句子。

这是没有任何种子提示的情况：

![](../Images/7da6125b5df9e8b7b66eb193e43b24d4.png)

这是与ChatGPT免费版本互动的截图，在进行测试时（在这种情况下，侧边并排显示）。

答案完全错误，因为在(a)中我们要求的是分子数量，而不是摩尔数，而在(b)中我们要求的是质量，但数字是错的。

正确答案是5.337E22分子和10.41克Zn(CN)2。

现在让我们看看当我在问题前加上种子句子时发生了什么：

![](../Images/cff6f674c1f8ec7ff999f09d3265edef.png)

这是与ChatGPT免费版本互动的截图，在进行测试时（在这种情况下，侧边并排显示）。

> **我。感到。惊讶。**

两个答案都是完全正确的！（并且计算过程非常详细。）

我想我得重新修订并重写我很久以前写的这篇博客，当时GPT-3刚刚发布：

[](/devising-tests-to-measure-gpt-3s-knowledge-of-the-basic-sciences-4bbfcde8286b?source=post_page-----e95fb7f4903c--------------------------------) [## 设计测试以测量GPT-3对基础科学的知识

### 学生们能从OpenAI最新的语言模型中学习，并将其用作全天候顾问吗？学生们能用它来……

[towardsdatascience.com](/devising-tests-to-measure-gpt-3s-knowledge-of-the-basic-sciences-4bbfcde8286b?source=post_page-----e95fb7f4903c--------------------------------)

# 手动提示工程的终结？

这些以及其他近期的发展表明，我们可能正在见证手动提示工程时代的结束，以及一个新的时代的开始，在这个时代中，你无需掌握每个AI的提示语言就能获得所需的结果。如果你尝试了DALL-E 3，你一定会发现它在理解你的意图方面做得更好，即使使用的是你一直使用的相同提示。用户可以越来越自然地指示模型，甚至让AI系统自动生成能够产生所需结果的提示。

AI优化AI：似乎非常强大。那么呢？工作呢？

从历史上看，以前的工业和技术革命产生了新的工作形式，通常伴随着重大的经济和社会变革，带来了不可预测的后果。在那些时代，随着工作的自动化，新的角色应运而生，以满足每个时代的需求——因此工作虽然改变了，但始终存在。

但随着人工智能革命的到来，这可能会有所不同。我们可能首次面临一种能够适应新挑战并学习未来将出现的任务和工作的自动化力量，包括如何控制自身。

## 我们在短期内会得到什么？

仅仅触及AI模型的一种可改进的特征，DeepMind的预印本显示，单凭优化提示而不进行实际的再训练或微调，我们就可以让LLMs表现得更好，其他生成性AI模型也必定是如此。

这种提示的优化很难被人类匹配，特别是当优化的提示有意义但其确切形式并不明显时——见我上面提供的第二个示例，其中最优的种子提示相当长且非常具体。

这些发现和进展表明，我们正朝着一个未来发展，在这个未来中，人工智能系统将能够自行生成非常有效的提示，从而减少对手动提示工程的需求。因此，提示工程师的角色可能会发生变化，那些无法适应新自动化程序并学习在哪里仍然有人工干预空间的提示工程师将被淘汰。

区分可能具有不同未来的两种角色至关重要。一方面，如果你的工作是手动创建提示，随着人工智能模型在生成自身提示方面变得更加熟练，你的角色可能变得不那么相关且需求减少。另一方面，如果你的角色涉及在更广泛的系统中优化AI模型的使用，其中你将其与非AI软件或代码的输入和输出相结合，并可能在其他场景中使用，那么你在劳动力市场上的价值可能对自动化更具韧性，并在长期内仍然有用。

总结我对这一问题的关键观点，就像一些人曾经快速地跟上了提示工程的潮流一样，他们现在必须保持警觉，因为人工智能及其与人类的互动正迅速发展。因此，跟踪如DeepMind的预印本或这篇博客文章等文献，对于了解如何在人工智能工具和其他人工智能工具发展时最佳地调整自己的掌握是至关重要的。

# 参考文献

DeepMind在arXiv上的预印本：

[## 大型语言模型作为优化器](https://arxiv.org/abs/2309.03409?source=post_page-----e95fb7f4903c--------------------------------)

### 优化无处不在。虽然基于导数的算法已成为解决各种问题的强大工具，...

[arxiv.org](https://arxiv.org/abs/2309.03409?source=post_page-----e95fb7f4903c--------------------------------)

另一位作家在Medium上的一篇有趣的相关博客文章：

[](https://medium.com/@minh.hoque/large-language-models-as-optimizers-explained-a20dc5e5c5af?source=post_page-----e95fb7f4903c--------------------------------) [## 大型语言模型作为优化器的解释

### 为什么这篇论文很重要

medium.com](https://medium.com/@minh.hoque/large-language-models-as-optimizers-explained-a20dc5e5c5af?source=post_page-----e95fb7f4903c--------------------------------)

[***www.lucianoabriata.com***](https://www.lucianoabriata.com/) *我写的内容涵盖了我广泛兴趣领域的一切：自然、科学、技术、编程等。* [***订阅以获取我的新故事***](https://lucianosphere.medium.com/subscribe) ***通过电子邮件****。要* ***咨询小项目*** *请查看我的* [***服务页面***](https://lucianoabriata.altervista.org/services/index.html)*。你可以* [***在这里联系我***](https://lucianoabriata.altervista.org/office/contact.html)***。*** *你也可以* [***在这里给我小费***](https://paypal.me/LAbriata)*。

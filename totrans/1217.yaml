- en: 'How To: One-Way ANOVA by Hand'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/how-to-one-way-anova-by-hand-4c19e2a61a8c](https://towardsdatascience.com/how-to-one-way-anova-by-hand-4c19e2a61a8c)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Learn how to perform a one-way Analysis Of VAriance (ANOVA) by hand to compare
    a quantitative measure between three groups or more
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://antoinesoetewey.medium.com/?source=post_page-----4c19e2a61a8c--------------------------------)[![Antoine
    Soetewey](../Images/51d7837d18ff15a62cac2343a485e35d.png)](https://antoinesoetewey.medium.com/?source=post_page-----4c19e2a61a8c--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4c19e2a61a8c--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4c19e2a61a8c--------------------------------)
    [Antoine Soetewey](https://antoinesoetewey.medium.com/?source=post_page-----4c19e2a61a8c--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4c19e2a61a8c--------------------------------)
    ·6 min read·Aug 30, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fe19036a2b1f92b4cab19e94d4f8f34a.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Rohan Makhecha](https://unsplash.com/@rohanmakhecha?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: An ANOVA is a statistical test used to compare a [quantitative variable](https://statsandr.com/blog/variable-types-and-examples/#quantitative)
    between groups to determine if there is a statistically significant difference
    between several population means. In practice, it is usually used to compare three
    or more groups. However, in theory, it can also be done with only two groups.[1](https://statsandr.com/blog/how-to-one-way-anova-by-hand/#fn1)
  prefs: []
  type: TYPE_NORMAL
- en: In a previous post, we showed how to perform a [one-way ANOVA in R](https://statsandr.com/blog/anova-in-r/).
    In this post, we illustrate how to conduct a one-way ANOVA by hand, via what is
    usually called an “ANOVA table”.
  prefs: []
  type: TYPE_NORMAL
- en: Data and hypotheses
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To illustrate the method, suppose we take a [sample](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)
    of 12 students, divided equally into three classes (A, B and C) and we observe
    their age. Here is the sample:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4164bb0dd850bfd1ef18777059f543e7.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: We are interested in comparing the [population](https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/)
    means between classes.
  prefs: []
  type: TYPE_NORMAL
- en: 'Remember that the null hypothesis of the ANOVA is that all means are equal
    (i.e., age is not significantly different between classes), whereas the alternative
    hypothesis is that at least one mean is different from the other two (i.e., age
    is significantly different in at least one class compared to the other two). Formally,
    we have:'
  prefs: []
  type: TYPE_NORMAL
- en: μA = μB = μC
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: at least one mean is different
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ANOVA by hand
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As mentioned above, we are going to do an ANOVA table to conclude the test.
  prefs: []
  type: TYPE_NORMAL
- en: Note that the ANOVA requires some assumptions (i.e., independence, equality
    of variances and normality). The aim of this post is to illustrate how to do an
    ANOVA by hand and not how to verify these assumptions, so we suppose they are
    met without any verification. See how to [test these assumptions in R](https://statsandr.com/blog/anova-in-r/#underlying-assumptions-of-anova)
    if you are interested.
  prefs: []
  type: TYPE_NORMAL
- en: Overall and group means
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We first need to compute the [mean](https://statsandr.com/blog/descriptive-statistics-by-hand/#mean)
    age by class (referred as the group means):'
  prefs: []
  type: TYPE_NORMAL
- en: 'class A: (24+31+26+23) / 4 = 26'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'class B: (24+21+19+24) / 4 = 22'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'class C: (15+21+18+18) / 4 = 18'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'and the mean age for the whole sample (referred as the overall mean):'
  prefs: []
  type: TYPE_NORMAL
- en: (24+31+26+23+24+21+1912+24+15+21+18+18) / 12 = 22
  prefs: []
  type: TYPE_NORMAL
- en: SSR and SSE
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We then need to compute the sum of squares regression (SSR), and the sum of
    squares error (SSE).
  prefs: []
  type: TYPE_NORMAL
- en: 'The SSR is computed by taking the square of the difference between the mean
    group and the overall mean, multiplied by the number of observations in the group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/73e0b14daad83c79c7d384162584da20.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'and then taking the sum of all cells:'
  prefs: []
  type: TYPE_NORMAL
- en: 64+0+64 = 128 = SSR
  prefs: []
  type: TYPE_NORMAL
- en: 'The SSE is computed by taking the square of the difference between each observation
    and its group mean:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/90330e84d6fef605ec33c22700d80d48.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'and then taking the sum of all cells:'
  prefs: []
  type: TYPE_NORMAL
- en: 4+25+0+9+4+1+9+4+9+9+0+0 = 74 = SSE
  prefs: []
  type: TYPE_NORMAL
- en: For those interested in computing the sum of square total (SST), it is simply
    the sum of SSR and SSE, that is,
  prefs: []
  type: TYPE_NORMAL
- en: SST = SSR + SSE = 128 + 74 = 202
  prefs: []
  type: TYPE_NORMAL
- en: ANOVA table
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The ANOVA table looks as follows (we leave it empty and we are going to fill
    it in step by step):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a4f90e13abbea87622190882ba14ca75.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We start to build the ANOVA table by plugging the SSR and SSE values found
    above into the table (in the “Sum.of.Sq.” column):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4e8d5790595fc2f2523dc3e9663c4e36.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'The “Df” column corresponds to the degrees of freedom, and is computed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'for the line regression: number of groups-1 = 3–1 = 2'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'for the line error: number of observations-number of groups = 12–3 = 9'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'With this information, the ANOVA table becomes:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7fbdaee538e8d3de78ee143bdba03e18.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'The “Mean.Sq.” column corresponds to the Mean Square, and is equal to the sum
    of square divided by the degrees of freedom, so the “Sum.of.Sq.” column divided
    by the “Df” column:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2b300dd748ec0004aa8cd2d016356812.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, the F-value corresponds to the ratio between the two mean squares,
    so 64 / 8.222 = 7.78:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0809c9876a457bc4f646f35ee16548bc.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: This F-value gives the test statistic (also referred as Fobs), which needs to
    be compared with the critical value found in the Fisher table to conclude the
    test.
  prefs: []
  type: TYPE_NORMAL
- en: 'We find the critical value in the Fisher table based on the degrees of freedom
    (those used in the ANOVA table) and based on the significance level. Suppose we
    take a significance level α = 0.05, the critical value can be found in the Fisher
    table as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5f6e477a7b07d15f139ae216304ec90b.png)'
  prefs: []
  type: TYPE_IMG
- en: Table by author
  prefs: []
  type: TYPE_NORMAL
- en: So we have
  prefs: []
  type: TYPE_NORMAL
- en: F(2;9;0.05) = 4.26
  prefs: []
  type: TYPE_NORMAL
- en: 'If you are interested to find this value with R, it can be found with the `qf()`
    function, where 0.95 corresponds to 1−α:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Conclusion of the test
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The rejection rule says that, if:'
  prefs: []
  type: TYPE_NORMAL
- en: Fobs > F(2;9;0.05) ⇒ we reject the null hypothesis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fobs ≤ F(2;9;0.05) ⇒ we *do not* reject the null hypothesis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In our case,
  prefs: []
  type: TYPE_NORMAL
- en: Fobs = 7.78 > F(2;9;0.05) = 4.26
  prefs: []
  type: TYPE_NORMAL
- en: ⇒ We reject the null hypothesis that all means are equal. In other words, it
    means that at least one class is different than the other two in terms of age.[2](https://statsandr.com/blog/how-to-one-way-anova-by-hand/#fn2)
  prefs: []
  type: TYPE_NORMAL
- en: 'To verify our results, here is the ANOVA table using R:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'We found the same results by hand, but note that in R, the p-value is computed
    instead of comparing the Fobs with the critical value. The p-value can easily
    be found in R based on the Fobs and the degrees of freedom:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thanks for reading.
  prefs: []
  type: TYPE_NORMAL
- en: I hope this article helped you to conduct a one-way ANOVA by hand. See this
    [tutorial](https://statsandr.com/blog/anova-in-r/) if you want to learn how to
    do it in R.
  prefs: []
  type: TYPE_NORMAL
- en: As always, if you have a question or a suggestion related to the topic covered
    in this article, please add it as a comment so other readers can benefit from
    the discussion.
  prefs: []
  type: TYPE_NORMAL
- en: In that case, a [Student’s t-test](https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/)
    is usually preferred over an ANOVA, although both tests will lead to the exact
    same conclusions.[↩︎](https://statsandr.com/blog/how-to-one-way-anova-by-hand/#fnref1)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remember that an ANOVA cannot tell you which group is different than the other
    in terms of the quantitative dependent variable, nor whether they are all different
    or if only one is different. To answer this question, post-hoc tests are required.
    This is beyond the scope of the present post, but it can easily be done in R (see
    this [tutorial](https://statsandr.com/blog/anova-in-r/)).[↩︎](https://statsandr.com/blog/how-to-one-way-anova-by-hand/#fnref2)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Related articles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[One-sample Wilcoxon test in R](https://statsandr.com/blog/one-sample-wilcoxon-test-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Hypothesis test by hand](https://statsandr.com/blog/hypothesis-test-by-hand/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[ANOVA in R](https://statsandr.com/blog/anova-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Correlation coefficient and correlation test in R](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[One-proportion and chi-square goodness of fit test](https://statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Originally published at* [*https://statsandr.com*](https://statsandr.com/blog/how-to-one-way-anova-by-hand/)
    *on August 30, 2023.*'
  prefs: []
  type: TYPE_NORMAL

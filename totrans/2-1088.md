# 多少键位足够弹奏钢琴？

> 原文：[https://towardsdatascience.com/how-many-keys-are-enough-to-play-the-piano-639916f47a22](https://towardsdatascience.com/how-many-keys-are-enough-to-play-the-piano-639916f47a22)

## 使用Python、MIDI和Matplotlib寻找答案

[](https://dmitryelj.medium.com/?source=post_page-----639916f47a22--------------------------------)[![Dmitrii Eliuseev](../Images/7c48f0c016930ead59ddb785eaf3e0e6.png)](https://dmitryelj.medium.com/?source=post_page-----639916f47a22--------------------------------)[](https://towardsdatascience.com/?source=post_page-----639916f47a22--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----639916f47a22--------------------------------) [Dmitrii Eliuseev](https://dmitryelj.medium.com/?source=post_page-----639916f47a22--------------------------------)

·发表于[数据科学前沿](https://towardsdatascience.com/?source=post_page-----639916f47a22--------------------------------) ·阅读时长9分钟·2023年12月23日

--

![](../Images/c44ccfaa64fbed9efdb75a2dc66e3bf7.png)

照片由Cedrik Malabanan拍摄，[Unsplash](https://unsplash.com/@ohboyced)

学习弹钢琴是一个具有挑战性且有趣的过程，但每个新手都会面临一个困境：应该买什么样的乐器？市场上的选择非常广泛，从上面照片中的小型两八度乐器到70公斤重的全尺寸木质键盘。一方面，额外的键位永远不会有害；另一方面，尺寸、重量和价格之间总是存在权衡。

显然，一种方法是直接问老师他或她推荐什么，但也许大多数音乐家从未从那个角度考虑过音乐。有没有更量化的方法来寻找答案？事实上，答案是肯定的；我们可以使用Python轻松制作音乐音符分布。

本教程对数据科学初学者很有用；它不需要复杂的数学或库，并且结果易于解释。它也对那些想学习音乐但尚未决定购买哪种乐器的人很有用。

让我们开始吧！

## 数据来源

对于数据分析，我将使用[MIDI](https://en.wikipedia.org/wiki/MIDI)文件。这是一种相当古老的格式；第一个MIDI（Musical Instrument Digital Interface）规格发布于1983年。MIDI文件的关键特征是，它们存储的音乐不是原始音频，而是以“原始”符号形式。MIDI文件中的每个记录包含乐器类型、音高、时序和其他参数。例如，我可以在免费的[MuseScore](https://github.com/musescore/MuseScore)应用程序中打开贝多芬的*降C小调小品*，并看到如下内容：

![](../Images/7ebeee591b4fd2cbb2918453dc68c3ad.png)

MuseScore编辑器，作者截屏

让我们在Python中打开同一个文件并转储其内容：

[PRE0]

输出如下（完整文件更长；在这里，我仅打印每个轨道的前几行）：

[PRE1]

如我们所见，文件包含三个轨道，第一个轨道只有元数据，另外两个轨道包含一些额外的数据和音乐音符。为了找出音乐片段中有多少不同的音符，我们将仅使用`note_on`记录。每个MIDI音符在21..108范围内有一个数字代码：

![](../Images/a34009f56ad10fc8baf17b0fd047aa26.png)

MIDI音符代码，图片来源 [Wikipedia](https://fr.wikipedia.org/wiki/Musical_Instrument_Digital_Interface)

使用这些信息，让我们创建一个函数，将MIDI文件中的所有音符提取到Python列表中：

[PRE2]

下一步，让我们创建一个处理文件夹中所有MIDI文件的函数：

[PRE3]

我们还需要一些MIDI文件。这些文件，特别是古典音乐（已进入公有领域），通常可以免费获得，并且很容易找到。对于我的分析，我使用了来自 [http://www.piano-midi.de](http://www.piano-midi.de/) 的文件（CC BY-SA德国许可）。

## 分布

此时，我们有一种方法，可以从一组MIDI文件中提取所有音乐音符。我们可以很容易地使用Matplotlib中的**直方图**查看哪些音符使用得更频繁：

[PRE4]

输出如下所示：

![](../Images/fc5a9cea18e481bf0c8b122e56cf285d.png)

音符分布，图片来源：作者

`plt.hist`方法完成了计算列表中值分布并绘制图表所需的所有工作。我们可以看到，分布看起来正常。最常用的键位于键盘的中央，这很有意义。

## 可视化

**键盘** 从技术上讲，问题已解决，使用大约20行Python代码，我们可以查看不同音乐片段的音符分布。但实际上，这不够方便，特别是对音乐家而言，我们可以做得更好。Matplotlib库可以绘制的不仅仅是科学图表。让我们绘制一个钢琴键盘：

[PRE5]

输出如下，这比直方图要好得多：

![](../Images/5c74b603d9ca342ff0cf4d1a2bd9fc0f.png)

Matplotlib中的钢琴键盘，图片来源：作者

**热图** 下一步是可视化分布。一个方便的方法是使用热图，我们可以在键盘上绘制它。首先，我们需要一个方法将键名（C3，D3等）转换为MIDI代码。这只是一个简单的线性转换：

[PRE6]

其次，我们可以使用Python的`Counter`类来了解每个音符的使用频率：

[PRE7]

使用这段代码，我们可以将每个音符的出现频率作为热图的 alpha 通道：

[PRE8]

相同的逻辑适用于黑键；为了简便起见，我将在这里省略这段代码。

## 结果

最后，让我们回答故事标题中的问题。我们需要学习多少个钢琴键才能弹奏钢琴？

要得到答案，我们首先需要找到合适的曲目。在亚马逊上有很多钢琴课程的书籍，通常可以免费查看其第一页，这足以收集标题列表。有了标题，就容易找到MIDI文件。好吧，让我们看看一些结果。

**第一年学习：** **好国王温塞斯拉斯**（圣诞颂歌）：

![](../Images/6daf23bb9e9e4aaf5533ea393d02a840.png)

作者截图

如我们所见，这首旋律很简单，主要只使用白键，实际音符范围大约为3个音域。但没有3音域范围的钢琴可用，最接近的是4个音域。

**第二年学习：C小调的小品，WoO 52**（贝多芬）

![](../Images/eb2e419e4cbf559c84d5ad4f374858b5.png)

作者截图

如我们所见，这更复杂，使用了更多的黑键，这首曲子的范围大约为4.5个音域。

**第三年学习：慰藉曲，S. 172**（弗朗茨·李斯特）

![](../Images/f97e6642005aff0e6b3eceb5eec3bf73.png)

作者截图

在这种情况下，范围更广；几乎所有的7个音域都需要来演奏这首曲子。

## 结论

在这篇文章中，我展示了如何处理MIDI文件，并以直方图和钢琴键盘热图的形式制作音乐音符分布。这不仅对回答“我们需要多少个键”这样的问题有用。将旋律或文件列表转换为热图，可以比较不同作品、不同作曲家或不同流派的风格，例如古典与流行。这可以成为音乐学或文化人类学领域更大分析的一部分。例如，这是J.S.巴赫音乐中的音符分布，很明显范围更小：

![](../Images/583f5f7e7e784e5babf1b4ce2a61c229.png)

J.S.巴赫音符分布，作者图像

读者可能会想知道原因，答案很简单：巴赫为[大键琴](https://en.wikipedia.org/wiki/Harpsichord)创作音乐，而现代钢琴在那时还未发明。有趣的是，现在，300多年后，我们可以很容易地在热图中看到这一点！

关于钢琴课程，我必须承认，我最初认为一个4音域范围的乐器足以学习钢琴是错误的。这可能适合第一年的学习，但正如从热图中看到的，至少需要6音域范围才能演奏音乐，即使在第二年的学习中也是如此。

对社会数据分析感兴趣的人也欢迎阅读其他文章：

+   [探索性数据分析：我们对YouTube频道了解多少](/exploratory-data-analysis-what-do-we-know-about-youtube-channels-3688c5cbc438)

+   [德国住房租赁市场：使用Python的探索性数据分析](https://medium.com/towards-data-science/housing-rental-market-in-germany-exploratory-data-analysis-with-python-3975428d07d2)

+   [人们关于气候的书写：使用Python进行Twitter数据聚类](https://medium.com/towards-data-science/what-people-write-about-climate-twitter-data-clustering-in-python-2fbbd2b95906)

+   [在Twitter帖子中寻找时间模式：使用Python进行探索性数据分析](https://medium.com/towards-data-science/finding-temporal-patterns-in-twitter-posts-exploratory-data-analysis-with-python-8aac618c8699)

+   [Python数据分析：我们对流行歌曲了解多少？](https://blog.devgenius.io/python-data-analysis-what-do-we-know-about-pop-songs-b6197d85d4)

如果你喜欢这个故事，可以随时[订阅](https://medium.com/@dmitryelj/membership)Medium，你将会在我的新文章发布时收到通知，并且可以完全访问其他作者的成千上万篇故事。本文的完整源代码和Jupyter笔记本也可以在我的[Patreon页面](https://www.patreon.com/deliuseev)找到。

感谢阅读。

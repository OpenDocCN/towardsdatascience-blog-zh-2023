["```py\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nfrom datasets import load_dataset\nfrom transformers import AutoModelForSeq2SeqLM, AutoTokenizer, GenerationConfig\n```", "```py\ndataset_name = \"financial_phrasebank\"\n\ndataset = load_dataset(dataset_name, \"sentences_allagree\")\n```", "```py\nlabels_df = pd.DataFrame()\n\nlabels_from_dataset = [dataset['train'][i]['label'] for i in range(2264)]\n\nlabels_df['labels'] = labels_from_dataset\n```", "```py\nmodel_name = \"google/flan-t5-base\"\n\nmodel = AutoModelForSeq2SeqLM.from_pretrained(model_name)\n\ntokenizer = AutoTokenizer.from_pretrained(model_name, use_fast=True)\n```", "```py\nzero_shot_sentiment = []\n\nfor i in range(2264):\n    sentence = dataset['train'][i]['sentence']\n\n    prompt = f\"\"\"\nIs the follwing sentence positive, negative or neutral?\n\n{sentence}\n    \"\"\"\n\n    inputs = tokenizer(prompt, return_tensors='pt')\n    output = tokenizer.decode(\n        model.generate(\n            inputs[\"input_ids\"],\n            max_new_tokens=50\n        )[0],\n        skip_special_tokens=True\n    )\n\n    zero_shot_sentiment.append(output)\n```", "```py\nlabels_df['zero_shot_sentiment'] = zero_shot_sentiment\nlabels_df['zero_shot_sentiment'] = labels_df['zero_shot_sentiment'].map({'neutral':1, 'positive':2, 'negative':0})\n```", "```py\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\nfrom sklearn.metrics import classification_report\n\ncm = confusion_matrix(labels_df['labels'], labels_df['zero_shot_sentiment'], labels=[0,1,2])\n\ndisp_cm = ConfusionMatrixDisplay(cm, display_labels=[0,1,2])\n\ndisp_cm.plot();\n\nplt.grid(False)\nplt.tight_layout()\n\nclf_report = classification_report(labels_df['labels'], labels_df['zero_shot_sentiment'], labels=[0,1,2])\n\nprint(clf_report)\n```", "```py\none_shot_sentiment = []\n\nfor i in range(2264):\n    sentence = dataset['train'][i]['sentence']\n\n    prompt = f\"\"\"\n\nIs the follwing sentence positive, negative or neutral?\n\nStatement: \"According to Gran , the company has no plans to move all production to Russia , although that is where the company is growing .\"\nneutral\n\nIs the follwing sentence positive, negative or neutral?\nStatement: {sentence}\n\n{sentence}\n    \"\"\"\n\n    inputs = tokenizer(prompt, return_tensors='pt')\n    output = tokenizer.decode(\n        model.generate(\n            inputs[\"input_ids\"],\n            max_new_tokens=50\n        )[0],\n        skip_special_tokens=True\n    )\n\n    one_shot_sentiment.append(output)\n```", "```py\nlabels_df['one_shot_sentiment'] = one_shot_sentiment\nlabels_df['one_shot_sentiment'] = labels_df['one_shot_sentiment'].map({'neutral':1, 'positive':2, 'negative':0})\n\ncm = confusion_matrix(labels_df['labels'], labels_df['one_shot_sentiment'], labels=[0,1,2])\n\ndisp_cm = ConfusionMatrixDisplay(cm, display_labels=[0,1,2])\n\ndisp_cm.plot();\n\nplt.grid(False)\nplt.tight_layout()\n```"]
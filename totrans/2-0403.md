# Bootstrap（自助法）入门

> 原文：[https://towardsdatascience.com/bootstrap-tests-for-beginners-5fd9b092e7a6](https://towardsdatascience.com/bootstrap-tests-for-beginners-5fd9b092e7a6)

## 非参数检验入门第2部分

[](https://medium.com/@jaekim8080?source=post_page-----5fd9b092e7a6--------------------------------)[![Jae Kim](../Images/34716958ecfe8c0540f5cf5c1640d587.png)](https://medium.com/@jaekim8080?source=post_page-----5fd9b092e7a6--------------------------------)[](https://towardsdatascience.com/?source=post_page-----5fd9b092e7a6--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----5fd9b092e7a6--------------------------------) [Jae Kim](https://medium.com/@jaekim8080?source=post_page-----5fd9b092e7a6--------------------------------)

·发布在 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----5fd9b092e7a6--------------------------------) ·10分钟阅读·2023年6月19日

--

![](../Images/e426ee31bdecd2e830fa13188b8047c3.png)

照片来源：[Mohamed Nohassi](https://unsplash.com/@coopery?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

在本系列的[第1部分](/non-parametric-tests-for-beginners-part-1-rank-and-sign-tests-629704f27f2f?sk=67eea21356f2de5f0a5626a0442df459)中，我介绍了简单的秩检验和符号检验，作为非参数检验的入门。正如第1部分所述，bootstrap（自助法）也是一种流行的非参数统计推断方法，基于对观测数据的重新抽样。自从[Bradley Efron](https://scholar.google.com/citations?user=duBlF_YAAAAJ&hl=en) 在1980年代首次介绍以来，它在学术界获得了广泛的关注。[Efron 和 Tibshirani (1994)](https://www.taylorfrancis.com/books/mono/10.1201/9780429246593/introduction-bootstrap-bradley-efron-tibshirani) 提供了关于bootstrap方法的介绍性和全面的调查。该方法在统计科学领域得到了广泛应用，以上书籍至今已获得超过50,000次Google Scholar引用。

在这篇文章中，我以直观的方式介绍了自助法入门，提供了简单的示例和 R 代码。

# 介绍

如第1部分所述，假设检验的关键要素包括

1.  虚无假设和备择假设（H0 和 H1）

1.  检验统计量

1.  H0 下检验统计量的抽样分布

1.  决策规则（p值或临界值，在给定显著性水平下）

在生成检验统计量的抽样分布时，

+   *参数检验*（如 t 检验或 F 检验）假设总体遵循正态分布。如果总体不是正态的，则利用中心极限定理（称为渐近正态近似）将正态分布作为抽样分布的近似；

+   *秩和符号检验*使用数据点的秩和符号生成*精确*的抽样分布，如第1部分所讨论；

+   *自助法*生成或近似统计量的抽样分布，基于对观察数据的重新抽样（有放回），类似于从总体中随机和重复抽取样本的方式。

+   与秩和符号检验一样，自助法不要求总体正态性或基于中心极限定理的渐进正态近似。

+   自助法在其基本形式中要求从固定均值和方差的总体中进行纯随机抽样（无需正态性），尽管也有适用于依赖或异方差数据的自助法方法。

本文介绍了从总体随机生成数据的基本自助法，并附有示例。针对更一般数据结构的自助法，其简要细节和R资源在另一个部分中呈现。

# 自助法的玩具示例

## **示例 1：X = (1, 2, 3)**

假设研究者观察到数据集X = (1, 2, 3)，样本均值为2，标准差（*s*）为1。假设总体为正态，总体均值为2的假设下，样本均值（Xbar）的抽样分布为

其中*s* = 1，μ为总体均值。这意味着，在正态近似下，样本均值遵循均值为2、方差为1/3的正态分布。

自助法以有放回的方式重新抽样观察到的数据X = (1, 2, 3)，给其成员以1/3的等概率。下表1展示了这些重新抽样（或伪数据）X* = (X1*, X2*, X3*)的所有27种可能结果及其均值。

![](../Images/ae43241dd014dfd53ae618dbc10bc9ad.png)

表1：从X中有放回的抽样（图像由作者创建）

这27个结果的均值为2，方差为0.23。来自这些X*的样本均值的分布表示了精确的自助法分布，如下图1所示：

![](../Images/281656f241bfd39a1f6706c8216387b3.png)

图1：精确的自助法分布及其密度估计（图像由作者创建）

左侧的条形图显示了精确的自助法分布，而自助法分布的核密度估计（红色）与均值为2、方差为1/3的正态分布（黑色）一起绘制。

## **示例 2：X = (1, 2, 6)**

现在考虑X = (1, 2, 6)的情况，样本均值为3，*s* = 2.65。与表1中的类似计算显示X*的均值为3，方差为1.62。精确的自助法分布在下图2中绘制，伴随一个核密度估计（红色），显示出与均值为3、方差为*s*²/n的正态分布（黑色）的明显偏离。

![](../Images/231020ee34a883157a357b9cf38cf396.png)

图1：精确的自助法分布及其密度估计（图像由作者创建）

从这两个示例中，我们可以得出以下几点：

+   示例 1 是数据集 X 在其均值处完全对称的情况。样本均值的自助法抽样分布也对称，且很好地由正态分布近似。

+   示例 2 是数据集 X 在其均值处不对称的情况，这一点在自助法抽样分布的形状中得到了很好的反映。然而，正态分布无法反映这种不对称。

+   鉴于这些示例中的总体分布是未知的，很难评估自助法分布是否更好地代表了样本均值的真实抽样分布。

+   然而，我们观察到自助法具有反映总体分布中可能存在的**偏斜**的能力，而渐进正态近似无法捕捉到这一点。

请注意，自助法能够捕捉到样本总体的许多非正态特性，如**偏斜**、**厚尾**和**双峰性**，这些特性是正态近似无法捕捉到的。

许多比较自助法和渐进正态近似的学术研究提供了强有力的证据，表明自助法通常表现更好，能够捕捉到真实抽样分布的特征，特别是在样本量较小时。研究报告指出，随着样本量的增加，两种方法显示出类似的特性，这意味着在样本量较小时，通常应该优先选择自助法。

# 对于 X = (X1, …, Xn) 进行自助抽样

上述示例展示了 n = 3 的情况，我们能够获得所有 27 种可能重抽样的精确自助法分布。注意到所有可能重抽样的数量为 nⁿ，对于一般的 n 值，计算 nⁿ 次重抽样的精确自助法分布可能计算负担过重。然而，这一过程并非必要，因为蒙特卡罗模拟可以提供对精确自助法分布的相当准确的近似。

假设数据 X 是从具有固定均值和方差的总体中随机获取的。假设我们关注的统计量，例如样本均值或 t 统计量，记作 T(X)。然后，

1.  我们通过从 X 中有放回地随机抽样得到 X* = (X₁*, …, Xₙ*)，每个 X 成员的概率相等。

1.  由于我们不能对所有可能的 nⁿ 次重抽样进行操作，我们重复上述过程足够多次 B，比如 1000、5000 或 10000 次。通过这样做，我们得到 B 组不同的 X*，记作 {X*(i)}，其中 i = 1, …, B。

1.  从每个 X*(i) 中计算关注的统计量 [T(X*)]。然后我们得到 {T(X*,i)} (i = 1,…., B)，其中 T*(X*,i) 是从 X*(i) 计算的 T(X*)。

自助法分布 {T(X*,i)} 被用作精确自助法分布以及 T 的未知抽样分布的近似。

举例来说，我生成了 X = (X1, …, X20) 从

+   具有 2 和 10 自由度的 F 分布 [F(2,10)]，

+   具有 3 自由度的卡方分布 [chisq(3)]，

+   具有 3 自由度的 Student-t 分布 [t(3)]，以及

+   对数正态分布，均值为 0，方差为 1（对数正态）。

下图 3 绘制了 {T(X*,i)}（i = 1,…., B）的密度估计，其中 T 是均值，B = 10000，与正态分布的密度进行比较，正态分布的均值和方差值与 X 对应。自助法分布可能与正态分布不同，特别是当基础总体分布明显偏离正态分布时。

![](../Images/f67d5f5c31ecb848f5c713034b0542cb.png)

图 3：自助法分布（红色）与正态分布（黑色）（图片由作者制作）

下面给出了上述 Monte Carlo 模拟和图形的 R 代码：

[PRE0]

自助法检验和分析是基于上述红色曲线 {T(X*,i)}，而非黑色的正态分布。

+   推断统计量，如置信区间或 p 值，是通过 {T(X*,i)} 获得的，与使用正态分布时的计算方式相同。

+   自助法分布可以揭示更多和更详细的信息，如对称性、胖尾、非正态性、双峰性以及异常值的存在，关于总体的特性。

假设 T(X) 是上述的样本均值。

对于总体均值的 *自助法置信区间* 可以通过取 {T(X*,i)} 的适当百分位数来获得。例如，设 {T(X*,i;θ)} 为 {T(X*,i)} 的 θ 分位数。那么，95% 的自助法置信区间为 [{T(X*,i;2.5)},{T(X*,i;97.5)}]。

假设 T(X) 是 H0: μ = 0 与 H0: μ > 0 的 t 检验统计量。那么，*自助法 p 值*的计算是通过计算 {T(X*,i)} 大于原始样本中 T(X) 值的比例来完成的。也就是说，p 值的计算类似于正态分布的情况，取决于 H1 的结构。

![](../Images/4836977bd791a9f0a4b832cbac68f7a1.png)

表 2：自助法与正态法的 95% 置信区间（图片由作者制作）

上表 2 展示了自助法置信区间与渐近正态置信区间的比较，两者均为 95% 置信度。当总体分布为 t(3) 或 chisq(3) 时，这两种方法提供了类似的区间，但当总体遵循 F(2,10) 或 lognorm 分布时，它们可能会有较大差异。

# R 中的自助法 t 检验

自助法可以应用于单样本和双样本 t 检验。在这种情况下，感兴趣的检验统计量 T(X) 是 t 检验统计量，其自助法分布可以如上所述获得。在 R 中，包 “[MKinfer](https://cran.r-project.org/web/packages/MKinfer/index.html)” 提供了用于自助法检验的函数。

让我们考虑第 1 部分中使用的 X 和 Y 示例：

[PRE1]

结果总结在下表中（所有检验假设为双尾 H1）：

![](../Images/f00ff6194737be2061b028ff5ddae355.png)

表 3: 95% 置信区间和 p 值（图像由作者创建）

+   对于 μ(X) = 0 的检验，X 的样本均值为 0.19，t 统计量为 0.93。自助法和渐近置信区间及 p 值提供了类似的无法拒绝 H0 的推断结果，但自助法的置信区间更紧凑。

+   对于 μ(Y) = 1 的检验，Y 的样本均值为 1.99，t 统计量为 2.63。自助法和渐近置信区间及 p 值在 5% 显著性水平下提供了类似的拒绝 H0 的推断结果，但自助法的置信区间更紧凑且 p 值更低。

+   对于 H0: μ(X) — μ(Y) = — 1 的检验，X 和 Y 之间的均值差为 -1.80，t 统计量为 -1.87。自助法和渐近置信区间及 p 值在 10% 显著性水平下提供了类似的拒绝 H0 的推断结果。

# 更一般数据结构的自助法

如上所述，自助法也已被开发用于线性回归模型、时间序列预测以及更一般结构的数据。以下总结了自助法的几个重要扩展。

+   对于线性回归模型，自助法可以通过对残差进行重采样或对样本进行重采样来进行：见 R 包 “[car](https://socialsciences.mcmaster.ca/jfox/Books/Companion/appendices/Appendix-Bootstrapping.pdf)”。

+   自助法可以应用于基于自回归模型的时间序列预测：见 R 包 “[BootPR](https://cran.r-project.org/web/packages/BootPR/BootPR.pdf)”。

+   对于结构未知的时间序列数据，可以使用[平稳自助法](https://users.ssc.wisc.edu/~bhansen/718/Politis%20Romano.pdf)（或移动块自助法）。这涉及对时间序列观察值的块进行重采样。R 包 “[tseries](https://search.r-project.org/CRAN/refmans/tseries/html/tsbootstrap.html)” 提供了该方法的函数。

+   对于形式未知的异方差数据，可以使用[野生自助法](https://www.sciencedirect.com/science/article/abs/pii/S0304407608000833)，使用 R 包 “[fANCOVA](https://www.rdocumentation.org/packages/fANCOVA/versions/0.6-1/topics/wild.boot)” 。它通过与均值为零、方差为单位的随机变量进行缩放来重采样数据，从而有效地复制异方差结构。

# 结论

本文回顾了自助法作为一种非参数检验，其中通过重复重采样观察数据来计算或近似统计量的采样分布。虽然本文仅涵盖了用于置信区间和检验总体均值的p值的自助法，但自助法的应用非常广泛，从回归分析到结构未知的时间序列数据均有涉及。

许多学术研究报告了理论或计算结果，表明自助法检验通常优于渐进正态近似，尤其是当样本量较小或中等时。

因此，在小样本中，统计学和机器学习领域的研究人员强烈建议使用自助法作为渐进正态近似的有用替代方案。

- en: 'Scikit-LLM: Power Up Your Text Analysis in Python Using LLMs within scikit-learn
    Framework'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/scikit-llm-power-up-your-text-analysis-in-python-using-llm-models-within-scikit-learn-framework-e9f101ffb6d4](https://towardsdatascience.com/scikit-llm-power-up-your-text-analysis-in-python-using-llm-models-within-scikit-learn-framework-e9f101ffb6d4)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: HANDS-ON TUTORIALS, PYTHON LIBRARY
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Use advanced language models like ChatGPT to perform text classification, like
    sentiment analysis, text summarization, and other text analysis tasks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)[![Essi
    Alizadeh](../Images/be2244231732f93bcadf09682ef8ca37.png)](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------)
    [Essi Alizadeh](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------)
    ·10 min read·Jun 6, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/828eb6a079b92568a3d0c1e2344e2ed1.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Patrick Tomasso](https://unsplash.com/@impatrickt?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Scikit-LLM](https://github.com/iryna-kondr/scikit-llm) is a Python package
    that integrates large language models (LLMs) like OpenAI’s GPT-3 into the [scikit-learn](https://scikit-learn.org/)
    framework for text analysis tasks.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Scikit-LLM is designed to work within the scikit-learn framework. Hence, if
    you’re familiar with scikit-learn, you’ll feel right at home with scikit-llm.
    The library offers a range of features, out of which we will cover the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Zero-shot text classification
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Multi-label zero-shot text classification
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Text vectorization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Text translation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Text summarization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/63233c936c361da65586d05a1ba72051.png)'
  prefs: []
  type: TYPE_IMG
- en: Concepts covered in this post (Image by Author)
  prefs: []
  type: TYPE_NORMAL
- en: Please note that all datasets used in this post were exclusively created and
    compiled by the author.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why this library?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The main benefit of this library is it’s familiar scikit-learn API, in particular,
  prefs: []
  type: TYPE_NORMAL
- en: You can use similar APIs as scikit-learn, like `.fit()`, `.fit_transform()`,
    and`.predict()`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can combine estimators from the scikit-llm library in a Sklearn pipeline
    (check out my last example in this post).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can install the library via pip:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before you start using Scikit-LLM, you need to pass your OpenAI API key to Scikit-LLM.
    You can check out this [post](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/)
    to set up your OpenAI API key.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Please note that Scikit-LLM provides a convenient interface to access OpenAI’s
    GPT-3 models. Use of these models is not free and requires an API key. While the
    API cost is relatively cheap, depending on the volume of your data and frequency
    of calls, these costs can add up. Therefore, it’s important to plan and manage
    your usage carefully to control costs. Always remember to review OpenAI’s [pricing
    details](https://openai.com/pricing/) and terms of use before getting started
    with Scikit-LLM.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: To give you a rough idea, I ran this notebook at least five times to make this
    tutorial, and the total cost was US $0.02\. I have to say, I thought this would
    be higher!
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Zero-Shot Text Classification
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'One of the features of Scikit-LLM is the ability to perform zero-shot text
    classification. Scikit-LLM provides two classes for this purpose:'
  prefs: []
  type: TYPE_NORMAL
- en: '**ZeroShotGPTClassifier**: used for single label classification (e.g. sentiment
    analysis),'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MultiLabelZeroShotGPTClassifier**: used for a multi-label classification
    task.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Single label ZeroShotGPTClassifier
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let’s do a sentiment analysis of a few movie reviews. For training purposes,
    we define the sentiment for each review (defined by a variable `movie_review_labels`).
    We train the model with these reviews and labels, so that we can predict new movie
    reviews using the trained model.
  prefs: []
  type: TYPE_NORMAL
- en: 'The sample dataset for the movie reviews is given below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Let’s train the model and then check what the model predicts for each new review.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: As can be seen above, the model predicted the sentiment of each movie review
    correctly.
  prefs: []
  type: TYPE_NORMAL
- en: Multi-Labels ZeroShotGPTClassifier
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous section, we had a single-label classifier ([“positive”, “negative”,
    “neutral”]). Here, we are going to use the `MultiLabelZeroShotGPTClassifier` estimator
    to assign multiple labels to a list of restaurant reviews.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Let’s train the model and then predict the labels for new reviews.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: The predicted labels for each review are spot-on.
  prefs: []
  type: TYPE_NORMAL
- en: Text Vectorization
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Scikit-LLM provides the `GPTVectorizer` class to convert the input text into
    a fixed-dimensional vector representation. Each resulting vector is an array of
    floating numbers, which is a representation of the corresponding sentence.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s get a vectorized representation of the following sentences.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: In practice, these vectors are inputs to other machine learning models for tasks
    like classification, clustering, or regression, rather than examining the vectors
    directly.
  prefs: []
  type: TYPE_NORMAL
- en: Text Translation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: GPT models can be used to translate by making accurate readings from one language
    to another. We can translate a text into a language of interest using the `GPTTranslator`
    module.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Text Summarization
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: GPT models are very useful for summarizing texts. The Scikit-LLM library provides
    the `GPTSummarizer` estimator for text summarization. Let's see that in action
    by summarizing the long reviews given below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: Note that the `reviews` above is a list of three items, and that each item in
    the list is written out in a way that makes it easy to read.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: A short summary of each review is generated. The `max_words` parameter sets
    a rough upper bound on the summary's length; in practice, it may be a slightly
    longer.
  prefs: []
  type: TYPE_NORMAL
- en: Use a scikit-llm within a scikit-learn pipeline
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So far, all examples above have only used estimators from the Scikit-LLM library.
    As mentioned before, the main benefit of this library is its integration with
    the scikit-learn platform.
  prefs: []
  type: TYPE_NORMAL
- en: The following example uses a scikit-llm estimator in a scikit-learn pipeline
    and runs an XGBoost classifier on the movie review examples illustrated earlier.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Please note that the above is only a use case to illustrate the possibility
    of integrating Scikit-LLM estimators in a SKlearn pipeline.
  prefs: []
  type: TYPE_NORMAL
- en: If you enjoyed this post, you’re going to like my [other article](/tutorial-string2string-python-pkg-f9126b8474c5)
    on String-to-String algorithms for NLP tasks.
  prefs: []
  type: TYPE_NORMAL
- en: '[](/tutorial-string2string-python-pkg-f9126b8474c5?source=post_page-----e9f101ffb6d4--------------------------------)
    [## Taming Text with string2string: A Powerful Python Library for String-to-String
    Algorithms'
  prefs: []
  type: TYPE_NORMAL
- en: Leverage string2string for Natural Language Processing Tasks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/tutorial-string2string-python-pkg-f9126b8474c5?source=post_page-----e9f101ffb6d4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Scikit-LLM is a powerful tool that adds the power of advanced language models
    like GPT-3 to the well-known scikit-learn framework. In this tutorial, we looked
    at some of Scikit-LLM’s most important features: 1) zero-shot text classification,
    2) multi-label zero-shot text classification, 3) text vectorization, 4) text summary,
    5) language translation, and 6) integration with scikit-learn pipeline'
  prefs: []
  type: TYPE_NORMAL
- en: 'As I mentioned earlier, the main benefit of this library is its similar APIs
    to the scikit-learn and its integration into scikit-learn pipelines. However,
    the main limitation of Scikit-LLM is its heavy reliance on OpenAI. Although integrating
    open-source models is on [Scikit-LLM’s roadmap](https://github.com/iryna-kondr/scikit-llm#roadmap),
    it’s not yet available in the library. Hence, if you use Scikit-LLM, you should
    know that:'
  prefs: []
  type: TYPE_NORMAL
- en: Since Scikit-LLM uses OpenAI models, there is an API cost or a rate limit on
    the number of requests made to OpenAI.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Scikit-LLM is bound to have the same limitations as the OpenAI API, like
    not having access to the internet or the maximum tokens allowed for a given OpenAI
    model (in this post, the “gpt-3-turbo” model is mainly used, which has a maximum
    of 4096 tokens).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scikit-LLM is a promising tool that opens up new possibilities in the realm
    of text analysis using large language models. This library might be a useful addition
    to your toolbox; therefore, I suggest giving it a try.
  prefs: []
  type: TYPE_NORMAL
- en: 📓 You can find the notebook for this post on [GitHub](https://github.com/e-alizadeh/data-science-blog/blob/master/notebooks/Scikit-LLM-tutorial.ipynb).
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Thanks for reading! 📚
  prefs: []
  type: TYPE_NORMAL
- en: I’m a senior data scientist 📊 and engineer, writing about statistics, machine
    learning, Python, and more.
  prefs: []
  type: TYPE_NORMAL
- en: 🌱 I also curate a weekly newsletter called [**AI Sprout**](https://aisprout.beehiiv.com/subscribe)
    where I provide hands-on reviews and analysis of the latest AI tools and innovations.
    [Subscribe](https://aisprout.beehiiv.com/subscribe) to explore emerging AI with
    me!
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[*Follow me on Medium*](https://medium.com/@ealizadeh) *👋 to get my latest
    post*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Subscribe to* [*my mailing list*](https://ealizadeh.com/) *✉️ for updates
    right to your inbox*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Let’s connect on* [*LinkedIn*](https://www.linkedin.com/in/alizadehesmaeil/)
    *and* [*Twitter*](https://twitter.com/es_alizadeh) *🤝*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[](https://medium.ealizadeh.com/membership?source=post_page-----e9f101ffb6d4--------------------------------)
    [## Join Medium with my referral link - Esmaeil Alizadeh'
  prefs: []
  type: TYPE_NORMAL
- en: 📖 Read every story from Esmaeil Alizadeh (and thousands of other writers on
    Medium). Subscribe to Medium to get full…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: medium.ealizadeh.com](https://medium.ealizadeh.com/membership?source=post_page-----e9f101ffb6d4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Reference
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[](https://github.com/iryna-kondr/scikit-llm?source=post_page-----e9f101ffb6d4--------------------------------)
    [## GitHub - iryna-kondr/scikit-llm: Seamlessly integrate powerful language models
    like ChatGPT into…'
  prefs: []
  type: TYPE_NORMAL
- en: Seamlessly integrate powerful language models like ChatGPT into scikit-learn
    for enhanced text analysis tasks. You can…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/iryna-kondr/scikit-llm?source=post_page-----e9f101ffb6d4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Useful Links
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[](https://scikit-learn.org/?source=post_page-----e9f101ffb6d4--------------------------------)
    [## scikit-learn'
  prefs: []
  type: TYPE_NORMAL
- en: '"We use scikit-learn to support leading-edge basic research [...]" "I think
    it''s the most well-designed ML package I''ve…'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: scikit-learn.org](https://scikit-learn.org/?source=post_page-----e9f101ffb6d4--------------------------------)
    [](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/?source=post_page-----e9f101ffb6d4--------------------------------)
    [## How to Get an OpenAI API Key
  prefs: []
  type: TYPE_NORMAL
- en: Lots of applications and AI tools now require you bring your own OpenAI API
    key. You can generate one on OpenAI's…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.howtogeek.com](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/?source=post_page-----e9f101ffb6d4--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: '*Originally published at* [*https://ealizadeh.com*](https://ealizadeh.com/blog/tutorial-scikit-llm/)*.*'
  prefs: []
  type: TYPE_NORMAL

# Scikit-LLM：在scikit-learn框架内使用LLMs提升Python文本分析能力

> 原文：[https://towardsdatascience.com/scikit-llm-power-up-your-text-analysis-in-python-using-llm-models-within-scikit-learn-framework-e9f101ffb6d4](https://towardsdatascience.com/scikit-llm-power-up-your-text-analysis-in-python-using-llm-models-within-scikit-learn-framework-e9f101ffb6d4)

## 实操教程，Python库

## 使用像ChatGPT这样的先进语言模型来进行文本分类，比如情感分析、文本摘要和其他文本分析任务

[](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)[![Essi Alizadeh](../Images/be2244231732f93bcadf09682ef8ca37.png)](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------) [Essi Alizadeh](https://medium.ealizadeh.com/?source=post_page-----e9f101ffb6d4--------------------------------)

·发布于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----e9f101ffb6d4--------------------------------) ·10分钟阅读·2023年6月6日

--

![](../Images/828eb6a079b92568a3d0c1e2344e2ed1.png)

照片由[Patrick Tomasso](https://unsplash.com/@impatrickt?utm_source=medium&utm_medium=referral)拍摄，发布在[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# 介绍

[Scikit-LLM](https://github.com/iryna-kondr/scikit-llm)是一个Python包，将像OpenAI的GPT-3这样的高级语言模型（LLMs）集成到[scikit-learn](https://scikit-learn.org/)框架中，用于文本分析任务。

Scikit-LLM旨在与scikit-learn框架一起使用。因此，如果你对scikit-learn很熟悉，你会对scikit-llm感到如鱼得水。该库提供了一系列功能，我们将介绍以下内容：

+   零样本文本分类

+   多标签零样本文本分类

+   文本向量化

+   文本翻译

+   文本摘要

![](../Images/63233c936c361da65586d05a1ba72051.png)

本文涵盖的概念（图片由作者提供）

> 请注意，本文中使用的所有数据集均由作者专门创建和编制。

## 为什么选择这个库？

这个库的主要优点是熟悉的scikit-learn API，特别是，

+   你可以使用与scikit-learn类似的API，如`.fit()`、`.fit_transform()`和`.predict()`。

+   你可以在Sklearn管道中组合scikit-llm库中的估算器（请查看我在本文中的最后一个示例）。

# 安装

你可以通过pip安装这个库：

[PRE0]

# 配置

在开始使用Scikit-LLM之前，你需要将你的OpenAI API密钥传递给Scikit-LLM。你可以查看这个[帖子](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/)来设置你的OpenAI API密钥。

[PRE1]

> 请注意，Scikit-LLM 提供了一个方便的接口来访问 OpenAI 的 GPT-3 模型。使用这些模型并非免费，并且需要 API 密钥。虽然 API 成本相对便宜，但根据数据量和调用频率，这些成本可能会累积。因此，计划和管理使用非常重要以控制成本。在开始使用 Scikit-LLM 之前，请务必查看 OpenAI 的 [定价详情](https://openai.com/pricing/) 和使用条款。
> 
> 大致说一下，我至少运行了这个笔记本五次以制作这个教程，总费用为 0.02 美元。我得说，我本以为会更高！

# 零样本文本分类

Scikit-LLM 的一个特点是能够执行零样本文本分类。Scikit-LLM 为此提供了两个类：

+   **ZeroShotGPTClassifier**：用于单标签分类（例如情感分析），

+   **MultiLabelZeroShotGPTClassifier**：用于多标签分类任务。

# 单标签 ZeroShotGPTClassifier

让我们对一些电影评论进行情感分析。为了训练目的，我们为每条评论定义情感（由变量 `movie_review_labels` 定义）。我们用这些评论和标签训练模型，以便我们可以使用训练好的模型预测新的电影评论。

电影评论的样本数据集如下所示：

[PRE2]

让我们训练模型，然后检查模型对每条新评论的预测。

[PRE3]

[PRE4]

如上所示，模型正确预测了每条电影评论的情感。

# 多标签 ZeroShotGPTClassifier

在上一节中，我们使用了一个单标签分类器（[“positive”, “negative”, “neutral”]）。这里，我们将使用 `MultiLabelZeroShotGPTClassifier` 估计器为餐厅评论列表分配多个标签。

[PRE5]

让我们训练模型，然后预测新评论的标签。

[PRE6]

[PRE7]

对每条评论的预测标签都是准确的。

# 文本向量化

Scikit-LLM 提供了 `GPTVectorizer` 类来将输入文本转换为固定维度的向量表示。每个生成的向量都是浮点数数组，这是相应句子的表示。

让我们获取以下句子的向量化表示。

[PRE8]

[PRE9]

在实际操作中，这些向量是其他机器学习模型的输入，用于分类、聚类或回归等任务，而不是直接检查向量。

# 文本翻译

GPT 模型可以通过从一种语言到另一种语言的准确阅读来进行翻译。我们可以使用 `GPTTranslator` 模块将文本翻译成感兴趣的语言。

[PRE10]

[PRE11]

# 文本摘要

GPT 模型对于总结文本非常有用。Scikit-LLM 库提供了 `GPTSummarizer` 估计器用于文本摘要。让我们通过对下面的长评论进行总结来看看它的效果。

[PRE12]

请注意，上面的 `reviews` 是一个包含三个项目的列表，每个项目都以易于阅读的方式书写。

[PRE13]

生成每条评论的简短摘要。`max_words`参数设置了摘要长度的大致上限；实际上，摘要可能稍长。

# 在scikit-learn管道中使用scikit-llm

到目前为止，上述所有示例仅使用了Scikit-LLM库中的估计器。如前所述，这个库的主要优点是它与scikit-learn平台的集成。

以下示例在scikit-learn管道中使用了scikit-llm估计器，并对之前说明的电影评论示例运行了XGBoost分类器。

[PRE14]

[PRE15]

请注意，上述内容仅为一个用例，用于说明在SKlearn管道中集成Scikit-LLM估计器的可能性。

如果你喜欢这篇文章，你一定会喜欢我的[另一篇文章](/tutorial-string2string-python-pkg-f9126b8474c5)，内容涉及NLP任务中的字符串到字符串算法。

[](/tutorial-string2string-python-pkg-f9126b8474c5?source=post_page-----e9f101ffb6d4--------------------------------) [## 使用string2string驯服文本：一个强大的Python库，用于字符串到字符串算法

### 利用string2string进行自然语言处理任务

[towardsdatascience.com](/tutorial-string2string-python-pkg-f9126b8474c5?source=post_page-----e9f101ffb6d4--------------------------------)

# 结论

Scikit-LLM是一个强大的工具，它将像GPT-3这样的先进语言模型的力量添加到著名的scikit-learn框架中。在本教程中，我们查看了Scikit-LLM的一些重要特性：1）零样本文本分类，2）多标签零样本文本分类，3）文本向量化，4）文本摘要，5）语言翻译，以及6）与scikit-learn管道的集成。

正如我之前提到的，这个库的主要优点是它与scikit-learn相似的API以及其集成到scikit-learn管道中的能力。然而，Scikit-LLM的主要限制是它对OpenAI的高度依赖。尽管集成开源模型在[Scikit-LLM的路线图](https://github.com/iryna-kondr/scikit-llm#roadmap)中已经列出，但库中尚不可用。因此，如果你使用Scikit-LLM，你应该知道：

+   由于Scikit-LLM使用了OpenAI模型，因此对OpenAI的API调用有费用或请求次数限制。

+   Scikit-LLM必然会有与OpenAI API相同的限制，例如无法访问互联网或对给定OpenAI模型的最大令牌数（在这篇文章中，主要使用“gpt-3-turbo”模型，该模型的最大令牌数为4096）。

Scikit-LLM是一个有前景的工具，它在使用大型语言模型进行文本分析方面开辟了新的可能性。这个库可能是你工具箱中的有用补充，因此我建议你尝试一下。

> 📓 你可以在[GitHub](https://github.com/e-alizadeh/data-science-blog/blob/master/notebooks/Scikit-LLM-tutorial.ipynb)上找到这篇文章的笔记本。

感谢阅读！📚

我是一名高级数据科学家📊和工程师，撰写关于统计学、机器学习、Python等方面的内容。

> 🌱 我还策划了一份每周新闻通讯，名为 [**AI Sprout**](https://aisprout.beehiiv.com/subscribe)，在其中提供最新 AI 工具和创新的实用评测和分析。[订阅](https://aisprout.beehiiv.com/subscribe) 与我一起探索新兴 AI！

+   [*在 Medium 上关注我*](https://medium.com/@ealizadeh) *👋 获取我的最新文章*

+   *订阅* [*我的邮件列表*](https://ealizadeh.com/) *✉️ 以获取最新更新直接送到你的收件箱*

+   *让我们在* [*LinkedIn*](https://www.linkedin.com/in/alizadehesmaeil/) *和* [*Twitter*](https://twitter.com/es_alizadeh) *上连接* 🤝

[](https://medium.ealizadeh.com/membership?source=post_page-----e9f101ffb6d4--------------------------------) [## 通过我的推荐链接加入 Medium - Esmaeil Alizadeh

### 📖 阅读 Esmaeil Alizadeh 的每一个故事（以及 Medium 上成千上万其他作家的故事）。订阅 Medium 以获取完整内容……

[medium.ealizadeh.com](https://medium.ealizadeh.com/membership?source=post_page-----e9f101ffb6d4--------------------------------)

# 参考资料

[](https://github.com/iryna-kondr/scikit-llm?source=post_page-----e9f101ffb6d4--------------------------------) [## GitHub - iryna-kondr/scikit-llm: 无缝集成强大的语言模型，如 ChatGPT，以增强文本分析任务……

### 无缝集成强大的语言模型，如 ChatGPT，以增强 scikit-learn 的文本分析任务。你可以……

[github.com](https://github.com/iryna-kondr/scikit-llm?source=post_page-----e9f101ffb6d4--------------------------------)

# 有用的链接

[](https://scikit-learn.org/?source=post_page-----e9f101ffb6d4--------------------------------) [## scikit-learn

### “我们使用 scikit-learn 来支持前沿的基础研究 [...]” “我认为这是我使用过的设计最好的 ML 包……”

[scikit-learn.org](https://scikit-learn.org/?source=post_page-----e9f101ffb6d4--------------------------------) [](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/?source=post_page-----e9f101ffb6d4--------------------------------) [## 如何获取 OpenAI API 密钥

### 现在许多应用程序和 AI 工具要求你提供自己的 OpenAI API 密钥。你可以在 OpenAI 的网站上生成一个……

[www.howtogeek.com](https://www.howtogeek.com/885918/how-to-get-an-openai-api-key/?source=post_page-----e9f101ffb6d4--------------------------------)

*最初发布于* [*https://ealizadeh.com*](https://ealizadeh.com/blog/tutorial-scikit-llm/)*.*

- en: 'Local vs Global Forecasting: What You Need to Know'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/local-vs-global-forecasting-what-you-need-to-know-1cc29e66cae0](https://towardsdatascience.com/local-vs-global-forecasting-what-you-need-to-know-1cc29e66cae0)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A comparison of Local and Global approaches to time series forecasting, with
    a Python demonstration using LightGBM and the Australian Tourism dataset.
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@davide.burba?source=post_page-----1cc29e66cae0--------------------------------)[![Davide
    Burba](../Images/a1ca3cf59c2b933021fa0d978e1af522.png)](https://medium.com/@davide.burba?source=post_page-----1cc29e66cae0--------------------------------)[](https://towardsdatascience.com/?source=post_page-----1cc29e66cae0--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----1cc29e66cae0--------------------------------)
    [Davide Burba](https://medium.com/@davide.burba?source=post_page-----1cc29e66cae0--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----1cc29e66cae0--------------------------------)
    ·9 min read·May 2, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4b226d455de07e4891301fc3a307c7a3.png)'
  prefs: []
  type: TYPE_IMG
- en: Local vs Global forecasting, by [Giulia Roggia](https://www.instagram.com/giulia_roggia__/).
    Used with permission.
  prefs: []
  type: TYPE_NORMAL
- en: '[What is Local forecasting?](#9be8)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[What is Global forecasting?](#d102)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[How to Choose between Local & Global forecasting?](#65b1)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Python Example: Australian Tourism](#4f95)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Conclusion](#99a0)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***What is Local forecasting?***'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Local forecasting is the traditional approach where we **train one predictive
    model for each time series independently**. The classical statistical models (like
    exponential smoothing, ARIMA, TBATS, etc.) typically use this approach, but it
    can also be used by standard machine learning models via a feature engineering
    step.
  prefs: []
  type: TYPE_NORMAL
- en: 'Local forecasting has **advantages**:'
  prefs: []
  type: TYPE_NORMAL
- en: It’s intuitive to understand and implement.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each model can be tweaked separately.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'But it also has some **limitations**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'It suffers from the “cold-start” problem: it requires a relatively large amount
    of historical data for each time series to estimate the model parameters reliably.
    It also makes it impossible to predict new targets, like the demand for a new
    product.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It can’t capture the commonalities and dependencies among related time series,
    like cross-sectional or hierarchical relationships.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It’s hard to scale to large datasets with many time series, as it requires fitting
    and maintaining a separate model for each target.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***What is Global forecasting?***'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/6117a24385da5468e8dca8bd6fb04408.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by [PIRO](https://pixabay.com/users/piro4d-2707530/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1617121)
    from [Pixabay](https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1617121)
  prefs: []
  type: TYPE_NORMAL
- en: Global forecasting is a more modern approach, where **multiple time series are
    used to train a single “global” predictive model**. By doing so, it has a larger
    training set and it can leverage shared structures across the targets to learn
    complex relations, ultimately leading to better predictions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Building a global forecasting model typically involves a feature engineering
    step to build features like:'
  prefs: []
  type: TYPE_NORMAL
- en: Lagged values of the target
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Statistics of the target over time-windows (e.g. *“mean in the past week”*,
    *“minimum in the past month”*, etc.)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Categorical features to distinguish groups of time series
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Exogenous features to model external/interaction/seasonal factors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Global forecasting has considerable **advantages**:'
  prefs: []
  type: TYPE_NORMAL
- en: It leverages the information from other time series to improve accuracy and
    robustness.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It can do predictions for time series with little to no data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It scales to datasets with many time series because it requires fitting and
    maintaining only one single model.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By using feature engineering, it can handle problems such as multiple data frequencies
    and missing data which are more difficult to solve with classical statistical
    models.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'But global forecasting also has some **limitations**:'
  prefs: []
  type: TYPE_NORMAL
- en: It requires an extra effort to use more complex models and perform feature engineering.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It might need full re-training when new time-series appear.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If performance for one specific time-series starts to degrade, it’s hard to
    update it without impacting the predictions on the other targets.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It may require more computational resources and sophisticated methods to estimate
    and optimize the model parameters.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to choose between Local and Global forecasting?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There is no definitive answer to whether local or global forecasting is better
    for a given problem.
  prefs: []
  type: TYPE_NORMAL
- en: 'In general, **local forecasting may be more suitable for** problems with:'
  prefs: []
  type: TYPE_NORMAL
- en: Few time series with long histories
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: High variability and specificity among the time series
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Limited forecasting and programming expertise
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'On the other hand, **global forecasting may be more suitable for** problems
    with:'
  prefs: []
  type: TYPE_NORMAL
- en: Many time series with short histories
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Low variability and high similarity among the targets
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Noisy data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Example: Australian tourism'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/cd7d5f39143e84de3cba74eb056b8ea8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by [Penny](https://pixabay.com/users/pen_ash-5526837/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=7423042)
    from [Pixabay](https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=7423042)
  prefs: []
  type: TYPE_NORMAL
- en: In this section we showcase the differences between the two approaches with
    a practical example in Python using [LightGBM](https://lightgbm.readthedocs.io/en/v3.3.2/)
    and the [Australian Tourism dataset](https://github.com/unit8co/darts/blob/master/datasets/australian_tourism.csv),
    which is available on [Darts](https://github.com/unit8co/darts/tree/master) under
    the Apache 2.0 License.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s start by importing the necessary libraries.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Data Preparation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Australian Tourism dataset is made of quarter time-series starting in 1998\.
    In this notebook we consider the tourism numbers at a region level.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Let’s have a quick look at the data:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Which produces the following plot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4f1d00d7cdcc565962f669dd1d47bab0.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We can see that:'
  prefs: []
  type: TYPE_NORMAL
- en: Data exhibits a strong yearly seasonality.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The scale of the time-series is quite different across different regions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The length of the time-series is always the same.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There’s no missing data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data engineering
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s **predict the value of the next quarter** based on:'
  prefs: []
  type: TYPE_NORMAL
- en: The lagged values of the previous 2 years
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The current quarter (as a categorical feature)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Train/Test split
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For simplicity, in this example we backtest our model with a single train/test
    split (you can check [this article](https://effectiveforecasting.com/why-backtesting-matters-and-how-to-do-it-right/)
    for more information about backtesting). Let’s consider the last 2 years as test
    set, and the period before as validation set.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Model training
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now we estimate the forecasting models using the two different approaches. In
    both cases we use a LightGBM model with default parameters.
  prefs: []
  type: TYPE_NORMAL
- en: '**Local approach**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As said before, with the local approach we estimate **multiple models: one
    for each target**.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Global Approach
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'On the other hand, with the Global Approach we estimate **one model for all
    the targets**. To do this we need to perform two extra steps:'
  prefs: []
  type: TYPE_NORMAL
- en: First, since the targets have different scales, we perform a normalization step.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Then to allow the model to distinguish across different targets, we add a categorical
    feature for each target.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: These steps are described in the next two sections.
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1: Normalization** We scale all the data (targets and features) between
    0 and 1 **by target**. This is important because it makes the data comparable,
    which in turn it makes the model training easier. The estimation of the scaling
    parameters is done on the validation set.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '**Step 2: Add “target name” as a categorical feature** To allow the model to
    distinguish across different targets, we add the target name as a categorical
    feature. This is not a mandatory step and in some cases it could lead to overfit,
    especially when the number of time-series is high. An alternative could be to
    encode other features which are target-specific but more generic, like “ *region_are_in_squared_km*”,
    “*is_the_region_on_the_coast* “, etc.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: For simplicity we make *target_name* categorical after concatenating the data
    together. The reason why we specify the “category” type is because it’s automatically
    detected by LightGBM.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Predictions on the test set
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To analyze the performance of the two approaches, we make predictions on the
    test set.
  prefs: []
  type: TYPE_NORMAL
- en: 'First with the local approach:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Then with the global approach (note that we apply the inverse normalization):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Error analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To evaluate the performances of the two approaches, we perform an error analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, let’s compute the Mean Absolute Error (MAE) overall and by region:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'which gives:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b0ef42c063c7d45107d9abf4cc457562.png)'
  prefs: []
  type: TYPE_IMG
- en: '*Mean Absolute Error on the Test Set —* Image by author'
  prefs: []
  type: TYPE_NORMAL
- en: We can see that the global approach leads to a lower error overall, as well
    as for every region except for Western Australia.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s have a look at some predictions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Here are some of the outputs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8f2252c8e6a7b08f0f4ee29d95c8c3ac.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/fc90732c85a2c22596ea0b87178393ac.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d93306f791cd8fcc99bba7810d80c437.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: We can see that the local models predict a constant, while the global model
    captured the seasonal behaviour of the targets.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this example we showcased the local and global approaches to time-series
    forecasting, using:'
  prefs: []
  type: TYPE_NORMAL
- en: Quarterly Australian tourism data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Simple feature engineering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: LightGBM models with default hyper-parameters
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We saw that **the global approach produced better predictions**, leading to
    a 43% lower mean absolute error than the local one. In particular, the global
    approach had a lower MAE on all the targets except for Western Australia.
  prefs: []
  type: TYPE_NORMAL
- en: 'The superiority of the global approach in this setting was somehow expected,
    since:'
  prefs: []
  type: TYPE_NORMAL
- en: We are predicting multiple correlated time-series.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The depth of the historical data is very shallow.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We are using a somehow complex model for shallow univariate time-series. A classical
    statistical model might be more appropriate in this setting.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*The code used in this article is available* [*here*](https://github.com/davide-burba/code-collection/)*.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Enjoyed this article?* [*Checkout my other ones*](https://medium.com/@davide.burba)
    *and follow me for more!* [*Click here*](https://medium.com/@davide.burba/membership)
    *to read unlimited articles and support me at no additional cost for you*❤️'
  prefs: []
  type: TYPE_NORMAL

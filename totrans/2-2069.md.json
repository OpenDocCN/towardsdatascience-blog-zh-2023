["```py\n-- cte of sum of units per customer from orders fact table\nWITH customer_units_agg as (\n    SELECT\n        customer_id\n        , SUM(units) as UNIT_SUM\n    FROM\n        orders\n    GROUP BY\n        customer_id\n)\n\n-- join CTE table with customers dim table to filter by units and zip\nSELECT\n    COUNT(DISTINCT ca.customer_id) as CUSTOMER_CNT\nFROM customer_units_agg ca\n    INNER JOIN customer ctmr on ca.customer_id = ctmr.customer_id\nWHERE 1=1\n    AND ca.UNIT_SUM >= 3\n    AND ctmr.ship_zip_code = 90210;\n```", "```py\n-- mysql and others\nCREATE TEMPORARY TABLE my_temp_table as\n    SELECT\n        column1\n        , column2\n        , column3\n    FROM original_table\n    WHERE some_conditions;\n\n-- sql server\nSELECT\n    column1\n    , column2\n    , column3\nINTO #my_temp_table -- this is the new temp table created\nFROM original_table\nWHERE some_conditions;\n```", "```py\n-- chaining multiple cte together\nWITH cte_tabl_1 as (\n    SELECT * FROM table1\n),\ncte_tabl_2 as (\n    SELECT * FROM table2\n),\ncte_tabl_3 as (\n    SELECT * FROM table3\n)\n\nselect * from cte_tabl_1, cte_tabl_2, cte_tabl_3;\n```"]
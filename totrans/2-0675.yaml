- en: Dealing with Dates in Pythonâ€™s DataFrame Part 1 â€” Date Series Creation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¤„ç† Python æ•°æ®æ¡†ä¸­çš„æ—¥æœŸï¼Œç¬¬ 1 éƒ¨åˆ† â€” æ—¥æœŸç³»åˆ—åˆ›å»º
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/dealing-with-dates-in-pythons-dataframe-part-1-date-series-creation-f4a800db9ae](https://towardsdatascience.com/dealing-with-dates-in-pythons-dataframe-part-1-date-series-creation-f4a800db9ae)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/dealing-with-dates-in-pythons-dataframe-part-1-date-series-creation-f4a800db9ae](https://towardsdatascience.com/dealing-with-dates-in-pythons-dataframe-part-1-date-series-creation-f4a800db9ae)
- en: Data Processing in Python
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Python æ•°æ®å¤„ç†
- en: Pandas methods for date series creation
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Pandas æ—¥æœŸç³»åˆ—åˆ›å»ºæ–¹æ³•
- en: '[](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)[![KahEm
    Chu](../Images/2f89d02e85f61f08f048773990f4d53f.png)](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)
    [KahEm Chu](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)[![KahEm
    Chu](../Images/2f89d02e85f61f08f048773990f4d53f.png)](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)
    [KahEm Chu](https://kahemchu.medium.com/?source=post_page-----f4a800db9ae--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)
    Â·10 min readÂ·Jan 4, 2023
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f4a800db9ae--------------------------------)
    Â·é˜…è¯»æ—¶é—´ 10 åˆ†é’ŸÂ·2023 å¹´ 1 æœˆ 4 æ—¥
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/d3349995772e17d6c1e9e1b34526cc5b.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d3349995772e17d6c1e9e1b34526cc5b.png)'
- en: Photo by [Jon Tyson](https://unsplash.com/@jontyson?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/s/photos/time?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[Jon Tyson](https://unsplash.com/@jontyson?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    æ‘„å½±ï¼Œæ¥è‡ª [Unsplash](https://unsplash.com/s/photos/time?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)'
- en: Most of the time, the DateTime object represents a crucial element for drawing
    insights from the data. We can understand the trend, cycle, and seasonal pattern
    from the data with the date. From that, we can prepare the report based on the
    pattern found, and further study and analyze the data.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒDateTime å¯¹è±¡æ˜¯ä»æ•°æ®ä¸­è·å–æ´å¯Ÿçš„é‡è¦å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ—¥æœŸç†è§£æ•°æ®ä¸­çš„è¶‹åŠ¿ã€å‘¨æœŸå’Œå­£èŠ‚æ¨¡å¼ã€‚åŸºäºè¿™äº›æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‡†å¤‡æŠ¥å‘Šï¼Œå¹¶è¿›ä¸€æ­¥ç ”ç©¶å’Œåˆ†ææ•°æ®ã€‚
- en: 'The importance of the DateTime object in analysis motivated me to study further
    what I can do with the DateTime object in the `pandas` module. Then, I jotted
    down the methods and properties I used frequently and those I felt I might need
    to use some days. Furthermore, I grouped them into parts according to my understanding.
    There are 2 parts created as below:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: DateTime å¯¹è±¡åœ¨åˆ†æä¸­çš„é‡è¦æ€§æ¿€åŠ±æˆ‘è¿›ä¸€æ­¥ç ”ç©¶åœ¨ `pandas` æ¨¡å—ä¸­å¯ä»¥ç”¨ DateTime å¯¹è±¡åšä»€ä¹ˆã€‚ç„¶åï¼Œæˆ‘è®°å½•ä¸‹äº†æˆ‘ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•å’Œå±æ€§ï¼Œä»¥åŠæˆ‘å¯èƒ½éœ€è¦ä½¿ç”¨çš„ä¸€äº›æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘æ ¹æ®è‡ªå·±çš„ç†è§£å°†å…¶åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…·ä½“å¦‚ä¸‹ï¼š
- en: '![](../Images/31bdd968f0779f2b31bcfdec88c1c29a.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/31bdd968f0779f2b31bcfdec88c1c29a.png)'
- en: Image from Author.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºäºä½œè€…ã€‚
- en: For a better reading experience, I decided to split the group into 2 articles.
    This is the first article, you may find [the second article here](/dealing-with-dates-in-pythons-dataframe-part-2-the-basics-9ad5edacd2f8).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ›´å¥½çš„é˜…è¯»ä½“éªŒï¼Œæˆ‘å†³å®šå°†è¿™ä¸€ç»„å†…å®¹æ‹†åˆ†ä¸º 2 ç¯‡æ–‡ç« ã€‚è¿™æ˜¯ç¬¬ä¸€ç¯‡ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° [ç¬¬äºŒç¯‡æ–‡ç« ](/dealing-with-dates-in-pythons-dataframe-part-2-the-basics-9ad5edacd2f8)ã€‚
- en: Let us start with Part 1, *The Basic to Deal with DateTime Series*.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç¬¬ 1 éƒ¨åˆ†å¼€å§‹ï¼Œ*å¤„ç† DateTime ç³»åˆ—çš„åŸºç¡€çŸ¥è¯†*ã€‚
- en: Part 1 â€” The Basic to Deal with DateTime Series
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç¬¬ 1 éƒ¨åˆ† â€” å¤„ç† DateTime ç³»åˆ—çš„åŸºç¡€çŸ¥è¯†
- en: '[DateTime Series Creation](#0933)'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[DateTime ç³»åˆ—åˆ›å»º](#0933)'
- en: '[pandas.date_range](#b5e1)'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[pandas.date_range](#b5e1)'
- en: '[pandas.bdate_range](#bbc9)'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[pandas.bdate_range](#bbc9)'
- en: '[pandas.period_range](#7d21)'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[pandas.period_range](#7d21)'
- en: '[pandas.timedelta_range](#b8b9)'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[pandas.timedelta_range](#b8b9)'
- en: DateTime Series Creation
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DateTime ç³»åˆ—åˆ›å»º
- en: DateTime series creation is practical when you want to create a sample dataset
    to test out a couple of new functions that you are writing. Below are the four
    DateTime series creation methods from the `pandas` module.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ•°æ®é›†ä»¥æµ‹è¯•ä½ æ­£åœ¨ç¼–å†™çš„å‡ ä¸ªæ–°åŠŸèƒ½æ—¶ï¼Œåˆ›å»º DateTime ç³»åˆ—æ˜¯å¾ˆå®ç”¨çš„ã€‚ä»¥ä¸‹æ˜¯ `pandas` æ¨¡å—ä¸­å››ç§ DateTime
    ç³»åˆ—åˆ›å»ºæ–¹æ³•ã€‚
- en: '[pandas.date_range](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.date_range.html?highlight=date_range#pandas.date_range)
    â€” Return a fixed frequency DatetimeIndex.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[pandas.bdate_range](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.bdate_range.html)
    â€” Return a fixed frequency DatetimeIndex, with the business day as the default
    frequency.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[pandas.period_range](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.period_range.html)
    â€” Return a fixed frequency PeriodIndex. The day (calendar) is the default frequency.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[pandas.timedelta_range](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.timedelta_range.html)
    â€” Return a fixed frequency TimedeltaIndex, with the day as the default frequency.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The frequency mentioned above is referring to the interval between the dates
    generated, it could be hourly, daily, monthly, quarterly, yearly and more. You
    may learn about the [frequency string aliases in this link](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases)
    [1].
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: Letâ€™s see them one by one!
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: '**1\. pandas.date_range**'
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The `pandas.date_range()` method returns the DateTime series according to the
    combination of three parameters from the following four parameters:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '`start` â€” the start date of the date range generated'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`end` â€” the end date of the date range generated'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`periods` â€” the number of dates generated'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`freq` â€” default to â€œDâ€, the interval between dates generated, it could be
    hourly, monthly or yearly'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*Note:* `freq = â€œDâ€` *mean daily frequency.*'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: At least three of the 4 parameters above must be stated to generate a DateTime
    series. Since the `freq` is defaulted to be â€œDâ€, if you are using `freq=D`, you
    need to specify the other two parameters only. If `freq` is omitted, which means
    you specify only the `start`, the `end` and the `period` parameters, and the date
    created will have periods of linearly spaced elements between the start and the
    end date. There are other parameters in the method, but in this article, we will
    focus on these 4 main parameters only.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: For the **first example**, the dates are generated by specifying the start date
    and the period. As mentioned above, the frequency is set to be daily by default.
    Hence, there will be 10 dates generated at a daily frequency.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Output:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/dd9d065d649643000f0d164a77e22eea.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: For the **second example**, the start date, the periods, and the frequency are
    specified. The following example is creating a date series starting from 2020/1/1,
    10 dates with 3-month intervals between each date.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Output:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/29d895a26aeed2724e4983258eec9864.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: Why are the dates start from month's end? ğŸ¤¨
  id: totrans-47
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Well, it's actually because the â€œMâ€ frequency refers to the month-end frequency,
    while the â€œMSâ€ refers to the month-start frequency [[1]](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases).
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: For the **third example**, the start and end date, and the frequency are provided.
    As mentioned, the dates created will be linearly spaced when you omitted the frequency.
    Then, if the periods are omitted, the dates created will be the dates within the
    start and end date at the frequency interval specified.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/e39a9740855558489678ed42e6f1140b.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/be9049a9c1c63095482efd207c6b604c.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
- en: Image from Author. Created with Excalidraw.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: As the next period will be Jan 31, 2023, hence there are only 4 dates created
    in the third example ğŸ˜‰.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '**A simple guide here:**'
  id: totrans-56
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-57
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When you are certain about the number of dates you want to create, you use the
    **period** parameter.
  id: totrans-58
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-59
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When you are not sure about how many exact dates you will have but know when
    should it end or it should not exceed, use the **end** parameter instead.
  id: totrans-60
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**2\. pandas.bdate_range**'
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Similar to `pandas.date_range()` method, `pandas.bdate_range()` also have 4
    main parameters, which are the `start`, the `end`, the `periods` and the `freq`,
    except the `freq` is defaulted to â€œBâ€ in `pandas.bdate_range()`. The â€œBâ€ refers
    to business day frequency, which the weekend like Saturday and Sunday will be
    skipped.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
- en: Let's see the **first example**! So, in the following example, the start date
    and the periods are specified, and as mentioned, the frequency is defaulted to
    â€œBâ€.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Output:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8bc3c25787eb5a0bf9d502fcee72b97e.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: The two dates which are skipped, â€œ2022â€“01â€“08â€ and â€œ2022â€“01â€“09â€ are Saturday
    and Sunday respectively.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: You might notice that the `pandas.date_range()` method can return workdays only
    as well when you set the `freq= â€œBâ€`, then why do we need to use `pandas.bdate_range()`?
    ğŸ¤·â€â™€ï¸
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: This is because of the `pandas.bdate_range()` return business day by default
    and `pandas.bdate_range()` have `weekmask` and `holidays`parameters.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '**Note:** To use the `holidays` or `weekmask` parameter, **custom business
    day frequency** need to be used, where `freq= â€œCâ€`. [[2]](https://stackoverflow.com/questions/55248600/pandas-specifying-custom-holidays)'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: Now, let us see what is the `holidays` parameter. `Holidays` referring to the
    list of dates to exclude from the set of valid business days.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: For the **second example**, the start date, periods, frequency and holidays
    parameter are specified.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Output:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/602f90cfa1f6927676cc019c53f2f814.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: The holiday date specified is not on the list of dates generated, and as â€œCâ€
    refers to the custom business day frequency, so the weekend is still skipped in
    the date range created.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '**Note:** The Holidays parameter only takes a list of the datetime objects.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's see the `weekmask` parameter. Weekmask refers to the valid business
    days for a business that does not follow traditional business like Mon to Fri.
    Also, the default value for `weekmask` is equivalent to â€˜Mon Tue Wed Thu Friâ€™.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: For the **third example**, we specified the start date, the custom business
    day with `weekmask = â€œTue Wed Thu Fri Sat Sunâ€`.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº**ç¬¬ä¸‰ä¸ªç¤ºä¾‹**ï¼Œæˆ‘ä»¬æŒ‡å®šäº†å¼€å§‹æ—¥æœŸå’Œè‡ªå®šä¹‰çš„å·¥ä½œæ—¥ï¼Œ`weekmask = â€œTue Wed Thu Fri Sat Sunâ€`ã€‚
- en: '[PRE5]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/1badc10d915089ccffc67a13dec174e5.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1badc10d915089ccffc67a13dec174e5.png)'
- en: Image by Author.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: The Monday date (2022â€“01â€“10) will not be included in the dates created. This
    parameter is useful when the business not running according to a normal weekday.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜ŸæœŸä¸€çš„æ—¥æœŸï¼ˆ2022â€“01â€“10ï¼‰å°†ä¸ä¼šåŒ…å«åœ¨ç”Ÿæˆçš„æ—¥æœŸä¸­ã€‚è¿™ä¸ªå‚æ•°åœ¨ä¸šåŠ¡ä¸æŒ‰æ­£å¸¸å·¥ä½œæ—¥è¿è¡Œæ—¶éå¸¸æœ‰ç”¨ã€‚
- en: Combining these two parameters, you can generate the DateTime series according
    to your business operating day as in the example below.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“åˆè¿™ä¸¤ä¸ªå‚æ•°ï¼Œä½ å¯ä»¥æ ¹æ®ä¸šåŠ¡æ“ä½œæ—¥ç”Ÿæˆ DateTime ç³»åˆ—ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹æ‰€ç¤ºã€‚
- en: '[PRE6]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Output:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![](../Images/e625be0ef3cc9531067b1f03e2b368ad.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e625be0ef3cc9531067b1f03e2b368ad.png)'
- en: Image by Author.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: As seen from the output, the Monday date (2022â€“01â€“10) and holiday date (2022â€“01â€“07)
    are not included in the list generated.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œæ˜ŸæœŸä¸€çš„æ—¥æœŸï¼ˆ2022â€“01â€“10ï¼‰å’ŒèŠ‚å‡æ—¥çš„æ—¥æœŸï¼ˆ2022â€“01â€“07ï¼‰æ²¡æœ‰åŒ…å«åœ¨ç”Ÿæˆçš„åˆ—è¡¨ä¸­ã€‚
- en: '**3\. pandas.period range**'
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**3\. pandas.period_range**'
- en: There are some similarities and differences between `pandas.period_range()`
    method and the two methods earlier, the `pandas.date_range()` and `pandas.bdate_range()`
    .
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '`pandas.period_range()` æ–¹æ³•ä¸ä¹‹å‰çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå³ `pandas.date_range()` å’Œ `pandas.bdate_range()`ï¼Œä¹‹é—´å­˜åœ¨ä¸€äº›ç›¸ä¼¼ä¹‹å¤„å’Œä¸åŒä¹‹å¤„ã€‚'
- en: Similar to the two methods earlier, `pandas.period_range()` can generate the
    date series by specifying the 3 out of the 4 main parameters, `start`, `end`,
    `periods` and `freq`. Also, the frequency is still defaulted to daily.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ç±»ä¼¼äºä¹‹å‰çš„ä¸¤ç§æ–¹æ³•ï¼Œ`pandas.period_range()` å¯ä»¥é€šè¿‡æŒ‡å®šå››ä¸ªä¸»è¦å‚æ•°ä¸­çš„ä¸‰ä¸ªï¼Œå³ `start`ã€`end`ã€`periods`
    å’Œ `freq`ï¼Œæ¥ç”Ÿæˆæ—¥æœŸç³»åˆ—ã€‚åŒæ—¶ï¼Œé¢‘ç‡ä»é»˜è®¤ä¸ºæ¯æ—¥ã€‚
- en: One difference to take note of is that the `pandas.period_range()` generate
    period object instead of a DateTime object.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ä¸åŒç‚¹æ˜¯ï¼Œ`pandas.period_range()` ç”Ÿæˆçš„æ˜¯å‘¨æœŸå¯¹è±¡ï¼Œè€Œä¸æ˜¯ DateTime å¯¹è±¡ã€‚
- en: For the **first example**, we are generating a series of 5 periods in daily
    frequency by default, starting from 2022â€“01â€“01.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº**ç¬¬ä¸€ä¸ªç¤ºä¾‹**ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ç³»åˆ—æŒ‰æ—¥é¢‘ç‡çš„ 5 ä¸ªå‘¨æœŸï¼Œé»˜è®¤ä» 2022â€“01â€“01 å¼€å§‹ã€‚
- en: '[PRE7]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Output:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![](../Images/ef8d835618168bf5e526080429dc8f08.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ef8d835618168bf5e526080429dc8f08.png)'
- en: Image by Author.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: For the **second example**, we are generating a series of 5 periods in monthly
    frequency, starting from 2022â€“01â€“01.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº**ç¬¬äºŒä¸ªç¤ºä¾‹**ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ç³»åˆ—çš„ 5 ä¸ªå‘¨æœŸï¼Œé¢‘ç‡ä¸ºæ¯æœˆä¸€æ¬¡ï¼Œä» 2022â€“01â€“01 å¼€å§‹ã€‚
- en: '[PRE8]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Output:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![](../Images/d68aa1c805b6dadab4277ca01245e009.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d68aa1c805b6dadab4277ca01245e009.png)'
- en: Image by Author.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: For the **third example**, we are generating a series of 5 periods in yearly
    frequency, starting from 2022â€“01â€“01.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº**ç¬¬ä¸‰ä¸ªç¤ºä¾‹**ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ç³»åˆ—æŒ‰å¹´é¢‘ç‡çš„ 5 ä¸ªå‘¨æœŸï¼Œä» 2022â€“01â€“01 å¼€å§‹ã€‚
- en: '[PRE9]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Output:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![](../Images/4d09ae89354eea02b1b87a9ea699cf75.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4d09ae89354eea02b1b87a9ea699cf75.png)'
- en: Image by Author.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: For the **last example**, we are generating a series in yearly frequency, starting
    from 2022â€“01â€“01 to 2027â€“01â€“01.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äº**æœ€åä¸€ä¸ªç¤ºä¾‹**ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ç³»åˆ—æŒ‰å¹´ä¸ºé¢‘ç‡çš„å‘¨æœŸï¼Œä» 2022â€“01â€“01 åˆ° 2027â€“01â€“01ã€‚
- en: '[PRE10]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Output:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![](../Images/e467a0cc91d8f9328bf302de01cbda15.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e467a0cc91d8f9328bf302de01cbda15.png)'
- en: Image by Author.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: The period_range method work in the same way with `pandas.date_range()`, just
    it returns the period instead of the date. So, if the `periods` parameter is omitted,
    the periods created will be the periods within the start and end date with the
    frequency interval specified.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: period_range æ–¹æ³•çš„å·¥ä½œæ–¹å¼ä¸ `pandas.date_range()` ç›¸åŒï¼Œåªæ˜¯å®ƒè¿”å›çš„æ˜¯å‘¨æœŸè€Œä¸æ˜¯æ—¥æœŸã€‚å› æ­¤ï¼Œå¦‚æœçœç•¥ `periods`
    å‚æ•°ï¼Œåˆ™åˆ›å»ºçš„å‘¨æœŸå°†æ˜¯æŒ‡å®šé¢‘ç‡é—´éš”çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸä¹‹é—´çš„å‘¨æœŸã€‚
- en: '**4\. pandas.timedelta_range**'
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**4\. pandas.timedelta_range**'
- en: Similar to the three methods above, `pandas.timedelta_range()` method returns
    the date series according to the combination of three parameters from the four
    main parameters, start, end, periods and frequency. The frequency is still defaulted
    to daily. There is one difference between this method with the three examples
    earlier, which can be explained with the example below.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: ç±»ä¼¼äºä¸Šè¿°ä¸‰ç§æ–¹æ³•ï¼Œ`pandas.timedelta_range()` æ–¹æ³•æ ¹æ®å››ä¸ªä¸»è¦å‚æ•°ä¸­çš„ä¸‰ä¸ªå‚æ•°ç»„åˆè¿”å›æ—¥æœŸç³»åˆ—ï¼Œå³ startã€endã€periods
    å’Œ frequencyã€‚é¢‘ç‡ä»é»˜è®¤ä¸ºæ¯æ—¥ã€‚ä¸ä¹‹å‰çš„ä¸‰ä¸ªç¤ºä¾‹æ–¹æ³•ä¸åŒçš„ä¸€ç‚¹å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä¾‹å­è¿›è¡Œè§£é‡Šã€‚
- en: The example below is from a mistake I made during running the script, and then
    the errors that occurred.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹ç¤ºä¾‹æ¥è‡ªæˆ‘åœ¨è¿è¡Œè„šæœ¬æ—¶çŠ¯çš„ä¸€ä¸ªé”™è¯¯ï¼Œä»¥åŠéšåå‘ç”Ÿçš„é”™è¯¯ã€‚
- en: '[PRE11]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The script above returns a Key Error and a Value Error as below.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šé¢çš„è„šæœ¬è¿”å›äº†å¦‚ä¸‹çš„é”®é”™è¯¯å’Œæ•°å€¼é”™è¯¯ã€‚
- en: '![](../Images/a48471c65e93d3b735015f75a39bac90.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a48471c65e93d3b735015f75a39bac90.png)'
- en: Key Error. Image by Author.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: é”®é”™è¯¯ã€‚å›¾ç‰‡æ¥æºï¼šä½œè€…ã€‚
- en: '![](../Images/bdd091195332b8785819b0abff3483c2.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bdd091195332b8785819b0abff3483c2.png)'
- en: Value Error. Image by Author.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: From the error script, we can see the error comes from the value we put for
    the â€œstartâ€ parameter. As we are generating a time delta object, the value we
    put for the â€œstartâ€ parameter should be in timedelta format too.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: So, the correct example should be as below, where the start is specified in
    timedelta format, the number of periods is specified, and the default daily frequency
    is used.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Output:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a023494a11b34cea30c17bbdf067385b.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: For the second example, the starting time delta, the periods and the frequency
    are specified.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Output:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4082e9a9a8ad6a5f6298e8a8b2db5031.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: For the third example, the starting time delta, the end time delta and the frequency
    are specified.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Output:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/62399de92be4ced62f374dc9681ec454.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: For the fourth example, the starting time delta, the end time delta and the
    periods are specified. The time delta series generated will be linearly spaced
    when the frequency is not set.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Output:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cb55d385f5a812cbcde33e343fca56f3.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: For the `pandas.timedelta_range()` method, the â€œstartâ€ parameter accepts
    only the time delta object, while for the other three methods, the â€œstartâ€ parameter
    takes the Datetime object as input.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: 5\. **Create DateTime with a Timestamp**
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the pandas module, we can also create the datetime object with the timestamp
    method.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: There are two ways to create a DateTime object with a timestamp, the first way
    is with the datetime parameters as below.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Output:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/770b4803a5591dbf881c564592414699.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: The second way is to create the timestamp from the DateTime string.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![](../Images/268128a5c66fd13e8de07d4f40b3e5f0.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
- en: Image by Author.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: Okay, so the above is a demonstration of the usage of timestamp methods to create
    a DateTime object.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: '**Conclusion**'
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In conclusion, we have seen 4 methods related to DateTime series creation, which
    are standard date creation, business date creation, period creation and timedelta
    creation. Other than that, the date creation method with timestamp is also demonstrated.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: Thatâ€™s all for the DateTime series creation in Python. I hope you enjoy reading
    this article and hope it helps you to understand more about DateTime series creation
    in a DataFrame. Thanks! ğŸ˜Š
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: Stay Connected
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Subscribe on [YouTube](https://www.youtube.com/channel/UCiMtx0qbILP41Ot-pkk6eJw)
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: Side Note
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Part Two of this article, [Dealing with Dates in Pythonâ€™s DataFrame Part 2 â€”
    The Basics](/dealing-with-dates-in-pythons-dataframe-part-2-the-basics-9ad5edacd2f8).
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: I have explained the possible manipulation you can perform on the DateTime variables
    in [Dealing with Dates in Python](https://medium.com/towards-data-science/dealing-with-dates-in-python-1b4069a07a0f).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: In [Report Automation Tips with Python](/report-automation-tips-with-python-783a9cd58e23),
    I have explained some tips on report automation. Check it out!
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: Reference
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[1] [Time Series/Data Functionality â€” Offset aliases. *pandas*: String aliases
    for useful common time series frequencies](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '[2] [pandas-specifying-custom-holidays](https://stackoverflow.com/questions/55248600/pandas-specifying-custom-holidays):
    Specifying custom holidays in `pandas.bdate_range()` method'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: Thank you and congrats for reading to the end ğŸ˜Š!
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bb86215d7a55cb1f73fcdca86f1e5572.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
- en: Photo by [JOSHUA COLEMAN](https://unsplash.com/@joshstyle?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
    on [Unsplash](https://unsplash.com/s/photos/thank-you?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL

["```py\n!pip install fastai\n```", "```py\nfrom fastai.vision.all import *\n```", "```py\nURLs.PETS\n```", "```py\n'https://s3.amazonaws.com/fast-ai-imageclas/oxford-iiit-pet.tgz'\n```", "```py\npath = untar_data(URLs.PETS)/'images'    # path to images\npath\n```", "```py\ndef animal_labels(filename):    \n    return filename[:filename.rfind('_')]  # extract the filename until the last underscore\n```", "```py\n dls = ImageDataLoaders.from_name_func(\n    path,                                # path to images \n    get_image_files(path),               # get the list of path for all images\n    valid_pct = 0.25,                    # percentages to use for validation\n    seed = 42,                           # random seed\n    label_func = animal_labels,          # labelling for the images\n    item_tfms = Resize(224))             # transform the images to 224x224\n```", "```py\nfor vocab in dls.vocab:\n    print(vocab)\n```", "```py\nAbyssinian\nBengal\nBirman\nBombay\nBritish_Shorthair\nEgyptian_Mau\nMaine_Coon\nPersian\nRagdoll\nRussian_Blue\nSiamese\nSphynx\namerican_bulldog\namerican_pit_bull_terrier\nbasset_hound\nbeagle\nboxer\nchihuahua\nenglish_cocker_spaniel\nenglish_setter\ngerman_shorthaired\ngreat_pyrenees\nhavanese\njapanese_chin\nkeeshond\nleonberger\nminiature_pinscher\nnewfoundland\npomeranian\npug\nsaint_bernard\nsamoyed\nscottish_terrier\nshiba_inu\nstaffordshire_bull_terrier\nwheaten_terrier\nyorkshire_terrier\n```", "```py\nlearn = vision_learner(dls, \n                       resnet34, \n                       metrics = error_rate)\nlearn.fine_tune(1)\n```", "```py\nlearn.fine_tune(1)\n```", "```py\nimg = PILImage.create('1024px-Bulldog_inglese.jpg')\nimg.to_thumb(192)\n```", "```py\nanimal_type, index, probs = learn.predict(img)\nprint(f\"Predicted animal: {animal_type}.\") \nprint(f\"Predicted animal probability: {probs[index]}\")\nprint(f\"Probabilities: {probs}\")\n```", "```py\nPredicted animal: american_bulldog.\nPredicted animal probability: 0.6161370277404785\nProbabilities: tensor([7.9024e-05, 4.4181e-04, 6.9500e-05, 8.0544e-05, 1.8523e-04, 7.2056e-05,\n        2.3234e-05, 7.4391e-04, 3.1683e-05, 7.3335e-05, 1.9286e-04, 2.3213e-04,\n        6.1614e-01, 4.6759e-03, 2.0838e-02, 4.2569e-04, 7.0168e-02, 4.3025e-05,\n        2.1922e-05, 4.6172e-05, 1.0497e-04, 2.4546e-04, 2.3985e-04, 6.9188e-04,\n        1.0650e-04, 2.1837e-04, 1.5202e-04, 1.7642e-04, 8.6259e-05, 1.4461e-02,\n        2.5644e-01, 2.9418e-04, 4.5159e-04, 1.2193e-04, 1.0669e-02, 4.7959e-04,\n        4.7566e-04])\n```"]
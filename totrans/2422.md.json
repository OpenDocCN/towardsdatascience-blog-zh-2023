["```py\nWITH customer_acq AS (\n  SELECT\n  *\n  , CASE\n      WHEN first_order_date IS NOT NULL\n        THEN first_order_date\n      ELSE salesforce_date_created\n    END AS acquisition_date\n  FROM customers\n)\n\n, main AS (\n  SELECT\n  *\n  FROM customer_acq\n  WHERE acquisition_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)\n)\n\nSELECT * FROM main\n```"]
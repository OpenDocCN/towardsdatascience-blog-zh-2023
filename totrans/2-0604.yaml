- en: Creating Dynamic Choropleth Visualizations Using Plotly
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Plotly 创建动态区域图可视化
- en: 原文：[https://towardsdatascience.com/creating-dynamic-choropleth-visualizations-using-plotly-61d266cbe9b4](https://towardsdatascience.com/creating-dynamic-choropleth-visualizations-using-plotly-61d266cbe9b4)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/creating-dynamic-choropleth-visualizations-using-plotly-61d266cbe9b4](https://towardsdatascience.com/creating-dynamic-choropleth-visualizations-using-plotly-61d266cbe9b4)
- en: Using a simple-to-learn package to create a complex visualization
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用易于学习的包来创建复杂的可视化
- en: '[](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)[![Hari
    Devanathan](../Images/9c793030ed7d21a2ed2955c57fa19273.png)](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)
    [Hari Devanathan](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)[![Hari
    Devanathan](../Images/9c793030ed7d21a2ed2955c57fa19273.png)](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)[](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)
    [Hari Devanathan](https://hd2zm.medium.com/?source=post_page-----61d266cbe9b4--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)
    ·12 min read·Dec 18, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----61d266cbe9b4--------------------------------)
    ·12 min 阅读·2023年12月18日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/17c9e259f0a21a20f9cdd5fc479fc7db.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/17c9e259f0a21a20f9cdd5fc479fc7db.png)'
- en: Photo by [NASA](https://unsplash.com/@nasa?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来源：[NASA](https://unsplash.com/@nasa?utm_source=medium&utm_medium=referral)
    在 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Visualizing data is a step that gets overlooked by data scientists. It helps
    us tell stories by analyzing and curating data into a form easy to understand.
    By removing all the technical detail and noise and highlighting key information,
    data scientists can explain the importance of their work to non-technical managers
    and executives.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 可视化数据是数据科学家经常忽略的一步。它帮助我们通过分析和整理数据来讲述故事，使其易于理解。通过去除所有技术细节和噪音，突出关键信息，数据科学家可以向非技术经理和高管解释其工作的意义。
- en: There are many tools to help visualize data. For years, Microsoft Excel dominated
    the static visualization market. Over time, we gravitated to dynamic visualizations
    and flexibility to showcase more data in a cleaner manner. Two types of tools
    helped create dynamic visuals.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 现在有许多工具可以帮助可视化数据。多年来，Microsoft Excel 主导了静态可视化市场。随着时间的推移，我们转向了动态可视化，灵活展示更多数据。两种类型的工具帮助创建了动态可视化。
- en: '**Business Intelligence and Analytics Software:** Tableau, PowerBI'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**商业智能和分析软件：** Tableau，PowerBI'
- en: '**Open-sourced programming libraries:** D3.js, Plotly Dash'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开源编程库：** D3.js，Plotly Dash'
- en: Third party software tools like Tableau and PowerBI are excellent for non-technical
    folks. Drag and drop interfaces and abstractions allow analysts to create dynamic
    dashboards easily. The drawbacks are
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 像 Tableau 和 PowerBI 这样的第三方软件工具对于非技术人员非常优秀。拖放界面和抽象功能使分析师能够轻松创建动态仪表板。缺点是
- en: software tools are expensive
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件工具价格昂贵
- en: a bit of a learning curve to learn these tools
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学习这些工具需要一些时间
- en: limits to visualization design; software may not allow some components
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化设计的限制；软件可能不允许某些组件
- en: Open-sourced programming libraries are excellent for technical folks. Those
    comfortable with software engineering can follow the documentation to create flexible
    dynamic visualizations with ease. Furthermore, these packages are free to use
    (with Plotly offering a paid version for its enterprise Dash components).
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 开源编程库对技术人员非常优秀。那些熟悉软件工程的人可以轻松地按照文档创建灵活的动态可视化。此外，这些软件包是免费的（Plotly 为其企业 Dash 组件提供了付费版本）。
- en: The difference between D3.js and Plotly are the following
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: D3.js 和 Plotly 的区别如下
- en: D3.js is designed in JavaScript, Plotly is designed in Python
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: D3.js 使用 JavaScript 设计，Plotly 使用 Python 设计
- en: D3.js has been around longer than Plotly, and thus has better community support
    and a more mature ecosystem(extensive examples and tutorials).
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: D3.js requires engineers to understand the low-level details of web development
    (HTML, CSS, JavaScript) in order to use it effectively. Plotly abstracts such
    details in simple-to-use Python classes.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: D3.js has a steep learning curve due to its JavaScript nature (asynchronous,
    Domain Object Model, functions), but can build a variety of complex dynamic visualizations.
    Plotly has a small learning curve due to its Python nature, but is limited to
    the kind of visualizations users can build.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If this was in 2019, I would recommend D3.js. At that time, Plotly was severely
    constrained on the kinds of visualizations I would have liked to build.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: However, I took a look at Plotly again and was impressed with its improvements.
    The clean interface makes it easy to rival some D3.js’s custom visualizations.
    Furthermore, I don’t have to learn the intricacies of JavaScript to utilize the
    package effectively.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: In fact, I was able to create a complex visualization in just 147 lines of code.
    Below is the video of the visualization.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: '**Video 1**: Names Dashboard [Video](https://www.youtube.com/watch?v=NmDFOqCduts&t=4s)
    created by Author'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: So what does the visualization do?
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: It has a map that shows how many people have a particular first name. The particular
    first name is based on the far-right dropdown **Choose Name To See Popularity
    Per State On Map**
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The names recommended by the **Choose Name To See Popularity Per State On Map**
    dropdown are the most popular N names in the USA. These N names are filtered by
    the middle dropdown **Top N Names,** where N can be 5, 10, or 15.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These names are also filtered by **Gender.** The **Gender** filter is on the
    far left, where users can choose Male or Female.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Once the visualization is drilled down by **Gender, Top N Names,** and **Choose
    Name To See Popularity Per State On Map,** the map then displays the popularity
    of a selected name by state AND by year. There is a year filter that a user can
    drag through to show the popularity of the selected name over time *instantaneously.*
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If a user clicks on a state, the bar graph below is updated. The bar graph takes
    the state and year of the map upon the click and displays the Top N Popular Names
    in that given state and year. The Top N Names are based on the filter **Top N
    Names.**
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It has a loading spinner to suggest when data is currently being loaded in,
    thus improving the user experience.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The amazing part? This complex visualization was completed in just ***148 lines***
    of Python code. Some of the complex pieces were added in 1–3 lines of code! Check
    out the repository below.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/hd2zm/Data-Science-Projects/blob/master/Name-Dashboard/name_dashboard.py?source=post_page-----61d266cbe9b4--------------------------------)
    [## Data-Science-Projects/Name-Dashboard/name_dashboard.py at master · hd2zm/Data-Science-Projects'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Contribute to hd2zm/Data-Science-Projects development by creating an account
    on GitHub.
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/hd2zm/Data-Science-Projects/blob/master/Name-Dashboard/name_dashboard.py?source=post_page-----61d266cbe9b4--------------------------------)
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: I was amazed at how intuitive the package is. The creators put a lot of thought
    into making this easy for people who have limited programming experience.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: While the documentation is straightforward, I’ll go over how I built each component.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: Plotly Components
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Load in data
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are two datasets we’re loading
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: '**names_by_state_cleaned.csv** — a custom dataset that lists all the first
    names of a person, the number of people with such name, the year, and the state.
    This dataset was downloaded and cleaned by the [Social Security administration
    website](https://www.ssa.gov/oact/babynames/). The datasets are [publicly available
    for commercial use](https://www.ssa.gov/oact/babynames/limits.html). Datasets
    were downloaded as folders containing many .txt files, and were merged into one
    CSV file using a custom script. This CSV file is 150 MB, and pretty big to upload
    to Github. For convenience sake, I’m attacking a sample screenshot of the dataset.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/3f83048ed8a40109994a39ae2687666f.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
- en: '**Figure 1**: Sample dataset of **names_by_state_cleaned.csv**'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '**us-states.json** — a dataset of geographical coordinates of all states in
    the USA. This is used to create the choropleth map. This is 88KB, and can be easily
    loaded in memory. [I’ve uploaded the json to the git repo containing the visualization
    code](https://github.com/hd2zm/Data-Science-Projects/blob/master/Name-Dashboard/us-states.json).'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'After creating the app, I load the two datasets in memory. Disclaimer: I [explain
    later](#000f) why loading in the csv file in memory isn’t a good idea from a production
    standpoint. For now, I’ll keep it as is.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: HTML Layout
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here’s the HTML design for the application
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Below is a screenshot of the layout that generates.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/243917335446fc96376687007e016925.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
- en: '**Figure 2:** Screenshot of dashboard'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: For those who are new to web development, Plotly abstracts all the complexities
    of HTML and CSS. Here are all the main components from the application.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: Header 1, which is the title of the visualization.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/6e9a72c0af8806367699504f7dfce714.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
- en: Screenshot of title of visualization
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: HTML Div with class name `filters`. This contains the Gender Header ( `html.Div`),
    Gender options in radio button format ( `dcc.RadioItems` ), Top N Names Header
    ( `html.Div`), Top N Names options in radio button format ( `dcc.RadioItems` ),
    Choose Name Header ( `html.Div`), and Choose Name dropdown ( `dcc.Dropdown` )
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/87cf842acc605b11af111fb65d25bbcb.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
- en: '**Figure 3:** Screenshot of different filters for the visualization. A radio
    button filter for Gender, aradio button filter for Top N Names, and a drop down
    filter for Popular Name'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: 'A loading spinner ( `dcc.Loading` ) that encompasses two graphs ( `dcc.Graph`
    ): one with id of `map` (see map from **Figure 2)** and one with id of `bar_top_n`
    (see bar chart from **Figure 2**)'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个包含两个图形（`dcc.Graph`）的加载动画（`dcc.Loading`）：一个图形的 id 为 `map`（见**图 2**中的地图），另一个图形的
    id 为 `bar_top_n`（见**图 2**中的条形图）。
- en: '![](../Images/32aa74c7107cc08e778a1cda5319ee58.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/32aa74c7107cc08e778a1cda5319ee58.png)'
- en: '**Figure 4:** Screenshot of loading spinner from visualization.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 4：** 可视化中的加载动画截图。'
- en: I was impressed that creating a loading spinner took 4 lines of code. This complexity
    requires a combination of CSS, HTML, and/or JavaScript in a website. Plotly abstracted
    those details so non-technical users can easily create a user friendly experience.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我对创建一个加载动画只需 4 行代码感到印象深刻。这种复杂性需要网站中 CSS、HTML 和/或 JavaScript 的组合。Plotly 抽象化了这些细节，使非技术用户也能轻松创建用户友好的体验。
- en: Furthermore, I enjoyed how Plotly kept the HTML DOM Structure while naming elements.
    As a former web developer, I quickly picked up on learning Plotly because of that
    HTML familiarity. Furthermore, I liked their utilization of the `children` parameter
    so the elements can be rearranged in an organized fashion. As a software developer,
    it’s better to write code that is maintainable than to write code that is efficient,
    yet confusing to read.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我喜欢 Plotly 保留了 HTML DOM 结构的同时命名元素。作为一名前网页开发人员，我由于 HTML 的熟悉感很快学会了 Plotly。此外，我喜欢他们利用
    `children` 参数来以有序的方式重新排列元素。作为软件开发人员，编写可维护的代码比编写高效但难以阅读的代码要好。
- en: You may notice some values like `initial_rank` or `initial_sex` in the `dcc`
    elements. Those are my custom variables I created before the app HTML layout.
    Here are these variables below.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会注意到 `dcc` 元素中一些值如 `initial_rank` 或 `initial_sex`。这些是我在应用 HTML 布局之前创建的自定义变量。以下是这些变量。
- en: '[PRE2]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This is why you see the bar graph in **Figure 2** set to the default title
    upon loading: Top 5 Popular Male Names In AK of 1910'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是为什么你看到**图 2**中的条形图在加载时设置为默认标题：1910 年 AK 州的前 5 大受欢迎男性名字。
- en: '![](../Images/7e6043f482788b9810bdaa835ac18559.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7e6043f482788b9810bdaa835ac18559.png)'
- en: '**Figure 5:** Bar Chart of initial values from dashboard upon loading.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 5：** 仪表板加载时的初始值条形图。'
- en: The goal is to have default options populated when the user first loads the
    dashboard. The user can then navigate through clicks.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是让用户首次加载仪表板时填充默认选项。然后，用户可以通过点击进行导航。
- en: Now that we have the HTML layout, it’s time to add actions. What happens when
    we click on the dropdowns, radio buttons, or map? We utilize JavaScript callback
    functions.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了 HTML 布局，是时候添加操作了。当我们点击下拉菜单、单选按钮或地图时会发生什么？我们使用 JavaScript 回调函数。
- en: Callback functions
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回调函数
- en: A JavaScript callback is a function which is to be executed after another function
    has finished execution. JavaScript is asynchronous, which allows it to run functions
    in the background while your application is running. Callbacks are used to execute
    logic after certain events, such as mouse-clicks or typing.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: JavaScript 回调是指在另一个函数完成执行后要执行的函数。JavaScript 是异步的，这允许它在应用程序运行时在后台运行函数。回调用于在某些事件（如鼠标点击或键入）之后执行逻辑。
- en: Plotly’s template for callback functions is as follows
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: Plotly 的回调函数模板如下所示：
- en: '[PRE3]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Inputs and outputs take in two parameters:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 输入和输出接受两个参数：
- en: id of div
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: div 的 id
- en: type of input received from div
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 div 接收的输入类型
- en: From HTML Layout, here are the following div ids we have
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从 HTML 布局中，我们有以下 div 的 id：
- en: sex-radio-selection
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: sex-radio-selection
- en: rank-dropdown-selection
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: rank-dropdown-selection
- en: top-rank-name-dropdown-selection
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: top-rank-name-dropdown-selection
- en: loading-2
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: loading-2
- en: map
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: map
- en: bar_top_n
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: bar_top_n
- en: The type of input can be parameters in `dcc` elements (`dcc.Dropdown` , `dcc.RadioButton`
    ) , `clickData` , `hoverData` , etc. Below is the callback function for the visualization.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 输入类型可以是 `dcc` 元素（`dcc.Dropdown`、`dcc.RadioButton`）、`clickData`、`hoverData` 等。以下是可视化的回调函数。
- en: '[PRE4]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The choropleth map and bar chart are created using plotly express figures, and
    returned as part of the output. The order of output returned in the function matters,
    as it should correlate to the Output order specified in the callback template.
    The same holds true for Inputs.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 plotly express 图形创建了 choropleth 地图和条形图，并作为输出的一部分返回。返回的输出顺序很重要，因为它应与回调模板中指定的输出顺序相对应。输入同样适用此规则。
- en: The choropleth has an animation frame parameter, which takes in ‘year’. This
    creates the animation slider by year, shown in in **Figure 6** and **Figure 7**.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: choropleth 地图具有一个动画帧参数，该参数接受 'year'。这创建了按年显示的动画滑块，如**图 6**和**图 7**所示。
- en: '![](../Images/5e4c031725d713f5d8f02fef9190469c.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
- en: '**Figure 6:** Choropleth Map of Number of people named John in year 1910'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f124b4edcb1f97c0b32722ef353fbe4a.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
- en: '**Figure 7:** Choropleth Map of Number of people named John after moving slider
    to year 1940'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: The state and year variables are set to `inital_state` and `initial_year` ,
    which were specified above. However, we would want to change those if a user clicked
    on a given state and a given year. Hence the if statement check if `click_data`
    is true, indicating if the `clickData` event is fired.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: If `click_data` is true, we set `state=click_data[points][0]['location']` and
    `year=clic_data['points'][0]['customdata']` . Furthermore, we defined the input
    `click_data` as `Input("map", "clickData")` . This means that we’re acknowledging
    a click if it happened on the map and updating the state and year based on the
    `location` and `customdata` properties of the map. Those are parameters defined
    when creating the choropleth map ( `locations=’state'` and `custom_data='year'`
    ).
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/055dbba79d7100d5b76da23ce7405def.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
- en: '**Figure 8:** Choropleth Map and Bar Chart, with tooltip shown upon hovering
    on Colorado. Toolitp gives current year, state on hover, and number of people
    with name John.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/64494862f1dc08ef0621afc1018e744d.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
- en: '**Figure 9:** Loading spinner after clicking on state Colorado from **Figure
    8.**'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/defc1d42da670dcd937396a485566e90.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
- en: '**Figure 10:** Bar graph updated to include Top 5 Popular male Names in state
    of Colorado from 1910\. This is created after user clicked on Colorado in **Figure
    7** and **Figure 8**. You can see different popular names in Colorado as compared
    to Arkansas in **Figure 7** (Charles and William are popular in Colorado instead
    of Paul and Robert in Arkansas).'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: Other inputs from dropdowns are used in filtering the data frame of names that
    was initially loaded in. Below are how the filters operate after they are modified
    by the callback function.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: Gender Filter
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/ff87a41c2e2f93f60c79a617d5ef806d.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
- en: '**Figure 11:** Dashboard from **Figure 6** after clicking on Gender Female
    radio button. The choropleth map is empty because it had to replace the names
    in the Popular Name Filter (dropdown) from male names to female names. The default
    name John isn’t among the list of female names, so you’ll have to select a female
    name from the dropdown to populate the map.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c04aaa0bc5eb9a3d80eb866f45bfc0b9.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12:** Dashboard from Figure 11 after selecting on name Helen from
    Popular Name dropdown filter. Now, bar chart is populated with top 5 popular female
    names in Arkansas of 1910 instead of male names. Grey states in the map indicate
    that no one was named Helen in that year and state.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: Top Rank Filter
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/118303e6926f7b09e6a9c28c221c12c8.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
- en: '**Figure 13:** Map visualization of popularity of John in 1967\. Bar Graph
    of Top 5 popular male names in Texas of 1967.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2f110e7bab58ab2ba8bb220f7097f8ad.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
- en: '**Figure 14:** Loading spinner after clicking on Top N Names radio button 15
    instead of 5'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9d5061bd61331a16ee4904fa0d9136d5.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15:** Same map as **Figure 13** except with bar chart updated to top
    15 names in Texas of 1967\. Bar chart also has over option to see number of people
    named William in Texas of 1967.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: Popular Name Filter
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](../Images/74a2f15fae71472841146654193eda8e.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
- en: '**Figure 16:** Dashboard with gender male, top 15 names, map with popularity
    of John, and bar chart of top 15 popular male names in Texas of 1910\. Dropdown
    of popularity map shows top 15 names from bar chart populated, with Willie hovered
    over.'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c501a3b2ef1f22450a2eebe3e67b2257.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
- en: '**Figure 17:** Dashboard from **Figure 16** after clicking on Willie in the
    Popular Name Filter. Map updates with popularity of Willie over state and year.'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: Putting it all together
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Tips to Improve Visualization
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Use SQL Databases and Queries for Optimization
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You may have noticed in the video that the loading spinner takes 4+ seconds
    to load in the data from any filter changes EXCEPT for year. This is because the
    Plotly Dash app reads all 150MB of data from a CSV file in memory, and queries
    select data while the application is running. Hence, why it takes a while to process
    the data frame.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: It is much faster to read from a database and select data using SQL queries.
    Now, you’re not loading in all data into memory. Just some parts. Furthermore,
    SQL databases are more compact and take up less memory than CSV files.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: Making the Bar Graph More Dynamic
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The visualization’s core component is the map of a single name’s popularity
    over location and time. The bar graph of the top N names in a single year or time
    may be redundant, as it contains the same information as the top_rank_name_dropdown
    filter.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: The top_rank_name_dropdown filter could be removed, and the bar graph can highlight
    the current name that the map is showing. If a user clicks on another bar with
    a different name, the map updates. If a user clicks on a state in a map, the bar
    graph will update with the top N names, state user selected, and year the slider
    was last on.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: Have The Bar Graph Update on The Year Slider On The Map
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It seems confusing that the map can be filtered by the year slider, but the
    bar cannot. The bar can be updated by state and year if the user clicks on a state
    on the map. This might be a confusing experience if a bar graph is from a different
    year than what the map year is on the slider.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: There might be a way to have the same year filter for both the map and the bar
    graph, but I have yet to come across that solution.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: My best guess is to see if there’s an event fired off when moving the year slider.
    Then in the callback, update the bar graph to reflect the current year. However,
    this current approach doesn’t do that because we’re loading in 150MB of data in
    memory, and filtering it in memory. So there would be a tremendous lag time when
    moving the slider.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: Revise Top N Filter
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are some states and years that only have 8 popular names in the dataset
    (Arkansas in 1910). This doesn’t reflect well on the Top N Filter, which shows
    8 bar graphs even when clicking on radio buttons 10 or 15\. Perhaps such buttons
    need to be hidden and replaced with a Top 8 radio button in this special circumstance.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: Conclusions
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This tutorial showed how to create a complex, dynamic visualization using Plotly.
    While there are ways to improve the visualization, this nevertheless shows how
    easy it is to use this open-source package. With more technical engineers and
    data/business analysts switching to data science, we need better tools to help
    them convey the data to the executives in clean manners. Based on the free costs
    and little learning curve, Plotly puts itself as one of the best packages an aspiring
    data scientist should keep in his/her arsenal.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: Thanks for reading! If you want to read more of my work, view my [Table of Contents](https://hd2zm.medium.com/table-of-contents-read-this-first-a124146f566c).
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: If you’re not a Medium paid member, but are interested in subscribing just to
    read tutorials and articles like this, [click here](https://hd2zm.medium.com/membership)
    to enroll in a membership. Enrolling in this link means I get paid for referring
    you to Medium.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL

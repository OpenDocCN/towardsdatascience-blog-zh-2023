["```py\ndataset = ImageFolder(\n    \"omniglot\",\n    transform=transforms.Compose([\n        transforms.ToTensor(), \n        transforms.Resize((98, 98))\n    ]),\n)\ndataloader = DataLoader(\n  dataset, shuffle=True, batch_size=64\n)\n```", "```py\ndinov2_vits14 = torch.hub.load('facebookresearch/dinov2', 'dinov2_vits14')\n```", "```py\ndinov2_vits14 = dinov2_vits14.to(device)\n\nall_embeddings, all_targets = [], []\n\nwith torch.no_grad():\n    for images, targets in tqdm(dataloader):\n        images = images.to(device)\n        embedding = dinov2_vits14(images)\n        all_embeddings.append(embedding)\n        all_targets.append(targets)\n\nall_embeddings = torch.cat(all_embeddings, dim=0)\nall_targets = torch.cat(all_targets, dim=0)\n```", "```py\nX_train, X_test, y_train, y_test = train_test_split(\n    all_embeddings.cpu().numpy(), \n    all_targets.cpu().numpy(), \n    test_size=0.3, \n    random_state=42,\n)\n\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)\ntest_acc = model.score(X_test, y_test)\nprint(f'Test accuracy: {test_acc}')\n```"]
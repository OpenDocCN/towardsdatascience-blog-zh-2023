# 最终的 DXA-国家

> 原文：[https://towardsdatascience.com/final-dxa-nation-f0309d718980](https://towardsdatascience.com/final-dxa-nation-f0309d718980)

## 基于长期图像的 AI 模型在健康和医学领域

## AI 可以看到终点！深度学习通过单次和顺序体成分成像预测全因死亡率

[](https://lambertleong.medium.com/?source=post_page-----f0309d718980--------------------------------)[![Lambert T Leong, PhD](../Images/2080be3fcabb7f5d702487a95c59d41b.png)](https://lambertleong.medium.com/?source=post_page-----f0309d718980--------------------------------)[](https://towardsdatascience.com/?source=post_page-----f0309d718980--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----f0309d718980--------------------------------) [Lambert T Leong, PhD](https://lambertleong.medium.com/?source=post_page-----f0309d718980--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----f0309d718980--------------------------------) ·阅读时间 9 分钟·2023年7月22日

--

![](../Images/cd4883e21fad31c2d88cd0b856faea01.png)

DXA 成像提供了多种体成分可视化类型。（图片由作者提供）

## 关键点，TLDR：

+   结合体成分成像和元数据（例如年龄、性别、握力、步速等）可以提供最佳的10年死亡率预测

+   相比单次记录模型，长期或顺序模型整体表现更佳，突显了在健康数据中建模变化和时间依赖性的必要性。

+   长期模型有潜力提供更全面的健康评估

+   [**阅读论文**](https://www.nature.com/articles/s43856-022-00166-9)

人工智能（AI）和机器学习（ML）正在革新医疗保健，推动我们迈向精准医疗时代。开发 AI 健康模型的动机是减少死亡和疾病，并延长高质量的生活。经过良好训练的模型具有更全面分析数据的能力，提供了更全面的健康评估。

# 单次记录与长期模型

基于图像的医学AI/ML模型现在已经达到了一个成熟的阶段，它们常常能与人类表现相媲美甚至超越人类，熟练地识别那些容易被人眼忽视的模式和异常。然而，大多数这些模型仍然在单一时间点的数据上运行，仅提供一个特定时刻的健康快照。无论是单模态还是多模态模型，它们往往处理的是在相对相似时间框架内收集的数据，这些数据构成了预测的基础。然而，在医学应用的AI/ML的更广泛背景下，这些单一时间点的模型只是第一步——所谓的“低悬果实”。医学AI研究的一个前沿是纵向模型，它们提供了对一个人健康状况随时间变化的更全面的视角。

纵向模型旨在整合多个时间点的数据，捕捉个体健康轨迹而非单独的瞬间。这些模型利用人类健康的动态特性，因为生理变化是不断发生的。将这些变化映射到特定的结果或健康问题上，可能会成为预测医疗的游戏规则改变者。纵向数据的概念在临床实践中并不陌生——它经常被用来监测衰老和预测脆弱性。一个典型的例子是骨矿密度（BMD）的跟踪，这是骨质疏松症和脆弱性的关键标志。定期评估BMD可以检测到显著的减少，预示潜在的健康风险。

# **纵向模型开发挑战**

从历史上看，纵向模型的开发面临了几个重要挑战。除了每个个体需要处理的大量数据和计算外，最关键的障碍在于纵向医学数据的策划。与单一时间点的数据不同，纵向数据涉及在较长时间内跟踪患者的健康信息，通常跨越多个医疗机构。这需要细致的数据组织和管理，使得策划过程既耗时又昂贵。多个成功的研究已经获得资助以前瞻性地收集纵向数据。这些研究报告了与患者在较长观察期内的保留相关的挑战。因此，尽管纵向模型具有潜在的好处，但其开发仍然是一个复杂且资源密集的任务。

# **目标**

体成分的变化，包括瘦体组织、脂肪软组织和骨骼的比例，已知与死亡率相关。在我们的研究中，我们旨在利用体成分信息来更好地预测全因死亡率，简单来说，就是预测一个人可能的生命时间线。我们评估了基于单一时间点和纵向数据构建的模型的性能，分别称为我们的“单记录”和“顺序”模型。单记录模型使我们能够评估哪种信息最能预测死亡率。开发顺序模型的目的是捕捉随时间变化的情况，并评估这些变化如何影响死亡率预测。

# **数据**

本研究的数据来自一个纵向研究，即[健康、老龄化与体成分（Health ABC）研究](https://healthabc.nia.nih.gov/)，在该研究中，跟踪和监测了3000多名年长的多种族男女成人，持续时间长达16年。这项研究产生了一个丰富而全面的纵向数据集。作为研究的一部分，患者接受了全身双能量X射线吸收测量（TBDXA）成像，并收集了几项元数据。为了遵循最佳建模实践并避免数据泄漏或减轻过拟合，数据被分为训练集、验证集和保留测试集，按照70%/10%/20%的比例划分。

我们使用全身双能量X射线吸收测量（TBDXA）成像来量化体成分，这一直被认为是金标准成像模式。历史上，患者元数据，包括年龄、体重指数（BMI）、握力、步速等变量，被用于评估衰老/死亡率，并作为体成分的替代测量。由于DXA扫描仪的可及性有限，患者元数据和体成分的替代测量得到了广泛使用。最近，随着扫描成本的降低以及不再需要医生转诊/订单/处方，可及性得到了极大改善。

# **单图像模型**

构建了三个单记录模型，每个模型使用不同的数据输入，但所有模型的输出都是10年死亡概率。第一个模型仅使用患者元数据，使用了一个32单元的ReLU激活隐藏层和一个Sigmoid预测层的神经网络。第二个模型仅使用TBDXA图像作为输入，它包括一个经过修改的Densenet121，该模型被修改为处理两个颜色通道而不是大多数自然图像中的三个颜色通道（RGB）。DXA的双能量特性导致高低X射线图像，这些图像完全注册并堆叠成两个图像通道。第三个模型将模型一中的元数据嵌入与模型二中的TBDXA图像嵌入结合，然后通过一个512单元、一个64单元的全连接ReLU层进行处理，最后通过一个Sigmoid预测层进行预测。

![](../Images/e8b1c0d513a89346bdc14c7726d9d48c.png)

[数据输入、模型架构和单记录模型方法图（作者提供的图片）](https://www.nature.com/articles/s43856-022-00166-9#Fig1)

# **纵向/序列模型**

构建并评估了三个连续模型。单记录模型架构作为每个连续模型的基础，但去除了sigmoid预测层，使输出成为表示特征嵌入的向量。在研究过程中，收集了每位患者在多个时间点的数据。每个时间点的数据被输入到适当的模型中，以获得相应的特征向量。每位患者的特征向量被排序并堆叠成一个序列。训练了一个长短期记忆（LSTM）模型，以处理特征向量序列并输出10年的死亡率预测。如前所述，进行长期研究存在若干困难，其中保留和数据收集是常见问题。我们的研究也遇到这些问题，因此一些患者的数据点比其他患者更多。选择LSTM模型作为序列建模方法，因为它们不受限于每位患者使用相同的输入序列长度。即，LSTM可以处理长度不同的序列，从而消除了如果患者数据点不足（约10个），需要填充序列的问题。

![](../Images/7f0cbdba49c4a6c004da92198e506eab.png)

[数据输入、模型架构和连续模型方法图（作者提供的图片）](https://www.nature.com/articles/s43856-022-00166-9#Fig1)

# **图像 + 元数据纵向模型胜出**

在保留的测试集上的接收操作特征曲线下面积（AUROC）显示，元数据在单记录和连续模型中均优于仅使用TBDXA图像。然而，将元数据和TBDXA成像结合在这两种建模范式中都产生了最佳的AUROC，这表明成像包含了元数据未捕捉的有用信息，能够预测死亡率。另一种解释是，元数据并不是预测死亡率的体成分的完整替代指标。如果它们是完整的替代指标，将TBDXA成像与元数据结合不会显著提高或改变AUROC。组合结果产生了更好的AUROC，表明成像提供了超出元数据捕捉的信息，进一步证明了成像的有效性。

![](../Images/a8687529aa5670a4884b1d74d330787d.png)

[单记录和连续模型AUC性能（作者提供的图片）](https://www.nature.com/articles/s43856-022-00166-9#Fig2)

总体来看，纵向或序列模型的表现优于单一记录模型。这一点在所有建模方法和输入数据类型（元数据、仅图像、组合的元数据和图像）中都适用。这些结果展示了建模变化及健康数据时间依赖性的重要性。

我们进行了综合辨别改进（IDI）分析，以评估将成像与元数据结合使用相较于仅使用元数据的好处。该分析是在表现优于单一记录模型的序列模型上进行的。IDI的结果为5.79，其中集成敏感性和特异性分别为3.46和2.33。这表明，将成像与元数据结合使用可以将模型正确识别出未来10年内无法生存者的能力提高3.46%，并将正确识别出未来10年内能够生存者的能力提高2.33%。总体来说，这表明模型性能的改善大约为5.8%。

![](../Images/2e62bc603aa9a8cd6a2e815be4717109.png)

[综合辨别改进（IDI）分析结果（作者提供的图像）](https://www.nature.com/articles/s43856-022-00166-9#Fig3)

# **那么，怎么了？**

我们的研究强调了纵向人工智能/机器学习模型在预测医疗领域，特别是全因死亡率方面的潜力。单一记录模型和纵向模型的比较分析显示，后者表现更佳，这表明建模时间变化在健康数据分析中的关键作用。我们的发现具有临床意义，包括通过考虑患者历史或纵向数据的模型提供更准确和全面的健康评估。此外，我们对可解释性人工智能的深入分析提供了与高10年死亡概率密切相关的变量的见解。其中一些变量是可改变的，可以在临床上进行干预，为许多人提供了改善其寿命和健康期的机会。虽然开发纵向健康模型所需的数据存在，但适当的基础设施和机构支持尚未完全到位，以便高效地进行数据整理和大规模开发这些模型。然而，许多人正在努力克服这些障碍，纵向模型的开发是医学中人工智能众多令人兴奋的前沿之一。

这些发现的临床意义深远。纵向模型有可能通过提供关于患者健康轨迹的更精确、个性化的预测来改进护理。这样的模型可以指导主动干预，从而提升护理结果，甚至可能延长生命。此外，使用元数据和影像数据为未来的 AI/ML 模型树立了新的标准，建议采取协同的方法以获得最佳结果。这加强了对多维度、细致数据的需求，以准确全面地描绘患者的健康状况。这些发现代表了 AI/ML 在医疗保健应用中的重要进展，突显了在追求精准医疗过程中的激动人心的前景。

# 更多资源：

## [**阅读论文**](https://www.nature.com/articles/s43856-022-00166-9)

[](https://www.nature.com/articles/s43856-022-00166-9?source=post_page-----f0309d718980--------------------------------) [## 深度学习预测基于纵向全身 DXA 成像的全因死亡率 …

### 死亡率研究已识别出预测全因死亡风险的生物标志物。这些标记物中的大多数，例如 …

www.nature.com](https://www.nature.com/articles/s43856-022-00166-9?source=post_page-----f0309d718980--------------------------------)

## 关于 IDI 和已发布示例的更多信息：

[](/area-under-the-curve-and-beyond-f87a8ec6937b?source=post_page-----f0309d718980--------------------------------) [## 曲线下面积及其应用

### 医生和数据科学家们，这里有一个关于 IDI 和 NRI 的介绍及一个 Python 代码示例。AUC 可能并不总是足够的 …

towardsdatascience.com](/area-under-the-curve-and-beyond-f87a8ec6937b?source=post_page-----f0309d718980--------------------------------) [](https://www.nature.com/articles/s43856-021-00024-0?source=post_page-----f0309d718980--------------------------------) [## 双能量三室乳腺成像用于成分生物标志物以提高检测 …

### 尽管乳腺成像如全视场数字乳腺摄影和数字乳腺断层扫描有助于减少 …

www.nature.com](https://www.nature.com/articles/s43856-021-00024-0?source=post_page-----f0309d718980--------------------------------) [](https://github.com/LambertLeong/AUC_NRI_IDI_python_functions?source=post_page-----f0309d718980--------------------------------) [## GitHub - LambertLeong/AUC_NRI_IDI_python_functions: 自定义 Python 函数帮助你进一步 …

### 自定义 Python 函数帮助你进一步分析机器学习模型和诊断测试 - GitHub …

github.com](https://github.com/LambertLeong/AUC_NRI_IDI_python_functions?source=post_page-----f0309d718980--------------------------------) [](https://www.lambertleong.com/thoughts/AUC-IDI-NRI?source=post_page-----f0309d718980--------------------------------) [## 曲线下面积与集成歧视改进和净重新分类的结合

### 医生和数据科学家，这里是关于 IDI 和 NRI 的介绍，并附有一个 Python 编码示例。AUC 可能并不总是足够的…

[www.lambertleong.com](https://www.lambertleong.com/thoughts/AUC-IDI-NRI?source=post_page-----f0309d718980--------------------------------)

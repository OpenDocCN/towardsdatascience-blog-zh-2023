- en: Confidence Interval vs Prediction Interval
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/confidence-vs-prediction-intervals-are-you-making-these-costly-analysis-mistakes-fa02b074498](https://towardsdatascience.com/confidence-vs-prediction-intervals-are-you-making-these-costly-analysis-mistakes-fa02b074498)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: An exploration into the key differences between confidence and prediction intervals
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)[![Egor
    Howell](../Images/1f796e828f1625440467d01dcc3e40cd.png)](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)[](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)
    [Egor Howell](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)
    ·6 min read·Jun 4, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0431f8f5d270f3410c3ddff11082e605.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
- en: Photo by [Jarosław Kwoczała](https://unsplash.com/@sumekler?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: Background
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The terms ‘[***confidence interval***](https://medium.com/towards-data-science/confidence-intervals-simply-explained-58b0b11e985f)’
    and ‘[***prediction interva***](https://en.wikipedia.org/wiki/Prediction_interval)***l***’
    are frequently thrown around interchangebly inside Data Science meetings. I must
    confess that I’ve done it myself sometimes, just to appear smart.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: However, this is dangerous. Confidence and prediction intervals refer to very
    different things and you risk potentially being caught off guard by someone who
    understands the difference. That would definitely be embarrassing.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: But don’t despair! In this article, I will intuitively explain the difference
    between the two intervals and make you feel confident in applying them.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: Confidence Interval
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Overview
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The more well-known one is the confidence interval, so let’s start here. A
    confidence interval is a measure of uncertainty on some sampled parameters such
    as the mean from a sample or a coefficient in a [**regression model**](https://en.wikipedia.org/wiki/Regression_analysis).
    It helps us understand the proximity of our estimate to the true population value.
    If you’re interested in learning more about confidence intervals, feel free to
    check out my previous blog post on the topic:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: '[](/confidence-intervals-simply-explained-58b0b11e985f?source=post_page-----fa02b074498--------------------------------)
    [## Confidence Intervals Simply Explained'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: A concise explanation of confidence intervals.
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/confidence-intervals-simply-explained-58b0b11e985f?source=post_page-----fa02b074498--------------------------------)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/confidence-intervals-simply-explained-58b0b11e985f?source=post_page-----fa02b074498--------------------------------)
- en: Theory
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理论
- en: 'Consider the simple [**linear regression**](https://en.wikipedia.org/wiki/Linear_regression)
    equation in its two forms:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑 [**线性回归**](https://en.wikipedia.org/wiki/Linear_regression) 方程的两种形式：
- en: '![](../Images/abd2e8a1de7e995842dde5f5c8f5bde7.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/abd2e8a1de7e995842dde5f5c8f5bde7.png)'
- en: Equation by author in LaTeX.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 公式由作者提供，使用 LaTeX 排版。
- en: '**y**: *Response*'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**y**: *响应*'
- en: '**x**: *Covariate or feature*'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**x**: *协变量或特征*'
- en: '**β₀:** *Coefficient for the slope*'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**β₀:** *斜率系数*'
- en: '**β₁:** *Intercept*'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**β₁:** *截距*'
- en: '**ε:** *Gaussian random noise*'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ε:** *高斯随机噪声*'
- en: '**E[y | x]**: *Mean response of y given x*'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**E[y | x]**: *给定 x 的 y 的均值响应*'
- en: The goal of linear regression is to determine the unknown coefficients **β₀**
    and **β₁** based on some data, represented by the variables **x** and corresponding
    outputs or response **y**. However, in practice, we often only have access to
    a random sample from the entire population. Consequently, the values of **β₀**
    and **β₁** are subject to uncertainty since they are estimated from this random
    sample and not the population. This uncertainty is the source of ‘error’ in regression
    models.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 线性回归的目标是根据一些数据确定未知的系数 **β₀** 和 **β₁**，这些数据由变量 **x** 和相应的输出或响应 **y** 表示。然而，在实际应用中，我们通常只能访问整个总体的随机样本。因此，**β₀**
    和 **β₁** 的值会存在不确定性，因为它们是从这个随机样本中估计的，而非总体。这种不确定性是回归模型中的“误差”来源。
- en: In the case of a confidence interval, it represents the level of uncertainty
    associated with the estimated mean response, **E[y | x]**. Let’s consider an example
    of a dataset comparing salary and age, where we find that the mean salary for
    a 23-year-old is £28,000, E[salary | 23] = £28,000\. If we calculate a 95% confidence
    interval and obtain a range of £26,000 to £30,000, it suggests that we can expect
    the true mean salary for the entire population of 23-year-olds to fall within
    this interval with a probability of 95%. Although this explanation may not capture
    all the intricacies, it serves the purpose of providing a general intuition.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在置信区间的情况下，它表示与估计的均值响应 **E[y | x]** 相关的不确定性水平。假设我们有一个比较工资和年龄的数据集，发现23岁时的平均工资为28,000英镑，E[salary
    | 23] = 28,000英镑。如果我们计算95%的置信区间，并得到26,000到30,000英镑的范围，这表明我们可以以95%的概率预期，所有23岁人群的真实平均工资会落在此区间内。虽然这个解释可能无法涵盖所有细节，但它提供了一个总体的直观理解。
- en: See [here](https://robjhyndman.com/hyndsight/intervals/) for a rigorous definition
    of the confidence interval and its implications.
  id: totrans-30
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 查看 [这里](https://robjhyndman.com/hyndsight/intervals/) 以获取置信区间及其含义的严格定义。
- en: 'To put it in one sentence:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 一句话总结：
- en: Confidence Interval = Uncertainty In The Mean Response
  id: totrans-32
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 置信区间 = 均值响应中的不确定性
- en: Formula
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 公式
- en: 'The formula for the confidence interval in regression is quite lengthy, but
    luckily most statistical software perform it for us! However, for completeness,
    let’s state the formula and highlight some key features:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 回归中置信区间的公式相当复杂，但幸运的是大多数统计软件可以为我们计算！然而，为了完整性，让我们陈述公式并突出一些关键特征：
- en: '![](../Images/69df99eb4de6b67338c4bf56364b258e.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/69df99eb4de6b67338c4bf56364b258e.png)'
- en: Equation by author in LaTeX.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 公式由作者提供，使用 LaTeX 排版。
- en: '![](../Images/7ba99feb36ec2c3e00ed7406b1fd60ff.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7ba99feb36ec2c3e00ed7406b1fd60ff.png)'
- en: Equation by author in LaTeX.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 公式由作者提供，使用 LaTeX 排版。
- en: 'Where:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 其中：
- en: '**x**: *The feature or covariate value*'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**x**: *特征或协变量值*'
- en: '**ŷ:** T*he prediction for x*'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ŷ:** *x 的预测值*'
- en: '***t_(1-α/2, n-2)** = [***T-distribution***](/statistical-t-test-simply-explained-b510045d69e)*critical
    value for a confidence level of 1-α**with n-2* [***degrees of freedom***](https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics))*'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***t_(1-α/2, n-2)** = [***T 分布***](/statistical-t-test-simply-explained-b510045d69e)*置信水平为1-α**的临界值，*自由度为
    n-2* [***自由度***](https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics))*'
- en: '***n**: *Number of data points in the sample**'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***n**: *样本中的数据点数量**'
- en: '***y**: *The true/actual responses**'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***y**: *真实/实际响应**'
- en: '***MSE**: [*The mean squared error*](https://en.wikipedia.org/wiki/Mean_squared_error)*'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***MSE**: [*均方误差*](https://en.wikipedia.org/wiki/Mean_squared_error)*'
- en: '*Again, don’t get too bogged down in this mathematical details — I certainly
    haven’t! The purpose was simply to provide a little insight into the origin of
    the formula. As you can see, its mainly unifying the spread of the data and the
    error in the prediction. If you’re interested in a comprehensive derivation, checkout
    this link [here](https://online.stat.psu.edu/stat415/lesson/7/7.5).*'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '*Prediction Interval*'
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*Overview*'
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*The confidence interval measures the uncertainty in estimating the mean response,
    so what does the prediction interval do? The prediction interval measures the
    uncertainty of where a new sampled value is likely to fall. It achieves this by
    considering all the observed responses in the current sample. It takes into account
    both the variability in our sample and the uncertainty of the estimated regression
    model.*'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: '*Theory*'
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*Remember our simple linear regression equation above:*'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/abd2e8a1de7e995842dde5f5c8f5bde7.png)*'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: '*Equation by author in LaTeX.*'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: '*The confidence interval express the sampling uncertainty in **E[y | x],**
    whereas the prediction interval express the uncertainty in the range of **y.**
    As it is considering the whole range and not just the mean, the prediction is
    naturally larger than the confidence interval.*'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: '*The confidence interval expresses the sampling uncertainty associated with
    estimating **E[y | x]**, the expected value of **y** on **x**. Whereas, the prediction
    interval captures the uncertainty in the whole range of possible values of **y**.
    Since the prediction interval considers the entire range and not just the mean,
    it is naturally wider than the confidence interval.*'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '*Formula*'
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*The formula for the prediction interval is closely related to that of the
    confidence interval:*'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/18d4fd6b26b51c34417a401842af586a.png)*'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: '*However, do you observe the one key difference? That’s right, there is an
    additional term involving the MSE. By introducing this extra positive term, we
    can see mathematically that the prediction interval will be larger than the confidence
    interval.*'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '*Example Plot*'
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*To better understand confidence and prediction intervals, let’s walk through
    an example that visualises them. Below is a code snippet that generates a plot
    displaying the relationship between salary and experience. The plot includes the
    data points, the regression line, and the 95% confidence and prediction intervals:*'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '*Data from [Kaggle](https://www.kaggle.com/datasets/abhishek14398/salary-dataset-simple-linear-regression)
    with a CC0 licence.*'
  id: totrans-62
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*GitHub Gist by author.*'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/1ec88e4d34ae09a5b36708e1eceedaaa.png)*'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '*Plot generated by author in Python.*'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
- en: '*As we can see, the prediction interval is much wider than the confidence interval.*'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: '*Summary & Further Thoughts*'
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*In this article, we have explored the differences between confidence and prediction
    intervals. To summarise the key points, refer to the table below:*'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/4efda2d6fcbf679acd975cd38a6d08a4.png)*'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '*Table by author.*'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '*Now that you understand the difference, you can correct anyone who mistakenly
    uses the two terms interchangeably!*'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: '*The full code used in this post can be found on my GitHub here:*'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: '*[](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/General/confidence_vs_prediction_intervals.py?source=post_page-----fa02b074498--------------------------------)
    [## Medium-Articles/confidence_vs_prediction_intervals.py at main · egorhowell/Medium-Articles'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: Code I use in my medium blog/articles. Contribute to egorhowell/Medium-Articles
    development by creating an account on…
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/General/confidence_vs_prediction_intervals.py?source=post_page-----fa02b074498--------------------------------)
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: Another Thing!
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have a free newsletter, [**Dishing the Data**](https://dishingthedata.substack.com/),
    where I share weekly tips for becoming a better Data Scientist. There is no “fluff”
    or “clickbait,” just pure actionable insights from a practicing Data Scientist.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://newsletter.egorhowell.com/?source=post_page-----fa02b074498--------------------------------)
    [## Dishing The Data | Egor Howell | Substack'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: How To Become A Better Data Scientist. Click to read Dishing The Data, by Egor
    Howell, a Substack publication with…
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: newsletter.egorhowell.com](https://newsletter.egorhowell.com/?source=post_page-----fa02b074498--------------------------------)
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: Connect With Me!
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**YouTube**](https://www.youtube.com/@egorhowell)'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**LinkedIn**](https://www.linkedin.com/in/egor-howell-092a721b3/)'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Twitter**](https://twitter.com/EgorHowell)'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**GitHub**](https://github.com/egorhowell)'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: References & Further Reading
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'More in depth discussion about the two intervals: [https://online.stat.psu.edu/stat501/lesson/3/3.3](https://online.stat.psu.edu/stat501/lesson/3/3.3)'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'More discussion and relation to tolerance intervals: [https://blog.minitab.com/en/adventures-in-statistics-2/when-should-i-use-confidence-intervals-prediction-intervals-and-tolerance-intervals](https://blog.minitab.com/en/adventures-in-statistics-2/when-should-i-use-confidence-intervals-prediction-intervals-and-tolerance-intervals)'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Inspiration for the code tutorial: [https://lmc2179.github.io/posts/confidence_prediction.html](https://lmc2179.github.io/posts/confidence_prediction.html)*'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

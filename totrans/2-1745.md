# Python 类型提示在数据科学项目中：必须、可能还是不推荐？

> 原文：[https://towardsdatascience.com/python-type-hinting-in-data-science-projects-a-must-a-maybe-or-a-no-no-d76b8a53e37b](https://towardsdatascience.com/python-type-hinting-in-data-science-projects-a-must-a-maybe-or-a-no-no-d76b8a53e37b)

## PYTHON 编程

## 我们应该在 Python 实现的数据科学项目中使用类型提示吗？

[](https://medium.com/@nyggus?source=post_page-----d76b8a53e37b--------------------------------)[![Marcin Kozak](../Images/d7faf62e48ed81dab5d8ad92819fff54.png)](https://medium.com/@nyggus?source=post_page-----d76b8a53e37b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----d76b8a53e37b--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----d76b8a53e37b--------------------------------) [Marcin Kozak](https://medium.com/@nyggus?source=post_page-----d76b8a53e37b--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----d76b8a53e37b--------------------------------) ·阅读时间 6 分钟·2023年9月26日

--

![](../Images/fb8966e277eba25a6d58485fa18f1c9d.png)

无论你是否是 Python 类型提示的满意用户，你都需要了解这些概念以及如何使用它们。照片由 [Kerin Gedge](https://unsplash.com/@keringedge?utm_source=medium&utm_medium=referral) 拍摄，来源于 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

我们应该在 Python 实现的数据科学项目中使用类型提示吗？

想要免责声明吗？请看这里：这要看情况。在概念验证类型的项目中，通常是不必要的。在生产项目中，至少在 2023 年，这还是有必要的。但再次说明，这要看情况。

我会尽量简明扼要，尽快切入重点。我不想花费数小时考虑所有的利弊，原因很简单，因为数据科学市场对我们的工作有明确的期望。我的目标是向你展示这些期望，而不是详细讨论它们。

让我们从显而易见的事情开始。首先，Python 中的类型提示是 *可选的*。可选的意思是 *你不必在 Python 中使用类型提示*。如果是这样，那么我们主要问题的唯一答案是：你可以，但不，您不必在数据科学项目中使用类型提示！

那么…就这样吗？我们完成了吗？

等一下。我们确实陈述了显而易见的内容，但我们并没有触及任何超出显而易见的内容。

> 我们应该在 Python 实现的数据科学项目中使用类型提示吗？这要看情况。在概念验证类型的项目中，这并不是必要的。在生产项目中，至少在 2023 年，这还是有必要的。

举个例子。假设你是一个在私人公司工作的 Python 开发者。公司有自己关于 Python 开发的规则和建议。其中一条规则是：使用类型提示。就这么简单——不管你偏好什么，你都必须使用它们。如果这只是一个建议，你可能不需要使用它们。然而，由于这是一个规则，你必须使用*可选*类型提示。

好的，这点说得很好。但我们讨论的是一般数据科学项目中的类型提示，而不是某个特定公司里的情况。那么，是可选的，对吗？你不一定非得使用它们？

在回答之前，让我告诉你我在 Python 中使用类型提示的方式、时间和原因。

我在这里写了我对类型提示的看法：

[](https://betterprogramming.pub/pythons-type-hinting-friend-foe-or-just-a-headache-73c7849039c7?source=post_page-----d76b8a53e37b--------------------------------) [## Python 的类型提示：朋友、敌人还是仅仅是个麻烦？

### 类型提示在 Python 社区中的受欢迎程度不断上升。这会把我们带向何方？我们可以做些什么来使用它……

[betterprogramming.pub](https://betterprogramming.pub/pythons-type-hinting-friend-foe-or-just-a-headache-73c7849039c7?source=post_page-----d76b8a53e37b--------------------------------)

简而言之，我尝试以一种使代码更具可读性的方法来使用类型提示。此外，多亏了类型提示，静态检查器可以帮助保持代码的正确性。

> 我们应该记住，Python 的核心在于动态类型。

同时，我们应该记住，Python 的核心在于动态类型。当我们在实现类型提示上花费大量精力时，我们有点像是在剥离 Python 的动态类型。那么剩下的是什么？剩下的就是没有核心的 Python。

> 当我们在实现类型提示上花费大量精力时，我们有点像是在剥离 Python 的动态类型。那么剩下的是什么？剩下的就是没有核心的 Python。

我认为，有些情况下不应该使用类型提示。例如快速原型设计。我经常这样做：为了看看某些东西如何工作，我实现一个简单的原型。有时我可能会使用一些类型提示，只是为了展示所需的参数类型，尤其是当这些类型是自定义类型时。记住，我说的是原型设计，如果说明一个特定的函数返回`dict[str, tuple[int, str]]`类型的对象很重要，那我会在类型提示中说明它。不是为了让静态检查器满意，而是为了展示需要展示的内容。

但在原型设计阶段，我更常忽略类型提示。到时自然会用到它们。现在重要的是代码能够动态运行。这时静态类型*并不*那么有用。

但当我编写数据科学软件产品时，现在我总是使用类型提示。我会坦白地说。是的，它们可以（动态地）帮助捕捉一些静态错误——但它们也可能成为很大的障碍。有时候，我觉得实现良好的类型提示比其他所有工作加起来还要花费更多的时间。代码会变得更长、更复杂。在高级项目中，良好的类型提示可能很难实现，主要是由于代码的复杂性。更糟糕的是，许多类型检查器仍然远未达到最佳状态，可能会在类型提示正确时显示错误。确实，你可以保持类型提示过于简单（`x: dict`），但通常不应该这样做。在生产项目中，你应该更详细，因此，不应做如下操作：

[PRE0]

比如，你可能需要做如下操作：

[PRE1]

或者，相当于：

[PRE2]

没有类型提示，代码变成了：

[PRE3]

哪种更好？你不会惊讶于我的答案：好吧，这要看情况。

让我们总结一下上述提供的选项：

+   无类型提示：基于鸭子类型的快速编码。

+   过于简化的类型提示：编码稍慢，但这种类型提示的优势相当有限。

+   更详细的类型提示：静态检查器提供了很大的帮助，但编码速度大幅降低，同时静态检查器失败的风险也大大增加；通常，鸭子类型变得隐蔽，如果不是被遗忘的话；代码可读性下降。

+   基于类型别名的更详细类型提示：与上述类似，但代码更易读。

+   极其详细的类型提示，细节到最深层次：对我来说，绝对是一种过于狂热的方法，没有优势且有许多缺点，和详细的类型提示一样——但在一种夸张的形式中。

+   专用工具如 `[pylance](https://pypi.org/project/pylance/)` 或 `[typeguard](https://pypi.org/project/typeguard/)`。但请记住，这些工具可能会导致运行时效率成本，如果你决定在运行时类型检查中使用它们——而类型提示本身是一个静态检查工具，对运行时没有影响。

如常，最佳选择通常在这些选项之间的某个地方，你可以称之为黄金选择。但这个选择的位置取决于项目的多个方面，如客户、公司、项目负责人以及——最重要的——项目的类型。

在原型设计过程中，你通常会选择不使用类型提示，特别是当你不是类型提示的忠实粉丝时。然而，当你是时，你会发现自己更经常地使用它们——除非截止日期太紧迫，甚至无法再多花一分多余的时间。那是多余的吗？好吧，你已经知道答案了……这要看情况。

上述方法是我在日常数据科学工作中遵循的做法。一些细节因项目而异，但大体上几乎都是一样的。我认为这些是大多数进行数据科学项目的公司遵循的规则，因此你也可能希望遵循这些规则——除非公司或项目的规则非常严格。否则，你可能没有选择的余地。

无论你是否是一个快乐的类型提示用户，你都应该了解它是如何工作的以及如何使用它。如今，一个不知道如何使用类型提示的 Python 开发者… 已经不再是 Python 开发者了。接受这一点：你必须了解类型提示，并且要了解得很透彻。

不过请记住，Python 的类型提示系统仅在一定复杂度下才有帮助。即使你作为代码的作者了解你实现的复杂类型提示的所有细节，其他开发者也可能需要花费很多时间来理解代码。如果我被迫越过这一界限，我可能会认为是时候换一种语言了。被迫走到这一步，我会认为像 Go 这样的静态类型语言可能会更好。

感谢阅读。如果你喜欢这篇文章，你也可能喜欢我写的其他文章；你可以在[这里](https://medium.com/@nyggus)查看。如果你想加入 Medium，请使用下面的推荐链接：

[## 通过我的推荐链接加入 Medium - Marcin Kozak](https://medium.com/@nyggus/membership?source=post_page-----d76b8a53e37b--------------------------------)

### 作为 Medium 的会员，你的一部分会员费用会流向你阅读的作者，你可以完全访问每一个故事…

[medium.com](https://medium.com/@nyggus/membership?source=post_page-----d76b8a53e37b--------------------------------)

- en: 'Non-Parametric Tests for Beginners (Part 1: Rank and Sign Tests)'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/non-parametric-tests-for-beginners-part-1-rank-and-sign-tests-629704f27f2f](https://towardsdatascience.com/non-parametric-tests-for-beginners-part-1-rank-and-sign-tests-629704f27f2f)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: With examples and R codes
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@jaekim8080?source=post_page-----629704f27f2f--------------------------------)[![Jae
    Kim](../Images/34716958ecfe8c0540f5cf5c1640d587.png)](https://medium.com/@jaekim8080?source=post_page-----629704f27f2f--------------------------------)[](https://towardsdatascience.com/?source=post_page-----629704f27f2f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----629704f27f2f--------------------------------)
    [Jae Kim](https://medium.com/@jaekim8080?source=post_page-----629704f27f2f--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----629704f27f2f--------------------------------)
    ·9 min read·Jun 1, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/91888e55e896cb2b8b8478a2f184525d.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Joshua Earle](https://unsplash.com/@joshuaearle?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Non-parametric test is an important branch of inferential statistics. Yet, it
    is not widely used, nor fully understood, by many data scientists and analysts.
    It is a natural alternative to a parametric test such as the conventional t-test,
    with a range of advantages and a strong potential to be highly useful for modern
    applications such as A/B testing.
  prefs: []
  type: TYPE_NORMAL
- en: Non-parametric tests are constructed based on the ranks or signs of data points,
    or using the re-sampling methods such as the bootstrap. In this post, those based
    on ranks and signs are discussed with examples and R code. The bootstrap methods
    will be discussed in the second part of the series. I should like to thank Venkat
    Raman whose recent [LinkedIn post](https://www.linkedin.com/feed/update/urn:li:activity:7068311379614593024/)
    motivated this post.
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Parametric vs. Non-parametric tests
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Inferential statistic or hypothesis testing is conducted with the following
    key elements:'
  prefs: []
  type: TYPE_NORMAL
- en: The null and alternative hypotheses (H0 and H1)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Test statistic
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sampling distribution of the test statistic under H0
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Decision rule (p-value or critical value, at a given level of significance)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Parametric tests
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: They include well-known tests such as the t-test, F-test, and chi-squared test.
    A typical feature of a parametric test is that
  prefs: []
  type: TYPE_NORMAL
- en: it requires estimation of the unknown parameters such as the mean and variance;
    and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: its sampling distribution follows a normal distribution or other distributions
    derived from it (e.g., a F-distribution or chi-squared distribution).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To ensure the normality of the sampling distribution, the population should
    follow a normal distribution. If it is non-normal, then the sampling distribution
    is approximated by a normal distribution when the sample size is sufficiently
    large. This is called *asymptotic approximation*, whose validity is based on the
    central limit theorem under a range of parametric assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: Non-parametric tests
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Non-parametric tests calculate the test statistics and their sampling distributions
    in different ways from their parametric counterparts:'
  prefs: []
  type: TYPE_NORMAL
- en: They are obtained using fully data-dependent methods such as the ranks and signs
    of data points, without having to estimate the population parameters.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A non-parametric test has an *exact* sampling distribution, in the sense that
    it can be obtained without resorting to any approximation. The distribution is
    either fully known analytically or can be obtained computationally using a Monte
    Carlo simulation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The advantages of a non-parametric test include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: It does not require strong parametric assumptions such as the normality of the
    population;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It does not require an asymptotic approximation to its sampling distribution;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Since sampling distribution is exact, the level of significance (the probability
    of Type I error) is always correct in repeated sampling (no size distortion);
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Its p-values and critical values are also exact; and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Its power (probability of rejecting a false null hypothesis) is often higher
    than its parametric alternatives, especially when the sample size is small.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Its main disadvantage is that computation of the exact sampling distribution
    (and also exact p-value and critical values) can be time-consuming, when the sample
    size is large or massive. However, this is a minor issue in modern times where
    computational power is becoming increasingly stronger. In addition, many non-parametric
    tests adopt analytic formulae or efficient algorithms, which can accurately approximate
    their exact p-values or critical values, when the computational burden is heavy.
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Simple non-parametric tests
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sign test for the median
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Consider a variable X generated purely randomly from its population. Using its
    sample realization (X1, …, Xn), a researcher wishes to test for
  prefs: []
  type: TYPE_NORMAL
- en: 'H0: median = 0; H1: median ≠ 0.'
  prefs: []
  type: TYPE_NORMAL
- en: Under H0, each X values should be positive (or negative) with the probability
    of 0.5\. Alternatively, the expected number of positive cases of X under H0 is
    n/2.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let the test statistic T(X,n) be the total number of the cases where X > 0\.
    The sampling distribution of T(X,n) under H0 follows a binomial distribution with
    n trials, each with the probability of success (p) equal to 0.5, denoted as B(n,
    p = 0.5). The distribution B(n=20, p = 0.5) is plotted as below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0b05d2d9296c45eb65dafc42a48f223c.png)'
  prefs: []
  type: TYPE_IMG
- en: Exact sampling distribution of T(X, n=20), Image Created by the Author
  prefs: []
  type: TYPE_NORMAL
- en: The above is the exact sampling distribution of the test statistic T(X,n) under
    H0, when n = 20\. If the observed value of T(X,n) is close to 10, then the null
    hypothesis cannot be rejected. The exact p-value of the test can be calculated
    using the *binom.test* function in R.
  prefs: []
  type: TYPE_NORMAL
- en: As an example, consider the following X and Y values with n = 20.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/673cd80de505c21cc47b1c6c5de4c98e.png)'
  prefs: []
  type: TYPE_IMG
- en: Table 1 (Positive = 1 if X > 0; Positive = 0 otherwise), Image Created by the
    Author
  prefs: []
  type: TYPE_NORMAL
- en: 'From Table 1 above, T(X) = 12 and T(Y) = 18, with the median of X being 0.36
    and that of Y 1.67\. It is clear that X is highly compatible with H0 while Y is
    not. The exact p-value of the test for X is 0.5034 and that for Y is 0.0004, which
    can be obtained using the R function as below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: When n is large, the sampling distribution still exactly follows B(n, p = 0.5).
    The distribution, however, approaches a normal distribution with the mean 0.5n
    and variance 0.25n. As a result, a normal distribution can be used as an approximation
    to the exact distribution B(n, p=0.5), when n is large.
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Rank test for randomness
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A simple test for randomness of a set of time series observations can be conducted
    using the rank of data. The rank is calculated as the ranking values of the sample
    observations (X1, …, Xn) ordered in an ascending order. That is, the value 1 is
    assigned to the smallest value of X; the value of 2 is assigned to the next smallest
    value of X; and so on, until the value n is assigned to the largest value.
  prefs: []
  type: TYPE_NORMAL
- en: 'The null hypothesis is that a time series is purely random against the alternative
    that it is not. [Bartels (1982)](https://www.researchgate.net/publication/230639951_The_Rank_Version_of_von_Neumann''s_Ratio_Test_for_Randomness)
    proposed a test statistic of the following form:'
  prefs: []
  type: TYPE_NORMAL
- en: Equation (1)
  prefs: []
  type: TYPE_NORMAL
- en: 'where Ri is the rank of the ith value (Xi) in the sequence of n observations.
    Under the null hypothesis, (R1, …, Rn) follows any permutation of (1, …., n) with
    an equal probability. This is because if the time series observations are purely
    random, its ranks should also be purely random. Based on this point, the exact
    distribution of RV can be simulated with the following R code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The above R code generates the exact sampling distribution of RV under H0 when
    n = 20, which is plotted below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1904c68babe76428bb34d3d00a7ceffd.png)'
  prefs: []
  type: TYPE_IMG
- en: Exact Sampling Distribution of RV, Image Created by the Author
  prefs: []
  type: TYPE_NORMAL
- en: The exact p-value or critical values are obtained from the above distribution
    in a usual way. Note that the critical values (given with the R code above) are
    almost identical to those tabulated by Bartels (1982).
  prefs: []
  type: TYPE_NORMAL
- en: The null hypothesis of pure randomness is rejected if the calculated RV statistic
    given in equation (1) is less than the critical value at a level of significance.
    This is because a purely random series has its ranks values also purely random,
    which will lead to a large value of RV statistic (see the example below).
  prefs: []
  type: TYPE_NORMAL
- en: When the sample size is large or massive, the above simulation can still be
    conducted to generate the exact sampling distribution without a heavy computational
    burden. Bartels (1982) also provides approximation formulae for these exact critical
    values.
  prefs: []
  type: TYPE_NORMAL
- en: 'As an example, consider X and Y in Table 1 plotted as below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0723462a4347000b3a2532af469c8799.png)'
  prefs: []
  type: TYPE_IMG
- en: Time plots of X and Y (Image Created by Author)
  prefs: []
  type: TYPE_NORMAL
- en: 'The variable X appears to be random around 0, while Y shows an upward trend
    which is a feature of a time series that is not purely random. The following R
    code plots X and Y, and calculates the RV statistics with their p-values:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The RV statistic for X is 2.21 with the p-value of 0.6844; while that of Y is
    0.32 with the p-value of 0.0000\. This means that the null hypothesis that X is
    purely random cannot be rejected at a conventional level of significance, but
    that for Y is rejected.
  prefs: []
  type: TYPE_NORMAL
- en: 'The calculation is also illustrated in the table below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c916129db07fa92dcaba59b96cac757.png)'
  prefs: []
  type: TYPE_IMG
- en: Illustration of the RV statistic for X and Y (Image Created by the Author)
  prefs: []
  type: TYPE_NORMAL
- en: Being a purely random series, X has its rank values purely random and highly
    variable (resulting in a large value in the numerator of RV). In contrast, Y is
    not purely random, and its rank values do not change very much. As a result of
    this property, the RV statistic for X is much larger than that of Y.
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Wilcoxon tests
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Wilcoxon tests ([McDonald, 2014](http://www.biostathandbook.com/wilcoxonsignedrank.html))
    are non-parametric alternatives to Welch’s two-sample t-tests. The null hypothesis
    is that the median values of two populations are equal, against alternative that
    they are not. There are two versions of the test:'
  prefs: []
  type: TYPE_NORMAL
- en: Wilcoxon rank-sum test (also called Mann–Whitney–Wilcoxon test), when X and
    Y are independent; and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wilcoxon signed-rank test, when X and Y are paired.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let (X1, …, Xn) and (Y1, …, Ym) be the random samples from the respective populations.
    The test statistic for the independent sample (Wilcoxon rank-sum test) is given
    by
  prefs: []
  type: TYPE_NORMAL
- en: where S(X,Y) = 1 if X > Y; S(X,Y) = 0.5 if X = Y; and S(X,Y) = 0 if X < Y.
  prefs: []
  type: TYPE_NORMAL
- en: The statistic for the case of dependent samples (Wilcoxon signed-rank test)
    is calculated as
  prefs: []
  type: TYPE_NORMAL
- en: where Zi = Xi — Yi; sgn(Zi) =1 if Zi > 0, sgn(Zi) = — 1 if otherwise; and Ri
    is the rank of |Zi| (absolute value of Zi). Note that there are different versions
    of T statistic being used, but they are all equivalent.
  prefs: []
  type: TYPE_NORMAL
- en: For both U and T statistics, the exact sampling distributions under H0 can be
    obtained by a Monte Carlo simulation or can be approximated.
  prefs: []
  type: TYPE_NORMAL
- en: For X and Y given in Table 1, the R code for the Wilcoxon tests are given by
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'where H0: μ = 0 and μ = median(X) — median(Y). The U test statistic is 67.5
    with the p-value of 0.0004; and T statistic is 11 with the p-value of 0.0001\.
    Hence, at the 5% level of significance, both tests reject the null hypothesis
    that the medians are equal.'
  prefs: []
  type: TYPE_NORMAL
- en: This post has reviewed three simple non-parametric tests based on ranks and
    signs. The main difference between non-parametric and parametric tests is how
    the test statistics and their sampling distributions under H0 are calculated.
    That is,
  prefs: []
  type: TYPE_NORMAL
- en: The test statistic and the sampling distribution of a non-parametric test are
    obtained using the fully data-dependent methods such as the ranks and signs, without
    having to estimate the unknown population parameters.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: They are obtained without resorting to any parametric assumptions or asymptotic
    approximations based on the central limit theorem.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The sampling distribution of a non-parametric test is exact. As a result, the
    test is conducted without any size distortion, and its p-value and critical values
    are exact.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A non-parametric test often shows better statistical properties than its parametric
    counterparts (e.g., a higher statistical power and no size distortion), especially
    when the sample size is small or when the assumptions of parametric tests are
    violated.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It is strongly recommended that the researchers adopt these non-parametric tests
    in their applications (such as the A/B tests) as an alternative to the parametric
    tests. In this post, several simple non-parametric tests are presented with examples
    and R codes.
  prefs: []
  type: TYPE_NORMAL
- en: 'References:'
  prefs: []
  type: TYPE_NORMAL
- en: Bartels, R. (1982). The rank version of von Neumann’s ratio test for randomness.
    *Journal of the American Statistical Association*, *77*(377), 40–46.
  prefs: []
  type: TYPE_NORMAL
- en: McDonald, J. H. (2014). *Handbook of biological statistics*. New York. [http://www.biostathandbook.com/wilcoxonsignedrank.html](http://www.biostathandbook.com/wilcoxonsignedrank.html)
  prefs: []
  type: TYPE_NORMAL

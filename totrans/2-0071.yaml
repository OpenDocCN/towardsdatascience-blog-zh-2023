- en: 4 All Time Useful Tricks Of Pandas Group By
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 4 ä¸ªå†æ¥æœ€æœ‰ç”¨çš„ pandas groupby æŠ€å·§
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b](https://towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b](https://towardsdatascience.com/4-all-time-useful-use-cases-of-pandas-group-by-77aae706322b)
- en: Data Science
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ•°æ®ç§‘å­¦
- en: A One-stop-solution For All Your Questions About Data Aggregation Using Pandas
    Groupby
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼šè§£ç­”ä½ å…³äºä½¿ç”¨ pandas groupby è¿›è¡Œæ•°æ®æ±‡æ€»çš„æ‰€æœ‰é—®é¢˜
- en: '[](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)[![Suraj
    Gurav](../Images/f5dca32861f8c1c428e66fbe2174c04b.png)](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)
    [Suraj Gurav](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)[![Suraj
    Gurav](../Images/f5dca32861f8c1c428e66fbe2174c04b.png)](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)[](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)
    [Suraj Gurav](https://medium.com/@17.rsuraj?source=post_page-----77aae706322b--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)
    Â·8 min readÂ·Mar 24, 2023
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨åœ¨ [Towards Data Science](https://towardsdatascience.com/?source=post_page-----77aae706322b--------------------------------)
    Â·é˜…è¯»æ—¶é—´ 8 åˆ†é’ŸÂ·2023å¹´3æœˆ24æ—¥
- en: --
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/6cb476af3f438709882dc9b91ed40ea2.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6cb476af3f438709882dc9b91ed40ea2.png)'
- en: Image by [Hands off my tags! Michael Gaida](https://pixabay.com/users/652234-652234/?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182)
    from [Pixabay](https://pixabay.com//?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”± [Hands off my tags! Michael Gaida](https://pixabay.com/users/652234-652234/?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182)
    æä¾›ï¼Œæ¥è‡ª [Pixabay](https://pixabay.com//?utm_source=link-attribution&amp%3Butm_medium=referral&amp%3Butm_campaign=image&amp%3Butm_content=1422182)
- en: In Python, pandas is a commonly used library for data analysis. With its many
    built-in functions and methods, it makes data analysis faster and easier.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Python ä¸­ï¼Œpandas æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ•°æ®åˆ†æåº“ã€‚å‡­å€Ÿå…¶ä¼—å¤šå†…ç½®å‡½æ•°å’Œæ–¹æ³•ï¼Œå®ƒä½¿æ•°æ®åˆ†æå˜å¾—æ›´å¿«ã€æ›´ç®€å•ã€‚
- en: One of the most important aspects of data analysis is data aggregation, which
    helps you group the data by one variable and aggregate the rest of the numeric
    data to get summary statistics. And ultimately, you can use these summary statistics
    to answer the business question.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®åˆ†æä¸­æœ€é‡è¦çš„æ–¹é¢ä¹‹ä¸€æ˜¯æ•°æ®æ±‡æ€»ï¼Œå®ƒå¸®åŠ©ä½ æŒ‰ä¸€ä¸ªå˜é‡å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å°†å…¶ä½™çš„æ•°å€¼æ•°æ®æ±‡æ€»ä»¥è·å–æ‘˜è¦ç»Ÿè®¡ä¿¡æ¯ã€‚æœ€ç»ˆï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ‘˜è¦ç»Ÿè®¡ä¿¡æ¯æ¥å›ç­”ä¸šåŠ¡é—®é¢˜ã€‚
- en: Thatâ€™s where pandas function â€” `**groupby()**` â€” is useful, which groups the
    data based on values from a categorical or non-numerical column and helps you
    to analyse the data by these newly formed groups.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ pandas å‡½æ•° `**groupby()**` çš„ç”¨é€”ï¼Œå®ƒæ ¹æ®åˆ†ç±»æˆ–éæ•°å€¼åˆ—çš„å€¼å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¸®åŠ©ä½ æŒ‰è¿™äº›æ–°å½¢æˆçš„ç»„åˆ†ææ•°æ®ã€‚
- en: In my one of the past article â€” [**5 Pandas Group By Tricks You Should Know
    in Python**](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94)â€”
    you can learn what is `groupby` and how to use it.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­ â€” [**ä½ åº”è¯¥çŸ¥é“çš„5ä¸ª pandas groupby æŠ€å·§**](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94)â€”
    ä½ å¯ä»¥äº†è§£ä»€ä¹ˆæ˜¯ `groupby` ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚
- en: In this article, I am explaining 4 highly useful and often googled pandas `groupby`
    tricks with examples, which you must know to effectively perform data analysis.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡Š4ä¸ªéå¸¸æœ‰ç”¨ä¸”å¸¸è¢«æœç´¢çš„ pandas `groupby` æŠ€å·§ï¼Œå¹¶é™„æœ‰ç¤ºä¾‹ï¼Œè¿™æ˜¯ä½ è¿›è¡Œæ•°æ®åˆ†ææ—¶å¿…é¡»äº†è§£çš„ã€‚
- en: Iâ€™ve also attached a complete Jupyter-Notebook with all the examples by the
    end of this article.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ–‡æœ«å°¾æˆ‘è¿˜é™„ä¸Šäº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç¤ºä¾‹çš„å®Œæ•´ Jupyter Notebookã€‚
- en: Letâ€™s get started!
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¼€å§‹å§ï¼
- en: For this article, Iâ€™m using the most popular dataset on [UC Irvine Machine Learning
    Repository](https://archive-beta.ics.uci.edu/) â€” [**Iris**](https://archive-beta.ics.uci.edu/dataset/53/iris)
    â€” which is created by R.A. Fisher and available under [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/legalcode)
    license.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† [UC Irvine Machine Learning Repository](https://archive-beta.ics.uci.edu/)
    ä¸Šæœ€å—æ¬¢è¿çš„æ•°æ®é›† â€” [**Iris**](https://archive-beta.ics.uci.edu/dataset/53/iris) â€” è¯¥æ•°æ®é›†ç”±
    R.A. Fisher åˆ›å»ºï¼Œå¹¶åœ¨ [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/legalcode)
    è®¸å¯è¯ä¸‹æä¾›ã€‚
- en: Letâ€™s import the dataset into pandas DataFrame â€” `**df**`
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å°†æ•°æ®é›†å¯¼å…¥ pandas DataFrame â€” `**df**`
- en: '[PRE0]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/79e8cd00ebbadae913c4c7509e98407c.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/79e8cd00ebbadae913c4c7509e98407c.png)'
- en: Iris dataset | Image by Author
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Iris æ•°æ®é›† | ä½œè€…å›¾ç‰‡
- en: It is a simple 150 x 5 dataset containing the information of 3 classes of the
    Iris plant.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ 150 x 5 æ•°æ®é›†ï¼ŒåŒ…å« 3 ç§ Iris æ¤ç‰©çš„ç›¸å…³ä¿¡æ¯ã€‚
- en: Letâ€™s start with the first use-case, assuming that you already explored [***how
    to use***](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94) `[***groupby***](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94)`
    in my previous article as mentioned above.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å…ˆä»ç¬¬ä¸€ä¸ªç”¨ä¾‹å¼€å§‹ï¼Œå‡è®¾ä½ å·²ç»æ¢ç´¢äº†[***å¦‚ä½•ä½¿ç”¨***](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94)
    `[***groupby***](/5-pandas-group-by-tricks-you-should-know-in-python-f53246c92c94)`ï¼Œå¦‚ä¸Šæ–‡æ‰€è¿°ã€‚
- en: Applying different functions to different columns
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¯¹ä¸åŒåˆ—åº”ç”¨ä¸åŒå‡½æ•°
- en: In Pandas `groupby`, you can group all the rows of the dataset by categorical/non-numerical
    column and apply a function to aggregate the other desired numerical columns.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Pandas `groupby` ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡åˆ†ç±»/éæ•°å€¼åˆ—å¯¹æ•°æ®é›†ä¸­çš„æ‰€æœ‰è¡Œè¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¯¹å…¶ä»–æ‰€éœ€çš„æ•°å€¼åˆ—åº”ç”¨å‡½æ•°ä»¥è¿›è¡Œèšåˆã€‚
- en: For example, suppose you would like to get the sepal length for each class of
    the Iris plant. You can simply pass the column *class* in `groupby` and use `sum()`
    function on the column *sepal_length*, as shown below.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³è·å–æ¯ä¸ª Iris æ¤ç‰©ç±»åˆ«çš„èŠ±è¼é•¿åº¦ã€‚ä½ å¯ä»¥ç®€å•åœ°åœ¨`groupby`ä¸­ä¼ é€’åˆ—*class*ï¼Œå¹¶å¯¹åˆ—*sepal_length*ä½¿ç”¨`sum()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/2471355f94eb96b80b0c29106416f90b.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2471355f94eb96b80b0c29106416f90b.png)'
- en: Simple pandas groupby | Image by Author
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: ç®€å•çš„ pandas groupby | ä½œè€…å›¾ç‰‡
- en: It is quite straightforward.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™éå¸¸ç®€å•ã€‚
- en: But what if you would like to get a total sepal length and average sepal width
    for each class?
  id: totrans-30
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½†æ˜¯å¦‚æœä½ æƒ³è·å–æ¯ä¸ªç±»åˆ«çš„æ€»èŠ±è¼é•¿åº¦å’Œå¹³å‡èŠ±è¼å®½åº¦å‘¢ï¼Ÿ
- en: Thatâ€™s where the `**agg()**` function jumps in, which is used to apply aggregate
    functions on pandas DataFrame `groupby` object obtained by using `pandas.DataFrame.groupby`.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ—¶ï¼Œ`**agg()**`å‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå®ƒç”¨äºå¯¹é€šè¿‡ä½¿ç”¨`pandas.DataFrame.groupby`è·å¾—çš„ pandas DataFrame
    `groupby` å¯¹è±¡åº”ç”¨èšåˆå‡½æ•°ã€‚
- en: Certainly, you donâ€™t need to use `groupby()` multiple times, rather you can
    create a single groupby object and pass the column and its aggregate function
    as key-value pair in the `agg()` function.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œä½ ä¸éœ€è¦å¤šæ¬¡ä½¿ç”¨`groupby()`ï¼Œè€Œæ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ groupby å¯¹è±¡ï¼Œå°†åˆ—åŠå…¶èšåˆå‡½æ•°ä½œä¸ºé”®å€¼å¯¹ä¼ é€’ç»™`agg()`å‡½æ•°ã€‚
- en: Letâ€™s see how to do it.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç°ã€‚
- en: Here two columns on which you want to apply aggregate functions are â€” *sepal_length*
    and *sepal_width*â€”and the actual aggregate functions you want to apply on these
    columns are, `sum` and `mean`
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œä½ æƒ³å¯¹å…¶åº”ç”¨èšåˆå‡½æ•°çš„ä¸¤åˆ—æ˜¯ â€” *sepal_length* å’Œ *sepal_width* â€” å®é™…ä¸Šä½ è¦å¯¹è¿™äº›åˆ—åº”ç”¨çš„èšåˆå‡½æ•°æ˜¯ `sum`
    å’Œ `mean`
- en: Therefore, the key-value pair, i.e. the dictionary, will look like
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œé”®å€¼å¯¹ï¼Œå³å­—å…¸ï¼Œå°†å¦‚ä¸‹æ‰€ç¤º
- en: '[PRE2]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Whereas the `groupby` object will be created as:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: è€Œ `groupby` å¯¹è±¡å°†è¢«åˆ›å»ºä¸ºï¼š
- en: '[PRE3]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: And then you can apply function `agg()` on this groupby object as below,
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åä½ å¯ä»¥å¯¹è¿™ä¸ª groupby å¯¹è±¡åº”ç”¨`agg()`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ
- en: '[PRE4]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: To get an output like â€”
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä»¥ä¸‹è¾“å‡ºä¸ºä¾‹ â€”
- en: '![](../Images/ef725afff98ed58ce4cf568d5a87a8b4.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ef725afff98ed58ce4cf568d5a87a8b4.png)'
- en: Apply multiple function on different columns | Image by Author
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹ä¸åŒåˆ—åº”ç”¨å¤šä¸ªå‡½æ•° | ä½œè€…å›¾ç‰‡
- en: Well, you donâ€™t need to split the code into 3 distinct lines, which I did just
    to simplify the things.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½å§ï¼Œä½ ä¸éœ€è¦å°†ä»£ç æ‹†åˆ†æˆ 3 è¡Œï¼Œæˆ‘è¿™æ ·åšåªæ˜¯ä¸ºäº†ç®€åŒ–é—®é¢˜ã€‚
- en: Youâ€™ll get exactly the same output by clubbing everything in the single line
    of code as below.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡å°†æ‰€æœ‰å†…å®¹åˆå¹¶åˆ°ä»¥ä¸‹å•è¡Œä»£ç ä¸­ï¼Œä½ å°†å¾—åˆ°å®Œå…¨ç›¸åŒçš„è¾“å‡ºã€‚
- en: '[PRE5]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Extending the same logic, you can apply multiple functions on the same column,
    but in slightly different way.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰©å±•ç›¸åŒçš„é€»è¾‘ï¼Œä½ å¯ä»¥åœ¨åŒä¸€åˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•°ï¼Œä½†æ–¹å¼ç•¥æœ‰ä¸åŒã€‚
- en: Applying multiple functions to the same column
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¯¹åŒä¸€åˆ—åº”ç”¨å¤šä¸ªå‡½æ•°
- en: Often, you need to find out multiple statistics for the same column separated
    by a category, such as computing the minimum and maximum values. To do this, you
    can pass a **list of functions** to the `agg()` method.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸ï¼Œä½ éœ€è¦ä¸ºåŒä¸€åˆ—åœ¨ç±»åˆ«é—´æ‰¾åˆ°å¤šä¸ªç»Ÿè®¡æ•°æ®ï¼Œä¾‹å¦‚è®¡ç®—æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥å°†**å‡½æ•°åˆ—è¡¨**ä¼ é€’ç»™`agg()`æ–¹æ³•ã€‚
- en: For an instance, suppose you would like to get minimum, maximum, and median
    values of sepal length for each class of the Iris plant.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æƒ³è·å–æ¯ä¸ª Iris æ¤ç‰©ç±»åˆ«çš„èŠ±è¼é•¿åº¦çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œä¸­ä½æ•°ã€‚
- en: The actual aggregate functions you want to apply on this column are `min`, `max`
    and `median`, which you must pass as a list as shown below.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ è¦å¯¹è¿™åˆ—åº”ç”¨çš„å®é™…èšåˆå‡½æ•°æ˜¯ `min`ã€`max` å’Œ `median`ï¼Œè¿™äº›å¿…é¡»ä½œä¸ºåˆ—è¡¨ä¼ é€’ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE6]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/1436e641416c4fa702cb84eb6c3e4fe6.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1436e641416c4fa702cb84eb6c3e4fe6.png)'
- en: Apply multiple functions on same column | Image by Author
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨åŒä¸€åˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…
- en: Following the same way, you can apply multiple functions on multiple columns
    at the same time.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‰ç…§ç›¸åŒçš„æ–¹æ³•ï¼Œä½ å¯ä»¥åŒæ—¶åœ¨å¤šä¸ªåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•°ã€‚
- en: For example, in addition to above calculations, you can also get the same metrics
    for sepal width.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œé™¤äº†ä¸Šè¿°è®¡ç®—ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥è·å¾— sepal width çš„ç›¸åŒåº¦é‡ã€‚
- en: As this is a multiple column scenario, you should switch back to **key-value
    pair for column name and function name** as you did in the previous method. However,
    instead of single function name, this time you will pass the list of function
    names as shown below.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè¿™æ˜¯ä¸€ä¸ªå¤šåˆ—åœºæ™¯ï¼Œä½ åº”è¯¥åƒåœ¨å‰ä¸€ä¸ªæ–¹æ³•ä¸­é‚£æ ·åˆ‡æ¢å›**åˆ—åå’Œå‡½æ•°åçš„é”®å€¼å¯¹**ã€‚ç„¶è€Œï¼Œè¿™æ¬¡ä½ å°†ä¼ é€’å‡½æ•°åçš„åˆ—è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE7]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/209525957ca952409784147a152b788b.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/209525957ca952409784147a152b788b.png)'
- en: Apply multiple functions on multiple columns | Image by Author
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¤šåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…
- en: As a result, youâ€™ll get an easy to understand DataFrame.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªæ˜“äºç†è§£çš„ DataFrameã€‚
- en: However, it still has two rows as column heading and you can get rid of them
    by simply renaming the aggregated columns.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œå®ƒä»ç„¶æœ‰ä¸¤è¡Œä½œä¸ºåˆ—æ ‡é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡ç®€å•åœ°é‡å‘½åèšåˆåˆ—æ¥å»æ‰å®ƒä»¬ã€‚
- en: Customize aggregation column names
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è‡ªå®šä¹‰èšåˆåˆ—åç§°
- en: You can use the names of your choice for the column aggregations so that you
    can easily identify the returned column aggregations and get rid of 2nd row in
    the column headings.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥ä¸ºåˆ—èšåˆä½¿ç”¨ä½ é€‰æ‹©çš„åç§°ï¼Œä»¥ä¾¿è½»æ¾è¯†åˆ«è¿”å›çš„åˆ—èšåˆï¼Œå¹¶å»æ‰åˆ—æ ‡é¢˜ä¸­çš„ç¬¬äºŒè¡Œã€‚
- en: All you need to do is make a **tuple of column name and aggregate function**
    and assign this tuple to a column name.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦åšçš„å°±æ˜¯åˆ›å»º**åˆ—åå’Œèšåˆå‡½æ•°çš„å…ƒç»„**ï¼Œå¹¶å°†è¿™ä¸ªå…ƒç»„åˆ†é…ç»™åˆ—åã€‚
- en: Continuing the above example, you want to apply function `â€˜minâ€™` on the column
    *sepal_length*, so the tuple will be `(â€˜sepal_lengthâ€™, â€˜minâ€™)` and you will assign
    this tuple to the column named *min_sepal_length* as shown below.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç»§ç»­ä¸Šè¿°ç¤ºä¾‹ï¼Œä½ å¸Œæœ›åœ¨åˆ— *sepal_length* ä¸Šåº”ç”¨å‡½æ•° `â€˜minâ€™`ï¼Œå› æ­¤å…ƒç»„å°†æ˜¯ `(â€˜sepal_lengthâ€™, â€˜minâ€™)`ï¼Œä½ å°†æŠŠè¿™ä¸ªå…ƒç»„åˆ†é…ç»™åä¸º
    *min_sepal_length* çš„åˆ—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE8]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Similarly, you can create tuples for all the column aggregations and assign
    them to a custom name.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: åŒæ ·ï¼Œä½ å¯ä»¥ä¸ºæ‰€æœ‰åˆ—èšåˆåˆ›å»ºå…ƒç»„ï¼Œå¹¶å°†å®ƒä»¬åˆ†é…ç»™è‡ªå®šä¹‰åç§°ã€‚
- en: '[PRE9]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: And finally pass them in the `agg()` function separated by comma as shown below.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œå°†å®ƒä»¬ç”¨é€—å·åˆ†éš”ä¼ é€’ç»™ `agg()` å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE10]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/6101aa4b62c7f84beae6c7b9559e61df.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6101aa4b62c7f84beae6c7b9559e61df.png)'
- en: Naming returned columns in Pandas aggregate function | Image by Author
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Pandas èšåˆå‡½æ•°ä¸­å‘½åè¿”å›çš„åˆ— | å›¾ç‰‡æ¥æºï¼šä½œè€…
- en: Quick it is!
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: å¿«é€Ÿè§£å†³ï¼
- en: Now, this looks much simplified and easy-to-read output.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè¿™çœ‹èµ·æ¥ç®€åŒ–äº†å¾ˆå¤šï¼Œæ˜“äºé˜…è¯»ã€‚
- en: So far, you applied only the standard or built-in functions on one or more columns.
    However, sometimes you need to apply an user-defined function and using aggregate
    function you can easily do that.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ ä»…åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ä¸Šåº”ç”¨äº†æ ‡å‡†æˆ–å†…ç½®å‡½æ•°ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ä½ éœ€è¦åº”ç”¨ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œä½¿ç”¨èšåˆå‡½æ•°ä½ å¯ä»¥è½»æ¾åšåˆ°è¿™ä¸€ç‚¹ã€‚
- en: Applying custom or user-defined functions
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åº”ç”¨è‡ªå®šä¹‰æˆ–ç”¨æˆ·å®šä¹‰çš„å‡½æ•°
- en: Often the built-in aggregation functions in pandas are not sufficient for your
    needs and you define your own custom functions for your analysis.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸ï¼Œpandas ä¸­å†…ç½®çš„èšåˆå‡½æ•°ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ éœ€è¦ä¸ºåˆ†æå®šä¹‰è‡ªå·±çš„è‡ªå®šä¹‰å‡½æ•°ã€‚
- en: Now, you can apply these user-defined or custom function to grouped data using
    the `agg` method.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ `agg` æ–¹æ³•å°†è¿™äº›ç”¨æˆ·å®šä¹‰æˆ–è‡ªå®šä¹‰å‡½æ•°åº”ç”¨äºåˆ†ç»„æ•°æ®ã€‚
- en: For example, suppose you defined a custom function to compute the range of a
    column as follows.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå‡è®¾ä½ å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°æ¥è®¡ç®—åˆ—çš„èŒƒå›´ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE11]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: And now you would like to get the range for sepal length, sepal width, petal
    length and petal width of the Iris plant separated by its class.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä½ å¸Œæœ›è®¡ç®—é¸¢å°¾èŠ±çš„ sepal lengthã€sepal widthã€petal length å’Œ petal width çš„èŒƒå›´ï¼Œå¹¶æŒ‰å…¶ç±»åˆ«è¿›è¡ŒåŒºåˆ†ã€‚
- en: Again this is multiple columns scenario, so you must use a **key-value pairs**
    where **key is the column name** and **value is the name of the user-defined function**
    as shown below.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å†æ¬¡è¿™æ˜¯å¤šåˆ—åœºæ™¯ï¼Œå› æ­¤ä½ å¿…é¡»ä½¿ç”¨**é”®å€¼å¯¹**ï¼Œå…¶ä¸­**é”®æ˜¯åˆ—å**ï¼Œ**å€¼æ˜¯ç”¨æˆ·å®šä¹‰å‡½æ•°çš„åç§°**ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE12]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: This will quickly give you an output as â€”
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†å¿«é€Ÿç»™å‡ºå¦‚ä¸‹è¾“å‡º â€”
- en: '![](../Images/5750d9dee5d36f4b104128ea6a99120a.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5750d9dee5d36f4b104128ea6a99120a.png)'
- en: Apply user defined function on multiple columns | Image by Author
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¤šåˆ—ä¸Šåº”ç”¨ç”¨æˆ·å®šä¹‰çš„å‡½æ•° | å›¾ç‰‡æ¥æºï¼šä½œè€…
- en: However, it will be difficult for viewer of the above DataFrame to understand
    which type of aggregate function is used to get these numbers.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œå¯¹äºä¸Šè¿° DataFrame çš„æŸ¥çœ‹è€…æ¥è¯´ï¼Œç†è§£è¿™äº›æ•°å­—ä½¿ç”¨äº†å“ªç§èšåˆå‡½æ•°å°†ä¼šæ¯”è¾ƒå›°éš¾ã€‚
- en: Therefore, adding more context make sense here, which can be achieved by adding
    maximum and minimum values for each column.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæ·»åŠ æ›´å¤šä¸Šä¸‹æ–‡æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ æ¯åˆ—çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ¥å®ç°ã€‚
- en: Interestingly, you can also combine user-defined functions with built-in functions
    and apply them to multiple columns in the `agg()` function.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰è¶£çš„æ˜¯ï¼Œä½ è¿˜å¯ä»¥å°†è‡ªå®šä¹‰å‡½æ•°ä¸å†…ç½®å‡½æ•°ç»“åˆä½¿ç”¨ï¼Œå¹¶å°†å®ƒä»¬åº”ç”¨äº`agg()`å‡½æ•°ä¸­çš„å¤šä¸ªåˆ—ã€‚
- en: Letâ€™s take another example.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚
- en: Suppose, you would like to compute minimum, maximum and above user-defined function
    for all the numerical columns in the dataset.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾ä½ æƒ³è®¡ç®—æ•°æ®é›†ä¸­æ‰€æœ‰æ•°å€¼åˆ—çš„æœ€å°å€¼ã€æœ€å¤§å€¼å’Œè‡ªå®šä¹‰å‡½æ•°ã€‚
- en: And now this is **multiple columns â€” multiple functions** scenario which means
    youâ€™ll still use key-value pairs but pass list of functions as a value, as shown
    below.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è¿™æ˜¯**å¤šåˆ—â€”â€”å¤šå‡½æ•°**çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€ä½ ä»ç„¶ä¼šä½¿ç”¨é”®å€¼å¯¹ï¼Œä½†å°†å‡½æ•°åˆ—è¡¨ä½œä¸ºå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
- en: '[PRE13]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: To get an quick output as â€”
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥å¿«é€Ÿè¾“å‡ºä¸ºä¾‹ â€”
- en: '![](../Images/52aa6edd63f961511e83f4b3760b8c89.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/52aa6edd63f961511e83f4b3760b8c89.png)'
- en: Apply multiple functions on multiple columns | Image by Author
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¤šä¸ªåˆ—ä¸Šåº”ç”¨å¤šä¸ªå‡½æ•° | ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Interesting, right?
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰è¶£ï¼Œå¯¹å§ï¼Ÿ
- en: But it is still difficult to say whatâ€™s there in the function `my_range` and
    what type of computation happens in this function.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†ä»ç„¶å¾ˆéš¾è¯´`my_range`å‡½æ•°çš„å†…å®¹ä»¥åŠåœ¨è¯¥å‡½æ•°ä¸­å‘ç”Ÿäº†ä»€ä¹ˆè®¡ç®—ã€‚
- en: It makes more sense to give a meaningful name to this function and then use
    the function again for aggregation.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™è¿™ä¸ªå‡½æ•°ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°ï¼Œç„¶åå†æ¬¡ä½¿ç”¨è¯¥å‡½æ•°è¿›è¡Œèšåˆæ›´ä¸ºåˆç†ã€‚
- en: You can easily assign a name for the function using below code.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç è½»æ¾ä¸ºå‡½æ•°æŒ‡å®šåç§°ã€‚
- en: '[PRE14]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: And then re-apply the function `my_range` on all the required columns as,
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶ååœ¨æ‰€æœ‰éœ€è¦çš„åˆ—ä¸Šé‡æ–°åº”ç”¨`my_range`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ
- en: '[PRE15]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](../Images/465cc4daff2866fa3bd47bff2fcdea45.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/465cc4daff2866fa3bd47bff2fcdea45.png)'
- en: pandas groupby agg custom function multiple columns | Image by Author
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: pandas groupby agg è‡ªå®šä¹‰å‡½æ•° å¤šåˆ— | ä½œè€…æä¾›çš„å›¾ç‰‡
- en: Now, this output looks much more useful as it tells you exactly what type of
    calculations were performed on each column.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè¿™ä¸ªè¾“å‡ºçœ‹èµ·æ¥æ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå‡†ç¡®åœ°å‘Šè¯‰ä½ å¯¹æ¯åˆ—è¿›è¡Œäº†ä»€ä¹ˆç±»å‹çš„è®¡ç®—ã€‚
- en: Thatâ€™s all about data aggregation using pandas `groupby`! ğŸ†
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯å…³äºä½¿ç”¨pandas `groupby`çš„æ•°æ®èšåˆï¼ ğŸ†
- en: I hope you found this article useful and saved it as a **one-stop-solution**
    for pandas `.groupby()` use cases.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¸Œæœ›ä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸ºpandas `.groupby()`ç”¨ä¾‹çš„**ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ**ã€‚
- en: Knowing these flexibility features about data aggregation using pandas `.groupby()`
    can certainly boost your productivity. It also helps you to aggregate and represent
    the data in better and easy-to-understand way.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: äº†è§£å…³äºä½¿ç”¨pandas `.groupby()`çš„æ•°æ®èšåˆçš„è¿™äº›çµæ´»ç‰¹æ€§æ— ç–‘å¯ä»¥æå‡ä½ çš„ç”Ÿäº§åŠ›ã€‚å®ƒè¿˜å¸®åŠ©ä½ ä»¥æ›´å¥½å’Œæ˜“äºç†è§£çš„æ–¹å¼æ±‡æ€»å’Œè¡¨ç¤ºæ•°æ®ã€‚
- en: '*Interested in reading more stories on Medium??*'
  id: totrans-111
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*å¯¹é˜…è¯»æ›´å¤šMediumä¸Šçš„æ•…äº‹æ„Ÿå…´è¶£å—ï¼Ÿ*'
- en: ğŸ’¡ Consider [**Becoming a Medium Member**](https://medium.com/@17.rsuraj/membership)
    to **access unlimited** stories on medium and daily interesting Medium digest.
    I will get a small portion of your fee and No additional cost to you.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ è€ƒè™‘ [**æˆä¸ºMediumä¼šå‘˜**](https://medium.com/@17.rsuraj/membership) ä»¥**æ— é™è®¿é—®**Mediumä¸Šçš„æ•…äº‹å’Œæ¯æ—¥æœ‰è¶£çš„Mediumæ‘˜è¦ã€‚æˆ‘å°†ä»ä½ çš„è´¹ç”¨ä¸­è·å¾—ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”ä½ æ— éœ€é¢å¤–ä»˜è´¹ã€‚
- en: ğŸ’¡ Be sure to [**Sign-up to my Email list**](https://medium.com/subscribe/@17.rsuraj)
    to never miss another article on data science guides, tricks and tips, SQL and
    Python.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ ç¡®ä¿ [**æ³¨å†Œæˆ‘çš„é‚®ä»¶åˆ—è¡¨**](https://medium.com/subscribe/@17.rsuraj) ä»¥å…é”™è¿‡æœ‰å…³æ•°æ®ç§‘å­¦æŒ‡å—ã€æŠ€å·§å’Œçªé—¨ã€SQLå’ŒPythonçš„å…¶ä»–æ–‡ç« ã€‚
- en: ğŸ’¡ Here is a complete [**Notebook**](https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/4_Use_cases_Pandas_Group_By.ipynb)
    with all the examples.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ [**Notebook**](https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/4_Use_cases_Pandas_Group_By.ipynb)
    åŒ…å«æ‰€æœ‰ç¤ºä¾‹ã€‚
- en: '**Thank you for reading!**'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ„Ÿè°¢é˜…è¯»ï¼**'

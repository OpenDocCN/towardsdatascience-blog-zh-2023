["```py\nSELECT\n  user_pseudo_id AS user_id,\n  ecommerce.transaction_id AS order_id,\n  PARSE_DATE('%Y%m%d', event_date) AS order_date\nFROM\n  `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`\nWHERE\n  event_name = 'purchase'\n  AND ecommerce.transaction_id <> '(not set)'\nGROUP BY\n  1,\n  2,\n  3\n```", "```py\nSELECT\n  *,\n  CASE\n    WHEN DENSE_RANK() OVER(PARTITION BY user_id ORDER BY order_date) = 1 \n    THEN 'new' ELSE 'returning'\nEND\n  AS customer_type\nFROM\n  `datastic.new_existing.base_table`\n```", "```py\nSELECT\n  user_id,\n  DATE_TRUNC(order_date,MONTH) AS month,\n  STRING_AGG(DISTINCT customer_type\n  ORDER BY\n    customer_type ASC) AS customer_type\nFROM\n  customer_table\nWHERE\n  order_date < '2021-01-01'\nGROUP BY\n  1,\n  2\n```", "```py\nWITH\n  customer_month AS (\n  SELECT\n    user_id,\n    DATE_TRUNC(order_date,MONTH) AS month,\n    STRING_AGG(DISTINCT customer_type\n    ORDER BY\n      customer_type ASC) AS customer_type\n  FROM\n    customer_table\n  WHERE\n    order_date < '2021-01-01'\n  GROUP BY\n    1,\n    2)\n\n  -- Main Query\nSELECT\n  *,\n  CASE\n    WHEN customer_type LIKE 'new,returning' THEN 'both'\n  ELSE\n  customer_type\nEND\n  AS c_type\nFROM\n  customer_month\n```"]
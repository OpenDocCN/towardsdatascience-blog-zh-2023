- en: How I Built a Custom GPT-Based Chatbot in Under 10 Minutes with LlamaIndex
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/how-i-built-a-custom-gpt-based-chatbot-in-under-10-minutes-with-llamaindex-2102f0173420](https://towardsdatascience.com/how-i-built-a-custom-gpt-based-chatbot-in-under-10-minutes-with-llamaindex-2102f0173420)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Overview and Implementation with Python
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@aashishnair?source=post_page-----2102f0173420--------------------------------)[![Aashish
    Nair](../Images/23f4b3839e464419332b690a4098d824.png)](https://medium.com/@aashishnair?source=post_page-----2102f0173420--------------------------------)[](https://towardsdatascience.com/?source=post_page-----2102f0173420--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----2102f0173420--------------------------------)
    [Aashish Nair](https://medium.com/@aashishnair?source=post_page-----2102f0173420--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----2102f0173420--------------------------------)
    ·6 min read·Apr 12, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1ae789d4b6cc2e0d3b71df8d0b8fd123.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Photo by Miguel Á. Padriñán: [https://www.pexels.com/photo/two-white-message-balloons-1111368/](https://www.pexels.com/photo/two-white-message-balloons-1111368/)'
  prefs: []
  type: TYPE_NORMAL
- en: Not long ago, I read an article from Jerry Liu that introduced LlamaIndex, an
    interface that utilizes GPT to synthesize responses to queries using the information
    provided by the user.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://medium.com/@jerryjliu98/how-unstructured-and-llamaindex-can-help-bring-the-power-of-llms-to-your-own-data-3657d063e30d?source=post_page-----2102f0173420--------------------------------)
    [## How Unstructured and LlamaIndex can help bring the power of LLM’s to your
    own data'
  prefs: []
  type: TYPE_NORMAL
- en: (co-authored by Jerry Liu, creator of LlamaIndex, and Brian Raymond, CEO of
    Unstructured)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: medium.com](https://medium.com/@jerryjliu98/how-unstructured-and-llamaindex-can-help-bring-the-power-of-llms-to-your-own-data-3657d063e30d?source=post_page-----2102f0173420--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: It immediately got my attention, and I knew I had to try it out for myself.
  prefs: []
  type: TYPE_NORMAL
- en: After all, many of the large language models (LLMs) that have taken the world
    by storm have limited use cases since they aren’t trained with the data available
    to their users.
  prefs: []
  type: TYPE_NORMAL
- en: Thus, there is still a demand for customizable LLMs that are tailored to the
    needs of their users. Simply put, businesses need LLMs that perform tasks like
    text summarization, question and answering (Q&A), and text generation with their
    own information.
  prefs: []
  type: TYPE_NORMAL
- en: To see if LlamaIndex has the potential to meet this demand, I’ve played around
    with its features and was genuinely surprised at what I was able to do. I even
    ended up building a Q&A chatbot in just around 10 minutes!
  prefs: []
  type: TYPE_NORMAL
- en: Here, I walk you through my journey.
  prefs: []
  type: TYPE_NORMAL
- en: What Does LlamaIndex Do?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: LlamaIndex generates responses to queries by connecting LLMs to the information
    provided by users.
  prefs: []
  type: TYPE_NORMAL
- en: 'As detailed in [the documentation](https://gpt-index.readthedocs.io/en/latest/guides/primer/usage_pattern.html),
    the usage of LlamaIndex entails the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Load in the documents
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Parse the documents into nodes (optional)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Construct the index
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Build Indices on top of the constructed indices (optional)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Query the index
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Essentially, LlamaIndex loads your data into a document object and then converts
    it into an index. When the index is provided a query, it passes the query to a
    GPT prompt to synthesize a response. By default, this is done with OpenAI’s `text-davinci-003`
    model.
  prefs: []
  type: TYPE_NORMAL
- en: While this process sounds pretty convoluted, it can be executed with very little
    code, as you are about to find out.
  prefs: []
  type: TYPE_NORMAL
- en: Setup
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To test the versatility of LlamaIndex, I ended up building 3 different chatbots,
    with each bot being constructed with a different data source. For the sake of
    brevity, the previously mentioned optional steps (i.e., steps 2 and 4) will be
    omitted.
  prefs: []
  type: TYPE_NORMAL
- en: First, let’s take care of the prerequisites.
  prefs: []
  type: TYPE_NORMAL
- en: 'LlamaIndex and OpenAI can be installed from pip using the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Users will also need an API key from OpenAI:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The project will also need the following imports:'
  prefs: []
  type: TYPE_NORMAL
- en: Loading the data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Data can be loaded either manually or through a data loader. For this case,
    I have loaded 3 types of data:'
  prefs: []
  type: TYPE_NORMAL
- en: a local .txt file in which I write about my favorite fruits (accessible in the
    [GitHub repository](https://github.com/anair123/Creating-A-Custom-GPT-Based-Chatbot-With-LlamaIndex))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a [Wikipedia page on apples](https://en.wikipedia.org/wiki/Apple)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a [YouTube video showing a recipe for a vanilla cake](https://www.youtube.com/watch?v=EYXQmbZNhy8)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The first index will be created with the local .txt file, which is located in
    a folder named `data`. This data will be loaded manually.
  prefs: []
  type: TYPE_NORMAL
- en: The second index will be created using data from the Wikipedia page on apples.
    It can be loaded with one of LlamaIndex’s data loaders.
  prefs: []
  type: TYPE_NORMAL
- en: The third index will be constructed with the YouTube video showing how to bake
    a vanilla cake. This data will also be loaded with a data loader.
  prefs: []
  type: TYPE_NORMAL
- en: Construct the Indices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With all the data loaded into document objects, we can construct the index for
    each chatbot.
  prefs: []
  type: TYPE_NORMAL
- en: Each index can be constructed from the document object with a one-liner.
  prefs: []
  type: TYPE_NORMAL
- en: Surprised? From loading the data to creating the index, the usage of LlamaIndex
    requires just a few lines of code!
  prefs: []
  type: TYPE_NORMAL
- en: Query the Index
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The constructed indices can now generate responses for any given query. Once
    again, this step can be completed with a one-liner.
  prefs: []
  type: TYPE_NORMAL
- en: '**Querying the index build with the .txt file**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](../Images/b9aec3f5b43cd6e2602026412bf1c93b.png)'
  prefs: []
  type: TYPE_IMG
- en: Code Output (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: In case you were wondering, this is the right answer.
  prefs: []
  type: TYPE_NORMAL
- en: '**2\. Querying the index built with the Wikipedia page (topic: apples)**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c79e0a389fbefd562be76d1df02fe7e.png)'
  prefs: []
  type: TYPE_IMG
- en: Code Output (Creating By Author)
  prefs: []
  type: TYPE_NORMAL
- en: '**3\. Querying the index build with the YouTube video (topic: vanilla cake
    recipe)**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/31d4364682152a02c7cc5146a3d3b6c8.png)'
  prefs: []
  type: TYPE_IMG
- en: Code Output (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: Finally, it’s also worth noting that the indices will only provide answers to
    queries when they contain the needed context.
  prefs: []
  type: TYPE_NORMAL
- en: Here’s how the same index created with the YouTube video’s data would respond
    to a completely irrelevant query.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b1f8e568abcffff112491b39387d811b.png)'
  prefs: []
  type: TYPE_IMG
- en: Code Output (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: Thankfully, it seems that LlamaIndex has taken measures against hallucination
    (i.e when a model confidently gives an answer not justified by the given data).
  prefs: []
  type: TYPE_NORMAL
- en: Deploying the Chatbots with a Web App
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Finally, we can create a web app in order to share the constructed indices with
    end users.
  prefs: []
  type: TYPE_NORMAL
- en: To do so, we need to first save the indices using the `save_to_disk` method.
  prefs: []
  type: TYPE_NORMAL
- en: 'These indices will be used in a Streamlit app. The underlying code for the
    entire app is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: In the app, users can select the data source that they wish to base their questions
    on and write their query in the provided box.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can see how the indices perform after running the app:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Querying the index built with the .txt file (my favorite fruits):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b53cafcf295ec1349aa5c732b523f78b.png)'
  prefs: []
  type: TYPE_IMG
- en: Streamlit App (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Querying the index built with the Wikipedia page (apples):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d51be9f3f497e4558712958fd44aebf2.png)'
  prefs: []
  type: TYPE_IMG
- en: Streamlit App (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: 'Querying the index built with the Youtube video (vanilla cake recipe):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/858391c3c5d591dfa7ee2893c1f489d2.png)'
  prefs: []
  type: TYPE_IMG
- en: Streamlit App (Created By Author)
  prefs: []
  type: TYPE_NORMAL
- en: Pretty cool, right? We’ve built a functioning web app in just 10 minutes!
  prefs: []
  type: TYPE_NORMAL
- en: Final Remarks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/e955c0ba062ac53f3af4c5eef0332371.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Prateek Katyal](https://unsplash.com/@prateekkatyal?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: So far, I have only implemented the basic functionalities of the LlamaIndex
    interface. There are many areas that haven’t been explored in this project, such
    as customizing LLMs and using non-default settings.
  prefs: []
  type: TYPE_NORMAL
- en: For more information, I invite you to visit [the documentation](https://gpt-index.readthedocs.io/en/latest/index.html).
  prefs: []
  type: TYPE_NORMAL
- en: If you plan on experimenting with this tool yourself, do be wary of the costs
    that are incurred from the use of OpenAI’s API. This project cost me a mere $1,
    but that can be attributed to my working with small documents (the pricing is
    based on the number of tokens you use). If you get too carried away, you may end
    up picking up a nasty bill.
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, all of the source code used to create the Q&A chatbots can be accessed
    in this Github repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/anair123/Creating-A-Custom-GPT-Based-Chatbot-With-LlamaIndex?source=post_page-----2102f0173420--------------------------------)
    [## GitHub - anair12GitHubting-A-Custom-GPT-Based-Chatbot-With-LlamaIndex'
  prefs: []
  type: TYPE_NORMAL
- en: You can't perform that action at this time. You signed in with another tab or
    window. You signed out in another tab or…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/anair123/Creating-A-Custom-GPT-Based-Chatbot-With-LlamaIndex?source=post_page-----2102f0173420--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Thank you for reading!
  prefs: []
  type: TYPE_NORMAL

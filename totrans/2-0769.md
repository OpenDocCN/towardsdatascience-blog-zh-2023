# 在 Power BI 中使用字段参数进行动态过滤

> 原文：[https://towardsdatascience.com/dynamic-filtering-with-field-parameters-in-power-bi-520a472127d5](https://towardsdatascience.com/dynamic-filtering-with-field-parameters-in-power-bi-520a472127d5)

## 字段参数太棒了！了解如何使用这一功能进行数据建模，并让用户能够完全自由地选择数据的显示方式！

[](https://datamozart.medium.com/?source=post_page-----520a472127d5--------------------------------)[![尼古拉·伊利奇](../Images/9fab894b9696c0dfd80c5173188b720b.png)](https://datamozart.medium.com/?source=post_page-----520a472127d5--------------------------------)[](https://towardsdatascience.com/?source=post_page-----520a472127d5--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----520a472127d5--------------------------------) [尼古拉·伊利奇](https://datamozart.medium.com/?source=post_page-----520a472127d5--------------------------------)

·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----520a472127d5--------------------------------) ·阅读时长 5 分钟·2023年4月12日

--

![](../Images/cb7756fcbed7245635b7612d01bfe4ae.png)

图片由作者提供

如果你定期关注我的文章，你可能已经注意到我对字段参数非常热衷。这个功能在 2022 年 5 月推出，显著减少了处理一些常见业务场景时的复杂性和开发工作量。

我已经写过如何利用 [字段参数让你的 Power BI 报告更生动](https://data-mozart.com/bring-life-to-field-parameters-in-power-bi/)。然而，这不仅仅是关于数据可视化，因为这个功能也可以非常优雅地解决一些数据建模挑战。

在我展示一个我最近实现的极其实用的字段参数用例之前，让我们首先解释一下什么是字段参数，以及一旦你开始使用这个功能，幕后发生了什么。

简而言之，字段参数使你能够执行两个操作：

***1\. 动态更改用于切片和切块数据的属性*** —— 意思是动态切换不同的列

***2\. 动态更改可视化中显示的指标*** —— 意思是动态切换不同的度量值

我听见了，我听见了……尼古拉，我们以前也可以在没有字段参数的情况下做到这一点……是的，没错，但是 [与 TREATAS 复杂性相比](https://data-mozart.com/daxis-dynamic-axis-in-power-bi/)，或者编写 [复杂冗长的 DAX SWITCH 语句](https://data-mozart.com/dynamic-filtering-in-power-bi/)，你现在只需点击几下而无需编写一行 DAX 代码就能完成所有设置！

# 探索内部机制

让我们快速看看字段参数创建的内部机制。

一旦你在字段参数窗口中拖动列和/或度量值，Power BI 将自动在你的数据模型中创建一个新表。你也可以选择自动创建一个包含字段参数值的切片器，并将其放置在报告页面上。

![](../Images/872e54eef611b777aee0126064acd35e.png)

作者提供的图片

这个表格由三列内置列组成——一列对最终用户可见，而另外两列默认隐藏。

![](../Images/6ee15b99618c58fe677d98106c7b3553.png)

作者提供的图片

第一列，即将显示在切片器中的列名称，是对消费者暴露的标签。你可以在之后更改列的名称，而无需更改后台的整个逻辑。

这是可能的，因为表格中的第二列称为 Fields。这个列利用了 NAMEOF DAX 函数。NAMEOF 函数返回模型对象的完全限定名称。为什么这很重要？假设你想将列名从 Brand 更改为 Brand name…你可以做到这一点，而不会违反字段参数结构，因为 NAMEOF 函数仍会返回对象的新名称。显示名称保持不变，但它将引用一个具有不同名称的基础对象。

第三列是数字型的，表示字段参数中元素的顺序，从 0 开始。

好的，这三个 KPI 是在创建字段参数时自动提供的。然而，由于这只是一个表格，你也可以手动扩展这个表格，添加更多列。

如果你想知道这为什么有趣，请继续关注，我将向你展示如何利用这种“扩展性”来解决一些数据建模挑战。

# 设置场景

我的数据模型相当简单。我有一个包含各种保险产品数据的表格。对于每个产品，用户应该能够查看赚取和/或签发的保费（解释这两个 KPI 之间的区别超出了本文的范围）。此外，这些 KPI 中的每一个都可以以本币、欧元或美元显示：

![](../Images/2d8cbded2278fb3313958dad7e1f4c20.png)

作者提供的图片

这个想法是让用户能够根据不同的货币（欧元、美元、本币）和/或不同的 KPI（赚取与签发）来切片和筛选数据。

![](../Images/f56a0a297903a5bb875a5a0c5564a13e.png)

如果用户在货币切片器中选择了 EUR，则只应显示 EUR 中的 KPI。

在旧版客户端的解决方案中，这种动态选择是通过使用一些冗长的 DAX 来处理的：即 SWITCH 语句和 SELECTEDVALUE 函数的组合。这个解决方案不仅复杂，而且难以维护：假设你想要在范围内添加一种新货币，或者一个新的 KPI。你需要找到所有应用了该逻辑的度量值，并调整这些度量值的定义。

# 字段参数来拯救！

或者，你可以使用 Field 参数根据用户的选择过滤数据！让我们扩展之前创建的 Field 参数表：

![](../Images/2c4dfc67c1028a55f917e39ab5953230.png)

作者提供的图像

第一个添加的列代表某个选项的货币，而第二列代表 KPI（保费类型）。我将在我的 Param_Premium 表中将这些列分别重命名为货币和保费类型。

现在，让我们打开模型视图，并建立维度表（货币和保费类型）与 Field 参数表（Param_Premium）之间的关系：

![](../Images/87ee206560c0b67516f2d00cf886c684.png)

作者提供的图像

接下来，让我们从表格视觉中移除所有单独的列，并放入 Field 参数表中的“列”：

![](../Images/390f35034e9503eda50fbc3cda9c5ebc.png)

作者提供的图像

初看起来，它与之前的情况完全相同。但一旦我开始操作切片器…你看会发生什么！

![](../Images/680a2cca2366719b9f6f2cc5aedefe6c.png)

作者提供的图像

运作得非常出色！

# 结论

Field 参数非常棒！这一功能不仅减少了许多 Power BI 常见任务的开发工作量，还丰富了 Power BI 报告的数据可视化方面——正如你所见，我们利用 Field 参数进行数据建模，并使报告用户在数据展示方式上拥有完全的灵活性。通过将数据模型扩展至 Field 参数逻辑，我们提供了动态控制报告页面数据的可能性。

感谢阅读！

[成为会员并支持 Medium 上的数千名作者！](https://datamozart.medium.com/membership)

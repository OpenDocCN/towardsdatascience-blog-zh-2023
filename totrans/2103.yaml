- en: 'Time Series for Climate Change: Origin-Destination Demand Forecasting'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/time-series-for-climate-change-origin-destination-demand-forecasting-79c8fed6af89](https://towardsdatascience.com/time-series-for-climate-change-origin-destination-demand-forecasting-79c8fed6af89)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Mining floating car data to tackle climate change
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://vcerq.medium.com/?source=post_page-----79c8fed6af89--------------------------------)[![Vitor
    Cerqueira](../Images/9e52f462c6bc20453d3ea273eb52114b.png)](https://vcerq.medium.com/?source=post_page-----79c8fed6af89--------------------------------)[](https://towardsdatascience.com/?source=post_page-----79c8fed6af89--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----79c8fed6af89--------------------------------)
    [Vitor Cerqueira](https://vcerq.medium.com/?source=post_page-----79c8fed6af89--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----79c8fed6af89--------------------------------)
    ·6 min read·Jun 15, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8b8326d71e3d800402ab1a16ddf64987.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Denys Nevozhai](https://unsplash.com/fr/@dnevozhai?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 'This is Part 8 of the series *Time Series for Climate Change.* List of articles:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Part 1: [Forecasting Wind Power](/time-series-for-climate-change-forecasting-wind-power-8ed6d653a255)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 2: [Solar Irradiance Forecasting](/time-series-for-climate-change-solar-irradiance-forecasting-a972dac7418f)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 3: [Forecasting Large Ocean Waves](https://medium.com/towards-data-science/time-series-for-climate-change-forecasting-large-ocean-waves-78484536be36)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 4: [Forecasting Energy Demand](https://medium.com/towards-data-science/time-series-for-climate-change-forecasting-energy-demand-79f39c24c85e)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 5: [Forecasting Extreme Weather Events](/times-series-for-climate-change-forecasting-extreme-weather-events-335dc199fb6f)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 6: [Using Deep Learning for Precision Agriculture](/time-series-for-climate-change-using-deep-learning-for-precision-agriculture-806878cab9c)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Part 7: [Reducing Food Waste with Clustering](https://medium.com/towards-data-science/time-series-for-climate-change-reducing-food-waste-with-clustering-c2f067ffa907)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Floating Car Data for Mobility Modelling
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mining floating car data is a key task in intelligent transportation systems.
    Floating car data refers to data collected by vehicles equipped with GPS devices.
    These provide information about the location and speed of vehicles.
  prefs: []
  type: TYPE_NORMAL
- en: Understanding mobility patterns within cities is an important task in transportation.
    For example, it helps reduce congestion and overall transportation activity. Less
    time in traffic means fewer greenhouse gases are emitted. So, accurate models
    have a positive impact on climate change.
  prefs: []
  type: TYPE_NORMAL
- en: The widespread of GPS devices produced many data sets related to mobility. But,
    learning from GPS data is a challenging problem. Spatial dependencies are tricky
    but fundamental to capture. There are also temporal dependencies, for instance,
    rush hours. Mobility patterns also differ on whether it’s a weekday or not.
  prefs: []
  type: TYPE_NORMAL
- en: Origin-destination flow count estimation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/1614d8b8519d8aed73fd7cd92021fe89.png)'
  prefs: []
  type: TYPE_IMG
- en: A taxi trip in San Francisco, USA. Image by author
  prefs: []
  type: TYPE_NORMAL
- en: Floating car data offers many possibilities for mobility modeling. One of these
    possibilities is the origin-destination (OD) flow count problem.
  prefs: []
  type: TYPE_NORMAL
- en: OD flow count refers to the estimation of how many vehicles traverse a given
    sub-region to another in a given period. This task is relevant for several reasons.
    Taxi companies can allocate their fleet dynamically according to the expected
    demand in a particular zone.
  prefs: []
  type: TYPE_NORMAL
- en: 'Hands-on: Forecasting OD Demand in San Francisco'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the rest of this article, we’ll forecast taxi passenger demand in San Francisco,
    USA. We’ll tackle this problem as an OD flow count task.
  prefs: []
  type: TYPE_NORMAL
- en: 'The full code used in this tutorial is available on Github:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://github.com/vcerqueira/tsa4climate](https://github.com/vcerqueira/tsa4climate)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data set
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will use a data set collected by a taxi fleet in San Francisco, California,
    USA. The data set contains GPS data from 536 taxis over a period of 21 days. In
    total, there are 121 million GPS traces split across 464045 trips. You can check
    reference [1] for more details.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1339eb0ec79817aeec62720eb773732a.png)'
  prefs: []
  type: TYPE_IMG
- en: Sample of the data set.
  prefs: []
  type: TYPE_NORMAL
- en: At each time step and for each taxi, we have information about its coordinates
    and whether a passenger occupies it.
  prefs: []
  type: TYPE_NORMAL
- en: Defining the problem
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/3ce06ecdf62a4b63df519806d88569e4.png)'
  prefs: []
  type: TYPE_IMG
- en: End location of a sample of taxi trips in San Francisco, USA. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Our goal is to model where people are moving to given their origin. OD flow
    count estimation can be split into four sub-tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: Spatial grid decomposition
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Selection of origin-destination pairs
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Temporal discretization
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Modeling and forecasting
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let’s dive into each problem in turn.
  prefs: []
  type: TYPE_NORMAL
- en: Spatial grid decomposition
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Spatial decomposition is a common preprocessing step for OD flow count estimation.
    The idea is to split the map into grid cells, which represent a small part of
    the city. Then, we can count how many people traverse each possible pair of grid
    cells.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b008dda08ef5019dd2d0917b2966c0a6.png)'
  prefs: []
  type: TYPE_IMG
- en: Two example grid cells in San Francisco. Image by author.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this case study, we split the city map into 10000 grid cells as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: In the code above, we remove outlying locations. These can occur due to GPS
    malfunctions.
  prefs: []
  type: TYPE_NORMAL
- en: Getting the most popular trips
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: After the spatial decomposition process, we get the origin and destination of
    each taxi trip when they’re occupied by a passenger.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The idea is to reconstruct the data set to contain the following information:
    origin, destination, and origin timestamp of each passenger trip. This data forms
    the basis for our origin-destination (OD) flow count model.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This data allows us to count how many trips go from cell A to cell B:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: For simplicity, we get the top 50 OD grid cell pairs with the most trips. Taking
    this subset is optional. Yet, OD pairs with only a few trips will show a sparse
    demand over time, which is difficult to model. Besides, trips with low demand
    may not be useful from a fleet management point of view.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Temporal discretization
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'After finding the top OD pairs in terms of demand, we discretize these over
    time. This is done by counting how many trips occur in each hour for each given
    top pair. This can be done as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This leads to a set of time series, one for each top OD pair. Here’s the time
    series plot for four example pairs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b9c9cc32ef36fb79603e187ea8d7d5bf.png)'
  prefs: []
  type: TYPE_IMG
- en: Time series of flow counts for four example origin-destination pairs. Image
    by author.
  prefs: []
  type: TYPE_NORMAL
- en: The time series show a daily seasonality, which is mostly driven by rush hours.
  prefs: []
  type: TYPE_NORMAL
- en: Forecasting
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The set of time series that results from the temporal discretization can be
    used for forecasting. We can build a model to forecast how many passengers want
    to make the trip relative to a given OD pair.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s how this can be done for an example OD pair:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Above, we built a forecasting model based on ARIMA. The model forecasts passenger
    demand in the next hour given the recent past demand. We use an ARIMA method for
    simplicity, but other approaches such as [deep learning](https://medium.com/towards-data-science/how-to-transform-time-series-for-deep-learning-3b6abbbb3726)
    can be used.
  prefs: []
  type: TYPE_NORMAL
- en: Going further with Graph Neural Networks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The abovementioned approach is a simple but effective way to solve OD flow count
    problems. But, it considers each OD pair as a separate time series.
  prefs: []
  type: TYPE_NORMAL
- en: In reality, each pair is correlated with the neighboring OD pairs or surrounding
    roads. Because of this, graph neural networks have been increasingly used to forecast
    traffic conditions. The road network is modeled as a graph, and neural networks
    can capture complex interactions therein. You can check [this Keras example](https://keras.io/examples/timeseries/timeseries_traffic_forecasting/)
    to learn how to implement this kind of method.
  prefs: []
  type: TYPE_NORMAL
- en: Key Takeaways
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mobility modeling is an important task in intelligent transportation systems;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OD flow count models can help reduce traffic within cities, thereby decreasing
    the emission of greenhouse gases;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can tackle OD flow count problems with an approach based on spatial decomposition
    and temporal discretization. This results in a set of time series for each OD
    pair, which can be used for forecasting.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thank you for reading, and see you in the next story!
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[1] [Dataset of mobility traces of taxi cabs in San Francisco, USA.](https://ieee-dataport.org/open-access/crawdad-epflmobility)
    (License [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/))'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Moreira-Matias, Luís, et al. “Time-evolving OD matrix estimation using
    high-speed GPS data streams.” *Expert systems with Applications* 44 (2016): 275–288.'
  prefs: []
  type: TYPE_NORMAL

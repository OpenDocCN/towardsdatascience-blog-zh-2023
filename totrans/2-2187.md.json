["```py\ndgp = dgp_notification_newsletter(n=10_000)\ndf = dgp.generate_data()\ndf.head()python\n```", "```py\nplot_group_comparison(df, x=\"subscription\", y=\"spend\", title=\"Spend\", xticks=[\"Non-subscriber\", \"Subscriber\"])\n```", "```py\nplot_group_comparison(df, x=\"notification\", y=\"spend\", title=\"Spend\", xticks=[\"No Notification\", \"Notification\"])\n```", "```py\nplot_group_comparison(df, x=\"notification\", y=\"subscription\", title=\"Subscription Probability\", xticks=[\"No Notification\", \"Notification\"])\n```", "```py\ndf.groupby([\"notification\", \"subscription\"]).agg(spend=(\"spend\", \"sum\"), customers=(\"spend\", \"count\")).iloc[::-1].T.round(0)\n```", "```py\ntau_ZY = df.loc[df.notification == 1, \"spend\"].mean() - df.loc[df.notification == 0, \"spend\"].mean()\ntau_ZW = df.loc[df.notification == 1, \"subscription\"].mean() - df.loc[df.notification == 0, \"subscription\"].mean()\ntau_ZY / tau_ZW\n```", "```py\n6.070222743259094\n```", "```py\nfrom linearmodels.iv.model import IV2SLS as iv\n\nmodel_iv = iv.from_formula(\"spend ~ 1 + [subscription ~ notification]\", data=df).fit()\nmodel_iv.summary.tables[1]\n```", "```py\nmodel_1st_stage = smf.ols(\"subscription ~ 1 + notification\", data=df).fit()\ndf[\"subscription_hat\"] = model_1st_stage.predict(df)\nmodel_2nd_stage = smf.ols(\"spend ~ 1 + subscription_hat\", data=df).fit()\nmodel_2nd_stage.summary().tables[1]\n```", "```py\nmodel_1st_stage = smf.ols(\"subscription ~ 1 + spend_old + notification\", data=df).fit()\ndf[\"subscription_hat\"] = model_1st_stage.predict(df)\nmodel_2nd_stage_x = smf.ols(\"spend ~ 1 + spend_old + subscription_hat\", data=df).fit()\nmodel_2nd_stage_x.summary().tables[1]\n```", "```py\nmodel_2sls = iv.from_formula(\"spend ~ 1 + spend_old + [subscription ~ notification]\", data=df).fit()\nmodel_2sls.summary.tables[1]\n```"]
- en: Confidence Interval vs Prediction Interval
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/confidence-vs-prediction-intervals-are-you-making-these-costly-analysis-mistakes-fa02b074498](https://towardsdatascience.com/confidence-vs-prediction-intervals-are-you-making-these-costly-analysis-mistakes-fa02b074498)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: An exploration into the key differences between confidence and prediction intervals
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)[![Egor
    Howell](../Images/1f796e828f1625440467d01dcc3e40cd.png)](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)[](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)
    [Egor Howell](https://medium.com/@egorhowell?source=post_page-----fa02b074498--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----fa02b074498--------------------------------)
    ·6 min read·Jun 4, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0431f8f5d270f3410c3ddff11082e605.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Jarosław Kwoczała](https://unsplash.com/@sumekler?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The terms ‘[***confidence interval***](https://medium.com/towards-data-science/confidence-intervals-simply-explained-58b0b11e985f)’
    and ‘[***prediction interva***](https://en.wikipedia.org/wiki/Prediction_interval)***l***’
    are frequently thrown around interchangebly inside Data Science meetings. I must
    confess that I’ve done it myself sometimes, just to appear smart.
  prefs: []
  type: TYPE_NORMAL
- en: However, this is dangerous. Confidence and prediction intervals refer to very
    different things and you risk potentially being caught off guard by someone who
    understands the difference. That would definitely be embarrassing.
  prefs: []
  type: TYPE_NORMAL
- en: But don’t despair! In this article, I will intuitively explain the difference
    between the two intervals and make you feel confident in applying them.
  prefs: []
  type: TYPE_NORMAL
- en: Confidence Interval
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Overview
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The more well-known one is the confidence interval, so let’s start here. A
    confidence interval is a measure of uncertainty on some sampled parameters such
    as the mean from a sample or a coefficient in a [**regression model**](https://en.wikipedia.org/wiki/Regression_analysis).
    It helps us understand the proximity of our estimate to the true population value.
    If you’re interested in learning more about confidence intervals, feel free to
    check out my previous blog post on the topic:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/confidence-intervals-simply-explained-58b0b11e985f?source=post_page-----fa02b074498--------------------------------)
    [## Confidence Intervals Simply Explained'
  prefs: []
  type: TYPE_NORMAL
- en: A concise explanation of confidence intervals.
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/confidence-intervals-simply-explained-58b0b11e985f?source=post_page-----fa02b074498--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Theory
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Consider the simple [**linear regression**](https://en.wikipedia.org/wiki/Linear_regression)
    equation in its two forms:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/abd2e8a1de7e995842dde5f5c8f5bde7.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: '**y**: *Response*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**x**: *Covariate or feature*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**β₀:** *Coefficient for the slope*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**β₁:** *Intercept*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ε:** *Gaussian random noise*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**E[y | x]**: *Mean response of y given x*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The goal of linear regression is to determine the unknown coefficients **β₀**
    and **β₁** based on some data, represented by the variables **x** and corresponding
    outputs or response **y**. However, in practice, we often only have access to
    a random sample from the entire population. Consequently, the values of **β₀**
    and **β₁** are subject to uncertainty since they are estimated from this random
    sample and not the population. This uncertainty is the source of ‘error’ in regression
    models.
  prefs: []
  type: TYPE_NORMAL
- en: In the case of a confidence interval, it represents the level of uncertainty
    associated with the estimated mean response, **E[y | x]**. Let’s consider an example
    of a dataset comparing salary and age, where we find that the mean salary for
    a 23-year-old is £28,000, E[salary | 23] = £28,000\. If we calculate a 95% confidence
    interval and obtain a range of £26,000 to £30,000, it suggests that we can expect
    the true mean salary for the entire population of 23-year-olds to fall within
    this interval with a probability of 95%. Although this explanation may not capture
    all the intricacies, it serves the purpose of providing a general intuition.
  prefs: []
  type: TYPE_NORMAL
- en: See [here](https://robjhyndman.com/hyndsight/intervals/) for a rigorous definition
    of the confidence interval and its implications.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'To put it in one sentence:'
  prefs: []
  type: TYPE_NORMAL
- en: Confidence Interval = Uncertainty In The Mean Response
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Formula
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The formula for the confidence interval in regression is quite lengthy, but
    luckily most statistical software perform it for us! However, for completeness,
    let’s state the formula and highlight some key features:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/69df99eb4de6b67338c4bf56364b258e.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7ba99feb36ec2c3e00ed7406b1fd60ff.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation by author in LaTeX.
  prefs: []
  type: TYPE_NORMAL
- en: 'Where:'
  prefs: []
  type: TYPE_NORMAL
- en: '**x**: *The feature or covariate value*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ŷ:** T*he prediction for x*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***t_(1-α/2, n-2)** = [***T-distribution***](/statistical-t-test-simply-explained-b510045d69e)*critical
    value for a confidence level of 1-α**with n-2* [***degrees of freedom***](https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics))*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***n**: *Number of data points in the sample**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***y**: *The true/actual responses**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '***MSE**: [*The mean squared error*](https://en.wikipedia.org/wiki/Mean_squared_error)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Again, don’t get too bogged down in this mathematical details — I certainly
    haven’t! The purpose was simply to provide a little insight into the origin of
    the formula. As you can see, its mainly unifying the spread of the data and the
    error in the prediction. If you’re interested in a comprehensive derivation, checkout
    this link [here](https://online.stat.psu.edu/stat415/lesson/7/7.5).*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Prediction Interval*'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*Overview*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*The confidence interval measures the uncertainty in estimating the mean response,
    so what does the prediction interval do? The prediction interval measures the
    uncertainty of where a new sampled value is likely to fall. It achieves this by
    considering all the observed responses in the current sample. It takes into account
    both the variability in our sample and the uncertainty of the estimated regression
    model.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Theory*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*Remember our simple linear regression equation above:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/abd2e8a1de7e995842dde5f5c8f5bde7.png)*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Equation by author in LaTeX.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*The confidence interval express the sampling uncertainty in **E[y | x],**
    whereas the prediction interval express the uncertainty in the range of **y.**
    As it is considering the whole range and not just the mean, the prediction is
    naturally larger than the confidence interval.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*The confidence interval expresses the sampling uncertainty associated with
    estimating **E[y | x]**, the expected value of **y** on **x**. Whereas, the prediction
    interval captures the uncertainty in the whole range of possible values of **y**.
    Since the prediction interval considers the entire range and not just the mean,
    it is naturally wider than the confidence interval.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Formula*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*The formula for the prediction interval is closely related to that of the
    confidence interval:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/18d4fd6b26b51c34417a401842af586a.png)*'
  prefs: []
  type: TYPE_NORMAL
- en: '*However, do you observe the one key difference? That’s right, there is an
    additional term involving the MSE. By introducing this extra positive term, we
    can see mathematically that the prediction interval will be larger than the confidence
    interval.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Example Plot*'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*To better understand confidence and prediction intervals, let’s walk through
    an example that visualises them. Below is a code snippet that generates a plot
    displaying the relationship between salary and experience. The plot includes the
    data points, the regression line, and the 95% confidence and prediction intervals:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Data from [Kaggle](https://www.kaggle.com/datasets/abhishek14398/salary-dataset-simple-linear-regression)
    with a CC0 licence.*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*GitHub Gist by author.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/1ec88e4d34ae09a5b36708e1eceedaaa.png)*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Plot generated by author in Python.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*As we can see, the prediction interval is much wider than the confidence interval.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Summary & Further Thoughts*'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*In this article, we have explored the differences between confidence and prediction
    intervals. To summarise the key points, refer to the table below:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/4efda2d6fcbf679acd975cd38a6d08a4.png)*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Table by author.*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Now that you understand the difference, you can correct anyone who mistakenly
    uses the two terms interchangeably!*'
  prefs: []
  type: TYPE_NORMAL
- en: '*The full code used in this post can be found on my GitHub here:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*[](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/General/confidence_vs_prediction_intervals.py?source=post_page-----fa02b074498--------------------------------)
    [## Medium-Articles/confidence_vs_prediction_intervals.py at main · egorhowell/Medium-Articles'
  prefs: []
  type: TYPE_NORMAL
- en: Code I use in my medium blog/articles. Contribute to egorhowell/Medium-Articles
    development by creating an account on…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/General/confidence_vs_prediction_intervals.py?source=post_page-----fa02b074498--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Another Thing!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I have a free newsletter, [**Dishing the Data**](https://dishingthedata.substack.com/),
    where I share weekly tips for becoming a better Data Scientist. There is no “fluff”
    or “clickbait,” just pure actionable insights from a practicing Data Scientist.
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://newsletter.egorhowell.com/?source=post_page-----fa02b074498--------------------------------)
    [## Dishing The Data | Egor Howell | Substack'
  prefs: []
  type: TYPE_NORMAL
- en: How To Become A Better Data Scientist. Click to read Dishing The Data, by Egor
    Howell, a Substack publication with…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: newsletter.egorhowell.com](https://newsletter.egorhowell.com/?source=post_page-----fa02b074498--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: Connect With Me!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[**YouTube**](https://www.youtube.com/@egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**LinkedIn**](https://www.linkedin.com/in/egor-howell-092a721b3/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**Twitter**](https://twitter.com/EgorHowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[**GitHub**](https://github.com/egorhowell)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: References & Further Reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'More in depth discussion about the two intervals: [https://online.stat.psu.edu/stat501/lesson/3/3.3](https://online.stat.psu.edu/stat501/lesson/3/3.3)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'More discussion and relation to tolerance intervals: [https://blog.minitab.com/en/adventures-in-statistics-2/when-should-i-use-confidence-intervals-prediction-intervals-and-tolerance-intervals](https://blog.minitab.com/en/adventures-in-statistics-2/when-should-i-use-confidence-intervals-prediction-intervals-and-tolerance-intervals)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Inspiration for the code tutorial: [https://lmc2179.github.io/posts/confidence_prediction.html](https://lmc2179.github.io/posts/confidence_prediction.html)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL

["```py\n**FROM python:3.10-slim** \n**WORKDIR /app** # install poetry **ENV POETRY_VERSION=1.2.0\nRUN pip install \"poetry==$POETRY_VERSION\"** # copy application **COPY [\"pyproject.toml\", \"poetry.lock\", \"README.md\", \"./\"]\nCOPY [\"src/\", \"src/\"]** # build wheel **RUN poetry build --format wheel** # install package **RUN pip install dist/*.whl**\n```", "```py\n**> docker build --file Dockerfile --tag project:latest .**\n\n...\n => [7/7] RUN pip install dist/*.whl                                                                                                                                                                                                                                                                              30.7s\n => exporting to image                                                                                                                                                                                                                                                                                             0.5s \n => => exporting layers                                                                                                                                                                                                                                                                                            0.5s \n => => writing image sha256:bb2acf440f4cf24ac00f051b1deaaefaf4e41b87aa26c34342cbb6faf6b55591                                                                                                                                                                                                                       0.0s \n => => naming to docker.io/library/project:latest\n```", "```py\n**> docker images**\n\nREPOSITORY   TAG       IMAGE ID       CREATED         SIZE\nproject      latest    bb2acf440f4c   2 minutes ago   271MB\n```", "```py\n**> docker run -it --rm project:latest**\n```", "```py\nPython 3.10.10 (main, Mar 23 2023, 03:59:34) [GCC 10.2.1 20210110] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>>\n```", "```py\n**> docker run -it --rm project:latest /bin/bash**\n\nroot@76eb4cb2d8fb:/app#\n```", "```py\napp\n├── README.md\n├── dist\n│   └── example_app-0.3.0-py3-none-any.whl\n├── poetry.lock\n├── pyproject.toml\n└── src\n    └── example_app\n```", "```py\n**> pip freeze**\n\n...\ndulwich==0.20.50\n**example-app** @ file:///app/dist/example_app-0.3.0-py3-none-any.whl\nfastapi==0.85.2\n...\n```", "```py\n**> pip show example-app**\n\nName: example-app\nVersion: 0.3.0\nSummary: \nHome-page: https://github.com/johschmidt42/python-project-johannes\nAuthor: Johannes Schmidt\nAuthor-email: johannes.schmidt.vik@gmail.com\nLicense: MIT\nLocation: **/usr/local/lib/python3.10/site-packages**\nRequires: fastapi, httpx, uvicorn\nRequired-by:\n```", "```py\n**> uvicorn app:app --host 0.0.0.0 --port 80 --workers 1**\n\nINFO:     Started server process [17]\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://0.0.0.0:80 (Press CTRL+C to quit)\n```", "```py\n# main.py\n\nfrom example_app.app import app\n\nif __name__ == '__main__':\n    print(app.title)\n```", "```py\n# Dockerfile\n...\n**COPY [\"main.py\", \"./\"]**\n...\n```", "```py\n**> uvicorn main:app --host 0.0.0.0 --port 80 --workers 1**\n\nINFO:     Started server process [8]\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://0.0.0.0:80 (Press CTRL+C to quit)\n```", "```py\nFROM python:3.10-slim\n\nWORKDIR /app\n\n# install poetry\nENV POETRY_VERSION=1.2.0\nRUN pip install \"poetry==$POETRY_VERSION\"\n\n# copy application\nCOPY [\"pyproject.toml\", \"poetry.lock\", \"README.md\", \"**main.py**\", \"./\"]\nCOPY [\"src/\", \"src/\"]\n\n# build wheel\nRUN poetry build --format wheel\n\n# install package\nRUN pip install dist/*.whl\n\n# expose port\n**EXPOSE 80**\n\n# command to run\n**CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"80\", \"--workers\", \"1\"]**\n```", "```py\n> **docker run -p 9000:80 -it --rm project:latest**\n\n[2023-01-30 21:04:33 +0000] [1] [INFO] Starting gunicorn 20.1.0\n[2023-01-30 21:04:33 +0000] [1] [INFO] Listening at: http://0.0.0.0:80 (1)\n[2023-01-30 21:04:33 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker\n[2023-01-30 21:04:33 +0000] [7] [INFO] Booting worker with pid: 7\n[2023-01-30 21:04:34 +0000] [7] [INFO] Started server process [7]\n[2023-01-30 21:04:34 +0000] [7] [INFO] Waiting for application startup.\n[2023-01-30 21:04:34 +0000] [7] [INFO] Application startup complete.\n```", "```py\nFROM python:3.10-slim\n\nWORKDIR /app\n\n# install poetry\nENV POETRY_VERSION=1.2.0\nRUN pip install \"poetry==$POETRY_VERSION\"\n\n# install gunicorn (ASGI web implementation)\n**RUN pip install gunicorn==20.1.0**\n\n# copy application\nCOPY [\"pyproject.toml\", \"poetry.lock\", \"README.md\", \"./\"]\nCOPY [\"src/\", \"src/\"]\n\n# build wheel\nRUN poetry build --format wheel\n\n# install package\nRUN pip install dist/*.whl\n\n# expose port\nEXPOSE 80\n\n# command to run\nCMD [\"**gunicorn**\", \"main:app\", \"**--bind**\", \"**0.0.0.0:80**\", \"--workers\", \"1\", \"**--worker-class\", \"uvicorn.workers.UvicornWorker**\"]\n```", "```py\n**FROM python:3.10-slim as base**\n\nWORKDIR /app\n\n# ignore 'Running pip as the root user...' warning\nENV PIP_ROOT_USER_ACTION=ignore\n\n# update pip\nRUN pip install --upgrade pip\n\n**FROM base as builder**\n\n# install poetry\nENV POETRY_VERSION=1.3.1\nRUN pip install \"poetry==$POETRY_VERSION\"\n\n# copy application\nCOPY [\"pyproject.toml\", \"poetry.lock\", \"README.md\", \"./\"]\nCOPY [\"src/\", \"src/\"]\n\n# build wheel\nRUN poetry build --format wheel\n\n**FROM base as production**\n\n# expose port\nEXPOSE 80\n\n# copy the wheel from the build stage\nCOPY --from=builder /app/dist/*.whl /app/\n\n# install package\nRUN pip install /app/*.whl\n\n# copy entrypoint of the app\nCOPY [\"main.py\", \"./\"]\n\n# command to run\nCMD [\"uvicorn\", \"main:app\",\"--host\", \"0.0.0.0\", \"--port\", \"80\", \"--workers\", \"1\"] \n```", "```py\n**> docker build --file Dockerfile --tag project:latest --target production .**\n```", "```py\n**> docker images**\n\nREPOSITORY   TAG       IMAGE ID       CREATED          SIZE\nproject      latest    f1be09c32a55   14 minutes ago   **197MB**\n```", "```py\n**> docker run -p 9000:80 -it --rm project:latest**\n```", "```py\n> CR_PAT=\"XYZ\"\n> echo $CR_PAT | docker login ghcr.io -u johschmidt42 --password-stdin\n\nLogin Succeeded\n```", "```py\n# Makefile\n\n...\n\nlogin: ## login to ghcr.io using a personal access token (PAT)\n @if [ -z \"$(CR_PAT)\" ]; then\\\n  echo \"CR_PAT is not set\";\\\n else\\\n  echo $(CR_PAT) | docker login ghcr.io -u johschmidt42 --password-stdin;\\\n fi\n\n...\n```", "```py\n> **make login CR_PAT=\"XYZ\"**\n```", "```py\n> **docker tag project:latest ghcr.io/johschmidt42/project:latest**\n```", "```py\n# Makefile\n\n...\n\ntag: ## tag docker image to ghcr.io/johschmidt42/project:latest\n @docker tag project:latest ghcr.io/johschmidt42/project:latest\n\n...\n```", "```py\n**> docker images**\n\nREPOSITORY                     TAG       IMAGE ID       CREATED             SIZE\nproject                        latest    f1be09c32a55   About an hour ago   197MB\nghcr.io/johschmidt42/project   latest    f1be09c32a55   About an hour ago   197MB\n```", "```py\n> **docker push ghcr.io/johschmidt42/project:latest** \ndenied: permission_denied: The token provided does not match expected scopes.\n```", "```py\n# Makefile\n\n...\n\npush: tag ## docker push to container registry (ghcr.io)\n @docker push ghcr.io/johschmidt42/project:latest\n\n...\n```", "```py\n> **make push**\n\n1a3ba1c1448c: Pushed \n0ad139eaf32a: Pushing [========================================>          ]   43.3MB/54.08MB\n0e0b5d4aea1e: Pushed \na179cef7de6a: Pushing [==================================================>]  18.15MB\n22f1e17dcfe4: Pushed \n805fe34ec92b: Pushing [==================================================>]  12.76MB\nfa04dee82d1b: Pushed \n42d55226bf51: Pushing [==================================================>]  30.83MB\n7d13900c8624: Pushed \n650abce4b096: Pushing [==============>                                    ]  22.72MB/80.51MB\nlatest: digest: sha256:57d409bb564f465541c2529e77ad05a02f09e2cc22b3c38a93967ce1b277f58a size: 2414 \n```", "```py\n**> docker pull ghcr.io/johschmidt42/python-project-johannes:v0.4.1**\n```", "```py\n> docker stop $(docker ps -a -q) && docker rm $(docker ps -a -q)\n```", "```py\n> docker rmi $(docker images --filter \"dangling=true\" -q --no-trunc)\n```", "```py\n> docker build --file Dockerfile --tag project:latest --target production .\n```", "```py\n> **trivy image project:latest --scanners vuln --format table --severity  CRITICAL,HIGH**\n```", "```py\nproject:latest (debian 12.0)\n\nTotal: 27 (HIGH: 27, CRITICAL: 0)\n\n┌────────────────┬────────────────┬──────────┬───────────────────┬───────────────┬──────────────────────────────────────────────────────────────┐\n│    Library     │ Vulnerability  │ Severity │ Installed Version │ Fixed Version │                            Title                             │\n├────────────────┼────────────────┼──────────┼───────────────────┼───────────────┼──────────────────────────────────────────────────────────────┤\n│ linux-libc-dev │ CVE-2013-7445  │ **HIGH**     │ 6.1.27-1          │               │ kernel: memory exhaustion via crafted Graphics Execution     │\n│                │                │          │                   │               │ Manager (GEM) objects                                        │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2013-7445                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2019-19449 │          │                   │               │ kernel: mounting a crafted f2fs filesystem image can lead to │\n│                │                │          │                   │               │ slab-out-of-bounds read...                                   │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2019-19449                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2019-19814 │          │                   │               │ kernel: out-of-bounds write in __remove_dirty_segment in     │\n│                │                │          │                   │               │ fs/f2fs/segment.c                                            │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2019-19814                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2021-3847  │          │                   │               │ low-privileged user privileges escalation                    │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2021-3847                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2021-3864  │          │                   │               │ descendant's dumpable setting with certain SUID binaries     │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2021-3864                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-1194  │          │                   │               │ use-after-free in parse_lease_state()                        │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-1194                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-2124  │          │                   │ 6.1.37-1      │ OOB access in the Linux kernel's XFS subsystem               │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-2124                    │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-2156  │          │                   │               │ IPv6 RPL protocol reachable assertion leads to DoS           │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-2156                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-2176  │          │                   │               │ Slab-out-of-bound read in compare_netdev_and_ip              │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-2176                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3090  │          │                   │ 6.1.37-1      │ out-of-bounds write caused by unclear skb->cb                │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3090                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-31248 │          │                   │               │ use-after-free in nft_chain_lookup_byid()                    │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-31248                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32247 │          │                   │ 6.1.37-1      │ session setup memory exhaustion denial-of-service            │\n│                │                │          │                   │               │ vulnerability                                                │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32247                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32248 │          │                   │               │ tree connection NULL pointer dereference denial-of-service   │\n│                │                │          │                   │               │ vulnerability                                                │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32248                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32250 │          │                   │               │ session race condition remote code execution vulnerability   │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32250                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32252 │          │                   │               │ session NULL pointer dereference denial-of-service           │\n│                │                │          │                   │               │ vulnerability                                                │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32252                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32254 │          │                   │               │ tree connection race condition remote code execution         │\n│                │                │          │                   │               │ vulnerability                                                │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32254                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32257 │          │                   │               │ session race condition remote code execution vulnerability   │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32257                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-32258 │          │                   │               │ session race condition remote code execution vulnerability   │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-32258                   │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3268  │          │                   │               │ out-of-bounds access in relay_file_read                      │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3268                    │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3269  │          │                   │               │ distros-[DirtyVMA] Privilege escalation via                  │\n│                │                │          │                   │               │ non-RCU-protected VMA traversal                              │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3269                    │\n│                ├────────────────┤          │                   │               ├──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3390  │          │                   │               │ UAF in nftables when nft_set_lookup_global triggered after   │\n│                │                │          │                   │               │ handling named and anonymous sets...                         │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3390                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3397  │          │                   │               │ slab-use-after-free Write in txEnd due to race condition     │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3397                    │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-35001 │          │                   │               │ stack-out-of-bounds-read in nft_byteorder_eval()             │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-35001                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-35788 │          │                   │ 6.1.37-1      │ out-of-bounds write in fl_set_geneve_opt()                   │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-35788                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-35827 │          │                   │               │ race condition leading to use-after-free in ravb_remove()    │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-35827                   │\n│                ├────────────────┤          │                   ├───────────────┼──────────────────────────────────────────────────────────────┤\n│                │ CVE-2023-3640  │          │                   │               │ a per-cpu entry area leak was identified through the         │\n│                │                │          │                   │               │ init_cea_offsets function when...                            │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-3640                    │\n├────────────────┼────────────────┤          ├───────────────────┼───────────────┼──────────────────────────────────────────────────────────────┤\n│ perl-base      │ CVE-2023-31484 │          │ 5.36.0-7          │               │ CPAN.pm before 2.35 does not verify TLS certificates when    │\n│                │                │          │                   │               │ downloading distributions over...                            │\n│                │                │          │                   │               │ https://avd.aquasec.com/nvd/cve-2023-31484                   │\n└────────────────┴────────────────┴──────────┴───────────────────┴───────────────┴──────────────────────────────────────────────────────────────┘\n```", "```py\n# Dockerfile\n...\n\nFROM base as production\n\n# expose port\nEXPOSE 80\n\n# copy the wheel from the build stage\nCOPY --from=builder /app/dist/*.whl /app/\n\n# install package\nRUN pip install /app/*.whl\n\n# copy entrypoint of the app\nCOPY [\"main.py\", \"./\"]\n\n**# Remove linux-libc-dev (CVE-2023-31484)\nRUN apt-get remove -y --allow-remove-essential linux-libc-dev**\n\n# command to run\nCMD [\"uvicorn\", \"main:app\",\"--host\", \"0.0.0.0\", \"--port\", \"80\", \"--workers\", \"1\"]\n```", "```py\n# .trivyignore\n\n# vulnerabilities to be ignored by trivy are added here\nCVE-2023-31484\n```", "```py\n> trivy image project:latest --scanners vuln --format table --severity  CRITICAL,HIGH **--ignorefile .trivyignore**\n```", "```py\nproject:latest (debian 12.0)\n\nTotal: 0 (HIGH: 0, CRITICAL: 0)\n```"]
# 利用GPTs构建物理信息神经网络领域的专家GPT

> 原文：[https://towardsdatascience.com/building-an-expert-gpt-in-physics-informed-neural-networks-with-gpts-75ebf6925966](https://towardsdatascience.com/building-an-expert-gpt-in-physics-informed-neural-networks-with-gpts-75ebf6925966)

## 一个定制的副驾驶，用于简化PINN研究和开发

[](https://shuaiguo.medium.com/?source=post_page-----75ebf6925966--------------------------------)[![Shuai Guo](../Images/d673c066f8006079be5bf92757e73a59.png)](https://shuaiguo.medium.com/?source=post_page-----75ebf6925966--------------------------------)[](https://towardsdatascience.com/?source=post_page-----75ebf6925966--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----75ebf6925966--------------------------------) [Shuai Guo](https://shuaiguo.medium.com/?source=post_page-----75ebf6925966--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page-----75ebf6925966--------------------------------)·14分钟阅读·2023年11月18日

--

![](../Images/7a99281c603b8d52064dd2e1f7fa5b4b.png)

定制GPT的标志。（由DALL·E 3生成）

在最近的OpenAI DevDay上，最令人兴奋的发布之一就是GPTs。基本上，GPTs是任何人都可以创建的用于特定目的的ChatGPT定制版本。配置一个可用的GPT的过程无需编程，只需通过聊天即可。因此，自发布以来，社区已经创建了各种GPT，以帮助用户提高生产力，增添生活乐趣。

作为物理信息神经网络（PINN）领域的从业者，我经常使用ChatGPT（GPT-4）来帮助我理解复杂的技术概念，调试在实现模型时遇到的问题，并提出新颖的研究想法或工程解决方案。尽管非常有用，我发现ChatGPT在提供超出其一般PINN知识的量身定制答案时常常显得力不从心。虽然我可以调整我的提示以纳入更多的上下文信息，但这是一项相当耗时的工作，有时会迅速消耗我的耐心。

现在可以轻松定制ChatGPT，我想到一个想法：为什么不开发一个定制的GPT，作为PINN专家🦸‍♀️，从我精心挑选的资源中汲取知识，并努力以量身定制的方式回答关于PINN的问题呢？

所以，在这篇博客文章中，让我们看看如何使这一目标成为现实！我们将首先介绍构建我们目标GPT的过程，提供指令设计和知识库的详细信息。然后，我们将进行一些演示，看看如何与新创建的GPT进行最佳互动。最后，我们将探讨未来发展的机会。

这个想法与你产生共鸣吗？让我们开始吧🗺️📍🚶‍♀️

> 这是我物理启发机器学习系列中的另一篇博客。其他包括：
> 
> [物理启发神经网络：应用中心指南](/physics-informed-neural-networks-an-application-centric-guide-dc1013526b02)
> 
> [揭开物理启发神经网络的设计模式](/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)
> 
> [通过PINN和符号回归发现微分方程](/discovering-differential-equations-with-physics-informed-neural-networks-and-symbolic-regression-c28d279c0b4d)
> 
> [通过物理启发的DeepONet进行操作学习](/operator-learning-via-physics-informed-deeponet-lets-implement-it-from-scratch-6659f3179887)
> 
> [通过物理启发的DeepONet解决逆问题](/solving-inverse-problems-with-physics-informed-deeponet-a-practical-guide-with-code-implementation-27795eb4f502)
> 
> 随时查看它们！

## 内容目录

**·** [**1\. 如何构建？**](#d978)

∘ [知识](#3239)

∘ [说明](#ef8e)

**·** [**2\. 如何互动？**](#9d1a)

**·** [**3\. 如何扩展**](#067f)

**·** [**4\. 总结**](#2ddc)

# 1\. 如何构建？

如前所述，构建定制化GPT非常简单：这只是将我们的想法传达给GPT Builder的问题。

![](../Images/a2933eb4d87cfbdb3e48976698e30ad7.png)

GPT Builder环境。

为了开发我们的目标GPT，我们需要特别关注知识和说明部分。让我们看看如何正确设置它们。

## 知识

本节允许我们向GPT附加文件。稍后，当GPT响应用户的问题时，它可能会从上传的文件中检索相关信息，并基于这些检索到的信息来回答问题。实质上，这些附加的文件作为*知识库*为定制化GPT提供支持，并促进RAG（检索增强生成）模式。

为了为GPT提供正确的知识，我将我关于[PINN设计模式](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)的系列技术博客上传到了GPT Builder。以前，我在Towards Data Science上定期发表文章，提炼出可重用的解决方案，这些方案经过测试，已被证明对PINN实现中的常见问题有效。每篇文章都详细解释了一种设计模式，包括具体问题、相应解决方案的技术性、基准、优缺点以及替代方案。可以在[这里](https://medium.com/towards-data-science/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)找到一篇示例博客。

我保持这一系列文章的初衷是创建一个结构化的地图，供PINN从业者依赖，以便识别最适合特定挑战的技术，并跟上最新进展。现在我可以进一步推进，将系列文章整合到GPT的知识库中，使用户可以通过聊天直接学习PINN中的最佳实践。

## 指令

一旦GPT的知识更新完成，我们需要专注于制定正确的指令。指令部分允许我们输入命令来控制自定义GPT的行为。如果你有使用Open API的经验，指令就像是Chat Completions API中的“SystemMessage”。

对于我们当前的任务，我们希望创建一个在PINN领域的专家GPT，并能够有效地帮助用户应对PINN研究和开发中的复杂性。我们将这些想法解释给GPT构建者，系统将自动生成一份指令草稿。

制定正确的指令通常是一个迭代过程，需要多轮解释思想 ==> 更新指令 ==> 测试GPT行为 ==> 完善思想。经过一段时间的调整，我得到了以下GPT：

![](../Images/abae5142703141df54590b03dd995066.png)

生成的GPT。（作者提供的图像）

**指令（由GPT生成）**：

> 我是PINN设计模式专家，专注于物理信息神经网络，重点是系列技术文章中概述的设计模式，包括集成学习、主动学习、超参数调整、梯度增强学习、因果训练、协同点采样等主题。每篇文章讨论一个特定的设计模式，这些模式在研究论文中展示，涵盖以下方面：
> 
> - 来源：提出设计模式的原始研究论文。
> 
> - 问题：设计模式中的策略旨在解决的具体问题。
> 
> - 解决方案：策略的关键组成部分、其实施方式以及其有效性的理由。
> 
> - 基准：使用设计模式评估的偏微分方程及其相关性能。
> 
> - 优势与劣势：策略有效的条件及其局限性。
> 
> - 替代方案：其他类似问题的解决方法，提供对潜在解决方案的更广泛视角。
> 
> - 潜在的未来改进：关于推进设计模式的建议。
> 
> 我利用这种结构化的方法来帮助用户在多个方面，包括分析设计模式、评估解决方案、指导研究和开发，并提供量身定制的建议和解释以支持您的工作。
> 
> 我的目标是促进对物理信息神经网络的全面而细致的理解，帮助用户在这一动态发展领域中导航并取得成功。
> 
> 在我的回应中，我将整合来自综合数据库的物理信息神经网络知识和见解，确保用户体验流畅自然，而不会明确引用信息来源。然而，当用户明确询问信息来源时，我会指出哪个原始研究论文提出了相关的设计模式或策略。这种方法保持了沟通的专业性和流畅性，专注于根据物理信息神经网络的专业知识提供准确和相关的上下文信息。

这是一个非常全面的指令，涵盖了角色规范、知识库的描述，以及如何在与用户互动时使用该知识库。此外，我还为 GPT 启用了网页浏览功能，以便在必要时可以在线查找信息。

这里有一个附带说明：在开发自己的 GPT 并将其发布到公众时，你可能需要考虑隐私和网络安全问题。例如，具有不当目的的用户可能利用提示注入攻击来揭示原始的 GPT 配置指令，这些指令你可能不希望公开。在这些情况下，请记得添加额外的指令以防范这些攻击。

好了，现在我们已经构建了所需的 GPT，我们可以保存更改并将其发布到公众（我会在本文末尾分享 GPT 链接）。是时候测试一下并看看如何与之互动了。

# 2\. 如何互动？

凭借对 PINN 最佳实践的特定知识，以及在预训练期间获得的一般 PINN 知识，新创建的 GPT 可以在多种不同方式上成为用户的有用助手。接下来，让我们看看一些具体的例子。

+   **提出具体的实施问题。**

问：什么是 PINN 中的配点，我应该如何对其进行采样？

配点是 PINN 中的一个关键概念，以正确的方式进行采样对成功实现 PINN 至关重要。让我们看看定制的 GPT 如何回答这个问题：

![](../Images/53102a8716f45e2c699e683e888cd0d8.png)

定制 GPT 生成的回应。 （图片由作者提供）

GPT 首先基于其对 PINN 的一般知识解释了配点的定义，然后提供了几种具体的、先进的采样策略（例如，RAD、RAR-D）的详细描述。这可能会很有帮助，因为它为从业者提供了快速的指引，便于深入探讨。它还表明，定制的 GPT 不仅能够从知识库中提取相关信息，而且知道*何时*这样做。

现在，如果我们向标准 ChatGPT（GPT-4）提出相同的问题，回答将如下所示：

![](../Images/34ebf996dfa0271d218d69c0e3112a1f.png)

标准 ChatGPT（GPT-4）生成的回应。 （图片由作者提供）

我们可以看到标准的 ChatGPT 只能提供有关采样策略的一般信息。尽管它还建议将“自适应采样”作为潜在的策略之一，但其描述非常高层次，没有提供更多细节，例如如何调整采样，或如何测量网络性能等。此外，最后一个建议，即“结合数据与物理”，则相当无用，因为使用 PINN 的整个理念是将数据与物理结合。

+   **请求编写原型代码**

问：你能用 Python 编写一个原型代码来演示 RAD 算法的工作流程吗？

继续之前的对话，我们可以进一步要求定制的 GPT 生成一些实现其建议的特定算法的原型代码，例如 RAD 算法。以下是回复：

![](../Images/ed438e5e0f6cc01ab05ad123b2b3957b.png)

定制 GPT 生成的回复。（图像来源：作者）

不错！定制的 GPT 能够基于博客中的描述快速勾勒出一些原型代码。这对从业者了解算法的内部工作原理并实现快速原型设计，以查看该算法是否适合当前问题非常有用。

+   **请求最佳实践总结**

问：你能总结一下那些可以有效提高 PINN 训练稳定性的方法吗？

这是从业者可能感兴趣的另一个常见点，即寻求与他们工作相关的量身定制的总结或概述。以下是定制 GPT 的回复：

![](../Images/95d47878a9ddfeb241f88b403d358171.png)

定制 GPT 生成的回复。（图像来源：作者）

我们可以看到定制的 GPT 能够生成广泛但具体的技术总结，从集成学习到超参数调优。回答与博客中所指出的内容非常一致，并反映了最先进的技术。同时，注意到博客系列还讨论了其他技术，如主动学习。然而，定制的 GPT 认为这些技术与“*提高 PINN 训练的稳定性*”并不十分相关，因此没有在回答中提及。总体而言，这是一个对从业者快速了解全貌的有用功能。

另一方面，如果我们问标准的 ChatGPT（GPT-4）相同的问题，得到的回答如下：

![](../Images/ddb301377bd83b6288f60673ed3716ab.png)

标准 ChatGPT（GPT-4）生成的回复。为了节省空间，回复被截断。（图像来源：作者）

这里仅显示了完整响应的一部分以节省空间，但标准 GPT 的回答主要围绕神经网络训练的一般最佳实践，例如正则化、归一化与缩放、学习率调度、迁移学习和预训练等。这进一步显示了定制 GPT 具备针对我们需求的知识的好处。

+   **询问特定概念**

问：因果训练在 PINN 训练中解决了什么问题？

对于新手从业者，GPT 的常见使用方式可能是更好地理解他们在研究论文中遇到的特定 PINN 概念。在这种情况下，我们要求 GPT 解释 *因果训练* 的含义，这是 2022 年引入到 PINN 的一个相当新的概念。以下是我们获得的响应：

![](../Images/c900a92ce3ac871acad708bc6e6a97e0.png)

定制 GPT 生成的响应。（作者提供的图片）

在我提供给 GPT 的博客系列中，有一篇深入探讨了 PINN 训练中的因果关系问题。本质上，定制 GPT 抓住了这一点，并很好地总结了方法的核心思想。

+   **寻找原始研究论文**

问：最初提出将因果训练引入 PINN 的论文是哪一篇？

如果某个具体技术对用户的问题确实很有趣，用户自然会想深入了解并阅读原始研究论文。因此，定制 GPT 的一个好特性是提供指向提出该技术的原始研究论文的指针。以下是获得的响应：

![](../Images/6031cd83059258fc2fa889fbe19b2847.png)

在这种情况下，定制 GPT 正确地指出了研究的来源。有趣的是，标准 GPT 则给出了完全错误的答案：

![](../Images/e36c7b7a906a5822f73c48bea2d9ade7.png)

我在网上搜索过，没有找到由 Paris Perdikaris 撰写的《Causality-Inspired Neural Networks for Physics-Informed Machine Learning》这篇论文。这就是大型语言模型的幻觉！

+   **调试实际实施中的问题**

问：当我在训练物理信息神经网络时，我注意到尽管训练损失在减少，但神经网络对物理量的预测始终不准确，尤其是在早期时间步骤。这可能是什么原因？

帮助调试实际实施问题可能是定制 GPT 最受从业者欢迎的功能之一。在这里，我们向定制 GPT 提出一个实际问题，并评估它是否能揭示可能的根本原因。获得的响应如下：

![](../Images/7e904a03e77a9615b370adf8180ae005.png)

定制 GPT 生成的响应片段。（作者提供的图片）

我们看到在众多可行的理由中，“时间因果关系的违反”排在首位。相反，如果我们向标准 GPT 提出同样的问题，我们的结果会有所不同：

![](../Images/60a13d31e28de3680504f7084a46049a.png)

标准 GPT 生成的响应片段。（图像来源于作者）

我们看到建议的根本原因相当普遍，也适用于其他类型的神经网络，这些网络不一定是以物理为基础的。

定制 GPT 列出“时间因果性违反”作为首要原因的原因有两个：

+   我的 PINN 系列博客中的每一篇都有一个部分专门描述特定技术旨在解决的问题。因此，该博客系列实际上是“症状”与“治疗”对的集合。

+   一篇博客深入探讨了 PINN 中的因果训练概念。配备了这一知识库的定制 GPT 将“症状”（问题）与相应的“治疗”（将因果关系纳入训练）相匹配。

通过利用 PINN 中的症状与治疗的定制知识，定制 GPT 更有可能揭示具体实际实施问题的根本原因。

+   **激发新的研究想法**

问：将主动学习应用于 PINN 的未来研究机会是什么？

最后，使用定制 GPT 的另一个用途是为新的研究方向和想法提供灵感。在这里，我们希望探索将主动学习技术与 PINN 相结合的可能性，我们的定制 GPT 提供了一个长长的潜在机会清单（为了节省一些空间，仅列出了机会标题）：

========== * 以下列表由 GPT 生成 * ============

1.  主动学习中的算法改进

1.  高维问题的可扩展性

1.  与其他机器学习技术的集成

1.  实时与在线学习

1.  不确定性量化

1.  特定应用的主动学习策略

1.  高效计算策略

1.  逆问题中的主动学习

1.  鲁棒性与泛化能力

1.  与实验设计的集成

========== * 上述列表由 GPT 生成 * ============

对于其中一些方向，我已经看到最近的工作。对于其他方向，我不了解任何具体工作，它们可能非常有趣且富有成果！作为附注，GPT 提出的前两大方向绝对不是它的“原创”想法。它们实际上在我讨论主动学习应用于 PINN 的博客的“潜在未来改进”部分中明确提到。这表明定制 GPT 可以无缝地将其通用知识与检索到的特定信息结合起来，形成回答。

# 3\. 如何扩展

我们已经讨论了专家 GPT 如何帮助从业者在 PINN 领域中导航。在这一部分，让我们换个角度，讨论一些未来可能的扩展方向。

+   **更新知识库**：PINN是一个充满活力的研究领域，时不时会宣布新的进展。因此，为了使专家GPT保持“专家”地位，定期更新其知识库并告知其关于PINN的最新进展至关重要。

+   **增加知识库的文档多样性**：目前，知识库仅包含有关PINN最佳实践的文档。此外，我们可以添加其他类型的文档来丰富多样性。例如，添加PINN领域的综述论文可以使GPT为用户描绘更好的全貌；另外，添加面向应用的研究论文可以使PINN了解现实案例，从而更好地帮助用户完成任务。

+   **针对特定PINN库的编码助手**：进行PINN研究的软件正在迅速发展。因此，跟上库中的最新进展对于从业者来说变得越来越困难。一个有前途的提高生产力的方法是设计一个GPT作为代码副驾驶，软件文档作为知识库。通过这种方式，编码助手GPT可以通过自然语言交流为用户的问题提供量身定制的编码解决方案。

+   **增强定制GPT与行动**：我们尚未触及的定制GPT的另一项功能是所谓的“行动”。本质上，这些“行动”类似于“插件”，它们赋予GPT在ChatGPT之外采取行动的能力。一项近期的工作[1]探讨了利用LLM自动调用API来支持PINN软件以帮助用户完成任务的可能性。对于创建专家GPT的情况，我们也可以让专家GPT访问专业PINN软件的API，以便它可以以自主的方式执行不同类型的分析。这可以大大降低从业者利用PINN的门槛，加速PINN技术在各种现实问题中的应用。

# **4\. 总结**

在本博客中，我们探讨了创建一个专注于PINN并可以帮助从业者日常工作的定制GPT的想法（使用ChatGPT最新的GPT功能）。我们解释了创建这个定制GPT的过程，并展示了它可能比标准GPT更有利的一些场景。这些场景包括：

1.  询问具体实施问题。

1.  请求编写原型代码

1.  请求最佳实践总结

1.  询问具体概念

1.  寻找原始研究论文

1.  调试实际实施中的问题

1.  激发新的研究思路

最后，我们简要讨论了从用户体验角度进一步改进这个定制GPT的可能方式。

你可以在这里访问创建的GPT：[https://chat.openai.com/g/g-Z4YUXe3Bf-pinn-design-pattern-specialist](https://chat.openai.com/g/g-Z4YUXe3Bf-pinn-design-pattern-specialist)

希望你觉得这个博客有用🤗如果你对学习更多关于 PINN 的内容感兴趣，请查看我之前的博客：

+   [解开物理信息神经网络设计模式的奥秘](/unraveling-the-design-pattern-of-physics-informed-neural-networks-series-01-8190df459527)

+   [使用 PINN 和符号回归发现微分方程](/discovering-differential-equations-with-physics-informed-neural-networks-and-symbolic-regression-c28d279c0b4d)

+   [通过物理信息 DeepONet 进行算子学习](/operator-learning-via-physics-informed-deeponet-lets-implement-it-from-scratch-6659f3179887)

+   [通过物理信息 DeepONet 解决逆问题](/solving-inverse-problems-with-physics-informed-deeponet-a-practical-guide-with-code-implementation-27795eb4f502)

或者，如果你想查看更多大型语言模型的应用：

+   [开发用于研究论文消化的自主双聊机器人系统](/developing-an-autonomous-dual-chatbot-system-for-research-paper-digesting-ea46943e9343)

+   [当 AutoML 遇上大型语言模型](/when-automl-meets-large-language-model-756e6bb9baa7)

随时订阅我的[新闻通讯](https://shuaiguo.medium.com/subscribe)或关注我的[Medium](https://shuaiguo.medium.com/)。

期待与你分享更多令人兴奋的项目。敬请关注！

## 参考文献

[1] Kumar 等人，《MyCrunchGPT: 基于 chatGPT 的科学机器学习框架》，arXiv，2023年。

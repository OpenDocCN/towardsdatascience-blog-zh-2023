- en: Demystifying Dependence and Why it Is Important in Causal Inference and Causal
    Validation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/demystifying-dependence-and-why-it-is-important-in-causal-inference-and-causal-validation-4263b18d5f04](https://towardsdatascience.com/demystifying-dependence-and-why-it-is-important-in-causal-inference-and-causal-validation-4263b18d5f04)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A step-by-step guide in understanding the concept of dependence and how to apply
    it to validate directed acyclic graphs using Python
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://grahamharrison-86487.medium.com/?source=post_page-----4263b18d5f04--------------------------------)[![Graham
    Harrison](../Images/c6bfe00c6e0cfcdf3bd042c7fdc03554.png)](https://grahamharrison-86487.medium.com/?source=post_page-----4263b18d5f04--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4263b18d5f04--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4263b18d5f04--------------------------------)
    [Graham Harrison](https://grahamharrison-86487.medium.com/?source=post_page-----4263b18d5f04--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4263b18d5f04--------------------------------)
    Â·16 min readÂ·Nov 11, 2023
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/2acee73c46470784e1400ed88bbbe08b.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
- en: Photo by [Ana Municio](https://unsplash.com/@lamunix?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)
    on [Unsplash](https://unsplash.com/photos/gray-and-brown-stones-on-gray-ground-PbzntH58GLQ?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Causal Inference is an emergent branch of data science concerned with determining
    the cause-and-effect relationship between events and outcomes and it has the potential
    to significantly add to the value that machine learning can generate for organisations.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: For example, a traditional machine learning algorithm can predict which loan
    customers are likely to default thereby enabling proactive intervention with customers.
    However, although this algorithm will be useful to reduce loan defaults, it will
    have no concept of why they occurred and whilst pro-active intervention is useful
    knowing the reasons for defaults would enable the underlying cause to be addressed.
    In this world pro-active intervention may no longer be necessary because the factors
    that lead to defaulting have been permanently cured.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: This is the promise of Causal Inference and why it has the potential to deliver
    significant impact and outcomes to those organisations that can harness that potential.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: There are a number of different approaches but the most common approach typically
    starts by augmenting the data with a â€œDirected Acyclic Graphâ€ which encapsulates
    and visualises the causal relationships in the data and then uses causal inference
    techniques to ask â€œwhat-ifâ€ type questions.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: The Problem
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A Directed Acyclic Graph (DAG) that encapsulates the causal relationships in
    the data is typically constructed manually (or semi-manually) by data scientists
    and domain experts working together. Hence the DAG could be wrong which would
    invalidate any causal calculations leading to flawed conclusions and potentially
    incorrect decisions.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: The Opportunity
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A range of techniques exist for â€œCausal Validationâ€ (the process of validating
    the DAG against the data) and if these techniques work they can minimise or eliminate
    errors in the DAG thereby ensuring that the calculations and conclusions are error-free.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: The Way Forward
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The statistical concept of dependence between random variables can be used to
    ascertain whether a relationship that exists in the DAG also exists in the data;
    if it does exist the DAG is more likely to be correct and if not it is more likely
    to be incorrect.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: Getting Started
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We are going to need an example DAG to work through the problem which has enough
    nodes and links to enable a deep exploration of causal validation â€¦
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cd401cc91ab871411a3df74e01fef9cc.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
- en: Example DAG that will be used throughout the article â€” Image by Author
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: Each node in a DAG is either having a causal effect on other node(s) or other
    node(s) are having a causal effect on it and the direction of the arrow is the
    direction of the causal effect. For example, one of the causes of â€œBâ€ is â€œCâ€ and
    one of the causes of â€œCâ€ is â€œFâ€.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: The example DAG is fictitious hence the node letters / names are unimportant,
    however â€œXâ€ is intended to be the â€œtreatmentâ€, â€œYâ€ is the â€œeffect,â€ and all the
    other nodes are having some causal impact that would, in a real-world example,
    obscure the true effects of X on Y.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: Note that the light-blue nodes have no inputs (exogenous in causal terminology)
    and the dark-blue nodes have one or more inputs (endogenous in the terminology).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: To get started we will also need some data that matches the DAG. The dataset
    below is entirely synthetic and has been generated by the author. It exactly encapsulates
    and matches the structure suggested by the DAG and contains no erroneous or faulty
    relationships â€¦
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/23142b03ead0c51efecb36617405554e.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
- en: Synthetic, fictitious dataset that is associated with the DAG â€” Image by Author
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: Another thing we need before we can get started is a way of extending the pandas
    `DataFrame` and `Series` classes with custom methods so that the code we write
    is clean, concise and easy to understand.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: Here is a link to one of my previous articles that provides an end-to-end tutorial
    on how to extend data frames and why it is a useful thing to do â€¦
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '[](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)
    [## How to Extend Pandas DataFrames with Custom Methods to Supercharge Code Functionality
    & Readability'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: A step-by-step guide to extending pandas DataFrames with custom methods including
    full examples for implementingâ€¦
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªé€æ­¥æŒ‡å—ï¼Œä»‹ç»å¦‚ä½•é€šè¿‡è‡ªå®šä¹‰æ–¹æ³•æ‰©å±• pandas DataFramesï¼ŒåŒ…æ‹¬å®æ–½çš„å®Œæ•´ç¤ºä¾‹ â€¦
- en: towardsdatascience.com](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '[towardsdatascience.com](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)'
- en: Understanding Dependence
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç†è§£ä¾èµ–æ€§
- en: One definition of dependence is as follows â€¦
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾èµ–æ€§çš„ä¸€ä¸ªå®šä¹‰å¦‚ä¸‹ â€¦
- en: Dependence between two random variables means that the occurrence or value of
    one variable affects the occurrence or value of the other. Variables are considered
    dependent if the occurrence or value of one variable provides information about
    the occurrence or value of the other variable.
  id: totrans-36
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸¤ä¸ªéšæœºå˜é‡ä¹‹é—´çš„ä¾èµ–æ€§æ„å‘³ç€ä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–å€¼ä¼šå½±å“å¦ä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–å€¼ã€‚å¦‚æœä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–å€¼æä¾›äº†å…³äºå¦ä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–å€¼çš„ä¿¡æ¯ï¼Œåˆ™è¿™ä¸¤ä¸ªå˜é‡è¢«è®¤ä¸ºæ˜¯ç›¸å…³çš„ã€‚
- en: To unpack this, letâ€™s take another look at our example DAG and consider the
    causal factors that affect node Y â€¦
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ·±å…¥äº†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å†çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ç¤ºä¾‹ DAGï¼Œå¹¶è€ƒè™‘å½±å“èŠ‚ç‚¹ Y çš„å› æœå› ç´  â€¦
- en: '![](../Images/290380d5018508aeb10f34dcc346a75b.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/290380d5018508aeb10f34dcc346a75b.png)'
- en: DAG with causal factors affecting Y highlighted â€” Image by Author
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: çªå‡ºæ˜¾ç¤ºå½±å“ Y çš„å› æœå› ç´ çš„ DAG â€” ä½œè€…æä¾›çš„å›¾ç‰‡
- en: In this visualisation we can see that node Y is caused by (and hence dependent
    on) 5 different factors â€” C , E , F , G and X.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªå¯è§†åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°èŠ‚ç‚¹ Y æ˜¯ç”± 5 ä¸ªä¸åŒå› ç´ é€ æˆçš„ï¼ˆå› æ­¤ä¹Ÿä¾èµ–äºè¿™äº›å› ç´ ï¼‰ â€” Cã€Eã€Fã€G å’Œ Xã€‚
- en: Now lets take another look at the data that the DAG is representing â€¦
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸‹ DAG æ‰€è¡¨ç¤ºçš„æ•°æ® â€¦
- en: '![](../Images/a87ef178b3188e067c9b179e369a2885.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a87ef178b3188e067c9b179e369a2885.png)'
- en: Review of the first 5 rows of data from the df_causal DataFrame â€” Image by Author
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: df_causal DataFrame ä¸­å‰ 5 è¡Œæ•°æ®çš„å›é¡¾ â€” ä½œè€…æä¾›çš„å›¾ç‰‡
- en: This synthetic data set was created by the author to facilitate the article
    so I happen to know that the relationship between node Y and those dependent factors
    is as follows â€¦
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªåˆæˆæ•°æ®é›†æ˜¯ä½œè€…ä¸ºæ–¹ä¾¿æœ¬æ–‡åˆ›å»ºçš„ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“èŠ‚ç‚¹ Y ä¸è¿™äº›ä¾èµ–å› ç´ ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ â€¦
- en: '**Y = 3C + 3E + 2F + 2.5G + 1.5X + Îµ**'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**Y = 3C + 3E + 2F + 2.5G + 1.5X + Îµ**'
- en: '(Note: Îµ represents the error term)'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ï¼ˆæ³¨ï¼šÎµ ä»£è¡¨è¯¯å·®é¡¹ï¼‰
- en: â€¦ and this can be tested and verified by picking a row (in this case I have
    chosen the 3rd row) applying that formula to the data â€¦
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ è¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡é€‰æ‹©ä¸€è¡Œï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘é€‰æ‹©äº†ç¬¬ 3 è¡Œï¼‰å¹¶å°†è¯¥å…¬å¼åº”ç”¨äºæ•°æ®æ¥æµ‹è¯•å’ŒéªŒè¯ â€¦
- en: '[PRE0]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We can now see why and how Y is dependent on C, E, F, G and X. If the value
    of one of those dependent variables changes, the value of Y will also change.
    We can also see from the DAG that Y should not be dependent (for example) on node
    D because there is no link between D and Y.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Y å¦‚ä½•ä»¥åŠä¸ºä½•ä¾èµ–äº Cã€Eã€Fã€G å’Œ Xã€‚å¦‚æœè¿™äº›ä¾èµ–å˜é‡ä¸­çš„ä¸€ä¸ªå€¼å‘ç”Ÿå˜åŒ–ï¼ŒY çš„å€¼ä¹Ÿä¼šå˜åŒ–ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä» DAG ä¸­çœ‹åˆ° Y
    ä¸åº”ä¾èµ–ï¼ˆä¾‹å¦‚ï¼‰èŠ‚ç‚¹ Dï¼Œå› ä¸º D å’Œ Y ä¹‹é—´æ²¡æœ‰è¿æ¥ã€‚
- en: The statement â€œY is dependent on C, E, F, G and Xâ€ can be represented in a mathematical
    formula as follows â€¦
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: â€œY ä¾èµ–äº Cã€Eã€Fã€G å’Œ Xâ€ çš„è¡¨è¿°å¯ä»¥ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºå¦‚ä¸‹ â€¦
- en: '![](../Images/a94fa5224968e1d531aa8cde4caa2c17.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a94fa5224968e1d531aa8cde4caa2c17.png)'
- en: Image by Author
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: â€¦ and the statement â€œY is independent of Dâ€ is represented as follows â€¦
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ ä»¥åŠâ€œY ä¸ D ç‹¬ç«‹â€ çš„è¡¨è¿°å¦‚ä¸‹ â€¦
- en: '![](../Images/04b9fcfec170531347cc5aa88c9d4409.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/04b9fcfec170531347cc5aa88c9d4409.png)'
- en: Image by Author
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: The â«« symbol is called a â€œdouble up-tackâ€ but the â««Ì¸ symbol does not have a
    commonly accepted name so I have adopted â€œslashed double up-tackâ€ through personal
    preference.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: â«« ç¬¦å·è¢«ç§°ä¸ºâ€œåŒå‘äº¤å‰ç¬¦å·â€ï¼Œä½† â««Ì¸ ç¬¦å·æ²¡æœ‰ä¸€ä¸ªæ™®éæ¥å—çš„åç§°ï¼Œæ‰€ä»¥æˆ‘ä¸ªäººä¹ æƒ¯ç§°ä¹‹ä¸ºâ€œæ–œæ åŒå‘äº¤å‰ç¬¦å·â€ã€‚
- en: Some articles and texts use a single up-tack (âŠ¥ and âŠ¥Ì¸) instead of double up-tacks
    but double up-tacks are more common hence that is the standard that I have adopted
    and used throughout this article and the associated Python code.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€äº›æ–‡ç« å’Œæ–‡æœ¬ä½¿ç”¨å•å‘äº¤å‰ç¬¦å·ï¼ˆâŠ¥ å’Œ âŠ¥Ì¸ï¼‰ä»£æ›¿åŒå‘äº¤å‰ç¬¦å·ï¼Œä½†åŒå‘äº¤å‰ç¬¦å·æ›´ä¸ºå¸¸è§ï¼Œå› æ­¤è¿™æ˜¯æˆ‘åœ¨æœ¬æ–‡åŠç›¸å…³ Python ä»£ç ä¸­é‡‡ç”¨çš„æ ‡å‡†ã€‚
- en: To recap then, statistical dependence between two random variables means that
    â€œthe occurrence or value of one variable affects the occurrence or value of the
    otherâ€ and we now know how this looks visually in the DAG, how to represent it
    as a mathematical formula (e.g. **Y = 3C + 3E + 2F + 2.5G + 1.5X + Îµ**) and also
    how to represent it using the slashed double up-tack notation (e.g. Y â««Ì¸ C, E,
    F, G, X).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: å›é¡¾ä¸€ä¸‹ï¼Œä¸¤ä¸ªéšæœºå˜é‡ä¹‹é—´çš„ç»Ÿè®¡ä¾èµ–æ„å‘³ç€â€œä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–æ•°å€¼å½±å“å¦ä¸€ä¸ªå˜é‡çš„å‘ç”Ÿæˆ–æ•°å€¼â€ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“è¿™åœ¨DAGä¸­æ˜¯å¦‚ä½•å¯è§†åŒ–çš„ï¼Œå¦‚ä½•ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºï¼ˆä¾‹å¦‚**Y
    = 3C + 3E + 2F + 2.5G + 1.5X + Îµ**ï¼‰ï¼Œä»¥åŠå¦‚ä½•ç”¨æ–œæ åŒå‘ç®­å¤´ç¬¦å·è¡¨ç¤ºï¼ˆä¾‹å¦‚Y â««Ì¸ Cã€Eã€Fã€Gã€Xï¼‰ã€‚
- en: From Dependence to Causal Validation
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»ä¾èµ–å…³ç³»åˆ°å› æœéªŒè¯
- en: Causal Inference typically starts with a set of data and then augments that
    data with a DAG. There are emerging techniques that can reverse engineer a DAG
    from the data but they are not accurate or consistent hence the most common approach
    to developing a DAG is to ask the domain experts what they think the causal relationships
    are and then to validate or test that DAG against the data and amend it as necessary
    if validation fails.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: å› æœæ¨æ–­é€šå¸¸ä»ä¸€ç»„æ•°æ®å¼€å§‹ï¼Œç„¶åç”¨DAGæ‰©å……è¿™äº›æ•°æ®ã€‚è™½ç„¶æœ‰äº›æ–°å…´æŠ€æœ¯å¯ä»¥ä»æ•°æ®ä¸­åå‘å·¥ç¨‹ç”ŸæˆDAGï¼Œä½†å®ƒä»¬å¹¶ä¸å‡†ç¡®æˆ–ä¸€è‡´ï¼Œå› æ­¤å¼€å‘DAGçš„æœ€å¸¸è§æ–¹æ³•æ˜¯è¯¢é—®é¢†åŸŸä¸“å®¶ä»–ä»¬è®¤ä¸ºçš„å› æœå…³ç³»ï¼Œç„¶åéªŒè¯æˆ–æµ‹è¯•è¯¥DAGæ˜¯å¦ç¬¦åˆæ•°æ®ï¼Œå¹¶åœ¨éªŒè¯å¤±è´¥æ—¶è¿›è¡Œå¿…è¦çš„ä¿®æ­£ã€‚
- en: The DAG has proposed that Y is dependent on C, E, F, G and X and if this dependency
    exists in the data then there will be confidence that the causal links pointing
    into node Y are valid and correct and there is a mathematical notation that can
    be used to represent this as follows â€¦
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: DAGå·²ç»æå‡ºYä¾èµ–äºCã€Eã€Fã€Gå’ŒXï¼Œå¦‚æœè¿™ç§ä¾èµ–åœ¨æ•°æ®ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®ä¿¡æŒ‡å‘èŠ‚ç‚¹Yçš„å› æœé“¾æ¥æ˜¯æœ‰æ•ˆå’Œæ­£ç¡®çš„ï¼Œå¹¶ä¸”å¯ä»¥ç”¨å¦‚ä¸‹æ•°å­¦ç¬¦å·è¡¨ç¤ºâ€¦â€¦
- en: '![](../Images/7d1be63d07a51c7371b0adc52771cd4a.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7d1be63d07a51c7371b0adc52771cd4a.png)'
- en: Image by Author
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: This scary-looking formula is actually very simple to understand. The â€œGâ€ subscript
    of the first slashed double up-tack dependency symbol means â€œin the graphâ€ (i.e.
    the DAG) and the second â€œDâ€ subscript means â€œin the dataâ€ (note that I have seen
    a â€œPâ€ subscript in some of the literature but â€œDâ€ makes more sense to me so that
    is what I have adopted).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªçœ‹èµ·æ¥å“äººçš„å…¬å¼å…¶å®éå¸¸å®¹æ˜“ç†è§£ã€‚ç¬¬ä¸€ä¸ªæ–œæ åŒå‘ç®­å¤´ç¬¦å·çš„â€œGâ€ä¸‹æ ‡è¡¨ç¤ºâ€œåœ¨å›¾ä¸­â€ï¼ˆå³DAGï¼‰ï¼Œè€Œç¬¬äºŒä¸ªâ€œDâ€ä¸‹æ ‡è¡¨ç¤ºâ€œåœ¨æ•°æ®ä¸­â€ï¼ˆæ³¨æ„ï¼Œæˆ‘è§è¿‡ä¸€äº›æ–‡çŒ®ä¸­ä½¿ç”¨â€œPâ€ä¸‹æ ‡ï¼Œä½†â€œDâ€å¯¹æˆ‘æ¥è¯´æ›´æœ‰æ„ä¹‰ï¼Œå› æ­¤æˆ‘é‡‡ç”¨äº†â€œDâ€ï¼‰ã€‚
- en: Armed with that knowledge, the whole formula can be read as â€œIf Y is dependent
    on C, E, F, G and X in the graph then Y should also be dependent on C, E, F, G
    and X in the data.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: å…·å¤‡è¿™äº›çŸ¥è¯†åï¼Œæ•´ä¸ªå…¬å¼å¯ä»¥è¢«è§£è¯»ä¸ºâ€œå¦‚æœå›¾ä¸­çš„Yä¾èµ–äºCã€Eã€Fã€Gå’ŒXï¼Œé‚£ä¹ˆYåœ¨æ•°æ®ä¸­ä¹Ÿåº”è¯¥ä¾èµ–äºCã€Eã€Fã€Gå’ŒXâ€ã€‚
- en: It follows then that we just need a mechanism in Python that can detect dependencies
    in the data. That mechanism can then be used to check each node in the DAG that
    has in-coming connections and if dependencies are detected in the data that match
    those in the DAG we can be reasonably confident that there are no spurious connections
    (causal links) and that the DAG is a valid representation of the data in this
    respect.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªPythonæœºåˆ¶æ¥æ£€æµ‹æ•°æ®ä¸­çš„ä¾èµ–å…³ç³»ã€‚ç„¶åå¯ä»¥ä½¿ç”¨è¯¥æœºåˆ¶æ£€æŸ¥DAGä¸­å…·æœ‰ä¼ å…¥è¿æ¥çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœåœ¨æ•°æ®ä¸­æ£€æµ‹åˆ°çš„ä¾èµ–å…³ç³»ä¸DAGä¸­çš„åŒ¹é…ï¼Œæˆ‘ä»¬å¯ä»¥åˆç†åœ°ç¡®ä¿¡æ²¡æœ‰è™šå‡çš„è¿æ¥ï¼ˆå› æœé“¾æ¥ï¼‰ï¼Œå¹¶ä¸”DAGåœ¨è¿™æ–¹é¢æ˜¯æ•°æ®çš„æœ‰æ•ˆè¡¨ç¤ºã€‚
- en: Observing Dependence in the Data
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è§‚å¯Ÿæ•°æ®ä¸­çš„ä¾èµ–å…³ç³»
- en: Letâ€™s start by visualising the relationships that exist in the data between
    C, E, F, G and X and our node of interest Y â€¦
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¼€å§‹å¯è§†åŒ–æ•°æ®ä¸­Cã€Eã€Fã€Gå’ŒXä¸æˆ‘ä»¬å…³æ³¨çš„èŠ‚ç‚¹Yä¹‹é—´çš„å…³ç³»â€¦â€¦
- en: '![](../Images/5f5c35ed6754ce4e6677ada75543ef7f.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5f5c35ed6754ce4e6677ada75543ef7f.png)'
- en: Image by Author
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: The chart on the right is plotting Y on the x axis and separate lines for C,
    E, F, G and X on the y axis. If Y is dependent on these other variables then changing
    the value of one of them should change the value of Y. This means that there should
    be a positive or negative co-efficient and the lines should exhibit a noticeable
    slope (either upwards or downwards).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: å³ä¾§çš„å›¾è¡¨å°†Yç»˜åˆ¶åœ¨xè½´ä¸Šï¼Œå°†Cã€Eã€Fã€Gå’ŒXåˆ†åˆ«ç»˜åˆ¶åœ¨yè½´ä¸Šã€‚å¦‚æœYä¾èµ–äºè¿™äº›å…¶ä»–å˜é‡ï¼Œé‚£ä¹ˆæ”¹å˜å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å€¼åº”è¯¥ä¼šæ”¹å˜Yçš„å€¼ã€‚è¿™æ„å‘³ç€åº”è¯¥å­˜åœ¨ä¸€ä¸ªæ­£æˆ–è´Ÿçš„ç³»æ•°ï¼Œå¹¶ä¸”è¿™äº›çº¿åº”è¯¥è¡¨ç°å‡ºæ˜æ˜¾çš„æ–œç‡ï¼ˆå‘ä¸Šæˆ–å‘ä¸‹ï¼‰ã€‚
- en: Given that there are definite slopes we can see that ğ‘Œâ««Ì¸ ğ¶,ğ¸,ğ¹,ğº,ğ‘‹ is true i.e.
    that Y is dependent on C, E, F, G and X **in the data**.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºå­˜åœ¨æ˜ç¡®çš„æ–œç‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ğ‘Œâ««Ì¸ ğ¶,ğ¸,ğ¹,ğº,ğ‘‹æ˜¯æ­£ç¡®çš„ï¼Œå³Yåœ¨æ•°æ®ä¸­ä¾èµ–äºCã€Eã€Fã€Gå’ŒX**ã€‚
- en: If however there is no dependence then changing the value of a variable would
    have little or no effect on Y, the co-efficient should be close to zero and the
    line should have no slope i.e. it should be flat.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: This can be demonstrated by adding the relationship between Y and D to the chart
    remembering that there is no causal link from D to Y in the DAG so there should
    be no relationship between Y and D in the data either â€¦
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/29419ca82d443e6ace8f4bfb53ad7158.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: This is looking exactly how we would expect it. C, E, F, G and X all have clear
    slopes and either a negative or positive co-efficient clearly showing that if
    the value of those variables changes, the value of Y will be changed so Y is dependent
    on those variables.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: However the slope for D is flat and the co-efficient is very small (just -0.029)
    so changing the value of D will have a negligible effect on the value of Y and
    hence the causal relationship ğ‘Œâ««ğ· (Y is independent of D) exists in the data.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: Implementing Dependency in the Data in Python
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The proposed method for detecting dependencies in the data uses the ols class
    from the statsmodels.formula.api library to perform an ordinary least squares
    (OLS) regression.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: The ols class can be fitted to a data set and the the coefficients or slopes
    that exist in the data can be extracted and interpreted. Here is how it is done
    â€¦
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b7e7c7a721ec0164576975dd169b8a0b.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: The key data in the summary is the middle table which provides some analysis
    of the variables C, E, F, G and X in respect of their relationship with Y. For
    example the ols analysis is proposing the following -
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: ğ‘Œ=2.03ğ¶+3.02ğ¸+1.84ğ¹+6.33ğº+1.54ğ‘‹âˆ’25.2
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: and this is not too far away from the formula that I used to create the dataset
    which was â€¦
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: ğ‘Œ=3ğ¶+3ğ¸+2ğ¹+2.5ğº+1.5ğ‘‹+Îµ
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: The biggest difference is for node G but for the purposes of validation the
    magnitude of the co-efficient is not really important, just that a coefficient
    exists and that the slope is not flat.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: Apart from the `coef` column the other item of interest is the `P>|t|` or p-value
    column which works as follows ...
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: The null hypothesis is that there is no relationship between the variable (e.g.
    E) and the dependent variable (e.g. Y)
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the p-value is greater than the alpha (usually set at 0.05) then the null
    hypothesis is rejected i.e. there is a relationship i.e. there is dependence.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For example the p-values for E, G and X are all below 0.05 so the null hypothesis
    can be rejected and dependence can be assumed.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: But what about C ad F? C has a p-value of 0.076 which is slightly above alpha
    and F has a value if 0.275 which is significantly above our chosen alpha (0.05).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: We could just increase alpha until we conclude that all of the variables are
    dependent but that approach will not work very well in the long run as it will
    start concluding dependence where none exists.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: When I did the original development I almost gave up at this point assuming
    that ols could not be used as a reliable method to detect dependence across my
    DAGs and data but then I took another look at the ols analysis.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘è¿›è¡Œæœ€åˆå¼€å‘æ—¶ï¼Œæˆ‘å‡ ä¹åœ¨è¿™ä¸€ç‚¹ä¸Šæ”¾å¼ƒäº†ï¼Œè®¤ä¸ºolsä¸èƒ½ä½œä¸ºæ£€æµ‹æˆ‘çš„DAGå’Œæ•°æ®ä¸­ä¾èµ–å…³ç³»çš„å¯é æ–¹æ³•ï¼Œä½†éšåæˆ‘é‡æ–°å®¡è§†äº†olsåˆ†æã€‚
- en: A co-efficient can be observed for all 5 variables, but the p-value is conclusive
    in only 3 out of the 5\. I then swapped to using the `coef` but further on down
    the line I found instances where the p-value worked but the `coef` did not.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹æ‰€æœ‰5ä¸ªå˜é‡å¯ä»¥è§‚å¯Ÿåˆ°ç³»æ•°ï¼Œä½†på€¼ä»…åœ¨5ä¸ªä¸­çš„3ä¸ªä¸Šå…·æœ‰å†³å®šæ€§ã€‚æˆ‘éšåè½¬è€Œä½¿ç”¨`coef`ï¼Œä½†åœ¨åç»­çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°på€¼æœ‰æ•ˆè€Œ`coef`æ— æ•ˆçš„æƒ…å†µã€‚
- en: After many frustrating hours and a lot of trial-and-error I came established
    a method which uses both values and that exhibits a high degree of accuracy that
    has been rigorously tested against a lot of different data and DAGs.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ç»å†äº†è®¸å¤šä»¤äººæ²®ä¸§çš„å°æ—¶å’Œå¤§é‡çš„åå¤è¯•éªŒåï¼Œæˆ‘å»ºç«‹äº†ä¸€ç§æ–¹æ³•ï¼Œå®ƒç»“åˆäº†ä¸¤ä¸ªå€¼ï¼Œå¹¶ä¸”å±•ç°å‡ºé«˜åº¦çš„å‡†ç¡®æ€§ï¼Œç»ä¸¥æ ¼æµ‹è¯•å¯¹æ¯”äº†å¤§é‡ä¸åŒçš„æ•°æ®å’ŒDAGã€‚
- en: Here is the method that I use to detect dependency â€¦
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ç”¨æ¥æ£€æµ‹ä¾èµ–å…³ç³»çš„æ–¹æ³•â€¦
- en: '[PRE1]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The test I have adopted through trial and error is as follows â€¦
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘é€šè¿‡åå¤è¯•éªŒé‡‡ç”¨çš„æµ‹è¯•æ–¹æ³•å¦‚ä¸‹â€¦
- en: If the p-value is greater than 0.05 AND the co-efficient is less than or equal
    to 1.0 then assume no dependency, otherwise assume dependency.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœpå€¼å¤§äº0.05ä¸”ç³»æ•°å°äºæˆ–ç­‰äº1.0ï¼Œåˆ™å‡å®šæ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå¦åˆ™å‡å®šå­˜åœ¨ä¾èµ–å…³ç³»ã€‚
- en: This approach does not follow the statistical approach which would be just to
    consider the p-value in isolation but a significant amount of testing has suggested
    that it works very reliably.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æ–¹æ³•å¹¶ä¸éµå¾ªç»Ÿè®¡æ–¹æ³•ï¼Œä»…ä»…è€ƒè™‘på€¼ï¼Œä½†å¤§é‡æµ‹è¯•è¡¨æ˜å®ƒéå¸¸å¯é ã€‚
- en: Optimising the Python Code
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä¼˜åŒ–Pythonä»£ç 
- en: One drawback with the approach above is that the formula is embedded in the
    code i.e. in `ols_formula = "Y ~ C + E + F + G + X"` and also in the declarations
    of `dependent_variable` and `variables` and this will lead to code repetition
    in a real-world example.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šè¿°æ–¹æ³•çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å…¬å¼åµŒå…¥åœ¨ä»£ç ä¸­ï¼Œå³åœ¨`ols_formula = "Y ~ C + E + F + G + X"`ä»¥åŠ`dependent_variable`å’Œ`variables`çš„å£°æ˜ä¸­ï¼Œè¿™ä¼šåœ¨å®é™…ç¤ºä¾‹ä¸­å¯¼è‡´ä»£ç é‡å¤ã€‚
- en: It would be much better if a way could be found to extend the `DataFrame` class
    to be able to perform dependency tests generically on any dataset.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœèƒ½æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥æ‰©å±•`DataFrame`ç±»ï¼Œä»¥ä¾¿èƒ½åœ¨ä»»ä½•æ•°æ®é›†ä¸Šé€šç”¨åœ°è¿›è¡Œä¾èµ–æ€§æµ‹è¯•ï¼Œé‚£å°†ä¼šæ›´å¥½ã€‚
- en: Fortunately it is easy to add custom methods to the `DataFrame` class by using
    a technique called "monkey patching". If you would like a step-by-step tutorial
    please take a look at my tutorial article ...
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¸è¿çš„æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨ä¸€ç§ç§°ä¸ºâ€œçŒ´å­è¡¥ä¸â€çš„æŠ€æœ¯ï¼Œå‘`DataFrame`ç±»æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•éå¸¸ç®€å•ã€‚å¦‚æœä½ æƒ³è¦é€æ­¥æ•™ç¨‹ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„æ•™ç¨‹æ–‡ç« â€¦
- en: '[](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)
    [## How to Extend Pandas DataFrames with Custom Methods to Supercharge Code Functionality
    & Readability'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)
    [## å¦‚ä½•æ‰©å±•Pandas DataFramesä»¥å¢å¼ºä»£ç åŠŸèƒ½æ€§å’Œå¯è¯»æ€§'
- en: A step-by-step guide to extending pandas DataFrames with custom methods including
    full examples for implementingâ€¦
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä¸€æ­¥æ­¥æ‰©å±•pandas DataFramesçš„è‡ªå®šä¹‰æ–¹æ³•çš„æŒ‡å—ï¼ŒåŒ…æ‹¬å®ç°çš„å®Œæ•´ç¤ºä¾‹â€¦
- en: towardsdatascience.com](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '[towardsdatascience.com](/how-to-extend-pandas-dataframes-with-custom-methods-to-supercharge-code-functionality-readability-f4ae983ad715?source=post_page-----4263b18d5f04--------------------------------)'
- en: Here is the optimised code that enables any dependency test to be executed against
    any dataset â€¦
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¼˜åŒ–åçš„ä»£ç ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä»»ä½•æ•°æ®é›†ä¸Šæ‰§è¡Œä»»ä½•ä¾èµ–æ€§æµ‹è¯•â€¦
- en: Once the `DataFrame` class has been extended with the `dependence` method, it
    is trivially easy to test any dependency test.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦`DataFrame`ç±»æ‰©å±•äº†`dependence`æ–¹æ³•ï¼Œæµ‹è¯•ä»»ä½•ä¾èµ–æ€§æµ‹è¯•å°†å˜å¾—éå¸¸ç®€å•ã€‚
- en: For example, we can try out ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹ which should validate as `True` with
    no errors ...
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹ï¼Œè¿™åº”è¯¥éªŒè¯ä¸º`True`ä¸”æ²¡æœ‰é”™è¯¯â€¦
- en: '![](../Images/45d9d09bd277f3fffb2a4a67b27e5075.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/45d9d09bd277f3fffb2a4a67b27e5075.png)'
- en: Image by Author
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: We can try out ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹,ğ· which should validate as `False` indicating that
    "D" is an error because Y is not dependent on it ...
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å°è¯•ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹,ğ·ï¼Œè¿™åº”è¯¥éªŒè¯ä¸º`False`ï¼Œè¡¨ç¤º"D"æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºYä¸ä¾èµ–äºå®ƒâ€¦
- en: '![](../Images/d473cc439c247524f601e2832e64bba9.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d473cc439c247524f601e2832e64bba9.png)'
- en: Image by Author
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: These tests both pass and the success rate is very high across all of the DAGs
    and datasets I have tried out to ascertain the accuracy of this approach.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: Bringing it All Together
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To summarise, the relatively small code-base presented above achieves an impressive
    outcome i.e. to enable any dependency test to be carried out on any dataset to
    indicate whether that test passes or not and where it fails to specifically highlight
    the errors.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: However, more is needed. Letâ€™s assume that when we consulted our domain experts
    the DAG they produced contained an error and that those experts had assumed that
    a causal link (or dependency) existed from node D to node Y.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: The proposed DAG would now look like this â€¦
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/22a4b93964ccce5e5112f983fcfb1719.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: Armed with our new capability we can easily test the DAG out for node Y as follows
    â€¦
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: â€¦ and as we have seen in the results above node â€œDâ€ will be accurately identified
    as an â€œerrorâ€. We have therefore identified a â€œspurious edgeâ€ i.e. a link that
    exists in the DAG but that does not exist in the data and this tells us that the
    DAG must be adjusted to removed that spurious edge in order to be accurate.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: It therefore follows that the following must hold â€¦
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: Start with a proposed DAG.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Iterate over all nodes.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Execute a dependency test for all incoming connections.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Accumulate a list of all errors.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The accumulated list of errors will instantly indicate all spurious edges /
    connections / dependencies which must be removed from the proposed DAG to produce
    a new DAG that is free of all spurious edges (i.e. dependencies that exist in
    the DAG but not in the data).
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: The code to achieve this is as follows â€¦
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: Testing the Full Algorithm to Detect Spurious Edges in the DAG
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With these few lines of code it is now possible to test any DAG (represented
    by a set of edges) against any data (represented by a pandas `DataFrame`) to see
    if there are any "spurious" edges in the DAG that do not exist in the data.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: Letâ€™s start by testing the case where the DAG correctly represents all of the
    causal links in the data (remembering that `df_causal` correctly represents the
    DAG as it was synthetically created by the author to be an exact representation)
    ...
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: No errors were detected where the DAG matches the data.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: Now letâ€™s add a non-existent causal link D => Y into our DAG and re-run the
    code â€¦
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/22a4b93964ccce5e5112f983fcfb1719.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The â€œspuriousâ€ edge was correctly identified in the DAG! But what about when
    there are multiple spurious causal relationships in the DAG that do not exist
    in the data? Will our algorithm still perform?
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: To test this out a second non-existent causal link A => E is added to the DAG
    â€¦
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/73746a399cf9cbe55e900a81eb48321f.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This test has also passed. If two spurious causal relationships are added to
    the DAG that do not exist in the data they are both correctly detected and identified
    as errors.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: Testing the Algorithm to Destruction
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: These promising results give rise to the question â€œSo, just how accurate is
    this methods?â€ i.e. how many spurious causal relationships can continue to be
    added to the DAG before it fails to detect them correctly.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æœ‰å¸Œæœ›çš„ç»“æœå¼•å‘äº†ä¸€ä¸ªé—®é¢˜ï¼šâ€œé‚£ä¹ˆï¼Œè¿™ç§æ–¹æ³•åˆ°åº•æœ‰å¤šå‡†ç¡®ï¼Ÿâ€å³åœ¨ DAG ä¸­å¯ä»¥ç»§ç»­æ·»åŠ å¤šå°‘è™šå‡å› æœå…³ç³»è€Œä¸è¢«æ­£ç¡®æ£€æµ‹åˆ°ã€‚
- en: To answer this questions the author devised a challenging test that started
    by identifying every single valid causal link that could exist in the DAG but
    that does not. In the case of this particular DAG the full set of possible links
    looks like this â€¦
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å›ç­”è¿™äº›é—®é¢˜ï¼Œä½œè€…è®¾è®¡äº†ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„æµ‹è¯•ï¼Œé¦–å…ˆè¯†åˆ« DAG ä¸­æ¯ä¸€ä¸ªå¯èƒ½å­˜åœ¨ä½†å®é™…ä¸Šä¸å­˜åœ¨çš„æœ‰æ•ˆå› æœé“¾æ¥ã€‚å¯¹äºè¿™ä¸ªç‰¹å®šçš„ DAGï¼Œæ‰€æœ‰å¯èƒ½é“¾æ¥çš„å®Œæ•´é›†åˆå¦‚ä¸‹â€¦â€¦
- en: '![](../Images/803272ebb3328bbd0dba172ff00f907b.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/803272ebb3328bbd0dba172ff00f907b.png)'
- en: Image by Author
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: A test harness was then used to randomly select any 3 of the possible missing
    links at the same time, and to repeat that test for different sets in order to
    ascertain the accuracy of the validation algorithm.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: éšåï¼Œä½¿ç”¨æµ‹è¯•å·¥å…·éšæœºé€‰æ‹©ä»»ä½• 3 ä¸ªå¯èƒ½ç¼ºå¤±çš„é“¾æ¥ï¼ŒåŒæ—¶é‡å¤æµ‹è¯•ä¸åŒçš„é›†åˆï¼Œä»¥ç¡®å®šéªŒè¯ç®—æ³•çš„å‡†ç¡®æ€§ã€‚
- en: The results are astounding. The simple algorithm presented here detects any
    combination of 3 spurious links (using the example DAG and data) with 100% accuracy.
    Even changing the test to select any 12 of the possible spurious links together
    produces an accuracy of 90%!
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æœä»¤äººéœ‡æƒŠã€‚è¿™é‡Œæå‡ºçš„ç®€å•ç®—æ³•èƒ½å¤Ÿä»¥ 100% çš„å‡†ç¡®ç‡æ£€æµ‹ä»»ä½• 3 ä¸ªè™šå‡é“¾æ¥çš„ç»„åˆï¼ˆä½¿ç”¨ç¤ºä¾‹ DAG å’Œæ•°æ®ï¼‰ã€‚å³ä¾¿å°†æµ‹è¯•æ”¹ä¸ºé€‰æ‹©ä»»ä½• 12 ä¸ªå¯èƒ½çš„è™šå‡é“¾æ¥ï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°
    90% çš„å‡†ç¡®ç‡ï¼
- en: 'Bonus Section: Separate vs. Combined Dependency Testing'
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: é™„å½•éƒ¨åˆ†ï¼šåˆ†å¼€ä¸ç»„åˆä¾èµ–æµ‹è¯•
- en: Throughout the article the set of dependencies for a given node has been established
    by looking at all of the â€œparentâ€ nodes and then creating a single statement of
    dependences, for example â€¦
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ•´ç¯‡æ–‡ç« ä¸­ï¼Œé€šè¿‡æŸ¥çœ‹æ‰€æœ‰çš„â€œçˆ¶â€èŠ‚ç‚¹æ¥å»ºç«‹ç»™å®šèŠ‚ç‚¹çš„ä¾èµ–é›†åˆï¼Œç„¶ååˆ›å»ºä¸€ä¸ªä¾èµ–å£°æ˜ï¼Œä¾‹å¦‚â€¦â€¦
- en: '![](../Images/a94fa5224968e1d531aa8cde4caa2c17.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a94fa5224968e1d531aa8cde4caa2c17.png)'
- en: Image by Author
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: You may be wondering if the same set of tests are equivalent â€¦
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ç›¸åŒçš„æµ‹è¯•é›†æ˜¯å¦ç­‰æ•ˆâ€¦â€¦
- en: '![](../Images/d4b3396d6463ee1d91826993c5af3e17.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d4b3396d6463ee1d91826993c5af3e17.png)'
- en: Image by Author
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…æä¾›çš„å›¾ç‰‡
- en: One of the challenges the author faced was to assume that these separate tests
    are equivalent to the single overall test when detecting spurious edges but trial-and-error
    during testing led to the firm conclusion that this is not the case.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…é¢ä¸´çš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯å‡è®¾è¿™äº›å•ç‹¬çš„æµ‹è¯•ç­‰åŒäºæ£€æµ‹è™šå‡è¾¹çš„å•ä¸ªæ•´ä½“æµ‹è¯•ï¼Œä½†æµ‹è¯•ä¸­çš„è¯•é”™è¿‡ç¨‹å¾—å‡ºäº†æ˜ç¡®ç»“è®ºï¼Œå³æƒ…å†µå¹¶éå¦‚æ­¤ã€‚
- en: When looking for the spurious edge Y => D the implementing the ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹,ğ·
    test was 100% reliable but testing separately for ğ‘Œâ««Ì¸ğ· does not work and this
    was proven by executing many rounds of automated testing to compare the accuracy
    of the two methods.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¯»æ‰¾è™šå‡è¾¹ Y => D æ—¶ï¼Œå®ç° ğ‘Œâ««Ì¸ğ¶,ğ¸,ğ¹,ğº,ğ‘‹,ğ· æµ‹è¯•æ˜¯ 100% å¯é çš„ï¼Œä½†å•ç‹¬æµ‹è¯• ğ‘Œâ««Ì¸ğ· ä¸èµ·ä½œç”¨ï¼Œè¿™é€šè¿‡æ‰§è¡Œå¤šè½®è‡ªåŠ¨åŒ–æµ‹è¯•æ¥æ¯”è¾ƒè¿™ä¸¤ç§æ–¹æ³•çš„å‡†ç¡®æ€§å¾—åˆ°äº†è¯æ˜ã€‚
- en: The assumption is that because the formula that encapsulates the relationships
    between these variables is **ğ‘Œ = 3ğ¶ + 3ğ¸ + 2ğ¹ + 2.5ğº + 1.5ğ‘‹ + Îµ** the OLS test
    which underpins the implementation of dependency needs to consider all of the
    variables together and this also bears out another truism in causal inference
    â€¦
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æ˜¯å› ä¸ºå°è£…è¿™äº›å˜é‡ä¹‹é—´å…³ç³»çš„å…¬å¼æ˜¯**ğ‘Œ = 3ğ¶ + 3ğ¸ + 2ğ¹ + 2.5ğº + 1.5ğ‘‹ + Îµ**ï¼Œå®ç°ä¾èµ–çš„ OLS æµ‹è¯•éœ€è¦è€ƒè™‘æ‰€æœ‰å˜é‡åœ¨ä¸€èµ·ï¼Œè¿™ä¹ŸéªŒè¯äº†å› æœæ¨æ–­ä¸­çš„å¦ä¸€ä¸ªçœŸç†â€¦â€¦
- en: '**it is very difficult or maybe even impossible to reverse engineer a DAG from
    the data but when a â€œfirst stabâ€ has been made that gets most of the way there
    the task becomes achievable**'
  id: totrans-166
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**ä»æ•°æ®ä¸­é€†å‘å·¥ç¨‹ä¸€ä¸ª DAG æ˜¯éå¸¸å›°éš¾ç”šè‡³å¯èƒ½ä¸å¯èƒ½ï¼Œä½†å½“è¿›è¡Œâ€œåˆæ­¥å°è¯•â€å¹¶æ¥è¿‘ç›®æ ‡æ—¶ï¼Œä»»åŠ¡å˜å¾—å¯å®ç°**'
- en: 'The morale of this section is: consider all of the incoming relationships for
    each node together when testing for dependency because if they are tested separately
    it simply does not work.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬èŠ‚çš„è¦ç‚¹æ˜¯ï¼šåœ¨æµ‹è¯•ä¾èµ–å…³ç³»æ—¶ï¼Œè€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰è¾“å…¥å…³ç³»ï¼Œå› ä¸ºå¦‚æœå•ç‹¬æµ‹è¯•ï¼Œå®ƒæ ¹æœ¬ä¸èµ·ä½œç”¨ã€‚
- en: Connect and Get in Touch â€¦
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è¿æ¥å¹¶ä¿æŒè”ç³»â€¦â€¦
- en: If you enjoyed this article, you can get unlimited access to thousands more
    by becoming a Medium member for just $5 a month by [clicking on my referral link](https://grahamharrison-86487.medium.com/membership)
    (I will receive a proportion of the fees if you sign up using this link at no
    extra cost to you).
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥é€šè¿‡æˆä¸º Medium ä¼šå‘˜ï¼Œæ¯æœˆä»…éœ€ 5 ç¾å…ƒï¼Œå³å¯æ— é™è®¿é—®æ›´å¤šå†…å®¹ï¼Œç‚¹å‡»[æˆ‘çš„æ¨èé“¾æ¥](https://grahamharrison-86487.medium.com/membership)ï¼ˆå¦‚æœä½ é€šè¿‡æ­¤é“¾æ¥æ³¨å†Œï¼Œæˆ‘å°†è·å¾—è´¹ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸”å¯¹ä½ æ²¡æœ‰é¢å¤–è´¹ç”¨ï¼‰ã€‚
- en: '[](https://grahamharrison-86487.medium.com/membership?source=post_page-----4263b18d5f04--------------------------------)
    [## Join Medium with my referral link - Graham Harrison'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://grahamharrison-86487.medium.com/membership?source=post_page-----4263b18d5f04--------------------------------)
    [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium - Graham Harrison'
- en: As a Medium member, a portion of your membership fee goes to writers you read,
    and you get full access to every storyâ€¦
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½œä¸º Medium ä¼šå‘˜ï¼Œä½ çš„ä¼šå‘˜è´¹ç”¨çš„ä¸€éƒ¨åˆ†å°†ä¼šæµå‘ä½ é˜…è¯»çš„ä½œè€…ï¼Œä½ å¯ä»¥å…¨é¢è®¿é—®æ‰€æœ‰æ•…äº‹â€¦
- en: grahamharrison-86487.medium.com](https://grahamharrison-86487.medium.com/membership?source=post_page-----4263b18d5f04--------------------------------)
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: grahamharrison-86487.medium.com](https://grahamharrison-86487.medium.com/membership?source=post_page-----4263b18d5f04--------------------------------)
- en: â€¦ or connect by â€¦
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ æˆ–è€…é€šè¿‡ â€¦ è¿æ¥
- en: '[Subscribing to a free e-mail whenever I publish a new story](https://grahamharrison-86487.medium.com/subscribe).'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '[è®¢é˜…æˆ‘çš„å…è´¹ç”µå­é‚®ä»¶ï¼Œä»¥ä¾¿åœ¨æˆ‘å‘å¸ƒæ–°æ•…äº‹æ—¶åŠæ—¶è·å–](https://grahamharrison-86487.medium.com/subscribe)ã€‚'
- en: '[Taking a quick look at my previous articles](https://grahamharrison-86487.medium.com/).'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '[å¿«é€Ÿæµè§ˆæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ](https://grahamharrison-86487.medium.com/)ã€‚'
- en: '[Downloading my free strategic data-driven decision making framework](https://relentless-originator-3199.ck.page/5f4857fd12).'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '[ä¸‹è½½æˆ‘çš„å…è´¹æˆ˜ç•¥æ•°æ®é©±åŠ¨å†³ç­–æ¡†æ¶](https://relentless-originator-3199.ck.page/5f4857fd12)ã€‚'
- en: Visiting my data science website â€” [The Data Blog](https://www.the-data-blog.co.uk/).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: è®¿é—®æˆ‘çš„æ•°æ®ç§‘å­¦ç½‘ç«™ â€” [æ•°æ®åšå®¢](https://www.the-data-blog.co.uk/)ã€‚

- en: What is dbt (data build tool) and When should you use it?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/what-is-dbt-data-build-tool-and-when-should-you-use-it-9dc1566d960d](https://towardsdatascience.com/what-is-dbt-data-build-tool-and-when-should-you-use-it-9dc1566d960d)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Discover the Hidden Benefits and Drawbacks of dbt
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://khuyentran1476.medium.com/?source=post_page-----9dc1566d960d--------------------------------)[![Khuyen
    Tran](../Images/98aa66025ad29b618e875c75f1c400a5.png)](https://khuyentran1476.medium.com/?source=post_page-----9dc1566d960d--------------------------------)[](https://towardsdatascience.com/?source=post_page-----9dc1566d960d--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----9dc1566d960d--------------------------------)
    [Khuyen Tran](https://khuyentran1476.medium.com/?source=post_page-----9dc1566d960d--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----9dc1566d960d--------------------------------)
    ·8 min read·Apr 30, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8fd7187361494d3070374a447154da1a.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Motivation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If your organization is looking to create a data-driven product, you should
    consider having efficient data pipelines to:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Stay competitive:** Quick access to data and its analysis through efficient
    data pipelines accelerates decision-making and keeps you ahead of your competition.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Reduce costs:** The time and effort required to collect and transform data
    can be significantly reduced with efficient data pipelines, which can reduce costs
    and enable employees to focus on higher-level tasks that require human intelligence.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](../Images/1da42b35f889b90b992755664495c754.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: One tool that has gained popularity in recent years for managing data pipelines
    is dbt (data build tool).
  prefs: []
  type: TYPE_NORMAL
- en: While dbt can provide significant benefits for managing and modeling data, it
    may not be the best tool for every situation. In this article, we’ll explore the
    use cases of dbt to determine whether dbt is a good fit for your organization.
  prefs: []
  type: TYPE_NORMAL
- en: 'Feel free to play and fork the source code of this article here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/khuyentran1401/dbt-demo?source=post_page-----9dc1566d960d--------------------------------)
    [## GitHub - khuyentran1401/dbt-demo: Demo for dbt'
  prefs: []
  type: TYPE_NORMAL
- en: You can't perform that action at this time. You signed in with another tab or
    window. You signed out in another tab or…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/khuyentran1401/dbt-demo?source=post_page-----9dc1566d960d--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: What is dbt?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: dbt is an open-source tool for transforming data in a data warehouse. With dbt,
    users can write SQL queries that transform data and create repeatable workflows
    that can be easily tested and automated.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8d805b3cebe265a0a79650e206caedd5.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: When Should You Consider dbt
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You should consider using dbt when:'
  prefs: []
  type: TYPE_NORMAL
- en: '**You have a data warehouse:** dbt is an effective tool for organizing, transforming,
    and testing data in a data warehouse environment.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Your data pipeline is complex:** dbt’s modular approach can help break down
    complex pipelines into smaller pieces, making it easier to debug, test, and make
    changes to your pipeline.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Your data changes frequently:** dbt’s snapshot allows you to track changes
    in data over time.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Transparency is essential to your organization:** dbt can automatically generate
    documentation for your pipeline. It also provides insights into the data transformation
    process through data lineage.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Data quality is essential to your organization:** dbt can test your models
    to help you catch errors early and ensure that your data is accurate.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Before diving into some helpful features of dbt, we need to first set up the
    dbt environment. This will allow you to easily follow along with the discussion.
  prefs: []
  type: TYPE_NORMAL
- en: Setup dbt
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Install dbt
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This article uses BigQuery as a data warehouse for dbt, to install dbt’s adapter
    for BigQuery, type:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Follow [this instruction](https://docs.getdbt.com/docs/core/pip-install) if
    you want to use other dbt’s adapters.
  prefs: []
  type: TYPE_NORMAL
- en: Create a project
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To initialize a dbt project called `dbt_demo`, type the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The following is the project directory.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/58f08fd665855524131402391ad4d2f2.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Modularity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: dbt’s modular approach allows you to break down a complex pipeline into smaller
    pieces.
  prefs: []
  type: TYPE_NORMAL
- en: To demonstrate this, we will use the `austin_bikeshare` dataset from [BigQuery
    public datasets](https://cloud.google.com/bigquery/public-data).
  prefs: []
  type: TYPE_NORMAL
- en: 'Create a new SQL file in the `models` directory, named `models/trips_per_property.sql`
    with the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Since this model contains multiple data transformations, it can be difficult
    to maintain and test.
  prefs: []
  type: TYPE_NORMAL
- en: 'We could separate the model into different models by doing the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Create two files `stg_stations.sql` and `stg_trips.sql` under the `models` directory.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Replace the existing `stations` CTE and `trips` CTE with the following SQL
    code:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/62fbcb330cc2404448a79c8e7cbeadf0.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: In the `stg_trips.sql` file, write the SQL code from the `trips` CTE in the
    original model.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: In the `stg_stations.sql` file, write the SQL code from the `stations` CTE in
    the original model.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'By breaking down the model into multiple models, you can now reuse the data
    models in other models:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1af0bc9afd047dc34877bb7491785346.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Your team members can also work on the different parts of the project simultaneously.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/725fce0463047da25e0286f33cc75cfc.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Because each module is self-contained, it can be easily tested and validated.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0ab71b53bfec7af5f1c969a358044017.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Code Reusability
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Using macros in dbt simplifies the process of reusing SQL code fragments across
    various models.
  prefs: []
  type: TYPE_NORMAL
- en: To demonstrate, we will create a macro called `get_end_time` in the `macros/get_end_time.sql`
    file. This micro gets an end time based on a start time and duration.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Think of the `get_end_time` macro as a Python function that can be used repeatedly
    to generate a value based on the inputs provided.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b0e3e8fdb37220233e4e7f1e960292b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: 'Another model can now use this micro with specific values for `start_time`
    and `duration_minutes`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Testing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'With dbt, you can easily verify the correctness of your models. For instance,
    to ensure the `stg_stations` model is correct, you may want to check that:'
  prefs: []
  type: TYPE_NORMAL
- en: The `station_id` column is non-null and has unique values.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `property_type` column only has the values ‘free_parking’ or ‘paid_parking’.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To test the `stg_stations` model, create a new YAML file in the `models` directory,
    named `models/schema.yml` with the following content.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Then run `dbt test` to run all of the tests.
  prefs: []
  type: TYPE_NORMAL
- en: By catching potential errors early in the transformation process, tests can
    reduce the risk of errors in downstream applications and analyses.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/759bf139db25d64feb2f34bd6401c390.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: In addition, tests provide a way to track changes in the data over time and
    to ensure that the transformation logic remains correct as the underlying data
    changes.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/197f0558ee9e3ed9d203d4ae088eed05.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Documentation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With dbt, you can easily document your models and share the documentation with
    your team.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create documentation for your models, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Add descriptions to your `models/schema.yml` file.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/261d01b4eb82187b745e80b6102b9283.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '[View full file.](https://github.com/khuyentran1401/dbt-demo/blob/main/models/schema.yml)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Run `dbt docs generate` to generate the documentation for your project.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Run `dbt docs serve` command to launch the documentation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Access the documentation by navigating to [http://localhost:8080](http://localhost:8080/)
    in your web browser.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/c1fafd0480a42981ffa4f9fb1c86fa99.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Documenting your data models helps to ensure that everyone who works with the
    models can comprehend their functionality and purpose.
  prefs: []
  type: TYPE_NORMAL
- en: You can also examine data lineage in the documentation by clicking “View lineage
    graph.”
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/714dfaa074ce4eebbe5b6e1c7435aac6.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Track changes in data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With dbt, you can track data changes over time through snapshots.
  prefs: []
  type: TYPE_NORMAL
- en: To see why this is useful, imagine you have a `subscriber_type` table where
    the `subscriber_type` field is frequently overwritten as subscribers modify their
    membership status.
  prefs: []
  type: TYPE_NORMAL
- en: If a user changes their membership from “trial” to “premium”, the record of
    when the user had the “trial” membership will be lost.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7324f5735db009449180e5deb71988a2.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Losing this record can be problematic if we want to use it for other evaluations
    such as calculating the average time taken by a user to change their subscription.
  prefs: []
  type: TYPE_NORMAL
- en: 'dbt can snapshot these changes to help you understand how values in a row change
    over time. Here’s an example of a snapshot table for the previous example:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aaa9ddc0c71b7ec3535cdbf46c8c6dff.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: '[View this tutorial on how to create snapshots.](https://docs.getdbt.com/docs/build/snapshots)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When You Should Not Use dbt
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'While dbt can provide significant benefits for managing and modeling data,
    you should not use dbt when:'
  prefs: []
  type: TYPE_NORMAL
- en: '**You don’t have a data warehouse:** dbt is designed to work specifically with
    data warehouses, such as Snowflake, Redshift, or BigQuery. If you don’t have a
    data warehouse, then dbt may not be the right tool for you.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**You want a one-stop shop for ETL:** While dbt is an excellent tool for transforming
    data, it does not offer a complete end-to-end solution for ETL (Extract, Transform,
    Load) tasks. Other tools are needed for tasks such as data extraction, data cleansing,
    and data loading.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**You want to visualize your data:** dbt is not a data visualization tool.
    If you want to create visualizations, you will need to use a separate tool or
    library such as Tableau, Looker, or PowerBI.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**You want advanced feature engineering beyond the limitations of SQL grammar:**
    As SQL is dbt''s primary language, there are some limitations when it comes to
    feature engineering. If you need to perform advanced feature engineering tasks
    that go beyond the capabilities of SQL, you may need to use other tools or languages
    such as Python or R.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](../Images/5a642bf8669ac618a833aac8e82659dd.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this article, we cover some helpful features of dbt and learn when to and
    not to use dbt. I hope this article gives you the knowledge needed to decide whether
    dbt is the right solution for your data pipelines.
  prefs: []
  type: TYPE_NORMAL
- en: I love writing about data science concepts and playing with different data science
    tools. You can connect with me on [LinkedIn](https://www.linkedin.com/in/khuyen-tran-1401/)
    and [Twitter](https://twitter.com/KhuyenTran16).
  prefs: []
  type: TYPE_NORMAL
- en: 'Star [this repo](https://github.com/khuyentran1401/Data-science) if you want
    to check the code for the articles I have written. Follow me on Medium to stay
    notified about my latest data science articles:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/introduction-to-dvc-data-version-control-tool-for-machine-learning-projects-7cb49c229fe0?source=post_page-----9dc1566d960d--------------------------------)
    [## Introduction to DVC: Data Version Control Tool for Machine Learning Projects'
  prefs: []
  type: TYPE_NORMAL
- en: Just like Git, but with Data!
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/introduction-to-dvc-data-version-control-tool-for-machine-learning-projects-7cb49c229fe0?source=post_page-----9dc1566d960d--------------------------------)
    [](/4-pre-commit-plugins-to-automate-code-reviewing-and-formatting-in-python-c80c6d2e9f5?source=post_page-----9dc1566d960d--------------------------------)
    [## 4 pre-commit Plugins to Automate Code Reviewing and Formatting in Python
  prefs: []
  type: TYPE_NORMAL
- en: Write High-Quality Code with black, flake8, isort, and interrogate
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/4-pre-commit-plugins-to-automate-code-reviewing-and-formatting-in-python-c80c6d2e9f5?source=post_page-----9dc1566d960d--------------------------------)
    [](/validate-your-pandas-dataframe-with-pandera-2995910e564?source=post_page-----9dc1566d960d--------------------------------)
    [## Validate Your pandas DataFrame with Pandera
  prefs: []
  type: TYPE_NORMAL
- en: Make Sure Your Data Matches Your Expectation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/validate-your-pandas-dataframe-with-pandera-2995910e564?source=post_page-----9dc1566d960d--------------------------------)
    [](/pytest-for-data-scientists-2990319e55e6?source=post_page-----9dc1566d960d--------------------------------)
    [## Pytest for Data Scientists
  prefs: []
  type: TYPE_NORMAL
- en: A Comprehensive Guide to Pytest for your Data Science Projects
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/pytest-for-data-scientists-2990319e55e6?source=post_page-----9dc1566d960d--------------------------------)
  prefs: []
  type: TYPE_NORMAL

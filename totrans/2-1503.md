# 随机变量参数的最大似然估计

> 原文：[https://towardsdatascience.com/maximum-likelihood-estimation-4a1a866dfa70](https://towardsdatascience.com/maximum-likelihood-estimation-4a1a866dfa70)

## 通过观察数据的最高似然性来建模参数

[](https://romanmichaelpaolucci.medium.com/?source=post_page-----4a1a866dfa70--------------------------------)[![Roman Paolucci](../Images/61d8dd3f53507c1d69cc441c4303400b.png)](https://romanmichaelpaolucci.medium.com/?source=post_page-----4a1a866dfa70--------------------------------)[](https://towardsdatascience.com/?source=post_page-----4a1a866dfa70--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----4a1a866dfa70--------------------------------) [Roman Paolucci](https://romanmichaelpaolucci.medium.com/?source=post_page-----4a1a866dfa70--------------------------------)

·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page-----4a1a866dfa70--------------------------------) ·11分钟阅读·2023年12月10日

--

![](../Images/3914d7333e71686deb52327047a97ded.png)

Francesco Ungaro 摄影： [https://www.pexels.com/photo/blue-and-white-abstract-painting-1912832/](https://www.pexels.com/photo/blue-and-white-abstract-painting-1912832/)

概率和统计学中的概念由于高水平的数学、糟糕的符号表示以及随机变量和数据的交织而显得有些难以捉摸。本文阐明了在估计量、估计值、偏差和方差，以及最大似然估计方法的背景下，随机变量和数据之间的关系。

本文将分为以下几个部分。

+   **概率质量和分布函数的参数**

+   **估计量**

+   **估计值**

+   **偏差和方差**

+   **最大似然估计**

+   **无耻的推广** [**Quant Guild**](https://quantguild.com/)

## 概率质量和分布函数的参数

本文不是关于常见随机变量的入门文章（[这篇文章是为了这个目的](https://medium.com/quant-guild/common-random-variables-f30c537a01e4)）。我建议你阅读那篇文章，或在继续之前具备基本概率（公理、质量/分布函数等）的扎实基础。

让我们以医院接收病人的例子来讨论。

假设我们是一名医院风险管理人员、高级医生统计师、数据科学护士（我确实*不知道*谁会负责这个），我们想估计没有足够的病床来接纳病人的风险。将某一天检查入住的病人数建模为*泊松*随机变量是合理的。也就是说，我们假设每天检查入住医院的病人数服从泊松分布。

![](../Images/ecc84a629991aac77da535065d079dfd.png)

作者生成的图像

**X**是**1、2、…、n**天住院的病人数量。

我现在将简化问题空间，以免出现愤怒的评论：

+   *假设所有住院病人当天都会出院*

+   *假设每天入住的病人彼此独立*

这实际可行吗？可能不行——但它确实能帮助我们以简化的方式前进。这些是建模风险时需要考虑的事情，你的假设如何影响模型。

在这些假设下，我们很可能会低估风险。为什么？因为人们总是会在同一天出院吗？绝对不会，所以在这种情况下我们高估了床位的可用性。独立性呢？人们会互相传染吗？我在这里偏题了，因为这不是一篇关于假设和违背假设的文章。

好的，考虑到所有给定的假设，我们知道病人遵循一个泊松分布，其概率质量函数如下。

![](../Images/6697af301b601bb7f38ad3754ea0d7a6.png)

作者生成的图像

因此，对于某一天的病人数量 **a**，我们可以找出看到该数量病人的相关概率。

此外，假设我们只有100张床位，根据历史病人数据，我们如何估计无法接纳病人的概率？我们将在回答一个更紧迫的问题后回到这个想法。

特别敏锐的人，或者那些稍微关注一点的人，会问出以下某种变体的问题

> 我们如何估计参数 lambda？我们选择什么值？

啊，是的，现在我们可以讨论估计量了。

## 估计量

一个估计量是任意一组随机变量的*函数*。重要的是要注意，*估计量*是一个函数，该函数在一组数据上给出*估计值*。请允许我详细说明。

以下方程是一个估计量

![](../Images/e3e4c77808023f1b340e05e543f1ddfb.png)

作者生成的图像

希望以函数形式书写有助于传达要点。这个函数，即样本均值，是总体均值的一个估计量。请注意，这这是一个任意一组独立且服从标准正态分布的随机变量的函数。

让我们对估计量应用期望算子

![](../Images/404ac8cb5afdb560021da4985d3b9546.png)

作者生成的图像

我们可以看到，这个估计量的期望值为零，这也与给定标准正态随机变量集的总体参数一致。请注意，我们在这里有总体参数，在我们上面的医院示例中，我们缺少总体参数 lambda，因此它必须被*估计*。稍后会详细讨论。

以下也是一个估计量

![](../Images/40b2a694dc2d27663136b2c0ec271b86.png)

作者生成的图像

其中 *zeta* 是一个任意常数。

我们可以应用相同的期望算子

![](../Images/a1daff9ba067aa9d3fb9a00db3bf9254.png)

由作者生成的图像

期望值现在是 zeta，注意这与总体参数不一致。

我们这里有一个有趣的情况。我们知道总体参数，因此自然希望我们的估计量的期望值能够得到控制我们数据的总体参数。直观上，这是第一个没有 zeta 的估计量。

但如果我们不知道总体参数呢？如果我们不知道总体参数，不添加像 zeta 这样的任意常数是否是最优的？

再次，我们将很快在偏差和方差的背景下回到这个概念。

## 估计

这一部分很简单，我保证会很简短。估计是数据的一个函数，其中函数是给定的估计量。

需要注意的是，这些估计有其自身的分布，因为它们是我们提供给估计量的数据的函数。

假设我们有来自标准正态分布的以下实现随机变量

![](../Images/e74c032ce6554a50a952c1a4e2befaa0.png)

由作者生成的图像

这是*数据*，*没有*任何不确定性。我们知道支配分布，并且知道每个**z**的值。根据这些数据，我们可以构造对总体均值的估计（我们刚好知道这个均值）。这是通过在实现的数据上应用*g*函数得到的。

这里有一个 Python 脚本来完成这个任务。

由作者生成的代码

[PRE0]

注意，在这种情况下，n=1000，我们构造了一个总体均值的估计（我们知道这个均值是零），结果非常接近。每一个新的数据样本将产生不同的估计——然而，我们知道在期望值上，这些估计将与总体均值对齐。

这就是当说估计量遵循它们的*自身分布*时的含义。如果我们记录一系列 n=1000 个样本并创建直方图，我们实际上会观察到*样本均值的分布*。

*这里涉及大数法则和中心极限定理的影响——如果你对这些概念在完全不同的背景下的直观解释感兴趣，请参见以下视频。*

由作者生成的视频

我们现在可以回到文章前面提出的问题。

在我们的医院例子中，我们需要估计参数，我们知道可以使用估计量来估计该参数。

我们面临的真正问题是，我们应该使用什么估计量，以及如何评估这个估计量？

## 偏差和方差

偏差指的是估计量对被估计参数的期望偏离。这听起来比较复杂，我们来看看数学公式。

假设我们有一系列独立且同分布的正态随机变量**N**。我们可以为总体均值 theta 构造一个估计。

![](../Images/abc692cb0a31ab167c35c82d7f14bf61.png)

作者生成的图像

正式来说，偏差是估计量的期望与真实值之间的差异。

![](../Images/b547e09ea6d41c626ed53152f584ec0d.png)

作者生成的图像

在这种情况下，tau 等于总体均值 mu，因为这是我们试图估计的真实值。现在我们找出我们的估计量的期望值。

![](../Images/84910bb8e9f24a691a0a34fcf58c2a9d.png)

作者生成的图像

因此

![](../Images/1e216d408c42a0711bc2f64a429ade7e.png)

作者生成的图像

在这里，我们发现估计量 theta 对于总体均值是无偏的。

在以下情况下，出现了一个必要的问题：

> 一个具有零偏差和大量方差的估计量是否比一个具有小偏差和极低方差的估计量更好？

哪个估计量更好？如果有一个考虑了偏差和方差的度量就好了…

**均方误差 (MSE)**

均方误差考虑了估计量与被估计值之间的期望（平方）距离。

![](../Images/dcb6f7864ebb305c18165922af60dd8d.png)

作者生成的图像

MSE 实际上简化为方差与偏差的平方的组合。

![](../Images/724aad204ee11eb1e26e8cdc8f0389ab.png)

作者生成的图像

我们现在有了回答总体问题的方法：*我们应该选择哪个估计量？* 也就是说，我们可以比较估计量之间的 MSE，以确定在偏差和方差的背景下哪个可能更好。

在机器学习的背景下，我们面临着*偏差-方差权衡*的著名问题。当模型有更多的预测变量时，它们往往对训练数据的估计误差（偏差）较低——然而，在拟合新的训练样本时，这些估计的方差往往会更大。权衡指的是同时最小化偏差和方差的问题。

或许我们将在另一篇文章中更深入地探讨这个话题。现在，让我们最后讨论如何利用*最大似然估计*构造一个有效的估计量。

## 最大似然估计

目前为止在本文中所花费的时间为*为什么*最大似然估计有用奠定了基础。让我们回顾一下。

+   我们有一个有 100 张床位的医院，并且有关于每天检查和出院患者数量的数据，我们想用泊松分布来建模这个随机变量。

+   我们知道泊松分布由 lambda 参数化，但我们应该如何估计这个参数呢？我们应该选择什么估计量？

+   我们知道我们希望选择的估计量在偏差和方差的背景下具有较低的 MSE，但*我们如何凭空构造这样的估计量呢？*

幸运的是，我们回顾中的最后一个问题可以通过最大似然估计的方法来回答。MLE 在估计量中具有几个理想的特性，例如

+   MLE 提供渐近零偏差

+   MLEs 在其数据的统治分布下是渐近正态的

+   MLEs提供的方差对所有渐近正态估计量来说是尽可能低的

这里的渐近指的是给定数据集的样本量的任意增加。

但是*MLE*到底是什么？对于我们估计的任何参数，我们都是在寻找使观察到的数据的似然性最高的估计。在随机变量的背景下进行这种操作将得到MLE估计量，将该估计量应用于数据将得到MLE估计。

现在让我们推导泊松随机变量的最大似然估计量。之后，我们可以使用这个估计量来估计lambda。

![](../Images/133f950066aaeb8fc7dbd11b2c7d80e4.png)

作者生成的图像

在这里，我们可以使用之前假设的独立性概念，找到多变量函数作为泊松随机变量的单独概率质量函数的分解乘积。

![](../Images/842a56f161390856619665c5cb293662.png)

作者生成的图像

我们通常使用*对数似然*，因为它使计算更简单。

![](../Images/02ff5e26b2a573c484c10706fcf02c99.png)

作者生成的图像

不过，不要混淆，以下解法是等效的。

![](../Images/3d479ebb9496c498907695c0e12eb888.png)

作者生成的图像

现在让我们代入theta的概率质量函数。

![](../Images/59bd21efc46033cc8436915287f21427.png)

作者生成的图像

利用对数的性质，我们可以将乘积分解为求和。

![](../Images/27cee3fb9beeb0dfc048a3b0b34cf410.png)

作者生成的图像

我们现在希望通过选择一个合适的lambda值来最大化这个概率。这成为了一个微积分中的优化问题，我们对lambda求导并将方程设为零——求解lambda。

![](../Images/076b40a0bdf463da14082833f01db8cc.png)

作者生成的图像

![](../Images/3fd911c651161ef4c6829c50b7575e8c.png)

作者生成的图像

![](../Images/49c38b7b7555ca47172611d366fc67a1.png)

作者生成的图像

![](../Images/d41a9c381b67ea3133e9d322d0bc2787.png)

作者生成的图像

真棒！总体参数lambda的MLE是样本均值。使用Python，我将展示如何将这一切结合起来。

+   给定一组假设遵循泊松分布的每日患者数据，使用MLE计算总体参数lambda的估计值

+   使用MLE估计量建模泊松分布

+   计算在特定一天内没有足够床位容纳患者的概率

+   将其与已知的lambda进行比较（这里我们可以知道，因为这是模拟数据）以查看MLE估计的效果如何

作者生成的代码

[PRE1]

就是这样，这是对我们人口参数的相当准确的估计！这就是最大似然估计的方法。

## 结论

概率与统计的基础研究涵盖了随机变量的基本假设和功能。然而，抽象的研究往往让学生感觉缺少了什么：*应用于实际问题以指导决策*。

在这里，我们讨论了如何基于泊松随机变量的理论和假设构建一个基础概率模型，并结合观察到的数据来分析假设被违反时可能的概率高估和低估。

如前所述，这个基础概率模型的一个关键假设是日常就医者之间的独立性，但这可能并不完全准确。以近期的证据为例，请回忆一下在 COVID-19 大流行期间，医院床位如何逐日变得越来越紧张。在这种情况下，这一过程的自协方差结构很可能是非零的，这意味着日常入住之间存在某种相关性。此外，我们的所有就医者不可能在同一天全部离院。

基于*今天*的入住情况来建模*明天*的入住情况可能更为合理。利用这个框架，我们现在可以将原始问题视为一个随时间演变的*依赖*系统，其中的*未来*状态仅依赖于*现在*的状态。幸运的是，我们有方法处理这样的依赖过程，通过将其视为*马尔可夫链*进行研究，这将是未来文章的主题——敬请关注！

# Quant Guild

有兴趣提升你在量化金融、数学、统计学、数据科学、机器学习和人工智能方面的知识吗？

在 Quant Guild 查看我们的课程，使用代码 **QGMEDIUM 享受 50% 折扣**！

[## Introduction to Python](https://quantguild.com/p/introduction-to-python?source=post_page-----4a1a866dfa70--------------------------------)

### Python 已经成为学术界和从业者的首选语言…

[## Algorithmic Trading System Development](https://quantguild.com/p/algorithmic-trading-system-development?source=post_page-----4a1a866dfa70--------------------------------) [## Introduction to Python](https://quantguild.com/p/introduction-to-python?source=post_page-----4a1a866dfa70--------------------------------)

### 一个为那些有兴趣构建自己算法交易系统的人员设计的简明课程。

[quantguild.com](https://quantguild.com/p/algorithmic-trading-system-development?source=post_page-----4a1a866dfa70--------------------------------)

查看我们的免费资源！

[**YouTube**](https://www.youtube.com/@QuantGuild)

[**YouTube**](https://www.youtube.com/@QuantGuild?source=post_page-----4a1a866dfa70--------------------------------) [## Quant Guild

### divitiae et educatione

www.youtube.com](https://www.youtube.com/@QuantGuild?source=post_page-----4a1a866dfa70--------------------------------)

[**GitHub**](https://github.com/Quant-Guild)

[](https://github.com/Quant-Guild?source=post_page-----4a1a866dfa70--------------------------------) [## Quant-Guild

### Quant-Guild 目前有 4 个可用的代码库。关注他们在 GitHub 上的代码。

github.com](https://github.com/Quant-Guild?source=post_page-----4a1a866dfa70--------------------------------)

[**Medium**](https://medium.com/quant-guild)

[](https://medium.com/quant-guild?source=post_page-----4a1a866dfa70--------------------------------) [## Quant Guild

### 财富与教育

medium.com](https://medium.com/quant-guild?source=post_page-----4a1a866dfa70--------------------------------)

[**Discord**](https://discord.gg/MJ4FU2c6c3)

[## 加入 Quant Guild Discord 服务器！

### 查看 Quant Guild 社区的 Discord——与其他 1 名成员一起闲逛，享受免费的语音和文字聊天。

discord.gg](https://discord.gg/MJ4FU2c6c3?source=post_page-----4a1a866dfa70--------------------------------)

非常感谢阅读！希望你喜欢这篇文章——如果有任何问题，请随时留言或随时联系：*roman@quantguild.com*。

除此之外，我们下次见！

**RMP**

- en: 'Mastering Weather Predictions: Unleash the Power of AI with LSTM Deep Learning
    Models for Accurate Temperature Forecasts'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/mastering-weather-predictions-unleash-the-power-of-ai-with-lstm-deep-learning-models-for-accurate-cadd72ce221](https://towardsdatascience.com/mastering-weather-predictions-unleash-the-power-of-ai-with-lstm-deep-learning-models-for-accurate-cadd72ce221)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Predicting temperature trends with advanced deep learning techniques using LSTM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://octaviobomfim.medium.com/?source=post_page-----cadd72ce221--------------------------------)[![Octavio
    Santiago](../Images/d705f7624c5e5540b08346e4680f676f.png)](https://octaviobomfim.medium.com/?source=post_page-----cadd72ce221--------------------------------)[](https://towardsdatascience.com/?source=post_page-----cadd72ce221--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----cadd72ce221--------------------------------)
    [Octavio Santiago](https://octaviobomfim.medium.com/?source=post_page-----cadd72ce221--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----cadd72ce221--------------------------------)
    ·7 min read·Mar 27, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/54483c9868dcecdd790798f64147f9da.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Weather Predictions generated using DALLE-2'
  prefs: []
  type: TYPE_NORMAL
- en: Weather forecasting is one of the most important tools in the modern world and
    developing a good temperature prediction model can be a huge competitive advantage
    for many businesses. Ambient temperature measurement is directly linked to several
    business areas such as agriculture, energy sector, trading, aviation, and many
    other sectors.
  prefs: []
  type: TYPE_NORMAL
- en: Measuring temperature is an important aspect of weather forecasting and is one
    of the most fundamental and widely-used indicators of climate conditions because
    it influences the behavior of atmospheric gases and the circulation of air and
    water, which are critical components of the climate system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some key ways in which weather temperature measurement is important for many
    businesses are:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Agriculture: Temperature measurement is used to monitor growing conditions
    and predict potential crop yields, which helps farmers to make informed decisions
    about planting, harvesting, and storage of crops.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Energy and utilities: Temperature measurement is used to forecast heat waves,
    cold snaps, and other temperature extremes, which helps utilities to plan for
    and respond to changes in energy demand. Some companies trade energy and energy
    demand prediction is crucial to get good profit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Transportation: Temperature measurement is used to predict and monitor extreme
    temperatures, such as heat waves or cold snaps, which can affect the safety and
    efficiency of transportation systems such as roads and airports.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Overall, temperature measurement is a fundamental tool for understanding and
    predicting weather and climate conditions, a model that can predict the temperature
    precisely is critical for the functioning of many different industries and very
    advantageous for many others.
  prefs: []
  type: TYPE_NORMAL
- en: In this article, we will learn how to build LSTM Deep Learning models to forecast
    temperature precisely.
  prefs: []
  type: TYPE_NORMAL
- en: Dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The dataset used for training was taken from the INMET website with meteorological
    data from the station SAO PAULO — INTERLAGOS (A771) in the city of São Paulo —
    Brazil. The sampling frequency of the temperature data is hourly and 1 year of
    training from 23-March-2022 01:00 to 23-March-2023 12:00 was used.
  prefs: []
  type: TYPE_NORMAL
- en: 'Source: [https://mapas.inmet.gov.br/#](https://mapas.inmet.gov.br/#)'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bdfe7b6134a652e4698010339aebda00.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: São Paulo map'
  prefs: []
  type: TYPE_NORMAL
- en: 'Target Variable: Temp Max (ºC)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/79bf5832ecc03e61914d56d2353d4138.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: INMET temperatures (Max, Mean, Min)'
  prefs: []
  type: TYPE_NORMAL
- en: LSTM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: LSTM (Long Short-Term Memory) is a type of recurrent neural network (RNN) architecture
    that is particularly well-suited for processing sequential data, such as time
    series, speech, or text.
  prefs: []
  type: TYPE_NORMAL
- en: Unlike traditional feedforward neural networks, the basic building block of
    an LSTM model is the LSTM cell, which is designed to remember and update information
    over a long period of time. Each LSTM cell has a set of “gates” that control the
    flow of information into and out of the cell, allowing the network to selectively
    store or forget information as it processes the input data.
  prefs: []
  type: TYPE_NORMAL
- en: An LSTM network is typically composed of multiple LSTM cells arranged in a sequence.
    The input data is passed through the cells one time step at a time, with the output
    of one cell being used as the input to the next cell. This allows the network
    to learn and model complex sequential patterns in the data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/319085d9a268b6674082d5b7c8110f93.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: LSTM Architecture'
  prefs: []
  type: TYPE_NORMAL
- en: Train and Benchmarks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The main outcome in training a Time Series model is how to split the dataset
    correctly into train and test datasets. Since the sequence is important we cannot
    split the dataset randomly, to split the dataset right, the sklearn function “TimeSeriesSplit”
    is being used.
  prefs: []
  type: TYPE_NORMAL
- en: '**LSTM Vanilla**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: LSTM vanilla (or “vanilla LSTM”) refers to a type of Long Short-Term Memory
    (LSTM) neural network architecture that is a basic or standard version of the
    LSTM model.
  prefs: []
  type: TYPE_NORMAL
- en: '**Train**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 18 days of sample time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dataset hourly separated
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 80% train dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/29c59fc9d96c249e345ad70c12984c85.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Train LSTM Vanilla'
  prefs: []
  type: TYPE_NORMAL
- en: '**Regression metrics for the training:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'MAE (Mean Absolute Error): 0.53'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MSE (Mean Squared Error) : 0.60'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MAPE (Mean Absolute Percentage Error): 2,9 %'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Problems:**'
  prefs: []
  type: TYPE_NORMAL
- en: Delay for temperature rises and peak identification
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Test**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 20% of the dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/ba0edd3b4cd8352826225a9031078574.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Test LSTM vanilla'
  prefs: []
  type: TYPE_NORMAL
- en: '**Regression metrics for the training:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'MAE (Mean Absolute Error): 0.59'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MSE (Mean Squared Error) : 0.82'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MAPE (Mean Absolute Percentage Error): 2,5 %'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Forecasting**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Forecasting 48 hours ahead
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/35975a572b3ebc3b7e7ad5741dff9212.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Predict LSTM Vanilla'
  prefs: []
  type: TYPE_NORMAL
- en: '**LSTM Stacked**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Stacked LSTM (Long Short-Term Memory) is a variant of the popular LSTM recurrent
    neural network architecture. In a standard LSTM, a single layer of LSTM cells
    is used to process sequential data. In a stacked LSTM, multiple layers of LSTM
    cells are used, with the output of one layer being used as the input to the next
    layer.
  prefs: []
  type: TYPE_NORMAL
- en: The stacked LSTM architecture is used to improve the ability of the network
    to learn and model complex sequential patterns in data. Each layer in the stack
    can learn different levels of abstraction and extract features from the input
    data, which allows the network to capture more complex relationships and dependencies
    in the data.
  prefs: []
  type: TYPE_NORMAL
- en: '**Train**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 18 days of sample time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dataset hourly separated
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 80% train dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/8912f8845eb5a97aa7fef3270e6b3b60.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Train LSTM Stacked'
  prefs: []
  type: TYPE_NORMAL
- en: '**Regression metrics for the training:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'MAE (Mean Absolute Error): 0.52'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MSE (Mean Squared Error) : 0.57'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MAPE (Mean Absolute Percentage Error): 2,8 %'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Problems:**'
  prefs: []
  type: TYPE_NORMAL
- en: Delay for temperature rises and peak identification
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Problem with future predictions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Test**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 20% of the dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/7025f5a2f623e1afb3e5788423322a95.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Test LSTM Stacked'
  prefs: []
  type: TYPE_NORMAL
- en: '**Regression metrics for the training:**'
  prefs: []
  type: TYPE_NORMAL
- en: 'MAE (Mean Absolute Error): 0.57'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MSE (Mean Squareed Error) : 0.82'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MAPE (Mean Absolute Percentage Error): 2,4 %'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Forecasting**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Forecasting 48 hours ahead
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/7be57654a5922ece79cb57f54a63534d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: Forecasting LSTM Stacked'
  prefs: []
  type: TYPE_NORMAL
- en: Evaluate Forecasting — LSTM Vanilla
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After the training and tests performed for each model, the most consistent
    method to compare their efficiency is to compare to new and real data. A prediction
    for the next 48 hours was performed for LSTM Vanilla and Stacked and compared
    to real data (yellow) below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/93fbcce8eeb2bf07064f309392b60dcb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: LSTM Vanilla, LSTM Stacked, and Real Temp comparison'
  prefs: []
  type: TYPE_NORMAL
- en: '**LSTM Vanilla**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Average error: 2,04 ºC'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Maximum error: 4,44ºC'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**LSTM Stacked**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Average error: 1,36 ºC'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Maximum error: 3,16ºC'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](../Images/299d79057c1752c06422ca5b17c0997e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Image by Author: MAE comparison'
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the 48-hour prediction Stacked LSTM model showed a lower Average absolute
    error and a lower maximum temperature error as well, showing that adding complexity
    to the model was beneficial for these LSTM models and fitting data.
  prefs: []
  type: TYPE_NORMAL
- en: In the 48-hour prediction, the Stacked LSTM model exhibited a reduced average
    absolute error and maximum temperature error compared to the Vanilla. These findings
    indicate that the inclusion of additional complexity in the model was advantageous
    for the LSTM architecture. The introduction of these additional layers allows
    the model to capture more complex patterns and dependencies in the data which
    can enhance its performance in prediction tasks. The observed decrease in errors
    suggests that the added complexity enabled the model to capture more of the underlying
    patterns and variability in the temperature data, resulting in more accurate predictions.
  prefs: []
  type: TYPE_NORMAL
- en: Both models exhibited a high degree of precision in predicting temperature values
    for the next 48 hours, with an average error rate of approximately 2% and 2ºC.
    However, a challenge encountered by both models was accurately identifying a secondary
    temperature valley that differed from the expected outcome. This issue highlights
    a potential limitation in the models’ ability to capture and interpret complex
    patterns in the temperature data, particularly in cases where unexpected fluctuations
    or anomalies occur. Further research may be necessary to improve the models’ sensitivity
    to such irregularities and enhance their overall performance for temperature prediction.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thank you so much for reading! Any questions or suggestions please contact
    me via LinkedIn: [https://www.linkedin.com/in/octavio-b-santiago/](https://www.linkedin.com/in/octavio-b-santiago/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'If you want to implement this solution or learn more about LSTM algorithms
    you can find the full python code on my GitHub repo in the link below:'
  prefs: []
  type: TYPE_NORMAL
- en: Code
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[](https://github.com/octavio-santiago/temperature-forecasting?source=post_page-----cadd72ce221--------------------------------)
    [## GitHub - octavio-santiago/temperature-forecasting: Temperature Forecasting
    models with AI - Python'
  prefs: []
  type: TYPE_NORMAL
- en: Temperature Forecasting models with AI - Python This repository contains code
    for training and evaluating LSTM deep…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/octavio-santiago/temperature-forecasting?source=post_page-----cadd72ce221--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Datasource: [https://mapas.inmet.gov.br/#](https://mapas.inmet.gov.br/#) —
    INMET (Instituto Nacional de Meteorologia) Public Dataset : CC0 1.0 Universal
    License ([https://portal.inmet.gov.br/sobre](https://portal.inmet.gov.br/sobre))'
  prefs: []
  type: TYPE_NORMAL

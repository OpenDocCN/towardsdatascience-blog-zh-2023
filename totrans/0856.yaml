- en: Exploring emotions with Artificial Intelligence, OpenAI, and Exploratory Data
    Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/exploring-emotions-with-artificial-intelligence-openai-and-exploratory-data-analysis-36a3882d3f11](https://towardsdatascience.com/exploring-emotions-with-artificial-intelligence-openai-and-exploratory-data-analysis-36a3882d3f11)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Here‚Äôs how to visualize emotion in text with Python using OpenAI and Exploratory
    Data Analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://piero-paialunga.medium.com/?source=post_page-----36a3882d3f11--------------------------------)[![Piero
    Paialunga](../Images/de2185596a49484698733e85114dd1ff.png)](https://piero-paialunga.medium.com/?source=post_page-----36a3882d3f11--------------------------------)[](https://towardsdatascience.com/?source=post_page-----36a3882d3f11--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page-----36a3882d3f11--------------------------------)
    [Piero Paialunga](https://piero-paialunga.medium.com/?source=post_page-----36a3882d3f11--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page-----36a3882d3f11--------------------------------)
    ¬∑9 min read¬∑Dec 12, 2023
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/417d5e40aed1306a713601d76c61dcc4.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author made using [Midjourney](https://www.midjourney.com/home?callbackUrl=%2Fexplore)
  prefs: []
  type: TYPE_NORMAL
- en: I want to start by saying that I am a fan of old Disney movies more than the
    new ones.
  prefs: []
  type: TYPE_NORMAL
- en: I think that it has something to do with the fact that I was a kid when I watched
    older Disney movies and I have this feeling of nostalgia about the moment itself.
    Even if, by all means, I am not a movie expert, I also have the feeling that the
    old Disney movies are the ones with the best plots.
  prefs: []
  type: TYPE_NORMAL
- en: 'There is one remarkable exception though, and that is [**Inside Out**](https://movies.disney.com/inside-out).
    I watched that movie in the theater and was in love with it. I don‚Äôt want to spoil
    anything, I‚Äôll say that the movie is about the idea that inside all of us there
    is a range of emotions:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Rage**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Disgust**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Joy**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Fear**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sadness**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: And these emotions sometimes talk, like they are real people, inside of us.
    It‚Äôs an incredibly sweet movie with, I think, an amazing plot. When I heard that
    the new movie, Inside Out 2, is about to come out, I was so excited and I‚Äôm counting
    the days. :)
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let me anticipate your question:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúWhat does it have to do with AI?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When I was watching the trailer, I thought
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúCan we generate what emotions would say?‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ‚ÄúCan we use the ChatGPT technologies to simulate what emotion ‚Äúrage‚Äù would say
    if they were a person?‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ‚ÄúCan we explore emotions as vectors in a N dimensional space? And if that, can
    we plot it?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: So buckle up, and let‚Äôs see what we can do üòè
  prefs: []
  type: TYPE_NORMAL
- en: '**Before we dive in,** I want to highlight that this is a ‚Äúgame‚Äù based on the
    movie. I think that a world where emotions are replaced by AI would be a pretty
    sad one, and I‚Äôm not claiming that the procedure will do any of that in the first
    place.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This story is divided into 4 parts:'
  prefs: []
  type: TYPE_NORMAL
- en: 0\. The structure of the code
  prefs: []
  type: TYPE_NORMAL
- en: 1\. The first part of the code, generating emotions. High focus on the code
  prefs: []
  type: TYPE_NORMAL
- en: 2\. The second part of the code. This is less ***actually*****based on the code**.
    It is more based on the Exploration of the dataset. This is where the fun starts!
  prefs: []
  type: TYPE_NORMAL
- en: 3\. A summary
  prefs: []
  type: TYPE_NORMAL
- en: 4\. The conclusions
  prefs: []
  type: TYPE_NORMAL
- en: '***This blog will be code-based and it is meant to be useful for developers.***
    If you are not a developer, you can jump straight to chapter 3, where I will describe
    the result of the Emotion inspection using AI :)'
  prefs: []
  type: TYPE_NORMAL
- en: 0\. The structure
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This work is divided into two chapters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The generation of the ‚Äúemotion‚Äù data**: It will be a module with a main.py
    script that generates sentences. These sentences will be ‚Äúmovie-like‚Äù sentences
    like the Inside Out ones. We will generate 150 sentences per emotion: 150x5 =
    750 sentences with OpenAI.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Exploratory Data Analysis:** This will be a notebook that will do the data
    exploration on the Open AI generated sentences.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let‚Äôs describe how we are doing it‚Ä¶
  prefs: []
  type: TYPE_NORMAL
- en: The whole code is available on my GitHub page ([https://github.com/PieroPaialungaAI/Emotion_AI/](https://github.com/PieroPaialungaAI/Emotion_AI/tree/main/EmotionAI))
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 1\. Emotion AI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We call the generation of the emotion data as **EmotionAI.**
  prefs: []
  type: TYPE_NORMAL
- en: 'In EmotionAI, I created 4 Python scripts:'
  prefs: []
  type: TYPE_NORMAL
- en: '**constants.py**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**main.py**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**util.py**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**emotionai.py**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can find that in [this Github folder](https://github.com/PieroPaialungaAI/Emotion_AI/tree/main/EmotionAI).
    Let‚Äôs start from the bottom, by describing the main.py file:'
  prefs: []
  type: TYPE_NORMAL
- en: 1.1 Main.py
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **main.py** file has the idea of creating the emotions‚Äô sentences.
  prefs: []
  type: TYPE_NORMAL
- en: It does it using a class named AIEmotionGenerator, which is part of the **emotionai.py**
    code. Using AIEmotionGenerator, you first **create the folders** where you will
    store the sentences (50x3 per emotion), and then you **generate the sentences
    and store them.** Pretty easy, right?
  prefs: []
  type: TYPE_NORMAL
- en: 'The dirty work is done by **emotionai.py** let‚Äôs give a look:'
  prefs: []
  type: TYPE_NORMAL
- en: 1.2 emotionai.py
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**emotionai.py** builds a class, named AIEmotionGenerator.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This class does two things:'
  prefs: []
  type: TYPE_NORMAL
- en: Build the folder for you (**boring**) ü•±
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generate the sentence given an emotion (**very interesting**) ü§©
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I generated emotions giving a hint to OpenAI‚Äôs GPT, which is the real sentences
    said by the emotions of the movie Inside Out. Let‚Äôs see what they are in **constants.py**
  prefs: []
  type: TYPE_NORMAL
- en: 1.3 constants.py
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: So, this is the constants.py. In this file we have the sentences that we use
    to make GPT understand more about the task. You should fill it with your [Open
    AI API](https://openai.com/blog/openai-api) key too‚Ä¶ this is crucial to make it
    work*.
  prefs: []
  type: TYPE_NORMAL
- en: '*The OpenAI API key will cost you money eventually, but I spent like $0.11
    for this project. Keep an eye on the usage page of OpenAI, but don‚Äôt be stressed
    about it. It‚Äôs not an investment. :)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The sentences come from a movie. Notice that OpenAI is programmed not to give
    you answers that are ANGRY, or SAD, that‚Äôs why I changed the emotion to ‚ÄúGoofy
    Sadness‚Äù and ‚ÄúFunny Anger‚Äù‚Ä¶ It‚Äôs a little bit frustrating that these technologies
    pretend that the world is all rainbow and ice cream if you ask me, but it did
    the trick.
  prefs: []
  type: TYPE_NORMAL
- en: 2\. EDA on the Emotion Sentences
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Ok, so after you have generated the emotions, you will have your folders and
    they will look like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/35e19e0140cd28015ffb959c52381431.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: 'We need to extract the .txt files and explore them. Let‚Äôs do it step by step:'
  prefs: []
  type: TYPE_NORMAL
- en: 2.0 Libraries
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'I used my long life friends: üëª'
  prefs: []
  type: TYPE_NORMAL
- en: Notice that EmotionAI is in the library, we will need to use it (especially
    for the constants)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 2.1 Importing the text
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This part is a little bit boring but necessary, we import the text from the
    folders and fix it in a dataframe manner.
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, the OpenAI response can be a little random, especially in the
    format. So please review the .txt files and delete stuff like ‚ÄúSure! Let me give
    you the answer‚Äù or ‚ÄúI‚Äôm sorry that you feel sad, this is the list of answers‚Äù‚Ä¶
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Once you have done it your dataset will look like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '2.2 Visualization: WordCloud!'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The wordcloud is a method to see the frequency of words in a text. This is
    what we will use, class by class (or emotion by emotion) to visualize the texts:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/76a94b38fcf54a208b262e776ba408b8.png)'
  prefs: []
  type: TYPE_IMG
- en: This is super fun. The disgust has the most said word ‚ÄúSMELL‚Äù and ‚ÄúSOCK‚Äù. The
    Joy has world like ‚ÄúLAUGHTER‚Äù and ‚ÄúDELIGHT‚Äù. The Sadness has words like ‚ÄúSTUCK‚Äù,
    ‚ÄúACCIDENTALLY‚Äù, ‚ÄúNEVER‚Äù. Fear has words like ‚ÄúSCARED‚Äù, ‚ÄúMIGHT‚Äù, WORRY‚Äù.
  prefs: []
  type: TYPE_NORMAL
- en: We are getting good stuff. Let‚Äôs keep going!
  prefs: []
  type: TYPE_NORMAL
- en: 2.3 Embedding
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Embedding is the idea of transforming words into numbers‚Ä¶ or better‚Ä¶ SENTENCES
    into SEQUENCES of NUMBERS. Like this!
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/042a07f593c5d4a2fcd8dcf89fcf759a.png)'
  prefs: []
  type: TYPE_IMG
- en: The sentences with **Awful** and **Terrible** are close, the sentence with **Beautiful**
    is further away!
  prefs: []
  type: TYPE_NORMAL
- en: You can do the embedding step in so many ways, I chose to do it with OpenAI,
    mainly cause it‚Äôs quick and efficient, but choose your own method!
  prefs: []
  type: TYPE_NORMAL
- en: 'This is how you embed each sentence in your dataset, so that you have every
    sentence as a vector, just like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d601a441f876ce27402d20fe24f8fb7b.png)'
  prefs: []
  type: TYPE_IMG
- en: P.S. I‚Äôd be mad too if you replaced my Ice Cream with Broccoli‚Ä¶
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 2.4 Reduce the vectors dimensions‚Ä¶
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now we want to visualize the vectors. To do it, as our brain can only process
    2 or 3D things, let‚Äôs us the PCA to reduce the dimensionality from 1500+ (vector
    dimensionality using GPT Embedding) to 2*.
  prefs: []
  type: TYPE_NORMAL
- en: '**Preprocess** the input vectors:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Train the PCA**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Apply the PCA** to the original vector'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*I made this [article](/hands-on-image-compression-using-principal-component-analysis-with-python-1cd6cad72366)
    about Principal Component Analysis if you want to understand how it works‚Ä¶ :)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 2.5 See the rainbow!
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now that we have our 2D dataset we can plot them and understand what‚Äôs going
    on. Let‚Äôs do it!
  prefs: []
  type: TYPE_NORMAL
- en: That‚Äôs pretty nice‚Ä¶ you can distinguish‚Ä¶
  prefs: []
  type: TYPE_NORMAL
- en: '**Sadness** in the lower part of the dataset, as a long stripe'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Disgust** in the right upper part of the dataset, as a diagonal stripe'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Anger** in the left upper part of the dataset, as a circle like structure'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let‚Äôs see how ‚ÄúJoy‚Äù is doing.
  prefs: []
  type: TYPE_NORMAL
- en: 'Fear and Joy are pretty separated, which is good, except for an area in the
    middle. I suspect that is because ‚ÄúFear‚Äù can be ‚ÄúJoyful‚Äù when you see sentence
    like:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúI am so HAPPY that the spider didn‚Äôt approach me. I am terrified by spider‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: That is like a Joy/Fear situation indeed üôÉ
  prefs: []
  type: TYPE_NORMAL
- en: 'In this case, we also applied the PCA to the embedded Sentence of Fear in the
    movie, and we see that the sentence that Fear says in the movie (which was):'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúI sure am glad you told me earthquakes are a myth Joy, otherwise i‚Äôd be terrified
    right now.‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Is pretty much between the orange fellas of the ‚ÄúFear‚Äù sentences.
  prefs: []
  type: TYPE_NORMAL
- en: If we do the same with the disgust sentence, we see that the disgust is correctly
    in between the green points, which is what we want.
  prefs: []
  type: TYPE_NORMAL
- en: 'The disgust sentence was:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúOkay, Caution, There Is A Dangerous Smell, People.‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: And even this one is kind of a Disgust/Fear situation. That is because emotions
    are not black and white, and you can feel a lot of emotions at the same time.
    If you were ever in love, you know this very well ‚ù§
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Conclusions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thank you so much for reading this story. I had so much fun doing it. I love
    Inside Out and I think it‚Äôs very fun when we try to see if a computer can generate
    emotion-like sentences.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this story we:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Establish that Inside Out is amazing**, and we used it as a starting point
    for the idea of making emotion ‚Äúsay things‚Äù. If ‚Äúfear‚Äù could talk, what would
    it say?'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Used the GPT technology of OpenAI to generate sentences, **based on the original
    ones of the movies.** We made OpenAI generate 150 disgust-like sentences, 150
    fear-like sentences, 150 joy-like sentences, and 150 sadness-like sentences.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Used Exploratory Data Analysis techniques like **wordcloud, embedding, and PCA
    to visualize the results.**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The sentences that GPT took out were pretty funny.
  prefs: []
  type: TYPE_NORMAL
- en: 'Fear said:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúI am scared that my own shadow might come alive and start chasing me.‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'While Sadness said:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚ÄúI once got stuck in a revolving door because I forgot to push‚Äù
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The wordcloud was amazing too, as it highlighted as the Sadness has that sense
    of Fear and uses words like ‚ÄúNever‚Äù, while the disgust is almost related to the
    ‚Äúsmell‚Äù of things, which is pretty accurate.
  prefs: []
  type: TYPE_NORMAL
- en: When we visualized the sentences, we saw that the sentences formed clear clusters
    and that the original sentences of the movie were pretty much in the corresponding
    cluster. This is a sign of consistency and good prompting.
  prefs: []
  type: TYPE_NORMAL
- en: 'This work could be useful for many things like:'
  prefs: []
  type: TYPE_NORMAL
- en: Suggesting the movie director new sentences using this technology
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understand the consistency of the characters by tracking their vectors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create new emotions and feelings
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Your ideas (comment on this post)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 4\. About me!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thank you again for your time. It means a lot ‚ù§
  prefs: []
  type: TYPE_NORMAL
- en: 'My name is Piero Paialunga and I‚Äôm this guy here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/636991027461e453b326924e6e606f79.png)'
  prefs: []
  type: TYPE_IMG
- en: 'I am a Ph.D. student at the University of Cincinnati Aerospace Engineering
    Department. I talk about AI, and Machine Learning in my blog posts and on Linkedin.
    If you liked the article and want to know more about machine learning and follow
    my studies you can:'
  prefs: []
  type: TYPE_NORMAL
- en: A. Follow me on [**Linkedin**](https://www.linkedin.com/in/pieropaialunga/),
    where I publish all my stories
  prefs: []
  type: TYPE_NORMAL
- en: B. Subscribe to my [**newsletter**](https://piero-paialunga.medium.com/subscribe).
    It will keep you updated about new stories and give you the chance to text me
    to receive all the corrections or doubts you may have.
  prefs: []
  type: TYPE_NORMAL
- en: C. Become a [**referred member**](https://piero-paialunga.medium.com/membership),
    so you won‚Äôt have any ‚Äúmaximum number of stories for the month‚Äù and you can read
    whatever I (and thousands of other Machine Learning and Data Science top writers)
    write about the newest technology available.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you want to ask me questions or start a collaboration, leave a message here:'
  prefs: []
  type: TYPE_NORMAL
- en: '***piero.paialunga@hotmail.com***'
  prefs: []
  type: TYPE_NORMAL
- en: Ciao ‚ù§Ô∏è
  prefs: []
  type: TYPE_NORMAL

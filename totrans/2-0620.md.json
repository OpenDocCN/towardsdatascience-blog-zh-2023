["```py\nimport pandas as pd\n\n# Calculate review frequencies by year\ndata['year'] = pd.DatetimeIndex(data['period']).year\nrows_count = data.groupby('year', as_index=False).year.value_counts()\nrows_count.columns=['year','reviews']\n\nimport matplotlib.pyplot as plt\n\n# Generate a line plot\nrows_count.plot.line(x='year',y = 'reviews')\nplt.show()\n```", "```py\nimport re\n\n# Convert product reviews to a string\ntext = pd.Series.to_string(data['text'], index = False)\n\n# Remove newline characters\ntext = re.sub('\\n', '', text)\n\n# Calculate sum of numbers, letters, and spaces\nnumbers = sum(c.isdigit() for c in text)\nletters = sum(c.isalpha() for c in text)\nspaces  = sum(c.isspace() for c in text)\nothers  = len(text) - numbers - letters - spaces\n```", "```py\n# Calculate metrics\ndirtiness = ((numbers + others) / len(text)) * 100\ncleanness = ((letters + spaces) / len(text)) * 100\n\nprint(dirtiness)\nprint(cleanness)\n```", "```py\nfrom arabica import coffee_break\n\ncoffee_break(text = data['text'],\n             time = data['period'],\n             date_format = 'us',     # Use US-style date format to read dates\n             preprocess = True,      # Clean data - digits and punctuation\n             skip = ['<br />',       # Remove additional stop words\n                     '/n',\n             'Another Long String'],\n             n_breaks = 2,           # 2 breakpoints identified\n             time_freq = 'Y')        # Yearly aggregation\n```", "```py\nfrom arabica import cappuccino\n\ncappuccino(text = data['text'],\n           time = data['period'],\n           date_format = 'us',       # Use US-style date format to parse dates\n           plot = 'heatmap',\n           ngram = 2,                # N-gram size, 1 = unigram, 2 = bigram\n           time_freq = 'Y',          # Aggregation period, 'M' = monthly, 'Y' = yearly\n           max_words = 8,            # Display 8 most frequent bigrams for each period\n           stopwords = ['english'],  # Remove English stopwords\n           skip = ['<br />',         # Remove additional stop words\n                   '/n',\n           'Another Long String'],\n           numbers = True,           # Remove numbers\n           lower_case = True)        # Lowercase text\n```"]